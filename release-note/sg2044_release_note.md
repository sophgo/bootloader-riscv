# 1.0.0_2025-01-09

## [bootloader-riscv(master)](https://github.com/sophgo/bootloader-riscv/tree/master)

+ change ramdisk get ip from /proc/sgdrv/vethip (@xiangwen.jiang in [8b7976ee00ccb06](https://github.com/sophgo/bootloader-riscv/commit/8b7976ee00ccb06) at 2025-01-08 09:45:46)
    > Signed-off-by: xiangwen.jiang &lt;xiangwen.jiang@sophgo.com&gt;

+ scripts: modify BM1690 boot file address. (@dong.yang in [1491742c520fa58](https://github.com/sophgo/bootloader-riscv/commit/1491742c520fa58) at 2025-01-03 08:04:42)
    > Signed-off-by: dong.yang &lt;dong.yang@sophgo.com&gt;

+ pcie mode rp use zsbl.bin (@tingzhu.wang@sophgo.com in [05231d991d1a43e](https://github.com/sophgo/bootloader-riscv/commit/05231d991d1a43e) at 2024-12-26 07:14:38)
    > Signed-off-by: tingzhu.wang@sophgo.com &lt;tingzhu.wang@sophgo.com&gt;

+ change the address of ip (@tingzhu.wang@sophgo.com in [070a738f8a53632](https://github.com/sophgo/bootloader-riscv/commit/070a738f8a53632) at 2024-12-26 02:49:09)
    > Signed-off-by: tingzhu.wang@sophgo.com &lt;tingzhu.wang@sophgo.com&gt;

+ SG2042:Release:V1.1.0 (@chunzhi.lin in [efb9cfed97e59e1](https://github.com/sophgo/bootloader-riscv/commit/efb9cfed97e59e1) at 2024-12-25 02:57:56)
    > Signed-off-by: chunzhi.lin &lt;chunzhi.lin@sophgo.com&gt;

+ Add pxe boot. (@zhaohui-yan in [93245269b0655de](https://github.com/sophgo/bootloader-riscv/commit/93245269b0655de) at 2024-12-24 04:12:01)

+ script:sg2042:: avoid repeated umount (@sharim in [9ea83bac2605cb0](https://github.com/sophgo/bootloader-riscv/commit/9ea83bac2605cb0) at 2024-12-20 02:47:32)
    > Signed-off-by: sharim &lt;sharim.pyi@gmail.com&gt;

+ script:sg2042::fix fedora image&#x27;s rootfs path (@sharim in [68a3a36bdf83bda](https://github.com/sophgo/bootloader-riscv/commit/68a3a36bdf83bda) at 2024-12-19 03:17:49)
    > Signed-off-by: sharim &lt;sharim.pyi@gmail.com&gt;

+ script:sg2042::modify behavior of &#x60;mkdir&#x60; and &#x60;umount&#x60; (@sharim in [350798ff66abb4b](https://github.com/sophgo/bootloader-riscv/commit/350798ff66abb4b) at 2024-12-18 12:36:15)
    > 1. add &#x27;-p&#x27; to &#x60;mkdir&#x60; to avoid &quot;create existed directory&quot; error
    > 2. add &#x27;-R&#x27; to &#x60;umount&#x60; to auto umount rootfs recursively
    > Signed-off-by: sharim &lt;sharim.pyi@gmail.com&gt;

+ scripts: fix some bugs (@JianHang Wu in [191c4efbe36733e](https://github.com/sophgo/bootloader-riscv/commit/191c4efbe36733e) at 2024-12-13 10:19:02)
    > Signed-off-by: JianHang Wu &lt;jianhang.wu@sophgo.com&gt;

+ Scripts:change the default offset and fix a bug (@JianHang Wu in [95c8a85d5c9600d](https://github.com/sophgo/bootloader-riscv/commit/95c8a85d5c9600d) at 2024-12-09 22:19:51)
    > Signed-off-by: JianHang Wu &lt;jianhang.wu@sophgo.com&gt;

+ Scripts:do some optimizations. (@JianHang Wu in [1cdf8237a80d7be](https://github.com/sophgo/bootloader-riscv/commit/1cdf8237a80d7be) at 2024-12-09 09:35:12)
    > -add overlap checking, error reporting, info print functionality in gen_firmware_xml.c.
    > -remove some redundant files(gen_spi_flash.c and gen_sg2044r_spi_flash.c,etc).
    > If you need to add new board-level firmware, please follow the example to add the corresponding information at the head of gen_firmware_xml.c file. Additionally, add or modify the relevant functions in envsetup.sh (including specifying the release-note path and macros, etc).
    > Signed-off-by: JianHang Wu &lt;jianhang.wu@sophgo.com&gt;

+ script: modify fw path for bm1690. (@dong.yang in [fe1796a58b3f17f](https://github.com/sophgo/bootloader-riscv/commit/fe1796a58b3f17f) at 2024-12-05 03:35:33)
    > Signed-off-by: dong.yang &lt;dong.yang@sophgo.com&gt;

+ scripts: refine mango and sg2044 build scripts (@Jingyu Li in [828af44ad55f38b](https://github.com/sophgo/bootloader-riscv/commit/828af44ad55f38b) at 2024-12-03 12:26:43)
    > - Moved the DTB copy earlier to avoid issues with kernel Makefile version or
    > rpmbuild tool version inconsistencies.
    > - FSBL source code is not publicly available; the daily build system updates
    > the SG2044 binary at a fixed link and will automatically download it if
    > missing locally.
    > Signed-off-by: Jingyu Li &lt;jingyu.li01@sophgo.com&gt;

+ scripts: fix build_rv_euler_kernel bug (@Jingyu Li in [a052f452e8c1211](https://github.com/sophgo/bootloader-riscv/commit/a052f452e8c1211) at 2024-11-29 06:18:22)
    > Different versions of the Linux kernel have varying build paths.
    > Signed-off-by: Jingyu Li &lt;jingyu.li01@sophgo.com&gt;

+ scripts: refine build process (@Jingyu Li in [4e5a4f9fe786b09](https://github.com/sophgo/bootloader-riscv/commit/4e5a4f9fe786b09) at 2024-11-28 08:00:23)
    > - Add DTB generation to build_rv_ubuntu/euler_kernel.
    > - Only copy the DTB file corresponding to the specified $CHIP into the firmware
    > directory.
    > - For SG2044, Remove the LinuxBoot binaries when build_rv_*_image
    > process; remove the LinuxBoot build process when build_rv_firmware.
    > Signed-off-by: Jingyu Li &lt;jingyu.li01@sophgo.com&gt;

+ modify the packaging scripts and add packaging support for SG2044 firmware (@wujianhang in [a60c5e4a38a7463](https://github.com/sophgo/bootloader-riscv/commit/a60c5e4a38a7463) at 2024-11-27 13:48:45)

+ scripts: revert build_rv_pcie_zsbl for BM1690. (@dong.yang in [7d5fa90c035fbc0](https://github.com/sophgo/bootloader-riscv/commit/7d5fa90c035fbc0) at 2024-11-27 13:04:09)
    > Now we use PCIe zsbl config for BM1690 in sg2260-pld branch,
    > so keep this cmd until BM1690 switch to zsbl master branch.
    > Signed-off-by: dong.yang &lt;dong.yang@sophgo.com&gt;

+ scripts: remove checkout op when building EDK II (@Jingyu Li in [fc17795954f4b29](https://github.com/sophgo/bootloader-riscv/commit/fc17795954f4b29) at 2024-11-27 10:02:39)
    > In the daily-build system, the checkout operation synchronizes remote changes
    > stored in the refs/remotes/* space. However, if we also perform a checkout
    > during the local build process, the local changes in the refs/heads/* space can
    > lead to synchronization issues, including potential version rollbacks.
    > Signed-off-by: Jingyu Li &lt;jingyu.li01@sophgo.com&gt;

+ scripts: Restore rpm build directory to default directory (@Xiaoguang Xing in [e39fa86943a382b](https://github.com/sophgo/bootloader-riscv/commit/e39fa86943a382b) at 2024-11-25 13:48:33)
    > Signed-off-by: Xiaoguang Xing &lt;xiaoguang.xing@sophgo.com&gt;

+ scripts: fix rpm&#x27;s builddir when linux ver &gt;&#x3D; 6.10 (@sharim in [874948fdc477ec7](https://github.com/sophgo/bootloader-riscv/commit/874948fdc477ec7) at 2024-11-25 09:59:57)
    > Signed-off-by: sharim &lt;sharim.pyi@gmail.com&gt;

## [zsbl(master)](https://github.com/sophgo/zsbl/tree/master)

+ bm1690: cli_loop(0) will cause zsbl into cmdline. (@dong.yang in [779440bd7d73f96](https://github.com/sophgo/zsbl/commit/779440bd7d73f96) at 2025-01-04 09:03:55)
    > In PCIe mode, zsbl should directly jump to the next level to
    > continue execution.
    > Signed-off-by: dong.yang &lt;dong.yang@sophgo.com&gt;

+ support getopt series functions (@Chao Wei in [d8a5994f48a23ff](https://github.com/sophgo/zsbl/commit/d8a5994f48a23ff) at 2024-12-31 15:01:47)

+ SG2044: remove c920 csr log on boot (@Chao Wei in [57dff4918865a5b](https://github.com/sophgo/zsbl/commit/57dff4918865a5b) at 2024-12-31 14:33:32)
    > add a command lscsr instead.
    > press j, enter console, then execute lscsr command

+ remove outdated efuse driver (@Chao Wei in [b6f2fd576b40d15](https://github.com/sophgo/zsbl/commit/b6f2fd576b40d15) at 2024-12-31 14:25:55)

+ add more device list commands (@Chao Wei in [66d995632cb323e](https://github.com/sophgo/zsbl/commit/66d995632cb323e) at 2024-12-31 14:23:08)

+ add command, list boot devices (@Chao Wei in [07753bc184d6f57](https://github.com/sophgo/zsbl/commit/07753bc184d6f57) at 2024-12-31 14:15:08)
    > lsbdev, list boot devices

+ add command, list all platform devices (@Chao Wei in [ce547abc97a4253](https://github.com/sophgo/zsbl/commit/ce547abc97a4253) at 2024-12-31 14:11:53)
    > lspdev, list platform devices

+ add console (@Chao Wei in [679cb81f20fbe19](https://github.com/sophgo/zsbl/commit/679cb81f20fbe19) at 2024-12-31 14:11:53)

+ SG2044: Auto generate memory information (@Chao Wei in [0e3bba0a8cf5071](https://github.com/sophgo/zsbl/commit/0e3bba0a8cf5071) at 2024-12-30 04:25:48)
    > Auto generate memory information by eFuse data

+ modify memory node in dtb automatically (@Chao Wei in [fa0fbce42bd0152](https://github.com/sophgo/zsbl/commit/fa0fbce42bd0152) at 2024-12-27 14:23:14)

+ follow device naming convension (@Chao Wei in [fe702a41a2562b2](https://github.com/sophgo/zsbl/commit/fe702a41a2562b2) at 2024-12-27 14:20:59)

+ add alias property in device (@Chao Wei in [a82264d8946a516](https://github.com/sophgo/zsbl/commit/a82264d8946a516) at 2024-12-27 14:20:59)

+ add nvmem device model (@Chao Wei in [8f9f41cabfdd7c6](https://github.com/sophgo/zsbl/commit/8f9f41cabfdd7c6) at 2024-12-27 14:20:59)
    > add nvmem device model
    > add its first device driver, sophgo efuse

+ SG2044: support geting dram information from efuse (@Chao Wei in [572f47fc5740d09](https://github.com/sophgo/zsbl/commit/572f47fc5740d09) at 2024-12-27 14:20:59)

+ fix conflict macro definitions (@Chao Wei in [4ec7ed9e1725cb6](https://github.com/sophgo/zsbl/commit/4ec7ed9e1725cb6) at 2024-12-27 14:20:59)

+ using alias to index boot devices (@Chao Wei in [455a9160aaf5885](https://github.com/sophgo/zsbl/commit/455a9160aaf5885) at 2024-12-27 14:20:59)

+ change tp memory layout of pcie mode (@tingzhu.wang@sophgo.com in [e287bbc15974dc7](https://github.com/sophgo/zsbl/commit/e287bbc15974dc7) at 2024-12-26 02:26:41)
    > Signed-off-by: tingzhu.wang@sophgo.com &lt;tingzhu.wang@sophgo.com&gt;

+ Modify the value of DDR data-rate in conf.ini (@lin fei in [fc1ca4037f53799](https://github.com/sophgo/zsbl/commit/fc1ca4037f53799) at 2024-12-25 12:51:56)
    > Signed-off-by: lin peng &lt;peng.lin@sophgo.com&gt;

+ Modify the conf.ini content according to SMBIOS specifications (@lin fei in [ae1bd24a1b30eac](https://github.com/sophgo/zsbl/commit/ae1bd24a1b30eac) at 2024-12-25 12:38:45)
    > - Remove the chassis-related content.
    > - Update the values for DDR, CPU, and cache sections according to SMBIOS specifications.
    > - Standardize the casing (uppercase/lowercase) in conf.ini.
    > Signed-off-by: lin peng &lt;peng.lin@sophgo.com&gt;

+ SG2044: Fix footer &quot;[eof]&quot; not found in EDK II phase (@Jingyu Li in [a3b608caf8edb15](https://github.com/sophgo/zsbl/commit/a3b608caf8edb15) at 2024-12-19 22:53:19)
    > Set the NULL character after the footer rather than before.
    > Signed-off-by: Jingyu Li &lt;jingyu.li01@sophgo.com&gt;

+ SG2044: Remove debug information of mtd device (@Chao Wei in [d47989c20cc9fc6](https://github.com/sophgo/zsbl/commit/d47989c20cc9fc6) at 2024-12-17 08:36:41)

+ SG2042: Support parseing MAC from conf.ini (@Chao Wei in [1864a4ade785fd9](https://github.com/sophgo/zsbl/commit/1864a4ade785fd9) at 2024-12-13 15:27:08)

+ SG2044: Support parseing MAC from conf.ini (@Chao Wei in [46fdc55a77ba9e1](https://github.com/sophgo/zsbl/commit/46fdc55a77ba9e1) at 2024-12-13 15:20:55)

+ Add lib to support ethernet MAC operations (@Chao Wei in [c20883b669d7d71](https://github.com/sophgo/zsbl/commit/c20883b669d7d71) at 2024-12-13 15:20:06)

+ SG2044: Support SPI NOR flash boot (@Chao Wei in [1d7b025be539b1a](https://github.com/sophgo/zsbl/commit/1d7b025be539b1a) at 2024-12-13 13:28:07)
    > 1. Add SOPHGO SPIFMC driver
    > 2. Change flash file table from 0x60_0000 to 0x8000

+ SG2044: Load config file to a conventional address (@Chao Wei in [a7a46291660399b](https://github.com/sophgo/zsbl/commit/a7a46291660399b) at 2024-12-12 13:56:59)
    > Instead of loading conf.ini to an allocated address,
    > load conf.ini to a conventional address, aka 0x89000000.
    > EDK2 will get conf.ini from there and getting informations about
    > SoC and boards.

+ Modify l2 cache size to 2MiB in sg2044 evb conf.ini (@lin fei in [f4aa049e9883272](https://github.com/sophgo/zsbl/commit/f4aa049e9883272) at 2024-12-05 08:58:26)
    > Signed-off-by: lin fei &lt;peng.lin@sophgo.com&gt;

+ Add sg2044 evb conf.ini in zsbl Repository (@lin fei in [22fd2846a4b1d4e](https://github.com/sophgo/zsbl/commit/22fd2846a4b1d4e) at 2024-12-04 07:24:05)
    > Signed-off-by: lin peng &lt;peng.lin@sophgo.com&gt;

+ qemu riscv64 virt works (@Chao Wei in [7fb853c748aedbc](https://github.com/sophgo/zsbl/commit/7fb853c748aedbc) at 2024-11-27 12:56:46)

+ Remove unused ARM code (@Chao Wei in [a2b7d8d84bf9635](https://github.com/sophgo/zsbl/commit/a2b7d8d84bf9635) at 2024-11-27 12:23:39)

+ Add serial device driver model (@Chao Wei in [c5842115d6de303](https://github.com/sophgo/zsbl/commit/c5842115d6de303) at 2024-11-27 11:56:38)

+ SG2042: Fixbug, wrong dtb used (@Chao Wei in [14568dc124fa9a3](https://github.com/sophgo/zsbl/commit/14568dc124fa9a3) at 2024-11-26 12:11:37)
    > 1. Setup dtb names after config init
    > 2. Add prefix &quot;riscv64&quot; in sgfat lib
    > 3. Setup boot device priority before loading any files

## [opensbi(sg2044-dev)](https://github.com/sophgo/opensbi/tree/sg2044-dev)

+ makefile: remove linker garbage collection print (@Xiaoguang Xing in [748d7041081b049](https://github.com/sophgo/opensbi/commit/748d7041081b049) at 2024-12-25 06:16:07)
    > See commmit 0171cfc(&quot;Makefile: enable --gc-sections&quot;).
    > Signed-off-by: Xiaoguang Xing &lt;xiaoguang.xing@sophgo.com&gt;

+ lib: fix warning message of timer in boot phase (@haijiao.liu in [3de9421b0211a27](https://github.com/sophgo/opensbi/commit/3de9421b0211a27) at 2024-12-25 01:42:05)
    > Optimize the reset driver to prevent the use of the timer function
    > before the timer driver initialization is completed, which resloves
    > the following warning messages:
    > sbi_timer_delay_loop: called without timer device
    > Signed-off-by: haijiao.liu &lt;haijiao.liu@sophgo.com&gt;

+ platform: Fix when no serial node in dtb (@Xiaoguang Xing in [1d0d0a6b1519d99](https://github.com/sophgo/opensbi/commit/1d0d0a6b1519d99) at 2024-12-25 01:40:40)
    > SOPHGO BM1690 SoC TP dtb has not serial node.
    > Signed-off-by: bowen.pang &lt;bowen.pang@sophgo.com&gt;

+ lib: add mtimer and mswi support for bm1690 ap and tp (@Xiaoguang Xing in [ba3b2e626902e1a](https://github.com/sophgo/opensbi/commit/ba3b2e626902e1a) at 2024-12-25 01:38:33)
    > mswi and mtimer&#x27; address of bm1690 ap and tp is not contiguous,
    > so make them separately.
    > Signed-off-by: Xiaoguang Xing &lt;xiaoguang.xing@sophgo.com&gt;

+ platform: generic: add sophgo sg2044 and bm1690 soc support (@Xiaoguang Xing in [4e26aa8747e11dd](https://github.com/sophgo/opensbi/commit/4e26aa8747e11dd) at 2024-12-25 01:38:12)
    > Signed-off-by: Xiaoguang Xing &lt;xiaoguang.xing@sophgo.com&gt;

+ include: Bump-up version to 1.6 (@Anup Patel in [bd613dd92113f68](https://github.com/sophgo/opensbi/commit/bd613dd92113f68) at 2024-12-24 09:58:18)
    > Update the OpenSBI version to 1.6 as part of release preparation.
    > Signed-off-by: Anup Patel &lt;apatel@ventanamicro.com&gt;
    > Signed-off-by: Anup Patel &lt;anup@brainfault.org&gt;

+ lib: utils: Fix irqchip registration for PLIC and APLIC (@Anup Patel in [7150db29d718680](https://github.com/sophgo/opensbi/commit/7150db29d718680) at 2024-12-24 08:36:09)
    > Currently, the same irqchip instance is registered for multiple PLIC
    > and APLIC instances which causes the sbi_list_for_each_entry() loop
    > in the sbi_irqchip_init() to hang at boot-time.
    > To address the above issue, register a separate irqchip instance for
    > each PLIC and APLIC instance.
    > Fixes: 2dd6eaf68055 (&quot;lib: sbi_irqchip: Call driver warm_init from SBI core&quot;)
    > Reported-by: Himanshu Chauhan &lt;hchauhan@ventanamicro.com&gt;
    > Signed-off-by: Anup Patel &lt;apatel@ventanamicro.com&gt;
    > Reviewed-by: Himanshu Chauhan &lt;hchauhan@ventanamicro.com&gt;

+ lib: sbi: Improve the alignment of boot-time prints (@Anup Patel in [551ac0f2d431a7a](https://github.com/sophgo/opensbi/commit/551ac0f2d431a7a) at 2024-12-24 06:30:47)
    > Addition of &quot;Experimental SBI Extensions&quot; to the boot-time prints
    > disturbs the alignment of other prints so adjust all boot-time
    > prints accordingly.
    > Signed-off-by: Anup Patel &lt;apatel@ventanamicro.com&gt;

+ lib: sbi: Print list of available SBI extensions at boot-time (@Anup Patel in [06754612f3617b8](https://github.com/sophgo/opensbi/commit/06754612f3617b8) at 2024-12-22 05:46:13)
    > Add boot-time prints for list of available standard and experimental
    > SBI extensions.
    > Signed-off-by: Anup Patel &lt;apatel@ventanamicro.com&gt;

+ include: sbi: Fix compiling with C23 enabled compilers (@Michael Neuling in [d539d64a23bbd64](https://github.com/sophgo/opensbi/commit/d539d64a23bbd64) at 2024-12-21 16:08:50)
    > C23 pre-defines bool so we need to gate our defines.
    > Signed-off-by: Michael Neuling &lt;michaelneuling@tenstorrent.com&gt;
    > Reviewed-by: Anup Patel &lt;anup@brainfault.org&gt;

+ inclue: sbi_utils: Cleanup int vs bool in semihosting_init() definitions (@Michael Neuling in [91196d76b7919fe](https://github.com/sophgo/opensbi/commit/91196d76b7919fe) at 2024-12-21 15:51:59)
    > This is needed for a future patches to enable the new C23 language dialect.
    > Signed-off-by: Michael Neuling &lt;michaelneuling@tenstorrent.com&gt;
    > Reviewed-by: Anup Patel &lt;anup@brainfault.org&gt;

+ lib: utils: Mark RPMI drivers as experimental (@Samuel Holland in [8d8cc9507bd79af](https://github.com/sophgo/opensbi/commit/8d8cc9507bd79af) at 2024-12-21 12:52:47)
    > These drivers were merged on an experimental basis without the RPMI
    > specification being frozen. As a result, they may not be compatible with
    > the frozen version of the RPMI protocol. Additionally, their devicetree
    > bindings have not been reviewed and are subject to change. Warn the user
    > that these drivers make no compatibility guarantees, and that their
    > behavior and devicetree bindings may change incompatibly in future
    > versions of OpenSBI.
    > Signed-off-by: Samuel Holland &lt;samuel.holland@sifive.com&gt;
    > Reviewed-by: Anup Patel &lt;anup@brainfault.org&gt;

+ platform: generic: Initialize console before other drivers (@Samuel Holland in [0c5dc12d73b0b5f](https://github.com/sophgo/opensbi/commit/0c5dc12d73b0b5f) at 2024-12-21 12:51:50)
    > Initialize serial drivers first, so messages printed by other drivers do
    > not need to use the early console buffer.
    > Suggested-by: Anup Patel &lt;anup@brainfault.org&gt;
    > Signed-off-by: Samuel Holland &lt;samuel.holland@sifive.com&gt;
    > Reviewed-by: Anup Patel &lt;anup@brainfault.org&gt;

+ lib: utils: Improve rpmi_cppc_fc_db_trigger() for RV32 (@Xiang W in [f0693016547837b](https://github.com/sophgo/opensbi/commit/f0693016547837b) at 2024-12-19 05:32:30)
    > Improve 64-bit operation under rv32 and remove db_val_u32_hi
    > in rpmi_cppc_fc_db_trigger().
    > Signed-off-by: Xiang W &lt;wxjstz@126.com&gt;
    > Reviewed-by: Anup Patel &lt;anup@brainfault.org&gt;

+ lib: sbi_pmu: Verify the raw events first during event info (@Atish Patra in [51dbc57fc7f0d6d](https://github.com/sophgo/opensbi/commit/51dbc57fc7f0d6d) at 2024-12-15 08:43:12)
    > The raw events have same event_idx. Thus, the event info sanity check
    > only relies on the select mask. The raw event check should be done first
    > so that regular hardware events can be verified using event idx range
    > check.
    > Fixes: e4345842168b (&quot;lib: sbi_pmu: Implement SBI PMU event info function&quot;)
    > Signed-off-by: Atish Patra &lt;atishp@rivosinc.com&gt;
    > Reviewed-by: Anup Patel &lt;anup@brainfault.org&gt;

+ lib: sbi_pmu: Fix the sanity check condition for hw event map (@Atish Patra in [0928ca21bcbdcc9](https://github.com/sophgo/opensbi/commit/0928ca21bcbdcc9) at 2024-12-15 08:36:52)
    > The hardware event map function invoked from platform code should
    > exclude any raw events as there is a separate function for the raw
    > events.
    > Fixes: d8a483fc7fd0 (&quot;lib: sbi_pmu: PMU raw event v2 support&quot;)
    > Signed-off-by: Atish Patra &lt;atishp@rivosinc.com&gt;
    > Reviewed-by: Anup Patel &lt;anup@brainfault.org&gt;

+ scripts/carray: change to using single awk invocation to generate .c (@Ben Dooks in [39532d11e9a5caa](https://github.com/sophgo/opensbi/commit/39532d11e9a5caa) at 2024-12-15 07:09:59)
    > The shell script makes multiple call-outs to awk to get information
    > from the configuration file. It would be easier to just write the
    > whole thing in one .awk script and have the makefile altered to call
    > that instead.
    > There should be no functional difference other than the script type
    > and has been tested with PLATFORM&#x3D;generic build. This should be both
    > quicker and easier to understand.
    > Signed-off-by: Ben Dooks &lt;ben.dooks@codethink.co.uk&gt;
    > Reviewed-by: Anup Patel &lt;anup@brainfault.org&gt;

+ script/carry.sh: send error to stderr (@Ben Dooks in [2c76548cba7f0ac](https://github.com/sophgo/opensbi/commit/2c76548cba7f0ac) at 2024-12-15 07:00:50)
    > Send the errors to stderr, otherwise they end up being
    > written to the file the script was redirecting to in the
    > Makefile
    > Also, use EOF block to make it easier to redirect
    > Signed-off-by: Ben Dooks &lt;ben.dooks@codethink.co.uk&gt;
    > Reviewed-by: Anup Patel &lt;anup@brainfault.org&gt;

+ Makefile: remove carry output if scripts/carray.sh fails (@Ben Dooks in [a36cd1b043d5f3f](https://github.com/sophgo/opensbi/commit/a36cd1b043d5f3f) at 2024-12-15 07:00:47)
    > If the script fails, we end up trying to build either
    > an empty or damaged .c file. Just remove it and let
    > gcc fail on non-existent file.
    > Signed-off-by: Ben Dooks &lt;ben.dooks@codethink.co.uk&gt;
    > Reviewed-by: Anup Patel &lt;anup@brainfault.org&gt;

+ top: add ~ files to .gitignore (@Ben Dooks in [c7866d99fe9a31f](https://github.com/sophgo/opensbi/commit/c7866d99fe9a31f) at 2024-12-15 07:00:45)
    > Ignore temporary files, and avoid accidentally adding
    > them to a commit.
    > Signed-off-by: Ben Dooks &lt;ben.dooks@codethink.co.uk&gt;
    > Reviewed-by: Anup Patel &lt;anup@brainfault.org&gt;

+ lib: sbi: sse: Fix a6 and a7 register content upon injection (@Clément Léger in [b47fcd01b3ba0e3](https://github.com/sophgo/opensbi/commit/b47fcd01b3ba0e3) at 2024-12-15 06:23:53)
    > The specification states that a6 contains the current hart id and
    > a7 contains the entry argument. This was inverted in the current
    > implementation.
    > Reported-by: Andrew Jones &lt;andrew.jones@linux.dev&gt;
    > Signed-off-by: Clément Léger &lt;cleger@rivosinc.com&gt;
    > Reviewed-by: Anup Patel &lt;anup@brainfault.org&gt;

+ lib: sbi: fix GLOBAL_PLAT_DEFINE (@Clément Léger in [851e3010989254e](https://github.com/sophgo/opensbi/commit/851e3010989254e) at 2024-12-15 06:22:57)
    > Fix GLOBAL_PLAT_0_START/END definitions. The specification states that
    > the beginning of the range is 0xc000 and the end is 0xffff.
    > Reported-by: Andrew Jones &lt;andrew.jones@linux.dev&gt;
    > Signed-off-by: Clément Léger &lt;cleger@rivosinc.com&gt;
    > Reviewed-by: Anup Patel &lt;anup@brainfault.org&gt;

+ Makefile: Don&#x27;t enable V-extension using -march option (@Anup Patel in [5545602f778e306](https://github.com/sophgo/opensbi/commit/5545602f778e306) at 2024-12-15 06:00:48)
    > Enabling V-extension using -march option causes OpenSBI boot-time
    > hang with LLVM compiler.
    > As a work-around, don&#x27;t enable V-extension using -march option and
    > instead use a custom OpenSBI specific define inform availability of
    > V-extension to lib/sbi/sbi_trap_v_ldst.c.
    > Fixes: c2acc5e5b0d8 (&quot;lib: sbi_misaligned_ldst: Add handling of vector load/store&quot;)
    > Signed-off-by: Anup Patel &lt;apatel@ventanamicro.com&gt;
    > Reviewed-by: Samuel Holland &lt;samuel.holland@sifive.com&gt;

+ lib: utils/fdt_cppc_rpmi: Fix compile error with LLVM (@Anup Patel in [74c6ea014db8fc7](https://github.com/sophgo/opensbi/commit/74c6ea014db8fc7) at 2024-12-15 05:58:13)
    > The following error is observed when compiling fdt_cppc_rpmi
    > driver using LLVM:
    > lib/utils/cppc/fdt_cppc_rpmi.c:87:3: error: label followed by a declaration is a C23 extension [-Werror,-Wc23-extensions]
    > 87 |                 u64 db_val_u64 &#x3D; 0;
    > To fix the above issue, move the variable declaration at the
    > start of function.
    > Fixes: 591a98bdd549 (&quot;lib: utils/cppc: Add RPMI CPPC driver&quot;)
    > Signed-off-by: Anup Patel &lt;apatel@ventanamicro.com&gt;
    > Reviewed-by: Samuel Holland &lt;samuel.holland@sifive.com&gt;

+ lib: sbi_misaligned_ldst: Add handling of vector load/store (@Nylon Chen in [c2acc5e5b0d8516](https://github.com/sophgo/opensbi/commit/c2acc5e5b0d8516) at 2024-12-06 12:13:06)
    > Add misaligned load/store handling for the vector extension
    > to the sbi_misaligned_ldst library.
    > This implementation is inspired from the misaligned_vec_ldst
    > implementation in the riscv-pk project.
    > Co-developed-by: Zong Li &lt;zong.li@sifive.com&gt;
    > Signed-off-by: Zong Li &lt;zong.li@sifive.com&gt;
    > Signed-off-by: Nylon Chen &lt;nylon.chen@sifive.com&gt;
    > Reviewed-by: Andy Chiu &lt;andy.chiu@sifive.com&gt;
    > Reviewed-by: Anup Patel &lt;anup@brainfault.org&gt;

+ lib: utils/mpxy: Add RPMI client driver for MPXY (@Rahul Pathak in [c5a8b15e398ad09](https://github.com/sophgo/opensbi/commit/c5a8b15e398ad09) at 2024-12-06 03:56:57)
    > Add a generic RPMI mailbox client driver which provides a MPXY channel.
    > Initially, this driver only supports RPMI clock service group but can
    > be extended to support multiple RPMI service groups.
    > Signed-off-by: Rahul Pathak &lt;rpathak@ventanamicro.com&gt;
    > Co-developed-by: Anup Patel &lt;apatel@ventanamicro.com&gt;
    > Signed-off-by: Anup Patel &lt;apatel@ventanamicro.com&gt;

+ lib: utils: Add simple FDT based MPXY driver framework (@Anup Patel in [32577ec3a1eea11](https://github.com/sophgo/opensbi/commit/32577ec3a1eea11) at 2024-12-06 03:56:54)
    > The generic platform can have multiple MPXY drivers so add a simple
    > FDT based MPXY driver framework.
    > Signed-off-by: Anup Patel &lt;apatel@ventanamicro.com&gt;

+ lib: sbi: Implement SBI MPXY extension (@Anup Patel in [e67d91cdcc1cba3](https://github.com/sophgo/opensbi/commit/e67d91cdcc1cba3) at 2024-12-06 03:56:52)
    > Implement the SBI MPXY extension which provides an SBI interface to
    > the supervisor software for send messages via MPXY framework.
    > Signed-off-by: Rahul Pathak &lt;rpathak@ventanamicro.com&gt;
    > Co-developed-by: Anup Patel &lt;apatel@ventanamicro.com&gt;
    > Signed-off-by: Anup Patel &lt;apatel@ventanamicro.com&gt;

+ lib: sbi: Add SBI Message Proxy (MPXY) framework (@Rahul Pathak in [7939bf1329eb551](https://github.com/sophgo/opensbi/commit/7939bf1329eb551) at 2024-12-06 03:56:50)
    > Introduce SBI Message Proxy (MPXY) framework which allows platform specific
    > code or drivers to register message protocol specific channels.
    > This framework enables the supervisor software to send messages belonging
    > to different message protocols via OpenSBI firmware.
    > Signed-off-by: Rahul Pathak &lt;rpathak@ventanamicro.com&gt;
    > Co-developed-by: Himanshu Chauhan &lt;hchauhan@ventanamicro.com&gt;
    > Signed-off-by: Himanshu Chauhan &lt;hchauhan@ventanamicro.com&gt;
    > Co-developed-by: Anup Patel &lt;apatel@ventanamicro.com&gt;
    > Signed-off-by: Anup Patel &lt;apatel@ventanamicro.com&gt;

+ lib: utils/cppc: Add RPMI CPPC driver (@Subrahmanya Lingappa in [591a98bdd549b20](https://github.com/sophgo/opensbi/commit/591a98bdd549b20) at 2024-12-06 03:56:47)
    > Add RPMI based driver for CPPC register read, write and probe.
    > Signed-off-by: Subrahmanya Lingappa &lt;slingappa@ventanamicro.com&gt;
    > Co-developed-by: Rahul Pathak &lt;rpathak@ventanamicro.com&gt;
    > Signed-off-by: Rahul Pathak &lt;rpathak@ventanamicro.com&gt;
    > Co-developed-by: Sunil V L &lt;sunilvl@ventanamicro.com&gt;
    > Signed-off-by: Sunil V L &lt;sunilvl@ventanamicro.com&gt;
    > Signed-off-by: Anup Patel &lt;apatel@ventanamicro.com&gt;

+ lib: utils: Add simple FDT based CPPC driver framework (@Anup Patel in [54e632b72e80101](https://github.com/sophgo/opensbi/commit/54e632b72e80101) at 2024-12-06 03:56:45)
    > The generic platform can have multiple CPPC drivers so add a simple
    > FDT based CPPC driver framework.
    > Signed-off-by: Anup Patel &lt;apatel@ventanamicro.com&gt;

+ lib: utils/hsm: Add RPMI HSM driver (@Subrahmanya Lingappa in [33ee9b8240fee29](https://github.com/sophgo/opensbi/commit/33ee9b8240fee29) at 2024-12-06 03:56:43)
    > The RPMI HSM service group provides set of routine to query and control
    > power states of a Hart. Add RPMI based Hart State Management (HSM) driver.
    > Signed-off-by: Subrahmanya Lingappa &lt;slingappa@ventanamicro.com&gt;
    > Signed-off-by: Anup Patel &lt;apatel@ventanamicro.com&gt;

+ lib: utils: Add simple FDT based HSM driver framework (@Anup Patel in [ff4769bf08b50c6](https://github.com/sophgo/opensbi/commit/ff4769bf08b50c6) at 2024-12-06 03:56:40)
    > The generic platform can have multiple HSM drivers so add a simple
    > FDT based HSM driver framework.
    > Signed-off-by: Anup Patel &lt;apatel@ventanamicro.com&gt;

+ lib: utils/fdt: Allow dynamic registration of FDT fixup callbacks (@Anup Patel in [9d760b810e18447](https://github.com/sophgo/opensbi/commit/9d760b810e18447) at 2024-12-06 03:56:38)
    > It should possible to fixup FDT from any part of OpenSBI so add
    > fdt_register_general_fixup() which allows dynamic registration of
    > FDT fixup callbacks.
    > Signed-off-by: Anup Patel &lt;apatel@ventanamicro.com&gt;

+ lib: sbi: Add optional resume address to hart suspend (@Subrahmanya Lingappa in [fdd72635368beb5](https://github.com/sophgo/opensbi/commit/fdd72635368beb5) at 2024-12-06 03:56:35)
    > Add an optional resume address to the platform specific hart suspend call.
    > Signed-off-by: Subrahmanya Lingappa &lt;slingappa@ventanamicro.com&gt;
    > Signed-off-by: Anup Patel &lt;apatel@ventanamicro.com&gt;

+ lib: utils/suspend: Add RPMI system suspend driver (@Subrahmanya Lingappa in [13f55f33a1d3617](https://github.com/sophgo/opensbi/commit/13f55f33a1d3617) at 2024-12-06 03:56:32)
    > Add RPMI based system suspend driver.
    > To test this, execute the follwoing in Linux:
    > $ echo mem &gt; /sys/power/state
    > To wake up, execute the following command on qemu monitor terminal:
    > (qemu) system_wakeup
    > Signed-off-by: Subrahmanya Lingappa &lt;slingappa@ventanamicro.com&gt;
    > Signed-off-by: Anup Patel &lt;apatel@ventanamicro.com&gt;

+ lib: utils: Add simple FDT based system suspend driver framework (@Anup Patel in [3676324b0e13b97](https://github.com/sophgo/opensbi/commit/3676324b0e13b97) at 2024-12-06 03:56:29)
    > The generic platform can have multiple system suspend drivers so add a
    > simple FDT based system suspend driver framework.
    > Signed-off-by: Anup Patel &lt;apatel@ventanamicro.com&gt;

+ lib/utils: reset: Add RPMI System Reset driver (@Rahul Pathak in [6a26726e08e4d1e](https://github.com/sophgo/opensbi/commit/6a26726e08e4d1e) at 2024-12-06 03:56:27)
    > Add RPMI based driver for system reset and enable it in the generic
    > platform defconfig
    > Signed-off-by: Rahul Pathak &lt;rpathak@ventanamicro.com&gt;
    > Signed-off-by: Anup Patel &lt;apatel@ventanamicro.com&gt;

+ lib/utils: Add RPMI messaging protocol and shared memory transport support (@Rahul Pathak in [91f46fb47eefb87](https://github.com/sophgo/opensbi/commit/91f46fb47eefb87) at 2024-12-06 03:56:21)
    > The RISC-V Platform Management Interface (RPMI) defines a messaging protocol
    > and shared memory based transport for bi-directional communication with an
    > on-chip or external microcontroller.
    > To support RPMI in OpenSBI, add:
    > 1) The RPMI messaging protocol defines and helper macros
    > 2) A FDT mailbox driver for the RPMI shared memory transport
    > Signed-off-by: Rahul Pathak &lt;rpathak@ventanamicro.com&gt;
    > Co-developed-by: Subrahmanya Lingappa &lt;slingappa@ventanamicro.com&gt;
    > Signed-off-by: Subrahmanya Lingappa &lt;slingappa@ventanamicro.com&gt;
    > Co-developed-by: Anup Patel &lt;apatel@ventanamicro.com&gt;
    > Signed-off-by: Anup Patel &lt;apatel@ventanamicro.com&gt;

+ lib: utils/mailbox: Add simple FDT based mailbox framework (@Anup Patel in [2244a34f0d618c6](https://github.com/sophgo/opensbi/commit/2244a34f0d618c6) at 2024-12-06 03:56:19)
    > Add a simple FDT based mailbox framework which is built on top of the generic
    > mailbox library. The phandle of FDT mailbox DT node is treated as the unique
    > mailbox controller ID which is required by the generic mailbox library. The
    > FDT based mailbox drivers will be probed on-demand from fdt_mailbox_request_chan()
    > called by the mailbox client drivers.
    > Signed-off-by: Anup Patel &lt;apatel@ventanamicro.com&gt;

+ lib: utils/mailbox: Add generic mailbox library (@Anup Patel in [ad846a7cb8cdb98](https://github.com/sophgo/opensbi/commit/ad846a7cb8cdb98) at 2024-12-06 03:56:13)
    > Add generic mailbox library which is independent of hardware description
    > format. The OpenSBI platform support or mailbox drivers can register
    > mailbox controller instances which can be discovered and used by different
    > mailbox client drivers. Each mailbox controller instance has a unique ID
    > which can be used by mailbox client drivers for find the mailbox controller
    > instance. The mailbox client drivers will typically request a mailbox channel
    > from the mailbox controller and use it to do data transfer with the remote
    > end of mailbox channel.
    > Signed-off-by: Anup Patel &lt;apatel@ventanamicro.com&gt;

+ lib: Increase ROOT_REGION_MAX to accomodate more memregions (@Rahul Pathak in [b49d67b70f09149](https://github.com/sophgo/opensbi/commit/b49d67b70f09149) at 2024-12-06 03:56:11)
    > As more drivers adding memregions into root domain, the current static limit
    > of ROOT_REGION_MAX is not sufficient. Increase the limit to accomodate more
    > memregions.
    > Signed-off-by: Rahul Pathak &lt;rpathak@ventanamicro.com&gt;
    > Signed-off-by: Anup Patel &lt;apatel@ventanamicro.com&gt;

+ lib: sbi_pmu: Implement SBI PMU event info function (@Atish Patra in [e4345842168b572](https://github.com/sophgo/opensbi/commit/e4345842168b572) at 2024-12-02 04:22:55)
    > Allow the supervisor software to query about the event using the
    > new function. This supports both firmware and hardware events.
    > The hardware event presence is verified hw_event_map which is populated
    > via PMU device tree node. The firmware event presence is checked through
    > event validation function which should take care of both standard and
    > platform firmware events.
    > Signed-off-by: Atish Patra &lt;atishp@rivosinc.com&gt;
    > Reviewed-by: Anup Patel &lt;anup@brainfault.org&gt;

+ lib: sbi_pmu: Add SBI PMU event info function details. (@Atish Patra in [05970d273c609ff](https://github.com/sophgo/opensbi/commit/05970d273c609ff) at 2024-12-02 04:22:52)
    > The SBI v3.0 introduced a new function to query about the events
    > without invoking CFG_MATCH. This allows supervisor software to
    > identify which events are supported on the platform with single
    > SBI call instead of a CFG_MATCH for each event.
    > Signed-off-by: Atish Patra &lt;atishp@rivosinc.com&gt;
    > Reviewed-by: Anup Patel &lt;anup@brainfault.org&gt;

+ lib: sbi_pmu: Remove redundant check for fw events (@Atish Patra in [cf196d80aa0850c](https://github.com/sophgo/opensbi/commit/cf196d80aa0850c) at 2024-12-02 04:22:50)
    > The pmu_validate_event already has the same check for fw events.
    > The validate function is called prior to the current function
    > to find a counter for firmware. That&#x27;s why, the redudant
    > check can be removed from the find counter function.
    > Signed-off-by: Atish Patra &lt;atishp@rivosinc.com&gt;
    > Reviewed-by: Anup Patel &lt;anup@brainfault.org&gt;

+ lib: sbi_pmu: PMU raw event v2 support (@Atish Patra in [d8a483fc7fd05f7](https://github.com/sophgo/opensbi/commit/d8a483fc7fd05f7) at 2024-12-02 04:22:04)
    > As per the updated ISA specification and SBI PMU v3.0, lower 56
    > bits are available for the platform to implement mhpmeventX
    > encoding. Implement the PMU raw event V2 support defined in SBI
    > v3.0 which allows more bits for platforms to encode the raw events.
    > Signed-off-by: Atish Patra &lt;atishp@rivosinc.com&gt;
    > Reviewed-by: Anup Patel &lt;anup@brainfault.org&gt;

+ Makefile: Fix POSIX grep for multiple patterns (@Igor Melnikov in [40e725da031ccdc](https://github.com/sophgo/opensbi/commit/40e725da031ccdc) at 2024-12-01 07:02:18)
    > grep -e &quot;-mstrict-align\|-mno-unaligned-access&quot; makes use of GNU grep&#x27;s
    > backslash-escaped alternation operator \| which is available in basic
    > regular expression syntax (BRE) mode.
    > However, in POSIX grep&#x27;s BRE mode | is an ordinary character which, when
    > backslash-escaped, matches itself. Therefore, the search pattern becomes
    > a plain string &#x27;-mstrict-align|-mno-unaligned-access&#x27; which obviously
    > never matches the expected error and CC_SUPPORT_STRICT_ALIGN is always set
    > to y.
    > When cross-compiling with LLVM on amd64-unknown-openbsd7.6 host for
    > riscv64-unknown-elf target this results in a compilation error:
    > clang: error: unsupported option &#x27;-mno-unaligned-access&#x27; for target
    > &#x27;riscv64-unknown-elf&#x27;
    > Using multiple -e options for this case maintains consistent behaviour
    > across different grep implementations and fixes the issue.
    > Signed-off-by: Igor Melnikov &lt;imel@purelymail.com&gt;
    > Reviewed-by: Anup Patel &lt;anup@brainfault.org&gt;

+ lib: utils/timer: Use fdt_driver for initialization (@Samuel Holland in [a387a8dff05bd43](https://github.com/sophgo/opensbi/commit/a387a8dff05bd43) at 2024-11-28 12:27:20)
    > The timer driver subsystem does not need any extra data, so it can use
    > &#x60;struct fdt_driver&#x60; directly. The generic fdt_timer_init() performs a
    > best-effort initialization of all matching DT nodes.
    > Signed-off-by: Samuel Holland &lt;samuel.holland@sifive.com&gt;
    > Reviewed-by: Anup Patel &lt;anup@brainfault.org&gt;

+ lib: utils/serial: Use fdt_driver for initialization (@Samuel Holland in [a524f0a507de18f](https://github.com/sophgo/opensbi/commit/a524f0a507de18f) at 2024-11-28 12:22:58)
    > The serial driver subsystem does not need any extra data, so it can use
    > &#x60;struct fdt_driver&#x60; directly. The generic fdt_serial_init() first
    > attempts to match the chosen stdout device, and upon failure matches the
    > first available serial device in the DT. It is a fatal error if no such
    > device is found. This matches the behavior of fdt_driver_init_one().
    > Signed-off-by: Samuel Holland &lt;samuel.holland@sifive.com&gt;
    > Reviewed-by: Anup Patel &lt;anup@brainfault.org&gt;

+ lib: utils/reset: Use fdt_driver for initialization (@Samuel Holland in [6d9ad492dbfdda0](https://github.com/sophgo/opensbi/commit/6d9ad492dbfdda0) at 2024-11-28 12:18:17)
    > The reset driver subsystem does not need any extra data, so it can use
    > &#x60;struct fdt_driver&#x60; directly. The generic fdt_reset_init() performs a
    > best-effort initialization of all matching DT nodes. Platform-specific
    > logic expects exactly one DT node to match a single driver. This is
    > accomplished by using fdt_driver_init_one() with a local list containing
    > that one driver.
    > Signed-off-by: Samuel Holland &lt;samuel.holland@sifive.com&gt;
    > Reviewed-by: Anup Patel &lt;anup@brainfault.org&gt;

+ lib: utils/regmap: Use fdt_driver for initialization (@Samuel Holland in [1f8db2f18ffb4ba](https://github.com/sophgo/opensbi/commit/1f8db2f18ffb4ba) at 2024-11-28 12:15:29)
    > The regmap driver subsystem does not need any extra data, so it can use
    > &#x60;struct fdt_driver&#x60; directly. It always initializes the driver for a
    > specific DT node.
    > Signed-off-by: Samuel Holland &lt;samuel.holland@sifive.com&gt;
    > Reviewed-by: Anup Patel &lt;anup@brainfault.org&gt;

+ lib: utils/ipi: Use fdt_driver for initialization (@Samuel Holland in [5fa510c5f69f42d](https://github.com/sophgo/opensbi/commit/5fa510c5f69f42d) at 2024-11-28 12:12:05)
    > The ipi driver subsystem does not need any extra data, so it can use
    > &#x60;struct fdt_driver&#x60; directly. The generic fdt_ipi_init() performs a
    > best-effort initialization of all matching DT nodes.
    > Signed-off-by: Samuel Holland &lt;samuel.holland@sifive.com&gt;
    > Reviewed-by: Anup Patel &lt;anup@brainfault.org&gt;

+ lib: utils/i2c: Use fdt_driver for initialization (@Samuel Holland in [333133edaa8bfe0](https://github.com/sophgo/opensbi/commit/333133edaa8bfe0) at 2024-11-28 12:08:05)
    > The i2c driver subsystem does not need any extra data, so it can use
    > &#x60;struct fdt_driver&#x60; directly. It always initializes the driver for a
    > specific DT node.
    > Signed-off-by: Samuel Holland &lt;samuel.holland@sifive.com&gt;
    > Reviewed-by: Anup Patel &lt;anup@brainfault.org&gt;

+ lib: utils/gpio: Use fdt_driver for initialization (@Samuel Holland in [bef8f9b8068c6e5](https://github.com/sophgo/opensbi/commit/bef8f9b8068c6e5) at 2024-11-28 11:59:12)
    > FDT gpio drivers have an extra .xlate operation, so they need to embed
    > the &#x60;struct fdt_driver&#x60; inside the subsystem-specific type. The gpio
    > subsystem always initializes the driver for a specific DT node.
    > Signed-off-by: Samuel Holland &lt;samuel.holland@sifive.com&gt;
    > Reviewed-by: Anup Patel &lt;anup@brainfault.org&gt;

+ scripts/carray.sh: Allow referencing a struct member (@Samuel Holland in [10df2d6fb5dba48](https://github.com/sophgo/opensbi/commit/10df2d6fb5dba48) at 2024-11-28 11:53:36)
    > It can be useful to embed the objects referenced by a carray inside
    > another struct. To avoid type punning, the generated carray code must
    > use the correct type for the enclosing struct and member access to
    > compute the desired object address.
    > Signed-off-by: Samuel Holland &lt;samuel.holland@sifive.com&gt;
    > Reviewed-by: Anup Patel &lt;anup@brainfault.org&gt;

+ scripts/carray.sh: Avoid useless use of cat (@Samuel Holland in [bb008e5d2706992](https://github.com/sophgo/opensbi/commit/bb008e5d2706992) at 2024-11-28 11:47:54)
    > awk(1) takes input files as positional arguments, so there is no need
    > to read the file with cat(1).
    > Signed-off-by: Samuel Holland &lt;samuel.holland@sifive.com&gt;
    > Reviewed-by: Anup Patel &lt;anup@brainfault.org&gt;

+ lib: utils/fdt: Add helpers for generic driver initialization (@Samuel Holland in [1ccc52c427f3f3b](https://github.com/sophgo/opensbi/commit/1ccc52c427f3f3b) at 2024-11-28 11:43:05)
    > Currently, each driver subsystem contains its own code for matching
    > drivers against the platform&#x27;s devicetree blob. This bloats firmware
    > size because the several FDT scanning loops are almost exact copies of
    > each other, and is confusing because the loops do have some subtle
    > differences. Furthermore, the existing match algorithm is inefficient:
    > it scans the FDT structure separately for each driver in the list. A
    > faster algorithm scans the FDT blob only once, matching all drivers in
    > the list for each &#x60;compatible&#x60; property seen.
    > Add new helpers implementing this faster algorithm. Since they must
    > iterate through the list of drivers, the driver structure cannot be
    > opaque. However, since the driver list is an array of pointers, the
    > &#x60;struct fdt_driver&#x60; can be embedded in a subsystem-specific driver
    > structure if needed. These three helpers cover all existing use cases
    > for driver initialization within OpenSBI.
    > An additional benefit of centralized driver initialization is the
    > consistent use of fdt_node_is_enabled().
    > Signed-off-by: Samuel Holland &lt;samuel.holland@sifive.com&gt;
    > Reviewed-by: Anup Patel &lt;anup@brainfault.org&gt;

+ treewide: Make carray arrays const and NULL-terminated (@Samuel Holland in [df1c1000014049d](https://github.com/sophgo/opensbi/commit/df1c1000014049d) at 2024-11-28 11:39:17)
    > This allows the compiler to generate significantly better code, because
    > it does not have to maintain either the loop counter or loop limit. Plus
    > there are half as many symbols to relocate. This also simplifies passing
    > carray arrays to helper functions.
    > Signed-off-by: Samuel Holland &lt;samuel.holland@sifive.com&gt;
    > Reviewed-by: Anup Patel &lt;anup@brainfault.org&gt;

+ sbi: fwft: clear the config lock when warm boot (@Nick Hu in [23ef9c5f00b81cf](https://github.com/sophgo/opensbi/commit/23ef9c5f00b81cf) at 2024-11-28 06:43:38)
    > The hotplug cpu should clear the fwft config&#x27;s SBI_FWFT_SET_FLAG_LOCK
    > in the warm boot flow otherwise the cpu can&#x27;t set the menvcfg.sse by
    > SBI_EXT_FWFT_SET sbi call and cause the illegal instruction when
    > accessing the CSR_SSP in kernel.
    > Signed-off-by: Nick Hu &lt;nick.hu@sifive.com&gt;
    > Reviewed-by: Anup Patel &lt;anup@brainfault.org&gt;

+ lib: sbi_irqchip: Set the IRQ handler when registering a chip (@Samuel Holland in [111772353f4a334](https://github.com/sophgo/opensbi/commit/111772353f4a334) at 2024-11-28 06:21:56)
    > In addition to saving some code size, this moves the decision about
    > setting the top-level external interrupt handler to the irqchip core,
    > not the specific driver, which would be needed to support chained
    > interrupt handlers.
    > Signed-off-by: Samuel Holland &lt;samuel.holland@sifive.com&gt;
    > Reviewed-by: Anup Patel &lt;anup@brainfault.org&gt;

+ platform: Drop irqchip warm init and exit hooks (@Samuel Holland in [678f5909a3fe54d](https://github.com/sophgo/opensbi/commit/678f5909a3fe54d) at 2024-11-28 06:16:36)
    > Now that driver lifecycle is managed from within the SBI irqchip core,
    > platforms need only to initialize the driver once during cold init.
    > Remove the remaining platform hooks that are no longer used.
    > Signed-off-by: Samuel Holland &lt;samuel.holland@sifive.com&gt;
    > Reviewed-by: Anup Patel &lt;anup@brainfault.org&gt;

+ lib: sbi_irqchip: Call driver warm_init from SBI core (@Samuel Holland in [2dd6eaf680556e7](https://github.com/sophgo/opensbi/commit/2dd6eaf680556e7) at 2024-11-28 06:10:17)
    > Currently, each platform keeps track of which irqchip driver is in use
    > and calls its warm init function. Since the generic platform may use
    > multiple irqchip drivers, it has logic to track an array of drivers.
    > The code is simplified and made common across platforms by treating warm
    > init and exit as properties of the driver, not the platform. Then the
    > platform&#x27;s only role is to select and prepare a driver during cold boot.
    > For now, only add a .warm_init hook, since none of the existing drivers
    > need an .exit hook. It could be added in the future if needed.
    > Signed-off-by: Samuel Holland &lt;samuel.holland@sifive.com&gt;
    > Reviewed-by: Anup Patel &lt;anup@brainfault.org&gt;

+ lib: sbi_irqchip: Register devices during cold init (@Samuel Holland in [e3e5686ef903d03](https://github.com/sophgo/opensbi/commit/e3e5686ef903d03) at 2024-11-28 06:07:25)
    > Have the SBI irqchip core keep track of registered irqchip devices. This
    > is useful for any callbacks the irqchip driver may have, such as for
    > warm initialization, the external interrupt handler function, and any
    > future support for handling external interrupts (beyond IPIs) in M-mode.
    > This improves on the tracking done in fdt_irqchip.c, as it tracks device
    > instances, not just drivers, so callbacks can target a specific device.
    > Signed-off-by: Samuel Holland &lt;samuel.holland@sifive.com&gt;
    > Reviewed-by: Anup Patel &lt;anup@brainfault.org&gt;

+ lib: utils/irqchip: Move per-hart data from fdt_plic to plic (@Samuel Holland in [56fddce83f163e5](https://github.com/sophgo/opensbi/commit/56fddce83f163e5) at 2024-11-28 06:05:01)
    > The per-hart PLIC pointer is not really specific to FDT platforms. Move
    > it into the main driver and drop the extra wrapper functions.
    > Signed-off-by: Samuel Holland &lt;samuel.holland@sifive.com&gt;
    > Reviewed-by: Anup Patel &lt;anup@brainfault.org&gt;

+ lib: utils/irqchip: plic: Common PM save/restore (@Samuel Holland in [c6c22f00f457264](https://github.com/sophgo/opensbi/commit/c6c22f00f457264) at 2024-11-28 05:58:38)
    > Move the PLIC save/restore functions inside the driver, so they can be
    > reused on any platform that needs them. The memory needed to store the
    > PLIC context is also allocated by the driver. The PM data cannot be
    > completely encapsulated, as some platforms (including Allwinner D1) need
    > to program the IRQ enable status to a sideband interrupt controller for
    > wakeup capability.
    > Signed-off-by: Samuel Holland &lt;samuel.holland@sifive.com&gt;
    > Reviewed-by: Anup Patel &lt;anup@brainfault.org&gt;

+ lib: utils/irqchip: plic: Provide a hartindex to context map (@Samuel Holland in [69448a07906523c](https://github.com/sophgo/opensbi/commit/69448a07906523c) at 2024-11-28 04:06:46)
    > This removes platform-specific arguments to plic_warm_irqchip_init(),
    > which makes the driver independent from the platform after cold init,
    > and allows for further refactoring.
    > Signed-off-by: Samuel Holland &lt;samuel.holland@sifive.com&gt;
    > Reviewed-by: Anup Patel &lt;anup@brainfault.org&gt;

+ lib: utils/irqchip: plic: Move delegation to base PLIC driver (@Samuel Holland in [c26e3fd2ed655c1](https://github.com/sophgo/opensbi/commit/c26e3fd2ed655c1) at 2024-11-28 04:05:11)
    > This needs to be in the base PLIC driver as part of the power management
    > save/restore flow.
    > This is also in preparation for moving the PLIC information in the
    > scratch area to the base PLIC driver. After that change, the FDT PLIC
    > layer will be unable to look up the &#x60;struct plic_data&#x60; after cold boot.
    > Signed-off-by: Samuel Holland &lt;samuel.holland@sifive.com&gt;
    > Reviewed-by: Anup Patel &lt;anup@brainfault.org&gt;

+ lib: utils/irqchip: plic: Allow enabling IRQs by default (@Samuel Holland in [a786aed08dbc203](https://github.com/sophgo/opensbi/commit/a786aed08dbc203) at 2024-11-28 04:05:10)
    > Unlike other platforms, Ariane and OpenPiton enable all IRQs by default.
    > This was described in commit b44e844880d0 (&quot;Add support for Ariane FPGA
    > SoC&quot;) as &quot;due to some issue of the design.&quot; Add this workaround behind a
    > flag in plic_warm_irqchip_init(), so every platform can use the same
    > warm init function.
    > Signed-off-by: Samuel Holland &lt;samuel.holland@sifive.com&gt;
    > Reviewed-by: Anup Patel &lt;anup@brainfault.org&gt;

## [linux-riscv(sg2044-dev-6.12)](https://github.com/sophgo/linux-riscv/tree/sg2044-dev-6.12)

+ sophgo/veth: Get ip address from /proc/sgdrv/vethip (@xiangwen.jiang in [d93d203ad2081eb](https://github.com/sophgo/linux-riscv/commit/d93d203ad2081eb) at 2025-01-08 09:48:56)
    > Signed-off-by: xiangwen.jiang &lt;xiangwen.jiang@sophgo.com&gt;

+ irqchip/thead-c900-aclint-sswi: Add ACPI support (@Jingyu Li in [d3302993751b299](https://github.com/sophgo/linux-riscv/commit/d3302993751b299) at 2025-01-08 07:32:46)
    > Add ACPI support in ACLINT-SSWI early probe. Treat ACLINT-SSWI as a fake IMSIC
    > that can only handle IPIs in a software manner. Use the IMSIC-related fields in
    > the MADT table to obtain the register base address of ACLINT-SSWI.
    > Note that when booting with ACPI, ACLINT-SSWI cannot coexist with the standard
    > IMSIC driver, as the IMSIC driver parses the ACPI table entries before ACLINT-SSWI,
    > resulting in error logs. Therefore, we disable the IMSIC-related kernel drivers.
    > Signed-off-by: Jingyu Li &lt;jingyu.li01@sophgo.com&gt;

+ irqchip/sg2044-msi: Handle non-512 numbers of MSI vectors cases. (@Jingyu Li in [01fe4f2e5c9b603](https://github.com/sophgo/linux-riscv/commit/01fe4f2e5c9b603) at 2025-01-06 13:41:52)
    > Add the property &quot;sophgo,msi-num-vecs&quot; to specify the number of MSI vectors to
    > avoid error log occur when getting irqs in turn, such as:
    > [    3.464650] sg2044-msi 7ee00000.msi-controller: error -ENXIO: IRQ msi504 not found
    > Signed-off-by: Jingyu Li &lt;jingyu.li01@sophgo.com&gt;

+ dts: Change rp memory layout for BM1690 (@bokai.zeng in [15dd7947a580593](https://github.com/sophgo/linux-riscv/commit/15dd7947a580593) at 2025-01-06 13:07:08)
    > Signed-off-by: bokai.zeng &lt;bokai.zeng@sophgo.com&gt;

+ dts: Keep pcie msi 8 interrupts (@bokai.zeng in [e2fc96e27965df3](https://github.com/sophgo/linux-riscv/commit/e2fc96e27965df3) at 2025-01-06 13:05:42)
    > Signed-off-by: bokai.zeng &lt;bokai.zeng@sophgo.com&gt;

+ pci: Compatible with acpi and dtb (@kun-chang in [c7fef95f75ea8d4](https://github.com/sophgo/linux-riscv/commit/c7fef95f75ea8d4) at 2025-01-06 03:25:42)
    > - When ACPI CONFIG is ture, the kernel supports ACPI and DTB.
    > - When ACPI CONFIG is false, the kernel compiles through and
    > the kernel only supports DTB.
    > Signed-off-by: kun-chang &lt;kun.chang@sophgo.com&gt;

+ acpi: Add MSI controller&#x27;s HID to acpi_honor_dep_ids (@kun-chang in [a6fb7809d388f43](https://github.com/sophgo/linux-riscv/commit/a6fb7809d388f43) at 2025-01-04 05:04:54)
    > - We found that the previous dependency description for PCI was incomplete,
    > as there is a description of INTX functionality in PCI in ACPI, resulting
    > in the &quot;honor_deps&quot; being seen as true. In fact, now the &#x27;_DEP&#x27; described
    > in the ACPI table does not exist in &quot;acpi_honor_dep_ids&quot; when checked in
    > the kernel, and this dependency is invalid. When we remove the description
    > of INTX functionality in ACPI, the previous PCI device will still be probed
    > before the MSI controller and unable to function properly.
    > - We should ensure that all dependencies added to the device are valid, and all
    > dependencies are probed before the device.
    > - Like:&quot;Interrupt controller &lt;-- Link Device + MSI Controller &lt;-- PCI Host bridge&quot;.
    > Signed-off-by: kun-chang &lt;kun.chang@sophgo.com&gt;

+ pci: Fix pci_alloc_irq_vectors panic (@Jingyu Li in [e2f8fc362ce88ee](https://github.com/sophgo/linux-riscv/commit/e2f8fc362ce88ee) at 2025-01-04 05:04:42)
    > Commit bc7acc0 (of: property: fw_devlink: Do not use interrupt-parent
    > directly) dropped the explicit fw_devlink handling of &quot;interrupt-parent&quot;.
    > SG2044 PCIe device depends on the MSI controller, so we modify the
    > &quot;interrupt-parent&quot; to &quot;msi-parent&quot; to ensure the probe order and device
    > link. The following error log has been fixed.
    > [    1.752691] ------------[ cut here ]------------
    > [    1.752696] kernel BUG at kernel/irq/msi.c:685!
    > [    1.752702] Kernel BUG [sophgo#1]
    > [    1.752704] Modules linked in:
    > [    1.752711] CPU: 0 UID: 0 PID: 1 Comm: swapper/0 Not tainted 6.12.7 sophgo#16
    > [    1.752716] Hardware name: SOPHGO SOPHGO SG2044 EVB/SOPHGO SG2044 EVB, BIOS V1.0 Not Set
    > [    1.752718] epc : msi_domain_activate+0x74/0x7e
    > [    1.752732]  ra : msi_domain_activate+0x38/0x7e
    > [    1.752736] epc : ffffffff800b26bc ra : ffffffff800b2680 sp : ffff8f8000313430
    > [    1.752739]  gp : ffffffff81c6f740 tp : ffffaf80806a0000 t0 : 0000000000000000
    > [    1.752741]  t1 : 0000000000000000 t2 : 0000000000000000 s0 : ffff8f8000313470
    > [    1.752743]  s1 : ffffaf80843baa30 a0 : ffffffffffffffda a1 : 0000000000000000
    > [    1.752745]  a2 : 0000000000000000 a3 : 0000000000000000 a4 : ffffaf80843baa00
    > [    1.752746]  a5 : 0000000000000000 a6 : 0000000000000000 a7 : 0000000000000000
    > [    1.752748]  s2 : 000000000000000e s3 : 0000000000000000 s4 : ffffaf8085bb3b00
    > [    1.752750]  s5 : ffff8f8000313608 s6 : 0000000000000000 s7 : ffffaf8086f630c8
    > [    1.752752]  s8 : fffffffffbffffff s9 : ffffffff81b964b0 s10: 0000000000000000
    > [    1.752754]  s11: 0000000000000000 t3 : 0000000000000000 t4 : 0000000000000000
    > [    1.752755]  t5 : 0000000000000000 t6 : 0000000000000000
    > [    1.752757] status: 0000000200000120 badaddr: 0000000000000000 cause: 0000000000000003
    > [    1.752760] [&lt;ffffffff800b26bc&gt;] msi_domain_activate+0x74/0x7e
    > [    1.752766] [&lt;ffffffff800adf96&gt;] __irq_domain_activate_irq+0x46/0x96
    > [    1.752770] [&lt;ffffffff800afd14&gt;] irq_domain_activate_irq+0x38/0x58
    > [    1.752774] [&lt;ffffffff800b2966&gt;] __msi_domain_alloc_irqs+0x212/0x39a
    > [    1.752778] [&lt;ffffffff800b324e&gt;] __msi_domain_alloc_locked+0x12c/0x16a
    > [    1.752782] [&lt;ffffffff800b3ba8&gt;] msi_domain_alloc_irqs_all_locked+0x54/0xaa
    > [    1.752787] [&lt;ffffffff8070cb38&gt;] pci_msi_setup_msi_irqs+0x2c/0x46
    > [    1.752795] [&lt;ffffffff8070b860&gt;] __pci_enable_msi_range+0x23c/0x418
    > [    1.752798] [&lt;ffffffff8070a778&gt;] pci_alloc_irq_vectors_affinity+0xec/0x100
    > [    1.752802] [&lt;ffffffff8070a7a6&gt;] pci_alloc_irq_vectors+0x1a/0x2a
    > [    1.752804] [&lt;ffffffff8070d5da&gt;] pcie_portdrv_probe+0x1a2/0x5c0
    > [    1.752809] [&lt;ffffffff807006bc&gt;] local_pci_probe+0x40/0x88
    > [    1.752813] [&lt;ffffffff8070142e&gt;] pci_device_probe+0xb4/0x232
    > [    1.752816] [&lt;ffffffff80879620&gt;] really_probe+0x9e/0x356
    > [    1.752822] [&lt;ffffffff80879954&gt;] __driver_probe_device+0x7c/0x13c
    > [    1.752825] [&lt;ffffffff80879af0&gt;] driver_probe_device+0x38/0xd0
    > [    1.752829] [&lt;ffffffff80879c12&gt;] __device_attach_driver+0x8a/0xec
    > [    1.752832] [&lt;ffffffff808772f6&gt;] bus_for_each_drv+0x70/0xd0
    > [    1.752835] [&lt;ffffffff80879fc0&gt;] __device_attach+0x94/0x196
    > [    1.752838] [&lt;ffffffff8087a0dc&gt;] device_attach+0x1a/0x24
    > [    1.752842] [&lt;ffffffff806f2188&gt;] pci_bus_add_device+0x72/0xf8
    > [    1.752849] [&lt;ffffffff806f224a&gt;] pci_bus_add_devices+0x3c/0x7e
    > [    1.752852] [&lt;ffffffff806f6020&gt;] pci_host_probe+0x96/0xdc
    > [    1.752857] [&lt;ffffffff80d68e0a&gt;] sophgo_dw_pcie_probe+0x1042/0x10a0
    > [    1.752863] [&lt;ffffffff8087c8a0&gt;] platform_probe+0x5e/0xc6
    > [    1.752868] [&lt;ffffffff80879620&gt;] really_probe+0x9e/0x356
    > [    1.752871] [&lt;ffffffff80879954&gt;] __driver_probe_device+0x7c/0x13c
    > [    1.752874] [&lt;ffffffff80879af0&gt;] driver_probe_device+0x38/0xd0
    > [    1.752877] [&lt;ffffffff80879d62&gt;] __driver_attach+0xee/0x1e8
    > [    1.752880] [&lt;ffffffff8087722e&gt;] bus_for_each_dev+0x6c/0xc4
    > [    1.752883] [&lt;ffffffff80878f7a&gt;] driver_attach+0x26/0x34
    > [    1.752886] [&lt;ffffffff808785b0&gt;] bus_add_driver+0x110/0x23e
    > [    1.752889] [&lt;ffffffff8087ae46&gt;] driver_register+0x52/0x106
    > [    1.752893] [&lt;ffffffff8087c436&gt;] __platform_driver_register+0x28/0x34
    > [    1.752897] [&lt;ffffffff80e3d2fc&gt;] sophgo_dw_pcie_driver_init+0x22/0x2c
    > [    1.752910] [&lt;ffffffff8000298a&gt;] do_one_initcall+0x5c/0x1e4
    > [    1.752913] [&lt;ffffffff80e0194c&gt;] kernel_init_freeable+0x296/0x316
    > [    1.752917] [&lt;ffffffff80d712d0&gt;] kernel_init+0x2a/0x17e
    > [    1.752922] [&lt;ffffffff80d7c0ca&gt;] ret_from_fork+0xe/0x1c
    > [    1.752933] Code: eb99 70e2 7442 74a2 4501 6121 4581 4701 4781 8082 (9002) e097
    > [    1.752938] ---[ end trace 0000000000000000 ]---
    > [    1.752941] Kernel panic - not syncing: Fatal exception in interrupt
    > [    1.752943] SMP: stopping secondary CPUs
    > [    2.127393] ---[ end Kernel panic - not syncing: Fatal exception in interrupt ]---
    > Signed-off-by: Jingyu Li &lt;jingyu.li01@sophgo.com&gt;

+ of: Fix fdt CRC check failed when ACPI is enabled (@Jingyu Li in [3e9fce22cbaf566](https://github.com/sophgo/linux-riscv/commit/3e9fce22cbaf566) at 2025-01-04 05:03:04)
    > The EFI Stub will generate an empty DTB and append the /chosen node to it when
    > booting ARM64 and RISC-V platfroms with ACPI enabled. That means the DTB is not
    > empty.
    > The commit 7b937cc ignores the above ACPI boot situation, which forces the fdt
    > to be NULL when ACPI is enabled, resulting in the following issue.
    > [    3.491475] OF: fdt: not creating &#x27;/sys/firmware/fdt&#x27;: CRC check failed
    > Signed-off-by: Jingyu Li &lt;jingyu.li01@sophgo.com&gt;

+ acpi: Enable BGRT handling on RISC-V (@Jingyu Li in [ea97dc6fbd7c105](https://github.com/sophgo/linux-riscv/commit/ea97dc6fbd7c105) at 2025-01-04 04:26:13)
    > Add ACPI BGRT support on RISC-V, allowing the display of the boot image from the
    > ACPI table during startup.
    > Signed-off-by: Jingyu Li &lt;jingyu.li01@sophgo.com&gt;

+ scripts: Workaround find libssl failed (@Xiaoguang Xing in [0971a3a77c6c53d](https://github.com/sophgo/linux-riscv/commit/0971a3a77c6c53d) at 2025-01-04 04:26:13)
    > Signed-off-by: Xiaoguang Xing &lt;xiaoguang.xing@sophgo.com&gt;

+ tools: Add pmbus tool for sophgo power management (@Xiaoguang Xing in [d5ea5c2b23fb547](https://github.com/sophgo/linux-riscv/commit/d5ea5c2b23fb547) at 2025-01-04 04:26:12)
    > Signed-off-by: xingzhe.ma &lt;xingzhe.ma@sophgo.com&gt;

+ tools: Add efuse code used in user-mode (@zhencheng.zhang in [ba1ed16f8040cb2](https://github.com/sophgo/linux-riscv/commit/ba1ed16f8040cb2) at 2025-01-04 04:26:12)
    > - support efuse writing, each bit can only be written onece
    > - support efuse reading
    > - note: addr is the Hard Macro address not Ecc read address
    > Signed-off-by: zhencheng.zhang &lt;zhencheng.zhang@sophgo.com&gt;

+ Revert &quot;sched: Remove sched_setscheduler*() EXPORTs&quot; (@Xiaoguang Xing in [52c7876e2e22c38](https://github.com/sophgo/linux-riscv/commit/52c7876e2e22c38) at 2025-01-04 04:26:12)
    > This reverts commit 616d91b68cd56bcb1954b6a5af7d542401fde772.
    > The sophgo multimedia module requires the thread priority setting
    > function.

+ scripts: Make kernel headers deb package fatter (@Xiaoguang Xing in [335172edcfa35df](https://github.com/sophgo/linux-riscv/commit/335172edcfa35df) at 2025-01-04 04:26:12)
    > Signed-off-by: Xiaoguang Xing &lt;xiaoguang.xing@sophgo.com&gt;

+ tools: Add AP/RP/TP ddr/axi sram R/W performance test for SOPHGO BM1690 (@kai.ma in [0228f7a50d13544](https://github.com/sophgo/linux-riscv/commit/0228f7a50d13544) at 2025-01-04 04:26:12)
    > Signed-off-by: kai.ma &lt;kai.ma@sophgo.com&gt;

+ drivers: Implement some algorithms on snps,designware (@Xiaoguang Xing in [ea71b7918fc496a](https://github.com/sophgo/linux-riscv/commit/ea71b7918fc496a) at 2025-01-04 04:26:11)
    > Basically complete these algorithms include rsa,
    > ecdh(192, 256, 384), ecdsa(192, 256, 384).
    > But ecdsa 521 curve has not been implemented yet.
    > Note that the driver can successfully probe and register,
    > but can not pass testmgr tests provided by linux kernel.
    > Signed-off-by: ruoxi.zhang &lt;ruoxi.zhang@sophgo.com&gt;

+ riscv: Add defconfig for SOPHGO SG2044 and BM1690 (@Xiaoguang Xing in [21b7968330254ba](https://github.com/sophgo/linux-riscv/commit/21b7968330254ba) at 2025-01-04 04:26:11)
    > Signed-off-by: Xiaoguang Xing &lt;xiaoguang.xing@sophgo.com&gt;

+ drivers: Add mfd/mmc/spi/serial ACPI for SOPHGO SG2044 and BM1690 (@Xiaoguang Xing in [0941b1ace5050d8](https://github.com/sophgo/linux-riscv/commit/0941b1ace5050d8) at 2025-01-04 04:26:11)
    > Signed-off-by: kun-chang &lt;kun.chang@sophgo.com&gt;

+ riscv: Add dts for SOPHGO SG2044 and BM1690 (@Xiaoguang Xing in [0658dd8ce95c883](https://github.com/sophgo/linux-riscv/commit/0658dd8ce95c883) at 2025-01-04 04:26:11)
    > Signed-off-by: Xiaoguang Xing &lt;xiaoguang.xing@sophgo.com&gt;
    > Signed-off-by: dong.yang &lt;dong.yang@sophgo.com&gt;
    > Signed-off-by: Chao Wei &lt;chao.wei@sophgo.com&gt;
    > Signed-off-by: fengchun.li &lt;fengchun.li@sophgo.com&gt;
    > Signed-off-by: xiangwen.jiang &lt;xiangwen.jiang@sophgo.com&gt;
    > Signed-off-by: chengjun.li &lt;chengjun.li@sophgo.com&gt;
    > Signed-off-by: kun-chang &lt;kun.chang@sophgo.com&gt;
    > Signed-off-by: zhencheng.zhang &lt;zhencheng.zhang@sophgo.com&gt;
    > Signed-off-by: tingzhu.wang &lt;tingzhu.wang@sophgo.com&gt;
    > Signed-off-by: kai.ma &lt;kai.ma@sophgo.com&gt;
    > Signed-off-by: pbw &lt;bowen.pang01@sophgo.com&gt;
    > Signed-off-by: yujing.shen &lt;yujing.shen@sophgo.com&gt;
    > Signed-off-by: wenwen.zhu &lt;wenwen.zhu@sophgo.com&gt;

+ drivers: Add pcie support for SOPHGO SG2044 and BM1690 (@Xiaoguang Xing in [d4d642bf2f1bb29](https://github.com/sophgo/linux-riscv/commit/d4d642bf2f1bb29) at 2025-01-04 04:26:10)
    > Signed-off-by: fengchun.li &lt;fengchun.li@sophgo.com&gt;
    > Signed-off-by: kun-chang &lt;kun.chang@sophgo.com&gt;

+ drivers: Add pwm support for SOPHGO SG2044 and BM1690 (@Xiaoguang Xing in [d210ad7368e91e2](https://github.com/sophgo/linux-riscv/commit/d210ad7368e91e2) at 2025-01-04 04:26:10)
    > Signed-off-by: ruoxi.zhang &lt;ruoxi.zhang@sophgo.com&gt;
    > Signed-off-by: kun-chang &lt;kun.chang@sophgo.com&gt;

+ drivers: Add TPU/RXU/veth support for SOPHGO BM1690 (@Xiaoguang Xing in [544c2d508af9c68](https://github.com/sophgo/linux-riscv/commit/544c2d508af9c68) at 2025-01-04 04:26:10)
    > Signed-off-by: tingzhu.wang &lt;tingzhu.wang@sophgo.com
    > Signed-off-by: bokai.zeng &lt;bokai.zeng@sophgo.com&gt;
    > Signed-off-by: kai.ma &lt;kai.ma@sophgo.com&gt;
    > Signed-off-by: xiangwen.jiang &lt;xiangwen.jiang@sophgo.com&gt;

+ drivers: Add virtual tty support for SOPHGO BM1690 (@Xiaoguang Xing in [3ffe1e3f128c95b](https://github.com/sophgo/linux-riscv/commit/3ffe1e3f128c95b) at 2025-01-04 04:26:10)
    > Signed-off-by: pbw &lt;bowen.pang01@sophgo.com&gt;

+ drivers: Add MSI controller support for SOPHGO SG2044 and BM1690 (@Xiaoguang Xing in [0eca3209361e6f5](https://github.com/sophgo/linux-riscv/commit/0eca3209361e6f5) at 2025-01-04 04:26:10)
    > Signed-off-by: kun-chang &lt;kun.chang@sophgo.com&gt;

+ drivers: Add p2p ethernet support for SOPHGO SG2044 and BM1690 (@Xiaoguang Xing in [17a03ae505cec31](https://github.com/sophgo/linux-riscv/commit/17a03ae505cec31) at 2025-01-04 04:26:09)
    > Signed-off-by: chengjun.li &lt;chengjun.li@sophgo.com&gt;

+ driver: Add ethernet for SOPHGO SG2044 and BM1690 (@Xiaoguang Xing in [e80af0ddea27750](https://github.com/sophgo/linux-riscv/commit/e80af0ddea27750) at 2025-01-04 04:26:00)
    > Signed-off-by: dong.yang &lt;dong.yang@sophgo.com&gt;
    > Signed-off-by: chengjun.li &lt;chengjun.li@sophgo.com&gt;

+ Revert &quot;net: stmmac: make stmmac_{probe|remove}_config_dt static&quot; (@Xiaoguang Xing in [7ed1e4030b91ab6](https://github.com/sophgo/linux-riscv/commit/7ed1e4030b91ab6) at 2025-01-04 03:58:06)
    > This reverts commit b2504f649bda92094dedfb721c7d49f9a348d500.

+ drivers: Add efuse support for SOPHGO SG2044 and BM1690 (@Xiaoguang Xing in [e4ec848acc8dbcc](https://github.com/sophgo/linux-riscv/commit/e4ec848acc8dbcc) at 2025-01-04 03:56:56)
    > Signed-off-by: zhencheng.zhang &lt;zhencheng.zhang@sophgo.com&gt;

+ drivers: Add spi-nor flash support for SOPHGO SG2044 and BM1690 (@Xiaoguang Xing in [7ce48ce9ad6e50a](https://github.com/sophgo/linux-riscv/commit/7ce48ce9ad6e50a) at 2025-01-04 03:56:43)
    > Signed-off-by: zhencheng.zhang &lt;zhencheng.zhang@sophgo.com&gt;

+ drivers: Add reset support for SOPHGO SG2044 and BM1690 (@Xiaoguang Xing in [f370fe0a3c9efe4](https://github.com/sophgo/linux-riscv/commit/f370fe0a3c9efe4) at 2025-01-04 03:55:51)
    > Signed-off-by: dong.yang &lt;dong.yang@sophgo.com&gt;

+ drivers: Add pinctrl support for SOPHGO SG2044 and BM1690 (@Xiaoguang Xing in [1cf34cc0c7c7bfe](https://github.com/sophgo/linux-riscv/commit/1cf34cc0c7c7bfe) at 2025-01-04 03:55:41)
    > Signed-off-by: dong.yang &lt;dong.yang@sophgo.com&gt;

+ drivers: Add clock support for SOPHGO SG2044 and BM1690 (@Xiaoguang Xing in [cf259b07a97cc13](https://github.com/sophgo/linux-riscv/commit/cf259b07a97cc13) at 2025-01-04 03:55:25)
    > Signed-off-by: dong.yang &lt;dong.yang@sophgo.com&gt;

+ riscv: Workaround cpu hang when swith mmu page table (@Xiaoguang Xing in [aaf4831ef686f2d](https://github.com/sophgo/linux-riscv/commit/aaf4831ef686f2d) at 2025-01-04 03:54:28)
    > Signed-off-by: Xiaoguang Xing &lt;xiaoguang.xing@sophgo.com&gt;

+ irqchip: add T-HEAD C900 ACLINT SSWI driver (@Inochi Amaoto in [8f39214546e4e95](https://github.com/sophgo/linux-riscv/commit/8f39214546e4e95) at 2025-01-02 23:02:46)
    > Add a driver for the T-HEAD C900 ACLINT SSWI device. This device allows
    > the system with T-HEAD cpus to send ipi via fast device interface.
    > Signed-off-by: Inochi Amaoto &lt;inochiama@gmail.com&gt;

+ dt-bindings: interrupt-controller: Add Sophgo SG2044 ACLINT SSWI (@Inochi Amaoto in [79fad6add9018d8](https://github.com/sophgo/linux-riscv/commit/79fad6add9018d8) at 2025-01-02 23:02:46)
    > Sophgo SG2044 has a new version of T-HEAD C920, which implement
    > a fully featured T-HEAD ACLINT device. This ACLINT device contains
    > a SSWI device to support fast S-mode IPI.
    > Add necessary compatible string for the T-HEAD ACLINT sswi device.
    > Link: https://www.xrvm.com/product/xuantie/C920
    > Signed-off-by: Inochi Amaoto &lt;inochiama@gmail.com&gt;
    > Reviewed-by: Conor Dooley &lt;conor.dooley@microchip.com&gt;

+ riscv: defconfig: Enable T-HEAD C900 ACLINT SSWI drivers (@Inochi Amaoto in [35ce38d5507b2fa](https://github.com/sophgo/linux-riscv/commit/35ce38d5507b2fa) at 2025-01-02 23:02:46)
    > Add support for T-HEAD C900 ACLINT SSWI irqchip.
    > Signed-off-by: Inochi Amaoto &lt;inochiama@gmail.com&gt;

+ ALSA: sh: Fix wrong argument order for copy_from_iter() (@Takashi Iwai in [f3e6eaf033f44ad](https://github.com/sophgo/linux-riscv/commit/f3e6eaf033f44ad) at 2025-01-02 09:34:26)
    > commit 66a0a2b0473c39ae85c44628d14e4366fdc0aa0d upstream.
    > Fix a brown paper bag bug I introduced at converting to the standard
    > iter helper; the arguments were wrongly passed and have to be
    > swapped.
    > Fixes: 9b5f8ee43e48 (&quot;ALSA: sh: Use standard helper for buffer accesses&quot;)
    > Reported-by: kernel test robot &lt;lkp@intel.com&gt;
    > Closes: https://lore.kernel.org/oe-kbuild-all/202412140019.jat5Dofr-lkp@intel.com/
    > Link: https://patch.msgid.link/20241220114417.5898-1-tiwai@suse.de
    > Signed-off-by: Takashi Iwai &lt;tiwai@suse.de&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ Linux 6.12.8 (@Greg Kroah-Hartman in [77f85ccd3618f32](https://github.com/sophgo/linux-riscv/commit/77f85ccd3618f32) at 2025-01-02 09:34:26)
    > Link: https://lore.kernel.org/r/20241230154218.044787220@linuxfoundation.org
    > Tested-by: Ronald Warsow &lt;rwarsow@gmx.de&gt;
    > Tested-by: Salvatore Bonaccorso &lt;carnil@debian.org&gt;
    > Tested-by: Florian Fainelli &lt;florian.fainelli@broadcom.com&gt;
    > Tested-by: Pavel Machek (CIP) &lt;pavel@denx.de&gt;
    > Tested-by: Shuah Khan &lt;skhan@linuxfoundation.org&gt;
    > Tested-by: Takeshi Ogasawara &lt;takeshi.ogasawara@futuring-girl.com&gt;
    > Tested-by: kernelci.org bot &lt;bot@kernelci.org&gt;
    > Tested-by: Linux Kernel Functional Testing &lt;lkft@linaro.org&gt;
    > Tested-by: Markus Reichelt &lt;lkt+2023@mareichelt.com&gt;
    > Tested-by: Harshit Mogalapalli &lt;harshit.m.mogalapalli@oracle.com&gt;
    > Tested-by: Ron Economos &lt;re@w6rz.net&gt;
    > Tested-by: Hardik Garg &lt;hargar@linux.microsoft.com&gt;
    > Tested-by: Justin M. Forbes &lt;jforbes@fedoraproject.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ Bluetooth: btusb: mediatek: change the conditions for ISO interface (@Chris Lu in [f5c5661f02b5539](https://github.com/sophgo/linux-riscv/commit/f5c5661f02b5539) at 2025-01-02 09:34:25)
    > commit defc33b5541e0a7e45cc2d99d72fbe80a597afc5 upstream.
    > Change conditions for Bluetooth driver claiming and releasing usb
    > ISO interface for MediaTek ISO data transmission.
    > Signed-off-by: Chris Lu &lt;chris.lu@mediatek.com&gt;
    > Signed-off-by: Luiz Augusto von Dentz &lt;luiz.von.dentz@intel.com&gt;
    > Cc: Fedor Pchelkin &lt;boddah8794@gmail.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ ALSA: ump: Shut up truncated string warning (@Takashi Iwai in [f59b81fe8df97f6](https://github.com/sophgo/linux-riscv/commit/f59b81fe8df97f6) at 2025-01-02 09:34:25)
    > commit ed990c07af70d286f5736021c6e25d8df6f2f7b0 upstream.
    > The recent change for the legacy substream name update brought a
    > compile warning for some compilers due to the nature of snprintf().
    > Use scnprintf() to shut up the warning since the truncation is
    > intentional.
    > Fixes: e29e504e7890 (&quot;ALSA: ump: Indicate the inactive group in legacy substream names&quot;)
    > Reported-by: kernel test robot &lt;lkp@intel.com&gt;
    > Closes: https://lore.kernel.org/oe-kbuild-all/202411300103.FrGuTAYp-lkp@intel.com/
    > Link: https://patch.msgid.link/20241130090009.19849-1-tiwai@suse.de
    > Signed-off-by: Takashi Iwai &lt;tiwai@suse.de&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ btrfs: check folio mapping after unlock in put_file_data() (@Boris Burkov in [dd8bbfe723778bf](https://github.com/sophgo/linux-riscv/commit/dd8bbfe723778bf) at 2025-01-02 09:34:25)
    > commit 0fba7be1ca6df2881e68386e5575fe096f33c4ca upstream.
    > When we call btrfs_read_folio() we get an unlocked folio, so it is possible
    > for a different thread to concurrently modify folio-&gt;mapping. We must
    > check that this hasn&#x27;t happened once we do have the lock.
    > CC: stable@vger.kernel.org # 6.12+
    > Reviewed-by: Qu Wenruo &lt;wqu@suse.com&gt;
    > Signed-off-by: Boris Burkov &lt;boris@bur.io&gt;
    > Signed-off-by: David Sterba &lt;dsterba@suse.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ btrfs: check folio mapping after unlock in relocate_one_folio() (@Boris Burkov in [d508e56270389b3](https://github.com/sophgo/linux-riscv/commit/d508e56270389b3) at 2025-01-02 09:34:25)
    > commit 3e74859ee35edc33a022c3f3971df066ea0ca6b9 upstream.
    > When we call btrfs_read_folio() to bring a folio uptodate, we unlock the
    > folio. The result of that is that a different thread can modify the
    > mapping (like remove it with invalidate) before we call folio_lock().
    > This results in an invalid page and we need to try again.
    > In particular, if we are relocating concurrently with aborting a
    > transaction, this can result in a crash like the following:
    > BUG: kernel NULL pointer dereference, address: 0000000000000000
    > PGD 0 P4D 0
    > Oops: 0000 [#1] SMP
    > CPU: 76 PID: 1411631 Comm: kworker/u322:5
    > Workqueue: events_unbound btrfs_reclaim_bgs_work
    > RIP: 0010:set_page_extent_mapped+0x20/0xb0
    > RSP: 0018:ffffc900516a7be8 EFLAGS: 00010246
    > RAX: ffffea009e851d08 RBX: ffffea009e0b1880 RCX: 0000000000000000
    > RDX: 0000000000000000 RSI: ffffc900516a7b90 RDI: ffffea009e0b1880
    > RBP: 0000000003573000 R08: 0000000000000001 R09: ffff88c07fd2f3f0
    > R10: 0000000000000000 R11: 0000194754b575be R12: 0000000003572000
    > R13: 0000000003572fff R14: 0000000000100cca R15: 0000000005582fff
    > FS:  0000000000000000(0000) GS:ffff88c07fd00000(0000) knlGS:0000000000000000
    > CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
    > CR2: 0000000000000000 CR3: 000000407d00f002 CR4: 00000000007706f0
    > DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
    > DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
    > PKRU: 55555554
    > Call Trace:
    > &lt;TASK&gt;
    > ? __die+0x78/0xc0
    > ? page_fault_oops+0x2a8/0x3a0
    > ? __switch_to+0x133/0x530
    > ? wq_worker_running+0xa/0x40
    > ? exc_page_fault+0x63/0x130
    > ? asm_exc_page_fault+0x22/0x30
    > ? set_page_extent_mapped+0x20/0xb0
    > relocate_file_extent_cluster+0x1a7/0x940
    > relocate_data_extent+0xaf/0x120
    > relocate_block_group+0x20f/0x480
    > btrfs_relocate_block_group+0x152/0x320
    > btrfs_relocate_chunk+0x3d/0x120
    > btrfs_reclaim_bgs_work+0x2ae/0x4e0
    > process_scheduled_works+0x184/0x370
    > worker_thread+0xc6/0x3e0
    > ? blk_add_timer+0xb0/0xb0
    > kthread+0xae/0xe0
    > ? flush_tlb_kernel_range+0x90/0x90
    > ret_from_fork+0x2f/0x40
    > ? flush_tlb_kernel_range+0x90/0x90
    > ret_from_fork_asm+0x11/0x20
    > &lt;/TASK&gt;
    > This occurs because cleanup_one_transaction() calls
    > destroy_delalloc_inodes() which calls invalidate_inode_pages2() which
    > takes the folio_lock before setting mapping to NULL. We fail to check
    > this, and subsequently call set_extent_mapping(), which assumes that
    > mapping !&#x3D; NULL (in fact it asserts that in debug mode)
    > Note that the &quot;fixes&quot; patch here is not the one that introduced the
    > race (the very first iteration of this code from 2009) but a more recent
    > change that made this particular crash happen in practice.
    > Fixes: e7f1326cc24e (&quot;btrfs: set page extent mapped after read_folio in relocate_one_page&quot;)
    > CC: stable@vger.kernel.org # 6.1+
    > Reviewed-by: Qu Wenruo &lt;wqu@suse.com&gt;
    > Signed-off-by: Boris Burkov &lt;boris@bur.io&gt;
    > Signed-off-by: David Sterba &lt;dsterba@suse.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ Bluetooth: btusb: mediatek: add intf release flow when usb disconnect (@Chris Lu in [cc569d791ab2a0d](https://github.com/sophgo/linux-riscv/commit/cc569d791ab2a0d) at 2025-01-02 09:34:25)
    > commit 489304e67087abddc2666c5af0159cb95afdcf59 upstream.
    > MediaTek claim an special usb intr interface for ISO data transmission.
    > The interface need to be released before unregistering hci device when
    > usb disconnect. Removing BT usb dongle without properly releasing the
    > interface may cause Kernel panic while unregister hci device.
    > Signed-off-by: Chris Lu &lt;chris.lu@mediatek.com&gt;
    > Signed-off-by: Luiz Augusto von Dentz &lt;luiz.von.dentz@intel.com&gt;
    > Cc: Fedor Pchelkin &lt;boddah8794@gmail.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ Bluetooth: btusb: mediatek: move Bluetooth power off command position (@Chris Lu in [b967b37cefdf7ae](https://github.com/sophgo/linux-riscv/commit/b967b37cefdf7ae) at 2025-01-02 09:34:25)
    > commit ad0c6f603bb0b07846fda484c59a176a8cd02838 upstream.
    > Move MediaTek Bluetooth power off command before releasing
    > usb ISO interface.
    > Signed-off-by: Chris Lu &lt;chris.lu@mediatek.com&gt;
    > Signed-off-by: Luiz Augusto von Dentz &lt;luiz.von.dentz@intel.com&gt;
    > Cc: Fedor Pchelkin &lt;boddah8794@gmail.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ Bluetooth: btusb: mediatek: add callback function in btusb_disconnect (@Chris Lu in [9da1cfc4f111b7e](https://github.com/sophgo/linux-riscv/commit/9da1cfc4f111b7e) at 2025-01-02 09:34:25)
    > commit cea1805f165cdd783dd21f26df957118cb8641b4 upstream.
    > Add disconnect callback function in btusb_disconnect which is reserved
    > for vendor specific usage before deregister hci in btusb_disconnect.
    > Signed-off-by: Chris Lu &lt;chris.lu@mediatek.com&gt;
    > Signed-off-by: Luiz Augusto von Dentz &lt;luiz.von.dentz@intel.com&gt;
    > Cc: Fedor Pchelkin &lt;boddah8794@gmail.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ power: supply: gpio-charger: Fix set charge current limits (@Dimitri Fedrau in [f6279a98db132da](https://github.com/sophgo/linux-riscv/commit/f6279a98db132da) at 2025-01-02 09:34:24)
    > commit afc6e39e824ad0e44b2af50a97885caec8d213d1 upstream.
    > Fix set charge current limits for devices which allow to set the lowest
    > charge current limit to be greater zero. If requested charge current limit
    > is below lowest limit, the index equals current_limit_map_size which leads
    > to accessing memory beyond allocated memory.
    > Fixes: be2919d8355e (&quot;power: supply: gpio-charger: add charge-current-limit feature&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Dimitri Fedrau &lt;dimitri.fedrau@liebherr.com&gt;
    > Link: https://lore.kernel.org/r/20241209-fix-charge-current-limit-v1-1-760d9b8f2af3@liebherr.com
    > Signed-off-by: Sebastian Reichel &lt;sebastian.reichel@collabora.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ btrfs: fix race with memory mapped writes when activating swap file (@Filipe Manana in [f6174bb982a831b](https://github.com/sophgo/linux-riscv/commit/f6174bb982a831b) at 2025-01-02 09:34:24)
    > commit 0525064bb82e50d59543b62b9d41a606198a4a44 upstream.
    > When activating the swap file we flush all delalloc and wait for ordered
    > extent completion, so that we don&#x27;t miss any delalloc and extents before
    > we check that the file&#x27;s extent layout is usable for a swap file and
    > activate the swap file. We are called with the inode&#x27;s VFS lock acquired,
    > so we won&#x27;t race with buffered and direct IO writes, however we can still
    > race with memory mapped writes since they don&#x27;t acquire the inode&#x27;s VFS
    > lock. The race window is between flushing all delalloc and locking the
    > whole file&#x27;s extent range, since memory mapped writes lock an extent range
    > with the length of a page.
    > Fix this by acquiring the inode&#x27;s mmap lock before we flush delalloc.
    > CC: stable@vger.kernel.org # 5.4+
    > Reviewed-by: Qu Wenruo &lt;wqu@suse.com&gt;
    > Signed-off-by: Filipe Manana &lt;fdmanana@suse.com&gt;
    > Signed-off-by: David Sterba &lt;dsterba@suse.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ btrfs: sysfs: fix direct super block member reads (@Qu Wenruo in [dbebb0cc5139606](https://github.com/sophgo/linux-riscv/commit/dbebb0cc5139606) at 2025-01-02 09:34:24)
    > commit fca432e73db2bec0fdbfbf6d98d3ebcd5388a977 upstream.
    > The following sysfs entries are reading super block member directly,
    > which can have a different endian and cause wrong values:
    > - sys/fs/btrfs/&lt;uuid&gt;/nodesize
    > - sys/fs/btrfs/&lt;uuid&gt;/sectorsize
    > - sys/fs/btrfs/&lt;uuid&gt;/clone_alignment
    > Thankfully those values (nodesize and sectorsize) are always aligned
    > inside the btrfs_super_block, so it won&#x27;t trigger unaligned read errors,
    > just endian problems.
    > Fix them by using the native cached members instead.
    > Fixes: df93589a1737 (&quot;btrfs: export more from FS_INFO to sysfs&quot;)
    > CC: stable@vger.kernel.org
    > Reviewed-by: Naohiro Aota &lt;naohiro.aota@wdc.com&gt;
    > Reviewed-by: Johannes Thumshirn &lt;johannes.thumshirn@wdc.com&gt;
    > Signed-off-by: Qu Wenruo &lt;wqu@suse.com&gt;
    > Reviewed-by: David Sterba &lt;dsterba@suse.com&gt;
    > Signed-off-by: David Sterba &lt;dsterba@suse.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ btrfs: fix use-after-free when COWing tree bock and tracing is enabled (@Filipe Manana in [c3a403d8ce36f5a](https://github.com/sophgo/linux-riscv/commit/c3a403d8ce36f5a) at 2025-01-02 09:34:24)
    > commit 44f52bbe96dfdbe4aca3818a2534520082a07040 upstream.
    > When a COWing a tree block, at btrfs_cow_block(), and we have the
    > tracepoint trace_btrfs_cow_block() enabled and preemption is also enabled
    > (CONFIG_PREEMPT&#x3D;y), we can trigger a use-after-free in the COWed extent
    > buffer while inside the tracepoint code. This is because in some paths
    > that call btrfs_cow_block(), such as btrfs_search_slot(), we are holding
    > the last reference on the extent buffer @buf so btrfs_force_cow_block()
    > drops the last reference on the @buf extent buffer when it calls
    > free_extent_buffer_stale(buf), which schedules the release of the extent
    > buffer with RCU. This means that if we are on a kernel with preemption,
    > the current task may be preempted before calling trace_btrfs_cow_block()
    > and the extent buffer already released by the time trace_btrfs_cow_block()
    > is called, resulting in a use-after-free.
    > Fix this by moving the trace_btrfs_cow_block() from btrfs_cow_block() to
    > btrfs_force_cow_block() before the COWed extent buffer is freed.
    > This also has a side effect of invoking the tracepoint in the tree defrag
    > code, at defrag.c:btrfs_realloc_node(), since btrfs_force_cow_block() is
    > called there, but this is fine and it was actually missing there.
    > Reported-by: syzbot+8517da8635307182c8a5@syzkaller.appspotmail.com
    > Link: https://lore.kernel.org/linux-btrfs/6759a9b9.050a0220.1ac542.000d.GAE@google.com/
    > CC: stable@vger.kernel.org # 5.4+
    > Reviewed-by: Qu Wenruo &lt;wqu@suse.com&gt;
    > Signed-off-by: Filipe Manana &lt;fdmanana@suse.com&gt;
    > Signed-off-by: David Sterba &lt;dsterba@suse.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ btrfs: fix transaction atomicity bug when enabling simple quotas (@Julian Sun in [b87c9b9ba05ba6e](https://github.com/sophgo/linux-riscv/commit/b87c9b9ba05ba6e) at 2025-01-02 09:34:24)
    > commit f2363e6fcc7938c5f0f6ac066fad0dd247598b51 upstream.
    > Set squota incompat bit before committing the transaction that enables
    > the feature.
    > With the config CONFIG_BTRFS_ASSERT enabled, an assertion
    > failure occurs regarding the simple quota feature.
    > [5.596534] assertion failed: btrfs_fs_incompat(fs_info, SIMPLE_QUOTA), in fs/btrfs/qgroup.c:365
    > [5.597098] ------------[ cut here ]------------
    > [5.597371] kernel BUG at fs/btrfs/qgroup.c:365!
    > [5.597946] CPU: 1 UID: 0 PID: 268 Comm: mount Not tainted 6.13.0-rc2-00031-gf92f4749861b #146
    > [5.598450] Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.16.2-debian-1.16.2-1 04/01/2014
    > [5.599008] RIP: 0010:btrfs_read_qgroup_config+0x74d/0x7a0
    > [5.604303]  &lt;TASK&gt;
    > [5.605230]  ? btrfs_read_qgroup_config+0x74d/0x7a0
    > [5.605538]  ? exc_invalid_op+0x56/0x70
    > [5.605775]  ? btrfs_read_qgroup_config+0x74d/0x7a0
    > [5.606066]  ? asm_exc_invalid_op+0x1f/0x30
    > [5.606441]  ? btrfs_read_qgroup_config+0x74d/0x7a0
    > [5.606741]  ? btrfs_read_qgroup_config+0x74d/0x7a0
    > [5.607038]  ? try_to_wake_up+0x317/0x760
    > [5.607286]  open_ctree+0xd9c/0x1710
    > [5.607509]  btrfs_get_tree+0x58a/0x7e0
    > [5.608002]  vfs_get_tree+0x2e/0x100
    > [5.608224]  fc_mount+0x16/0x60
    > [5.608420]  btrfs_get_tree+0x2f8/0x7e0
    > [5.608897]  vfs_get_tree+0x2e/0x100
    > [5.609121]  path_mount+0x4c8/0xbc0
    > [5.609538]  __x64_sys_mount+0x10d/0x150
    > The issue can be easily reproduced using the following reproducer:
    > root@q:linux# cat repro.sh
    > set -e
    > mkfs.btrfs -q -f /dev/sdb
    > mount /dev/sdb /mnt/btrfs
    > btrfs quota enable -s /mnt/btrfs
    > umount /mnt/btrfs
    > mount /dev/sdb /mnt/btrfs
    > The issue is that when enabling quotas, at btrfs_quota_enable(), we set
    > BTRFS_QGROUP_STATUS_FLAG_SIMPLE_MODE at fs_info-&gt;qgroup_flags and persist
    > it in the quota root in the item with the key BTRFS_QGROUP_STATUS_KEY, but
    > we only set the incompat bit BTRFS_FEATURE_INCOMPAT_SIMPLE_QUOTA after we
    > commit the transaction used to enable simple quotas.
    > This means that if after that transaction commit we unmount the filesystem
    > without starting and committing any other transaction, or we have a power
    > failure, the next time we mount the filesystem we will find the flag
    > BTRFS_QGROUP_STATUS_FLAG_SIMPLE_MODE set in the item with the key
    > BTRFS_QGROUP_STATUS_KEY but we will not find the incompat bit
    > BTRFS_FEATURE_INCOMPAT_SIMPLE_QUOTA set in the superblock, triggering an
    > assertion failure at:
    > btrfs_read_qgroup_config() -&gt; qgroup_read_enable_gen()
    > To fix this issue, set the BTRFS_FEATURE_INCOMPAT_SIMPLE_QUOTA flag
    > immediately after setting the BTRFS_QGROUP_STATUS_FLAG_SIMPLE_MODE.
    > This ensures that both flags are flushed to disk within the same
    > transaction.
    > Fixes: 182940f4f4db (&quot;btrfs: qgroup: add new quota mode for simple quotas&quot;)
    > CC: stable@vger.kernel.org # 6.6+
    > Reviewed-by: Filipe Manana &lt;fdmanana@suse.com&gt;
    > Signed-off-by: Julian Sun &lt;sunjunchao2870@gmail.com&gt;
    > Signed-off-by: Filipe Manana &lt;fdmanana@suse.com&gt;
    > Signed-off-by: David Sterba &lt;dsterba@suse.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ btrfs: avoid monopolizing a core when activating a swap file (@Filipe Manana in [9f372e86b9bd191](https://github.com/sophgo/linux-riscv/commit/9f372e86b9bd191) at 2025-01-02 09:34:24)
    > commit 2c8507c63f5498d4ee4af404a8e44ceae4345056 upstream.
    > During swap activation we iterate over the extents of a file and we can
    > have many thousands of them, so we can end up in a busy loop monopolizing
    > a core. Avoid this by doing a voluntary reschedule after processing each
    > extent.
    > CC: stable@vger.kernel.org # 5.4+
    > Reviewed-by: Qu Wenruo &lt;wqu@suse.com&gt;
    > Signed-off-by: Filipe Manana &lt;fdmanana@suse.com&gt;
    > Signed-off-by: David Sterba &lt;dsterba@suse.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ btrfs: fix swap file activation failure due to extents that used to be shared (@Filipe Manana in [8faba508242b224](https://github.com/sophgo/linux-riscv/commit/8faba508242b224) at 2025-01-02 09:34:24)
    > commit 03018e5d8508254534511d40fb57bc150e6a87f2 upstream.
    > When activating a swap file, to determine if an extent is shared we use
    > can_nocow_extent(), which ends up at btrfs_cross_ref_exist(). That helper
    > is meant to be quick because it&#x27;s used in the NOCOW write path, when
    > flushing delalloc and when doing a direct IO write, however it does return
    > some false positives, meaning it may indicate that an extent is shared
    > even if it&#x27;s no longer the case. For the write path this is fine, we just
    > do a unnecessary COW operation instead of doing a more rigorous check
    > which would be too heavy (calling btrfs_is_data_extent_shared()).
    > However when activating a swap file, the false positives simply result
    > in a failure, which is confusing for users/applications. One particular
    > case where this happens is when a data extent only has 1 reference but
    > that reference is not inlined in the extent item located in the extent
    > tree - this happens when we create more than 33 references for an extent
    > and then delete those 33 references plus every other non-inline reference
    > except one. The function check_committed_ref() assumes that if the size
    > of an extent item doesn&#x27;t match the size of struct btrfs_extent_item
    > plus the size of an inline reference (plus an owner reference in case
    > simple quotas are enabled), then the extent is shared - that is not the
    > case however, we can have a single reference but it&#x27;s not inlined - the
    > reason we do this is to be fast and avoid inspecting non-inline references
    > which may be located in another leaf of the extent tree, slowing down
    > write paths.
    > The following test script reproduces the bug:
    > $ cat test.sh
    > #!/bin/bash
    > DEV&#x3D;/dev/sdi
    > MNT&#x3D;/mnt/sdi
    > NUM_CLONES&#x3D;50
    > umount $DEV &amp;&gt; /dev/null
    > run_test()
    > {
    > local sync_after_add_reflinks&#x3D;$1
    > local sync_after_remove_reflinks&#x3D;$2
    > mkfs.btrfs -f $DEV &gt; /dev/null
    > #mkfs.xfs -f $DEV &gt; /dev/null
    > mount $DEV $MNT
    > touch $MNT/foo
    > chmod 0600 $MNT/foo
    > # On btrfs the file must be NOCOW.
    > chattr +C $MNT/foo &amp;&gt; /dev/null
    > xfs_io -s -c &quot;pwrite -b 1M 0 1M&quot; $MNT/foo
    > mkswap $MNT/foo
    > for ((i &#x3D; 1; i &lt;&#x3D; $NUM_CLONES; i++)); do
    > touch $MNT/foo_clone_$i
    > chmod 0600 $MNT/foo_clone_$i
    > # On btrfs the file must be NOCOW.
    > chattr +C $MNT/foo_clone_$i &amp;&gt; /dev/null
    > cp --reflink&#x3D;always $MNT/foo $MNT/foo_clone_$i
    > done
    > if [ $sync_after_add_reflinks -ne 0 ]; then
    > # Flush delayed refs and commit current transaction.
    > sync -f $MNT
    > fi
    > # Remove the original file and all clones except the last.
    > rm -f $MNT/foo
    > for ((i &#x3D; 1; i &lt; $NUM_CLONES; i++)); do
    > rm -f $MNT/foo_clone_$i
    > done
    > if [ $sync_after_remove_reflinks -ne 0 ]; then
    > # Flush delayed refs and commit current transaction.
    > sync -f $MNT
    > fi
    > # Now use the last clone as a swap file. It should work since
    > # its extent are not shared anymore.
    > swapon $MNT/foo_clone_${NUM_CLONES}
    > swapoff $MNT/foo_clone_${NUM_CLONES}
    > umount $MNT
    > }
    > echo -e &quot;\nTest without sync after creating and removing clones&quot;
    > run_test 0 0
    > echo -e &quot;\nTest with sync after creating clones&quot;
    > run_test 1 0
    > echo -e &quot;\nTest with sync after removing clones&quot;
    > run_test 0 1
    > echo -e &quot;\nTest with sync after creating and removing clones&quot;
    > run_test 1 1
    > Running the test:
    > $ ./test.sh
    > Test without sync after creating and removing clones
    > wrote 1048576/1048576 bytes at offset 0
    > 1 MiB, 1 ops; 0.0017 sec (556.793 MiB/sec and 556.7929 ops/sec)
    > Setting up swapspace version 1, size &#x3D; 1020 KiB (1044480 bytes)
    > no label, UUID&#x3D;a6b9c29e-5ef4-4689-a8ac-bc199c750f02
    > swapon: /mnt/sdi/foo_clone_50: swapon failed: Invalid argument
    > swapoff: /mnt/sdi/foo_clone_50: swapoff failed: Invalid argument
    > Test with sync after creating clones
    > wrote 1048576/1048576 bytes at offset 0
    > 1 MiB, 1 ops; 0.0036 sec (271.739 MiB/sec and 271.7391 ops/sec)
    > Setting up swapspace version 1, size &#x3D; 1020 KiB (1044480 bytes)
    > no label, UUID&#x3D;5e9008d6-1f7a-4948-a1b4-3f30aba20a33
    > swapon: /mnt/sdi/foo_clone_50: swapon failed: Invalid argument
    > swapoff: /mnt/sdi/foo_clone_50: swapoff failed: Invalid argument
    > Test with sync after removing clones
    > wrote 1048576/1048576 bytes at offset 0
    > 1 MiB, 1 ops; 0.0103 sec (96.665 MiB/sec and 96.6651 ops/sec)
    > Setting up swapspace version 1, size &#x3D; 1020 KiB (1044480 bytes)
    > no label, UUID&#x3D;916c2740-fa9f-4385-9f06-29c3f89e4764
    > Test with sync after creating and removing clones
    > wrote 1048576/1048576 bytes at offset 0
    > 1 MiB, 1 ops; 0.0031 sec (314.268 MiB/sec and 314.2678 ops/sec)
    > Setting up swapspace version 1, size &#x3D; 1020 KiB (1044480 bytes)
    > no label, UUID&#x3D;06aab1dd-4d90-49c0-bd9f-3a8db4e2f912
    > swapon: /mnt/sdi/foo_clone_50: swapon failed: Invalid argument
    > swapoff: /mnt/sdi/foo_clone_50: swapoff failed: Invalid argument
    > Fix this by reworking btrfs_swap_activate() to instead of using extent
    > maps and checking for shared extents with can_nocow_extent(), iterate
    > over the inode&#x27;s file extent items and use the accurate
    > btrfs_is_data_extent_shared().
    > CC: stable@vger.kernel.org # 5.4+
    > Reviewed-by: Qu Wenruo &lt;wqu@suse.com&gt;
    > Signed-off-by: Filipe Manana &lt;fdmanana@suse.com&gt;
    > Signed-off-by: David Sterba &lt;dsterba@suse.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ power: supply: cros_charge-control: hide start threshold on v2 cmd (@Thomas Weißschuh in [c110095013ad13d](https://github.com/sophgo/linux-riscv/commit/c110095013ad13d) at 2025-01-02 09:34:23)
    > commit c28dc9fc24f5fa802d44ef7620a511035bdd803e upstream.
    > ECs implementing the v2 command will not stop charging when the end
    > threshold is reached. Instead they will begin discharging until the
    > start threshold is reached, leading to permanent charge and discharge
    > cycles. This defeats the point of the charge control mechanism.
    > Avoid the issue by hiding the start threshold on v2 systems.
    > Instead on those systems program the EC with start &#x3D;&#x3D; end which forces
    > the EC to reach and stay at that level.
    > v1 does not support thresholds and v3 works correctly,
    > at least judging from the code.
    > Reported-by: Thomas Koch &lt;linrunner@gmx.net&gt;
    > Fixes: c6ed48ef5259 (&quot;power: supply: add ChromeOS EC based charge control driver&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Thomas Weißschuh &lt;linux@weissschuh.net&gt;
    > Link: https://lore.kernel.org/r/20241208-cros_charge-control-v2-v1-3-8d168d0f08a3@weissschuh.net
    > Signed-off-by: Sebastian Reichel &lt;sebastian.reichel@collabora.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ i2c: imx: add imx7d compatible string for applying erratum ERR007805 (@Carlos Song in [bcfb9d856bd6bbd](https://github.com/sophgo/linux-riscv/commit/bcfb9d856bd6bbd) at 2025-01-02 09:34:23)
    > commit e0cec363197e41af870613e8e17b30bf0e3d41b5 upstream.
    > Compatible string &quot;fsl,imx7d-i2c&quot; is not exited at i2c-imx driver
    > compatible string table, at the result, &quot;fsl,imx21-i2c&quot; will be
    > matched, but it will cause erratum ERR007805 not be applied in fact.
    > So Add &quot;fsl,imx7d-i2c&quot; compatible string in i2c-imx driver to apply
    > the erratum ERR007805(https://www.nxp.com/docs/en/errata/IMX7DS_3N09P.pdf).
    > &quot;
    > ERR007805 I2C: When the I2C clock speed is configured for 400 kHz,
    > the SCL low period violates the I2C spec of 1.3 uS min
    > Description: When the I2C module is programmed to operate at the
    > maximum clock speed of 400 kHz (as defined by the I2C spec), the SCL
    > clock low period violates the I2C spec of 1.3 uS min. The user must
    > reduce the clock speed to obtain the SCL low time to meet the 1.3us
    > I2C minimum required. This behavior means the SoC is not compliant
    > to the I2C spec at 400kHz.
    > Workaround: To meet the clock low period requirement in fast speed
    > mode, SCL must be configured to 384KHz or less.
    > &quot;
    > &quot;fsl,imx7d-i2c&quot; already is documented in binding doc. This erratum
    > fix has been included in imx6_i2c_hwdata and it is the same in all
    > I.MX6/7/8, so just reuse it.
    > Fixes: 39c025721d70 (&quot;i2c: imx: Implement errata ERR007805 or e7805 bus frequency limit&quot;)
    > Cc: stable@vger.kernel.org # v5.18+
    > Signed-off-by: Carlos Song &lt;carlos.song@nxp.com&gt;
    > Signed-off-by: Haibo Chen &lt;haibo.chen@nxp.com&gt;
    > Reviewed-by: Frank Li &lt;Frank.Li@nxp.com&gt;
    > Fixes: 39c025721d70 (&quot;i2c: imx: Implement errata ERR007805 or e7805 bus frequency limit&quot;)
    > Acked-by: Oleksij Rempel &lt;o.rempel@pengutronix.de&gt;
    > Link: https://lore.kernel.org/r/20241218044238.143414-1-carlos.song@nxp.com
    > Signed-off-by: Andi Shyti &lt;andi.shyti@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ power: supply: cros_charge-control: add mutex for driver data (@Thomas Weißschuh in [77e6c8adf8d66c5](https://github.com/sophgo/linux-riscv/commit/77e6c8adf8d66c5) at 2025-01-02 09:34:23)
    > commit e5f84d1cf562f7b45e28d6e5f6490626f870f81c upstream.
    > Concurrent accesses through sysfs may lead to inconsistent state in the
    > priv data. Introduce a mutex to avoid this.
    > Fixes: c6ed48ef5259 (&quot;power: supply: add ChromeOS EC based charge control driver&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Thomas Weißschuh &lt;linux@weissschuh.net&gt;
    > Link: https://lore.kernel.org/r/20241208-cros_charge-control-v2-v1-1-8d168d0f08a3@weissschuh.net
    > Signed-off-by: Sebastian Reichel &lt;sebastian.reichel@collabora.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ perf/x86/intel/ds: Add PEBS format 6 (@Kan Liang in [7182f93bb358a99](https://github.com/sophgo/linux-riscv/commit/7182f93bb358a99) at 2025-01-02 09:34:23)
    > commit b8c3a2502a205321fe66c356f4b70cabd8e1a5fc upstream.
    > The only difference between 5 and 6 is the new counters snapshotting
    > group, without the following counters snapshotting enabling patches,
    > it&#x27;s impossible to utilize the feature in a PEBS record. It&#x27;s safe to
    > share the same code path with format 5.
    > Add format 6, so the end user can at least utilize the legacy PEBS
    > features.
    > Fixes: a932aa0e868f (&quot;perf/x86: Add Lunar Lake and Arrow Lake support&quot;)
    > Signed-off-by: Kan Liang &lt;kan.liang@linux.intel.com&gt;
    > Signed-off-by: Peter Zijlstra (Intel) &lt;peterz@infradead.org&gt;
    > Cc: stable@vger.kernel.org
    > Link: https://lore.kernel.org/r/20241216204505.748363-1-kan.liang@linux.intel.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ perf/x86/intel: Fix bitmask of OCR and FRONTEND events for LNC (@Kan Liang in [5e44779d12bd3cd](https://github.com/sophgo/linux-riscv/commit/5e44779d12bd3cd) at 2025-01-02 09:34:23)
    > commit aa5d2ca7c179c40669edb5e96d931bf9828dea3d upstream.
    > The released OCR and FRONTEND events utilized more bits on Lunar Lake
    > p-core. The corresponding mask in the extra_regs has to be extended to
    > unblock the extra bits.
    > Add a dedicated intel_lnc_extra_regs.
    > Fixes: a932aa0e868f (&quot;perf/x86: Add Lunar Lake and Arrow Lake support&quot;)
    > Reported-by: Andi Kleen &lt;ak@linux.intel.com&gt;
    > Signed-off-by: Kan Liang &lt;kan.liang@linux.intel.com&gt;
    > Signed-off-by: Peter Zijlstra (Intel) &lt;peterz@infradead.org&gt;
    > Cc: stable@vger.kernel.org
    > Link: https://lkml.kernel.org/r/20241216160252.430858-1-kan.liang@linux.intel.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ power: supply: cros_charge-control: allow start_threshold &#x3D;&#x3D; end_threshold (@Thomas Weißschuh in [5792ae1cb1b00ae](https://github.com/sophgo/linux-riscv/commit/5792ae1cb1b00ae) at 2025-01-02 09:34:23)
    > commit e65a1b7fad0e112573eea7d64d4ab4fc513b8695 upstream.
    > Allow setting the start and stop thresholds to the same value.
    > There is no reason to disallow it.
    > Suggested-by: Thomas Koch &lt;linrunner@gmx.net&gt;
    > Fixes: c6ed48ef5259 (&quot;power: supply: add ChromeOS EC based charge control driver&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Thomas Weißschuh &lt;linux@weissschuh.net&gt;
    > Link: https://lore.kernel.org/r/20241208-cros_charge-control-v2-v1-2-8d168d0f08a3@weissschuh.net
    > Signed-off-by: Sebastian Reichel &lt;sebastian.reichel@collabora.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ i2c: microchip-core: fix &quot;ghost&quot; detections (@Conor Dooley in [2a9cbd6c9049abe](https://github.com/sophgo/linux-riscv/commit/2a9cbd6c9049abe) at 2025-01-02 09:34:23)
    > commit 49e1f0fd0d4cb03a16b8526c4e683e1958f71490 upstream.
    > Running i2c-detect currently produces an output akin to:
    > 0  1  2  3  4  5  6  7  8  9  a  b  c  d  e  f
    > 00:                         08 -- 0a -- 0c -- 0e --
    > 10: 10 -- 12 -- 14 -- 16 -- UU 19 -- 1b -- 1d -- 1f
    > 20: -- 21 -- 23 -- 25 -- 27 -- 29 -- 2b -- 2d -- 2f
    > 30: -- -- -- -- -- -- -- -- 38 -- 3a -- 3c -- 3e --
    > 40: 40 -- 42 -- 44 -- 46 -- 48 -- 4a -- 4c -- 4e --
    > 50: -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- --
    > 60: 60 -- 62 -- 64 -- 66 -- 68 -- 6a -- 6c -- 6e --
    > 70: 70 -- 72 -- 74 -- 76 --
    > This happens because for an i2c_msg with a len of 0 the driver will
    > mark the transmission of the message as a success once the START has
    > been sent, without waiting for the devices on the bus to respond with an
    > ACK/NAK. Since i2cdetect seems to run in a tight loop over all addresses
    > the NAK is treated as part of the next test for the next address.
    > Delete the fast path that marks a message as complete when idev-&gt;msg_len
    > is zero after sending a START/RESTART since this isn&#x27;t a valid scenario.
    > CC: stable@vger.kernel.org
    > Fixes: 64a6f1c4987e (&quot;i2c: add support for microchip fpga i2c controllers&quot;)
    > Signed-off-by: Conor Dooley &lt;conor.dooley@microchip.com&gt;
    > Reviewed-by: Andi Shyti &lt;andi.shyti@kernel.org&gt;
    > Link: https://lore.kernel.org/r/20241218-outbid-encounter-b2e78b1cc707@spud
    > Signed-off-by: Andi Shyti &lt;andi.shyti@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ x86/fred: Clear WFE in missing-ENDBRANCH #CPs (@Xin Li (Intel) in [b939f108e86b761](https://github.com/sophgo/linux-riscv/commit/b939f108e86b761) at 2025-01-02 09:34:22)
    > commit dc81e556f2a017d681251ace21bf06c126d5a192 upstream.
    > An indirect branch instruction sets the CPU indirect branch tracker
    > (IBT) into WAIT_FOR_ENDBRANCH (WFE) state and WFE stays asserted
    > across the instruction boundary.  When the decoder finds an
    > inappropriate instruction while WFE is set ENDBR, the CPU raises a #CP
    > fault.
    > For the &quot;kernel IBT no ENDBR&quot; selftest where #CPs are deliberately
    > triggered, the WFE state of the interrupted context needs to be
    > cleared to let execution continue.  Otherwise when the CPU resumes
    > from the instruction that just caused the previous #CP, another
    > missing-ENDBRANCH #CP is raised and the CPU enters a dead loop.
    > This is not a problem with IDT because it doesn&#x27;t preserve WFE and
    > IRET doesn&#x27;t set WFE.  But FRED provides space on the entry stack
    > (in an expanded CS area) to save and restore the WFE state, thus the
    > WFE state is no longer clobbered, so software must clear it.
    > Clear WFE to avoid dead looping in ibt_clear_fred_wfe() and the
    > !ibt_fatal code path when execution is allowed to continue.
    > Clobbering WFE in any other circumstance is a security-relevant bug.
    > [ dhansen: changelog rewording ]
    > Fixes: a5f6c2ace997 (&quot;x86/shstk: Add user control-protection fault handler&quot;)
    > Signed-off-by: Xin Li (Intel) &lt;xin@zytor.com&gt;
    > Signed-off-by: Dave Hansen &lt;dave.hansen@linux.intel.com&gt;
    > Signed-off-by: Ingo Molnar &lt;mingo@kernel.org&gt;
    > Acked-by: Dave Hansen &lt;dave.hansen@linux.intel.com&gt;
    > Cc: stable@vger.kernel.org
    > Link: https://lore.kernel.org/all/20241113175934.3897541-1-xin%40zytor.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ PCI/MSI: Handle lack of irqdomain gracefully (@Thomas Gleixner in [aed157301c659a4](https://github.com/sophgo/linux-riscv/commit/aed157301c659a4) at 2025-01-02 09:34:22)
    > commit a60b990798eb17433d0283788280422b1bd94b18 upstream.
    > Alexandre observed a warning emitted from pci_msi_setup_msi_irqs() on a
    > RISCV platform which does not provide PCI/MSI support:
    > WARNING: CPU: 1 PID: 1 at drivers/pci/msi/msi.h:121 pci_msi_setup_msi_irqs+0x2c/0x32
    > __pci_enable_msix_range+0x30c/0x596
    > pci_msi_setup_msi_irqs+0x2c/0x32
    > pci_alloc_irq_vectors_affinity+0xb8/0xe2
    > RISCV uses hierarchical interrupt domains and correctly does not implement
    > the legacy fallback. The warning triggers from the legacy fallback stub.
    > That warning is bogus as the PCI/MSI layer knows whether a PCI/MSI parent
    > domain is associated with the device or not. There is a check for MSI-X,
    > which has a legacy assumption. But that legacy fallback assumption is only
    > valid when legacy support is enabled, but otherwise the check should simply
    > return -ENOTSUPP.
    > Loongarch tripped over the same problem and blindly enabled legacy support
    > without implementing the legacy fallbacks. There are weak implementations
    > which return an error, so the problem was papered over.
    > Correct pci_msi_domain_supports() to evaluate the legacy mode and add
    > the missing supported check into the MSI enable path to complete it.
    > Fixes: d2a463b29741 (&quot;PCI/MSI: Reject multi-MSI early&quot;)
    > Reported-by: Alexandre Ghiti &lt;alexghiti@rivosinc.com&gt;
    > Signed-off-by: Thomas Gleixner &lt;tglx@linutronix.de&gt;
    > Tested-by: Alexandre Ghiti &lt;alexghiti@rivosinc.com&gt;
    > Cc: stable@vger.kernel.org
    > Link: https://lore.kernel.org/all/87ed2a8ow5.ffs@tglx
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ i2c: microchip-core: actually use repeated sends (@Conor Dooley in [a0d637675f2ba98](https://github.com/sophgo/linux-riscv/commit/a0d637675f2ba98) at 2025-01-02 09:34:22)
    > commit 9a8f9320d67b27ddd7f1ee88d91820197a0e908f upstream.
    > At present, where repeated sends are intended to be used, the
    > i2c-microchip-core driver sends a stop followed by a start. Lots of i2c
    > devices must not malfunction in the face of this behaviour, because the
    > driver has operated like this for years! Try to keep track of whether or
    > not a repeated send is required, and suppress sending a stop in these
    > cases.
    > CC: stable@vger.kernel.org
    > Fixes: 64a6f1c4987e (&quot;i2c: add support for microchip fpga i2c controllers&quot;)
    > Signed-off-by: Conor Dooley &lt;conor.dooley@microchip.com&gt;
    > Reviewed-by: Andi Shyti &lt;andi.shyti@kernel.org&gt;
    > Link: https://lore.kernel.org/r/20241218-football-composure-e56df2461461@spud
    > Signed-off-by: Andi Shyti &lt;andi.shyti@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ io_uring/sqpoll: fix sqpoll error handling races (@Pavel Begunkov in [8e8494c83cf7316](https://github.com/sophgo/linux-riscv/commit/8e8494c83cf7316) at 2025-01-02 09:34:22)
    > commit e33ac68e5e21ec1292490dfe061e75c0dbdd3bd4 upstream.
    > BUG: KASAN: slab-use-after-free in __lock_acquire+0x370b/0x4a10 kernel/locking/lockdep.c:5089
    > Call Trace:
    > &lt;TASK&gt;
    > ...
    > _raw_spin_lock_irqsave+0x3d/0x60 kernel/locking/spinlock.c:162
    > class_raw_spinlock_irqsave_constructor include/linux/spinlock.h:551 [inline]
    > try_to_wake_up+0xb5/0x23c0 kernel/sched/core.c:4205
    > io_sq_thread_park+0xac/0xe0 io_uring/sqpoll.c:55
    > io_sq_thread_finish+0x6b/0x310 io_uring/sqpoll.c:96
    > io_sq_offload_create+0x162/0x11d0 io_uring/sqpoll.c:497
    > io_uring_create io_uring/io_uring.c:3724 [inline]
    > io_uring_setup+0x1728/0x3230 io_uring/io_uring.c:3806
    > ...
    > Kun Hu reports that the SQPOLL creating error path has UAF, which
    > happens if io_uring_alloc_task_context() fails and then io_sq_thread()
    > manages to run and complete before the rest of error handling code,
    > which means io_sq_thread_finish() is looking at already killed task.
    > Note that this is mostly theoretical, requiring fault injection on
    > the allocation side to trigger in practice.
    > Cc: stable@vger.kernel.org
    > Reported-by: Kun Hu &lt;huk23@m.fudan.edu.cn&gt;
    > Signed-off-by: Pavel Begunkov &lt;asml.silence@gmail.com&gt;
    > Link: https://lore.kernel.org/r/0f2f1aa5729332612bd01fe0f2f385fd1f06ce7c.1735231717.git.asml.silence@gmail.com
    > Signed-off-by: Jens Axboe &lt;axboe@kernel.dk&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ rtla/timerlat: Fix histogram ALL for zero samples (@Tomas Glozar in [4c0f79cbc42d48a](https://github.com/sophgo/linux-riscv/commit/4c0f79cbc42d48a) at 2025-01-02 09:34:22)
    > commit 6cc45f8c1f898570916044f606be9890d295e129 upstream.
    > rtla timerlat hist currently computers the minimum, maximum and average
    > latency even in cases when there are zero samples. This leads to
    > nonsensical values being calculated for maximum and minimum, and to
    > divide by zero for average.
    > A similar bug is fixed by 01b05fc0e5f3 (&quot;rtla/timerlat: Fix histogram
    > report when a cpu count is 0&quot;) but the bug still remains for printing
    > the sum over all CPUs in timerlat_print_stats_all.
    > The issue can be reproduced with this command:
    > $ rtla timerlat hist -U -d 1s
    > Index
    > over:
    > count:
    > min:
    > avg:
    > max:
    > Floating point exception (core dumped)
    > (There are always no samples with -U unless the user workload is
    > created.)
    > Fix the bug by omitting max/min/avg when sample count is zero,
    > displaying a dash instead, just like we already do for the individual
    > CPUs. The logic is moved into a new function called
    > format_summary_value, which is used for both the individual CPUs
    > and for the overall summary.
    > Cc: stable@vger.kernel.org
    > Link: https://lore.kernel.org/20241127134130.51171-1-tglozar@redhat.com
    > Fixes: 1462501c7a8 (&quot;rtla/timerlat: Add a summary for hist mode&quot;)
    > Signed-off-by: Tomas Glozar &lt;tglozar@redhat.com&gt;
    > Signed-off-by: Steven Rostedt (Google) &lt;rostedt@goodmis.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ tracing: Prevent bad count for tracing_cpumask_write (@Lizhi Xu in [1cca920af19df5d](https://github.com/sophgo/linux-riscv/commit/1cca920af19df5d) at 2025-01-02 09:34:22)
    > commit 98feccbf32cfdde8c722bc4587aaa60ee5ac33f0 upstream.
    > If a large count is provided, it will trigger a warning in bitmap_parse_user.
    > Also check zero for it.
    > Cc: stable@vger.kernel.org
    > Fixes: 9e01c1b74c953 (&quot;cpumask: convert kernel trace functions&quot;)
    > Link: https://lore.kernel.org/20241216073238.2573704-1-lizhi.xu@windriver.com
    > Reported-by: syzbot+0aecfd34fb878546f3fd@syzkaller.appspotmail.com
    > Closes: https://syzkaller.appspot.com/bug?extid&#x3D;0aecfd34fb878546f3fd
    > Tested-by: syzbot+0aecfd34fb878546f3fd@syzkaller.appspotmail.com
    > Signed-off-by: Lizhi Xu &lt;lizhi.xu@windriver.com&gt;
    > Signed-off-by: Steven Rostedt (Google) &lt;rostedt@goodmis.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ virt: tdx-guest: Just leak decrypted memory on unrecoverable errors (@Li RongQing in [1429ae7b7d4759a](https://github.com/sophgo/linux-riscv/commit/1429ae7b7d4759a) at 2025-01-02 09:34:22)
    > commit 27834971f616c5e154423c578fa95e0444444ce1 upstream.
    > In CoCo VMs it is possible for the untrusted host to cause
    > set_memory_decrypted() to fail such that an error is returned
    > and the resulting memory is shared. Callers need to take care
    > to handle these errors to avoid returning decrypted (shared)
    > memory to the page allocator, which could lead to functional
    > or security issues.
    > Leak the decrypted memory when set_memory_decrypted() fails,
    > and don&#x27;t need to print an error since set_memory_decrypted()
    > will call WARN_ONCE().
    > Fixes: f4738f56d1dc (&quot;virt: tdx-guest: Add Quote generation support using TSM_REPORTS&quot;)
    > Signed-off-by: Li RongQing &lt;lirongqing@baidu.com&gt;
    > Signed-off-by: Dave Hansen &lt;dave.hansen@linux.intel.com&gt;
    > Signed-off-by: Ingo Molnar &lt;mingo@kernel.org&gt;
    > Reviewed-by: Rick Edgecombe &lt;rick.p.edgecombe@intel.com&gt;
    > Reviewed-by: Kirill A. Shutemov &lt;kirill.shutemov@linux.intel.com&gt;
    > Cc: stable@vger.kernel.org
    > Link: https://lore.kernel.org/all/20240619111801.25630-1-lirongqing%40baidu.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ tracing: Constify string literal data member in struct trace_event_call (@Christian Göttsche in [a744146969a0ec8](https://github.com/sophgo/linux-riscv/commit/a744146969a0ec8) at 2025-01-02 09:34:21)
    > commit 452f4b31e3f70a52b97890888eeb9eaa9a87139a upstream.
    > The name member of the struct trace_event_call is assigned with
    > generated string literals; declare them pointer to read-only.
    > Reported by clang:
    > security/landlock/syscalls.c:179:1: warning: initializing &#x27;char *&#x27; with an expression of type &#x27;const char[34]&#x27; discards qualifiers [-Wincompatible-pointer-types-discards-qualifiers]
    > 179 | SYSCALL_DEFINE3(landlock_create_ruleset,
    > | ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    > 180 |                 const struct landlock_ruleset_attr __user *const, attr,
    > |                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    > 181 |                 const size_t, size, const __u32, flags)
    > |                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    > ./include/linux/syscalls.h:226:36: note: expanded from macro &#x27;SYSCALL_DEFINE3&#x27;
    > 226 | #define SYSCALL_DEFINE3(name, ...) SYSCALL_DEFINEx(3, _##name, __VA_ARGS__)
    > |                                    ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    > ./include/linux/syscalls.h:234:2: note: expanded from macro &#x27;SYSCALL_DEFINEx&#x27;
    > 234 |         SYSCALL_METADATA(sname, x, __VA_ARGS__)                 \
    > |         ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    > ./include/linux/syscalls.h:184:2: note: expanded from macro &#x27;SYSCALL_METADATA&#x27;
    > 184 |         SYSCALL_TRACE_ENTER_EVENT(sname);                       \
    > |         ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    > ./include/linux/syscalls.h:151:30: note: expanded from macro &#x27;SYSCALL_TRACE_ENTER_EVENT&#x27;
    > 151 |                         .name                   &#x3D; &quot;sys_enter&quot;#sname,    \
    > |                                                   ^~~~~~~~~~~~~~~~~
    > Cc: stable@vger.kernel.org
    > Cc: Masami Hiramatsu &lt;mhiramat@kernel.org&gt;
    > Cc: Mathieu Desnoyers &lt;mathieu.desnoyers@efficios.com&gt;
    > Cc: Mickaël Salaün &lt;mic@digikod.net&gt;
    > Cc: Günther Noack &lt;gnoack@google.com&gt;
    > Cc: Nathan Chancellor &lt;nathan@kernel.org&gt;
    > Cc: Nick Desaulniers &lt;ndesaulniers@google.com&gt;
    > Cc: Bill Wendling &lt;morbo@google.com&gt;
    > Cc: Justin Stitt &lt;justinstitt@google.com&gt;
    > Link: https://lore.kernel.org/20241125105028.42807-1-cgoettsche@seltendoof.de
    > Fixes: b77e38aa240c3 (&quot;tracing: add event trace infrastructure&quot;)
    > Signed-off-by: Christian Göttsche &lt;cgzones@googlemail.com&gt;
    > Signed-off-by: Steven Rostedt (Google) &lt;rostedt@goodmis.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ dmaengine: loongson2-apb: Change GENMASK to GENMASK_ULL (@Binbin Zhou in [908dd70d54463ee](https://github.com/sophgo/linux-riscv/commit/908dd70d54463ee) at 2025-01-02 09:34:21)
    > [ Upstream commit 4b65d5322e1d8994acfdb9b867aa00bdb30d177b ]
    > Fix the following smatch static checker warning:
    > drivers/dma/loongson2-apb-dma.c:189 ls2x_dma_write_cmd()
    > warn: was expecting a 64 bit value instead of &#x27;~(((0)) + (((~((0))) - (((1)) &lt;&lt; (0)) + 1) &amp; (~((0)) &gt;&gt; ((8 * 4) - 1 - (4)))))&#x27;
    > The GENMASK macro used &quot;unsigned long&quot;, which caused build issues when
    > using a 32-bit toolchain because it would try to access bits &gt; 31. This
    > patch switches GENMASK to GENMASK_ULL, which uses &quot;unsigned long long&quot;.
    > Fixes: 71e7d3cb6e55 (&quot;dmaengine: ls2x-apb: New driver for the Loongson LS2X APB DMA controller&quot;)
    > Reported-by: Dan Carpenter &lt;dan.carpenter@linaro.org&gt;
    > Closes: https://lore.kernel.org/all/87cdc025-7246-4548-85ca-3d36fdc2be2d@stanley.mountain/
    > Signed-off-by: Binbin Zhou &lt;zhoubinbin@loongson.cn&gt;
    > Link: https://lore.kernel.org/r/20241028093413.1145820-1-zhoubinbin@loongson.cn
    > Signed-off-by: Vinod Koul &lt;vkoul@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ perf/x86/intel/uncore: Add Clearwater Forest support (@Kan Liang in [8659da87d216780](https://github.com/sophgo/linux-riscv/commit/8659da87d216780) at 2025-01-02 09:34:21)
    > commit b6ccddd6fe1fd49c7a82b6fbed01cccad21a29c7 upstream.
    > From the perspective of the uncore PMU, the Clearwater Forest is the
    > same as the previous Sierra Forest. The only difference is the event
    > list, which will be supported in the perf tool later.
    > Signed-off-by: Kan Liang &lt;kan.liang@linux.intel.com&gt;
    > Signed-off-by: Peter Zijlstra (Intel) &lt;peterz@infradead.org&gt;
    > Link: https://lkml.kernel.org/r/20241211161146.235253-1-kan.liang@linux.intel.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ freezer, sched: Report frozen tasks as &#x27;D&#x27; instead of &#x27;R&#x27; (@Chen Ridong in [79a47fd0f176606](https://github.com/sophgo/linux-riscv/commit/79a47fd0f176606) at 2025-01-02 09:34:21)
    > [ Upstream commit f718faf3940e95d5d34af9041f279f598396ab7d ]
    > Before commit:
    > f5d39b020809 (&quot;freezer,sched: Rewrite core freezer logic&quot;)
    > the frozen task stat was reported as &#x27;D&#x27; in cgroup v1.
    > However, after rewriting the core freezer logic, the frozen task stat is
    > reported as &#x27;R&#x27;. This is confusing, especially when a task with stat of
    > &#x27;S&#x27; is frozen.
    > This bug can be reproduced with these steps:
    > $ cd /sys/fs/cgroup/freezer/
    > $ mkdir test
    > $ sleep 1000 &amp;
    > [1] 739         // task whose stat is &#x27;S&#x27;
    > $ echo 739 &gt; test/cgroup.procs
    > $ echo FROZEN &gt; test/freezer.state
    > $ ps -aux | grep 739
    > root     739  0.1  0.0   8376  1812 pts/0    R    10:56   0:00 sleep 1000
    > As shown above, a task whose stat is &#x27;S&#x27; was changed to &#x27;R&#x27; when it was
    > frozen.
    > To solve this regression, simply maintain the same reported state as
    > before the rewrite.
    > [ mingo: Enhanced the changelog and comments ]
    > Fixes: f5d39b020809 (&quot;freezer,sched: Rewrite core freezer logic&quot;)
    > Signed-off-by: Chen Ridong &lt;chenridong@huawei.com&gt;
    > Signed-off-by: Peter Zijlstra (Intel) &lt;peterz@infradead.org&gt;
    > Signed-off-by: Ingo Molnar &lt;mingo@kernel.org&gt;
    > Acked-by: Tejun Heo &lt;tj@kernel.org&gt;
    > Acked-by: Michal Koutný &lt;mkoutny@suse.com&gt;
    > Link: https://lore.kernel.org/r/20241217004818.3200515-1-chenridong@huaweicloud.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/xe: Take PM ref in delayed snapshot capture worker (@Matthew Brost in [5db43dfda1f232c](https://github.com/sophgo/linux-riscv/commit/5db43dfda1f232c) at 2025-01-02 09:34:21)
    > [ Upstream commit aef0b4a07277f715bfc2a0d76a16da2bc4e89205 ]
    > The delayed snapshot capture worker can access the GPU or VRAM both of
    > which require a PM reference. Take a reference in this worker.
    > Cc: Rodrigo Vivi &lt;rodrigo.vivi@intel.com&gt;
    > Cc: Maarten Lankhorst &lt;maarten.lankhorst@linux.intel.com&gt;
    > Fixes: 4f04d07c0a94 (&quot;drm/xe: Faster devcoredump&quot;)
    > Signed-off-by: Matthew Brost &lt;matthew.brost@intel.com&gt;
    > Reviewed-by: Matthew Auld &lt;matthew.auld@intel.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20241126174615.2665852-5-matthew.brost@intel.com
    > (cherry picked from commit 1c6878af115a4586a40d6c14d530fa9f93e0bd83)
    > Signed-off-by: Thomas Hellström &lt;thomas.hellstrom@linux.intel.com&gt;
    > Stable-dep-of: 5dce85fecb87 (&quot;drm/xe: Move the coredump registration to the worker thread&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ objtool: Add bch2_trans_unlocked_error() to bcachefs noreturns (@chenchangcheng in [2cae02a84b98064](https://github.com/sophgo/linux-riscv/commit/2cae02a84b98064) at 2025-01-02 09:34:21)
    > [ Upstream commit 31ad36a271290648e7c2288a03d7b933d20254d6 ]
    > Fix the following objtool warning during build time:
    > fs/bcachefs/btree_trans_commit.o: warning: objtool: bch2_trans_commit_write_locked.isra.0() falls through to next function do_bch2_trans_commit.isra.0()
    > fs/bcachefs/btree_trans_commit.o: warning: objtool: .text: unexpected end of section
    > ......
    > fs/bcachefs/btree_update.o: warning: objtool: bch2_trans_update_get_key_cache() falls through to next function flush_new_cached_update()
    > fs/bcachefs/btree_update.o: warning: objtool: flush_new_cached_update() falls through to next function bch2_trans_update_by_path()
    > bch2_trans_unlocked_error() is an Obviously Correct (tm) panic() wrapper,
    > add it to the list of known noreturns.
    > [ mingo: Improved the changelog ]
    > Fixes: fd104e2967b7 (&quot;bcachefs: bch2_trans_verify_not_unlocked()&quot;)
    > Signed-off-by: chenchangcheng &lt;chenchangcheng@kylinos.cn&gt;
    > Signed-off-by: Peter Zijlstra (Intel) &lt;peterz@infradead.org&gt;
    > Signed-off-by: Ingo Molnar &lt;mingo@kernel.org&gt;
    > Link: https://lkml.kernel.org/r/20241220074847.3418134-1-ccc194101@163.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/xe: Move the coredump registration to the worker thread (@John Harrison in [1d397722cf3e78a](https://github.com/sophgo/linux-riscv/commit/1d397722cf3e78a) at 2025-01-02 09:34:21)
    > [ Upstream commit 5dce85fecb87751ec94526e1ac516dd7871e2e0c ]
    > Adding lockdep checking to the coredump code showed that there was an
    > existing violation. The dev_coredumpm_timeout() call is used to
    > register the dump with the base coredump subsystem. However, that
    > makes multiple memory allocations, only some of which use the GFP_
    > flags passed in. So that also needs to be deferred to the worker
    > function where it is safe to allocate with arbitrary flags.
    > In order to not add protoypes for the callback functions, moving the
    > _timeout call also means moving the worker thread function to later in
    > the file.
    > v2: Rebased after other changes to the worker function.
    > Fixes: e799485044cb (&quot;drm/xe: Introduce the dev_coredump infrastructure.&quot;)
    > Cc: Thomas Hellström &lt;thomas.hellstrom@linux.intel.com&gt;
    > Cc: Matthew Brost &lt;matthew.brost@intel.com&gt;
    > Cc: Jani Nikula &lt;jani.nikula@linux.intel.com&gt;
    > Cc: Daniel Vetter &lt;daniel.vetter@ffwll.ch&gt;
    > Cc: Francois Dugast &lt;francois.dugast@intel.com&gt;
    > Cc: Rodrigo Vivi &lt;rodrigo.vivi@intel.com&gt;
    > Cc: Lucas De Marchi &lt;lucas.demarchi@intel.com&gt;
    > Cc: &quot;Thomas Hellström&quot; &lt;thomas.hellstrom@linux.intel.com&gt;
    > Cc: Sumit Semwal &lt;sumit.semwal@linaro.org&gt;
    > Cc: &quot;Christian König&quot; &lt;christian.koenig@amd.com&gt;
    > Cc: intel-xe@lists.freedesktop.org
    > Cc: linux-media@vger.kernel.org
    > Cc: dri-devel@lists.freedesktop.org
    > Cc: linaro-mm-sig@lists.linaro.org
    > Cc: &lt;stable@vger.kernel.org&gt; # v6.8+
    > Signed-off-by: John Harrison &lt;John.C.Harrison@Intel.com&gt;
    > Reviewed-by: Matthew Brost &lt;matthew.brost@intel.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20241128210824.3302147-3-John.C.Harrison@Intel.com
    > (cherry picked from commit 90f51a7f4ec1004fc4ddfbc6d1f1068d85ef4771)
    > Signed-off-by: Thomas Hellström &lt;thomas.hellstrom@linux.intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ACPI/IORT: Add PMCG platform information for HiSilicon HIP09A (@Qinxin Xia in [d00e75e4fecf1ec](https://github.com/sophgo/linux-riscv/commit/d00e75e4fecf1ec) at 2025-01-02 09:34:20)
    > [ Upstream commit c2b46ae022704a2d845e59461fa24431ad627022 ]
    > HiSilicon HIP09A platforms using the same SMMU PMCG with HIP09
    > and thus suffers the same erratum. List them in the PMCG platform
    > information list without introducing a new SMMU PMCG Model.
    > Update the silicon-errata.rst as well.
    > Reviewed-by: Yicong Yang &lt;yangyicong@hisilicon.com&gt;
    > Acked-by: Hanjun Guo &lt;guohanjun@huawei.com&gt;
    > Signed-off-by: Qinxin Xia &lt;xiaqinxin@huawei.com&gt;
    > Link: https://lore.kernel.org/r/20241205013331.1484017-1-xiaqinxin@huawei.com
    > Signed-off-by: Catalin Marinas &lt;catalin.marinas@arm.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/dp_mst: Ensure mst_primary pointer is valid in drm_dp_mst_handle_up_req() (@Imre Deak in [ce55818b2d3a999](https://github.com/sophgo/linux-riscv/commit/ce55818b2d3a999) at 2025-01-02 09:34:20)
    > [ Upstream commit e54b00086f7473dbda1a7d6fc47720ced157c6a8 ]
    > While receiving an MST up request message from one thread in
    > drm_dp_mst_handle_up_req(), the MST topology could be removed from
    > another thread via drm_dp_mst_topology_mgr_set_mst(false), freeing
    > mst_primary and setting drm_dp_mst_topology_mgr::mst_primary to NULL.
    > This could lead to a NULL deref/use-after-free of mst_primary in
    > drm_dp_mst_handle_up_req().
    > Avoid the above by holding a reference for mst_primary in
    > drm_dp_mst_handle_up_req() while it&#x27;s used.
    > v2: Fix kfreeing the request if getting an mst_primary reference fails.
    > Cc: Lyude Paul &lt;lyude@redhat.com&gt;
    > Reviewed-by: Lyude Paul &lt;lyude@redhat.com&gt; (v1)
    > Signed-off-by: Imre Deak &lt;imre.deak@intel.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20241204132007.3132494-1-imre.deak@intel.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ wifi: iwlwifi: be less noisy if the NIC is dead in S3 (@Emmanuel Grumbach in [ccdc8fd86fc7b34](https://github.com/sophgo/linux-riscv/commit/ccdc8fd86fc7b34) at 2025-01-02 09:34:20)
    > commit 0572b7715ffd2cac20aac00333706f3094028180 upstream
    > If the NIC is dead upon resume, try to catch the error earlier and exit
    > earlier. We&#x27;ll print less error messages and get to the same recovery
    > path as before: reload the firmware.
    > Signed-off-by: Emmanuel Grumbach &lt;emmanuel.grumbach@intel.com&gt;
    > Signed-off-by: Miri Korenblit &lt;miriam.rachel.korenblit@intel.com&gt;
    > Link: https://patch.msgid.link/20241028135215.3a18682261e5.I18f336a4537378a4c1a8537d7246cee1fc82b42c@changeid
    > Signed-off-by: Johannes Berg &lt;johannes.berg@intel.com&gt;
    > Closes: https://bugzilla.kernel.org/show_bug.cgi?id&#x3D;219597
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ virtio-blk: don&#x27;t keep queue frozen during system suspend (@Ming Lei in [92d5139b91147ab](https://github.com/sophgo/linux-riscv/commit/92d5139b91147ab) at 2025-01-02 09:34:20)
    > [ Upstream commit 7678abee0867e6b7fb89aa40f6e9f575f755fb37 ]
    > Commit 4ce6e2db00de (&quot;virtio-blk: Ensure no requests in virtqueues before
    > deleting vqs.&quot;) replaces queue quiesce with queue freeze in virtio-blk&#x27;s
    > PM callbacks. And the motivation is to drain inflight IOs before suspending.
    > block layer&#x27;s queue freeze looks very handy, but it is also easy to cause
    > deadlock, such as, any attempt to call into bio_queue_enter() may run into
    > deadlock if the queue is frozen in current context. There are all kinds
    > of -&gt;suspend() called in suspend context, so keeping queue frozen in the
    > whole suspend context isn&#x27;t one good idea. And Marek reported lockdep
    > warning[1] caused by virtio-blk&#x27;s freeze queue in virtblk_freeze().
    > [1] https://lore.kernel.org/linux-block/ca16370e-d646-4eee-b9cc-87277c89c43c@samsung.com/
    > Given the motivation is to drain in-flight IOs, it can be done by calling
    > freeze &amp; unfreeze, meantime restore to previous behavior by keeping queue
    > quiesced during suspend.
    > Cc: Yi Sun &lt;yi.sun@unisoc.com&gt;
    > Cc: Michael S. Tsirkin &lt;mst@redhat.com&gt;
    > Cc: Jason Wang &lt;jasowang@redhat.com&gt;
    > Cc: Stefan Hajnoczi &lt;stefanha@redhat.com&gt;
    > Cc: virtualization@lists.linux.dev
    > Reported-by: Marek Szyprowski &lt;m.szyprowski@samsung.com&gt;
    > Signed-off-by: Ming Lei &lt;ming.lei@redhat.com&gt;
    > Acked-by: Stefan Hajnoczi &lt;stefanha@redhat.com&gt;
    > Link: https://lore.kernel.org/r/20241112125821.1475793-1-ming.lei@redhat.com
    > Signed-off-by: Jens Axboe &lt;axboe@kernel.dk&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ublk: detach gendisk from ublk device if add_disk() fails (@Ming Lei in [7d680f2f76a3417](https://github.com/sophgo/linux-riscv/commit/7d680f2f76a3417) at 2025-01-02 09:34:20)
    > [ Upstream commit 75cd4005da5492129917a4a4ee45e81660556104 ]
    > Inside ublk_abort_requests(), gendisk is grabbed for aborting all
    > inflight requests. And ublk_abort_requests() is called when exiting
    > the uring context or handling timeout.
    > If add_disk() fails, the gendisk may have been freed when calling
    > ublk_abort_requests(), so use-after-free can be caused when getting
    > disk&#x27;s reference in ublk_abort_requests().
    > Fixes the bug by detaching gendisk from ublk device if add_disk() fails.
    > Fixes: bd23f6c2c2d0 (&quot;ublk: quiesce request queue when aborting queue&quot;)
    > Signed-off-by: Ming Lei &lt;ming.lei@redhat.com&gt;
    > Link: https://lore.kernel.org/r/20241225110640.351531-1-ming.lei@redhat.com
    > Signed-off-by: Jens Axboe &lt;axboe@kernel.dk&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ blk-mq: register cpuhp callback after hctx is added to xarray table (@Ming Lei in [16b54ee81d8a447](https://github.com/sophgo/linux-riscv/commit/16b54ee81d8a447) at 2025-01-02 09:34:20)
    > [ Upstream commit 4bf485a7db5d82ddd0f3ad2b299893199090375e ]
    > We need to retrieve &#x27;hctx&#x27; from xarray table in the cpuhp callback, so the
    > callback should be registered after this &#x27;hctx&#x27; is added to xarray table.
    > Cc: Reinette Chatre &lt;reinette.chatre@intel.com&gt;
    > Cc: Fenghua Yu &lt;fenghua.yu@intel.com&gt;
    > Cc: Peter Newman &lt;peternewman@google.com&gt;
    > Cc: Babu Moger &lt;babu.moger@amd.com&gt;
    > Cc: Luck Tony &lt;tony.luck@intel.com&gt;
    > Signed-off-by: Ming Lei &lt;ming.lei@redhat.com&gt;
    > Tested-by: Tony Luck &lt;tony.luck@intel.com&gt;
    > Link: https://lore.kernel.org/r/20241206111611.978870-2-ming.lei@redhat.com
    > Signed-off-by: Jens Axboe &lt;axboe@kernel.dk&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ spi: omap2-mcspi: Fix the IS_ERR() bug for devm_clk_get_optional_enabled() (@Purushothama Siddaiah in [0aca51715e688c9](https://github.com/sophgo/linux-riscv/commit/0aca51715e688c9) at 2025-01-02 09:34:20)
    > [ Upstream commit 4c6ac5446d060f0bf435ccc8bc3aa7b7b5f718ad ]
    > The devm_clk_get_optional_enabled() function returns error
    > pointers(PTR_ERR()). So use IS_ERR() to check it.
    > Verified on K3-J7200 EVM board, without clock node mentioned
    > in the device tree.
    > Signed-off-by: Purushothama Siddaiah &lt;psiddaiah@mvista.com&gt;
    > Reviewed-by: Corey Minyard &lt;cminyard@mvista.com&gt;
    > Link: https://patch.msgid.link/20241205070426.1861048-1-psiddaiah@mvista.com
    > Signed-off-by: Mark Brown &lt;broonie@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ scsi: mpi3mr: Synchronize access to ioctl data buffer (@Ranjan Kumar in [b8ed09e397f8e42](https://github.com/sophgo/linux-riscv/commit/b8ed09e397f8e42) at 2025-01-02 09:34:19)
    > [ Upstream commit 367ac16e5ff2dcd6b7f00a8f94e6ba98875cb397 ]
    > The driver serializes ioctls through a mutex lock but access to the
    > ioctl data buffer is not guarded by the mutex. This results in multiple
    > user threads being able to write to the driver&#x27;s ioctl buffer
    > simultaneously.
    > Protect the ioctl buffer with the ioctl mutex.
    > Signed-off-by: Sumit Saxena &lt;sumit.saxena@broadcom.com&gt;
    > Signed-off-by: Ranjan Kumar &lt;ranjan.kumar@broadcom.com&gt;
    > Link: https://lore.kernel.org/r/20241110194405.10108-2-ranjan.kumar@broadcom.com
    > Signed-off-by: Martin K. Petersen &lt;martin.petersen@oracle.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ spi: intel: Add Panther Lake SPI controller support (@Aapo Vienamo in [b34f7381cd10514](https://github.com/sophgo/linux-riscv/commit/b34f7381cd10514) at 2025-01-02 09:34:19)
    > [ Upstream commit ceb259e43bf572ba7d766e1679ba73861d16203a ]
    > The Panther Lake SPI controllers are compatible with the Cannon Lake
    > controllers. Add support for following SPI controller device IDs:
    > - H-series: 0xe323
    > - P-series: 0xe423
    > - U-series: 0xe423
    > Signed-off-by: Aapo Vienamo &lt;aapo.vienamo@iki.fi&gt;
    > Signed-off-by: Mika Westerberg &lt;mika.westerberg@linux.intel.com&gt;
    > Link: https://patch.msgid.link/20241204080208.1036537-1-mika.westerberg@linux.intel.com
    > Signed-off-by: Mark Brown &lt;broonie@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ scsi: mpi3mr: Fix corrupt config pages PHY state is switched in sysfs (@Ranjan Kumar in [869fdc6f0606060](https://github.com/sophgo/linux-riscv/commit/869fdc6f0606060) at 2025-01-02 09:34:19)
    > [ Upstream commit 711201a8b8334a397440ac0b859df0054e174bc9 ]
    > The driver, through the SAS transport, exposes a sysfs interface to
    > enable/disable PHYs in a controller/expander setup.  When multiple PHYs
    > are disabled and enabled in rapid succession, the persistent and current
    > config pages related to SAS IO unit/SAS Expander pages could get
    > corrupted.
    > Use separate memory for each config request.
    > Signed-off-by: Prayas Patel &lt;prayas.patel@broadcom.com&gt;
    > Signed-off-by: Ranjan Kumar &lt;ranjan.kumar@broadcom.com&gt;
    > Link: https://lore.kernel.org/r/20241110194405.10108-3-ranjan.kumar@broadcom.com
    > Signed-off-by: Martin K. Petersen &lt;martin.petersen@oracle.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ scsi: mpt3sas: Diag-Reset when Doorbell-In-Use bit is set during driver load time (@Ranjan Kumar in [4524a8d175f0391](https://github.com/sophgo/linux-riscv/commit/4524a8d175f0391) at 2025-01-02 09:34:19)
    > [ Upstream commit 3f5eb062e8aa335643181c480e6c590c6cedfd22 ]
    > Issue a Diag-Reset when the &quot;Doorbell-In-Use&quot; bit is set during the
    > driver load/initialization.
    > Signed-off-by: Ranjan Kumar &lt;ranjan.kumar@broadcom.com&gt;
    > Link: https://lore.kernel.org/r/20241110173341.11595-2-ranjan.kumar@broadcom.com
    > Signed-off-by: Martin K. Petersen &lt;martin.petersen@oracle.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ scsi: storvsc: Do not flag MAINTENANCE_IN return of SRB_STATUS_DATA_OVERRUN as an error (@Cathy Avery in [1aea06f703defaa](https://github.com/sophgo/linux-riscv/commit/1aea06f703defaa) at 2025-01-02 09:34:19)
    > [ Upstream commit b1aee7f034615b6824d2c70ddb37ef9fc23493b7 ]
    > This partially reverts commit 812fe6420a6e (&quot;scsi: storvsc: Handle
    > additional SRB status values&quot;).
    > HyperV does not support MAINTENANCE_IN resulting in FC passthrough
    > returning the SRB_STATUS_DATA_OVERRUN value. Now that
    > SRB_STATUS_DATA_OVERRUN is treated as an error, multipath ALUA paths go
    > into a faulty state as multipath ALUA submits RTPG commands via
    > MAINTENANCE_IN.
    > [    3.215560] hv_storvsc 1d69d403-9692-4460-89f9-a8cbcc0f94f3:
    > tag#230 cmd 0xa3 status: scsi 0x0 srb 0x12 hv 0xc0000001
    > [    3.215572] scsi 1:0:0:32: alua: rtpg failed, result 458752
    > Make MAINTENANCE_IN return success to avoid the error path as is
    > currently done with INQUIRY and MODE_SENSE.
    > Suggested-by: Michael Kelley &lt;mhklinux@outlook.com&gt;
    > Signed-off-by: Cathy Avery &lt;cavery@redhat.com&gt;
    > Link: https://lore.kernel.org/r/20241127181324.3318443-1-cavery@redhat.com
    > Reviewed-by: Michael Kelley &lt;mhklinux@outlook.com&gt;
    > Reviewed-by: Ewan D. Milne &lt;emilne@redhat.com&gt;
    > Signed-off-by: Martin K. Petersen &lt;martin.petersen@oracle.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ scsi: mpi3mr: Start controller indexing from 0 (@Ranjan Kumar in [0dd139341f043df](https://github.com/sophgo/linux-riscv/commit/0dd139341f043df) at 2025-01-02 09:34:19)
    > [ Upstream commit 0d32014f1e3e7a7adf1583c45387f26b9bb3a49d ]
    > Instead of displaying the controller index starting from &#x27;1&#x27; make the
    > driver display the controller index starting from &#x27;0&#x27;.
    > Signed-off-by: Sumit Saxena &lt;sumit.saxena@broadcom.com&gt;
    > Signed-off-by: Ranjan Kumar &lt;ranjan.kumar@broadcom.com&gt;
    > Link: https://lore.kernel.org/r/20241110194405.10108-4-ranjan.kumar@broadcom.com
    > Signed-off-by: Martin K. Petersen &lt;martin.petersen@oracle.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ scsi: mpi3mr: Handling of fault code for insufficient power (@Ranjan Kumar in [05d44e2571d4e24](https://github.com/sophgo/linux-riscv/commit/05d44e2571d4e24) at 2025-01-02 09:34:19)
    > [ Upstream commit fb6eb98f3965e2ee92cbcb466051d2f2acf552d1 ]
    > Before retrying initialization, check and abort if the fault code
    > indicates insufficient power. Also mark the controller as unrecoverable
    > instead of issuing reset in the watch dog timer if the fault code
    > indicates insufficient power.
    > Signed-off-by: Prayas Patel &lt;prayas.patel@broadcom.com&gt;
    > Signed-off-by: Ranjan Kumar &lt;ranjan.kumar@broadcom.com&gt;
    > Link: https://lore.kernel.org/r/20241110194405.10108-5-ranjan.kumar@broadcom.com
    > Signed-off-by: Martin K. Petersen &lt;martin.petersen@oracle.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ bpf: Zero index arg error string for dynptr and iter (@Kumar Kartikeya Dwivedi in [fdaaf929432f3ea](https://github.com/sophgo/linux-riscv/commit/fdaaf929432f3ea) at 2025-01-02 09:34:18)
    > [ Upstream commit bd74e238ae6944b462f57ce8752440a011ba4530 ]
    > Andrii spotted that process_dynptr_func&#x27;s rejection of incorrect
    > argument register type will print an error string where argument numbers
    > are not zero-indexed, unlike elsewhere in the verifier.  Fix this by
    > subtracting 1 from regno. The same scenario exists for iterator
    > messages. Fix selftest error strings that match on the exact argument
    > number while we&#x27;re at it to ensure clean bisection.
    > Suggested-by: Andrii Nakryiko &lt;andrii@kernel.org&gt;
    > Signed-off-by: Kumar Kartikeya Dwivedi &lt;memxor@gmail.com&gt;
    > Link: https://lore.kernel.org/r/20241203002235.3776418-1-memxor@gmail.com
    > Signed-off-by: Alexei Starovoitov &lt;ast@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ regmap: Use correct format specifier for logging range errors (@Mark Brown in [ca5995f805bbbe2](https://github.com/sophgo/linux-riscv/commit/ca5995f805bbbe2) at 2025-01-02 09:34:18)
    > [ Upstream commit 3f1aa0c533d9dd8a835caf9a6824449c463ee7e2 ]
    > The register addresses are unsigned ints so we should use %u not %d to
    > log them.
    > Signed-off-by: Mark Brown &lt;broonie@kernel.org&gt;
    > Link: https://patch.msgid.link/20241127-regmap-test-high-addr-v1-1-74a48a9e0dc5@kernel.org
    > Signed-off-by: Mark Brown &lt;broonie@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ platform/x86: asus-nb-wmi: Ignore unknown event 0xCF (@Armin Wolf in [a089dad6f92d211](https://github.com/sophgo/linux-riscv/commit/a089dad6f92d211) at 2025-01-02 09:34:18)
    > [ Upstream commit e9fba20c29e27dc99e55e1c550573a114561bf8c ]
    > On the Asus X541UAK an unknown event 0xCF is emited when the charger
    > is plugged in. This is caused by the following AML code:
    > If (ACPS ())
    > {
    > ACPF &#x3D; One
    > Local0 &#x3D; 0x58
    > If (ATKP)
    > {
    > ^^^^ATKD.IANE (0xCF)
    > }
    > }
    > Else
    > {
    > ACPF &#x3D; Zero
    > Local0 &#x3D; 0x57
    > }
    > Notify (AC0, 0x80) // Status Change
    > If (ATKP)
    > {
    > ^^^^ATKD.IANE (Local0)
    > }
    > Sleep (0x64)
    > PNOT ()
    > Sleep (0x0A)
    > NBAT (0x80)
    > Ignore the 0xCF event to silence the unknown event warning.
    > Reported-by: Pau Espin Pedrol &lt;pespin@espeweb.net&gt;
    > Closes: https://lore.kernel.org/platform-driver-x86/54d4860b-ec9c-4992-acf6-db3f90388293@espeweb.net
    > Signed-off-by: Armin Wolf &lt;W_Armin@gmx.de&gt;
    > Reviewed-by: Hans de Goede &lt;hdegoede@redhat.com&gt;
    > Link: https://lore.kernel.org/r/20241123224700.18530-1-W_Armin@gmx.de
    > Reviewed-by: Ilpo Järvinen &lt;ilpo.jarvinen@linux.intel.com&gt;
    > Signed-off-by: Ilpo Järvinen &lt;ilpo.jarvinen@linux.intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ smb: server: Fix building with GCC 15 (@Brahmajit Das in [98575bd6e7b143c](https://github.com/sophgo/linux-riscv/commit/98575bd6e7b143c) at 2025-01-02 09:34:18)
    > [ Upstream commit e18655cf35a5958fbf4ae9ca3ebf28871a3a1801 ]
    > GCC 15 introduces -Werror&#x3D;unterminated-string-initialization by default,
    > this results in the following build error
    > fs/smb/server/smb_common.c:21:35: error: initializer-string for array of &#x27;char&#x27; is too long [-Werror&#x3D;unterminated-string-ini
    > tialization]
    > 21 | static const char basechars[43] &#x3D; &quot;0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_-!@#$%&quot;;
    > |                                   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    > cc1: all warnings being treated as errors
    > To this we are replacing char basechars[43] with a character pointer
    > and then using strlen to get the length.
    > Signed-off-by: Brahmajit Das &lt;brahmajit.xyz@gmail.com&gt;
    > Acked-by: Namjae Jeon &lt;linkinjeon@kernel.org&gt;
    > Signed-off-by: Steve French &lt;stfrench@microsoft.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ LoongArch: Fix reserving screen info memory for above-4G firmware (@Huacai Chen in [45d7745c89c162f](https://github.com/sophgo/linux-riscv/commit/45d7745c89c162f) at 2025-01-02 09:34:18)
    > [ Upstream commit 55dc2f8f263448f1e6c7ef135d08e640d5a4826e ]
    > Since screen_info.lfb_base is a __u32 type, an above-4G address need an
    > ext_lfb_base to present its higher 32bits. In init_screen_info() we can
    > use __screen_info_lfb_base() to handle this case for reserving screen
    > info memory.
    > Signed-off-by: Xuefeng Zhao &lt;zhaoxuefeng@loongson.cn&gt;
    > Signed-off-by: Jianmin Lv &lt;lvjianmin@loongson.cn&gt;
    > Signed-off-by: Tianyang Zhang &lt;zhangtianyang@loongson.cn&gt;
    > Signed-off-by: Huacai Chen &lt;chenhuacai@loongson.cn&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ LoongArch: BPF: Adjust the parameter of emit_jirl() (@Tiezhu Yang in [2d95df70e5945c6](https://github.com/sophgo/linux-riscv/commit/2d95df70e5945c6) at 2025-01-02 09:34:18)
    > [ Upstream commit c1474bb0b7cff4e8481095bd0618b8f6c2f0aeb4 ]
    > The branch instructions beq, bne, blt, bge, bltu, bgeu and jirl belong
    > to the format reg2i16, but the sequence of oprand is different for the
    > instruction jirl. So adjust the parameter order of emit_jirl() to make
    > it more readable correspond with the Instruction Set Architecture manual.
    > Here are the instruction formats:
    > beq     rj, rd, offs16
    > bne     rj, rd, offs16
    > blt     rj, rd, offs16
    > bge     rj, rd, offs16
    > bltu    rj, rd, offs16
    > bgeu    rj, rd, offs16
    > jirl    rd, rj, offs16
    > Link: https://loongson.github.io/LoongArch-Documentation/LoongArch-Vol1-EN.html#branch-instructions
    > Suggested-by: Huacai Chen &lt;chenhuacai@loongson.cn&gt;
    > Signed-off-by: Tiezhu Yang &lt;yangtiezhu@loongson.cn&gt;
    > Signed-off-by: Huacai Chen &lt;chenhuacai@loongson.cn&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ALSA: ump: Don&#x27;t open legacy substream for an inactive group (@Takashi Iwai in [fc98df1d7a9e58f](https://github.com/sophgo/linux-riscv/commit/fc98df1d7a9e58f) at 2025-01-02 09:34:17)
    > [ Upstream commit 3978d53df7236f0a517c2abeb43ddf6ac162cdd8 ]
    > When a UMP Group is inactive, we shouldn&#x27;t allow users to access it
    > via the legacy MIDI access.  Add the group active flag check and
    > return -ENODEV if it&#x27;s inactive.
    > Link: https://patch.msgid.link/20241129094546.32119-2-tiwai@suse.de
    > Signed-off-by: Takashi Iwai &lt;tiwai@suse.de&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ALSA: ump: Update legacy substream names upon FB info update (@Takashi Iwai in [f0a3b2d9692d643](https://github.com/sophgo/linux-riscv/commit/f0a3b2d9692d643) at 2025-01-02 09:34:17)
    > [ Upstream commit edad3f9519fcacb926d0e3f3217aecaf628a593f ]
    > The legacy rawmidi substreams should be updated when UMP FB Info or
    > UMP FB Name are received, too.
    > Link: https://patch.msgid.link/20241129094546.32119-4-tiwai@suse.de
    > Signed-off-by: Takashi Iwai &lt;tiwai@suse.de&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ALSA: ump: Indicate the inactive group in legacy substream names (@Takashi Iwai in [9dc4b8a8a415d3d](https://github.com/sophgo/linux-riscv/commit/9dc4b8a8a415d3d) at 2025-01-02 09:34:17)
    > [ Upstream commit e29e504e7890b9ee438ca6370d0180d607c473f9 ]
    > Since the legacy rawmidi has no proper way to know the inactive group,
    > indicate it in the rawmidi substream names with &quot;[Inactive]&quot; suffix
    > when the corresponding UMP group is inactive.
    > Link: https://patch.msgid.link/20241129094546.32119-3-tiwai@suse.de
    > Signed-off-by: Takashi Iwai &lt;tiwai@suse.de&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ALSA: sh: Use standard helper for buffer accesses (@Takashi Iwai in [532a29e8fa28e80](https://github.com/sophgo/linux-riscv/commit/532a29e8fa28e80) at 2025-01-02 09:34:17)
    > [ Upstream commit 9b5f8ee43e48c25fbe1a10163ec04343d750acd0 ]
    > The SH DAC audio driver uses the kmalloc&#x27;ed buffer as the main PCM
    > buffer, and the data is transferred via hrtimer callbacks manually
    > from there to the hardware.  Meanwhile, some of its code are written
    > as if the buffer is on iomem and use the special helpers for the iomem
    > (e.g. copy_from_iter_toio() or memset_io()).  Those are rather useless
    > and the standard helpers should be used.
    > Similarly, the PCM mmap callback is set to a special one with
    > snd_pcm_lib_mmap_iomem, but this is also nonsense, because SH
    > architecture doesn&#x27;t support this function, hence it leads just to
    > NULL -- the fallback to the standard helper.
    > This patch replaces those special setups with the standard ones.
    > Reported-by: kernel test robot &lt;lkp@intel.com&gt;
    > Closes: https://lore.kernel.org/oe-kbuild-all/202411281337.I4M07b7i-lkp@intel.com/
    > Link: https://patch.msgid.link/20241128104939.13755-1-tiwai@suse.de
    > Signed-off-by: Takashi Iwai &lt;tiwai@suse.de&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ udf: Skip parent dir link count update if corrupted (@Jan Kara in [4d9b403474f03f9](https://github.com/sophgo/linux-riscv/commit/4d9b403474f03f9) at 2025-01-02 09:34:17)
    > [ Upstream commit c5566903af56dd1abb092f18dcb0c770d6cd8dcb ]
    > If the parent directory link count is too low (likely directory inode
    > corruption), just skip updating its link count as if it goes to 0 too
    > early it can cause unexpected issues.
    > Signed-off-by: Jan Kara &lt;jack@suse.cz&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ scsi: megaraid_sas: Fix for a potential deadlock (@Tomas Henzl in [466ca39dbf5d0ba](https://github.com/sophgo/linux-riscv/commit/466ca39dbf5d0ba) at 2025-01-02 09:34:17)
    > [ Upstream commit 50740f4dc78b41dec7c8e39772619d5ba841ddd7 ]
    > This fixes a &#x27;possible circular locking dependency detected&#x27; warning
    > CPU0                    CPU1
    > ----                    ----
    > lock(&amp;instance-&gt;reset_mutex);
    > lock(&amp;shost-&gt;scan_mutex);
    > lock(&amp;instance-&gt;reset_mutex);
    > lock(&amp;shost-&gt;scan_mutex);
    > Fix this by temporarily releasing the reset_mutex.
    > Signed-off-by: Tomas Henzl &lt;thenzl@redhat.com&gt;
    > Link: https://lore.kernel.org/r/20240923174833.45345-1-thenzl@redhat.com
    > Acked-by: Chandrakanth Patil &lt;chandrakanth.patil@broadcom.com&gt;
    > Signed-off-by: Martin K. Petersen &lt;martin.petersen@oracle.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ALSA: hda/conexant: fix Z60MR100 startup pop issue (@bo liu in [4287eb3951ca1f4](https://github.com/sophgo/linux-riscv/commit/4287eb3951ca1f4) at 2025-01-02 09:34:17)
    > [ Upstream commit 947c4012f8f03a8bb946beb6e5294d5e32817d67 ]
    > When Z60MR100 startup, speaker will output a pop. To fix this issue,
    > we mute codec by init verbs in bios when system startup, and set GPIO
    > to low to unmute codec in codec driver when it loaded .
    > [ white space fixes and compile warning fix by tiwai ]
    > Signed-off-by: bo liu &lt;bo.liu@senarytech.com&gt;
    > Link: https://patch.msgid.link/20241129014441.437205-1-bo.liu@senarytech.com
    > Signed-off-by: Takashi Iwai &lt;tiwai@suse.de&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ udf: Verify inode link counts before performing rename (@Jan Kara in [0a65d850c45dee4](https://github.com/sophgo/linux-riscv/commit/0a65d850c45dee4) at 2025-01-02 09:34:17)
    > [ Upstream commit 6756af923e06aa33ad8894aaecbf9060953ba00f ]
    > During rename, we are updating link counts of various inodes either when
    > rename deletes target or when moving directory across directories.
    > Verify involved link counts are sane so that we don&#x27;t trip warnings in
    > VFS.
    > Reported-by: syzbot+3ff7365dc04a6bcafa66@syzkaller.appspotmail.com
    > Signed-off-by: Jan Kara &lt;jack@suse.cz&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ watchdog: it87_wdt: add PWRGD enable quirk for Qotom QCML04 (@James Hilliard in [b94011427ee3c90](https://github.com/sophgo/linux-riscv/commit/b94011427ee3c90) at 2025-01-02 09:34:16)
    > [ Upstream commit 43439076383a7611300334d1357c0f8883f40816 ]
    > For the watchdog timer to work properly on the QCML04 board we need to
    > set PWRGD enable in the Environment Controller Configuration Registers
    > Special Configuration Register 1 when it is not already set, this may
    > be the case when the watchdog is not enabled from within the BIOS.
    > Signed-off-by: James Hilliard &lt;james.hilliard1@gmail.com&gt;
    > Reviewed-by: Guenter Roeck &lt;linux@roeck-us.net&gt;
    > Link: https://lore.kernel.org/r/20241025063441.3494837-1-james.hilliard1@gmail.com
    > Signed-off-by: Guenter Roeck &lt;linux@roeck-us.net&gt;
    > Signed-off-by: Wim Van Sebroeck &lt;wim@linux-watchdog.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ Revert &quot;watchdog: s3c2410_wdt: use exynos_get_pmu_regmap_by_phandle() for PMU regs&quot; (@Peter Griffin in [a42417a8cffc01e](https://github.com/sophgo/linux-riscv/commit/a42417a8cffc01e) at 2025-01-02 09:34:16)
    > [ Upstream commit ccfb765944bb66813398958983cb8141e2624a6b ]
    > This reverts commit 746f0770f916e6c48e422d6a34e67eae16707f0e.
    > Now that we can register a SoC specific regmap with syscon using
    > of_syscon_register_regmap() api we can switch back to using
    > syscon_regmap_lookup_by_phandle() in the client drivers.
    > Signed-off-by: Peter Griffin &lt;peter.griffin@linaro.org&gt;
    > Reviewed-by: Sam Protsenko &lt;semen.protsenko@linaro.org&gt;
    > Reviewed-by: Guenter Roeck &lt;linux@roeck-us.net&gt;
    > Link: https://lore.kernel.org/r/20241029191131.2329414-1-peter.griffin@linaro.org
    > Signed-off-by: Guenter Roeck &lt;linux@roeck-us.net&gt;
    > Signed-off-by: Wim Van Sebroeck &lt;wim@linux-watchdog.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ stddef: make __struct_group() UAPI C++-friendly (@Alexander Lobakin in [a39ff5bf2357c73](https://github.com/sophgo/linux-riscv/commit/a39ff5bf2357c73) at 2025-01-02 09:34:16)
    > [ Upstream commit 724c6ce38bbaeb4b3f109b0e066d6c0ecd15446c ]
    > For the most part of the C++ history, it couldn&#x27;t have type
    > declarations inside anonymous unions for different reasons. At the
    > same time, __struct_group() relies on the latters, so when the @TAG
    > argument is not empty, C++ code doesn&#x27;t want to build (even under
    > &#x60;extern &quot;C&quot;&#x60;):
    > ../linux/include/uapi/linux/pkt_cls.h:25:24: error:
    > &#x27;struct tc_u32_sel::&lt;unnamed union&gt;::tc_u32_sel_hdr,&#x27; invalid;
    > an anonymous union may only have public non-static data members
    > [-fpermissive]
    > The safest way to fix this without trying to switch standards (which
    > is impossible in UAPI anyway) etc., is to disable tag declaration
    > for that language. This won&#x27;t break anything since for now it&#x27;s not
    > buildable at all.
    > Use a separate definition for __struct_group() when __cplusplus is
    > defined to mitigate the error, including the version from tools/.
    > Fixes: 50d7bd38c3aa (&quot;stddef: Introduce struct_group() helper macro&quot;)
    > Reported-by: Christopher Ferris &lt;cferris@google.com&gt;
    > Closes: https://lore.kernel.org/linux-hardening/Z1HZpe3WE5As8UAz@google.com
    > Suggested-by: Kees Cook &lt;kees@kernel.org&gt; # __struct_group_tag()
    > Signed-off-by: Alexander Lobakin &lt;aleksander.lobakin@intel.com&gt;
    > Reviewed-by: Gustavo A. R. Silva &lt;gustavoars@kernel.org&gt;
    > Link: https://lore.kernel.org/r/20241219135734.2130002-1-aleksander.lobakin@intel.com
    > Signed-off-by: Kees Cook &lt;kees@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ tracing/kprobe: Make trace_kprobe&#x27;s module callback called after jump_label update (@Masami Hiramatsu (Google) in [68662d78afbc03d](https://github.com/sophgo/linux-riscv/commit/68662d78afbc03d) at 2025-01-02 09:34:16)
    > [ Upstream commit d685d55dfc86b1a4bdcec77c3c1f8a83f181264e ]
    > Make sure the trace_kprobe&#x27;s module notifer callback function is called
    > after jump_label&#x27;s callback is called. Since the trace_kprobe&#x27;s callback
    > eventually checks jump_label address during registering new kprobe on
    > the loading module, jump_label must be updated before this registration
    > happens.
    > Link: https://lore.kernel.org/all/173387585556.995044.3157941002975446119.stgit@devnote2/
    > Fixes: 614243181050 (&quot;tracing/kprobes: Support module init function probing&quot;)
    > Signed-off-by: Masami Hiramatsu (Google) &lt;mhiramat@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ scsi: qla1280: Fix hw revision numbering for ISP1020/1040 (@Magnus Lindholm in [65289f50c18db50](https://github.com/sophgo/linux-riscv/commit/65289f50c18db50) at 2025-01-02 09:34:16)
    > [ Upstream commit c064de86d2a3909222d5996c5047f64c7a8f791b ]
    > Fix the hardware revision numbering for Qlogic ISP1020/1040 boards.  HWMASK
    > suggests that the revision number only needs four bits, this is consistent
    > with how NetBSD does things in their ISP driver. Verified on a IPS1040B
    > which is seen as rev 5 not as BIT_4.
    > Signed-off-by: Magnus Lindholm &lt;linmag7@gmail.com&gt;
    > Link: https://lore.kernel.org/r/20241113225636.2276-1-linmag7@gmail.com
    > Reviewed-by: Christoph Hellwig &lt;hch@lst.de&gt;
    > Signed-off-by: Martin K. Petersen &lt;martin.petersen@oracle.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ watchdog: mediatek: Add support for MT6735 TOPRGU/WDT (@Yassine Oudjana in [56216257d4292a4](https://github.com/sophgo/linux-riscv/commit/56216257d4292a4) at 2025-01-02 09:34:16)
    > [ Upstream commit 15ddf704f56f8c95ff74dfd1157ed8646b322fa1 ]
    > Add support for the Top Reset Generation Unit/Watchdog Timer found on
    > MT6735.
    > Signed-off-by: Yassine Oudjana &lt;y.oudjana@protonmail.com&gt;
    > Reviewed-by: AngeloGioacchino Del Regno &lt;angelogioacchino.delregno@collabora.com&gt;
    > Reviewed-by: Guenter Roeck &lt;linux@roeck-us.net&gt;
    > Link: https://lore.kernel.org/r/20241106104738.195968-3-y.oudjana@protonmail.com
    > Signed-off-by: Guenter Roeck &lt;linux@roeck-us.net&gt;
    > Signed-off-by: Wim Van Sebroeck &lt;wim@linux-watchdog.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ watchdog: rzg2l_wdt: Power on the watchdog domain in the restart handler (@Claudiu Beznea in [486fc631cc499a1](https://github.com/sophgo/linux-riscv/commit/486fc631cc499a1) at 2025-01-02 09:34:16)
    > [ Upstream commit bad201b2ac4e238c6d4b6966a220240e3861640c ]
    > On RZ/G3S the watchdog can be part of a software-controlled PM domain. In
    > this case, the watchdog device need to be powered on in
    > struct watchdog_ops::restart API. This can be done though
    > pm_runtime_resume_and_get() API if the watchdog PM domain and watchdog
    > device are marked as IRQ safe. We mark the watchdog PM domain as IRQ safe
    > with GENPD_FLAG_IRQ_SAFE when the watchdog PM domain is registered and the
    > watchdog device though pm_runtime_irq_safe().
    > Before commit e4cf89596c1f (&quot;watchdog: rzg2l_wdt: Fix &#x27;BUG: Invalid wait
    > context&#x27;&quot;) pm_runtime_get_sync() was used in watchdog restart handler
    > (which is similar to pm_runtime_resume_and_get() except the later one
    > handles the runtime resume errors).
    > Commit e4cf89596c1f (&quot;watchdog: rzg2l_wdt: Fix &#x27;BUG: Invalid wait
    > context&#x27;&quot;) dropped the pm_runtime_get_sync() and replaced it with
    > clk_prepare_enable() to avoid invalid wait context due to genpd_lock()
    > in genpd_runtime_resume() being called from atomic context. But
    > clk_prepare_enable() doesn&#x27;t fit for this either (as reported by
    > Ulf Hansson) as clk_prepare() can also sleep (it just not throw invalid
    > wait context warning as it is not written for this).
    > Because the watchdog device is marked now as IRQ safe (though this patch)
    > the irq_safe_dev_in_sleep_domain() call from genpd_runtime_resume() returns
    > 1 for devices not registering an IRQ safe PM domain for watchdog (as the
    > watchdog device is IRQ safe, PM domain is not and watchdog PM domain is
    > always-on), this being the case for RZ/G3S with old device trees and
    > the rest of the SoCs that use this driver, we can now drop also the
    > clk_prepare_enable() calls in restart handler and rely on
    > pm_runtime_resume_and_get().
    > Thus, drop clk_prepare_enable() and use pm_runtime_resume_and_get() in
    > watchdog restart handler.
    > Signed-off-by: Claudiu Beznea &lt;claudiu.beznea.uj@bp.renesas.com&gt;
    > Reviewed-by: Ulf Hansson &lt;ulf.hansson@linaro.org&gt;
    > Reviewed-by: Geert Uytterhoeven &lt;geert+renesas@glider.be&gt;
    > Acked-by: Guenter Roeck &lt;linux@roeck-us.net&gt;
    > Link: https://lore.kernel.org/r/20241015164732.4085249-5-claudiu.beznea.uj@bp.renesas.com
    > Signed-off-by: Guenter Roeck &lt;linux@roeck-us.net&gt;
    > Signed-off-by: Wim Van Sebroeck &lt;wim@linux-watchdog.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ASoC: Intel: sof_sdw: Fix DMI match for Lenovo 21QA and 21QB (@Richard Fitzgerald in [f4d68bdfaef6a0d](https://github.com/sophgo/linux-riscv/commit/f4d68bdfaef6a0d) at 2025-01-02 09:34:15)
    > commit ba7d47a54bf23a7201bdd2978e16b04fc1cb1f6e upstream.
    > Update the DMI match for a Lenovo laptop to the new DMI identifier.
    > This laptop ships with a different DMI identifier to what was expected,
    > and now has two identifiers.
    > Signed-off-by: Richard Fitzgerald &lt;rf@opensource.cirrus.com&gt;
    > Fixes: ea657f6b24e1 (&quot;ASoC: Intel: sof_sdw: Add quirk for cs42l43 system using host DMICs&quot;)
    > Signed-off-by: Bard Liao &lt;yung-chuan.liao@linux.intel.com&gt;
    > Link: https://patch.msgid.link/20241216140821.153670-3-yung-chuan.liao@linux.intel.com
    > Signed-off-by: Mark Brown &lt;broonie@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ mtd: rawnand: fix double free in atmel_pmecc_create_user() (@Dan Carpenter in [d2f090ea57f8d65](https://github.com/sophgo/linux-riscv/commit/d2f090ea57f8d65) at 2025-01-02 09:34:15)
    > commit d8e4771f99c0400a1873235704b28bb803c83d17 upstream.
    > The &quot;user&quot; pointer was converted from being allocated with kzalloc() to
    > being allocated by devm_kzalloc().  Calling kfree(user) will lead to a
    > double free.
    > Fixes: 6d734f1bfc33 (&quot;mtd: rawnand: atmel: Fix possible memory leak&quot;)
    > Signed-off-by: Dan Carpenter &lt;dan.carpenter@linaro.org&gt;
    > Signed-off-by: Miquel Raynal &lt;miquel.raynal@bootlin.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ ASoC: amd: ps: Fix for enabling DMIC on acp63 platform via _DSD entry (@Venkata Prasad Potturu in [7a51e3a5a1b8af7](https://github.com/sophgo/linux-riscv/commit/7a51e3a5a1b8af7) at 2025-01-02 09:34:15)
    > commit 88438444fdddd0244c8b2697713adcca3e71599e upstream.
    > Add condition check to register ACP PDM sound card by reading
    > _WOV acpi entry.
    > Fixes: 0386d765f27a (&quot;ASoC: amd: ps: refactor acp device configuration read logic&quot;)
    > Signed-off-by: Venkata Prasad Potturu &lt;venkataprasad.potturu@amd.com&gt;
    > Link: https://patch.msgid.link/20241213061147.1060451-1-venkataprasad.potturu@amd.com
    > Signed-off-by: Mark Brown &lt;broonie@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ powerpc/pseries/vas: Add close() callback in vas_vm_ops struct (@Haren Myneni in [6d9cd27105459f1](https://github.com/sophgo/linux-riscv/commit/6d9cd27105459f1) at 2025-01-02 09:34:15)
    > [ Upstream commit 05aa156e156ef3168e7ab8a68721945196495c17 ]
    > The mapping VMA address is saved in VAS window struct when the
    > paste address is mapped. This VMA address is used during migration
    > to unmap the paste address if the window is active. The paste
    > address mapping will be removed when the window is closed or with
    > the munmap(). But the VMA address in the VAS window is not updated
    > with munmap() which is causing invalid access during migration.
    > The KASAN report shows:
    > [16386.254991] BUG: KASAN: slab-use-after-free in reconfig_close_windows+0x1a0/0x4e8
    > [16386.255043] Read of size 8 at addr c00000014a819670 by task drmgr/696928
    > [16386.255096] CPU: 29 UID: 0 PID: 696928 Comm: drmgr Kdump: loaded Tainted: G    B              6.11.0-rc5-nxgzip #2
    > [16386.255128] Tainted: [B]&#x3D;BAD_PAGE
    > [16386.255148] Hardware name: IBM,9080-HEX Power11 (architected) 0x820200 0xf000007 of:IBM,FW1110.00 (NH1110_016) hv:phyp pSeries
    > [16386.255181] Call Trace:
    > [16386.255202] [c00000016b297660] [c0000000018ad0ac] dump_stack_lvl+0x84/0xe8 (unreliable)
    > [16386.255246] [c00000016b297690] [c0000000006e8a90] print_report+0x19c/0x764
    > [16386.255285] [c00000016b297760] [c0000000006e9490] kasan_report+0x128/0x1f8
    > [16386.255309] [c00000016b297880] [c0000000006eb5c8] __asan_load8+0xac/0xe0
    > [16386.255326] [c00000016b2978a0] [c00000000013f898] reconfig_close_windows+0x1a0/0x4e8
    > [16386.255343] [c00000016b297990] [c000000000140e58] vas_migration_handler+0x3a4/0x3fc
    > [16386.255368] [c00000016b297a90] [c000000000128848] pseries_migrate_partition+0x4c/0x4c4
    > ...
    > [16386.256136] Allocated by task 696554 on cpu 31 at 16377.277618s:
    > [16386.256149]  kasan_save_stack+0x34/0x68
    > [16386.256163]  kasan_save_track+0x34/0x80
    > [16386.256175]  kasan_save_alloc_info+0x58/0x74
    > [16386.256196]  __kasan_slab_alloc+0xb8/0xdc
    > [16386.256209]  kmem_cache_alloc_noprof+0x200/0x3d0
    > [16386.256225]  vm_area_alloc+0x44/0x150
    > [16386.256245]  mmap_region+0x214/0x10c4
    > [16386.256265]  do_mmap+0x5fc/0x750
    > [16386.256277]  vm_mmap_pgoff+0x14c/0x24c
    > [16386.256292]  ksys_mmap_pgoff+0x20c/0x348
    > [16386.256303]  sys_mmap+0xd0/0x160
    > ...
    > [16386.256350] Freed by task 0 on cpu 31 at 16386.204848s:
    > [16386.256363]  kasan_save_stack+0x34/0x68
    > [16386.256374]  kasan_save_track+0x34/0x80
    > [16386.256384]  kasan_save_free_info+0x64/0x10c
    > [16386.256396]  __kasan_slab_free+0x120/0x204
    > [16386.256415]  kmem_cache_free+0x128/0x450
    > [16386.256428]  vm_area_free_rcu_cb+0xa8/0xd8
    > [16386.256441]  rcu_do_batch+0x2c8/0xcf0
    > [16386.256458]  rcu_core+0x378/0x3c4
    > [16386.256473]  handle_softirqs+0x20c/0x60c
    > [16386.256495]  do_softirq_own_stack+0x6c/0x88
    > [16386.256509]  do_softirq_own_stack+0x58/0x88
    > [16386.256521]  __irq_exit_rcu+0x1a4/0x20c
    > [16386.256533]  irq_exit+0x20/0x38
    > [16386.256544]  interrupt_async_exit_prepare.constprop.0+0x18/0x2c
    > ...
    > [16386.256717] Last potentially related work creation:
    > [16386.256729]  kasan_save_stack+0x34/0x68
    > [16386.256741]  __kasan_record_aux_stack+0xcc/0x12c
    > [16386.256753]  __call_rcu_common.constprop.0+0x94/0xd04
    > [16386.256766]  vm_area_free+0x28/0x3c
    > [16386.256778]  remove_vma+0xf4/0x114
    > [16386.256797]  do_vmi_align_munmap.constprop.0+0x684/0x870
    > [16386.256811]  __vm_munmap+0xe0/0x1f8
    > [16386.256821]  sys_munmap+0x54/0x6c
    > [16386.256830]  system_call_exception+0x1a0/0x4a0
    > [16386.256841]  system_call_vectored_common+0x15c/0x2ec
    > [16386.256868] The buggy address belongs to the object at c00000014a819670
    > which belongs to the cache vm_area_struct of size 168
    > [16386.256887] The buggy address is located 0 bytes inside of
    > freed 168-byte region [c00000014a819670, c00000014a819718)
    > [16386.256915] The buggy address belongs to the physical page:
    > [16386.256928] page: refcount:1 mapcount:0 mapping:0000000000000000 index:0x0 pfn:0x14a81
    > [16386.256950] memcg:c0000000ba430001
    > [16386.256961] anon flags: 0x43ffff800000000(node&#x3D;4|zone&#x3D;0|lastcpupid&#x3D;0x7ffff)
    > [16386.256975] page_type: 0xfdffffff(slab)
    > [16386.256990] raw: 043ffff800000000 c00000000501c080 0000000000000000 5deadbee00000001
    > [16386.257003] raw: 0000000000000000 00000000011a011a 00000001fdffffff c0000000ba430001
    > [16386.257018] page dumped because: kasan: bad access detected
    > This patch adds close() callback in vas_vm_ops vm_operations_struct
    > which will be executed during munmap() before freeing VMA. The VMA
    > address in the VAS window is set to NULL after holding the window
    > mmap_mutex.
    > Fixes: 37e6764895ef (&quot;powerpc/pseries/vas: Add VAS migration handler&quot;)
    > Signed-off-by: Haren Myneni &lt;haren@linux.ibm.com&gt;
    > Signed-off-by: Madhavan Srinivasan &lt;maddy@linux.ibm.com&gt;
    > Link: https://patch.msgid.link/20241214051758.997759-1-haren@linux.ibm.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ASoC: dt-bindings: realtek,rt5645: Fix CPVDD voltage comment (@Chen-Yu Tsai in [3b0f5d3e5ebda72](https://github.com/sophgo/linux-riscv/commit/3b0f5d3e5ebda72) at 2025-01-02 09:34:15)
    > commit 6f4a0fd03ce856c6d9811429b9969b4f27e2eaee upstream.
    > Both the ALC5645 and ALC5650 datasheets specify a recommended voltage of
    > 1.8V for CPVDD, not 3.5V.
    > Fix the comment.
    > Cc: Matthias Brugger &lt;matthias.bgg@gmail.com&gt;
    > Fixes: 26aa19174f0d (&quot;ASoC: dt-bindings: rt5645: add suppliers&quot;)
    > Fixes: 83d43ab0a1cb (&quot;ASoC: dt-bindings: realtek,rt5645: Convert to dtschema&quot;)
    > Signed-off-by: Chen-Yu Tsai &lt;wenst@chromium.org&gt;
    > Acked-by: Krzysztof Kozlowski &lt;krzysztof.kozlowski@linaro.org&gt;
    > Link: https://patch.msgid.link/20241211035403.4157760-1-wenst@chromium.org
    > Signed-off-by: Mark Brown &lt;broonie@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ ASoC: Intel: sof_sdw: Fix DMI match for Lenovo 21Q6 and 21Q7 (@Richard Fitzgerald in [16258a1d930309c](https://github.com/sophgo/linux-riscv/commit/16258a1d930309c) at 2025-01-02 09:34:15)
    > commit 7c449ef0fdce540bfb235a2d93e7184864c3388b upstream.
    > Update the DMI match for a Lenovo laptop to the new DMI identifier.
    > This laptop ships with a different DMI identifier to what was expected,
    > and now has two identifiers.
    > Signed-off-by: Richard Fitzgerald &lt;rf@opensource.cirrus.com&gt;
    > Fixes: 83c062ae81e8 (&quot;ASoC: Intel: sof_sdw: Add quirks for some new Lenovo laptops&quot;)
    > Signed-off-by: Bard Liao &lt;yung-chuan.liao@linux.intel.com&gt;
    > Link: https://patch.msgid.link/20241216140821.153670-2-yung-chuan.liao@linux.intel.com
    > Signed-off-by: Mark Brown &lt;broonie@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ power: supply: bq24190: Fix BQ24296 Vbus regulator support (@Hans de Goede in [155829fd1e1d18c](https://github.com/sophgo/linux-riscv/commit/155829fd1e1d18c) at 2025-01-02 09:34:15)
    > [ Upstream commit b3ded6072c5600704cfa3ce3a8dc8718d34bda66 ]
    > There are 2 issues with bq24296_set_otg_vbus():
    > 1. When writing the OTG_CONFIG bit it uses POC_CHG_CONFIG_SHIFT which
    > should be POC_OTG_CONFIG_SHIFT.
    > 2. When turning the regulator off it never turns charging back on. Note
    > this must be done through bq24190_charger_set_charge_type(), to ensure
    > that the charge_type property value of none/trickle/fast is honored.
    > Resolve both issues to fix BQ24296 Vbus regulator support not working.
    > Fixes: b150a703b56f (&quot;power: supply: bq24190_charger: Add support for BQ24296&quot;)
    > Signed-off-by: Hans de Goede &lt;hdegoede@redhat.com&gt;
    > Link: https://lore.kernel.org/r/20241116203648.169100-2-hdegoede@redhat.com
    > Signed-off-by: Sebastian Reichel &lt;sebastian.reichel@collabora.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ dmaengine: fsl-edma: implement the cleanup path of fsl_edma3_attach_pd() (@Joe Hattori in [f5d231592430abd](https://github.com/sophgo/linux-riscv/commit/f5d231592430abd) at 2025-01-02 09:34:14)
    > commit ccfa3131d4a0347988e73638edea5c8281b6d2c7 upstream.
    > Current implementation of fsl_edma3_attach_pd() does not provide a
    > cleanup path, resulting in a memory leak. For example,
    > dev_pm_domain_detach() is not called after dev_pm_domain_attach_by_id(),
    > and the device link created with the DL_FLAG_STATELESS is not released
    > explicitly.
    > Therefore, provide a cleanup function fsl_edma3_detach_pd() and call it
    > upon failure. Also add a devm_add_action_or_reset() call with this
    > function after a successful fsl_edma3_attach_pd().
    > Fixes: 72f5801a4e2b (&quot;dmaengine: fsl-edma: integrate v3 support&quot;)
    > Signed-off-by: Joe Hattori &lt;joe@pf.is.s.u-tokyo.ac.jp&gt;
    > Link: https://lore.kernel.org/r/20241221075712.3297200-1-joe@pf.is.s.u-tokyo.ac.jp
    > Signed-off-by: Vinod Koul &lt;vkoul@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ dmaengine: apple-admac: Avoid accessing registers in probe (@Sasha Finkelstein in [ed31336f811778c](https://github.com/sophgo/linux-riscv/commit/ed31336f811778c) at 2025-01-02 09:34:14)
    > commit 8d55e8a16f019211163f1180fd9f9fbe05901900 upstream.
    > The ADMAC attached to the AOP has complex power sequencing, and is
    > power gated when the probe callback runs. Move the register reads
    > to other functions, where we can guarantee that the hardware is
    > switched on.
    > Fixes: 568aa6dd641f (&quot;dmaengine: apple-admac: Allocate cache SRAM to channels&quot;)
    > Signed-off-by: Sasha Finkelstein &lt;fnkl.kernel@gmail.com&gt;
    > Link: https://lore.kernel.org/r/20241124-admac-power-v1-1-58f2165a4d55@gmail.com
    > Signed-off-by: Vinod Koul &lt;vkoul@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ dmaengine: tegra: Return correct DMA status when paused (@Akhil R in [d8c3d13f5519688](https://github.com/sophgo/linux-riscv/commit/d8c3d13f5519688) at 2025-01-02 09:34:14)
    > commit ebc008699fd95701c9af5ebaeb0793eef81a71d5 upstream.
    > Currently, the driver does not return the correct DMA status when a DMA
    > pause is issued by the client drivers. This causes GPCDMA users to
    > assume that DMA is still running, while in reality, the DMA is paused.
    > Return DMA_PAUSED for tx_status() if the channel is paused in the middle
    > of a transfer.
    > Fixes: ee17028009d4 (&quot;dmaengine: tegra: Add tegra gpcdma driver&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Akhil R &lt;akhilrajeev@nvidia.com&gt;
    > Signed-off-by: Kartik Rajput &lt;kkartik@nvidia.com&gt;
    > Link: https://lore.kernel.org/r/20241212124412.5650-1-kkartik@nvidia.com
    > Signed-off-by: Vinod Koul &lt;vkoul@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ platform/chrome: cros_ec_lpc: fix product identity for early Framework Laptops (@Dustin L. Howett in [ba465de3022a47a](https://github.com/sophgo/linux-riscv/commit/ba465de3022a47a) at 2025-01-02 09:34:14)
    > commit dcd59d0d7d51b2a4b768fc132b0d74a97dfd6d6a upstream.
    > The product names for the Framework Laptop (12th and 13th Generation
    > Intel Core) are incorrect as of 62be134abf42.
    > Fixes: 62be134abf42 (&quot;platform/chrome: cros_ec_lpc: switch primary DMI data for Framework Laptop&quot;)
    > Cc: stable@vger.kernel.org # 6.12.x
    > Signed-off-by: Dustin L. Howett &lt;dustin@howett.net&gt;
    > Reviewed-by: Thomas Weißschuh &lt;linux@weissschuh.net&gt;
    > Link: https://lore.kernel.org/r/20241224-platform-chrome-cros_ec_lpc-fix-product-identity-for-early-framework-laptops-v1-1-0d31d6e1d22c@howett.net
    > Signed-off-by: Tzung-Bi Shih &lt;tzungbi@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ ASoC: SOF: Intel: hda-dai: Do not release the link DMA on STOP (@Peter Ujfalusi in [909ecf15cb70f78](https://github.com/sophgo/linux-riscv/commit/909ecf15cb70f78) at 2025-01-02 09:34:14)
    > commit e8d0ba147d901022bcb69da8d8fd817f84e9f3ca upstream.
    > The linkDMA should not be released on stop trigger since a stream re-start
    > might happen without closing of the stream. This leaves a short time for
    > other streams to &#x27;steal&#x27; the linkDMA since it has been released.
    > This issue is not easy to reproduce under normal conditions as usually
    > after stop the stream is closed, or the same stream is restarted, but if
    > another stream got in between the stop and start, like this:
    > aplay -Dhw:0,3 -c2 -r48000 -fS32_LE /dev/zero -d 120
    > CTRL+z
    > aplay -Dhw:0,0 -c2 -r48000 -fS32_LE /dev/zero -d 120
    > then the link DMA channels will be mixed up, resulting firmware error or
    > crash.
    > Fixes: ab5593793e90 (&quot;ASoC: SOF: Intel: hda: Always clean up link DMA during stop&quot;)
    > Cc: stable@vger.kernel.org
    > Closes: https://github.com/thesofproject/sof/issues/9695
    > Signed-off-by: Peter Ujfalusi &lt;peter.ujfalusi@linux.intel.com&gt;
    > Reviewed-by: Ranjani Sridharan &lt;ranjani.sridharan@linux.intel.com&gt;
    > Reviewed-by: Liam Girdwood &lt;liam.r.girdwood@intel.com&gt;
    > Reviewed-by: Bard Liao &lt;yung-chuan.liao@linux.intel.com&gt;
    > Link: https://patch.msgid.link/20241217091019.31798-1-peter.ujfalusi@linux.intel.com
    > Signed-off-by: Mark Brown &lt;broonie@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ dmaengine: at_xdmac: avoid null_prt_deref in at_xdmac_prep_dma_memset (@Chen Ridong in [54376d8d26596f9](https://github.com/sophgo/linux-riscv/commit/54376d8d26596f9) at 2025-01-02 09:34:14)
    > commit c43ec96e8d34399bd9dab2f2dc316b904892133f upstream.
    > The at_xdmac_memset_create_desc may return NULL, which will lead to a
    > null pointer dereference. For example, the len input is error, or the
    > atchan-&gt;free_descs_list is empty and memory is exhausted. Therefore, add
    > check to avoid this.
    > Fixes: b206d9a23ac7 (&quot;dmaengine: xdmac: Add memset support&quot;)
    > Signed-off-by: Chen Ridong &lt;chenridong@huawei.com&gt;
    > Link: https://lore.kernel.org/r/20241029082845.1185380-1-chenridong@huaweicloud.com
    > Signed-off-by: Vinod Koul &lt;vkoul@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ dmaengine: amd: qdma: Remove using the private get and set dma_ops APIs (@Lizhi Hou in [4ecd6f505e4f236](https://github.com/sophgo/linux-riscv/commit/4ecd6f505e4f236) at 2025-01-02 09:34:14)
    > commit dcbef0798eb825cd584f7a93f62bed63f7fbbfc9 upstream.
    > The get_dma_ops and set_dma_ops APIs were never for driver to use. Remove
    > these calls from QDMA driver. Instead, pass the DMA device pointer from the
    > qdma_platdata structure.
    > Fixes: 73d5fc92a11c (&quot;dmaengine: amd: qdma: Add AMD QDMA driver&quot;)
    > Signed-off-by: Lizhi Hou &lt;lizhi.hou@amd.com&gt;
    > Reviewed-by: Christoph Hellwig &lt;hch@lst.de&gt;
    > Link: https://lore.kernel.org/r/20240918181022.2155715-1-lizhi.hou@amd.com
    > Signed-off-by: Vinod Koul &lt;vkoul@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ phy: usb: Toggle the PHY power during init (@Justin Chen in [e4e6217cf7a6274](https://github.com/sophgo/linux-riscv/commit/e4e6217cf7a6274) at 2025-01-02 09:34:13)
    > commit 0a92ea87bdd6f77ca4e17fe19649882cf5209edd upstream.
    > When bringing up the PHY, it might be in a bad state if left powered.
    > One case is we lose the PLL lock if the PLL is gated while the PHY
    > is powered. Toggle the PHY power so we can start from a known state.
    > Fixes: 4e5b9c9a73b3 (&quot;phy: usb: Add support for new Synopsys USB controller on the 7216&quot;)
    > Signed-off-by: Justin Chen &lt;justin.chen@broadcom.com&gt;
    > Acked-by: Florian Fainelli &lt;florian.fainelli@broadcom.com&gt;
    > Link: https://lore.kernel.org/r/20241024213540.1059412-1-justin.chen@broadcom.com
    > Signed-off-by: Vinod Koul &lt;vkoul@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ ALSA: memalloc: prefer dma_mapping_error() over explicit address checking (@Fedor Pchelkin in [c180c3f42d340e8](https://github.com/sophgo/linux-riscv/commit/c180c3f42d340e8) at 2025-01-02 09:34:13)
    > commit fa0308134d26dbbeb209a1581eea46df663866b6 upstream.
    > With CONFIG_DMA_API_DEBUG enabled, the following warning is observed:
    > DMA-API: snd_hda_intel 0000:03:00.1: device driver failed to check map error[device address&#x3D;0x00000000ffff0000] [size&#x3D;20480 bytes] [mapped as single]
    > WARNING: CPU: 28 PID: 2255 at kernel/dma/debug.c:1036 check_unmap+0x1408/0x2430
    > CPU: 28 UID: 42 PID: 2255 Comm: wireplumber Tainted: G  W L  6.12.0-10-133577cad6bf48e5a7848c4338124081393bfe8a+ #759
    > debug_dma_unmap_page+0xe9/0xf0
    > snd_dma_wc_free+0x85/0x130 [snd_pcm]
    > snd_pcm_lib_free_pages+0x1e3/0x440 [snd_pcm]
    > snd_pcm_common_ioctl+0x1c9a/0x2960 [snd_pcm]
    > snd_pcm_ioctl+0x6a/0xc0 [snd_pcm]
    > ...
    > Check for returned DMA addresses using specialized dma_mapping_error()
    > helper which is generally recommended for this purpose by
    > Documentation/core-api/dma-api.rst.
    > Fixes: c880a5146642 (&quot;ALSA: memalloc: Use proper DMA mapping API for x86 WC buffer allocations&quot;)
    > Reported-by: Mikhail Gavrilov &lt;mikhail.v.gavrilov@gmail.com&gt;
    > Closes: https://lore.kernel.org/r/CABXGCsNB3RsMGvCucOy3byTEOxoc-Ys+zB_HQ&#x3D;Opb_GhX1ioDA@mail.gmail.com/
    > Tested-by: Mikhail Gavrilov &lt;mikhail.v.gavrilov@gmail.com&gt;
    > Signed-off-by: Fedor Pchelkin &lt;pchelkin@ispras.ru&gt;
    > Link: https://patch.msgid.link/20241219203345.195898-1-pchelkin@ispras.ru
    > Signed-off-by: Takashi Iwai &lt;tiwai@suse.de&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ phy: core: Fix that API devm_phy_destroy() fails to destroy the phy (@Zijun Hu in [7e7c8ffc017de3c](https://github.com/sophgo/linux-riscv/commit/7e7c8ffc017de3c) at 2025-01-02 09:34:13)
    > commit 4dc48c88fcf82b89fdebd83a906aaa64f40fb8a9 upstream.
    > For devm_phy_destroy(), its comment says it needs to invoke phy_destroy()
    > to destroy the phy, but it will not actually invoke the function since
    > devres_destroy() does not call devm_phy_consume(), and the missing
    > phy_destroy() call will cause that the phy fails to be destroyed.
    > Fortunately, the faulty API has not been used by current kernel tree.
    > Fix by using devres_release() instead of devres_destroy() within the API.
    > Fixes: ff764963479a (&quot;drivers: phy: add generic PHY framework&quot;)
    > Reviewed-by: Johan Hovold &lt;johan+linaro@kernel.org&gt;
    > Signed-off-by: Zijun Hu &lt;quic_zijuhu@quicinc.com&gt;
    > Link: https://lore.kernel.org/r/20241213-phy_core_fix-v6-3-40ae28f5015a@quicinc.com
    > Signed-off-by: Vinod Koul &lt;vkoul@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ phy: rockchip: samsung-hdptx: Set drvdata before enabling runtime PM (@Cristian Ciocaltea in [7061849a4a1752a](https://github.com/sophgo/linux-riscv/commit/7061849a4a1752a) at 2025-01-02 09:34:13)
    > commit 9d23e48654620fdccfcc74cc2cef04eaf7353d07 upstream.
    > In some cases, rk_hdptx_phy_runtime_resume() may be invoked before
    > platform_set_drvdata() is executed in -&gt;probe(), leading to a NULL
    > pointer dereference when using the return of dev_get_drvdata().
    > Ensure platform_set_drvdata() is called before devm_pm_runtime_enable().
    > Reported-by: Dmitry Osipenko &lt;dmitry.osipenko@collabora.com&gt;
    > Fixes: 553be2830c5f (&quot;phy: rockchip: Add Samsung HDMI/eDP Combo PHY driver&quot;)
    > Signed-off-by: Cristian Ciocaltea &lt;cristian.ciocaltea@collabora.com&gt;
    > Reviewed-by: Heiko Stuebner &lt;heiko@sntech.de&gt;
    > Link: https://lore.kernel.org/r/20241023-phy-sam-hdptx-rpm-fix-v1-1-87f4c994e346@collabora.com
    > Signed-off-by: Vinod Koul &lt;vkoul@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ dmaengine: dw: Select only supported masters for ACPI devices (@Andy Shevchenko in [5dd888449338d95](https://github.com/sophgo/linux-riscv/commit/5dd888449338d95) at 2025-01-02 09:34:13)
    > commit f0e870a0e9c5521f2952ea9f3ea9d3d122631a89 upstream.
    > The recently submitted fix-commit revealed a problem in the iDMA 32-bit
    > platform code. Even though the controller supported only a single master
    > the dw_dma_acpi_filter() method hard-coded two master interfaces with IDs
    > 0 and 1. As a result the sanity check implemented in the commit
    > b336268dde75 (&quot;dmaengine: dw: Add peripheral bus width verification&quot;)
    > got incorrect interface data width and thus prevented the client drivers
    > from configuring the DMA-channel with the EINVAL error returned. E.g.,
    > the next error was printed for the PXA2xx SPI controller driver trying
    > to configure the requested channels:
    > &gt; [  164.525604] pxa2xx_spi_pci 0000:00:07.1: DMA slave config failed
    > &gt; [  164.536105] pxa2xx_spi_pci 0000:00:07.1: failed to get DMA TX descriptor
    > &gt; [  164.543213] spidev spi-SPT0001:00: SPI transfer failed: -16
    > The problem would have been spotted much earlier if the iDMA 32-bit
    > controller supported more than one master interfaces. But since it
    > supports just a single master and the iDMA 32-bit specific code just
    > ignores the master IDs in the CTLLO preparation method, the issue has
    > been gone unnoticed so far.
    > Fix the problem by specifying the default master ID for both memory
    > and peripheral devices in the driver data. Thus the issue noticed for
    > the iDMA 32-bit controllers will be eliminated and the ACPI-probed
    > DW DMA controllers will be configured with the correct master ID by
    > default.
    > Cc: stable@vger.kernel.org
    > Fixes: b336268dde75 (&quot;dmaengine: dw: Add peripheral bus width verification&quot;)
    > Fixes: 199244d69458 (&quot;dmaengine: dw: add support of iDMA 32-bit hardware&quot;)
    > Reported-by: Ferry Toth &lt;fntoth@gmail.com&gt;
    > Closes: https://lore.kernel.org/dmaengine/ZuXbCKUs1iOqFu51@black.fi.intel.com/
    > Reported-by: Andy Shevchenko &lt;andriy.shevchenko@linux.intel.com&gt;
    > Closes: https://lore.kernel.org/dmaengine/ZuXgI-VcHpMgbZ91@black.fi.intel.com/
    > Tested-by: Ferry Toth &lt;fntoth@gmail.com&gt;
    > Signed-off-by: Andy Shevchenko &lt;andriy.shevchenko@linux.intel.com&gt;
    > Link: https://lore.kernel.org/r/20241104095142.157925-1-andriy.shevchenko@linux.intel.com
    > Signed-off-by: Vinod Koul &lt;vkoul@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ phy: rockchip: naneng-combphy: fix phy reset (@Chukun Pan in [5cdf336412a928a](https://github.com/sophgo/linux-riscv/commit/5cdf336412a928a) at 2025-01-02 09:34:13)
    > commit fbcbffbac994aca1264e3c14da96ac9bfd90466e upstream.
    > Currently, the USB port via combophy on the RK3528/RK3588 SoC is broken.
    > usb usb8-port1: Cannot enable. Maybe the USB cable is bad?
    > This is due to the combphy of RK3528/RK3588 SoC has multiple resets, but
    > only &quot;phy resets&quot; need assert and deassert, &quot;apb resets&quot; don&#x27;t need.
    > So change the driver to only match the phy resets, which is also what
    > the vendor kernel does.
    > Fixes: 7160820d742a (&quot;phy: rockchip: add naneng combo phy for RK3568&quot;)
    > Cc: FUKAUMI Naoki &lt;naoki@radxa.com&gt;
    > Cc: Michael Zimmermann &lt;sigmaepsilon92@gmail.com&gt;
    > Signed-off-by: Chukun Pan &lt;amadeus@jmu.edu.cn&gt;
    > Reviewed-by: Heiko Stuebner &lt;heiko@sntech.de&gt;
    > Tested-by: FUKAUMI Naoki &lt;naoki@radxa.com&gt;
    > Link: https://lore.kernel.org/r/20241122073006.99309-2-amadeus@jmu.edu.cn
    > Signed-off-by: Vinod Koul &lt;vkoul@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ dmaengine: mv_xor: fix child node refcount handling in early exit (@Javier Carrasco in [27dd330345619ee](https://github.com/sophgo/linux-riscv/commit/27dd330345619ee) at 2025-01-02 09:34:13)
    > commit 362f1bf98a3ecb5a2a4fcbdaa9718c8403beceb2 upstream.
    > The for_each_child_of_node() loop requires explicit calls to
    > of_node_put() to decrement the child&#x27;s refcount upon early exits (break,
    > goto, return).
    > Add the missing calls in the two early exits before the goto
    > instructions.
    > Cc: stable@vger.kernel.org
    > Fixes: f7d12ef53ddf (&quot;dma: mv_xor: add Device Tree binding&quot;)
    > Signed-off-by: Javier Carrasco &lt;javier.carrasco.cruz@gmail.com&gt;
    > Link: https://lore.kernel.org/r/20241011-dma_mv_xor_of_node_put-v1-1-3c2de819f463@gmail.com
    > Signed-off-by: Vinod Koul &lt;vkoul@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ phy: core: Fix that API devm_of_phy_provider_unregister() fails to unregister the phy provider (@Zijun Hu in [f797151e8479aff](https://github.com/sophgo/linux-riscv/commit/f797151e8479aff) at 2025-01-02 09:34:12)
    > commit c0b82ab95b4f1fbc3e3aeab9d829d012669524b6 upstream.
    > For devm_of_phy_provider_unregister(), its comment says it needs to invoke
    > of_phy_provider_unregister() to unregister the phy provider, but it will
    > not actually invoke the function since devres_destroy() does not call
    > devm_phy_provider_release(), and the missing of_phy_provider_unregister()
    > call will cause:
    > - The phy provider fails to be unregistered.
    > - Leak both memory and the OF node refcount.
    > Fortunately, the faulty API has not been used by current kernel tree.
    > Fix by using devres_release() instead of devres_destroy() within the API.
    > Fixes: ff764963479a (&quot;drivers: phy: add generic PHY framework&quot;)
    > Reviewed-by: Johan Hovold &lt;johan+linaro@kernel.org&gt;
    > Signed-off-by: Zijun Hu &lt;quic_zijuhu@quicinc.com&gt;
    > Link: https://lore.kernel.org/stable/20241213-phy_core_fix-v6-2-40ae28f5015a%40quicinc.com
    > Link: https://lore.kernel.org/r/20241213-phy_core_fix-v6-2-40ae28f5015a@quicinc.com
    > Signed-off-by: Vinod Koul &lt;vkoul@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ phy: qcom-qmp: Fix register name in RX Lane config of SC8280XP (@Krishna Kurapati in [d84bd63d4391ad1](https://github.com/sophgo/linux-riscv/commit/d84bd63d4391ad1) at 2025-01-02 09:34:12)
    > commit 8886fb3240931a0afce82dea87edfe46bcb0a586 upstream.
    > In RX Lane configuration sequence of SC8280XP, the register
    > V5_RX_UCDR_FO_GAIN is incorrectly spelled as RX_UCDR_SO_GAIN and
    > hence the programming sequence is wrong. Fix the register sequence
    > accordingly to avoid any compliance failures. This has been tested
    > on SA8775P by checking device mode enumeration in SuperSpeed.
    > Cc: stable@vger.kernel.org
    > Fixes: c0c7769cdae2 (&quot;phy: qcom-qmp: Add SC8280XP USB3 UNI phy&quot;)
    > Signed-off-by: Krishna Kurapati &lt;quic_kriskura@quicinc.com&gt;
    > Reviewed-by: Konrad Dybcio &lt;konrad.dybcio@oss.qualcomm.com&gt;
    > Link: https://lore.kernel.org/r/20241112092831.4110942-1-quic_kriskura@quicinc.com
    > Signed-off-by: Vinod Koul &lt;vkoul@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ mtd: rawnand: arasan: Fix double assertion of chip-select (@Maciej Andrzejewski in [acb13fcf75904a0](https://github.com/sophgo/linux-riscv/commit/acb13fcf75904a0) at 2025-01-02 09:34:12)
    > commit b086a46dae48829e11c0c02580e30d920b76743c upstream.
    > When two chip-selects are configured in the device tree, and the second is
    > a non-native GPIO, both the GPIO-based chip-select and the first native
    > chip-select may be asserted simultaneously. This double assertion causes
    > incorrect read and write operations.
    > The issue occurs because when nfc-&gt;ncs &lt;&#x3D; 2, nfc-&gt;spare_cs is always
    > initialized to 0 due to static initialization. Consequently, when the
    > second chip-select (GPIO-based) is selected in anfc_assert_cs(), it is
    > detected by anfc_is_gpio_cs(), and nfc-&gt;native_cs is assigned the value 0.
    > This results in both the GPIO-based chip-select being asserted and the
    > NAND controller register receiving 0, erroneously selecting the native
    > chip-select.
    > This patch resolves the issue, as confirmed by oscilloscope testing with
    > configurations involving two or more chip-selects in the device tree.
    > Fixes: acbd3d0945f9 (&quot;mtd: rawnand: arasan: Leverage additional GPIO CS&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Maciej Andrzejewski &lt;maciej.andrzejewski@m-works.net&gt;
    > Signed-off-by: Miquel Raynal &lt;miquel.raynal@bootlin.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ phy: core: Fix an OF node refcount leakage in _of_phy_get() (@Zijun Hu in [a817e938a0c6357](https://github.com/sophgo/linux-riscv/commit/a817e938a0c6357) at 2025-01-02 09:34:12)
    > commit 5ebdc6be16c2000e37fcb8b4072d442d268ad492 upstream.
    > _of_phy_get() will directly return when suffers of_device_is_compatible()
    > error, but it forgets to decrease refcount of OF node @args.np before error
    > return, the refcount was increased by previous of_parse_phandle_with_args()
    > so causes the OF node&#x27;s refcount leakage.
    > Fix by decreasing the refcount via of_node_put() before the error return.
    > Fixes: b7563e2796f8 (&quot;phy: work around &#x27;phys&#x27; references to usb-nop-xceiv devices&quot;)
    > Cc: stable@vger.kernel.org
    > Reviewed-by: Johan Hovold &lt;johan+linaro@kernel.org&gt;
    > Signed-off-by: Zijun Hu &lt;quic_zijuhu@quicinc.com&gt;
    > Link: https://lore.kernel.org/r/20241213-phy_core_fix-v6-4-40ae28f5015a@quicinc.com
    > Signed-off-by: Vinod Koul &lt;vkoul@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ phy: core: Fix an OF node refcount leakage in of_phy_provider_lookup() (@Zijun Hu in [479b6c2a5ff2f0c](https://github.com/sophgo/linux-riscv/commit/479b6c2a5ff2f0c) at 2025-01-02 09:34:12)
    > commit a2d633cb1421e679b56f1a9fe1f42f089706f1ed upstream.
    > For macro for_each_child_of_node(parent, child), refcount of @child has
    > been increased before entering its loop body, so normally needs to call
    > of_node_put(@child) before returning from the loop body to avoid refcount
    > leakage.
    > of_phy_provider_lookup() has such usage but does not call of_node_put()
    > before returning, so cause leakage of the OF node refcount.
    > Fix by simply calling of_node_put() before returning from the loop body.
    > The APIs affected by this issue are shown below since they indirectly
    > invoke problematic of_phy_provider_lookup().
    > phy_get()
    > of_phy_get()
    > devm_phy_get()
    > devm_of_phy_get()
    > devm_of_phy_get_by_index()
    > Fixes: 2a4c37016ca9 (&quot;phy: core: Fix of_phy_provider_lookup to return PHY provider for sub node&quot;)
    > Cc: stable@vger.kernel.org
    > Reviewed-by: Johan Hovold &lt;johan+linaro@kernel.org&gt;
    > Signed-off-by: Zijun Hu &lt;quic_zijuhu@quicinc.com&gt;
    > Link: https://lore.kernel.org/r/20241213-phy_core_fix-v6-5-40ae28f5015a@quicinc.com
    > Signed-off-by: Vinod Koul &lt;vkoul@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ mtd: rawnand: arasan: Fix missing de-registration of NAND (@Maciej Andrzejewski in [464b493ac4d83cd](https://github.com/sophgo/linux-riscv/commit/464b493ac4d83cd) at 2025-01-02 09:34:12)
    > commit 11e6831fd81468cf48155b9b3c11295c391da723 upstream.
    > The NAND chip-selects are registered for the Arasan driver during
    > initialization but are not de-registered when the driver is unloaded. As a
    > result, if the driver is loaded again, the chip-selects remain registered
    > and busy, making them unavailable for use.
    > Fixes: 197b88fecc50 (&quot;mtd: rawnand: arasan: Add new Arasan NAND controller&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Maciej Andrzejewski ICEYE &lt;maciej.andrzejewski@m-works.net&gt;
    > Signed-off-by: Miquel Raynal &lt;miquel.raynal@bootlin.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ phy: core: Fix that API devm_phy_put() fails to release the phy (@Zijun Hu in [09f17bfb3653a55](https://github.com/sophgo/linux-riscv/commit/09f17bfb3653a55) at 2025-01-02 09:34:12)
    > commit fe4bfa9b6d7bd752bfe4700c937f235aa8ce997b upstream.
    > For devm_phy_put(), its comment says it needs to invoke phy_put() to
    > release the phy, but it will not actually invoke the function since
    > devres_destroy() does not call devm_phy_release(), and the missing
    > phy_put() call will cause:
    > - The phy fails to be released.
    > - devm_phy_put() can not fully undo what API devm_phy_get() does.
    > - Leak refcount of both the module and device for below typical usage:
    > devm_phy_get(); // or its variant
    > ...
    > err &#x3D; do_something();
    > if (err)
    > goto err_out;
    > ...
    > err_out:
    > devm_phy_put(); // leak refcount here
    > The file(s) affected by this issue are shown below since they have such
    > typical usage.
    > drivers/pci/controller/cadence/pcie-cadence.c
    > drivers/net/ethernet/ti/am65-cpsw-nuss.c
    > Fix by using devres_release() instead of devres_destroy() within the API.
    > Fixes: ff764963479a (&quot;drivers: phy: add generic PHY framework&quot;)
    > Cc: stable@vger.kernel.org
    > Cc: Lorenzo Pieralisi &lt;lpieralisi@kernel.org&gt;
    > Cc: Krzysztof Wilczyński &lt;kw@linux.com&gt;
    > Cc: Bjorn Helgaas &lt;bhelgaas@google.com&gt;
    > Cc: David S. Miller &lt;davem@davemloft.net&gt;
    > Cc: Eric Dumazet &lt;edumazet@google.com&gt;
    > Cc: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Cc: Paolo Abeni &lt;pabeni@redhat.com&gt;
    > Reviewed-by: Johan Hovold &lt;johan+linaro@kernel.org&gt;
    > Signed-off-by: Zijun Hu &lt;quic_zijuhu@quicinc.com&gt;
    > Link: https://lore.kernel.org/r/20241213-phy_core_fix-v6-1-40ae28f5015a@quicinc.com
    > Signed-off-by: Vinod Koul &lt;vkoul@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ mtd: diskonchip: Cast an operand to prevent potential overflow (@Zichen Xie in [ee33d36f4174fbc](https://github.com/sophgo/linux-riscv/commit/ee33d36f4174fbc) at 2025-01-02 09:34:11)
    > commit 9b458e8be0d13e81ed03fffa23f8f9b528bbd786 upstream.
    > There may be a potential integer overflow issue in inftl_partscan().
    > parts[0].size is defined as &quot;uint64_t&quot;  while mtd-&gt;erasesize and
    > ip-&gt;firstUnit are defined as 32-bit unsigned integer. The result of
    > the calculation will be limited to 32 bits without correct casting.
    > Fixes: 1da177e4c3f4 (&quot;Linux-2.6.12-rc2&quot;)
    > Signed-off-by: Zichen Xie &lt;zichenxie0106@gmail.com&gt;
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Miquel Raynal &lt;miquel.raynal@bootlin.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ nfsd: restore callback functionality for NFSv4.0 (@NeilBrown in [b186b36a7c21299](https://github.com/sophgo/linux-riscv/commit/b186b36a7c21299) at 2025-01-02 09:34:11)
    > [ Upstream commit 7917f01a286ce01e9c085e24468421f596ee1a0c ]
    > A recent patch inadvertently broke callbacks for NFSv4.0.
    > In the 4.0 case we do not expect a session to be found but still need to
    > call setup_callback_client() which will not try to dereference it.
    > This patch moves the check for failure to find a session into the 4.1+
    > branch of setup_callback_client()
    > Fixes: 1e02c641c3a4 (&quot;NFSD: Prevent NULL dereference in nfsd4_process_cb_update()&quot;)
    > Signed-off-by: NeilBrown &lt;neilb@suse.de&gt;
    > Reviewed-by: Jeff Layton &lt;jlayton@kernel.org&gt;
    > Signed-off-by: Chuck Lever &lt;chuck.lever@oracle.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ bpf: Check negative offsets in __bpf_skb_min_len() (@Cong Wang in [997cf2d8c206941](https://github.com/sophgo/linux-riscv/commit/997cf2d8c206941) at 2025-01-02 09:34:11)
    > [ Upstream commit 9ecc4d858b92c1bb0673ad9c327298e600c55659 ]
    > skb_network_offset() and skb_transport_offset() can be negative when
    > they are called after we pull the transport header, for example, when
    > we use eBPF sockmap at the point of -&gt;sk_data_ready().
    > __bpf_skb_min_len() uses an unsigned int to get these offsets, this
    > leads to a very large number which then causes bpf_skb_change_tail()
    > failed unexpectedly.
    > Fix this by using a signed int to get these offsets and ensure the
    > minimum is at least zero.
    > Fixes: 5293efe62df8 (&quot;bpf: add bpf_skb_change_tail helper&quot;)
    > Signed-off-by: Cong Wang &lt;cong.wang@bytedance.com&gt;
    > Signed-off-by: Daniel Borkmann &lt;daniel@iogearbox.net&gt;
    > Acked-by: John Fastabend &lt;john.fastabend@gmail.com&gt;
    > Link: https://lore.kernel.org/bpf/20241213034057.246437-2-xiyou.wangcong@gmail.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ smb: fix bytes written value in /proc/fs/cifs/Stats (@Bharath SM in [987cf3869d7763a](https://github.com/sophgo/linux-riscv/commit/987cf3869d7763a) at 2025-01-02 09:34:11)
    > [ Upstream commit 92941c7f2c9529fac1b2670482d0ced3b46eac70 ]
    > With recent netfs apis changes, the bytes written
    > value was not getting updated in /proc/fs/cifs/Stats.
    > Fix this by updating tcon-&gt;bytes in write operations.
    > Fixes: 3ee1a1fc3981 (&quot;cifs: Cut over to using netfslib&quot;)
    > Signed-off-by: Bharath SM &lt;bharathsm@microsoft.com&gt;
    > Signed-off-by: Steve French &lt;stfrench@microsoft.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ nfsd: Revert &quot;nfsd: release svc_expkey/svc_export with rcu_work&quot; (@Yang Erkun in [7b005cff0de41ed](https://github.com/sophgo/linux-riscv/commit/7b005cff0de41ed) at 2025-01-02 09:34:11)
    > [ Upstream commit 69d803c40edeaf94089fbc8751c9b746cdc35044 ]
    > This reverts commit f8c989a0c89a75d30f899a7cabdc14d72522bb8d.
    > Before this commit, svc_export_put or expkey_put will call path_put with
    > sync mode. After this commit, path_put will be called with async mode.
    > And this can lead the unexpected results show as follow.
    > mkfs.xfs -f /dev/sda
    > echo &quot;/ *(rw,no_root_squash,fsid&#x3D;0)&quot; &gt; /etc/exports
    > echo &quot;/mnt *(rw,no_root_squash,fsid&#x3D;1)&quot; &gt;&gt; /etc/exports
    > exportfs -ra
    > service nfs-server start
    > mount -t nfs -o vers&#x3D;4.0 127.0.0.1:/mnt /mnt1
    > mount /dev/sda /mnt/sda
    > touch /mnt1/sda/file
    > exportfs -r
    > umount /mnt/sda # failed unexcepted
    > The touch will finally call nfsd_cross_mnt, add refcount to mount, and
    > then add cache_head. Before this commit, exportfs -r will call
    > cache_flush to cleanup all cache_head, and path_put in
    > svc_export_put/expkey_put will be finished with sync mode. So, the
    > latter umount will always success. However, after this commit, path_put
    > will be called with async mode, the latter umount may failed, and if
    > we add some delay, umount will success too. Personally I think this bug
    > and should be fixed. We first revert before bugfix patch, and then fix
    > the original bug with a different way.
    > Fixes: f8c989a0c89a (&quot;nfsd: release svc_expkey/svc_export with rcu_work&quot;)
    > Signed-off-by: Yang Erkun &lt;yangerkun@huawei.com&gt;
    > Signed-off-by: Chuck Lever &lt;chuck.lever@oracle.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ tcp_bpf: Add sk_rmem_alloc related logic for tcp_bpf ingress redirection (@Zijian Zhang in [4aa5dcb3891ffca](https://github.com/sophgo/linux-riscv/commit/4aa5dcb3891ffca) at 2025-01-02 09:34:11)
    > [ Upstream commit d888b7af7c149c115dd6ac772cc11c375da3e17c ]
    > When we do sk_psock_verdict_apply-&gt;sk_psock_skb_ingress, an sk_msg will
    > be created out of the skb, and the rmem accounting of the sk_msg will be
    > handled by the skb.
    > For skmsgs in __SK_REDIRECT case of tcp_bpf_send_verdict, when redirecting
    > to the ingress of a socket, although we sk_rmem_schedule and add sk_msg to
    > the ingress_msg of sk_redir, we do not update sk_rmem_alloc. As a result,
    > except for the global memory limit, the rmem of sk_redir is nearly
    > unlimited. Thus, add sk_rmem_alloc related logic to limit the recv buffer.
    > Since the function sk_msg_recvmsg and __sk_psock_purge_ingress_msg are
    > used in these two paths. We use &quot;msg-&gt;skb&quot; to test whether the sk_msg is
    > skb backed up. If it&#x27;s not, we shall do the memory accounting explicitly.
    > Fixes: 604326b41a6f (&quot;bpf, sockmap: convert to generic sk_msg interface&quot;)
    > Signed-off-by: Zijian Zhang &lt;zijianzhang@bytedance.com&gt;
    > Signed-off-by: Daniel Borkmann &lt;daniel@iogearbox.net&gt;
    > Reviewed-by: John Fastabend &lt;john.fastabend@gmail.com&gt;
    > Link: https://lore.kernel.org/bpf/20241210012039.1669389-3-zijianzhang@bytedance.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ tcp_bpf: Charge receive socket buffer in bpf_tcp_ingress() (@Cong Wang in [35727f450603b03](https://github.com/sophgo/linux-riscv/commit/35727f450603b03) at 2025-01-02 09:34:11)
    > [ Upstream commit 54f89b3178d5448dd4457afbb98fc1ab99090a65 ]
    > When bpf_tcp_ingress() is called, the skmsg is being redirected to the
    > ingress of the destination socket. Therefore, we should charge its
    > receive socket buffer, instead of sending socket buffer.
    > Because sk_rmem_schedule() tests pfmemalloc of skb, we need to
    > introduce a wrapper and call it for skmsg.
    > Fixes: 604326b41a6f (&quot;bpf, sockmap: convert to generic sk_msg interface&quot;)
    > Signed-off-by: Cong Wang &lt;cong.wang@bytedance.com&gt;
    > Signed-off-by: Daniel Borkmann &lt;daniel@iogearbox.net&gt;
    > Reviewed-by: John Fastabend &lt;john.fastabend@gmail.com&gt;
    > Link: https://lore.kernel.org/bpf/20241210012039.1669389-2-zijianzhang@bytedance.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ selftests/bpf: Fix compilation error in get_uprobe_offset() (@Jerome Marchand in [f7ef892250f8209](https://github.com/sophgo/linux-riscv/commit/f7ef892250f8209) at 2025-01-02 09:34:10)
    > [ Upstream commit 716f2bca1ce93bb95364f1fc0555c1650507b588 ]
    > In get_uprobe_offset(), the call to procmap_query() use the constant
    > PROCMAP_QUERY_VMA_EXECUTABLE, even if PROCMAP_QUERY is not defined.
    > Define PROCMAP_QUERY_VMA_EXECUTABLE when PROCMAP_QUERY isn&#x27;t.
    > Fixes: 4e9e07603ecd (&quot;selftests/bpf: make use of PROCMAP_QUERY ioctl if available&quot;)
    > Signed-off-by: Jerome Marchand &lt;jmarchan@redhat.com&gt;
    > Signed-off-by: Daniel Borkmann &lt;daniel@iogearbox.net&gt;
    > Acked-by: Yonghong Song &lt;yonghong.song@linux.dev&gt;
    > Link: https://lore.kernel.org/bpf/20241218175724.578884-1-jmarchan@redhat.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ bpf: Fix bpf_get_smp_processor_id() on !CONFIG_SMP (@Andrea Righi in [f4ab7d74247b015](https://github.com/sophgo/linux-riscv/commit/f4ab7d74247b015) at 2025-01-02 09:34:10)
    > [ Upstream commit 23579010cf0a12476e96a5f1acdf78a9c5843657 ]
    > On x86-64 calling bpf_get_smp_processor_id() in a kernel with CONFIG_SMP
    > disabled can trigger the following bug, as pcpu_hot is unavailable:
    > [    8.471774] BUG: unable to handle page fault for address: 00000000936a290c
    > [    8.471849] #PF: supervisor read access in kernel mode
    > [    8.471881] #PF: error_code(0x0000) - not-present page
    > Fix by inlining a return 0 in the !CONFIG_SMP case.
    > Fixes: 1ae6921009e5 (&quot;bpf: inline bpf_get_smp_processor_id() helper&quot;)
    > Signed-off-by: Andrea Righi &lt;arighi@nvidia.com&gt;
    > Signed-off-by: Andrii Nakryiko &lt;andrii@kernel.org&gt;
    > Link: https://lore.kernel.org/bpf/20241217195813.622568-1-arighi@nvidia.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ arm64: dts: broadcom: Fix L2 linesize for Raspberry Pi 5 (@Willow Cunningham in [f0f2e5aa56e944c](https://github.com/sophgo/linux-riscv/commit/f0f2e5aa56e944c) at 2025-01-02 09:34:10)
    > [ Upstream commit 058387d9c6b70e225da82492e1e193635c3fac3f ]
    > Set the cache-line-size parameter of the L2 cache for each core to the
    > correct value of 64 bytes.
    > Previously, the L2 cache line size was incorrectly set to 128 bytes
    > for the Broadcom BCM2712. This causes validation tests for the
    > Performance Application Programming Interface (PAPI) tool to fail as
    > they depend on sysfs accurately reporting cache line sizes.
    > The correct value of 64 bytes is stated in the official documentation of
    > the ARM Cortex A-72, which is linked in the comments of
    > arm64/boot/dts/broadcom/bcm2712.dtsi as the source for cache-line-size.
    > Fixes: faa3381267d0 (&quot;arm64: dts: broadcom: Add minimal support for Raspberry Pi 5&quot;)
    > Signed-off-by: Willow Cunningham &lt;willow.e.cunningham@maine.edu&gt;
    > Link: https://lore.kernel.org/r/20241007212954.214724-1-willow.e.cunningham@maine.edu
    > Signed-off-by: Florian Fainelli &lt;florian.fainelli@broadcom.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ fork: avoid inappropriate uprobe access to invalid mm (@Lorenzo Stoakes in [8cdfb0656965aa1](https://github.com/sophgo/linux-riscv/commit/8cdfb0656965aa1) at 2025-01-02 09:34:10)
    > [ Upstream commit 8ac662f5da19f5873fdd94c48a5cdb45b2e1b58f ]
    > If dup_mmap() encounters an issue, currently uprobe is able to access the
    > relevant mm via the reverse mapping (in build_map_info()), and if we are
    > very unlucky with a race window, observe invalid XA_ZERO_ENTRY state which
    > we establish as part of the fork error path.
    > This occurs because uprobe_write_opcode() invokes anon_vma_prepare() which
    > in turn invokes find_mergeable_anon_vma() that uses a VMA iterator,
    > invoking vma_iter_load() which uses the advanced maple tree API and thus
    > is able to observe XA_ZERO_ENTRY entries added to dup_mmap() in commit
    > d24062914837 (&quot;fork: use __mt_dup() to duplicate maple tree in
    > dup_mmap()&quot;).
    > This change was made on the assumption that only process tear-down code
    > would actually observe (and make use of) these values.  However this very
    > unlikely but still possible edge case with uprobes exists and
    > unfortunately does make these observable.
    > The uprobe operation prevents races against the dup_mmap() operation via
    > the dup_mmap_sem semaphore, which is acquired via uprobe_start_dup_mmap()
    > and dropped via uprobe_end_dup_mmap(), and held across
    > register_for_each_vma() prior to invoking build_map_info() which does the
    > reverse mapping lookup.
    > Currently these are acquired and dropped within dup_mmap(), which exposes
    > the race window prior to error handling in the invoking dup_mm() which
    > tears down the mm.
    > We can avoid all this by just moving the invocation of
    > uprobe_start_dup_mmap() and uprobe_end_dup_mmap() up a level to dup_mm()
    > and only release this lock once the dup_mmap() operation succeeds or clean
    > up is done.
    > This means that the uprobe code can never observe an incompletely
    > constructed mm and resolves the issue in this case.
    > Link: https://lkml.kernel.org/r/20241210172412.52995-1-lorenzo.stoakes@oracle.com
    > Fixes: d24062914837 (&quot;fork: use __mt_dup() to duplicate maple tree in dup_mmap()&quot;)
    > Signed-off-by: Lorenzo Stoakes &lt;lorenzo.stoakes@oracle.com&gt;
    > Reported-by: syzbot+2d788f4f7cb660dac4b7@syzkaller.appspotmail.com
    > Closes: https://lore.kernel.org/all/6756d273.050a0220.2477f.003d.GAE@google.com/
    > Cc: Adrian Hunter &lt;adrian.hunter@intel.com&gt;
    > Cc: Alexander Shishkin &lt;alexander.shishkin@linux.intel.com&gt;
    > Cc: Arnaldo Carvalho de Melo &lt;acme@kernel.org&gt;
    > Cc: Ian Rogers &lt;irogers@google.com&gt;
    > Cc: Ingo Molnar &lt;mingo@redhat.com&gt;
    > Cc: Jann Horn &lt;jannh@google.com&gt;
    > Cc: Jiri Olsa &lt;jolsa@kernel.org&gt;
    > Cc: Kan Liang &lt;kan.liang@linux.intel.com&gt;
    > Cc: Liam R. Howlett &lt;Liam.Howlett@Oracle.com&gt;
    > Cc: Mark Rutland &lt;mark.rutland@arm.com&gt;
    > Cc: Masami Hiramatsu &lt;mhiramat@kernel.org&gt;
    > Cc: Namhyung Kim &lt;namhyung@kernel.org&gt;
    > Cc: Oleg Nesterov &lt;oleg@redhat.com&gt;
    > Cc: Peng Zhang &lt;zhangpeng.00@bytedance.com&gt;
    > Cc: Peter Zijlstra &lt;peterz@infradead.org&gt;
    > Cc: Vlastimil Babka &lt;vbabka@suse.cz&gt;
    > Cc: David Hildenbrand &lt;david@redhat.com&gt;
    > Signed-off-by: Andrew Morton &lt;akpm@linux-foundation.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ smb: client: Deduplicate &quot;select NETFS_SUPPORT&quot; in Kconfig (@Dragan Simic in [825aaa75f785983](https://github.com/sophgo/linux-riscv/commit/825aaa75f785983) at 2025-01-02 09:34:10)
    > [ Upstream commit ee1c8e6b2931811a906b8c78006bfe0a3386fa60 ]
    > Repeating automatically selected options in Kconfig files is redundant, so
    > let&#x27;s delete repeated &quot;select NETFS_SUPPORT&quot; that was added accidentally.
    > Fixes: 69c3c023af25 (&quot;cifs: Implement netfslib hooks&quot;)
    > Signed-off-by: Dragan Simic &lt;dsimic@manjaro.org&gt;
    > Signed-off-by: Steve French &lt;stfrench@microsoft.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ mm/vmstat: fix a W&#x3D;1 clang compiler warning (@Bart Van Assche in [2175b66c7fc0db2](https://github.com/sophgo/linux-riscv/commit/2175b66c7fc0db2) at 2025-01-02 09:34:10)
    > [ Upstream commit 30c2de0a267c04046d89e678cc0067a9cfb455df ]
    > Fix the following clang compiler warning that is reported if the kernel is
    > built with W&#x3D;1:
    > ./include/linux/vmstat.h:518:36: error: arithmetic between different enumeration types (&#x27;enum node_stat_item&#x27; and &#x27;enum lru_list&#x27;) [-Werror,-Wenum-enum-conversion]
    > 518 |         return node_stat_name(NR_LRU_BASE + lru) + 3; // skip &quot;nr_&quot;
    > |                               ~~~~~~~~~~~ ^ ~~~
    > Link: https://lkml.kernel.org/r/20241212213126.1269116-1-bvanassche@acm.org
    > Fixes: 9d7ea9a297e6 (&quot;mm/vmstat: add helpers to get vmstat item names for each enum type&quot;)
    > Signed-off-by: Bart Van Assche &lt;bvanassche@acm.org&gt;
    > Cc: Konstantin Khlebnikov &lt;koct9i@gmail.com&gt;
    > Cc: Nathan Chancellor &lt;nathan@kernel.org&gt;
    > Signed-off-by: Andrew Morton &lt;akpm@linux-foundation.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ media: dvb-frontends: dib3000mb: fix uninit-value in dib3000_write_reg (@Nikita Zhandarovich in [c1197c1457bb709](https://github.com/sophgo/linux-riscv/commit/c1197c1457bb709) at 2025-01-02 09:34:09)
    > [ Upstream commit 2dd59fe0e19e1ab955259978082b62e5751924c7 ]
    > Syzbot reports [1] an uninitialized value issue found by KMSAN in
    > dib3000_read_reg().
    > Local u8 rb[2] is used in i2c_transfer() as a read buffer; in case
    > that call fails, the buffer may end up with some undefined values.
    > Since no elaborate error handling is expected in dib3000_write_reg(),
    > simply zero out rb buffer to mitigate the problem.
    > [1] Syzkaller report
    > dvb-usb: bulk message failed: -22 (6/0)
    > &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;
    > BUG: KMSAN: uninit-value in dib3000mb_attach+0x2d8/0x3c0 drivers/media/dvb-frontends/dib3000mb.c:758
    > dib3000mb_attach+0x2d8/0x3c0 drivers/media/dvb-frontends/dib3000mb.c:758
    > dibusb_dib3000mb_frontend_attach+0x155/0x2f0 drivers/media/usb/dvb-usb/dibusb-mb.c:31
    > dvb_usb_adapter_frontend_init+0xed/0x9a0 drivers/media/usb/dvb-usb/dvb-usb-dvb.c:290
    > dvb_usb_adapter_init drivers/media/usb/dvb-usb/dvb-usb-init.c:90 [inline]
    > dvb_usb_init drivers/media/usb/dvb-usb/dvb-usb-init.c:186 [inline]
    > dvb_usb_device_init+0x25a8/0x3760 drivers/media/usb/dvb-usb/dvb-usb-init.c:310
    > dibusb_probe+0x46/0x250 drivers/media/usb/dvb-usb/dibusb-mb.c:110
    > ...
    > Local variable rb created at:
    > dib3000_read_reg+0x86/0x4e0 drivers/media/dvb-frontends/dib3000mb.c:54
    > dib3000mb_attach+0x123/0x3c0 drivers/media/dvb-frontends/dib3000mb.c:758
    > ...
    > Fixes: 74340b0a8bc6 (&quot;V4L/DVB (4457): Remove dib3000-common-module&quot;)
    > Reported-by: syzbot+c88fc0ebe0d5935c70da@syzkaller.appspotmail.com
    > Signed-off-by: Nikita Zhandarovich &lt;n.zhandarovich@fintech.ru&gt;
    > Link: https://lore.kernel.org/r/20240517155800.9881-1-n.zhandarovich@fintech.ru
    > Signed-off-by: Mauro Carvalho Chehab &lt;mchehab@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ceph: allocate sparse_ext map only for sparse reads (@Ilya Dryomov in [122a2f3550a857e](https://github.com/sophgo/linux-riscv/commit/122a2f3550a857e) at 2025-01-02 09:34:09)
    > [ Upstream commit 18d44c5d062b97b97bb0162d9742440518958dc1 ]
    > If mounted with sparseread option, ceph_direct_read_write() ends up
    > making an unnecessarily allocation for O_DIRECT writes.
    > Fixes: 03bc06c7b0bd (&quot;ceph: add new mount option to enable sparse reads&quot;)
    > Signed-off-by: Ilya Dryomov &lt;idryomov@gmail.com&gt;
    > Reviewed-by: Alex Markuze &lt;amarkuze@redhat.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ mm: use aligned address in copy_user_gigantic_page() (@Kefeng Wang in [cb12d61361ce769](https://github.com/sophgo/linux-riscv/commit/cb12d61361ce769) at 2024-12-27 13:02:20)
    > commit f5d09de9f1bf9674c6418ff10d0a40cfe29268e1 upstream.
    > In current kernel, hugetlb_wp() calls copy_user_large_folio() with the
    > fault address.  Where the fault address may be not aligned with the huge
    > page size.  Then, copy_user_large_folio() may call
    > copy_user_gigantic_page() with the address, while
    > copy_user_gigantic_page() requires the address to be huge page size
    > aligned.  So, this may cause memory corruption or information leak,
    > addtional, use more obvious naming &#x27;addr_hint&#x27; instead of &#x27;addr&#x27; for
    > copy_user_gigantic_page().
    > Link: https://lkml.kernel.org/r/20241028145656.932941-2-wangkefeng.wang@huawei.com
    > Fixes: 530dd9926dc1 (&quot;mm: memory: improve copy_user_large_folio()&quot;)
    > Signed-off-by: Kefeng Wang &lt;wangkefeng.wang@huawei.com&gt;
    > Reviewed-by: David Hildenbrand &lt;david@redhat.com&gt;
    > Cc: Huang Ying &lt;ying.huang@intel.com&gt;
    > Cc: Matthew Wilcox (Oracle) &lt;willy@infradead.org&gt;
    > Cc: Muchun Song &lt;muchun.song@linux.dev&gt;
    > Cc: &lt;stable@vger.kernel.org&gt;
    > Signed-off-by: Andrew Morton &lt;akpm@linux-foundation.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ mm: use aligned address in clear_gigantic_page() (@Kefeng Wang in [b79b6fe0737f233](https://github.com/sophgo/linux-riscv/commit/b79b6fe0737f233) at 2024-12-27 13:02:20)
    > commit 8aca2bc96c833ba695ede7a45ad7784c836a262e upstream.
    > In current kernel, hugetlb_no_page() calls folio_zero_user() with the
    > fault address.  Where the fault address may be not aligned with the huge
    > page size.  Then, folio_zero_user() may call clear_gigantic_page() with
    > the address, while clear_gigantic_page() requires the address to be huge
    > page size aligned.  So, this may cause memory corruption or information
    > leak, addtional, use more obvious naming &#x27;addr_hint&#x27; instead of &#x27;addr&#x27; for
    > clear_gigantic_page().
    > Link: https://lkml.kernel.org/r/20241028145656.932941-1-wangkefeng.wang@huawei.com
    > Fixes: 78fefd04c123 (&quot;mm: memory: convert clear_huge_page() to folio_zero_user()&quot;)
    > Signed-off-by: Kefeng Wang &lt;wangkefeng.wang@huawei.com&gt;
    > Reviewed-by: &quot;Huang, Ying&quot; &lt;ying.huang@intel.com&gt;
    > Reviewed-by: David Hildenbrand &lt;david@redhat.com&gt;
    > Cc: Matthew Wilcox (Oracle) &lt;willy@infradead.org&gt;
    > Cc: Muchun Song &lt;muchun.song@linux.dev&gt;
    > Cc: &lt;stable@vger.kernel.org&gt;
    > Signed-off-by: Andrew Morton &lt;akpm@linux-foundation.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ mm: shmem: fix ShmemHugePages at swapout (@Hugh Dickins in [a095090b7015744](https://github.com/sophgo/linux-riscv/commit/a095090b7015744) at 2024-12-27 13:02:20)
    > commit dad2dc9c92e0f93f33cebcb0595b8daa3d57473f upstream.
    > /proc/meminfo ShmemHugePages has been showing overlarge amounts (more than
    > Shmem) after swapping out THPs: we forgot to update NR_SHMEM_THPS.
    > Add shmem_update_stats(), to avoid repetition, and risk of making that
    > mistake again: the call from shmem_delete_from_page_cache() is the bugfix;
    > the call from shmem_replace_folio() is reassuring, but not really a bugfix
    > (replace corrects misplaced swapin readahead, but huge swapin readahead
    > would be a mistake).
    > Link: https://lkml.kernel.org/r/5ba477c8-a569-70b5-923e-09ab221af45b@google.com
    > Fixes: 809bc86517cc (&quot;mm: shmem: support large folio swap out&quot;)
    > Signed-off-by: Hugh Dickins &lt;hughd@google.com&gt;
    > Reviewed-by: Shakeel Butt &lt;shakeel.butt@linux.dev&gt;
    > Reviewed-by: Yosry Ahmed &lt;yosryahmed@google.com&gt;
    > Reviewed-by: Baolin Wang &lt;baolin.wang@linux.alibaba.com&gt;
    > Tested-by: Baolin Wang &lt;baolin.wang@linux.alibaba.com&gt;
    > Cc: &lt;stable@vger.kernel.org&gt;
    > Signed-off-by: Andrew Morton &lt;akpm@linux-foundation.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ mm: convert partially_mapped set/clear operations to be atomic (@Usama Arif in [a086c8d7f2797c2](https://github.com/sophgo/linux-riscv/commit/a086c8d7f2797c2) at 2024-12-27 13:02:20)
    > commit 42b2eb69835b0fda797f70eb5b4fc213dbe3a7ea upstream.
    > Other page flags in the 2nd page, like PG_hwpoison and PG_anon_exclusive
    > can get modified concurrently.  Changes to other page flags might be lost
    > if they are happening at the same time as non-atomic partially_mapped
    > operations.  Hence, make partially_mapped operations atomic.
    > Link: https://lkml.kernel.org/r/20241212183351.1345389-1-usamaarif642@gmail.com
    > Fixes: 8422acdc97ed (&quot;mm: introduce a pageflag for partially mapped folios&quot;)
    > Reported-by: David Hildenbrand &lt;david@redhat.com&gt;
    > Link: https://lore.kernel.org/all/e53b04ad-1827-43a2-a1ab-864c7efecf6e@redhat.com/
    > Signed-off-by: Usama Arif &lt;usamaarif642@gmail.com&gt;
    > Acked-by: David Hildenbrand &lt;david@redhat.com&gt;
    > Acked-by: Johannes Weiner &lt;hannes@cmpxchg.org&gt;
    > Acked-by: Roman Gushchin &lt;roman.gushchin@linux.dev&gt;
    > Cc: Barry Song &lt;baohua@kernel.org&gt;
    > Cc: Domenico Cerasuolo &lt;cerasuolodomenico@gmail.com&gt;
    > Cc: Jonathan Corbet &lt;corbet@lwn.net&gt;
    > Cc: Matthew Wilcox &lt;willy@infradead.org&gt;
    > Cc: Mike Rapoport (Microsoft) &lt;rppt@kernel.org&gt;
    > Cc: Nico Pache &lt;npache@redhat.com&gt;
    > Cc: Rik van Riel &lt;riel@surriel.com&gt;
    > Cc: Ryan Roberts &lt;ryan.roberts@arm.com&gt;
    > Cc: Shakeel Butt &lt;shakeel.butt@linux.dev&gt;
    > Cc: Yu Zhao &lt;yuzhao@google.com&gt;
    > Cc: &lt;stable@vger.kernel.org&gt;
    > Signed-off-by: Andrew Morton &lt;akpm@linux-foundation.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ Linux 6.12.7 (@Greg Kroah-Hartman in [319addc2ad901da](https://github.com/sophgo/linux-riscv/commit/319addc2ad901da) at 2024-12-27 13:02:20)
    > Link: https://lore.kernel.org/r/20241223155408.598780301@linuxfoundation.org
    > Tested-by: SeongJae Park &lt;sj@kernel.org&gt;
    > Tested-by: Shuah Khan &lt;skhan@linuxfoundation.org&gt;
    > Tested-by: Takeshi Ogasawara &lt;takeshi.ogasawara@futuring-girl.com&gt;
    > Tested-by: Salvatore Bonaccorso &lt;carnil@debian.org&gt;
    > Tested-by: Harshit Mogalapalli &lt;harshit.m.mogalapalli@oracle.com&gt;
    > Tested-by: Ron Economos &lt;re@w6rz.net&gt;
    > Tested-by: Peter Schneider &lt;pschneider1968@googlemail.com&gt;
    > Tested-by: Luna Jernberg &lt;droidbittin@gmail.com&gt;
    > Tested-by: Jon Hunter &lt;jonathanh@nvidia.com&gt;
    > Tested-by: Justin M. Forbes &lt;jforbes@fedoraproject.org&gt;
    > Tested-by: kernelci.org bot &lt;bot@kernelci.org&gt;
    > Tested-by: Markus Reichelt &lt;lkt+2023@mareichelt.com&gt;
    > Tested-by: Florian Fainelli &lt;florian.fainelli@broadcom.com&gt;
    > Tested-by: Hardik Garg &lt;hargar@linux.microsoft.com&gt;
    > Tested-by: Pavel Machek (CIP) &lt;pavel@denx.de&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ epoll: Add synchronous wakeup support for ep_poll_callback (@Xuewen Yan in [2d129beb8dd49f1](https://github.com/sophgo/linux-riscv/commit/2d129beb8dd49f1) at 2024-12-27 13:02:20)
    > commit 900bbaae67e980945dec74d36f8afe0de7556d5a upstream.
    > Now, the epoll only use wake_up() interface to wake up task.
    > However, sometimes, there are epoll users which want to use
    > the synchronous wakeup flag to hint the scheduler, such as
    > Android binder driver.
    > So add a wake_up_sync() define, and use the wake_up_sync()
    > when the sync is true in ep_poll_callback().
    > Co-developed-by: Jing Xia &lt;jing.xia@unisoc.com&gt;
    > Signed-off-by: Jing Xia &lt;jing.xia@unisoc.com&gt;
    > Signed-off-by: Xuewen Yan &lt;xuewen.yan@unisoc.com&gt;
    > Link: https://lore.kernel.org/r/20240426080548.8203-1-xuewen.yan@unisoc.com
    > Tested-by: Brian Geffon &lt;bgeffon@google.com&gt;
    > Reviewed-by: Brian Geffon &lt;bgeffon@google.com&gt;
    > Reported-by: Benoit Lize &lt;lizeb@google.com&gt;
    > Signed-off-by: Christian Brauner &lt;brauner@kernel.org&gt;
    > Cc: Brian Geffon &lt;bgeffon@google.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ ceph: fix memory leak in ceph_direct_read_write() (@Ilya Dryomov in [eb9041837123f31](https://github.com/sophgo/linux-riscv/commit/eb9041837123f31) at 2024-12-27 13:02:19)
    > commit 66e0c4f91461d17d48071695271c824620bed4ef upstream.
    > The bvecs array which is allocated in iter_get_bvecs_alloc() is leaked
    > and pages remain pinned if ceph_alloc_sparse_ext_map() fails.
    > There is no need to delay the allocation of sparse_ext map until after
    > the bvecs array is set up, so fix this by moving sparse_ext allocation
    > a bit earlier.  Also, make a similar adjustment in __ceph_sync_read()
    > for consistency (a leak of the same kind in __ceph_sync_read() has been
    > addressed differently).
    > Cc: stable@vger.kernel.org
    > Fixes: 03bc06c7b0bd (&quot;ceph: add new mount option to enable sparse reads&quot;)
    > Signed-off-by: Ilya Dryomov &lt;idryomov@gmail.com&gt;
    > Reviewed-by: Alex Markuze &lt;amarkuze@redhat.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ ceph: validate snapdirname option length when mounting (@Ilya Dryomov in [ddbbc04989f0f20](https://github.com/sophgo/linux-riscv/commit/ddbbc04989f0f20) at 2024-12-27 13:02:19)
    > commit 12eb22a5a609421b380c3c6ca887474fb2089b2c upstream.
    > It becomes a path component, so it shouldn&#x27;t exceed NAME_MAX
    > characters.  This was hardened in commit c152737be22b (&quot;ceph: Use
    > strscpy() instead of strcpy() in __get_snap_name()&quot;), but no actual
    > check was put in place.
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Ilya Dryomov &lt;idryomov@gmail.com&gt;
    > Reviewed-by: Alex Markuze &lt;amarkuze@redhat.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ ceph: fix memory leaks in __ceph_sync_read() (@Max Kellermann in [cbd952b2c4e6eb5](https://github.com/sophgo/linux-riscv/commit/cbd952b2c4e6eb5) at 2024-12-27 13:02:19)
    > commit d6fd6f8280f0257ba93f16900a0d3d3912f32c79 upstream.
    > In two &#x60;break&#x60; statements, the call to ceph_release_page_vector() was
    > missing, leaking the allocation from ceph_alloc_page_vector().
    > Instead of adding the missing ceph_release_page_vector() calls, the
    > Ceph maintainers preferred to transfer page ownership to the
    > &#x60;ceph_osd_request&#x60; by passing &#x60;own_pages&#x3D;true&#x60; to
    > osd_req_op_extent_osd_data_pages().  This requires postponing the
    > ceph_osdc_put_request() call until after the block that accesses the
    > &#x60;pages&#x60;.
    > Cc: stable@vger.kernel.org
    > Fixes: 03bc06c7b0bd (&quot;ceph: add new mount option to enable sparse reads&quot;)
    > Fixes: f0fe1e54cfcf (&quot;ceph: plumb in decryption during reads&quot;)
    > Signed-off-by: Max Kellermann &lt;max.kellermann@ionos.com&gt;
    > Reviewed-by: Ilya Dryomov &lt;idryomov@gmail.com&gt;
    > Signed-off-by: Ilya Dryomov &lt;idryomov@gmail.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ of: Fix error path in of_parse_phandle_with_args_map() (@Herve Codina in [c62318587c06f47](https://github.com/sophgo/linux-riscv/commit/c62318587c06f47) at 2024-12-27 13:02:19)
    > commit d7dfa7fde63dde4d2ec0083133efe2c6686c03ff upstream.
    > The current code uses some &#x27;goto put;&#x27; to cancel the parsing operation
    > and can lead to a return code value of 0 even on error cases.
    > Indeed, some goto calls are done from a loop without setting the ret
    > value explicitly before the goto call and so the ret value can be set to
    > 0 due to operation done in previous loop iteration. For instance match
    > can be set to 0 in the previous loop iteration (leading to a new
    > iteration) but ret can also be set to 0 it the of_property_read_u32()
    > call succeed. In that case if no match are found or if an error is
    > detected the new iteration, the return value can be wrongly 0.
    > Avoid those cases setting the ret value explicitly before the goto
    > calls.
    > Fixes: bd6f2fd5a1d5 (&quot;of: Support parsing phandle argument lists through a nexus node&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Herve Codina &lt;herve.codina@bootlin.com&gt;
    > Link: https://lore.kernel.org/r/20241202165819.158681-1-herve.codina@bootlin.com
    > Signed-off-by: Rob Herring (Arm) &lt;robh@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ of: Fix refcount leakage for OF node returned by __of_get_dma_parent() (@Zijun Hu in [adc4b70fb659a80](https://github.com/sophgo/linux-riscv/commit/adc4b70fb659a80) at 2024-12-27 13:02:19)
    > commit 5d009e024056ded20c5bb1583146b833b23bbd5a upstream.
    > __of_get_dma_parent() returns OF device node @args.np, but the node&#x27;s
    > refcount is increased twice, by both of_parse_phandle_with_args() and
    > of_node_get(), so causes refcount leakage for the node.
    > Fix by directly returning the node got by of_parse_phandle_with_args().
    > Fixes: f83a6e5dea6c (&quot;of: address: Add support for the parent DMA bus&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Zijun Hu &lt;quic_zijuhu@quicinc.com&gt;
    > Link: https://lore.kernel.org/r/20241206-of_core_fix-v1-4-dc28ed56bec3@quicinc.com
    > Signed-off-by: Rob Herring (Arm) &lt;robh@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ ceph: give up on paths longer than PATH_MAX (@Max Kellermann in [99a37ab76a315c8](https://github.com/sophgo/linux-riscv/commit/99a37ab76a315c8) at 2024-12-27 13:02:19)
    > commit 550f7ca98ee028a606aa75705a7e77b1bd11720f upstream.
    > If the full path to be built by ceph_mdsc_build_path() happens to be
    > longer than PATH_MAX, then this function will enter an endless (retry)
    > loop, effectively blocking the whole task.  Most of the machine
    > becomes unusable, making this a very simple and effective DoS
    > vulnerability.
    > I cannot imagine why this retry was ever implemented, but it seems
    > rather useless and harmful to me.  Let&#x27;s remove it and fail with
    > ENAMETOOLONG instead.
    > Cc: stable@vger.kernel.org
    > Reported-by: Dario Weißer &lt;dario@cure53.de&gt;
    > Signed-off-by: Max Kellermann &lt;max.kellermann@ionos.com&gt;
    > Reviewed-by: Alex Markuze &lt;amarkuze@redhat.com&gt;
    > Signed-off-by: Ilya Dryomov &lt;idryomov@gmail.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ ceph: improve error handling and short/overflow-read logic in __ceph_sync_read() (@Alex Markuze in [28433d0b7b29558](https://github.com/sophgo/linux-riscv/commit/28433d0b7b29558) at 2024-12-27 13:02:19)
    > commit 9abee475803fab6ad59d4f4fc59c6a75374a7d9d upstream.
    > This patch refines the read logic in __ceph_sync_read() to ensure more
    > predictable and efficient behavior in various edge cases.
    > - Return early if the requested read length is zero or if the file size
    > (&#x60;i_size&#x60;) is zero.
    > - Initialize the index variable (&#x60;idx&#x60;) where needed and reorder some
    > code to ensure it is always set before use.
    > - Improve error handling by checking for negative return values earlier.
    > - Remove redundant encrypted file checks after failures. Only attempt
    > filesystem-level decryption if the read succeeded.
    > - Simplify leftover calculations to correctly handle cases where the
    > read extends beyond the end of the file or stops short.  This can be
    > hit by continuously reading a file while, on another client, we keep
    > truncating and writing new data into it.
    > - This resolves multiple issues caused by integer and consequent buffer
    > overflow (&#x60;pages&#x60; array being accessed beyond &#x60;num_pages&#x60;):
    > - https://tracker.ceph.com/issues/67524
    > - https://tracker.ceph.com/issues/68980
    > - https://tracker.ceph.com/issues/68981
    > Cc: stable@vger.kernel.org
    > Fixes: 1065da21e5df (&quot;ceph: stop copying to iter at EOF on sync reads&quot;)
    > Reported-by: Luis Henriques (SUSE) &lt;luis.henriques@linux.dev&gt;
    > Signed-off-by: Alex Markuze &lt;amarkuze@redhat.com&gt;
    > Reviewed-by: Viacheslav Dubeyko &lt;Slava.Dubeyko@ibm.com&gt;
    > Signed-off-by: Ilya Dryomov &lt;idryomov@gmail.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ nilfs2: prevent use of deleted inode (@Edward Adam Davis in [ff561987ff12b6a](https://github.com/sophgo/linux-riscv/commit/ff561987ff12b6a) at 2024-12-27 13:02:18)
    > commit 901ce9705fbb9f330ff1f19600e5daf9770b0175 upstream.
    > syzbot reported a WARNING in nilfs_rmdir. [1]
    > Because the inode bitmap is corrupted, an inode with an inode number that
    > should exist as a &quot;.nilfs&quot; file was reassigned by nilfs_mkdir for &quot;file0&quot;,
    > causing an inode duplication during execution.  And this causes an
    > underflow of i_nlink in rmdir operations.
    > The inode is used twice by the same task to unmount and remove directories
    > &quot;.nilfs&quot; and &quot;file0&quot;, it trigger warning in nilfs_rmdir.
    > Avoid to this issue, check i_nlink in nilfs_iget(), if it is 0, it means
    > that this inode has been deleted, and iput is executed to reclaim it.
    > [1]
    > WARNING: CPU: 1 PID: 5824 at fs/inode.c:407 drop_nlink+0xc4/0x110 fs/inode.c:407
    > ...
    > Call Trace:
    > &lt;TASK&gt;
    > nilfs_rmdir+0x1b0/0x250 fs/nilfs2/namei.c:342
    > vfs_rmdir+0x3a3/0x510 fs/namei.c:4394
    > do_rmdir+0x3b5/0x580 fs/namei.c:4453
    > __do_sys_rmdir fs/namei.c:4472 [inline]
    > __se_sys_rmdir fs/namei.c:4470 [inline]
    > __x64_sys_rmdir+0x47/0x50 fs/namei.c:4470
    > do_syscall_x64 arch/x86/entry/common.c:52 [inline]
    > do_syscall_64+0xf3/0x230 arch/x86/entry/common.c:83
    > entry_SYSCALL_64_after_hwframe+0x77/0x7f
    > Link: https://lkml.kernel.org/r/20241209065759.6781-1-konishi.ryusuke@gmail.com
    > Fixes: d25006523d0b (&quot;nilfs2: pathname operations&quot;)
    > Signed-off-by: Ryusuke Konishi &lt;konishi.ryusuke@gmail.com&gt;
    > Reported-by: syzbot+9260555647a5132edd48@syzkaller.appspotmail.com
    > Closes: https://syzkaller.appspot.com/bug?extid&#x3D;9260555647a5132edd48
    > Tested-by: syzbot+9260555647a5132edd48@syzkaller.appspotmail.com
    > Signed-off-by: Edward Adam Davis &lt;eadavis@qq.com&gt;
    > Cc: &lt;stable@vger.kernel.org&gt;
    > Signed-off-by: Andrew Morton &lt;akpm@linux-foundation.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ of: property: fw_devlink: Do not use interrupt-parent directly (@Samuel Holland in [e0d9c581ac735dc](https://github.com/sophgo/linux-riscv/commit/e0d9c581ac735dc) at 2024-12-27 13:02:18)
    > commit bc7acc0bd0f94c26bc0defc902311794a3d0fae9 upstream.
    > commit 7f00be96f125 (&quot;of: property: Add device link support for
    > interrupt-parent, dmas and -gpio(s)&quot;) started adding device links for
    > the interrupt-parent property. commit 4104ca776ba3 (&quot;of: property: Add
    > fw_devlink support for interrupts&quot;) and commit f265f06af194 (&quot;of:
    > property: Fix fw_devlink handling of interrupts/interrupts-extended&quot;)
    > later added full support for parsing the interrupts and
    > interrupts-extended properties, which includes looking up the node of
    > the parent domain. This made the handler for the interrupt-parent
    > property redundant.
    > In fact, creating device links based solely on interrupt-parent is
    > problematic, because it can create spurious cycles. A node may have
    > this property without itself being an interrupt controller or consumer.
    > For example, this property is often present in the root node or a /soc
    > bus node to set the default interrupt parent for child nodes. However,
    > it is incorrect for the bus to depend on the interrupt controller, as
    > some of the bus&#x27;s children may not be interrupt consumers at all or may
    > have a different interrupt parent.
    > Resolving these spurious dependency cycles can cause an incorrect probe
    > order for interrupt controller drivers. This was observed on a RISC-V
    > system with both an APLIC and IMSIC under /soc, where interrupt-parent
    > in /soc points to the APLIC, and the APLIC msi-parent points to the
    > IMSIC. fw_devlink found three dependency cycles and attempted to probe
    > the APLIC before the IMSIC. After applying this patch, there were no
    > dependency cycles and the probe order was correct.
    > Acked-by: Marc Zyngier &lt;maz@kernel.org&gt;
    > Cc: stable@vger.kernel.org
    > Fixes: 4104ca776ba3 (&quot;of: property: Add fw_devlink support for interrupts&quot;)
    > Signed-off-by: Samuel Holland &lt;samuel.holland@sifive.com&gt;
    > Link: https://lore.kernel.org/r/20241120233124.3649382-1-samuel.holland@sifive.com
    > Signed-off-by: Rob Herring (Arm) &lt;robh@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ udmabuf: fix racy memfd sealing check (@Jann Horn in [93f08e5c393fa64](https://github.com/sophgo/linux-riscv/commit/93f08e5c393fa64) at 2024-12-27 13:02:18)
    > commit 9cb189a882738c1d28b349d4e7c6a1ef9b3d8f87 upstream.
    > The current check_memfd_seals() is racy: Since we first do
    > check_memfd_seals() and then udmabuf_pin_folios() without holding any
    > relevant lock across both, F_SEAL_WRITE can be set in between.
    > This is problematic because we can end up holding pins to pages in a
    > write-sealed memfd.
    > Fix it using the inode lock, that&#x27;s probably the easiest way.
    > In the future, we might want to consider moving this logic into memfd,
    > especially if anyone else wants to use memfd_pin_folios().
    > Reported-by: Julian Orth &lt;ju.orth@gmail.com&gt;
    > Closes: https://bugzilla.kernel.org/show_bug.cgi?id&#x3D;219106
    > Closes: https://lore.kernel.org/r/CAG48ez0w8HrFEZtJkfmkVKFDhE5aP7nz&#x3D;obrimeTgpD+StkV9w@mail.gmail.com
    > Fixes: fbb0de795078 (&quot;Add udmabuf misc device&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Jann Horn &lt;jannh@google.com&gt;
    > Acked-by: Joel Fernandes (Google) &lt;joel@joelfernandes.org&gt;
    > Acked-by: Vivek Kasireddy &lt;vivek.kasireddy@intel.com&gt;
    > Signed-off-by: Vivek Kasireddy &lt;vivek.kasireddy@intel.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20241204-udmabuf-fixes-v2-1-23887289de1c@google.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ ocfs2: fix the space leak in LA when releasing LA (@Heming Zhao in [69860ca08e5c1a1](https://github.com/sophgo/linux-riscv/commit/69860ca08e5c1a1) at 2024-12-27 13:02:18)
    > commit 7782e3b3b004e8cb94a88621a22cc3c2f33e5b90 upstream.
    > Commit 30dd3478c3cd (&quot;ocfs2: correctly use ocfs2_find_next_zero_bit()&quot;)
    > introduced an issue, the ocfs2_sync_local_to_main() ignores the last
    > contiguous free bits, which causes an OCFS2 volume to lose the last free
    > clusters of LA window during the release routine.
    > Please note, because commit dfe6c5692fb5 (&quot;ocfs2: fix the la space leak
    > when unmounting an ocfs2 volume&quot;) was reverted, this commit is a
    > replacement fix for commit dfe6c5692fb5.
    > Link: https://lkml.kernel.org/r/20241205104835.18223-3-heming.zhao@suse.com
    > Fixes: 30dd3478c3cd (&quot;ocfs2: correctly use ocfs2_find_next_zero_bit()&quot;)
    > Signed-off-by: Heming Zhao &lt;heming.zhao@suse.com&gt;
    > Suggested-by: Joseph Qi &lt;joseph.qi@linux.alibaba.com&gt;
    > Reviewed-by: Joseph Qi &lt;joseph.qi@linux.alibaba.com&gt;
    > Cc: Mark Fasheh &lt;mark@fasheh.com&gt;
    > Cc: Joel Becker &lt;jlbec@evilplan.org&gt;
    > Cc: Junxiao Bi &lt;junxiao.bi@oracle.com&gt;
    > Cc: Changwei Ge &lt;gechangwei@live.cn&gt;
    > Cc: Jun Piao &lt;piaojun@huawei.com&gt;
    > Cc: &lt;stable@vger.kernel.org&gt;
    > Signed-off-by: Andrew Morton &lt;akpm@linux-foundation.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ of: address: Preserve the flags portion on 1:1 dma-ranges mapping (@Andrea della Porta in [501d68639106c52](https://github.com/sophgo/linux-riscv/commit/501d68639106c52) at 2024-12-27 13:02:18)
    > commit 7f05e20b989ac33c9c0f8c2028ec0a566493548f upstream.
    > A missing or empty dma-ranges in a DT node implies a 1:1 mapping for dma
    > translations. In this specific case, the current behaviour is to zero out
    > the entire specifier so that the translation could be carried on as an
    > offset from zero. This includes address specifier that has flags (e.g.
    > PCI ranges).
    > Once the flags portion has been zeroed, the translation chain is broken
    > since the mapping functions will check the upcoming address specifier
    > against mismatching flags, always failing the 1:1 mapping and its entire
    > purpose of always succeeding.
    > Set to zero only the address portion while passing the flags through.
    > Fixes: dbbdee94734b (&quot;of/address: Merge all of the bus translation code&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Andrea della Porta &lt;andrea.porta@suse.com&gt;
    > Tested-by: Herve Codina &lt;herve.codina@bootlin.com&gt;
    > Link: https://lore.kernel.org/r/e51ae57874e58a9b349c35e2e877425ebc075d7a.1732441813.git.andrea.porta@suse.com
    > Signed-off-by: Rob Herring (Arm) &lt;robh@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ nilfs2: fix buffer head leaks in calls to truncate_inode_pages() (@Ryusuke Konishi in [4a650eb9482c21c](https://github.com/sophgo/linux-riscv/commit/4a650eb9482c21c) at 2024-12-27 13:02:18)
    > commit 6309b8ce98e9a18390b9fd8f03fc412f3c17aee9 upstream.
    > When block_invalidatepage was converted to block_invalidate_folio, the
    > fallback to block_invalidatepage in folio_invalidate() if the
    > address_space_operations method invalidatepage (currently
    > invalidate_folio) was not set, was removed.
    > Unfortunately, some pseudo-inodes in nilfs2 use empty_aops set by
    > inode_init_always_gfp() as is, or explicitly set it to
    > address_space_operations.  Therefore, with this change,
    > block_invalidatepage() is no longer called from folio_invalidate(), and as
    > a result, the buffer_head structures attached to these pages/folios are no
    > longer freed via try_to_free_buffers().
    > Thus, these buffer heads are now leaked by truncate_inode_pages(), which
    > cleans up the page cache from inode evict(), etc.
    > Three types of caches use empty_aops: gc inode caches and the DAT shadow
    > inode used by GC, and b-tree node caches.  Of these, b-tree node caches
    > explicitly call invalidate_mapping_pages() during cleanup, which involves
    > calling try_to_free_buffers(), so the leak was not visible during normal
    > operation but worsened when GC was performed.
    > Fix this issue by using address_space_operations with invalidate_folio set
    > to block_invalidate_folio instead of empty_aops, which will ensure the
    > same behavior as before.
    > Link: https://lkml.kernel.org/r/20241212164556.21338-1-konishi.ryusuke@gmail.com
    > Fixes: 7ba13abbd31e (&quot;fs: Turn block_invalidatepage into block_invalidate_folio&quot;)
    > Signed-off-by: Ryusuke Konishi &lt;konishi.ryusuke@gmail.com&gt;
    > Cc: &lt;stable@vger.kernel.org&gt;	[5.18+]
    > Signed-off-by: Andrew Morton &lt;akpm@linux-foundation.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ udmabuf: also check for F_SEAL_FUTURE_WRITE (@Jann Horn in [185edda7d773bc6](https://github.com/sophgo/linux-riscv/commit/185edda7d773bc6) at 2024-12-27 13:02:18)
    > commit 0a16e24e34f28210f68195259456c73462518597 upstream.
    > When F_SEAL_FUTURE_WRITE was introduced, it was overlooked that udmabuf
    > must reject memfds with this flag, just like ones with F_SEAL_WRITE.
    > Fix it by adding F_SEAL_FUTURE_WRITE to SEALS_DENIED.
    > Fixes: ab3948f58ff8 (&quot;mm/memfd: add an F_SEAL_FUTURE_WRITE seal to memfd&quot;)
    > Cc: stable@vger.kernel.org
    > Acked-by: Vivek Kasireddy &lt;vivek.kasireddy@intel.com&gt;
    > Signed-off-by: Jann Horn &lt;jannh@google.com&gt;
    > Reviewed-by: Joel Fernandes (Google) &lt;joel@joelfernandes.org&gt;
    > Signed-off-by: Vivek Kasireddy &lt;vivek.kasireddy@intel.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20241204-udmabuf-fixes-v2-2-23887289de1c@google.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ of/irq: Fix using uninitialized variable @addr_len in API of_irq_parse_one() (@Zijun Hu in [e30e72844c1c711](https://github.com/sophgo/linux-riscv/commit/e30e72844c1c711) at 2024-12-27 13:02:17)
    > commit 0f7ca6f69354e0c3923bbc28c92d0ecab4d50a3e upstream.
    > of_irq_parse_one() may use uninitialized variable @addr_len as shown below:
    > // @addr_len is uninitialized
    > int addr_len;
    > // This operation does not touch @addr_len if it fails.
    > addr &#x3D; of_get_property(device, &quot;reg&quot;, &amp;addr_len);
    > // Use uninitialized @addr_len if the operation fails.
    > if (addr_len &gt; sizeof(addr_buf))
    > addr_len &#x3D; sizeof(addr_buf);
    > // Check the operation result here.
    > if (addr)
    > memcpy(addr_buf, addr, addr_len);
    > Fix by initializing @addr_len before the operation.
    > Fixes: b739dffa5d57 (&quot;of/irq: Prevent device address out-of-bounds read in interrupt map walk&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Zijun Hu &lt;quic_zijuhu@quicinc.com&gt;
    > Link: https://lore.kernel.org/r/20241209-of_irq_fix-v1-4-782f1419c8a1@quicinc.com
    > Signed-off-by: Rob Herring (Arm) &lt;robh@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ io_uring: check if iowq is killed before queuing (@Pavel Begunkov in [4f95a2186b7f2af](https://github.com/sophgo/linux-riscv/commit/4f95a2186b7f2af) at 2024-12-27 13:02:17)
    > commit dbd2ca9367eb19bc5e269b8c58b0b1514ada9156 upstream.
    > task work can be executed after the task has gone through io_uring
    > termination, whether it&#x27;s the final task_work run or the fallback path.
    > In this case, task work will find -&gt;io_wq being already killed and
    > null&#x27;ed, which is a problem if it then tries to forward the request to
    > io_queue_iowq(). Make io_queue_iowq() fail requests in this case.
    > Note that it also checks PF_KTHREAD, because the user can first close
    > a DEFER_TASKRUN ring and shortly after kill the task, in which case
    > -&gt;iowq check would race.
    > Cc: stable@vger.kernel.org
    > Fixes: 50c52250e2d74 (&quot;block: implement async io_uring discard cmd&quot;)
    > Fixes: 773af69121ecc (&quot;io_uring: always reissue from task_work context&quot;)
    > Reported-by: Will &lt;willsroot@protonmail.com&gt;
    > Signed-off-by: Pavel Begunkov &lt;asml.silence@gmail.com&gt;
    > Link: https://lore.kernel.org/r/63312b4a2c2bb67ad67b857d17a300e1d3b078e8.1734637909.git.asml.silence@gmail.com
    > Signed-off-by: Jens Axboe &lt;axboe@kernel.dk&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ selftests/bpf: Use asm constraint &quot;m&quot; for LoongArch (@Tiezhu Yang in [416226eb3f3a300](https://github.com/sophgo/linux-riscv/commit/416226eb3f3a300) at 2024-12-27 13:02:17)
    > commit 29d44cce324dab2bd86c447071a596262e7109b6 upstream.
    > Currently, LoongArch LLVM does not support the constraint &quot;o&quot; and no plan
    > to support it, it only supports the similar constraint &quot;m&quot;, so change the
    > constraints from &quot;nor&quot; in the &quot;else&quot; case to arch-specific &quot;nmr&quot; to avoid
    > the build error such as &quot;unexpected asm memory constraint&quot; for LoongArch.
    > Fixes: 630301b0d59d (&quot;selftests/bpf: Add basic USDT selftests&quot;)
    > Suggested-by: Weining Lu &lt;luweining@loongson.cn&gt;
    > Suggested-by: Li Chen &lt;chenli@loongson.cn&gt;
    > Signed-off-by: Tiezhu Yang &lt;yangtiezhu@loongson.cn&gt;
    > Signed-off-by: Daniel Borkmann &lt;daniel@iogearbox.net&gt;
    > Reviewed-by: Huacai Chen &lt;chenhuacai@loongson.cn&gt;
    > Cc: stable@vger.kernel.org
    > Link: https://llvm.org/docs/LangRef.html#supported-constraint-code-list
    > Link: https://github.com/llvm/llvm-project/blob/main/llvm/lib/Target/LoongArch/LoongArchISelDAGToDAG.cpp#L172
    > Link: https://lore.kernel.org/bpf/20241219111506.20643-1-yangtiezhu@loongson.cn
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ KVM: SVM: Allow guest writes to set MSR_AMD64_DE_CFG bits (@Sean Christopherson in [3931567bf1757a2](https://github.com/sophgo/linux-riscv/commit/3931567bf1757a2) at 2024-12-27 13:02:17)
    > commit 4d5163cba43fe96902165606fa54e1aecbbb32de upstream.
    > Drop KVM&#x27;s arbitrary behavior of making DE_CFG.LFENCE_SERIALIZE read-only
    > for the guest, as rejecting writes can lead to guest crashes, e.g. Windows
    > in particular doesn&#x27;t gracefully handle unexpected #GPs on the WRMSR, and
    > nothing in the AMD manuals suggests that LFENCE_SERIALIZE is read-only _if
    > it exists_.
    > KVM only allows LFENCE_SERIALIZE to be set, by the guest or host, if the
    > underlying CPU has X86_FEATURE_LFENCE_RDTSC, i.e. if LFENCE is guaranteed
    > to be serializing.  So if the guest sets LFENCE_SERIALIZE, KVM will provide
    > the desired/correct behavior without any additional action (the guest&#x27;s
    > value is never stuffed into hardware).  And having LFENCE be serializing
    > even when it&#x27;s not _required_ to be is a-ok from a functional perspective.
    > Fixes: 74a0e79df68a (&quot;KVM: SVM: Disallow guest from changing userspace&#x27;s MSR_AMD64_DE_CFG value&quot;)
    > Fixes: d1d93fa90f1a (&quot;KVM: SVM: Add MSR-based feature support for serializing LFENCE&quot;)
    > Reported-by: Simon Pilkington &lt;simonp.git@mailbox.org&gt;
    > Closes: https://lore.kernel.org/all/52914da7-a97b-45ad-86a0-affdf8266c61@mailbox.org
    > Cc: Tom Lendacky &lt;thomas.lendacky@amd.com&gt;
    > Cc: stable@vger.kernel.org
    > Reviewed-by: Tom Lendacky &lt;thomas.lendacky@amd.com&gt;
    > Link: https://lore.kernel.org/r/20241211172952.1477605-1-seanjc@google.com
    > Signed-off-by: Sean Christopherson &lt;seanjc@google.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ of/irq: Fix interrupt-map cell length check in of_irq_parse_imap_parent() (@Zijun Hu in [2976661ed4de10b](https://github.com/sophgo/linux-riscv/commit/2976661ed4de10b) at 2024-12-27 13:02:17)
    > commit fec3edc47d5cfc2dd296a5141df887bf567944db upstream.
    > On a malformed interrupt-map property which is shorter than expected by
    > 1 cell, we may read bogus data past the end of the property instead of
    > returning an error in of_irq_parse_imap_parent().
    > Decrement the remaining length when skipping over the interrupt parent
    > phandle cell.
    > Fixes: 935df1bd40d4 (&quot;of/irq: Factor out parsing of interrupt-map parent phandle+args from of_irq_parse_raw()&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Zijun Hu &lt;quic_zijuhu@quicinc.com&gt;
    > Link: https://lore.kernel.org/r/20241209-of_irq_fix-v1-1-782f1419c8a1@quicinc.com
    > [rh: reword commit msg]
    > Signed-off-by: Rob Herring (Arm) &lt;robh@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ NFS/pnfs: Fix a live lock between recalled layouts and layoutget (@Trond Myklebust in [16846e8e0ace406](https://github.com/sophgo/linux-riscv/commit/16846e8e0ace406) at 2024-12-27 13:02:17)
    > commit 62e2a47ceab8f3f7d2e3f0e03fdd1c5e0059fd8b upstream.
    > When the server is recalling a layout, we should ignore the count of
    > outstanding layoutget calls, since the server is expected to return
    > either NFS4ERR_RECALLCONFLICT or NFS4ERR_RETURNCONFLICT for as long as
    > the recall is outstanding.
    > Currently, we may end up livelocking, causing the layout to eventually
    > be forcibly revoked.
    > Fixes: bf0291dd2267 (&quot;pNFS: Ensure LAYOUTGET and LAYOUTRETURN are properly serialised&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Trond Myklebust &lt;trond.myklebust@hammerspace.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ io_uring: Fix registered ring file refcount leak (@Jann Horn in [06eb0894896bb66](https://github.com/sophgo/linux-riscv/commit/06eb0894896bb66) at 2024-12-27 13:02:17)
    > commit 12d908116f7efd34f255a482b9afc729d7a5fb78 upstream.
    > Currently, io_uring_unreg_ringfd() (which cleans up registered rings) is
    > only called on exit, but __io_uring_free (which frees the tctx in which the
    > registered ring pointers are stored) is also called on execve (via
    > begin_new_exec -&gt; io_uring_task_cancel -&gt; __io_uring_cancel -&gt;
    > io_uring_cancel_generic -&gt; __io_uring_free).
    > This means: A process going through execve while having registered rings
    > will leak references to the rings&#x27; &#x60;struct file&#x60;.
    > Fix it by zapping registered rings on execve(). This is implemented by
    > moving the io_uring_unreg_ringfd() from io_uring_files_cancel() into its
    > callee __io_uring_cancel(), which is called from io_uring_task_cancel() on
    > execve.
    > This could probably be exploited *on 32-bit kernels* by leaking 2^32
    > references to the same ring, because the file refcount is stored in a
    > pointer-sized field and get_file() doesn&#x27;t have protection against
    > refcount overflow, just a WARN_ONCE(); but on 64-bit it should have no
    > impact beyond a memory leak.
    > Cc: stable@vger.kernel.org
    > Fixes: e7a6c00dc77a (&quot;io_uring: add support for registering ring file descriptors&quot;)
    > Signed-off-by: Jann Horn &lt;jannh@google.com&gt;
    > Link: https://lore.kernel.org/r/20241218-uring-reg-ring-cleanup-v1-1-8f63e999045b@google.com
    > Signed-off-by: Jens Axboe &lt;axboe@kernel.dk&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ selftests/memfd: run sysctl tests when PID namespace support is enabled (@Isaac J. Manjarres in [fcd39809bf673c4](https://github.com/sophgo/linux-riscv/commit/fcd39809bf673c4) at 2024-12-27 13:02:16)
    > commit 6a75f19af16ff482cfd6085c77123aa0f464f8dd upstream.
    > The sysctl tests for vm.memfd_noexec rely on the kernel to support PID
    > namespaces (i.e.  the kernel is built with CONFIG_PID_NS&#x3D;y).  If the
    > kernel the test runs on does not support PID namespaces, the first sysctl
    > test will fail when attempting to spawn a new thread in a new PID
    > namespace, abort the test, preventing the remaining tests from being run.
    > This is not desirable, as not all kernels need PID namespaces, but can
    > still use the other features provided by memfd.  Therefore, only run the
    > sysctl tests if the kernel supports PID namespaces.  Otherwise, skip those
    > tests and emit an informative message to let the user know why the sysctl
    > tests are not being run.
    > Link: https://lkml.kernel.org/r/20241205192943.3228757-1-isaacmanjarres@google.com
    > Fixes: 11f75a01448f (&quot;selftests/memfd: add tests for MFD_NOEXEC_SEAL MFD_EXEC&quot;)
    > Signed-off-by: Isaac J. Manjarres &lt;isaacmanjarres@google.com&gt;
    > Reviewed-by: Jeff Xu &lt;jeffxu@google.com&gt;
    > Cc: Suren Baghdasaryan &lt;surenb@google.com&gt;
    > Cc: Kalesh Singh &lt;kaleshsingh@google.com&gt;
    > Cc: &lt;stable@vger.kernel.org&gt;	[6.6+]
    > Signed-off-by: Andrew Morton &lt;akpm@linux-foundation.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ tracing: Check &quot;%s&quot; dereference via the field and not the TP_printk format (@Steven Rostedt in [d3e73fe7ca21b0c](https://github.com/sophgo/linux-riscv/commit/d3e73fe7ca21b0c) at 2024-12-27 13:02:16)
    > commit afd2627f727b89496d79a6b934a025fc916d4ded upstream.
    > The TP_printk() portion of a trace event is executed at the time a event
    > is read from the trace. This can happen seconds, minutes, hours, days,
    > months, years possibly later since the event was recorded. If the print
    > format contains a dereference to a string via &quot;%s&quot;, and that string was
    > allocated, there&#x27;s a chance that string could be freed before it is read
    > by the trace file.
    > To protect against such bugs, there are two functions that verify the
    > event. The first one is test_event_printk(), which is called when the
    > event is created. It reads the TP_printk() format as well as its arguments
    > to make sure nothing may be dereferencing a pointer that was not copied
    > into the ring buffer along with the event. If it is, it will trigger a
    > WARN_ON().
    > For strings that use &quot;%s&quot;, it is not so easy. The string may not reside in
    > the ring buffer but may still be valid. Strings that are static and part
    > of the kernel proper which will not be freed for the life of the running
    > system, are safe to dereference. But to know if it is a pointer to a
    > static string or to something on the heap can not be determined until the
    > event is triggered.
    > This brings us to the second function that tests for the bad dereferencing
    > of strings, trace_check_vprintf(). It would walk through the printf format
    > looking for &quot;%s&quot;, and when it finds it, it would validate that the pointer
    > is safe to read. If not, it would produces a WARN_ON() as well and write
    > into the ring buffer &quot;[UNSAFE-MEMORY]&quot;.
    > The problem with this is how it used va_list to have vsnprintf() handle
    > all the cases that it didn&#x27;t need to check. Instead of re-implementing
    > vsnprintf(), it would make a copy of the format up to the %s part, and
    > call vsnprintf() with the current va_list ap variable, where the ap would
    > then be ready to point at the string in question.
    > For architectures that passed va_list by reference this was possible. For
    > architectures that passed it by copy it was not. A test_can_verify()
    > function was used to differentiate between the two, and if it wasn&#x27;t
    > possible, it would disable it.
    > Even for architectures where this was feasible, it was a stretch to rely
    > on such a method that is undocumented, and could cause issues later on
    > with new optimizations of the compiler.
    > Instead, the first function test_event_printk() was updated to look at
    > &quot;%s&quot; as well. If the &quot;%s&quot; argument is a pointer outside the event in the
    > ring buffer, it would find the field type of the event that is the problem
    > and mark the structure with a new flag called &quot;needs_test&quot;. The event
    > itself will be marked by TRACE_EVENT_FL_TEST_STR to let it be known that
    > this event has a field that needs to be verified before the event can be
    > printed using the printf format.
    > When the event fields are created from the field type structure, the
    > fields would copy the field type&#x27;s &quot;needs_test&quot; value.
    > Finally, before being printed, a new function ignore_event() is called
    > which will check if the event has the TEST_STR flag set (if not, it
    > returns false). If the flag is set, it then iterates through the events
    > fields looking for the ones that have the &quot;needs_test&quot; flag set.
    > Then it uses the offset field from the field structure to find the pointer
    > in the ring buffer event. It runs the tests to make sure that pointer is
    > safe to print and if not, it triggers the WARN_ON() and also adds to the
    > trace output that the event in question has an unsafe memory access.
    > The ignore_event() makes the trace_check_vprintf() obsolete so it is
    > removed.
    > Link: https://lore.kernel.org/all/CAHk-&#x3D;wh3uOnqnZPpR0PeLZZtyWbZLboZ7cHLCKRWsocvs9Y7hQ@mail.gmail.com/
    > Cc: stable@vger.kernel.org
    > Cc: Masami Hiramatsu &lt;mhiramat@kernel.org&gt;
    > Cc: Mark Rutland &lt;mark.rutland@arm.com&gt;
    > Cc: Mathieu Desnoyers &lt;mathieu.desnoyers@efficios.com&gt;
    > Cc: Andrew Morton &lt;akpm@linux-foundation.org&gt;
    > Cc: Al Viro &lt;viro@ZenIV.linux.org.uk&gt;
    > Cc: Linus Torvalds &lt;torvalds@linux-foundation.org&gt;
    > Link: https://lore.kernel.org/20241217024720.848621576@goodmis.org
    > Fixes: 5013f454a352c (&quot;tracing: Add check of trace event print fmts for dereferencing pointers&quot;)
    > Signed-off-by: Steven Rostedt (Google) &lt;rostedt@goodmis.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ tracing: Add missing helper functions in event pointer dereference check (@Steven Rostedt in [71a613ceac1ad62](https://github.com/sophgo/linux-riscv/commit/71a613ceac1ad62) at 2024-12-27 13:02:16)
    > commit 917110481f6bc1c96b1e54b62bb114137fbc6d17 upstream.
    > The process_pointer() helper function looks to see if various trace event
    > macros are used. These macros are for storing data in the event. This
    > makes it safe to dereference as the dereference will then point into the
    > event on the ring buffer where the content of the data stays with the
    > event itself.
    > A few helper functions were missing. Those were:
    > __get_rel_dynamic_array()
    > __get_dynamic_array_len()
    > __get_rel_dynamic_array_len()
    > __get_rel_sockaddr()
    > Also add a helper function find_print_string() to not need to use a middle
    > man variable to test if the string exists.
    > Cc: stable@vger.kernel.org
    > Cc: Masami Hiramatsu &lt;mhiramat@kernel.org&gt;
    > Cc: Mark Rutland &lt;mark.rutland@arm.com&gt;
    > Cc: Mathieu Desnoyers &lt;mathieu.desnoyers@efficios.com&gt;
    > Cc: Andrew Morton &lt;akpm@linux-foundation.org&gt;
    > Cc: Al Viro &lt;viro@ZenIV.linux.org.uk&gt;
    > Cc: Linus Torvalds &lt;torvalds@linux-foundation.org&gt;
    > Link: https://lore.kernel.org/20241217024720.521836792@goodmis.org
    > Fixes: 5013f454a352c (&quot;tracing: Add check of trace event print fmts for dereferencing pointers&quot;)
    > Signed-off-by: Steven Rostedt (Google) &lt;rostedt@goodmis.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ tracing: Add &quot;%s&quot; check in test_event_printk() (@Steven Rostedt in [683eccacc02d2eb](https://github.com/sophgo/linux-riscv/commit/683eccacc02d2eb) at 2024-12-27 13:02:16)
    > commit 65a25d9f7ac02e0cf361356e834d1c71d36acca9 upstream.
    > The test_event_printk() code makes sure that when a trace event is
    > registered, any dereferenced pointers in from the event&#x27;s TP_printk() are
    > pointing to content in the ring buffer. But currently it does not handle
    > &quot;%s&quot;, as there&#x27;s cases where the string pointer saved in the ring buffer
    > points to a static string in the kernel that will never be freed. As that
    > is a valid case, the pointer needs to be checked at runtime.
    > Currently the runtime check is done via trace_check_vprintf(), but to not
    > have to replicate everything in vsnprintf() it does some logic with the
    > va_list that may not be reliable across architectures. In order to get rid
    > of that logic, more work in the test_event_printk() needs to be done. Some
    > of the strings can be validated at this time when it is obvious the string
    > is valid because the string will be saved in the ring buffer content.
    > Do all the validation of strings in the ring buffer at boot in
    > test_event_printk(), and make sure that the field of the strings that
    > point into the kernel are accessible. This will allow adding checks at
    > runtime that will validate the fields themselves and not rely on paring
    > the TP_printk() format at runtime.
    > Cc: stable@vger.kernel.org
    > Cc: Masami Hiramatsu &lt;mhiramat@kernel.org&gt;
    > Cc: Mark Rutland &lt;mark.rutland@arm.com&gt;
    > Cc: Mathieu Desnoyers &lt;mathieu.desnoyers@efficios.com&gt;
    > Cc: Andrew Morton &lt;akpm@linux-foundation.org&gt;
    > Cc: Al Viro &lt;viro@ZenIV.linux.org.uk&gt;
    > Cc: Linus Torvalds &lt;torvalds@linux-foundation.org&gt;
    > Link: https://lore.kernel.org/20241217024720.685917008@goodmis.org
    > Fixes: 5013f454a352c (&quot;tracing: Add check of trace event print fmts for dereferencing pointers&quot;)
    > Signed-off-by: Steven Rostedt (Google) &lt;rostedt@goodmis.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ accel/ivpu: Fix WARN in ivpu_ipc_send_receive_internal() (@Jacek Lawrynowicz in [578874b2bb947e0](https://github.com/sophgo/linux-riscv/commit/578874b2bb947e0) at 2024-12-27 13:02:16)
    > commit 0f6482caa6acdfdfc744db7430771fe7e6c4e787 upstream.
    > Move pm_runtime_set_active() to ivpu_pm_init() so when
    > ivpu_ipc_send_receive_internal() is executed before ivpu_pm_enable()
    > it already has correct runtime state, even if last resume was
    > not successful.
    > Fixes: 8ed520ff4682 (&quot;accel/ivpu: Move set autosuspend delay to HW specific code&quot;)
    > Cc: stable@vger.kernel.org # v6.7+
    > Reviewed-by: Karol Wachowski &lt;karol.wachowski@intel.com&gt;
    > Reviewed-by: Jeffrey Hugo &lt;quic_jhugo@quicinc.com&gt;
    > Signed-off-by: Jacek Lawrynowicz &lt;jacek.lawrynowicz@linux.intel.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20241210130939.1575610-4-jacek.lawrynowicz@linux.intel.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ tracing: Fix test_event_printk() to process entire print argument (@Steven Rostedt in [3985cd30472a6a6](https://github.com/sophgo/linux-riscv/commit/3985cd30472a6a6) at 2024-12-27 13:02:16)
    > commit a6629626c584200daf495cc9a740048b455addcd upstream.
    > The test_event_printk() analyzes print formats of trace events looking for
    > cases where it may dereference a pointer that is not in the ring buffer
    > which can possibly be a bug when the trace event is read from the ring
    > buffer and the content of that pointer no longer exists.
    > The function needs to accurately go from one print format argument to the
    > next. It handles quotes and parenthesis that may be included in an
    > argument. When it finds the start of the next argument, it uses a simple
    > &quot;c &#x3D; strstr(fmt + i, &#x27;,&#x27;)&quot; to find the end of that argument!
    > In order to include &quot;%s&quot; dereferencing, it needs to process the entire
    > content of the print format argument and not just the content of the first
    > &#x27;,&#x27; it finds. As there may be content like:
    > ({ const char *saved_ptr &#x3D; trace_seq_buffer_ptr(p); static const char
    > access_str[] &#x3D; { &quot;---&quot;, &quot;--x&quot;, &quot;w--&quot;, &quot;w-x&quot;, &quot;-u-&quot;, &quot;-ux&quot;, &quot;wu-&quot;, &quot;wux&quot;
    > }; union kvm_mmu_page_role role; role.word &#x3D; REC-&gt;role;
    > trace_seq_printf(p, &quot;sp gen %u gfn %llx l%u %u-byte q%u%s %s%s&quot; &quot; %snxe
    > %sad root %u %s%c&quot;, REC-&gt;mmu_valid_gen, REC-&gt;gfn, role.level,
    > role.has_4_byte_gpte ? 4 : 8, role.quadrant, role.direct ? &quot; direct&quot; : &quot;&quot;,
    > access_str[role.access], role.invalid ? &quot; invalid&quot; : &quot;&quot;, role.efer_nx ? &quot;&quot;
    > : &quot;!&quot;, role.ad_disabled ? &quot;!&quot; : &quot;&quot;, REC-&gt;root_count, REC-&gt;unsync ?
    > &quot;unsync&quot; : &quot;sync&quot;, 0); saved_ptr; })
    > Which is an example of a full argument of an existing event. As the code
    > already handles finding the next print format argument, process the
    > argument at the end of it and not the start of it. This way it has both
    > the start of the argument as well as the end of it.
    > Add a helper function &quot;process_pointer()&quot; that will do the processing during
    > the loop as well as at the end. It also makes the code cleaner and easier
    > to read.
    > Cc: stable@vger.kernel.org
    > Cc: Masami Hiramatsu &lt;mhiramat@kernel.org&gt;
    > Cc: Mark Rutland &lt;mark.rutland@arm.com&gt;
    > Cc: Mathieu Desnoyers &lt;mathieu.desnoyers@efficios.com&gt;
    > Cc: Andrew Morton &lt;akpm@linux-foundation.org&gt;
    > Cc: Al Viro &lt;viro@ZenIV.linux.org.uk&gt;
    > Cc: Linus Torvalds &lt;torvalds@linux-foundation.org&gt;
    > Link: https://lore.kernel.org/20241217024720.362271189@goodmis.org
    > Fixes: 5013f454a352c (&quot;tracing: Add check of trace event print fmts for dereferencing pointers&quot;)
    > Signed-off-by: Steven Rostedt (Google) &lt;rostedt@goodmis.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ x86/hyperv: Fix hv tsc page based sched_clock for hibernation (@Naman Jain in [bacd0498dea04be](https://github.com/sophgo/linux-riscv/commit/bacd0498dea04be) at 2024-12-27 13:02:15)
    > commit bcc80dec91ee745b3d66f3e48f0ec2efdea97149 upstream.
    > read_hv_sched_clock_tsc() assumes that the Hyper-V clock counter is
    > bigger than the variable hv_sched_clock_offset, which is cached during
    > early boot, but depending on the timing this assumption may be false
    > when a hibernated VM starts again (the clock counter starts from 0
    > again) and is resuming back (Note: hv_init_tsc_clocksource() is not
    > called during hibernation/resume); consequently,
    > read_hv_sched_clock_tsc() may return a negative integer (which is
    > interpreted as a huge positive integer since the return type is u64)
    > and new kernel messages are prefixed with huge timestamps before
    > read_hv_sched_clock_tsc() grows big enough (which typically takes
    > several seconds).
    > Fix the issue by saving the Hyper-V clock counter just before the
    > suspend, and using it to correct the hv_sched_clock_offset in
    > resume. This makes hv tsc page based sched_clock continuous and ensures
    > that post resume, it starts from where it left off during suspend.
    > Override x86_platform.save_sched_clock_state and
    > x86_platform.restore_sched_clock_state routines to correct this as soon
    > as possible.
    > Note: if Invariant TSC is available, the issue doesn&#x27;t happen because
    > 1) we don&#x27;t register read_hv_sched_clock_tsc() for sched clock:
    > See commit e5313f1c5404 (&quot;clocksource/drivers/hyper-v: Rework
    > clocksource and sched clock setup&quot;);
    > 2) the common x86 code adjusts TSC similarly: see
    > __restore_processor_state() -&gt;  tsc_verify_tsc_adjust(true) and
    > x86_platform.restore_sched_clock_state().
    > Cc: stable@vger.kernel.org
    > Fixes: 1349401ff1aa (&quot;clocksource/drivers/hyper-v: Suspend/resume Hyper-V clocksource for hibernation&quot;)
    > Co-developed-by: Dexuan Cui &lt;decui@microsoft.com&gt;
    > Signed-off-by: Dexuan Cui &lt;decui@microsoft.com&gt;
    > Signed-off-by: Naman Jain &lt;namjain@linux.microsoft.com&gt;
    > Reviewed-by: Michael Kelley &lt;mhklinux@outlook.com&gt;
    > Link: https://lore.kernel.org/r/20240917053917.76787-1-namjain@linux.microsoft.com
    > Signed-off-by: Wei Liu &lt;wei.liu@kernel.org&gt;
    > Message-ID: &lt;20240917053917.76787-1-namjain@linux.microsoft.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ accel/ivpu: Fix general protection fault in ivpu_bo_list() (@Jacek Lawrynowicz in [a1e597ee5920a6a](https://github.com/sophgo/linux-riscv/commit/a1e597ee5920a6a) at 2024-12-27 13:02:15)
    > commit 4b2efb9db0c22a130bbd1275e489b42c02d08050 upstream.
    > Check if ctx is not NULL before accessing its fields.
    > Fixes: 37dee2a2f433 (&quot;accel/ivpu: Improve buffer object debug logs&quot;)
    > Cc: stable@vger.kernel.org # v6.8
    > Reviewed-by: Karol Wachowski &lt;karol.wachowski@intel.com&gt;
    > Reviewed-by: Jeffrey Hugo &lt;quic_jhugo@quicinc.com&gt;
    > Signed-off-by: Jacek Lawrynowicz &lt;jacek.lawrynowicz@linux.intel.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20241210130939.1575610-2-jacek.lawrynowicz@linux.intel.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ tools: hv: Fix a complier warning in the fcopy uio daemon (@Dexuan Cui in [9015ebfe8ec5397](https://github.com/sophgo/linux-riscv/commit/9015ebfe8ec5397) at 2024-12-27 13:02:15)
    > commit cb1b78f1c726c938bd47497c1ab16b01ce967f37 upstream.
    > hv_fcopy_uio_daemon.c:436:53: warning: &#x27;%s&#x27; directive output may be truncated
    > writing up to 14 bytes into a region of size 10 [-Wformat-truncation&#x3D;]
    > 436 |  snprintf(uio_dev_path, sizeof(uio_dev_path), &quot;/dev/%s&quot;, uio_name);
    > Also added &#x27;static&#x27; for the array &#x27;desc[]&#x27;.
    > Fixes: 82b0945ce2c2 (&quot;tools: hv: Add new fcopy application based on uio driver&quot;)
    > Cc: stable@vger.kernel.org # 6.10+
    > Signed-off-by: Dexuan Cui &lt;decui@microsoft.com&gt;
    > Reviewed-by: Saurabh Sengar &lt;ssengar@linux.microsoft.com&gt;
    > Link: https://lore.kernel.org/r/20240910004433.50254-1-decui@microsoft.com
    > Signed-off-by: Wei Liu &lt;wei.liu@kernel.org&gt;
    > Message-ID: &lt;20240910004433.50254-1-decui@microsoft.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ fgraph: Still initialize idle shadow stacks when starting (@Steven Rostedt in [52f46047031f883](https://github.com/sophgo/linux-riscv/commit/52f46047031f883) at 2024-12-27 13:02:15)
    > commit cc252bb592638e0f7aea40d580186c36d89526b8 upstream.
    > A bug was discovered where the idle shadow stacks were not initialized
    > for offline CPUs when starting function graph tracer, and when they came
    > online they were not traced due to the missing shadow stack. To fix
    > this, the idle task shadow stack initialization was moved to using the
    > CPU hotplug callbacks. But it removed the initialization when the
    > function graph was enabled. The problem here is that the hotplug
    > callbacks are called when the CPUs come online, but the idle shadow
    > stack initialization only happens if function graph is currently
    > active. This caused the online CPUs to not get their shadow stack
    > initialized.
    > The idle shadow stack initialization still needs to be done when the
    > function graph is registered, as they will not be allocated if function
    > graph is not registered.
    > Cc: stable@vger.kernel.org
    > Cc: Masami Hiramatsu &lt;mhiramat@kernel.org&gt;
    > Cc: Mathieu Desnoyers &lt;mathieu.desnoyers@efficios.com&gt;
    > Link: https://lore.kernel.org/20241211135335.094ba282@batman.local.home
    > Fixes: 2c02f7375e65 (&quot;fgraph: Use CPU hotplug mechanism to initialize idle shadow stacks&quot;)
    > Reported-by: Linus Walleij &lt;linus.walleij@linaro.org&gt;
    > Tested-by: Linus Walleij &lt;linus.walleij@linaro.org&gt;
    > Closes: https://lore.kernel.org/all/CACRpkdaTBrHwRbbrphVy-&#x3D;SeDz6MSsXhTKypOtLrTQ+DgGAOcQ@mail.gmail.com/
    > Signed-off-by: Steven Rostedt (Google) &lt;rostedt@goodmis.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ Drivers: hv: util: Avoid accessing a ringbuffer not initialized yet (@Michael Kelley in [3dd7a30c6d7f90a](https://github.com/sophgo/linux-riscv/commit/3dd7a30c6d7f90a) at 2024-12-27 13:02:15)
    > commit 07a756a49f4b4290b49ea46e089cbe6f79ff8d26 upstream.
    > If the KVP (or VSS) daemon starts before the VMBus channel&#x27;s ringbuffer is
    > fully initialized, we can hit the panic below:
    > hv_utils: Registering HyperV Utility Driver
    > hv_vmbus: registering driver hv_utils
    > ...
    > BUG: kernel NULL pointer dereference, address: 0000000000000000
    > CPU: 44 UID: 0 PID: 2552 Comm: hv_kvp_daemon Tainted: G E 6.11.0-rc3+ #1
    > RIP: 0010:hv_pkt_iter_first+0x12/0xd0
    > Call Trace:
    > ...
    > vmbus_recvpacket
    > hv_kvp_onchannelcallback
    > vmbus_on_event
    > tasklet_action_common
    > tasklet_action
    > handle_softirqs
    > irq_exit_rcu
    > sysvec_hyperv_stimer0
    > &lt;/IRQ&gt;
    > &lt;TASK&gt;
    > asm_sysvec_hyperv_stimer0
    > ...
    > kvp_register_done
    > hvt_op_read
    > vfs_read
    > ksys_read
    > __x64_sys_read
    > This can happen because the KVP/VSS channel callback can be invoked
    > even before the channel is fully opened:
    > 1) as soon as hv_kvp_init() -&gt; hvutil_transport_init() creates
    > /dev/vmbus/hv_kvp, the kvp daemon can open the device file immediately and
    > register itself to the driver by writing a message KVP_OP_REGISTER1 to the
    > file (which is handled by kvp_on_msg() -&gt;kvp_handle_handshake()) and
    > reading the file for the driver&#x27;s response, which is handled by
    > hvt_op_read(), which calls hvt-&gt;on_read(), i.e. kvp_register_done().
    > 2) the problem with kvp_register_done() is that it can cause the
    > channel callback to be called even before the channel is fully opened,
    > and when the channel callback is starting to run, util_probe()-&gt;
    > vmbus_open() may have not initialized the ringbuffer yet, so the
    > callback can hit the panic of NULL pointer dereference.
    > To reproduce the panic consistently, we can add a &quot;ssleep(10)&quot; for KVP in
    > __vmbus_open(), just before the first hv_ringbuffer_init(), and then we
    > unload and reload the driver hv_utils, and run the daemon manually within
    > the 10 seconds.
    > Fix the panic by reordering the steps in util_probe() so the char dev
    > entry used by the KVP or VSS daemon is not created until after
    > vmbus_open() has completed. This reordering prevents the race condition
    > from happening.
    > Reported-by: Dexuan Cui &lt;decui@microsoft.com&gt;
    > Fixes: e0fa3e5e7df6 (&quot;Drivers: hv: utils: fix a race on userspace daemons registration&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Michael Kelley &lt;mhklinux@outlook.com&gt;
    > Acked-by: Wei Liu &lt;wei.liu@kernel.org&gt;
    > Link: https://lore.kernel.org/r/20241106154247.2271-3-mhklinux@outlook.com
    > Signed-off-by: Wei Liu &lt;wei.liu@kernel.org&gt;
    > Message-ID: &lt;20241106154247.2271-3-mhklinux@outlook.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ KVM: x86: Play nice with protected guests in complete_hypercall_exit() (@Sean Christopherson in [22b5c2acd65dbe9](https://github.com/sophgo/linux-riscv/commit/22b5c2acd65dbe9) at 2024-12-27 13:02:15)
    > commit 9b42d1e8e4fe9dc631162c04caa69b0d1860b0f0 upstream.
    > Use is_64_bit_hypercall() instead of is_64_bit_mode() to detect a 64-bit
    > hypercall when completing said hypercall.  For guests with protected state,
    > e.g. SEV-ES and SEV-SNP, KVM must assume the hypercall was made in 64-bit
    > mode as the vCPU state needed to detect 64-bit mode is unavailable.
    > Hacking the sev_smoke_test selftest to generate a KVM_HC_MAP_GPA_RANGE
    > hypercall via VMGEXIT trips the WARN:
    > ------------[ cut here ]------------
    > WARNING: CPU: 273 PID: 326626 at arch/x86/kvm/x86.h:180 complete_hypercall_exit+0x44/0xe0 [kvm]
    > Modules linked in: kvm_amd kvm ... [last unloaded: kvm]
    > CPU: 273 UID: 0 PID: 326626 Comm: sev_smoke_test Not tainted 6.12.0-smp--392e932fa0f3-feat #470
    > Hardware name: Google Astoria/astoria, BIOS 0.20240617.0-0 06/17/2024
    > RIP: 0010:complete_hypercall_exit+0x44/0xe0 [kvm]
    > Call Trace:
    > &lt;TASK&gt;
    > kvm_arch_vcpu_ioctl_run+0x2400/0x2720 [kvm]
    > kvm_vcpu_ioctl+0x54f/0x630 [kvm]
    > __se_sys_ioctl+0x6b/0xc0
    > do_syscall_64+0x83/0x160
    > entry_SYSCALL_64_after_hwframe+0x76/0x7e
    > &lt;/TASK&gt;
    > ---[ end trace 0000000000000000 ]---
    > Fixes: b5aead0064f3 (&quot;KVM: x86: Assume a 64-bit hypercall for guests with protected state&quot;)
    > Cc: stable@vger.kernel.org
    > Cc: Tom Lendacky &lt;thomas.lendacky@amd.com&gt;
    > Reviewed-by: Xiaoyao Li &lt;xiaoyao.li@intel.com&gt;
    > Reviewed-by: Nikunj A Dadhania &lt;nikunj@amd.com&gt;
    > Reviewed-by: Tom Lendacky &lt;thomas.lendacky@amd.com&gt;
    > Reviewed-by: Binbin Wu &lt;binbin.wu@linux.intel.com&gt;
    > Reviewed-by: Kai Huang &lt;kai.huang@intel.com&gt;
    > Link: https://lore.kernel.org/r/20241128004344.4072099-2-seanjc@google.com
    > Signed-off-by: Sean Christopherson &lt;seanjc@google.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ smb: client: fix TCP timers deadlock after rmmod (@Enzo Matsumiya in [127e907e11ccd54](https://github.com/sophgo/linux-riscv/commit/127e907e11ccd54) at 2024-12-27 13:02:15)
    > commit e9f2517a3e18a54a3943c098d2226b245d488801 upstream.
    > Commit ef7134c7fc48 (&quot;smb: client: Fix use-after-free of network namespace.&quot;)
    > fixed a netns UAF by manually enabled socket refcounting
    > (sk-&gt;sk_net_refcnt&#x3D;1 and sock_inuse_add(net, 1)).
    > The reason the patch worked for that bug was because we now hold
    > references to the netns (get_net_track() gets a ref internally)
    > and they&#x27;re properly released (internally, on __sk_destruct()),
    > but only because sk-&gt;sk_net_refcnt was set.
    > Problem:
    > (this happens regardless of CONFIG_NET_NS_REFCNT_TRACKER and regardless
    > if init_net or other)
    > Setting sk-&gt;sk_net_refcnt&#x3D;1 *manually* and *after* socket creation is not
    > only out of cifs scope, but also technically wrong -- it&#x27;s set conditionally
    > based on user (&#x3D;1) vs kernel (&#x3D;0) sockets.  And net/ implementations
    > seem to base their user vs kernel space operations on it.
    > e.g. upon TCP socket close, the TCP timers are not cleared because
    > sk-&gt;sk_net_refcnt&#x3D;1:
    > (cf. commit 151c9c724d05 (&quot;tcp: properly terminate timers for kernel sockets&quot;))
    > net/ipv4/tcp.c:
    > void tcp_close(struct sock *sk, long timeout)
    > {
    > lock_sock(sk);
    > __tcp_close(sk, timeout);
    > release_sock(sk);
    > if (!sk-&gt;sk_net_refcnt)
    > inet_csk_clear_xmit_timers_sync(sk);
    > sock_put(sk);
    > }
    > Which will throw a lockdep warning and then, as expected, deadlock on
    > tcp_write_timer().
    > A way to reproduce this is by running the reproducer from ef7134c7fc48
    > and then &#x27;rmmod cifs&#x27;.  A few seconds later, the deadlock/lockdep
    > warning shows up.
    > Fix:
    > We shouldn&#x27;t mess with socket internals ourselves, so do not set
    > sk_net_refcnt manually.
    > Also change __sock_create() to sock_create_kern() for explicitness.
    > As for non-init_net network namespaces, we deal with it the best way
    > we can -- hold an extra netns reference for server-&gt;ssocket and drop it
    > when it&#x27;s released.  This ensures that the netns still exists whenever
    > we need to create/destroy server-&gt;ssocket, but is not directly tied to
    > it.
    > Fixes: ef7134c7fc48 (&quot;smb: client: Fix use-after-free of network namespace.&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Enzo Matsumiya &lt;ematsumiya@suse.de&gt;
    > Signed-off-by: Steve French &lt;stfrench@microsoft.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ s390/mm: Fix DirectMap accounting (@Heiko Carstens in [f7d75bc2430fc73](https://github.com/sophgo/linux-riscv/commit/f7d75bc2430fc73) at 2024-12-27 13:02:14)
    > commit 41856638e6c4ed51d8aa9e54f70059d1e357b46e upstream.
    > With uncoupling of physical and virtual address spaces population of
    > the identity mapping was changed to use the type POPULATE_IDENTITY
    > instead of POPULATE_DIRECT. This breaks DirectMap accounting:
    > &gt; cat /proc/meminfo
    > DirectMap4k:       55296 kB
    > DirectMap1M:    18446744073709496320 kB
    > Adjust all locations of update_page_count() in vmem.c to use
    > POPULATE_IDENTITY instead of POPULATE_DIRECT as well. With this
    > accounting is correct again:
    > &gt; cat /proc/meminfo
    > DirectMap4k:       54264 kB
    > DirectMap1M:     8334336 kB
    > Fixes: c98d2ecae08f (&quot;s390/mm: Uncouple physical vs virtual address spaces&quot;)
    > Cc: stable@vger.kernel.org
    > Reviewed-by: Alexander Gordeev &lt;agordeev@linux.ibm.com&gt;
    > Signed-off-by: Heiko Carstens &lt;hca@linux.ibm.com&gt;
    > Signed-off-by: Alexander Gordeev &lt;agordeev@linux.ibm.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ btrfs: tree-checker: reject inline extent items with 0 ref count (@Qu Wenruo in [f16eadc6fce4db2](https://github.com/sophgo/linux-riscv/commit/f16eadc6fce4db2) at 2024-12-27 13:02:14)
    > commit dfb92681a19e1d5172420baa242806414b3eff6f upstream.
    > [BUG]
    > There is a bug report in the mailing list where btrfs_run_delayed_refs()
    > failed to drop the ref count for logical 25870311358464 num_bytes
    > 2113536.
    > The involved leaf dump looks like this:
    > item 166 key (25870311358464 168 2113536) itemoff 10091 itemsize 50
    > extent refs 1 gen 84178 flags 1
    > ref#0: shared data backref parent 32399126528000 count 0 &lt;&lt;&lt;
    > ref#1: shared data backref parent 31808973717504 count 1
    > Notice the count number is 0.
    > [CAUSE]
    > There is no concrete evidence yet, but considering 0 -&gt; 1 is also a
    > single bit flipped, it&#x27;s possible that hardware memory bitflip is
    > involved, causing the on-disk extent tree to be corrupted.
    > [FIX]
    > To prevent us reading such corrupted extent item, or writing such
    > damaged extent item back to disk, enhance the handling of
    > BTRFS_EXTENT_DATA_REF_KEY and BTRFS_SHARED_DATA_REF_KEY keys for both
    > inlined and key items, to detect such 0 ref count and reject them.
    > CC: stable@vger.kernel.org # 5.4+
    > Link: https://lore.kernel.org/linux-btrfs/7c69dd49-c346-4806-86e7-e6f863a66f48@app.fastmail.com/
    > Reported-by: Frankie Fisher &lt;frankie@terrorise.me.uk&gt;
    > Reviewed-by: Filipe Manana &lt;fdmanana@suse.com&gt;
    > Signed-off-by: Qu Wenruo &lt;wqu@suse.com&gt;
    > Reviewed-by: David Sterba &lt;dsterba@suse.com&gt;
    > Signed-off-by: David Sterba &lt;dsterba@suse.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ btrfs: fix improper generation check in snapshot delete (@Josef Bacik in [c85a41172efb293](https://github.com/sophgo/linux-riscv/commit/c85a41172efb293) at 2024-12-27 13:02:14)
    > commit d75d72a858f0c00ca8ae161b48cdb403807be4de upstream.
    > We have been using the following check
    > if (generation &lt;&#x3D; root-&gt;root_key.offset)
    > to make decisions about whether or not to visit a node during snapshot
    > delete.  This is because for normal subvolumes this is set to 0, and for
    > snapshots it&#x27;s set to the creation generation.  The idea being that if
    > the generation of the node is less than or equal to our creation
    > generation then we don&#x27;t need to visit that node, because it doesn&#x27;t
    > belong to us, we can simply drop our reference and move on.
    > However reloc roots don&#x27;t have their generation stored in
    > root-&gt;root_key.offset, instead that is the objectid of their
    > corresponding fs root.  This means we can incorrectly not walk into
    > nodes that need to be dropped when deleting a reloc root.
    > There are a variety of consequences to making the wrong choice in two
    > distinct areas.
    > visit_node_for_delete()
    > 1. False positive.  We think we are newer than the block when we really
    > aren&#x27;t.  We don&#x27;t visit the node and drop our reference to the node
    > and carry on.  This would result in leaked space.
    > 2. False negative.  We do decide to walk down into a block that we
    > should have just dropped our reference to.  However this means that
    > the child node will have refs &gt; 1, so we will switch to
    > UPDATE_BACKREF, and then the subsequent walk_down_proc() will notice
    > that btrfs_header_owner(node) !&#x3D; root-&gt;root_key.objectid and it&#x27;ll
    > break out of the loop, and then walk_up_proc() will drop our reference,
    > so this appears to be ok.
    > do_walk_down()
    > 1. False positive.  We are in UPDATE_BACKREF and incorrectly decide that
    > we are done and don&#x27;t need to update the backref for our lower nodes.
    > This is another case that simply won&#x27;t happen with relocation, as we
    > only have to do UPDATE_BACKREF if the node below us was shared and
    > didn&#x27;t have FULL_BACKREF set, and since we don&#x27;t own that node
    > because we&#x27;re a reloc root we actually won&#x27;t end up in this case.
    > 2. False negative.  Again this is tricky because as described above, we
    > simply wouldn&#x27;t be here from relocation, because we don&#x27;t own any of
    > the nodes because we never set btrfs_header_owner() to the reloc root
    > objectid, and we always use FULL_BACKREF, we never actually need to
    > set FULL_BACKREF on any children.
    > Having spent a lot of time stressing relocation/snapshot delete recently
    > I&#x27;ve not seen this pop in practice.  But this is objectively incorrect,
    > so fix this to get the correct starting generation based on the root
    > we&#x27;re dropping to keep me from thinking there&#x27;s a problem here.
    > CC: stable@vger.kernel.org
    > Reviewed-by: Filipe Manana &lt;fdmanana@suse.com&gt;
    > Signed-off-by: Josef Bacik &lt;josef@toxicpanda.com&gt;
    > Signed-off-by: David Sterba &lt;dsterba@suse.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ drm/amdgpu/gfx12: fix IP version check (@Alex Deucher in [b2f23a1c7181f8c](https://github.com/sophgo/linux-riscv/commit/b2f23a1c7181f8c) at 2024-12-27 13:02:14)
    > commit 41be00f839e9ee7753892a73a36ce4c14c6f5cbf upstream.
    > Use the helper function rather than reading it directly.
    > Reviewed-by: Yang Wang &lt;kevinyang.wang@amd.com&gt;
    > Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > (cherry picked from commit f1fd1d0f40272948aa6ab82a3a82ecbbc76dff53)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ drm/amdgpu/nbio7.0: fix IP version check (@Alex Deucher in [5c923087adc7a5c](https://github.com/sophgo/linux-riscv/commit/5c923087adc7a5c) at 2024-12-27 13:02:14)
    > commit 3abb660f9e18925468685591a3702bda05faba4f upstream.
    > Use the helper function rather than reading it directly.
    > Reviewed-by: Yang Wang &lt;kevinyang.wang@amd.com&gt;
    > Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > (cherry picked from commit 0ec43fbece784215d3c4469973e4556d70bce915)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ btrfs: split bios to the fs sector size boundary (@Christoph Hellwig in [39f1ef13d8daf85](https://github.com/sophgo/linux-riscv/commit/39f1ef13d8daf85) at 2024-12-27 13:02:14)
    > commit be691b5e593f2cc8cef67bbc59c1fb91b74a86a9 upstream.
    > Btrfs like other file systems can&#x27;t really deal with I/O not aligned to
    > it&#x27;s internal block size (which strangely is called sector size in
    > btrfs, for historical reasons), but the block layer split helper doesn&#x27;t
    > even know about that.
    > Round down the split boundary so that all I/Os are aligned.
    > Fixes: d5e4377d5051 (&quot;btrfs: split zone append bios in btrfs_submit_bio&quot;)
    > CC: stable@vger.kernel.org # 6.12
    > Reviewed-by: Johannes Thumshirn &lt;johannes.thumshirn@wdc.com&gt;
    > Signed-off-by: Christoph Hellwig &lt;hch@lst.de&gt;
    > Reviewed-by: Damien Le Moal &lt;dlemoal@kernel.org&gt;
    > Reviewed-by: David Sterba &lt;dsterba@suse.com&gt;
    > Signed-off-by: David Sterba &lt;dsterba@suse.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ drm/amdgpu/mmhub4.1: fix IP version check (@Alex Deucher in [01b888b31b52967](https://github.com/sophgo/linux-riscv/commit/01b888b31b52967) at 2024-12-27 13:02:14)
    > commit 6ebc5b92190e01dd48313b68cbf752c9adcfefa8 upstream.
    > Use the helper function rather than reading it directly.
    > Reviewed-by: Yang Wang &lt;kevinyang.wang@amd.com&gt;
    > Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > (cherry picked from commit 63bfd24088b42c6f55c2096bfc41b50213d419b2)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ ring-buffer: Fix overflow in __rb_map_vma (@Edward Adam Davis in [ec12f30fe54234d](https://github.com/sophgo/linux-riscv/commit/ec12f30fe54234d) at 2024-12-27 13:02:13)
    > commit c58a812c8e49ad688f94f4b050ad5c5b388fc5d2 upstream.
    > An overflow occurred when performing the following calculation:
    > nr_pages &#x3D; ((nr_subbufs + 1) &lt;&lt; subbuf_order) - pgoff;
    > Add a check before the calculation to avoid this problem.
    > syzbot reported this as a slab-out-of-bounds in __rb_map_vma:
    > BUG: KASAN: slab-out-of-bounds in __rb_map_vma+0x9ab/0xae0 kernel/trace/ring_buffer.c:7058
    > Read of size 8 at addr ffff8880767dd2b8 by task syz-executor187/5836
    > CPU: 0 UID: 0 PID: 5836 Comm: syz-executor187 Not tainted 6.13.0-rc2-syzkaller-00159-gf932fb9b4074 #0
    > Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 11/25/2024
    > Call Trace:
    > &lt;TASK&gt;
    > __dump_stack lib/dump_stack.c:94 [inline]
    > dump_stack_lvl+0x116/0x1f0 lib/dump_stack.c:120
    > print_address_description mm/kasan/report.c:378 [inline]
    > print_report+0xc3/0x620 mm/kasan/report.c:489
    > kasan_report+0xd9/0x110 mm/kasan/report.c:602
    > __rb_map_vma+0x9ab/0xae0 kernel/trace/ring_buffer.c:7058
    > ring_buffer_map+0x56e/0x9b0 kernel/trace/ring_buffer.c:7138
    > tracing_buffers_mmap+0xa6/0x120 kernel/trace/trace.c:8482
    > call_mmap include/linux/fs.h:2183 [inline]
    > mmap_file mm/internal.h:124 [inline]
    > __mmap_new_file_vma mm/vma.c:2291 [inline]
    > __mmap_new_vma mm/vma.c:2355 [inline]
    > __mmap_region+0x1786/0x2670 mm/vma.c:2456
    > mmap_region+0x127/0x320 mm/mmap.c:1348
    > do_mmap+0xc00/0xfc0 mm/mmap.c:496
    > vm_mmap_pgoff+0x1ba/0x360 mm/util.c:580
    > ksys_mmap_pgoff+0x32c/0x5c0 mm/mmap.c:542
    > __do_sys_mmap arch/x86/kernel/sys_x86_64.c:89 [inline]
    > __se_sys_mmap arch/x86/kernel/sys_x86_64.c:82 [inline]
    > __x64_sys_mmap+0x125/0x190 arch/x86/kernel/sys_x86_64.c:82
    > do_syscall_x64 arch/x86/entry/common.c:52 [inline]
    > do_syscall_64+0xcd/0x250 arch/x86/entry/common.c:83
    > entry_SYSCALL_64_after_hwframe+0x77/0x7f
    > The reproducer for this bug is:
    > ------------------------8&lt;-------------------------
    > #include &lt;fcntl.h&gt;
    > #include &lt;stdlib.h&gt;
    > #include &lt;unistd.h&gt;
    > #include &lt;asm/types.h&gt;
    > #include &lt;sys/mman.h&gt;
    > int main(int argc, char **argv)
    > {
    > int page_size &#x3D; getpagesize();
    > int fd;
    > void *meta;
    > system(&quot;echo 1 &gt; /sys/kernel/tracing/buffer_size_kb&quot;);
    > fd &#x3D; open(&quot;/sys/kernel/tracing/per_cpu/cpu0/trace_pipe_raw&quot;, O_RDONLY);
    > meta &#x3D; mmap(NULL, page_size, PROT_READ, MAP_SHARED, fd, page_size * 5);
    > }
    > ------------------------&gt;8-------------------------
    > Cc: stable@vger.kernel.org
    > Fixes: 117c39200d9d7 (&quot;ring-buffer: Introducing ring-buffer mapping functions&quot;)
    > Link: https://lore.kernel.org/tencent_06924B6674ED771167C23CC336C097223609@qq.com
    > Reported-by: syzbot+345e4443a21200874b18@syzkaller.appspotmail.com
    > Closes: https://syzkaller.appspot.com/bug?extid&#x3D;345e4443a21200874b18
    > Signed-off-by: Edward Adam Davis &lt;eadavis@qq.com&gt;
    > Signed-off-by: Steven Rostedt (Google) &lt;rostedt@goodmis.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ vmalloc: fix accounting with i915 (@Matthew Wilcox (Oracle) in [ad7c9f1f4322ba9](https://github.com/sophgo/linux-riscv/commit/ad7c9f1f4322ba9) at 2024-12-27 13:02:13)
    > commit a2e740e216f5bf49ccb83b6d490c72a340558a43 upstream.
    > If the caller of vmap() specifies VM_MAP_PUT_PAGES (currently only the
    > i915 driver), we will decrement nr_vmalloc_pages and MEMCG_VMALLOC in
    > vfree().  These counters are incremented by vmalloc() but not by vmap() so
    > this will cause an underflow.  Check the VM_MAP_PUT_PAGES flag before
    > decrementing either counter.
    > Link: https://lkml.kernel.org/r/20241211202538.168311-1-willy@infradead.org
    > Fixes: b944afc9d64d (&quot;mm: add a VM_MAP_PUT_PAGES flag for vmap&quot;)
    > Signed-off-by: Matthew Wilcox (Oracle) &lt;willy@infradead.org&gt;
    > Acked-by: Johannes Weiner &lt;hannes@cmpxchg.org&gt;
    > Reviewed-by: Shakeel Butt &lt;shakeel.butt@linux.dev&gt;
    > Reviewed-by: Balbir Singh &lt;balbirs@nvidia.com&gt;
    > Acked-by: Michal Hocko &lt;mhocko@suse.com&gt;
    > Cc: Christoph Hellwig &lt;hch@lst.de&gt;
    > Cc: Muchun Song &lt;muchun.song@linux.dev&gt;
    > Cc: Roman Gushchin &lt;roman.gushchin@linux.dev&gt;
    > Cc: &quot;Uladzislau Rezki (Sony)&quot; &lt;urezki@gmail.com&gt;
    > Cc: &lt;stable@vger.kernel.org&gt;
    > Signed-off-by: Andrew Morton &lt;akpm@linux-foundation.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ alloc_tag: fix set_codetag_empty() when !CONFIG_MEM_ALLOC_PROFILING_DEBUG (@Suren Baghdasaryan in [9667c9146418aa8](https://github.com/sophgo/linux-riscv/commit/9667c9146418aa8) at 2024-12-27 13:02:13)
    > commit 60da7445a142bd15e67f3cda915497781c3f781f upstream.
    > It was recently noticed that set_codetag_empty() might be used not only to
    > mark NULL alloctag references as empty to avoid warnings but also to reset
    > valid tags (in clear_page_tag_ref()).  Since set_codetag_empty() is
    > defined as NOOP for CONFIG_MEM_ALLOC_PROFILING_DEBUG&#x3D;n, such use of
    > set_codetag_empty() leads to subtle bugs.  Fix set_codetag_empty() for
    > CONFIG_MEM_ALLOC_PROFILING_DEBUG&#x3D;n to reset the tag reference.
    > Link: https://lkml.kernel.org/r/20241130001423.1114965-2-surenb@google.com
    > Fixes: a8fc28dad6d5 (&quot;alloc_tag: introduce clear_page_tag_ref() helper function&quot;)
    > Signed-off-by: Suren Baghdasaryan &lt;surenb@google.com&gt;
    > Reported-by: David Wang &lt;00107082@163.com&gt;
    > Closes: https://lore.kernel.org/lkml/20241124074318.399027-1-00107082@163.com/
    > Cc: David Wang &lt;00107082@163.com&gt;
    > Cc: Kent Overstreet &lt;kent.overstreet@linux.dev&gt;
    > Cc: Mike Rapoport (Microsoft) &lt;rppt@kernel.org&gt;
    > Cc: Pasha Tatashin &lt;pasha.tatashin@soleen.com&gt;
    > Cc: Sourav Panda &lt;souravpanda@google.com&gt;
    > Cc: Yu Zhao &lt;yuzhao@google.com&gt;
    > Cc: &lt;stable@vger.kernel.org&gt;
    > Signed-off-by: Andrew Morton &lt;akpm@linux-foundation.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ zram: fix uninitialized ZRAM not releasing backing device (@Kairui Song in [6fb92e9a52e3fea](https://github.com/sophgo/linux-riscv/commit/6fb92e9a52e3fea) at 2024-12-27 13:02:13)
    > commit 74363ec674cb172d8856de25776c8f3103f05e2f upstream.
    > Setting backing device is done before ZRAM initialization.  If we set the
    > backing device, then remove the ZRAM module without initializing the
    > device, the backing device reference will be leaked and the device will be
    > hold forever.
    > Fix this by always reset the ZRAM fully on rmmod or reset store.
    > Link: https://lkml.kernel.org/r/20241209165717.94215-3-ryncsn@gmail.com
    > Fixes: 013bf95a83ec (&quot;zram: add interface to specif backing device&quot;)
    > Signed-off-by: Kairui Song &lt;kasong@tencent.com&gt;
    > Reported-by: Desheng Wu &lt;deshengwu@tencent.com&gt;
    > Suggested-by: Sergey Senozhatsky &lt;senozhatsky@chromium.org&gt;
    > Reviewed-by: Sergey Senozhatsky &lt;senozhatsky@chromium.org&gt;
    > Cc: &lt;stable@vger.kernel.org&gt;
    > Signed-off-by: Andrew Morton &lt;akpm@linux-foundation.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ zram: refuse to use zero sized block device as backing device (@Kairui Song in [6d91e90cfc34409](https://github.com/sophgo/linux-riscv/commit/6d91e90cfc34409) at 2024-12-27 13:02:13)
    > commit be48c412f6ebf38849213c19547bc6d5b692b5e5 upstream.
    > Patch series &quot;zram: fix backing device setup issue&quot;, v2.
    > This series fixes two bugs of backing device setting:
    > - ZRAM should reject using a zero sized (or the uninitialized ZRAM
    > device itself) as the backing device.
    > - Fix backing device leaking when removing a uninitialized ZRAM
    > device.
    > This patch (of 2):
    > Setting a zero sized block device as backing device is pointless, and one
    > can easily create a recursive loop by setting the uninitialized ZRAM
    > device itself as its own backing device by (zram0 is uninitialized):
    > echo /dev/zram0 &gt; /sys/block/zram0/backing_dev
    > It&#x27;s definitely a wrong config, and the module will pin itself, kernel
    > should refuse doing so in the first place.
    > By refusing to use zero sized device we avoided misuse cases including
    > this one above.
    > Link: https://lkml.kernel.org/r/20241209165717.94215-1-ryncsn@gmail.com
    > Link: https://lkml.kernel.org/r/20241209165717.94215-2-ryncsn@gmail.com
    > Fixes: 013bf95a83ec (&quot;zram: add interface to specif backing device&quot;)
    > Signed-off-by: Kairui Song &lt;kasong@tencent.com&gt;
    > Reported-by: Desheng Wu &lt;deshengwu@tencent.com&gt;
    > Reviewed-by: Sergey Senozhatsky &lt;senozhatsky@chromium.org&gt;
    > Cc: &lt;stable@vger.kernel.org&gt;
    > Signed-off-by: Andrew Morton &lt;akpm@linux-foundation.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ mm/page_alloc: don&#x27;t call pfn_to_page() on possibly non-existent PFN in split_large_buddy() (@David Hildenbrand in [4234ca9884bcae9](https://github.com/sophgo/linux-riscv/commit/4234ca9884bcae9) at 2024-12-27 13:02:13)
    > commit faeec8e23c10bd30e8aa759a2eb3018dae00f924 upstream.
    > In split_large_buddy(), we might call pfn_to_page() on a PFN that might
    > not exist.  In corner cases, such as when freeing the highest pageblock in
    > the last memory section, this could result with CONFIG_SPARSEMEM &amp;&amp;
    > !CONFIG_SPARSEMEM_EXTREME in __pfn_to_section() returning NULL and and
    > __section_mem_map_addr() dereferencing that NULL pointer.
    > Let&#x27;s fix it, and avoid doing a pfn_to_page() call for the first
    > iteration, where we already have the page.
    > So far this was found by code inspection, but let&#x27;s just CC stable as the
    > fix is easy.
    > Link: https://lkml.kernel.org/r/20241210093437.174413-1-david@redhat.com
    > Fixes: fd919a85cd55 (&quot;mm: page_isolation: prepare for hygienic freelists&quot;)
    > Signed-off-by: David Hildenbrand &lt;david@redhat.com&gt;
    > Reported-by: Vlastimil Babka &lt;vbabka@suse.cz&gt;
    > Closes: https://lkml.kernel.org/r/e1a898ba-a717-4d20-9144-29df1a6c8813@suse.cz
    > Reviewed-by: Vlastimil Babka &lt;vbabka@suse.cz&gt;
    > Reviewed-by: Zi Yan &lt;ziy@nvidia.com&gt;
    > Acked-by: Johannes Weiner &lt;hannes@cmpxchg.org&gt;
    > Cc: Yu Zhao &lt;yuzhao@google.com&gt;
    > Cc: &lt;stable@vger.kernel.org&gt;
    > Signed-off-by: Andrew Morton &lt;akpm@linux-foundation.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ drm/amdgpu/nbio7.7: fix IP version check (@Alex Deucher in [ea72b2f21f74b2d](https://github.com/sophgo/linux-riscv/commit/ea72b2f21f74b2d) at 2024-12-27 13:02:12)
    > commit 458600da793da12e0f3724ecbea34a80703f4d5b upstream.
    > Use the helper function rather than reading it directly.
    > Reviewed-by: Yang Wang &lt;kevinyang.wang@amd.com&gt;
    > Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > (cherry picked from commit 22b9555bc90df22b585bdd1f161b61584b13af51)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ drm/amdgpu/nbio7.11: fix IP version check (@Alex Deucher in [d887a3b08ad9d7c](https://github.com/sophgo/linux-riscv/commit/d887a3b08ad9d7c) at 2024-12-27 13:02:12)
    > commit 8c1ecc7197a88c6ae62de56e1c0887f220712a32 upstream.
    > Use the helper function rather than reading it directly.
    > Reviewed-by: Yang Wang &lt;kevinyang.wang@amd.com&gt;
    > Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > (cherry picked from commit 2c8eeaaa0fe5841ccf07a0eb51b1426f34ef39f7)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ drm/amdgpu/smu14.0.2: fix IP version check (@Alex Deucher in [cbe4eef73d0e244](https://github.com/sophgo/linux-riscv/commit/cbe4eef73d0e244) at 2024-12-27 13:02:12)
    > commit 9e752ee26c1031312a01d2afc281f5f6fdfca176 upstream.
    > Use the helper function rather than reading it directly.
    > Reviewed-by: Yang Wang &lt;kevinyang.wang@amd.com&gt;
    > Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > (cherry picked from commit 8f2cd1067afe68372a1723e05e19b68ed187676a)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ block: avoid to reuse &#x60;hctx&#x60; not removed from cpuhp callback list (@Ming Lei in [b5792c162dcf619](https://github.com/sophgo/linux-riscv/commit/b5792c162dcf619) at 2024-12-27 13:02:12)
    > [ Upstream commit 85672ca9ceeaa1dcf2777a7048af5f4aee3fd02b ]
    > If the &#x27;hctx&#x27; isn&#x27;t removed from cpuhp callback list, we can&#x27;t reuse it,
    > otherwise use-after-free may be triggered.
    > Reported-by: kernel test robot &lt;oliver.sang@intel.com&gt;
    > Closes: https://lore.kernel.org/oe-lkp/202412172217.b906db7c-lkp@intel.com
    > Tested-by: kernel test robot &lt;oliver.sang@intel.com&gt;
    > Fixes: 22465bbac53c (&quot;blk-mq: move cpuhp callback registering out of q-&gt;sysfs_lock&quot;)
    > Signed-off-by: Ming Lei &lt;ming.lei@redhat.com&gt;
    > Link: https://lore.kernel.org/r/20241218101617.3275704-3-ming.lei@redhat.com
    > Signed-off-by: Jens Axboe &lt;axboe@kernel.dk&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ hwmon: (tmp513) Fix Current Register value interpretation (@Murad Masimov in [62721d74829ebc0](https://github.com/sophgo/linux-riscv/commit/62721d74829ebc0) at 2024-12-27 13:02:12)
    > [ Upstream commit da1d0e6ba211baf6747db74c07700caddfd8a179 ]
    > The value returned by the driver after processing the contents of the
    > Current Register does not correspond to the TMP512/TMP513 specifications.
    > A raw register value is converted to a signed integer value by a sign
    > extension in accordance with the algorithm provided in the specification,
    > but due to the off-by-one error in the sign bit index, the result is
    > incorrect. Moreover, negative values will be reported as large positive
    > due to missing sign extension from u32 to long.
    > According to the TMP512 and TMP513 datasheets, the Current Register (07h)
    > is a 16-bit two&#x27;s complement integer value. E.g., if regval &#x3D; 1000 0011
    > 0000 0000, then the value must be (-32000 * lsb), but the driver will
    > return (33536 * lsb).
    > Fix off-by-one bug, and also cast data-&gt;curr_lsb_ua (which is of type u32)
    > to long to prevent incorrect cast for negative values.
    > Found by Linux Verification Center (linuxtesting.org) with SVACE.
    > Fixes: 59dfa75e5d82 (&quot;hwmon: Add driver for Texas Instruments TMP512/513 sensor chips.&quot;)
    > Signed-off-by: Murad Masimov &lt;m.masimov@maxima.ru&gt;
    > Link: https://lore.kernel.org/r/20241216173648.526-3-m.masimov@maxima.ru
    > [groeck: Fixed description line length]
    > Signed-off-by: Guenter Roeck &lt;linux@roeck-us.net&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ trace/ring-buffer: Do not use TP_printk() formatting for boot mapped buffers (@Steven Rostedt in [1828714c091bf04](https://github.com/sophgo/linux-riscv/commit/1828714c091bf04) at 2024-12-27 13:02:12)
    > commit 8cd63406d08110c8098e1efda8aef7ddab4db348 upstream.
    > The TP_printk() of a TRACE_EVENT() is a generic printf format that any
    > developer can create for their event. It may include pointers to strings
    > and such. A boot mapped buffer may contain data from a previous kernel
    > where the strings addresses are different.
    > One solution is to copy the event content and update the pointers by the
    > recorded delta, but a simpler solution (for now) is to just use the
    > print_fields() function to print these events. The print_fields() function
    > just iterates the fields and prints them according to what type they are,
    > and ignores the TP_printk() format from the event itself.
    > To understand the difference, when printing via TP_printk() the output
    > looks like this:
    > 4582.696626: kmem_cache_alloc: call_site&#x3D;getname_flags+0x47/0x1f0 ptr&#x3D;00000000e70e10e0 bytes_req&#x3D;4096 bytes_alloc&#x3D;4096 gfp_flags&#x3D;GFP_KERNEL node&#x3D;-1 accounted&#x3D;false
    > 4582.696629: kmem_cache_alloc: call_site&#x3D;alloc_empty_file+0x6b/0x110 ptr&#x3D;0000000095808002 bytes_req&#x3D;360 bytes_alloc&#x3D;384 gfp_flags&#x3D;GFP_KERNEL node&#x3D;-1 accounted&#x3D;false
    > 4582.696630: kmem_cache_alloc: call_site&#x3D;security_file_alloc+0x24/0x100 ptr&#x3D;00000000576339c3 bytes_req&#x3D;16 bytes_alloc&#x3D;16 gfp_flags&#x3D;GFP_KERNEL|__GFP_ZERO node&#x3D;-1 accounted&#x3D;false
    > 4582.696653: kmem_cache_free: call_site&#x3D;do_sys_openat2+0xa7/0xd0 ptr&#x3D;00000000e70e10e0 name&#x3D;names_cache
    > But when printing via print_fields() (echo 1 &gt; /sys/kernel/tracing/options/fields)
    > the same event output looks like this:
    > 4582.696626: kmem_cache_alloc: call_site&#x3D;0xffffffff92d10d97 (-1831793257) ptr&#x3D;0xffff9e0e8571e000 (-107689771147264) bytes_req&#x3D;0x1000 (4096) bytes_alloc&#x3D;0x1000 (4096) gfp_flags&#x3D;0xcc0 (3264) node&#x3D;0xffffffff (-1) accounted&#x3D;(0)
    > 4582.696629: kmem_cache_alloc: call_site&#x3D;0xffffffff92d0250b (-1831852789) ptr&#x3D;0xffff9e0e8577f800 (-107689770747904) bytes_req&#x3D;0x168 (360) bytes_alloc&#x3D;0x180 (384) gfp_flags&#x3D;0xcc0 (3264) node&#x3D;0xffffffff (-1) accounted&#x3D;(0)
    > 4582.696630: kmem_cache_alloc: call_site&#x3D;0xffffffff92efca74 (-1829778828) ptr&#x3D;0xffff9e0e8d35d3b0 (-107689640864848) bytes_req&#x3D;0x10 (16) bytes_alloc&#x3D;0x10 (16) gfp_flags&#x3D;0xdc0 (3520) node&#x3D;0xffffffff (-1) accounted&#x3D;(0)
    > 4582.696653: kmem_cache_free: call_site&#x3D;0xffffffff92cfbea7 (-1831879001) ptr&#x3D;0xffff9e0e8571e000 (-107689771147264) name&#x3D;names_cache
    > Cc: stable@vger.kernel.org
    > Cc: Masami Hiramatsu &lt;mhiramat@kernel.org&gt;
    > Cc: Mathieu Desnoyers &lt;mathieu.desnoyers@efficios.com&gt;
    > Cc: Linus Torvalds &lt;torvalds@linux-foundation.org&gt;
    > Link: https://lore.kernel.org/20241218141507.28389a1d@gandalf.local.home
    > Fixes: 07714b4bb3f98 (&quot;tracing: Handle old buffer mappings for event strings and functions&quot;)
    > Signed-off-by: Steven Rostedt (Google) &lt;rostedt@goodmis.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ hwmon: (tmp513) Fix interpretation of values of Temperature Result and Limit Registers (@Murad Masimov in [0f289ba4e5ae2ff](https://github.com/sophgo/linux-riscv/commit/0f289ba4e5ae2ff) at 2024-12-27 13:02:12)
    > [ Upstream commit dd471e25770e7e632f736b90db1e2080b2171668 ]
    > The values returned by the driver after processing the contents of the
    > Temperature Result and the Temperature Limit Registers do not correspond to
    > the TMP512/TMP513 specifications. A raw register value is converted to a
    > signed integer value by a sign extension in accordance with the algorithm
    > provided in the specification, but due to the off-by-one error in the sign
    > bit index, the result is incorrect.
    > According to the TMP512 and TMP513 datasheets, the Temperature Result (08h
    > to 0Bh) and Limit (11h to 14h) Registers are 13-bit two&#x27;s complement
    > integer values, shifted left by 3 bits. The value is scaled by 0.0625
    > degrees Celsius per bit.  E.g., if regval &#x3D; 1 1110 0111 0000 000, the
    > output should be -25 degrees, but the driver will return +487 degrees.
    > Found by Linux Verification Center (linuxtesting.org) with SVACE.
    > Fixes: 59dfa75e5d82 (&quot;hwmon: Add driver for Texas Instruments TMP512/513 sensor chips.&quot;)
    > Signed-off-by: Murad Masimov &lt;m.masimov@maxima.ru&gt;
    > Link: https://lore.kernel.org/r/20241216173648.526-4-m.masimov@maxima.ru
    > [groeck: fixed description line length]
    > Signed-off-by: Guenter Roeck &lt;linux@roeck-us.net&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ i915/guc: Reset engine utilization buffer before registration (@Umesh Nerlige Ramappa in [7779088287dcec4](https://github.com/sophgo/linux-riscv/commit/7779088287dcec4) at 2024-12-27 13:02:11)
    > [ Upstream commit abcc2ddae5f82aa6cfca162e3db643dd33f0a2e8 ]
    > On GT reset, we store total busyness counts for all engines and
    > re-register the utilization buffer with GuC. At that time we should
    > reset the buffer, so that we don&#x27;t get spurious busyness counts on
    > subsequent queries.
    > To repro this issue, run igt@perf_pmu@busy-hang followed by
    > igt@perf_pmu@most-busy-idle-check-all for a couple iterations.
    > Fixes: 77cdd054dd2c (&quot;drm/i915/pmu: Connect engine busyness stats from GuC to pmu&quot;)
    > Signed-off-by: Umesh Nerlige Ramappa &lt;umesh.nerlige.ramappa@intel.com&gt;
    > Reviewed-by: John Harrison &lt;John.C.Harrison@Intel.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20241127174006.190128-2-umesh.nerlige.ramappa@intel.com
    > (cherry picked from commit abd318237fa6556c1e5225529af145ef15d5ff0d)
    > Signed-off-by: Tvrtko Ursulin &lt;tursulin@ursulin.net&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/amdgpu: don&#x27;t access invalid sched (@Pierre-Eric Pelloux-Prayer in [67291d601f2b032](https://github.com/sophgo/linux-riscv/commit/67291d601f2b032) at 2024-12-27 13:02:11)
    > [ Upstream commit a93b1020eb9386d7da11608477121b10079c076a ]
    > Since 2320c9e6a768 (&quot;drm/sched: memset() &#x27;job&#x27; in drm_sched_job_init()&quot;)
    > accessing job-&gt;base.sched can produce unexpected results as the initialisation
    > of (*job)-&gt;base.sched done in amdgpu_job_alloc is overwritten by the
    > memset.
    > This commit fixes an issue when a CS would fail validation and would
    > be rejected after job-&gt;num_ibs is incremented. In this case,
    > amdgpu_ib_free(ring-&gt;adev, ...) will be called, which would crash the
    > machine because the ring value is bogus.
    > To fix this, pass a NULL pointer to amdgpu_ib_free(): we can do this
    > because the device is actually not used in this function.
    > The next commit will remove the ring argument completely.
    > Fixes: 2320c9e6a768 (&quot;drm/sched: memset() &#x27;job&#x27; in drm_sched_job_init()&quot;)
    > Signed-off-by: Pierre-Eric Pelloux-Prayer &lt;pierre-eric.pelloux-prayer@amd.com&gt;
    > Reviewed-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Reviewed-by: Christian König &lt;christian.koenig@amd.com&gt;
    > Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > (cherry picked from commit 2ae520cb12831d264ceb97c61f72c59d33c0dbd7)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ i915/guc: Accumulate active runtime on gt reset (@Umesh Nerlige Ramappa in [5d6f446eca40d5e](https://github.com/sophgo/linux-riscv/commit/5d6f446eca40d5e) at 2024-12-27 13:02:11)
    > [ Upstream commit 1622ed27d26ab4c234476be746aa55bcd39159dd ]
    > On gt reset, if a context is running, then accumulate it&#x27;s active time
    > into the busyness counter since there will be no chance for the context
    > to switch out and update it&#x27;s run time.
    > v2: Move comment right above the if (John)
    > Fixes: 77cdd054dd2c (&quot;drm/i915/pmu: Connect engine busyness stats from GuC to pmu&quot;)
    > Signed-off-by: Umesh Nerlige Ramappa &lt;umesh.nerlige.ramappa@intel.com&gt;
    > Reviewed-by: John Harrison &lt;John.C.Harrison@Intel.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20241127174006.190128-4-umesh.nerlige.ramappa@intel.com
    > (cherry picked from commit 7ed047da59cfa1acb558b95169d347acc8d85da1)
    > Signed-off-by: Tvrtko Ursulin &lt;tursulin@ursulin.net&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ i915/guc: Ensure busyness counter increases motonically (@Umesh Nerlige Ramappa in [4f02f0866342919](https://github.com/sophgo/linux-riscv/commit/4f02f0866342919) at 2024-12-27 13:02:11)
    > [ Upstream commit 59a0b46788d58fdcee8d2f6b4e619d264a1799bf ]
    > Active busyness of an engine is calculated using gt timestamp and the
    > context switch in time. While capturing the gt timestamp, it&#x27;s possible
    > that the context switches out. This race could result in an active
    > busyness value that is greater than the actual context runtime value by a
    > small amount. This leads to a negative delta and throws off busyness
    > calculations for the user.
    > If a subsequent count is smaller than the previous one, just return the
    > previous one, since we expect the busyness to catch up.
    > Fixes: 77cdd054dd2c (&quot;drm/i915/pmu: Connect engine busyness stats from GuC to pmu&quot;)
    > Signed-off-by: Umesh Nerlige Ramappa &lt;umesh.nerlige.ramappa@intel.com&gt;
    > Reviewed-by: John Harrison &lt;John.C.Harrison@Intel.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20241127174006.190128-3-umesh.nerlige.ramappa@intel.com
    > (cherry picked from commit cf907f6d294217985e9dafd9985dce874e04ca37)
    > Signed-off-by: Tvrtko Ursulin &lt;tursulin@ursulin.net&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ hwmon: (tmp513) Fix interpretation of values of Shunt Voltage and Limit Registers (@Murad Masimov in [2a4a917cbab83ca](https://github.com/sophgo/linux-riscv/commit/2a4a917cbab83ca) at 2024-12-27 13:02:11)
    > [ Upstream commit 74d7e038fd072635d21e4734e3223378e09168d3 ]
    > The values returned by the driver after processing the contents of the
    > Shunt Voltage Register and the Shunt Limit Registers do not correspond to
    > the TMP512/TMP513 specifications. A raw register value is converted to a
    > signed integer value by a sign extension in accordance with the algorithm
    > provided in the specification, but due to the off-by-one error in the sign
    > bit index, the result is incorrect. Moreover, the PGA shift calculated with
    > the tmp51x_get_pga_shift function is relevant only to the Shunt Voltage
    > Register, but is also applied to the Shunt Limit Registers.
    > According to the TMP512 and TMP513 datasheets, the Shunt Voltage Register
    > (04h) is 13 to 16 bit two&#x27;s complement integer value, depending on the PGA
    > setting.  The Shunt Positive (0Ch) and Negative (0Dh) Limit Registers are
    > 16-bit two&#x27;s complement integer values. Below are some examples:
    > Shunt Voltage Register
    > If PGA &#x3D; 8, and regval &#x3D; 1000 0011 0000 0000, then the decimal value must
    > be -32000, but the value calculated by the driver will be 33536.
    > Shunt Limit Register
    > If regval &#x3D; 1000 0011 0000 0000, then the decimal value must be -32000, but
    > the value calculated by the driver will be 768, if PGA &#x3D; 1.
    > Fix sign bit index, and also correct misleading comment describing the
    > tmp51x_get_pga_shift function.
    > Found by Linux Verification Center (linuxtesting.org) with SVACE.
    > Fixes: 59dfa75e5d82 (&quot;hwmon: Add driver for Texas Instruments TMP512/513 sensor chips.&quot;)
    > Signed-off-by: Murad Masimov &lt;m.masimov@maxima.ru&gt;
    > Link: https://lore.kernel.org/r/20241216173648.526-2-m.masimov@maxima.ru
    > [groeck: Fixed description and multi-line alignments]
    > Signed-off-by: Guenter Roeck &lt;linux@roeck-us.net&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/panel: synaptics-r63353: Fix regulator unbalance (@Michael Trimarchi in [17a915416b1fe28](https://github.com/sophgo/linux-riscv/commit/17a915416b1fe28) at 2024-12-27 13:02:11)
    > [ Upstream commit d2bd3fcb825725a59c8880070b1206b1710922bd ]
    > The shutdown function can be called when the display is already
    > unprepared. For example during reboot this trigger a kernel
    > backlog. Calling the drm_panel_unprepare, allow us to avoid
    > to trigger the kernel warning.
    > Fixes: 2e87bad7cd33 (&quot;drm/panel: Add Synaptics R63353 panel driver&quot;)
    > Tested-by: Dario Binacchi &lt;dario.binacchi@amarulasolutions.com&gt;
    > Signed-off-by: Michael Trimarchi &lt;michael@amarulasolutions.com&gt;
    > Signed-off-by: Dario Binacchi &lt;dario.binacchi@amarulasolutions.com&gt;
    > Reviewed-by: Neil Armstrong &lt;neil.armstrong@linaro.org&gt;
    > Reviewed-by: Jessica Zhang &lt;quic_jesszhan@quicinc.com&gt;
    > Link: https://lore.kernel.org/r/20241205163002.1804784-1-dario.binacchi@amarulasolutions.com
    > Signed-off-by: Neil Armstrong &lt;neil.armstrong@linaro.org&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20241205163002.1804784-1-dario.binacchi@amarulasolutions.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/panel: st7701: Add prepare_prev_first flag to drm_panel (@Marek Vasut in [e44cc317b8db96f](https://github.com/sophgo/linux-riscv/commit/e44cc317b8db96f) at 2024-12-27 13:02:10)
    > [ Upstream commit 406dd4c7984a457567ca652455d5efad81983f02 ]
    > The DSI host must be enabled for the panel to be initialized in
    > prepare(). Set the prepare_prev_first flag to guarantee this.
    > This fixes the panel operation on NXP i.MX8MP SoC / Samsung DSIM
    > DSI host.
    > Fixes: 849b2e3ff969 (&quot;drm/panel: Add Sitronix ST7701 panel driver&quot;)
    > Signed-off-by: Marek Vasut &lt;marex@denx.de&gt;
    > Reviewed-by: Jessica Zhang &lt;quic_jesszhan@quicinc.com&gt;
    > Link: https://lore.kernel.org/r/20241124224812.150263-1-marex@denx.de
    > Signed-off-by: Neil Armstrong &lt;neil.armstrong@linaro.org&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20241124224812.150263-1-marex@denx.de
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ udmabuf: fix memory leak on last export_udmabuf() error path (@Jann Horn in [c9fc8428d4255c2](https://github.com/sophgo/linux-riscv/commit/c9fc8428d4255c2) at 2024-12-27 13:02:10)
    > [ Upstream commit f49856f525acd5bef52ae28b7da2e001bbe7439e ]
    > In export_udmabuf(), if dma_buf_fd() fails because the FD table is full, a
    > dma_buf owning the udmabuf has already been created; but the error handling
    > in udmabuf_create() will tear down the udmabuf without doing anything about
    > the containing dma_buf.
    > This leaves a dma_buf in memory that contains a dangling pointer; though
    > that doesn&#x27;t seem to lead to anything bad except a memory leak.
    > Fix it by moving the dma_buf_fd() call out of export_udmabuf() so that we
    > can give it different error handling.
    > Note that the shape of this code changed a lot in commit 5e72b2b41a21
    > (&quot;udmabuf: convert udmabuf driver to use folios&quot;); but the memory leak
    > seems to have existed since the introduction of udmabuf.
    > Fixes: fbb0de795078 (&quot;Add udmabuf misc device&quot;)
    > Acked-by: Vivek Kasireddy &lt;vivek.kasireddy@intel.com&gt;
    > Signed-off-by: Jann Horn &lt;jannh@google.com&gt;
    > Signed-off-by: Vivek Kasireddy &lt;vivek.kasireddy@intel.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20241204-udmabuf-fixes-v2-3-23887289de1c@google.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ dma-buf: Fix __dma_buf_debugfs_list_del argument for !CONFIG_DEBUG_FS (@T.J. Mercier in [c8395bfcd0e3b3d](https://github.com/sophgo/linux-riscv/commit/c8395bfcd0e3b3d) at 2024-12-27 13:02:10)
    > [ Upstream commit 0cff90dec63da908fb16d9ea2872ebbcd2d18e6a ]
    > The arguments for __dma_buf_debugfs_list_del do not match for both the
    > CONFIG_DEBUG_FS case and the !CONFIG_DEBUG_FS case. The !CONFIG_DEBUG_FS
    > case should take a struct dma_buf *, but it&#x27;s currently struct file *.
    > This can lead to the build error:
    > error: passing argument 1 of ‘__dma_buf_debugfs_list_del’ from
    > incompatible pointer type [-Werror&#x3D;incompatible-pointer-types]
    > dma-buf.c:63:53: note: expected ‘struct file *’ but argument is of
    > type ‘struct dma_buf *’
    > 63 | static void __dma_buf_debugfs_list_del(struct file *file)
    > Fixes: bfc7bc539392 (&quot;dma-buf: Do not build debugfs related code when !CONFIG_DEBUG_FS&quot;)
    > Signed-off-by: T.J. Mercier &lt;tjmercier@google.com&gt;
    > Reviewed-by: Tvrtko Ursulin &lt;tvrtko.ursulin@igalia.com&gt;
    > Signed-off-by: Sumit Semwal &lt;sumit.semwal@linaro.org&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20241117170326.1971113-1-tjmercier@google.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ udmabuf: udmabuf_create pin folio codestyle cleanup (@Huan Yang in [8e86e9909ad204c](https://github.com/sophgo/linux-riscv/commit/8e86e9909ad204c) at 2024-12-27 13:02:10)
    > [ Upstream commit 164fd9efd46531fddfaa933d394569259896642b ]
    > This patch aim to simplify the memfd folio pin during the udmabuf
    > create. No functional changes.
    > This patch create a udmabuf_pin_folios function, in this, do the memfd
    > pin folio and then record each pinned folio, offset.
    > This patch simplify the pinned folio record, iter by each pinned folio,
    > and then record each offset in it.
    > Compare to iter by pgcnt, more readable.
    > Suggested-by: Vivek Kasireddy &lt;vivek.kasireddy@intel.com&gt;
    > Signed-off-by: Huan Yang &lt;link@vivo.com&gt;
    > Acked-by: Vivek Kasireddy &lt;vivek.kasireddy@intel.com&gt;
    > Signed-off-by: Vivek Kasireddy &lt;vivek.kasireddy@intel.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20240918025238.2957823-5-link@vivo.com
    > Stable-dep-of: f49856f525ac (&quot;udmabuf: fix memory leak on last export_udmabuf() error path&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/panel: himax-hx83102: Add a check to prevent NULL pointer dereference (@Zhang Zekun in [747547972e64750](https://github.com/sophgo/linux-riscv/commit/747547972e64750) at 2024-12-27 13:02:10)
    > [ Upstream commit e1e1af9148dc4c866eda3fb59cd6ec3c7ea34b1d ]
    > drm_mode_duplicate() could return NULL due to lack of memory,
    > which will then call NULL pointer dereference. Add a check to
    > prevent it.
    > Fixes: 0ef94554dc40 (&quot;drm/panel: himax-hx83102: Break out as separate driver&quot;)
    > Signed-off-by: Zhang Zekun &lt;zhangzekun11@huawei.com&gt;
    > Reviewed-by: Neil Armstrong &lt;neil.armstrong@linaro.org&gt;
    > Link: https://lore.kernel.org/r/20241025073408.27481-3-zhangzekun11@huawei.com
    > Signed-off-by: Neil Armstrong &lt;neil.armstrong@linaro.org&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20241025073408.27481-3-zhangzekun11@huawei.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/panel: novatek-nt35950: fix return value check in nt35950_probe() (@Yang Yingliang in [4021a163e101cb8](https://github.com/sophgo/linux-riscv/commit/4021a163e101cb8) at 2024-12-27 13:02:10)
    > [ Upstream commit f8fd0968eff52cf092c0d517d17507ea2f6e5ea5 ]
    > mipi_dsi_device_register_full() never returns NULL pointer, it
    > will return ERR_PTR() when it fails, so replace the check with
    > IS_ERR().
    > Fixes: 623a3531e9cf (&quot;drm/panel: Add driver for Novatek NT35950 DSI DriverIC panels&quot;)
    > Signed-off-by: Yang Yingliang &lt;yangyingliang@huawei.com&gt;
    > Reviewed-by: Neil Armstrong &lt;neil.armstrong@linaro.org&gt;
    > Link: https://lore.kernel.org/r/20241029123957.1588-1-yangyingliang@huaweicloud.com
    > Signed-off-by: Neil Armstrong &lt;neil.armstrong@linaro.org&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20241029123957.1588-1-yangyingliang@huaweicloud.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/amdgpu: Handle NULL bo-&gt;tbo.resource (again) in amdgpu_vm_bo_update (@Michel Dänzer in [004da42b8e5768d](https://github.com/sophgo/linux-riscv/commit/004da42b8e5768d) at 2024-12-27 13:02:10)
    > commit 85230ee36d88e7a09fb062d43203035659dd10a5 upstream.
    > Third time&#x27;s the charm, I hope?
    > Fixes: d3116756a710 (&quot;drm/ttm: rename bo-&gt;mem and make it a pointer&quot;)
    > Closes: https://gitlab.freedesktop.org/drm/amd/-/issues/3837
    > Reviewed-by: Christian König &lt;christian.koenig@amd.com&gt;
    > Signed-off-by: Michel Dänzer &lt;mdaenzer@redhat.com&gt;
    > Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > (cherry picked from commit 695c2c745e5dff201b75da8a1d237ce403600d04)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ drm/amd: Update strapping for NBIO 2.5.0 (@Mario Limonciello in [ef1f520cf57438b](https://github.com/sophgo/linux-riscv/commit/ef1f520cf57438b) at 2024-12-27 13:02:09)
    > commit a7f9d98eb1202132014ba760c26ad8608ffc9caf upstream.
    > This helps to avoid a spurious PME event on hotplug to Azalia.
    > Cc: Vijendar Mukunda &lt;Vijendar.Mukunda@amd.com&gt;
    > Reported-and-tested-by: ionut_n2001@yahoo.com
    > Closes: https://bugzilla.kernel.org/show_bug.cgi?id&#x3D;215884
    > Tested-by: Gabriel Marcano &lt;gabemarcano@yahoo.com&gt;
    > Acked-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Link: https://lore.kernel.org/r/20241211024414.7840-1-mario.limonciello@amd.com
    > Signed-off-by: Mario Limonciello &lt;mario.limonciello@amd.com&gt;
    > Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > (cherry picked from commit 3f6f237b9dd189e1fb85b8a3f7c97a8f27c1e49a)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ thunderbolt: Don&#x27;t display nvm_version unless upgrade supported (@Mario Limonciello in [eed704d8ab6782f](https://github.com/sophgo/linux-riscv/commit/eed704d8ab6782f) at 2024-12-27 13:02:09)
    > commit e34f1717ef0632fcec5cb827e5e0e9f223d70c9b upstream.
    > The read will never succeed if NVM wasn&#x27;t initialized due to an unknown
    > format.
    > Add a new callback for visibility to only show when supported.
    > Cc: stable@vger.kernel.org
    > Fixes: aef9c693e7e5 (&quot;thunderbolt: Move vendor specific NVM handling into nvm.c&quot;)
    > Reported-by: Richard Hughes &lt;hughsient@gmail.com&gt;
    > Closes: https://github.com/fwupd/fwupd/issues/8200
    > Signed-off-by: Mario Limonciello &lt;mario.limonciello@amd.com&gt;
    > Signed-off-by: Mika Westerberg &lt;mika.westerberg@linux.intel.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ drm/display: use ERR_PTR on DP tunnel manager creation fail (@Krzysztof Karas in [d9369f0c9f9531d](https://github.com/sophgo/linux-riscv/commit/d9369f0c9f9531d) at 2024-12-27 13:02:09)
    > commit 080b2e7b5e9ad23343e4b11f0751e4c724a78958 upstream.
    > Instead of returning a generic NULL on error from
    > drm_dp_tunnel_mgr_create(), use error pointers with informative codes
    > to align the function with stub that is executed when
    > CONFIG_DRM_DISPLAY_DP_TUNNEL is unset. This will also trigger IS_ERR()
    > in current caller (intel_dp_tunnerl_mgr_init()) instead of bypassing it
    > via NULL pointer.
    > v2: use error codes inside drm_dp_tunnel_mgr_create() instead of handling
    > on caller&#x27;s side (Michal, Imre)
    > v3: fixup commit message and add &quot;CC&quot;/&quot;Fixes&quot; lines (Andi),
    > mention aligning function code with stub
    > Fixes: 91888b5b1ad2 (&quot;drm/i915/dp: Add support for DP tunnel BW allocation&quot;)
    > Cc: Imre Deak &lt;imre.deak@intel.com&gt;
    > Cc: &lt;stable@vger.kernel.org&gt; # v6.9+
    > Signed-off-by: Krzysztof Karas &lt;krzysztof.karas@intel.com&gt;
    > Reviewed-by: Andi Shyti &lt;andi.shyti@linux.intel.com&gt;
    > Signed-off-by: Imre Deak &lt;imre.deak@intel.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/7q4fpnmmztmchczjewgm6igy55qt6jsm7tfd4fl4ucfq6yg2oy@q4lxtsu6445c
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ thunderbolt: Add support for Intel Panther Lake-M/P (@Mika Westerberg in [cb13e17466a02fe](https://github.com/sophgo/linux-riscv/commit/cb13e17466a02fe) at 2024-12-27 13:02:09)
    > commit 8644b48714dca8bf2f42a4ff8311de8efc9bd8c3 upstream.
    > Intel Panther Lake-M/P has the same integrated Thunderbolt/USB4
    > controller as Lunar Lake. Add these PCI IDs to the driver list of
    > supported devices.
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Mika Westerberg &lt;mika.westerberg@linux.intel.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ thunderbolt: Improve redrive mode handling (@Mika Westerberg in [9e2ff33ce003038](https://github.com/sophgo/linux-riscv/commit/9e2ff33ce003038) at 2024-12-27 13:02:09)
    > commit 24740385cb0d6d22ab7fa7adf36546d5b3cdcf73 upstream.
    > When USB-C monitor is connected directly to Intel Barlow Ridge host, it
    > goes into &quot;redrive&quot; mode that basically routes the DisplayPort signals
    > directly from the GPU to the USB-C monitor without any tunneling needed.
    > However, the host router must be powered on for this to work. Aaron
    > reported that there are a couple of cases where this will not work with
    > the current code:
    > - Booting with USB-C monitor plugged in.
    > - Plugging in USB-C monitor when the host router is in sleep state
    > (runtime suspended).
    > - Plugging in USB-C device while the system is in system sleep state.
    > In all these cases once the host router is runtime suspended the picture
    > on the connected USB-C display disappears too. This is certainly not
    > what the user expected.
    > For this reason improve the redrive mode handling to keep the host
    > router from runtime suspending when detect that any of the above cases
    > is happening.
    > Fixes: a75e0684efe5 (&quot;thunderbolt: Keep the domain powered when USB4 port is in redrive mode&quot;)
    > Reported-by: Aaron Rainbolt &lt;arainbolt@kfocus.org&gt;
    > Closes: https://lore.kernel.org/linux-usb/20241009220118.70bfedd0@kf-ir16/
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Mika Westerberg &lt;mika.westerberg@linux.intel.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ drm/modes: Avoid divide by zero harder in drm_mode_vrefresh() (@Ville Syrjälä in [47c8b6cf1d08f0a](https://github.com/sophgo/linux-riscv/commit/47c8b6cf1d08f0a) at 2024-12-27 13:02:09)
    > commit 9398332f23fab10c5ec57c168b44e72997d6318e upstream.
    > drm_mode_vrefresh() is trying to avoid divide by zero
    > by checking whether htotal or vtotal are zero. But we may
    > still end up with a div-by-zero of vtotal*htotal*...
    > Cc: stable@vger.kernel.org
    > Reported-by: syzbot+622bba18029bcde672e1@syzkaller.appspotmail.com
    > Closes: https://syzkaller.appspot.com/bug?extid&#x3D;622bba18029bcde672e1
    > Signed-off-by: Ville Syrjälä &lt;ville.syrjala@linux.intel.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20241129042629.18280-2-ville.syrjala@linux.intel.com
    > Reviewed-by: Jani Nikula &lt;jani.nikula@intel.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ drm/amdgpu: fix amdgpu_coredump (@Christian König in [3818802ddc3d2f8](https://github.com/sophgo/linux-riscv/commit/3818802ddc3d2f8) at 2024-12-27 13:02:09)
    > commit 8d1a13816e59254bd3b18f5ae0895230922bd120 upstream.
    > The VM pointer might already be outdated when that function is called.
    > Use the PASID instead to gather the information instead.
    > Signed-off-by: Christian König &lt;christian.koenig@amd.com&gt;
    > Reviewed-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > (cherry picked from commit 57f812d171af4ba233d3ed7c94dfa5b8e92dcc04)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ hexagon: Disable constant extender optimization for LLVM prior to 19.1.0 (@Nathan Chancellor in [ebdfd6b0f297339](https://github.com/sophgo/linux-riscv/commit/ebdfd6b0f297339) at 2024-12-27 13:02:08)
    > commit aef25be35d23ec768eed08bfcf7ca3cf9685bc28 upstream.
    > The Hexagon-specific constant extender optimization in LLVM may crash on
    > Linux kernel code [1], such as fs/bcache/btree_io.c after
    > commit 32ed4a620c54 (&quot;bcachefs: Btree path tracepoints&quot;) in 6.12:
    > clang: llvm/lib/Target/Hexagon/HexagonConstExtenders.cpp:745: bool (anonymous namespace)::HexagonConstExtenders::ExtRoot::operator&lt;(const HCE::ExtRoot &amp;) const: Assertion &#x60;ThisB-&gt;getParent() &#x3D;&#x3D; OtherB-&gt;getParent()&#x27; failed.
    > Stack dump:
    > 0.      Program arguments: clang --target&#x3D;hexagon-linux-musl ... fs/bcachefs/btree_io.c
    > 1.      &lt;eof&gt; parser at end of file
    > 2.      Code generation
    > 3.      Running pass &#x27;Function Pass Manager&#x27; on module &#x27;fs/bcachefs/btree_io.c&#x27;.
    > 4.      Running pass &#x27;Hexagon constant-extender optimization&#x27; on function &#x27;@__btree_node_lock_nopath&#x27;
    > Without assertions enabled, there is just a hang during compilation.
    > This has been resolved in LLVM main (20.0.0) [2] and backported to LLVM
    > 19.1.0 but the kernel supports LLVM 13.0.1 and newer, so disable the
    > constant expander optimization using the &#x27;-mllvm&#x27; option when using a
    > toolchain that is not fixed.
    > Cc: stable@vger.kernel.org
    > Link: https://github.com/llvm/llvm-project/issues/99714 [1]
    > Link: https://github.com/llvm/llvm-project/commit/68df06a0b2998765cb0a41353fcf0919bbf57ddb [2]
    > Link: https://github.com/llvm/llvm-project/commit/2ab8d93061581edad3501561722ebd5632d73892 [3]
    > Reviewed-by: Brian Cain &lt;bcain@quicinc.com&gt;
    > Signed-off-by: Nathan Chancellor &lt;nathan@kernel.org&gt;
    > Signed-off-by: Linus Torvalds &lt;torvalds@linux-foundation.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ USB: serial: option: add TCL IK512 MBIM &amp; ECM (@Daniel Swanemar in [e6b2735a766acf1](https://github.com/sophgo/linux-riscv/commit/e6b2735a766acf1) at 2024-12-27 13:02:08)
    > commit fdad4fb7c506bea8b419f70ff2163d99962e8ede upstream.
    > Add the following TCL IK512 compositions:
    > 0x0530: Modem + Diag + AT + MBIM
    > T:  Bus&#x3D;04 Lev&#x3D;01 Prnt&#x3D;01 Port&#x3D;00 Cnt&#x3D;01 Dev#&#x3D;  3 Spd&#x3D;10000 MxCh&#x3D; 0
    > D:  Ver&#x3D; 3.20 Cls&#x3D;00(&gt;ifc ) Sub&#x3D;00 Prot&#x3D;00 MxPS&#x3D; 9 #Cfgs&#x3D;  1
    > P:  Vendor&#x3D;1bbb ProdID&#x3D;0530 Rev&#x3D;05.04
    > S:  Manufacturer&#x3D;TCL
    > S:  Product&#x3D;TCL 5G USB Dongle
    > S:  SerialNumber&#x3D;3136b91a
    > C:  #Ifs&#x3D; 5 Cfg#&#x3D; 1 Atr&#x3D;80 MxPwr&#x3D;896mA
    > I:  If#&#x3D; 0 Alt&#x3D; 0 #EPs&#x3D; 3 Cls&#x3D;ff(vend.) Sub&#x3D;ff Prot&#x3D;40 Driver&#x3D;option
    > E:  Ad&#x3D;01(O) Atr&#x3D;02(Bulk) MxPS&#x3D;1024 Ivl&#x3D;0ms
    > E:  Ad&#x3D;81(I) Atr&#x3D;02(Bulk) MxPS&#x3D;1024 Ivl&#x3D;0ms
    > E:  Ad&#x3D;82(I) Atr&#x3D;03(Int.) MxPS&#x3D;  10 Ivl&#x3D;32ms
    > I:  If#&#x3D; 1 Alt&#x3D; 0 #EPs&#x3D; 2 Cls&#x3D;ff(vend.) Sub&#x3D;ff Prot&#x3D;30 Driver&#x3D;option
    > E:  Ad&#x3D;02(O) Atr&#x3D;02(Bulk) MxPS&#x3D;1024 Ivl&#x3D;0ms
    > E:  Ad&#x3D;83(I) Atr&#x3D;02(Bulk) MxPS&#x3D;1024 Ivl&#x3D;0ms
    > I:  If#&#x3D; 2 Alt&#x3D; 0 #EPs&#x3D; 3 Cls&#x3D;ff(vend.) Sub&#x3D;ff Prot&#x3D;40 Driver&#x3D;option
    > E:  Ad&#x3D;03(O) Atr&#x3D;02(Bulk) MxPS&#x3D;1024 Ivl&#x3D;0ms
    > E:  Ad&#x3D;84(I) Atr&#x3D;02(Bulk) MxPS&#x3D;1024 Ivl&#x3D;0ms
    > E:  Ad&#x3D;85(I) Atr&#x3D;03(Int.) MxPS&#x3D;  10 Ivl&#x3D;32ms
    > I:  If#&#x3D; 3 Alt&#x3D; 0 #EPs&#x3D; 1 Cls&#x3D;02(commc) Sub&#x3D;0e Prot&#x3D;00 Driver&#x3D;cdc_mbim
    > E:  Ad&#x3D;86(I) Atr&#x3D;03(Int.) MxPS&#x3D;  64 Ivl&#x3D;32ms
    > I:  If#&#x3D; 4 Alt&#x3D; 1 #EPs&#x3D; 2 Cls&#x3D;0a(data ) Sub&#x3D;00 Prot&#x3D;02 Driver&#x3D;cdc_mbim
    > E:  Ad&#x3D;0f(O) Atr&#x3D;02(Bulk) MxPS&#x3D;1024 Ivl&#x3D;0ms
    > E:  Ad&#x3D;8e(I) Atr&#x3D;02(Bulk) MxPS&#x3D;1024 Ivl&#x3D;0ms
    > 0x0640: ECM + Modem + Diag + AT
    > T:  Bus&#x3D;04 Lev&#x3D;01 Prnt&#x3D;01 Port&#x3D;00 Cnt&#x3D;01 Dev#&#x3D;  4 Spd&#x3D;10000 MxCh&#x3D; 0
    > D:  Ver&#x3D; 3.20 Cls&#x3D;00(&gt;ifc ) Sub&#x3D;00 Prot&#x3D;00 MxPS&#x3D; 9 #Cfgs&#x3D;  1
    > P:  Vendor&#x3D;1bbb ProdID&#x3D;0640 Rev&#x3D;05.04
    > S:  Manufacturer&#x3D;TCL
    > S:  Product&#x3D;TCL 5G USB Dongle
    > S:  SerialNumber&#x3D;3136b91a
    > C:  #Ifs&#x3D; 5 Cfg#&#x3D; 1 Atr&#x3D;80 MxPwr&#x3D;896mA
    > I:  If#&#x3D; 0 Alt&#x3D; 0 #EPs&#x3D; 1 Cls&#x3D;02(commc) Sub&#x3D;06 Prot&#x3D;00 Driver&#x3D;cdc_ether
    > E:  Ad&#x3D;81(I) Atr&#x3D;03(Int.) MxPS&#x3D;  16 Ivl&#x3D;32ms
    > I:  If#&#x3D; 1 Alt&#x3D; 1 #EPs&#x3D; 2 Cls&#x3D;0a(data ) Sub&#x3D;00 Prot&#x3D;00 Driver&#x3D;cdc_ether
    > E:  Ad&#x3D;0f(O) Atr&#x3D;02(Bulk) MxPS&#x3D;1024 Ivl&#x3D;0ms
    > E:  Ad&#x3D;8e(I) Atr&#x3D;02(Bulk) MxPS&#x3D;1024 Ivl&#x3D;0ms
    > I:  If#&#x3D; 2 Alt&#x3D; 0 #EPs&#x3D; 3 Cls&#x3D;ff(vend.) Sub&#x3D;ff Prot&#x3D;40 Driver&#x3D;option
    > E:  Ad&#x3D;01(O) Atr&#x3D;02(Bulk) MxPS&#x3D;1024 Ivl&#x3D;0ms
    > E:  Ad&#x3D;82(I) Atr&#x3D;02(Bulk) MxPS&#x3D;1024 Ivl&#x3D;0ms
    > E:  Ad&#x3D;83(I) Atr&#x3D;03(Int.) MxPS&#x3D;  10 Ivl&#x3D;32ms
    > I:  If#&#x3D; 3 Alt&#x3D; 0 #EPs&#x3D; 2 Cls&#x3D;ff(vend.) Sub&#x3D;ff Prot&#x3D;30 Driver&#x3D;option
    > E:  Ad&#x3D;02(O) Atr&#x3D;02(Bulk) MxPS&#x3D;1024 Ivl&#x3D;0ms
    > E:  Ad&#x3D;84(I) Atr&#x3D;02(Bulk) MxPS&#x3D;1024 Ivl&#x3D;0ms
    > I:  If#&#x3D; 4 Alt&#x3D; 0 #EPs&#x3D; 3 Cls&#x3D;ff(vend.) Sub&#x3D;ff Prot&#x3D;40 Driver&#x3D;option
    > E:  Ad&#x3D;03(O) Atr&#x3D;02(Bulk) MxPS&#x3D;1024 Ivl&#x3D;0ms
    > E:  Ad&#x3D;85(I) Atr&#x3D;02(Bulk) MxPS&#x3D;1024 Ivl&#x3D;0ms
    > E:  Ad&#x3D;86(I) Atr&#x3D;03(Int.) MxPS&#x3D;  10 Ivl&#x3D;32ms
    > Signed-off-by: Daniel Swanemar &lt;d.swanemar@gmail.com&gt;
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Johan Hovold &lt;johan@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ USB: serial: option: add Telit FE910C04 rmnet compositions (@Daniele Palmas in [ced29f2149c9b65](https://github.com/sophgo/linux-riscv/commit/ced29f2149c9b65) at 2024-12-27 13:02:08)
    > commit 8366e64a4454481339e7c56a8ad280161f2e441d upstream.
    > Add the following Telit FE910C04 compositions:
    > 0x10c0: rmnet + tty (AT/NMEA) + tty (AT) + tty (diag)
    > T:  Bus&#x3D;02 Lev&#x3D;01 Prnt&#x3D;03 Port&#x3D;06 Cnt&#x3D;01 Dev#&#x3D; 13 Spd&#x3D;480  MxCh&#x3D; 0
    > D:  Ver&#x3D; 2.00 Cls&#x3D;00(&gt;ifc ) Sub&#x3D;00 Prot&#x3D;00 MxPS&#x3D;64 #Cfgs&#x3D;  1
    > P:  Vendor&#x3D;1bc7 ProdID&#x3D;10c0 Rev&#x3D;05.15
    > S:  Manufacturer&#x3D;Telit Cinterion
    > S:  Product&#x3D;FE910
    > S:  SerialNumber&#x3D;f71b8b32
    > C:  #Ifs&#x3D; 4 Cfg#&#x3D; 1 Atr&#x3D;e0 MxPwr&#x3D;500mA
    > I:  If#&#x3D; 0 Alt&#x3D; 0 #EPs&#x3D; 3 Cls&#x3D;ff(vend.) Sub&#x3D;ff Prot&#x3D;50 Driver&#x3D;qmi_wwan
    > E:  Ad&#x3D;01(O) Atr&#x3D;02(Bulk) MxPS&#x3D; 512 Ivl&#x3D;0ms
    > E:  Ad&#x3D;81(I) Atr&#x3D;02(Bulk) MxPS&#x3D; 512 Ivl&#x3D;0ms
    > E:  Ad&#x3D;82(I) Atr&#x3D;03(Int.) MxPS&#x3D;   8 Ivl&#x3D;32ms
    > I:  If#&#x3D; 1 Alt&#x3D; 0 #EPs&#x3D; 3 Cls&#x3D;ff(vend.) Sub&#x3D;ff Prot&#x3D;60 Driver&#x3D;option
    > E:  Ad&#x3D;02(O) Atr&#x3D;02(Bulk) MxPS&#x3D; 512 Ivl&#x3D;0ms
    > E:  Ad&#x3D;83(I) Atr&#x3D;02(Bulk) MxPS&#x3D; 512 Ivl&#x3D;0ms
    > E:  Ad&#x3D;84(I) Atr&#x3D;03(Int.) MxPS&#x3D;  10 Ivl&#x3D;32ms
    > I:  If#&#x3D; 2 Alt&#x3D; 0 #EPs&#x3D; 3 Cls&#x3D;ff(vend.) Sub&#x3D;ff Prot&#x3D;40 Driver&#x3D;option
    > E:  Ad&#x3D;03(O) Atr&#x3D;02(Bulk) MxPS&#x3D; 512 Ivl&#x3D;0ms
    > E:  Ad&#x3D;85(I) Atr&#x3D;02(Bulk) MxPS&#x3D; 512 Ivl&#x3D;0ms
    > E:  Ad&#x3D;86(I) Atr&#x3D;03(Int.) MxPS&#x3D;  10 Ivl&#x3D;32ms
    > I:  If#&#x3D; 3 Alt&#x3D; 0 #EPs&#x3D; 2 Cls&#x3D;ff(vend.) Sub&#x3D;ff Prot&#x3D;30 Driver&#x3D;option
    > E:  Ad&#x3D;04(O) Atr&#x3D;02(Bulk) MxPS&#x3D; 512 Ivl&#x3D;0ms
    > E:  Ad&#x3D;87(I) Atr&#x3D;02(Bulk) MxPS&#x3D; 512 Ivl&#x3D;0ms
    > 0x10c4: rmnet + tty (AT) + tty (AT) + tty (diag)
    > T:  Bus&#x3D;02 Lev&#x3D;01 Prnt&#x3D;03 Port&#x3D;06 Cnt&#x3D;01 Dev#&#x3D; 14 Spd&#x3D;480  MxCh&#x3D; 0
    > D:  Ver&#x3D; 2.00 Cls&#x3D;00(&gt;ifc ) Sub&#x3D;00 Prot&#x3D;00 MxPS&#x3D;64 #Cfgs&#x3D;  1
    > P:  Vendor&#x3D;1bc7 ProdID&#x3D;10c4 Rev&#x3D;05.15
    > S:  Manufacturer&#x3D;Telit Cinterion
    > S:  Product&#x3D;FE910
    > S:  SerialNumber&#x3D;f71b8b32
    > C:  #Ifs&#x3D; 4 Cfg#&#x3D; 1 Atr&#x3D;e0 MxPwr&#x3D;500mA
    > I:  If#&#x3D; 0 Alt&#x3D; 0 #EPs&#x3D; 3 Cls&#x3D;ff(vend.) Sub&#x3D;ff Prot&#x3D;50 Driver&#x3D;qmi_wwan
    > E:  Ad&#x3D;01(O) Atr&#x3D;02(Bulk) MxPS&#x3D; 512 Ivl&#x3D;0ms
    > E:  Ad&#x3D;81(I) Atr&#x3D;02(Bulk) MxPS&#x3D; 512 Ivl&#x3D;0ms
    > E:  Ad&#x3D;82(I) Atr&#x3D;03(Int.) MxPS&#x3D;   8 Ivl&#x3D;32ms
    > I:  If#&#x3D; 1 Alt&#x3D; 0 #EPs&#x3D; 3 Cls&#x3D;ff(vend.) Sub&#x3D;ff Prot&#x3D;40 Driver&#x3D;option
    > E:  Ad&#x3D;02(O) Atr&#x3D;02(Bulk) MxPS&#x3D; 512 Ivl&#x3D;0ms
    > E:  Ad&#x3D;83(I) Atr&#x3D;02(Bulk) MxPS&#x3D; 512 Ivl&#x3D;0ms
    > E:  Ad&#x3D;84(I) Atr&#x3D;03(Int.) MxPS&#x3D;  10 Ivl&#x3D;32ms
    > I:  If#&#x3D; 2 Alt&#x3D; 0 #EPs&#x3D; 3 Cls&#x3D;ff(vend.) Sub&#x3D;ff Prot&#x3D;40 Driver&#x3D;option
    > E:  Ad&#x3D;03(O) Atr&#x3D;02(Bulk) MxPS&#x3D; 512 Ivl&#x3D;0ms
    > E:  Ad&#x3D;85(I) Atr&#x3D;02(Bulk) MxPS&#x3D; 512 Ivl&#x3D;0ms
    > E:  Ad&#x3D;86(I) Atr&#x3D;03(Int.) MxPS&#x3D;  10 Ivl&#x3D;32ms
    > I:  If#&#x3D; 3 Alt&#x3D; 0 #EPs&#x3D; 2 Cls&#x3D;ff(vend.) Sub&#x3D;ff Prot&#x3D;30 Driver&#x3D;option
    > E:  Ad&#x3D;04(O) Atr&#x3D;02(Bulk) MxPS&#x3D; 512 Ivl&#x3D;0ms
    > E:  Ad&#x3D;87(I) Atr&#x3D;02(Bulk) MxPS&#x3D; 512 Ivl&#x3D;0ms
    > 0x10c8: rmnet + tty (AT) + tty (diag) + DPL (data packet logging) + adb
    > T:  Bus&#x3D;02 Lev&#x3D;01 Prnt&#x3D;03 Port&#x3D;06 Cnt&#x3D;01 Dev#&#x3D; 17 Spd&#x3D;480  MxCh&#x3D; 0
    > D:  Ver&#x3D; 2.00 Cls&#x3D;00(&gt;ifc ) Sub&#x3D;00 Prot&#x3D;00 MxPS&#x3D;64 #Cfgs&#x3D;  1
    > P:  Vendor&#x3D;1bc7 ProdID&#x3D;10c8 Rev&#x3D;05.15
    > S:  Manufacturer&#x3D;Telit Cinterion
    > S:  Product&#x3D;FE910
    > S:  SerialNumber&#x3D;f71b8b32
    > C:  #Ifs&#x3D; 5 Cfg#&#x3D; 1 Atr&#x3D;e0 MxPwr&#x3D;500mA
    > I:  If#&#x3D; 0 Alt&#x3D; 0 #EPs&#x3D; 3 Cls&#x3D;ff(vend.) Sub&#x3D;ff Prot&#x3D;50 Driver&#x3D;qmi_wwan
    > E:  Ad&#x3D;01(O) Atr&#x3D;02(Bulk) MxPS&#x3D; 512 Ivl&#x3D;0ms
    > E:  Ad&#x3D;81(I) Atr&#x3D;02(Bulk) MxPS&#x3D; 512 Ivl&#x3D;0ms
    > E:  Ad&#x3D;82(I) Atr&#x3D;03(Int.) MxPS&#x3D;   8 Ivl&#x3D;32ms
    > I:  If#&#x3D; 1 Alt&#x3D; 0 #EPs&#x3D; 3 Cls&#x3D;ff(vend.) Sub&#x3D;ff Prot&#x3D;40 Driver&#x3D;option
    > E:  Ad&#x3D;02(O) Atr&#x3D;02(Bulk) MxPS&#x3D; 512 Ivl&#x3D;0ms
    > E:  Ad&#x3D;83(I) Atr&#x3D;02(Bulk) MxPS&#x3D; 512 Ivl&#x3D;0ms
    > E:  Ad&#x3D;84(I) Atr&#x3D;03(Int.) MxPS&#x3D;  10 Ivl&#x3D;32ms
    > I:  If#&#x3D; 2 Alt&#x3D; 0 #EPs&#x3D; 2 Cls&#x3D;ff(vend.) Sub&#x3D;ff Prot&#x3D;30 Driver&#x3D;option
    > E:  Ad&#x3D;03(O) Atr&#x3D;02(Bulk) MxPS&#x3D; 512 Ivl&#x3D;0ms
    > E:  Ad&#x3D;85(I) Atr&#x3D;02(Bulk) MxPS&#x3D; 512 Ivl&#x3D;0ms
    > I:  If#&#x3D; 3 Alt&#x3D; 0 #EPs&#x3D; 1 Cls&#x3D;ff(vend.) Sub&#x3D;ff Prot&#x3D;80 Driver&#x3D;(none)
    > E:  Ad&#x3D;86(I) Atr&#x3D;02(Bulk) MxPS&#x3D; 512 Ivl&#x3D;0ms
    > I:  If#&#x3D; 4 Alt&#x3D; 0 #EPs&#x3D; 2 Cls&#x3D;ff(vend.) Sub&#x3D;42 Prot&#x3D;01 Driver&#x3D;(none)
    > E:  Ad&#x3D;04(O) Atr&#x3D;02(Bulk) MxPS&#x3D; 512 Ivl&#x3D;0ms
    > E:  Ad&#x3D;87(I) Atr&#x3D;02(Bulk) MxPS&#x3D; 512 Ivl&#x3D;0ms
    > Signed-off-by: Daniele Palmas &lt;dnlplm@gmail.com&gt;
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Johan Hovold &lt;johan@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ xhci: Turn NEC specific quirk for handling Stop Endpoint errors generic (@Mathias Nyman in [7ccad1ee83c405a](https://github.com/sophgo/linux-riscv/commit/7ccad1ee83c405a) at 2024-12-27 13:02:08)
    > commit e21ebe51af688eb98fd6269240212a3c7300deea upstream.
    > xHC hosts from several vendors have the same issue where endpoints start
    > so slowly that a later queued &#x27;Stop Endpoint&#x27; command may complete before
    > endpoint is up and running.
    > The &#x27;Stop Endpoint&#x27; command fails with context state error as the endpoint
    > still appears as  stopped.
    > See commit 42b758137601 (&quot;usb: xhci: Limit Stop Endpoint retries&quot;) for
    > details
    > CC: stable@vger.kernel.org
    > Signed-off-by: Mathias Nyman &lt;mathias.nyman@linux.intel.com&gt;
    > Link: https://lore.kernel.org/r/20241217102122.2316814-2-mathias.nyman@linux.intel.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ USB: serial: option: add Netprisma LCUK54 modules for WWAN Ready (@Mank Wang in [50d84d15e33806e](https://github.com/sophgo/linux-riscv/commit/50d84d15e33806e) at 2024-12-27 13:02:08)
    > commit aa954ae08262bb5cd6ab18dd56a0b58c1315db8b upstream.
    > LCUK54-WRD&#x27;s pid/vid
    > 0x3731/0x010a
    > 0x3731/0x010c
    > LCUK54-WWD&#x27;s pid/vid
    > 0x3731/0x010b
    > 0x3731/0x010d
    > Above products use the exact same interface layout and option
    > driver:
    > MBIM + GNSS + DIAG + NMEA + AT + QDSS + DPL
    > T:  Bus&#x3D;01 Lev&#x3D;01 Prnt&#x3D;01 Port&#x3D;01 Cnt&#x3D;02 Dev#&#x3D;  5 Spd&#x3D;480  MxCh&#x3D; 0
    > D:  Ver&#x3D; 2.00 Cls&#x3D;00(&gt;ifc ) Sub&#x3D;00 Prot&#x3D;00 MxPS&#x3D;64 #Cfgs&#x3D;  1
    > P:  Vendor&#x3D;3731 ProdID&#x3D;0101 Rev&#x3D; 5.04
    > S:  Manufacturer&#x3D;NetPrisma
    > S:  Product&#x3D;LCUK54-WRD
    > S:  SerialNumber&#x3D;feeba631
    > C:* #Ifs&#x3D; 8 Cfg#&#x3D; 1 Atr&#x3D;a0 MxPwr&#x3D;500mA
    > A:  FirstIf#&#x3D; 0 IfCount&#x3D; 2 Cls&#x3D;02(comm.) Sub&#x3D;0e Prot&#x3D;00
    > I:* If#&#x3D; 0 Alt&#x3D; 0 #EPs&#x3D; 1 Cls&#x3D;02(comm.) Sub&#x3D;0e Prot&#x3D;00 Driver&#x3D;cdc_mbim
    > E:  Ad&#x3D;81(I) Atr&#x3D;03(Int.) MxPS&#x3D;  64 Ivl&#x3D;32ms
    > I:  If#&#x3D; 1 Alt&#x3D; 0 #EPs&#x3D; 0 Cls&#x3D;0a(data ) Sub&#x3D;00 Prot&#x3D;02 Driver&#x3D;cdc_mbim
    > I:* If#&#x3D; 1 Alt&#x3D; 1 #EPs&#x3D; 2 Cls&#x3D;0a(data ) Sub&#x3D;00 Prot&#x3D;02 Driver&#x3D;cdc_mbim
    > E:  Ad&#x3D;8e(I) Atr&#x3D;02(Bulk) MxPS&#x3D; 512 Ivl&#x3D;0ms
    > E:  Ad&#x3D;0f(O) Atr&#x3D;02(Bulk) MxPS&#x3D; 512 Ivl&#x3D;0ms
    > I:* If#&#x3D; 2 Alt&#x3D; 0 #EPs&#x3D; 1 Cls&#x3D;ff(vend.) Sub&#x3D;ff Prot&#x3D;ff Driver&#x3D;(none)
    > E:  Ad&#x3D;82(I) Atr&#x3D;03(Int.) MxPS&#x3D;  64 Ivl&#x3D;32ms
    > I:* If#&#x3D; 3 Alt&#x3D; 0 #EPs&#x3D; 2 Cls&#x3D;ff(vend.) Sub&#x3D;ff Prot&#x3D;30 Driver&#x3D;option
    > E:  Ad&#x3D;01(O) Atr&#x3D;02(Bulk) MxPS&#x3D; 512 Ivl&#x3D;0ms
    > E:  Ad&#x3D;83(I) Atr&#x3D;02(Bulk) MxPS&#x3D; 512 Ivl&#x3D;0ms
    > I:* If#&#x3D; 4 Alt&#x3D; 0 #EPs&#x3D; 3 Cls&#x3D;ff(vend.) Sub&#x3D;00 Prot&#x3D;40 Driver&#x3D;option
    > E:  Ad&#x3D;85(I) Atr&#x3D;03(Int.) MxPS&#x3D;  10 Ivl&#x3D;32ms
    > E:  Ad&#x3D;84(I) Atr&#x3D;02(Bulk) MxPS&#x3D; 512 Ivl&#x3D;0ms
    > E:  Ad&#x3D;02(O) Atr&#x3D;02(Bulk) MxPS&#x3D; 512 Ivl&#x3D;0ms
    > I:* If#&#x3D; 5 Alt&#x3D; 0 #EPs&#x3D; 3 Cls&#x3D;ff(vend.) Sub&#x3D;ff Prot&#x3D;40 Driver&#x3D;option
    > E:  Ad&#x3D;87(I) Atr&#x3D;03(Int.) MxPS&#x3D;  10 Ivl&#x3D;32ms
    > E:  Ad&#x3D;86(I) Atr&#x3D;02(Bulk) MxPS&#x3D; 512 Ivl&#x3D;0ms
    > E:  Ad&#x3D;03(O) Atr&#x3D;02(Bulk) MxPS&#x3D; 512 Ivl&#x3D;0ms
    > I:* If#&#x3D; 6 Alt&#x3D; 0 #EPs&#x3D; 1 Cls&#x3D;ff(vend.) Sub&#x3D;ff Prot&#x3D;70 Driver&#x3D;(none)
    > E:  Ad&#x3D;88(I) Atr&#x3D;02(Bulk) MxPS&#x3D; 512 Ivl&#x3D;0ms
    > I:* If#&#x3D; 7 Alt&#x3D; 0 #EPs&#x3D; 1 Cls&#x3D;ff(vend.) Sub&#x3D;ff Prot&#x3D;80 Driver&#x3D;(none)
    > E:  Ad&#x3D;8f(I) Atr&#x3D;02(Bulk) MxPS&#x3D; 512 Ivl&#x3D;0ms
    > Signed-off-by: Mank Wang &lt;mank.wang@netprisma.com&gt;
    > [ johan: use lower case hex notation ]
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Johan Hovold &lt;johan@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ USB: serial: option: add MediaTek T7XX compositions (@Jack Wu in [23e63f62c64f63e](https://github.com/sophgo/linux-riscv/commit/23e63f62c64f63e) at 2024-12-27 13:02:08)
    > commit f07dfa6a1b65034a5c3ba3a555950d972f252757 upstream.
    > Add the MediaTek T7XX compositions:
    > T:  Bus&#x3D;03 Lev&#x3D;01 Prnt&#x3D;01 Port&#x3D;05 Cnt&#x3D;01 Dev#&#x3D; 74 Spd&#x3D;480  MxCh&#x3D; 0
    > D:  Ver&#x3D; 2.10 Cls&#x3D;ef(misc ) Sub&#x3D;02 Prot&#x3D;01 MxPS&#x3D;64 #Cfgs&#x3D;  1
    > P:  Vendor&#x3D;0e8d ProdID&#x3D;7129 Rev&#x3D; 0.01
    > S:  Manufacturer&#x3D;MediaTek Inc.
    > S:  Product&#x3D;USB DATA CARD
    > S:  SerialNumber&#x3D;004402459035402
    > C:* #Ifs&#x3D;10 Cfg#&#x3D; 1 Atr&#x3D;a0 MxPwr&#x3D;500mA
    > A:  FirstIf#&#x3D; 0 IfCount&#x3D; 2 Cls&#x3D;02(comm.) Sub&#x3D;0e Prot&#x3D;00
    > I:* If#&#x3D; 0 Alt&#x3D; 0 #EPs&#x3D; 1 Cls&#x3D;02(comm.) Sub&#x3D;0e Prot&#x3D;00 Driver&#x3D;cdc_mbim
    > E:  Ad&#x3D;82(I) Atr&#x3D;03(Int.) MxPS&#x3D;  64 Ivl&#x3D;32ms
    > I:  If#&#x3D; 1 Alt&#x3D; 0 #EPs&#x3D; 0 Cls&#x3D;0a(data ) Sub&#x3D;00 Prot&#x3D;02 Driver&#x3D;cdc_mbim
    > I:* If#&#x3D; 1 Alt&#x3D; 1 #EPs&#x3D; 2 Cls&#x3D;0a(data ) Sub&#x3D;00 Prot&#x3D;02 Driver&#x3D;cdc_mbim
    > E:  Ad&#x3D;81(I) Atr&#x3D;02(Bulk) MxPS&#x3D; 512 Ivl&#x3D;0ms
    > E:  Ad&#x3D;01(O) Atr&#x3D;02(Bulk) MxPS&#x3D; 512 Ivl&#x3D;0ms
    > I:* If#&#x3D; 2 Alt&#x3D; 0 #EPs&#x3D; 2 Cls&#x3D;ff(vend.) Sub&#x3D;00 Prot&#x3D;00 Driver&#x3D;option
    > E:  Ad&#x3D;83(I) Atr&#x3D;02(Bulk) MxPS&#x3D; 512 Ivl&#x3D;0ms
    > E:  Ad&#x3D;02(O) Atr&#x3D;02(Bulk) MxPS&#x3D; 512 Ivl&#x3D;0ms
    > I:* If#&#x3D; 3 Alt&#x3D; 0 #EPs&#x3D; 2 Cls&#x3D;ff(vend.) Sub&#x3D;00 Prot&#x3D;00 Driver&#x3D;option
    > E:  Ad&#x3D;84(I) Atr&#x3D;02(Bulk) MxPS&#x3D; 512 Ivl&#x3D;0ms
    > E:  Ad&#x3D;03(O) Atr&#x3D;02(Bulk) MxPS&#x3D; 512 Ivl&#x3D;0ms
    > I:* If#&#x3D; 4 Alt&#x3D; 0 #EPs&#x3D; 2 Cls&#x3D;ff(vend.) Sub&#x3D;00 Prot&#x3D;00 Driver&#x3D;option
    > E:  Ad&#x3D;85(I) Atr&#x3D;02(Bulk) MxPS&#x3D; 512 Ivl&#x3D;0ms
    > E:  Ad&#x3D;04(O) Atr&#x3D;02(Bulk) MxPS&#x3D; 512 Ivl&#x3D;0ms
    > I:* If#&#x3D; 5 Alt&#x3D; 0 #EPs&#x3D; 2 Cls&#x3D;ff(vend.) Sub&#x3D;42 Prot&#x3D;01 Driver&#x3D;(none)
    > E:  Ad&#x3D;86(I) Atr&#x3D;02(Bulk) MxPS&#x3D; 512 Ivl&#x3D;0ms
    > E:  Ad&#x3D;05(O) Atr&#x3D;02(Bulk) MxPS&#x3D; 512 Ivl&#x3D;0ms
    > I:* If#&#x3D; 6 Alt&#x3D; 0 #EPs&#x3D; 2 Cls&#x3D;ff(vend.) Sub&#x3D;00 Prot&#x3D;00 Driver&#x3D;option
    > E:  Ad&#x3D;87(I) Atr&#x3D;02(Bulk) MxPS&#x3D; 512 Ivl&#x3D;0ms
    > E:  Ad&#x3D;06(O) Atr&#x3D;02(Bulk) MxPS&#x3D; 512 Ivl&#x3D;0ms
    > I:* If#&#x3D; 7 Alt&#x3D; 0 #EPs&#x3D; 2 Cls&#x3D;ff(vend.) Sub&#x3D;00 Prot&#x3D;00 Driver&#x3D;option
    > E:  Ad&#x3D;88(I) Atr&#x3D;02(Bulk) MxPS&#x3D; 512 Ivl&#x3D;0ms
    > E:  Ad&#x3D;07(O) Atr&#x3D;02(Bulk) MxPS&#x3D; 512 Ivl&#x3D;0ms
    > I:* If#&#x3D; 8 Alt&#x3D; 0 #EPs&#x3D; 2 Cls&#x3D;ff(vend.) Sub&#x3D;00 Prot&#x3D;00 Driver&#x3D;option
    > E:  Ad&#x3D;89(I) Atr&#x3D;02(Bulk) MxPS&#x3D; 512 Ivl&#x3D;0ms
    > E:  Ad&#x3D;08(O) Atr&#x3D;02(Bulk) MxPS&#x3D; 512 Ivl&#x3D;0ms
    > I:* If#&#x3D; 9 Alt&#x3D; 0 #EPs&#x3D; 2 Cls&#x3D;ff(vend.) Sub&#x3D;00 Prot&#x3D;00 Driver&#x3D;option
    > E:  Ad&#x3D;8a(I) Atr&#x3D;02(Bulk) MxPS&#x3D; 512 Ivl&#x3D;0ms
    > E:  Ad&#x3D;09(O) Atr&#x3D;02(Bulk) MxPS&#x3D; 512 Ivl&#x3D;0ms
    > -------------------------------
    > | If Number | Function        |
    > -------------------------------
    > | 2         | USB AP Log Port |
    > -------------------------------
    > | 3         | USB AP GNSS Port|
    > -------------------------------
    > | 4         | USB AP META Port|
    > -------------------------------
    > | 5         | ADB port        |
    > -------------------------------
    > | 6         | USB MD AT Port  |
    > ------------------------------
    > | 7         | USB MD META Port|
    > -------------------------------
    > | 8         | USB NTZ Port    |
    > -------------------------------
    > | 9         | USB Debug port  |
    > -------------------------------
    > Signed-off-by: Jack Wu &lt;wojackbb@gmail.com&gt;
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Johan Hovold &lt;johan@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ USB: serial: option: add MeiG Smart SLM770A (@Michal Hrusecky in [121b84c987e2c80](https://github.com/sophgo/linux-riscv/commit/121b84c987e2c80) at 2024-12-27 13:02:08)
    > commit 724d461e44dfc0815624d2a9792f2f2beb7ee46d upstream.
    > Update the USB serial option driver to support MeiG Smart SLM770A.
    > ID 2dee:4d57 Marvell Mobile Composite Device Bus
    > T:  Bus&#x3D;02 Lev&#x3D;01 Prnt&#x3D;01 Port&#x3D;00 Cnt&#x3D;01 Dev#&#x3D;  2 Spd&#x3D;480  MxCh&#x3D; 0
    > D:  Ver&#x3D; 2.00 Cls&#x3D;ef(misc ) Sub&#x3D;02 Prot&#x3D;01 MxPS&#x3D;64 #Cfgs&#x3D;  1
    > P:  Vendor&#x3D;2dee ProdID&#x3D;4d57 Rev&#x3D; 1.00
    > S:  Manufacturer&#x3D;Marvell
    > S:  Product&#x3D;Mobile Composite Device Bus
    > C:* #Ifs&#x3D; 6 Cfg#&#x3D; 1 Atr&#x3D;c0 MxPwr&#x3D;500mA
    > A:  FirstIf#&#x3D; 0 IfCount&#x3D; 2 Cls&#x3D;e0(wlcon) Sub&#x3D;01 Prot&#x3D;03
    > I:* If#&#x3D; 0 Alt&#x3D; 0 #EPs&#x3D; 1 Cls&#x3D;e0(wlcon) Sub&#x3D;01 Prot&#x3D;03 Driver&#x3D;rndis_host
    > E:  Ad&#x3D;87(I) Atr&#x3D;03(Int.) MxPS&#x3D;  64 Ivl&#x3D;4096ms
    > I:* If#&#x3D; 1 Alt&#x3D; 0 #EPs&#x3D; 2 Cls&#x3D;0a(data ) Sub&#x3D;00 Prot&#x3D;00 Driver&#x3D;rndis_host
    > E:  Ad&#x3D;83(I) Atr&#x3D;02(Bulk) MxPS&#x3D; 512 Ivl&#x3D;0ms
    > E:  Ad&#x3D;0c(O) Atr&#x3D;02(Bulk) MxPS&#x3D; 512 Ivl&#x3D;0ms
    > I:* If#&#x3D; 2 Alt&#x3D; 0 #EPs&#x3D; 2 Cls&#x3D;ff(vend.) Sub&#x3D;00 Prot&#x3D;00 Driver&#x3D;option
    > E:  Ad&#x3D;82(I) Atr&#x3D;02(Bulk) MxPS&#x3D; 512 Ivl&#x3D;0ms
    > E:  Ad&#x3D;0b(O) Atr&#x3D;02(Bulk) MxPS&#x3D; 512 Ivl&#x3D;0ms
    > I:* If#&#x3D; 3 Alt&#x3D; 0 #EPs&#x3D; 3 Cls&#x3D;ff(vend.) Sub&#x3D;00 Prot&#x3D;00 Driver&#x3D;option
    > E:  Ad&#x3D;88(I) Atr&#x3D;03(Int.) MxPS&#x3D;  64 Ivl&#x3D;4096ms
    > E:  Ad&#x3D;81(I) Atr&#x3D;02(Bulk) MxPS&#x3D; 512 Ivl&#x3D;0ms
    > E:  Ad&#x3D;0a(O) Atr&#x3D;02(Bulk) MxPS&#x3D; 512 Ivl&#x3D;0ms
    > I:* If#&#x3D; 4 Alt&#x3D; 0 #EPs&#x3D; 3 Cls&#x3D;ff(vend.) Sub&#x3D;00 Prot&#x3D;00 Driver&#x3D;option
    > E:  Ad&#x3D;89(I) Atr&#x3D;03(Int.) MxPS&#x3D;  64 Ivl&#x3D;4096ms
    > E:  Ad&#x3D;86(I) Atr&#x3D;02(Bulk) MxPS&#x3D; 512 Ivl&#x3D;0ms
    > E:  Ad&#x3D;0f(O) Atr&#x3D;02(Bulk) MxPS&#x3D; 512 Ivl&#x3D;0ms
    > I:* If#&#x3D; 5 Alt&#x3D; 0 #EPs&#x3D; 2 Cls&#x3D;ff(vend.) Sub&#x3D;00 Prot&#x3D;00 Driver&#x3D;option
    > E:  Ad&#x3D;85(I) Atr&#x3D;02(Bulk) MxPS&#x3D; 512 Ivl&#x3D;0ms
    > E:  Ad&#x3D;0e(O) Atr&#x3D;02(Bulk) MxPS&#x3D; 512 Ivl&#x3D;0ms
    > Tested successfully connecting to the Internet via rndis interface after
    > dialing via AT commands on If#&#x3D;3 or If#&#x3D;4.
    > Not sure of the purpose of the other serial interfaces.
    > Signed-off-by: Michal Hrusecky &lt;michal.hrusecky@turris.com&gt;
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Johan Hovold &lt;johan@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ efivarfs: Fix error on non-existent file (@James Bottomley in [dedea26a149f7fa](https://github.com/sophgo/linux-riscv/commit/dedea26a149f7fa) at 2024-12-27 13:02:07)
    > commit 2ab0837cb91b7de507daa145d17b3b6b2efb3abf upstream.
    > When looking up a non-existent file, efivarfs returns -EINVAL if the
    > file does not conform to the NAME-GUID format and -ENOENT if it does.
    > This is caused by efivars_d_hash() returning -EINVAL if the name is not
    > formatted correctly.  This error is returned before simple_lookup()
    > returns a negative dentry, and is the error value that the user sees.
    > Fix by removing this check.  If the file does not exist, simple_lookup()
    > will return a negative dentry leading to -ENOENT and efivarfs_create()
    > already has a validity check before it creates an entry (and will
    > correctly return -EINVAL)
    > Signed-off-by: James Bottomley &lt;James.Bottomley@HansenPartnership.com&gt;
    > Cc: &lt;stable@vger.kernel.org&gt;
    > [ardb: make efivarfs_valid_name() static]
    > Signed-off-by: Ard Biesheuvel &lt;ardb@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ KVM: x86: Cache CPUID.0xD XSTATE offsets+sizes during module init (@Sean Christopherson in [b965edb0197ae36](https://github.com/sophgo/linux-riscv/commit/b965edb0197ae36) at 2024-12-27 13:02:07)
    > commit 1201f226c863b7da739f7420ddba818cedf372fc upstream.
    > Snapshot the output of CPUID.0xD.[1..n] during kvm.ko initiliaization to
    > avoid the overead of CPUID during runtime.  The offset, size, and metadata
    > for CPUID.0xD.[1..n] sub-leaves does not depend on XCR0 or XSS values, i.e.
    > is constant for a given CPU, and thus can be cached during module load.
    > On Intel&#x27;s Emerald Rapids, CPUID is *wildly* expensive, to the point where
    > recomputing XSAVE offsets and sizes results in a 4x increase in latency of
    > nested VM-Enter and VM-Exit (nested transitions can trigger
    > xstate_required_size() multiple times per transition), relative to using
    > cached values.  The issue is easily visible by running &#x60;perf top&#x60; while
    > triggering nested transitions: kvm_update_cpuid_runtime() shows up at a
    > whopping 50%.
    > As measured via RDTSC from L2 (using KVM-Unit-Test&#x27;s CPUID VM-Exit test
    > and a slightly modified L1 KVM to handle CPUID in the fastpath), a nested
    > roundtrip to emulate CPUID on Skylake (SKX), Icelake (ICX), and Emerald
    > Rapids (EMR) takes:
    > SKX 11650
    > ICX 22350
    > EMR 28850
    > Using cached values, the latency drops to:
    > SKX 6850
    > ICX 9000
    > EMR 7900
    > The underlying issue is that CPUID itself is slow on ICX, and comically
    > slow on EMR.  The problem is exacerbated on CPUs which support XSAVES
    > and/or XSAVEC, as KVM invokes xstate_required_size() twice on each
    > runtime CPUID update, and because there are more supported XSAVE features
    > (CPUID for supported XSAVE feature sub-leafs is significantly slower).
    > SKX:
    > CPUID.0xD.2  &#x3D; 348 cycles
    > CPUID.0xD.3  &#x3D; 400 cycles
    > CPUID.0xD.4  &#x3D; 276 cycles
    > CPUID.0xD.5  &#x3D; 236 cycles
    > &lt;other sub-leaves are similar&gt;
    > EMR:
    > CPUID.0xD.2  &#x3D; 1138 cycles
    > CPUID.0xD.3  &#x3D; 1362 cycles
    > CPUID.0xD.4  &#x3D; 1068 cycles
    > CPUID.0xD.5  &#x3D; 910 cycles
    > CPUID.0xD.6  &#x3D; 914 cycles
    > CPUID.0xD.7  &#x3D; 1350 cycles
    > CPUID.0xD.8  &#x3D; 734 cycles
    > CPUID.0xD.9  &#x3D; 766 cycles
    > CPUID.0xD.10 &#x3D; 732 cycles
    > CPUID.0xD.11 &#x3D; 718 cycles
    > CPUID.0xD.12 &#x3D; 734 cycles
    > CPUID.0xD.13 &#x3D; 1700 cycles
    > CPUID.0xD.14 &#x3D; 1126 cycles
    > CPUID.0xD.15 &#x3D; 898 cycles
    > CPUID.0xD.16 &#x3D; 716 cycles
    > CPUID.0xD.17 &#x3D; 748 cycles
    > CPUID.0xD.18 &#x3D; 776 cycles
    > Note, updating runtime CPUID information multiple times per nested
    > transition is itself a flaw, especially since CPUID is a mandotory
    > intercept on both Intel and AMD.  E.g. KVM doesn&#x27;t need to ensure emulated
    > CPUID state is up-to-date while running L2.  That flaw will be fixed in a
    > future patch, as deferring runtime CPUID updates is more subtle than it
    > appears at first glance, the benefits aren&#x27;t super critical to have once
    > the XSAVE issue is resolved, and caching CPUID output is desirable even if
    > KVM&#x27;s updates are deferred.
    > Cc: Jim Mattson &lt;jmattson@google.com&gt;
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Sean Christopherson &lt;seanjc@google.com&gt;
    > Message-ID: &lt;20241211013302.1347853-2-seanjc@google.com&gt;
    > Signed-off-by: Paolo Bonzini &lt;pbonzini@redhat.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ net: mctp: handle skb cleanup on sock_queue failures (@Jeremy Kerr in [b2b4eddf2f18836](https://github.com/sophgo/linux-riscv/commit/b2b4eddf2f18836) at 2024-12-27 13:02:07)
    > commit ce1219c3f76bb131d095e90521506d3c6ccfa086 upstream.
    > Currently, we don&#x27;t use the return value from sock_queue_rcv_skb, which
    > means we may leak skbs if a message is not successfully queued to a
    > socket.
    > Instead, ensure that we&#x27;re freeing the skb where the sock hasn&#x27;t
    > otherwise taken ownership of the skb by adding checks on the
    > sock_queue_rcv_skb() to invoke a kfree on failure.
    > In doing so, rather than using the &#x27;rc&#x27; value to trigger the
    > kfree_skb(), use the skb pointer itself, which is more explicit.
    > Also, add a kunit test for the sock delivery failure cases.
    > Fixes: 4a992bbd3650 (&quot;mctp: Implement message fragmentation &amp; reassembly&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Jeremy Kerr &lt;jk@codeconstruct.com.au&gt;
    > Link: https://patch.msgid.link/20241218-mctp-next-v2-1-1c1729645eaa@codeconstruct.com.au
    > Signed-off-by: Paolo Abeni &lt;pabeni@redhat.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ block: Revert &quot;block: Fix potential deadlock while freezing queue and acquiring sysfs_lock&quot; (@Ming Lei in [97701315e32ed1b](https://github.com/sophgo/linux-riscv/commit/97701315e32ed1b) at 2024-12-27 13:02:07)
    > commit 224749be6c23efe7fb8a030854f4fc5d1dd813b3 upstream.
    > This reverts commit be26ba96421ab0a8fa2055ccf7db7832a13c44d2.
    > Commit be26ba96421a (&quot;block: Fix potential deadlock while freezing queue and
    > acquiring sysfs_loc&quot;) actually reverts commit 22465bbac53c (&quot;blk-mq: move cpuhp
    > callback registering out of q-&gt;sysfs_lock&quot;), and causes the original resctrl
    > lockdep warning.
    > So revert it and we need to fix the issue in another way.
    > Cc: Nilay Shroff &lt;nilay@linux.ibm.com&gt;
    > Fixes: be26ba96421a (&quot;block: Fix potential deadlock while freezing queue and acquiring sysfs_loc&quot;)
    > Signed-off-by: Ming Lei &lt;ming.lei@redhat.com&gt;
    > Link: https://lore.kernel.org/r/20241218101617.3275704-2-ming.lei@redhat.com
    > Signed-off-by: Jens Axboe &lt;axboe@kernel.dk&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ chelsio/chtls: prevent potential integer overflow on 32bit (@Dan Carpenter in [7e1ad75dccf3f8d](https://github.com/sophgo/linux-riscv/commit/7e1ad75dccf3f8d) at 2024-12-27 13:02:07)
    > commit fbbd84af6ba70334335bdeba3ae536cf751c14c6 upstream.
    > The &quot;gl-&gt;tot_len&quot; variable is controlled by the user.  It comes from
    > process_responses().  On 32bit systems, the &quot;gl-&gt;tot_len +
    > sizeof(struct cpl_pass_accept_req) + sizeof(struct rss_header)&quot; addition
    > could have an integer wrapping bug.  Use size_add() to prevent this.
    > Fixes: a08943947873 (&quot;crypto: chtls - Register chtls with net tls&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Dan Carpenter &lt;dan.carpenter@linaro.org&gt;
    > Reviewed-by: Simon Horman &lt;horms@kernel.org&gt;
    > Link: https://patch.msgid.link/c6bfb23c-2db2-4e1b-b8ab-ba3925c82ef5@stanley.mountain
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ net: tun: fix tun_napi_alloc_frags() (@Eric Dumazet in [4f393ea1e2f9c3b](https://github.com/sophgo/linux-riscv/commit/4f393ea1e2f9c3b) at 2024-12-27 13:02:07)
    > commit 429fde2d81bcef0ebab002215358955704586457 upstream.
    > syzbot reported the following crash [1]
    > Issue came with the blamed commit. Instead of going through
    > all the iov components, we keep using the first one
    > and end up with a malformed skb.
    > [1]
    > kernel BUG at net/core/skbuff.c:2849 !
    > Oops: invalid opcode: 0000 [#1] PREEMPT SMP KASAN PTI
    > CPU: 0 UID: 0 PID: 6230 Comm: syz-executor132 Not tainted 6.13.0-rc1-syzkaller-00407-g96b6fcc0ee41 #0
    > Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 11/25/2024
    > RIP: 0010:__pskb_pull_tail+0x1568/0x1570 net/core/skbuff.c:2848
    > Code: 38 c1 0f 8c 32 f1 ff ff 4c 89 f7 e8 92 96 74 f8 e9 25 f1 ff ff e8 e8 ae 09 f8 48 8b 5c 24 08 e9 eb fb ff ff e8 d9 ae 09 f8 90 &lt;0f&gt; 0b 66 0f 1f 44 00 00 90 90 90 90 90 90 90 90 90 90 90 90 90 90
    > RSP: 0018:ffffc90004cbef30 EFLAGS: 00010293
    > RAX: ffffffff8995c347 RBX: 00000000fffffff2 RCX: ffff88802cf45a00
    > RDX: 0000000000000000 RSI: 00000000fffffff2 RDI: 0000000000000000
    > RBP: ffff88807df0c06a R08: ffffffff8995b084 R09: 1ffff1100fbe185c
    > R10: dffffc0000000000 R11: ffffed100fbe185d R12: ffff888076e85d50
    > R13: ffff888076e85c80 R14: ffff888076e85cf4 R15: ffff888076e85c80
    > FS:  00007f0dca6ea6c0(0000) GS:ffff8880b8600000(0000) knlGS:0000000000000000
    > CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
    > CR2: 00007f0dca6ead58 CR3: 00000000119da000 CR4: 00000000003526f0
    > DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
    > DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
    > Call Trace:
    > &lt;TASK&gt;
    > skb_cow_data+0x2da/0xcb0 net/core/skbuff.c:5284
    > tipc_aead_decrypt net/tipc/crypto.c:894 [inline]
    > tipc_crypto_rcv+0x402/0x24e0 net/tipc/crypto.c:1844
    > tipc_rcv+0x57e/0x12a0 net/tipc/node.c:2109
    > tipc_l2_rcv_msg+0x2bd/0x450 net/tipc/bearer.c:668
    > __netif_receive_skb_list_ptype net/core/dev.c:5720 [inline]
    > __netif_receive_skb_list_core+0x8b7/0x980 net/core/dev.c:5762
    > __netif_receive_skb_list net/core/dev.c:5814 [inline]
    > netif_receive_skb_list_internal+0xa51/0xe30 net/core/dev.c:5905
    > gro_normal_list include/net/gro.h:515 [inline]
    > napi_complete_done+0x2b5/0x870 net/core/dev.c:6256
    > napi_complete include/linux/netdevice.h:567 [inline]
    > tun_get_user+0x2ea0/0x4890 drivers/net/tun.c:1982
    > tun_chr_write_iter+0x10d/0x1f0 drivers/net/tun.c:2057
    > do_iter_readv_writev+0x600/0x880
    > vfs_writev+0x376/0xba0 fs/read_write.c:1050
    > do_writev+0x1b6/0x360 fs/read_write.c:1096
    > do_syscall_x64 arch/x86/entry/common.c:52 [inline]
    > do_syscall_64+0xf3/0x230 arch/x86/entry/common.c:83
    > entry_SYSCALL_64_after_hwframe+0x77/0x7f
    > Fixes: de4f5fed3f23 (&quot;iov_iter: add iter_iovec() helper&quot;)
    > Reported-by: syzbot+4f66250f6663c0c1d67e@syzkaller.appspotmail.com
    > Closes: https://lore.kernel.org/netdev/675b61aa.050a0220.599f4.00bb.GAE@google.com/T/#u
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Eric Dumazet &lt;edumazet@google.com&gt;
    > Reviewed-by: Joe Damato &lt;jdamato@fastly.com&gt;
    > Reviewed-by: Jens Axboe &lt;axboe@kernel.dk&gt;
    > Acked-by: Willem de Bruijn &lt;willemb@google.com&gt;
    > Acked-by: Michael S. Tsirkin &lt;mst@redhat.com&gt;
    > Link: https://patch.msgid.link/20241212222247.724674-1-edumazet@google.com
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ i2c: riic: Always round-up when calculating bus period (@Geert Uytterhoeven in [065b3e27e45d77e](https://github.com/sophgo/linux-riscv/commit/065b3e27e45d77e) at 2024-12-27 13:02:07)
    > commit de6b43798d9043a7c749a0428dbb02d5fff156e5 upstream.
    > Currently, the RIIC driver may run the I2C bus faster than requested,
    > which may cause subtle failures.  E.g. Biju reported a measured bus
    > speed of 450 kHz instead of the expected maximum of 400 kHz on RZ/G2L.
    > The initial calculation of the bus period uses DIV_ROUND_UP(), to make
    > sure the actual bus speed never becomes faster than the requested bus
    > speed.  However, the subsequent division-by-two steps do not use
    > round-up, which may lead to a too-small period, hence a too-fast and
    > possible out-of-spec bus speed.  E.g. on RZ/Five, requesting a bus speed
    > of 100 resp. 400 kHz will yield too-fast target bus speeds of 100806
    > resp. 403226 Hz instead of 97656 resp. 390625 Hz.
    > Fix this by using DIV_ROUND_UP() in the subsequent divisions, too.
    > Tested on RZ/A1H, RZ/A2M, and RZ/Five.
    > Fixes: d982d66514192cdb (&quot;i2c: riic: remove clock and frequency restrictions&quot;)
    > Reported-by: Biju Das &lt;biju.das.jz@bp.renesas.com&gt;
    > Signed-off-by: Geert Uytterhoeven &lt;geert+renesas@glider.be&gt;
    > Cc: &lt;stable@vger.kernel.org&gt; # v4.15+
    > Link: https://lore.kernel.org/r/c59aea77998dfea1b4456c4b33b55ab216fcbf5e.1732284746.git.geert+renesas@glider.be
    > Signed-off-by: Andi Shyti &lt;andi.shyti@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ KVM: arm64: Do not allow ID_AA64MMFR0_EL1.ASIDbits to be overridden (@Marc Zyngier in [ea78f77f7832fd4](https://github.com/sophgo/linux-riscv/commit/ea78f77f7832fd4) at 2024-12-27 13:02:06)
    > commit 03c7527e97f73081633d773f9f8c2373f9854b25 upstream.
    > Catalin reports that a hypervisor lying to a guest about the size
    > of the ASID field may result in unexpected issues:
    > - if the underlying HW does only supports 8 bit ASIDs, the ASID
    > field in a TLBI VAE1* operation is only 8 bits, and the HW will
    > ignore the other 8 bits
    > - if on the contrary the HW is 16 bit capable, the ASID field
    > in the same TLBI operation is always 16 bits, irrespective of
    > the value of TCR_ELx.AS.
    > This could lead to missed invalidations if the guest was lead to
    > assume that the HW had 8 bit ASIDs while they really are 16 bit wide.
    > In order to avoid any potential disaster that would be hard to debug,
    > prenent the migration between a host with 8 bit ASIDs to one with
    > wider ASIDs (the converse was obviously always forbidden). This is
    > also consistent with what we already do for VMIDs.
    > If it becomes absolutely mandatory to support such a migration path
    > in the future, we will have to trap and emulate all TLBIs, something
    > that nobody should look forward to.
    > Fixes: d5a32b60dc18 (&quot;KVM: arm64: Allow userspace to change ID_AA64MMFR{0-2}_EL1&quot;)
    > Reported-by: Catalin Marinas &lt;catalin.marinas@arm.com&gt;
    > Signed-off-by: Marc Zyngier &lt;maz@kernel.org&gt;
    > Cc: stable@vger.kernel.org
    > Cc: Will Deacon &lt;will@kernel.org&gt;
    > Cc: Mark Rutland &lt;mark.rutland@arm.com&gt;
    > Cc: Marc Zyngier &lt;maz@kernel.org&gt;
    > Cc: James Morse &lt;james.morse@arm.com&gt;
    > Cc: Oliver Upton &lt;oliver.upton@linux.dev&gt;
    > Acked-by: Catalin Marinas &lt;catalin.marinas@arm.com&gt;
    > Link: https://lore.kernel.org/r/20241203190236.505759-1-maz@kernel.org
    > Signed-off-by: Oliver Upton &lt;oliver.upton@linux.dev&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ mmc: sdhci-tegra: Remove SDHCI_QUIRK_BROKEN_ADMA_ZEROLEN_DESC quirk (@Prathamesh Shete in [b2dc310a5591a88](https://github.com/sophgo/linux-riscv/commit/b2dc310a5591a88) at 2024-12-27 13:02:06)
    > commit a56335c85b592cb2833db0a71f7112b7d9f0d56b upstream.
    > Value 0 in ADMA length descriptor is interpreted as 65536 on new Tegra
    > chips, remove SDHCI_QUIRK_BROKEN_ADMA_ZEROLEN_DESC quirk to make sure max
    > ADMA2 length is 65536.
    > Fixes: 4346b7c7941d (&quot;mmc: tegra: Add Tegra186 support&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Prathamesh Shete &lt;pshete@nvidia.com&gt;
    > Acked-by: Thierry Reding &lt;treding@nvidia.com&gt;
    > Acked-by: Adrian Hunter &lt;adrian.hunter@intel.com&gt;
    > Message-ID: &lt;20241209101009.22710-1-pshete@nvidia.com&gt;
    > Signed-off-by: Ulf Hansson &lt;ulf.hansson@linaro.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ net: mdiobus: fix an OF node reference leak (@Joe Hattori in [aa9e573145e2967](https://github.com/sophgo/linux-riscv/commit/aa9e573145e2967) at 2024-12-27 13:02:06)
    > [ Upstream commit 572af9f284669d31d9175122bbef9bc62cea8ded ]
    > fwnode_find_mii_timestamper() calls of_parse_phandle_with_fixed_args()
    > but does not decrement the refcount of the obtained OF node. Add an
    > of_node_put() call before returning from the function.
    > This bug was detected by an experimental static analysis tool that I am
    > developing.
    > Fixes: bc1bee3b87ee (&quot;net: mdiobus: Introduce fwnode_mdiobus_register_phy()&quot;)
    > Signed-off-by: Joe Hattori &lt;joe@pf.is.s.u-tokyo.ac.jp&gt;
    > Reviewed-by: Andrew Lunn &lt;andrew@lunn.ch&gt;
    > Link: https://patch.msgid.link/20241218035106.1436405-1-joe@pf.is.s.u-tokyo.ac.jp
    > Signed-off-by: Paolo Abeni &lt;pabeni@redhat.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ psample: adjust size if rate_as_probability is set (@Adrian Moreno in [98031a6992c97ce](https://github.com/sophgo/linux-riscv/commit/98031a6992c97ce) at 2024-12-27 13:02:06)
    > [ Upstream commit 5eecd85c77a254a43bde3212da8047b001745c9f ]
    > If PSAMPLE_ATTR_SAMPLE_PROBABILITY flag is to be sent, the available
    > size for the packet data has to be adjusted accordingly.
    > Also, check the error code returned by nla_put_flag.
    > Fixes: 7b1b2b60c63f (&quot;net: psample: allow using rate as probability&quot;)
    > Signed-off-by: Adrian Moreno &lt;amorenoz@redhat.com&gt;
    > Reviewed-by: Aaron Conole &lt;aconole@redhat.com&gt;
    > Reviewed-by: Ido Schimmel &lt;idosch@nvidia.com&gt;
    > Link: https://patch.msgid.link/20241217113739.3929300-1-amorenoz@redhat.com
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ mmc: mtk-sd: disable wakeup in .remove() and in the error path of .probe() (@Joe Hattori in [2f19001192ccc20](https://github.com/sophgo/linux-riscv/commit/2f19001192ccc20) at 2024-12-27 13:02:06)
    > commit f3d87abe11ed04d1b23a474a212f0e5deeb50892 upstream.
    > Current implementation leaves pdev-&gt;dev as a wakeup source. Add a
    > device_init_wakeup(&amp;pdev-&gt;dev, false) call in the .remove() function and
    > in the error path of the .probe() function.
    > Signed-off-by: Joe Hattori &lt;joe@pf.is.s.u-tokyo.ac.jp&gt;
    > Fixes: 527f36f5efa4 (&quot;mmc: mediatek: add support for SDIO eint wakup IRQ&quot;)
    > Cc: stable@vger.kernel.org
    > Message-ID: &lt;20241203023442.2434018-1-joe@pf.is.s.u-tokyo.ac.jp&gt;
    > Signed-off-by: Ulf Hansson &lt;ulf.hansson@linaro.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ irqchip/gic-v3: Work around insecure GIC integrations (@Marc Zyngier in [20bf32f4828879c](https://github.com/sophgo/linux-riscv/commit/20bf32f4828879c) at 2024-12-27 13:02:06)
    > commit 773c05f417fa14e1ac94776619e9c978ec001f0b upstream.
    > It appears that the relatively popular RK3399 SoC has been put together
    > using a large amount of illicit substances, as experiments reveal that its
    > integration of GIC500 exposes the *secure* programming interface to
    > non-secure.
    > This has some pretty bad effects on the way priorities are handled, and
    > results in a dead machine if booting with pseudo-NMI enabled
    > (irqchip.gicv3_pseudo_nmi&#x3D;1) if the kernel contains 18fdb6348c480 (&quot;arm64:
    > irqchip/gic-v3: Select priorities at boot time&quot;), which relies on the
    > priorities being programmed using the NS view.
    > Let&#x27;s restore some sanity by going one step further and disable security
    > altogether in this case. This is not any worse, and puts us in a mode where
    > priorities actually make some sense.
    > Huge thanks to Mark Kettenis who initially identified this issue on
    > OpenBSD, and to Chen-Yu Tsai who reported the problem in Linux.
    > Fixes: 18fdb6348c480 (&quot;arm64: irqchip/gic-v3: Select priorities at boot time&quot;)
    > Reported-by: Mark Kettenis &lt;mark.kettenis@xs4all.nl&gt;
    > Reported-by: Chen-Yu Tsai &lt;wens@csie.org&gt;
    > Signed-off-by: Marc Zyngier &lt;maz@kernel.org&gt;
    > Signed-off-by: Thomas Gleixner &lt;tglx@linutronix.de&gt;
    > Tested-by: Chen-Yu Tsai &lt;wens@csie.org&gt;
    > Cc: stable@vger.kernel.org
    > Link: https://lore.kernel.org/all/20241213141037.3995049-1-maz@kernel.org
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ EDAC/amd64: Simplify ECC check on unified memory controllers (@Borislav Petkov (AMD) in [06e21320582653c](https://github.com/sophgo/linux-riscv/commit/06e21320582653c) at 2024-12-27 13:02:06)
    > commit 747367340ca6b5070728b86ae36ad6747f66b2fb upstream.
    > The intent of the check is to see whether at least one UMC has ECC
    > enabled. So do that instead of tracking which ones are enabled in masks
    > which are too small in size anyway and lead to not loading the driver on
    > Zen4 machines with UMCs enabled over UMC8.
    > Fixes: e2be5955a886 (&quot;EDAC/amd64: Add support for AMD Family 19h Models 10h-1Fh and A0h-AFh&quot;)
    > Reported-by: Avadhut Naik &lt;avadhut.naik@amd.com&gt;
    > Signed-off-by: Borislav Petkov (AMD) &lt;bp@alien8.de&gt;
    > Tested-by: Avadhut Naik &lt;avadhut.naik@amd.com&gt;
    > Reviewed-by: Avadhut Naik &lt;avadhut.naik@amd.com&gt;
    > Cc: &lt;stable@kernel.org&gt;
    > Link: https://lore.kernel.org/r/20241210212054.3895697-1-avadhut.naik@amd.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ ipvs: Fix clamp() of ip_vs_conn_tab on small memory systems (@David Laight in [d2e6df65ecfba4c](https://github.com/sophgo/linux-riscv/commit/d2e6df65ecfba4c) at 2024-12-27 13:02:05)
    > [ Upstream commit cf2c97423a4f89c8b798294d3f34ecfe7e7035c3 ]
    > The &#x27;max_avail&#x27; value is calculated from the system memory
    > size using order_base_2().
    > order_base_2(x) is defined as &#x27;(x) ? fn(x) : 0&#x27;.
    > The compiler generates two copies of the code that follows
    > and then expands clamp(max, min, PAGE_SHIFT - 12) (11 on 32bit).
    > This triggers a compile-time assert since min is 5.
    > In reality a system would have to have less than 512MB memory
    > for the bounds passed to clamp to be reversed.
    > Swap the order of the arguments to clamp() to avoid the warning.
    > Replace the clamp_val() on the line below with clamp().
    > clamp_val() is just &#x27;an accident waiting to happen&#x27; and not needed here.
    > Detected by compile time checks added to clamp(), specifically:
    > minmax.h: use BUILD_BUG_ON_MSG() for the lo &lt; hi test in clamp()
    > Reported-by: Linux Kernel Functional Testing &lt;lkft@linaro.org&gt;
    > Closes: https://lore.kernel.org/all/CA+G9fYsT34UkGFKxus63H6UVpYi5GRZkezT9MRLfAbM3f6ke0g@mail.gmail.com/
    > Fixes: 4f325e26277b (&quot;ipvs: dynamically limit the connection hash table&quot;)
    > Tested-by: Bartosz Golaszewski &lt;bartosz.golaszewski@linaro.org&gt;
    > Reviewed-by: Bartosz Golaszewski &lt;bartosz.golaszewski@linaro.org&gt;
    > Signed-off-by: David Laight &lt;david.laight@aculab.com&gt;
    > Acked-by: Julian Anastasov &lt;ja@ssi.bg&gt;
    > Signed-off-by: Pablo Neira Ayuso &lt;pablo@netfilter.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ selftests: openvswitch: fix tcpdump execution (@Adrian Moreno in [cb82774ee7213ad](https://github.com/sophgo/linux-riscv/commit/cb82774ee7213ad) at 2024-12-27 13:02:05)
    > [ Upstream commit a17975992cc11588767175247ccaae1213a8b582 ]
    > Fix the way tcpdump is executed by:
    > - Using the right variable for the namespace. Currently the use of the
    > empty &quot;ns&quot; makes the command fail.
    > - Waiting until it starts to capture to ensure the interesting traffic
    > is caught on slow systems.
    > - Using line-buffered output to ensure logs are available when the test
    > is paused with &quot;-p&quot;. Otherwise the last chunk of data might only be
    > written when tcpdump is killed.
    > Fixes: 74cc26f416b9 (&quot;selftests: openvswitch: add interface support&quot;)
    > Signed-off-by: Adrian Moreno &lt;amorenoz@redhat.com&gt;
    > Acked-by: Eelco Chaudron &lt;echaudro@redhat.com&gt;
    > Link: https://patch.msgid.link/20241217211652.483016-1-amorenoz@redhat.com
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ netfilter: ipset: Fix for recursive locking warning (@Phil Sutter in [8fe8bffbb997db5](https://github.com/sophgo/linux-riscv/commit/8fe8bffbb997db5) at 2024-12-27 13:02:05)
    > [ Upstream commit 70b6f46a4ed8bd56c85ffff22df91e20e8c85e33 ]
    > With CONFIG_PROVE_LOCKING, when creating a set of type bitmap:ip, adding
    > it to a set of type list:set and populating it from iptables SET target
    > triggers a kernel warning:
    > | WARNING: possible recursive locking detected
    > | 6.12.0-rc7-01692-g5e9a28f41134-dirty #594 Not tainted
    > | --------------------------------------------
    > | ping/4018 is trying to acquire lock:
    > | ffff8881094a6848 (&amp;set-&gt;lock){+.-.}-{2:2}, at: ip_set_add+0x28c/0x360 [ip_set]
    > |
    > | but task is already holding lock:
    > | ffff88811034c048 (&amp;set-&gt;lock){+.-.}-{2:2}, at: ip_set_add+0x28c/0x360 [ip_set]
    > This is a false alarm: ipset does not allow nested list:set type, so the
    > loop in list_set_kadd() can never encounter the outer set itself. No
    > other set type supports embedded sets, so this is the only case to
    > consider.
    > To avoid the false report, create a distinct lock class for list:set
    > type ipset locks.
    > Fixes: f830837f0eed (&quot;netfilter: ipset: list:set set type support&quot;)
    > Signed-off-by: Phil Sutter &lt;phil@nwl.cc&gt;
    > Signed-off-by: Pablo Neira Ayuso &lt;pablo@netfilter.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ net: dsa: restore dsa_software_vlan_untag() ability to operate on VLAN-untagged traffic (@Vladimir Oltean in [67814ea2d1b0a3c](https://github.com/sophgo/linux-riscv/commit/67814ea2d1b0a3c) at 2024-12-27 13:02:05)
    > [ Upstream commit 16f027cd40eeedd2325f7e720689462ca8d9d13e ]
    > Robert Hodaszi reports that locally terminated traffic towards
    > VLAN-unaware bridge ports is broken with ocelot-8021q. He is describing
    > the same symptoms as for commit 1f9fc48fd302 (&quot;net: dsa: sja1105: fix
    > reception from VLAN-unaware bridges&quot;).
    > For context, the set merged as &quot;VLAN fixes for Ocelot driver&quot;:
    > https://lore.kernel.org/netdev/20240815000707.2006121-1-vladimir.oltean@nxp.com/
    > was developed in a slightly different form earlier this year, in January.
    > Initially, the switch was unconditionally configured to set OCELOT_ES0_TAG
    > when using ocelot-8021q, regardless of port operating mode.
    > This led to the situation where VLAN-unaware bridge ports would always
    > push their PVID - see ocelot_vlan_unaware_pvid() - a negligible value
    > anyway - into RX packets. To strip this in software, we would have needed
    > DSA to know what private VID the switch chose for VLAN-unaware bridge
    > ports, and pushed into the packets. This was implemented downstream, and
    > a remnant of it remains in the form of a comment mentioning
    > ds-&gt;ops-&gt;get_private_vid(), as something which would maybe need to be
    > considered in the future.
    > However, for upstream, it was deemed inappropriate, because it would
    > mean introducing yet another behavior for stripping VLAN tags from
    > VLAN-unaware bridge ports, when one already existed (ds-&gt;untag_bridge_pvid).
    > The latter has been marked as obsolete along with an explanation why it
    > is logically broken, but still, it would have been confusing.
    > So, for upstream, felix_update_tag_8021q_rx_rule() was developed, which
    > essentially changed the state of affairs from &quot;Felix with ocelot-8021q
    > delivers all packets as VLAN-tagged towards the CPU&quot; into &quot;Felix with
    > ocelot-8021q delivers all packets from VLAN-aware bridge ports towards
    > the CPU&quot;. This was done on the premise that in VLAN-unaware mode,
    > there&#x27;s nothing useful in the VLAN tags, and we can avoid introducing
    > ds-&gt;ops-&gt;get_private_vid() in the DSA receive path if we configure the
    > switch to not push those VLAN tags into packets in the first place.
    > Unfortunately, and this is when the trainwreck started, the selftests
    > developed initially and posted with the series were not re-ran.
    > dsa_software_vlan_untag() was initially written given the assumption
    > that users of this feature would send _all_ traffic as VLAN-tagged.
    > It was only partially adapted to the new scheme, by removing
    > ds-&gt;ops-&gt;get_private_vid(), which also used to be necessary in
    > standalone ports mode.
    > Where the trainwreck became even worse is that I had a second opportunity
    > to think about this, when the dsa_software_vlan_untag() logic change
    > initially broke sja1105, in commit 1f9fc48fd302 (&quot;net: dsa: sja1105: fix
    > reception from VLAN-unaware bridges&quot;). I did not connect the dots that
    > it also breaks ocelot-8021q, for pretty much the same reason that not
    > all received packets will be VLAN-tagged.
    > To be compatible with the optimized Felix control path which runs
    > felix_update_tag_8021q_rx_rule() to only push VLAN tags when useful (in
    > VLAN-aware mode), we need to restore the old dsa_software_vlan_untag()
    > logic. The blamed commit introduced the assumption that
    > dsa_software_vlan_untag() will see only VLAN-tagged packets, assumption
    > which is false. What corrupts RX traffic is the fact that we call
    > skb_vlan_untag() on packets which are not VLAN-tagged in the first
    > place.
    > Fixes: 93e4649efa96 (&quot;net: dsa: provide a software untagging function on RX for VLAN-aware bridges&quot;)
    > Reported-by: Robert Hodaszi &lt;robert.hodaszi@digi.com&gt;
    > Closes: https://lore.kernel.org/netdev/20241215163334.615427-1-robert.hodaszi@digi.com/
    > Signed-off-by: Vladimir Oltean &lt;vladimir.oltean@nxp.com&gt;
    > Link: https://patch.msgid.link/20241216135059.1258266-1-vladimir.oltean@nxp.com
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ netdev-genl: avoid empty messages in queue dump (@Jakub Kicinski in [57ed6505ba70ff5](https://github.com/sophgo/linux-riscv/commit/57ed6505ba70ff5) at 2024-12-27 13:02:05)
    > [ Upstream commit 5eb70dbebf32c2fd1f2814c654ae17fc47d6e859 ]
    > Empty netlink responses from do() are not correct (as opposed to
    > dump() where not dumping anything is perfectly fine).
    > We should return an error if the target object does not exist,
    > in this case if the netdev is down it has no queues.
    > Fixes: 6b6171db7fc8 (&quot;netdev-genl: Add netlink framework functions for queue&quot;)
    > Reported-by: syzbot+0a884bc2d304ce4af70f@syzkaller.appspotmail.com
    > Reviewed-by: Eric Dumazet &lt;edumazet@google.com&gt;
    > Reviewed-by: Joe Damato &lt;jdamato@fastly.com&gt;
    > Link: https://patch.msgid.link/20241218022508.815344-1-kuba@kernel.org
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ can: m_can: set init flag earlier in probe (@Matthias Schiffer in [3a3696ec46cffbd](https://github.com/sophgo/linux-riscv/commit/3a3696ec46cffbd) at 2024-12-27 13:02:05)
    > [ Upstream commit fca2977629f49dee437e217c3fc423b6e0cad98c ]
    > While an m_can controller usually already has the init flag from a
    > hardware reset, no such reset happens on the integrated m_can_pci of the
    > Intel Elkhart Lake. If the CAN controller is found in an active state,
    > m_can_dev_setup() would fail because m_can_niso_supported() calls
    > m_can_cccr_update_bits(), which refuses to modify any other configuration
    > bits when CCCR_INIT is not set.
    > To avoid this issue, set CCCR_INIT before attempting to modify any other
    > configuration flags.
    > Fixes: cd5a46ce6fa6 (&quot;can: m_can: don&#x27;t enable transceiver when probing&quot;)
    > Signed-off-by: Matthias Schiffer &lt;matthias.schiffer@ew.tq-group.com&gt;
    > Reviewed-by: Markus Schneider-Pargmann &lt;msp@baylibre.com&gt;
    > Link: https://patch.msgid.link/e247f331cb72829fcbdfda74f31a59cbad1a6006.1728288535.git.matthias.schiffer@ew.tq-group.com
    > Signed-off-by: Marc Kleine-Budde &lt;mkl@pengutronix.de&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ can: m_can: fix missed interrupts with m_can_pci (@Matthias Schiffer in [0f897e47e2e4440](https://github.com/sophgo/linux-riscv/commit/0f897e47e2e4440) at 2024-12-27 13:02:05)
    > [ Upstream commit 743375f8deee360b0e902074bab99b0c9368d42f ]
    > The interrupt line of PCI devices is interpreted as edge-triggered,
    > however the interrupt signal of the m_can controller integrated in Intel
    > Elkhart Lake CPUs appears to be generated level-triggered.
    > Consider the following sequence of events:
    > - IR register is read, interrupt X is set
    > - A new interrupt Y is triggered in the m_can controller
    > - IR register is written to acknowledge interrupt X. Y remains set in IR
    > As at no point in this sequence no interrupt flag is set in IR, the
    > m_can interrupt line will never become deasserted, and no edge will ever
    > be observed to trigger another run of the ISR. This was observed to
    > result in the TX queue of the EHL m_can to get stuck under high load,
    > because frames were queued to the hardware in m_can_start_xmit(), but
    > m_can_finish_tx() was never run to account for their successful
    > transmission.
    > On an Elkhart Lake based board with the two CAN interfaces connected to
    > each other, the following script can reproduce the issue:
    > ip link set can0 up type can bitrate 1000000
    > ip link set can1 up type can bitrate 1000000
    > cangen can0 -g 2 -I 000 -L 8 &amp;
    > cangen can0 -g 2 -I 001 -L 8 &amp;
    > cangen can0 -g 2 -I 002 -L 8 &amp;
    > cangen can0 -g 2 -I 003 -L 8 &amp;
    > cangen can0 -g 2 -I 004 -L 8 &amp;
    > cangen can0 -g 2 -I 005 -L 8 &amp;
    > cangen can0 -g 2 -I 006 -L 8 &amp;
    > cangen can0 -g 2 -I 007 -L 8 &amp;
    > cangen can1 -g 2 -I 100 -L 8 &amp;
    > cangen can1 -g 2 -I 101 -L 8 &amp;
    > cangen can1 -g 2 -I 102 -L 8 &amp;
    > cangen can1 -g 2 -I 103 -L 8 &amp;
    > cangen can1 -g 2 -I 104 -L 8 &amp;
    > cangen can1 -g 2 -I 105 -L 8 &amp;
    > cangen can1 -g 2 -I 106 -L 8 &amp;
    > cangen can1 -g 2 -I 107 -L 8 &amp;
    > stress-ng --matrix 0 &amp;
    > To fix the issue, repeatedly read and acknowledge interrupts at the
    > start of the ISR until no interrupt flags are set, so the next incoming
    > interrupt will also result in an edge on the interrupt line.
    > While we have received a report that even with this patch, the TX queue
    > can become stuck under certain (currently unknown) circumstances on the
    > Elkhart Lake, this patch completely fixes the issue with the above
    > reproducer, and it is unclear whether the remaining issue has a similar
    > cause at all.
    > Fixes: cab7ffc0324f (&quot;can: m_can: add PCI glue driver for Intel Elkhart Lake&quot;)
    > Signed-off-by: Matthias Schiffer &lt;matthias.schiffer@ew.tq-group.com&gt;
    > Reviewed-by: Markus Schneider-Pargmann &lt;msp@baylibre.com&gt;
    > Link: https://patch.msgid.link/fdf0439c51bcb3a46c21e9fb21c7f1d06363be84.1728288535.git.matthias.schiffer@ew.tq-group.com
    > Signed-off-by: Marc Kleine-Budde &lt;mkl@pengutronix.de&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ team: Fix feature exposure when no ports are present (@Daniel Borkmann in [ed6f8d67193315a](https://github.com/sophgo/linux-riscv/commit/ed6f8d67193315a) at 2024-12-27 13:02:04)
    > [ Upstream commit e78c20f327bd94dabac68b98218dff069a8780f0 ]
    > Small follow-up to align this to an equivalent behavior as the bond driver.
    > The change in 3625920b62c3 (&quot;teaming: fix vlan_features computing&quot;) removed
    > the netdevice vlan_features when there is no team port attached, yet it
    > leaves the full set of enc_features intact.
    > Instead, leave the default features as pre 3625920b62c3, and recompute once
    > we do have ports attached. Also, similarly as in bonding case, call the
    > netdev_base_features() helper on the enc_features.
    > Fixes: 3625920b62c3 (&quot;teaming: fix vlan_features computing&quot;)
    > Signed-off-by: Daniel Borkmann &lt;daniel@iogearbox.net&gt;
    > Reviewed-by: Nikolay Aleksandrov &lt;razor@blackwall.org&gt;
    > Link: https://patch.msgid.link/20241213123657.401868-1-daniel@iogearbox.net
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ net: ethernet: bgmac-platform: fix an OF node reference leak (@Joe Hattori in [b3b49641a99bec1](https://github.com/sophgo/linux-riscv/commit/b3b49641a99bec1) at 2024-12-27 13:02:04)
    > [ Upstream commit 0cb2c504d79e7caa3abade3f466750c82ad26f01 ]
    > The OF node obtained by of_parse_phandle() is not freed. Call
    > of_node_put() to balance the refcount.
    > This bug was found by an experimental static analysis tool that I am
    > developing.
    > Fixes: 1676aba5ef7e (&quot;net: ethernet: bgmac: device tree phy enablement&quot;)
    > Signed-off-by: Joe Hattori &lt;joe@pf.is.s.u-tokyo.ac.jp&gt;
    > Reviewed-by: Simon Horman &lt;horms@kernel.org&gt;
    > Link: https://patch.msgid.link/20241214014912.2810315-1-joe@pf.is.s.u-tokyo.ac.jp
    > Signed-off-by: Paolo Abeni &lt;pabeni@redhat.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ netdev: fix repeated netlink messages in queue stats (@Jakub Kicinski in [b38e858ab0c05ce](https://github.com/sophgo/linux-riscv/commit/b38e858ab0c05ce) at 2024-12-27 13:02:04)
    > [ Upstream commit ecc391a541573da46b7ccc188105efedd40aef1b ]
    > The context is supposed to record the next queue to dump,
    > not last dumped. If the dump doesn&#x27;t fit we will restart
    > from the already-dumped queue, duplicating the message.
    > Before this fix and with the selftest improvements later
    > in this series we see:
    > # ./run_kselftest.sh -t drivers/net:stats.py
    > timeout set to 45
    > selftests: drivers/net: stats.py
    > KTAP version 1
    > 1..5
    > ok 1 stats.check_pause
    > ok 2 stats.check_fec
    > ok 3 stats.pkt_byte_sum
    > # Check| At /root/ksft-net-drv/drivers/net/./stats.py, line 125, in qstat_by_ifindex:
    > # Check|     ksft_eq(len(queues[qtype]), len(set(queues[qtype])),
    > # Check failed 45 !&#x3D; 44 repeated queue keys
    > # Check| At /root/ksft-net-drv/drivers/net/./stats.py, line 127, in qstat_by_ifindex:
    > # Check|     ksft_eq(len(queues[qtype]), max(queues[qtype]) + 1,
    > # Check failed 45 !&#x3D; 44 missing queue keys
    > # Check| At /root/ksft-net-drv/drivers/net/./stats.py, line 125, in qstat_by_ifindex:
    > # Check|     ksft_eq(len(queues[qtype]), len(set(queues[qtype])),
    > # Check failed 45 !&#x3D; 44 repeated queue keys
    > # Check| At /root/ksft-net-drv/drivers/net/./stats.py, line 127, in qstat_by_ifindex:
    > # Check|     ksft_eq(len(queues[qtype]), max(queues[qtype]) + 1,
    > # Check failed 45 !&#x3D; 44 missing queue keys
    > # Check| At /root/ksft-net-drv/drivers/net/./stats.py, line 125, in qstat_by_ifindex:
    > # Check|     ksft_eq(len(queues[qtype]), len(set(queues[qtype])),
    > # Check failed 103 !&#x3D; 100 repeated queue keys
    > # Check| At /root/ksft-net-drv/drivers/net/./stats.py, line 127, in qstat_by_ifindex:
    > # Check|     ksft_eq(len(queues[qtype]), max(queues[qtype]) + 1,
    > # Check failed 103 !&#x3D; 100 missing queue keys
    > # Check| At /root/ksft-net-drv/drivers/net/./stats.py, line 125, in qstat_by_ifindex:
    > # Check|     ksft_eq(len(queues[qtype]), len(set(queues[qtype])),
    > # Check failed 102 !&#x3D; 100 repeated queue keys
    > # Check| At /root/ksft-net-drv/drivers/net/./stats.py, line 127, in qstat_by_ifindex:
    > # Check|     ksft_eq(len(queues[qtype]), max(queues[qtype]) + 1,
    > # Check failed 102 !&#x3D; 100 missing queue keys
    > not ok 4 stats.qstat_by_ifindex
    > ok 5 stats.check_down
    > # Totals: pass:4 fail:1 xfail:0 xpass:0 skip:0 error:0
    > With the fix:
    > # ./ksft-net-drv/run_kselftest.sh -t drivers/net:stats.py
    > timeout set to 45
    > selftests: drivers/net: stats.py
    > KTAP version 1
    > 1..5
    > ok 1 stats.check_pause
    > ok 2 stats.check_fec
    > ok 3 stats.pkt_byte_sum
    > ok 4 stats.qstat_by_ifindex
    > ok 5 stats.check_down
    > # Totals: pass:5 fail:0 xfail:0 xpass:0 skip:0 error:0
    > Fixes: ab63a2387cb9 (&quot;netdev: add per-queue statistics&quot;)
    > Reviewed-by: Joe Damato &lt;jdamato@fastly.com&gt;
    > Link: https://patch.msgid.link/20241213152244.3080955-3-kuba@kernel.org
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ net: ethernet: oa_tc6: fix infinite loop error when tx credits becomes 0 (@Parthiban Veerasooran in [b15b0df3967e5de](https://github.com/sophgo/linux-riscv/commit/b15b0df3967e5de) at 2024-12-27 13:02:04)
    > [ Upstream commit 7d2f320e12744e5906a4fab40381060a81d22c12 ]
    > SPI thread wakes up to perform SPI transfer whenever there is an TX skb
    > from n/w stack or interrupt from MAC-PHY. Ethernet frame from TX skb is
    > transferred based on the availability tx credits in the MAC-PHY which is
    > reported from the previous SPI transfer. Sometimes there is a possibility
    > that TX skb is available to transmit but there is no tx credits from
    > MAC-PHY. In this case, there will not be any SPI transfer but the thread
    > will be running in an endless loop until tx credits available again.
    > So checking the availability of tx credits along with TX skb will prevent
    > the above infinite loop. When the tx credits available again that will be
    > notified through interrupt which will trigger the SPI transfer to get the
    > available tx credits.
    > Fixes: 53fbde8ab21e (&quot;net: ethernet: oa_tc6: implement transmit path to transfer tx ethernet frames&quot;)
    > Reviewed-by: Jacob Keller &lt;jacob.e.keller@intel.com&gt;
    > Signed-off-by: Parthiban Veerasooran &lt;parthiban.veerasooran@microchip.com&gt;
    > Signed-off-by: Paolo Abeni &lt;pabeni@redhat.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ net: hinic: Fix cleanup in create_rxqs/txqs() (@Dan Carpenter in [9f88db1b771b7ca](https://github.com/sophgo/linux-riscv/commit/9f88db1b771b7ca) at 2024-12-27 13:02:04)
    > [ Upstream commit 7203d10e93b6e6e1d19481ef7907de6a9133a467 ]
    > There is a check for NULL at the start of create_txqs() and
    > create_rxqs() which tess if &quot;nic_dev-&gt;txqs&quot; is non-NULL.  The
    > intention is that if the device is already open and the queues
    > are already created then we don&#x27;t create them a second time.
    > However, the bug is that if we have an error in the create_txqs()
    > then the pointer doesn&#x27;t get set back to NULL.  The NULL check
    > at the start of the function will say that it&#x27;s already open when
    > it&#x27;s not and the device can&#x27;t be used.
    > Set -&gt;txqs back to NULL on cleanup on error.
    > Fixes: c3e79baf1b03 (&quot;net-next/hinic: Add logical Txq and Rxq&quot;)
    > Signed-off-by: Dan Carpenter &lt;dan.carpenter@linaro.org&gt;
    > Reviewed-by: Simon Horman &lt;horms@kernel.org&gt;
    > Link: https://patch.msgid.link/0cc98faf-a0ed-4565-a55b-0fa2734bc205@stanley.mountain
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ net: netdevsim: fix nsim_pp_hold_write() (@Eric Dumazet in [5c553262f063b3b](https://github.com/sophgo/linux-riscv/commit/5c553262f063b3b) at 2024-12-27 13:02:04)
    > [ Upstream commit b9b8301d369b4c876de5255dbf067b19ba88ac71 ]
    > nsim_pp_hold_write() has two problems:
    > 1) It may return with rtnl held, as found by syzbot.
    > 2) Its return value does not propagate an error if any.
    > Fixes: 1580cbcbfe77 (&quot;net: netdevsim: add some fake page pool use&quot;)
    > Reported-by: syzbot &lt;syzkaller@googlegroups.com&gt;
    > Signed-off-by: Eric Dumazet &lt;edumazet@google.com&gt;
    > Reviewed-by: Simon Horman &lt;horms@kernel.org&gt;
    > Link: https://patch.msgid.link/20241216083703.1859921-1-edumazet@google.com
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ net: ethernet: oa_tc6: fix tx skb race condition between reference pointers (@Parthiban Veerasooran in [1f2eb6c32bae04b](https://github.com/sophgo/linux-riscv/commit/1f2eb6c32bae04b) at 2024-12-27 13:02:04)
    > [ Upstream commit e592b5110b3e9393881b0a019d86832bbf71a47f ]
    > There are two skb pointers to manage tx skb&#x27;s enqueued from n/w stack.
    > waiting_tx_skb pointer points to the tx skb which needs to be processed
    > and ongoing_tx_skb pointer points to the tx skb which is being processed.
    > SPI thread prepares the tx data chunks from the tx skb pointed by the
    > ongoing_tx_skb pointer. When the tx skb pointed by the ongoing_tx_skb is
    > processed, the tx skb pointed by the waiting_tx_skb is assigned to
    > ongoing_tx_skb and the waiting_tx_skb pointer is assigned with NULL.
    > Whenever there is a new tx skb from n/w stack, it will be assigned to
    > waiting_tx_skb pointer if it is NULL. Enqueuing and processing of a tx skb
    > handled in two different threads.
    > Consider a scenario where the SPI thread processed an ongoing_tx_skb and
    > it moves next tx skb from waiting_tx_skb pointer to ongoing_tx_skb pointer
    > without doing any NULL check. At this time, if the waiting_tx_skb pointer
    > is NULL then ongoing_tx_skb pointer is also assigned with NULL. After
    > that, if a new tx skb is assigned to waiting_tx_skb pointer by the n/w
    > stack and there is a chance to overwrite the tx skb pointer with NULL in
    > the SPI thread. Finally one of the tx skb will be left as unhandled,
    > resulting packet missing and memory leak.
    > - Consider the below scenario where the TXC reported from the previous
    > transfer is 10 and ongoing_tx_skb holds an tx ethernet frame which can be
    > transported in 20 TXCs and waiting_tx_skb is still NULL.
    > tx_credits &#x3D; 10; /* 21 are filled in the previous transfer */
    > ongoing_tx_skb &#x3D; 20;
    > waiting_tx_skb &#x3D; NULL; /* Still NULL */
    > - So, (tc6-&gt;ongoing_tx_skb || tc6-&gt;waiting_tx_skb) becomes true.
    > - After oa_tc6_prepare_spi_tx_buf_for_tx_skbs()
    > ongoing_tx_skb &#x3D; 10;
    > waiting_tx_skb &#x3D; NULL; /* Still NULL */
    > - Perform SPI transfer.
    > - Process SPI rx buffer to get the TXC from footers.
    > - Now let&#x27;s assume previously filled 21 TXCs are freed so we are good to
    > transport the next remaining 10 tx chunks from ongoing_tx_skb.
    > tx_credits &#x3D; 21;
    > ongoing_tx_skb &#x3D; 10;
    > waiting_tx_skb &#x3D; NULL;
    > - So, (tc6-&gt;ongoing_tx_skb || tc6-&gt;waiting_tx_skb) becomes true again.
    > - In the oa_tc6_prepare_spi_tx_buf_for_tx_skbs()
    > ongoing_tx_skb &#x3D; NULL;
    > waiting_tx_skb &#x3D; NULL;
    > - Now the below bad case might happen,
    > Thread1 (oa_tc6_start_xmit)	Thread2 (oa_tc6_spi_thread_handler)
    > ---------------------------	-----------------------------------
    > - if waiting_tx_skb is NULL
    > - if ongoing_tx_skb is NULL
    > - ongoing_tx_skb &#x3D; waiting_tx_skb
    > - waiting_tx_skb &#x3D; skb
    > - waiting_tx_skb &#x3D; NULL
    > ...
    > - ongoing_tx_skb &#x3D; NULL
    > - if waiting_tx_skb is NULL
    > - waiting_tx_skb &#x3D; skb
    > To overcome the above issue, protect the moving of tx skb reference from
    > waiting_tx_skb pointer to ongoing_tx_skb pointer and assigning new tx skb
    > to waiting_tx_skb pointer, so that the other thread can&#x27;t access the
    > waiting_tx_skb pointer until the current thread completes moving the tx
    > skb reference safely.
    > Fixes: 53fbde8ab21e (&quot;net: ethernet: oa_tc6: implement transmit path to transfer tx ethernet frames&quot;)
    > Signed-off-by: Parthiban Veerasooran &lt;parthiban.veerasooran@microchip.com&gt;
    > Reviewed-by: Larysa Zaremba &lt;larysa.zaremba@intel.com&gt;
    > Signed-off-by: Paolo Abeni &lt;pabeni@redhat.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ionic: Fix netdev notifier unregister on failure (@Brett Creeley in [ee2e931b2b46de9](https://github.com/sophgo/linux-riscv/commit/ee2e931b2b46de9) at 2024-12-27 13:02:03)
    > [ Upstream commit 9590d32e090ea2751e131ae5273859ca22f5ac14 ]
    > If register_netdev() fails, then the driver leaks the netdev notifier.
    > Fix this by calling ionic_lif_unregister() on register_netdev()
    > failure. This will also call ionic_lif_unregister_phc() if it has
    > already been registered.
    > Fixes: 30b87ab4c0b3 (&quot;ionic: remove lif list concept&quot;)
    > Signed-off-by: Brett Creeley &lt;brett.creeley@amd.com&gt;
    > Signed-off-by: Shannon Nelson &lt;shannon.nelson@amd.com&gt;
    > Reviewed-by: Jacob Keller &lt;jacob.e.keller@intel.com&gt;
    > Link: https://patch.msgid.link/20241212213157.12212-2-shannon.nelson@amd.com
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ netdev: fix repeated netlink messages in queue dump (@Jakub Kicinski in [d924c8afe666b15](https://github.com/sophgo/linux-riscv/commit/d924c8afe666b15) at 2024-12-27 13:02:03)
    > [ Upstream commit b1f3a2f5a742c1e939a73031bd31b9e557a2d77d ]
    > The context is supposed to record the next queue to dump,
    > not last dumped. If the dump doesn&#x27;t fit we will restart
    > from the already-dumped queue, duplicating the message.
    > Before this fix and with the selftest improvements later
    > in this series we see:
    > # ./run_kselftest.sh -t drivers/net:queues.py
    > timeout set to 45
    > selftests: drivers/net: queues.py
    > KTAP version 1
    > 1..2
    > # Check| At /root/ksft-net-drv/drivers/net/./queues.py, line 32, in get_queues:
    > # Check|     ksft_eq(queues, expected)
    > # Check failed 102 !&#x3D; 100
    > # Check| At /root/ksft-net-drv/drivers/net/./queues.py, line 32, in get_queues:
    > # Check|     ksft_eq(queues, expected)
    > # Check failed 101 !&#x3D; 100
    > not ok 1 queues.get_queues
    > ok 2 queues.addremove_queues
    > # Totals: pass:1 fail:1 xfail:0 xpass:0 skip:0 error:0
    > not ok 1 selftests: drivers/net: queues.py # exit&#x3D;1
    > With the fix:
    > # ./ksft-net-drv/run_kselftest.sh -t drivers/net:queues.py
    > timeout set to 45
    > selftests: drivers/net: queues.py
    > KTAP version 1
    > 1..2
    > ok 1 queues.get_queues
    > ok 2 queues.addremove_queues
    > # Totals: pass:2 fail:0 xfail:0 xpass:0 skip:0 error:0
    > Fixes: 6b6171db7fc8 (&quot;netdev-genl: Add netlink framework functions for queue&quot;)
    > Reviewed-by: Joe Damato &lt;jdamato@fastly.com&gt;
    > Link: https://patch.msgid.link/20241213152244.3080955-2-kuba@kernel.org
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ksmbd: fix broken transfers when exceeding max simultaneous operations (@Marios Makassikis in [938e7c364e2983d](https://github.com/sophgo/linux-riscv/commit/938e7c364e2983d) at 2024-12-27 13:02:03)
    > [ Upstream commit 43fb7bce8866e793275c4f9f25af6a37745f3416 ]
    > Since commit 0a77d947f599 (&quot;ksmbd: check outstanding simultaneous SMB
    > operations&quot;), ksmbd enforces a maximum number of simultaneous operations
    > for a connection. The problem is that reaching the limit causes ksmbd to
    > close the socket, and the client has no indication that it should have
    > slowed down.
    > This behaviour can be reproduced by setting &quot;smb2 max credits &#x3D; 128&quot; (or
    > lower), and transferring a large file (25GB).
    > smbclient fails as below:
    > $ smbclient //192.168.1.254/testshare -U user%pass
    > smb: \&gt; put file.bin
    > cli_push returned NT_STATUS_USER_SESSION_DELETED
    > putting file file.bin as \file.bin smb2cli_req_compound_submit:
    > Insufficient credits. 0 available, 1 needed
    > NT_STATUS_INTERNAL_ERROR closing remote file \file.bin
    > smb: \&gt; smb2cli_req_compound_submit: Insufficient credits. 0 available,
    > 1 needed
    > Windows clients fail with 0x8007003b (with smaller files even).
    > Fix this by delaying reading from the socket until there&#x27;s room to
    > allocate a request. This effectively applies backpressure on the client,
    > so the transfer completes, albeit at a slower rate.
    > Fixes: 0a77d947f599 (&quot;ksmbd: check outstanding simultaneous SMB operations&quot;)
    > Signed-off-by: Marios Makassikis &lt;mmakassikis@freebox.fr&gt;
    > Signed-off-by: Namjae Jeon &lt;linkinjeon@kernel.org&gt;
    > Signed-off-by: Steve French &lt;stfrench@microsoft.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ksmbd: count all requests in req_running counter (@Marios Makassikis in [7e2bb4108a05c9c](https://github.com/sophgo/linux-riscv/commit/7e2bb4108a05c9c) at 2024-12-27 13:02:03)
    > [ Upstream commit 83c47d9e0ce79b5d7c0b21b9f35402dbde0fa15c ]
    > This changes the semantics of req_running to count all in-flight
    > requests on a given connection, rather than the number of elements
    > in the conn-&gt;request list. The latter is used only in smb2_cancel,
    > and the counter is not used
    > Signed-off-by: Marios Makassikis &lt;mmakassikis@freebox.fr&gt;
    > Acked-by: Namjae Jeon &lt;linkinjeon@kernel.org&gt;
    > Signed-off-by: Steve French &lt;stfrench@microsoft.com&gt;
    > Stable-dep-of: 43fb7bce8866 (&quot;ksmbd: fix broken transfers when exceeding max simultaneous operations&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ionic: use ee-&gt;offset when returning sprom data (@Shannon Nelson in [69324efed0e2fc3](https://github.com/sophgo/linux-riscv/commit/69324efed0e2fc3) at 2024-12-27 13:02:03)
    > [ Upstream commit b096d62ba1323391b2db98b7704e2468cf3b1588 ]
    > Some calls into ionic_get_module_eeprom() don&#x27;t use a single
    > full buffer size, but instead multiple calls with an offset.
    > Teach our driver to use the offset correctly so we can
    > respond appropriately to the caller.
    > Fixes: 4d03e00a2140 (&quot;ionic: Add initial ethtool support&quot;)
    > Signed-off-by: Shannon Nelson &lt;shannon.nelson@amd.com&gt;
    > Reviewed-by: Jacob Keller &lt;jacob.e.keller@intel.com&gt;
    > Link: https://patch.msgid.link/20241212213157.12212-4-shannon.nelson@amd.com
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ net: renesas: rswitch: rework ts tags management (@Nikita Yushchenko in [280d1b743a3b827](https://github.com/sophgo/linux-riscv/commit/280d1b743a3b827) at 2024-12-27 13:02:03)
    > [ Upstream commit 922b4b955a03d19fea98938f33ef0e62d01f5159 ]
    > The existing linked list based implementation of how ts tags are
    > assigned and managed is unsafe against concurrency and corner cases:
    > - element addition in tx processing can race against element removal
    > in ts queue completion,
    > - element removal in ts queue completion can race against element
    > removal in device close,
    > - if a large number of frames gets added to tx queue without ts queue
    > completions in between, elements with duplicate tag values can get
    > added.
    > Use a different implementation, based on per-port used tags bitmaps and
    > saved skb arrays.
    > Safety for addition in tx processing vs removal in ts completion is
    > provided by:
    > tag &#x3D; find_first_zero_bit(...);
    > smp_mb();
    > &lt;write rdev-&gt;ts_skb[tag]&gt;
    > set_bit(...);
    > vs
    > &lt;read rdev-&gt;ts_skb[tag]&gt;
    > smp_mb();
    > clear_bit(...);
    > Safety for removal in ts completion vs removal in device close is
    > provided by using atomic read-and-clear for rdev-&gt;ts_skb[tag]:
    > ts_skb &#x3D; xchg(&amp;rdev-&gt;ts_skb[tag], NULL);
    > if (ts_skb)
    > &lt;handle it&gt;
    > Fixes: 33f5d733b589 (&quot;net: renesas: rswitch: Improve TX timestamp accuracy&quot;)
    > Signed-off-by: Nikita Yushchenko &lt;nikita.yoush@cogentembedded.com&gt;
    > Link: https://patch.msgid.link/20241212062558.436455-1-nikita.yoush@cogentembedded.com
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ionic: no double destroy workqueue (@Shannon Nelson in [13355dd37e22edb](https://github.com/sophgo/linux-riscv/commit/13355dd37e22edb) at 2024-12-27 13:02:03)
    > [ Upstream commit 746e6ae2e202b062b9deee7bd86d94937997ecd7 ]
    > There are some FW error handling paths that can cause us to
    > try to destroy the workqueue more than once, so let&#x27;s be sure
    > we&#x27;re checking for that.
    > The case where this popped up was in an AER event where the
    > handlers got called in such a way that ionic_reset_prepare()
    > and thus ionic_dev_teardown() got called twice in a row.
    > The second time through the workqueue was already destroyed,
    > and destroy_workqueue() choked on the bad wq pointer.
    > We didn&#x27;t hit this in AER handler testing before because at
    > that time we weren&#x27;t using a private workqueue.  Later we
    > replaced the use of the system workqueue with our own private
    > workqueue but hadn&#x27;t rerun the AER handler testing since then.
    > Fixes: 9e25450da700 (&quot;ionic: add private workqueue per-device&quot;)
    > Signed-off-by: Shannon Nelson &lt;shannon.nelson@amd.com&gt;
    > Reviewed-by: Jacob Keller &lt;jacob.e.keller@intel.com&gt;
    > Link: https://patch.msgid.link/20241212213157.12212-3-shannon.nelson@amd.com
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ net/smc: check return value of sock_recvmsg when draining clc data (@Guangguan Wang in [df3dfe1a93c6298](https://github.com/sophgo/linux-riscv/commit/df3dfe1a93c6298) at 2024-12-27 13:02:02)
    > [ Upstream commit c5b8ee5022a19464783058dc6042e8eefa34e8cd ]
    > When receiving clc msg, the field length in smc_clc_msg_hdr indicates the
    > length of msg should be received from network and the value should not be
    > fully trusted as it is from the network. Once the value of length exceeds
    > the value of buflen in function smc_clc_wait_msg it may run into deadloop
    > when trying to drain the remaining data exceeding buflen.
    > This patch checks the return value of sock_recvmsg when draining data in
    > case of deadloop in draining.
    > Fixes: fb4f79264c0f (&quot;net/smc: tolerate future SMCD versions&quot;)
    > Signed-off-by: Guangguan Wang &lt;guangguan.wang@linux.alibaba.com&gt;
    > Reviewed-by: Wen Gu &lt;guwen@linux.alibaba.com&gt;
    > Reviewed-by: D. Wythe &lt;alibuda@linux.alibaba.com&gt;
    > Signed-off-by: David S. Miller &lt;davem@davemloft.net&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ net: mscc: ocelot: fix incorrect IFH SRC_PORT field in ocelot_ifh_set_basic() (@Vladimir Oltean in [a8836eae3288c35](https://github.com/sophgo/linux-riscv/commit/a8836eae3288c35) at 2024-12-27 13:02:02)
    > [ Upstream commit 2d5df3a680ffdaf606baa10636bdb1daf757832e ]
    > Packets injected by the CPU should have a SRC_PORT field equal to the
    > CPU port module index in the Analyzer block (ocelot-&gt;num_phys_ports).
    > The blamed commit copied the ocelot_ifh_set_basic() call incorrectly
    > from ocelot_xmit_common() in net/dsa/tag_ocelot.c. Instead of calling
    > with &quot;x&quot;, it calls with BIT_ULL(x), but the field is not a port mask,
    > but rather a single port index.
    > [ side note: this is the technical debt of code duplication :( ]
    > The error used to be silent and doesn&#x27;t appear to have other
    > user-visible manifestations, but with new changes in the packing
    > library, it now fails loudly as follows:
    > ------------[ cut here ]------------
    > Cannot store 0x40 inside bits 46-43 - will truncate
    > sja1105 spi2.0: xmit timed out
    > WARNING: CPU: 1 PID: 102 at lib/packing.c:98 __pack+0x90/0x198
    > sja1105 spi2.0: timed out polling for tstamp
    > CPU: 1 UID: 0 PID: 102 Comm: felix_xmit
    > Tainted: G        W        N 6.13.0-rc1-00372-gf706b85d972d-dirty #2605
    > Call trace:
    > __pack+0x90/0x198 (P)
    > __pack+0x90/0x198 (L)
    > packing+0x78/0x98
    > ocelot_ifh_set_basic+0x260/0x368
    > ocelot_port_inject_frame+0xa8/0x250
    > felix_port_deferred_xmit+0x14c/0x258
    > kthread_worker_fn+0x134/0x350
    > kthread+0x114/0x138
    > The code path pertains to the ocelot switchdev driver and to the felix
    > secondary DSA tag protocol, ocelot-8021q. Here seen with ocelot-8021q.
    > The messenger (packing) is not really to blame, so fix the original
    > commit instead.
    > Fixes: e1b9e80236c5 (&quot;net: mscc: ocelot: fix QoS class for injected packets with &quot;ocelot-8021q&quot;&quot;)
    > Signed-off-by: Vladimir Oltean &lt;vladimir.oltean@nxp.com&gt;
    > Reviewed-by: Simon Horman &lt;horms@kernel.org&gt;
    > Link: https://patch.msgid.link/20241212165546.879567-1-vladimir.oltean@nxp.com
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ netdevsim: prevent bad user input in nsim_dev_health_break_write() (@Eric Dumazet in [8e9ef6bdf71bf25](https://github.com/sophgo/linux-riscv/commit/8e9ef6bdf71bf25) at 2024-12-27 13:02:02)
    > [ Upstream commit ee76746387f6233bdfa93d7406990f923641568f ]
    > If either a zero count or a large one is provided, kernel can crash.
    > Fixes: 82c93a87bf8b (&quot;netdevsim: implement couple of testing devlink health reporters&quot;)
    > Reported-by: syzbot+ea40e4294e58b0292f74@syzkaller.appspotmail.com
    > Closes: https://lore.kernel.org/netdev/675c6862.050a0220.37aaf.00b1.GAE@google.com/T/#u
    > Signed-off-by: Eric Dumazet &lt;edumazet@google.com&gt;
    > Cc: Jiri Pirko &lt;jiri@nvidia.com&gt;
    > Reviewed-by: Joe Damato &lt;jdamato@fastly.com&gt;
    > Link: https://patch.msgid.link/20241213172518.2415666-1-edumazet@google.com
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ net/smc: check smcd_v2_ext_offset when receiving proposal msg (@Guangguan Wang in [48d5a8a304a6436](https://github.com/sophgo/linux-riscv/commit/48d5a8a304a6436) at 2024-12-27 13:02:02)
    > [ Upstream commit 9ab332deb671d8f7e66d82a2ff2b3f715bc3a4ad ]
    > When receiving proposal msg in server, the field smcd_v2_ext_offset in
    > proposal msg is from the remote client and can not be fully trusted.
    > Once the value of smcd_v2_ext_offset exceed the max value, there has
    > the chance to access wrong address, and crash may happen.
    > This patch checks the value of smcd_v2_ext_offset before using it.
    > Fixes: 5c21c4ccafe8 (&quot;net/smc: determine accepted ISM devices&quot;)
    > Signed-off-by: Guangguan Wang &lt;guangguan.wang@linux.alibaba.com&gt;
    > Reviewed-by: Wen Gu &lt;guwen@linux.alibaba.com&gt;
    > Reviewed-by: D. Wythe &lt;alibuda@linux.alibaba.com&gt;
    > Signed-off-by: David S. Miller &lt;davem@davemloft.net&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ net/smc: check iparea_offset and ipv6_prefixes_cnt when receiving proposal msg (@Guangguan Wang in [47ce46349672a7e](https://github.com/sophgo/linux-riscv/commit/47ce46349672a7e) at 2024-12-27 13:02:02)
    > [ Upstream commit a29e220d3c8edbf0e1beb0f028878a4a85966556 ]
    > When receiving proposal msg in server, the field iparea_offset
    > and the field ipv6_prefixes_cnt in proposal msg are from the
    > remote client and can not be fully trusted. Especially the
    > field iparea_offset, once exceed the max value, there has the
    > chance to access wrong address, and crash may happen.
    > This patch checks iparea_offset and ipv6_prefixes_cnt before using them.
    > Fixes: e7b7a64a8493 (&quot;smc: support variable CLC proposal messages&quot;)
    > Signed-off-by: Guangguan Wang &lt;guangguan.wang@linux.alibaba.com&gt;
    > Reviewed-by: Wen Gu &lt;guwen@linux.alibaba.com&gt;
    > Reviewed-by: D. Wythe &lt;alibuda@linux.alibaba.com&gt;
    > Signed-off-by: David S. Miller &lt;davem@davemloft.net&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ net/smc: check v2_ext_offset/eid_cnt/ism_gid_cnt when receiving proposal msg (@Guangguan Wang in [42f6beb2d577942](https://github.com/sophgo/linux-riscv/commit/42f6beb2d577942) at 2024-12-27 13:02:02)
    > [ Upstream commit 7863c9f3d24ba49dbead7e03dfbe40deb5888fdf ]
    > When receiving proposal msg in server, the fields v2_ext_offset/
    > eid_cnt/ism_gid_cnt in proposal msg are from the remote client
    > and can not be fully trusted. Especially the field v2_ext_offset,
    > once exceed the max value, there has the chance to access wrong
    > address, and crash may happen.
    > This patch checks the fields v2_ext_offset/eid_cnt/ism_gid_cnt
    > before using them.
    > Fixes: 8c3dca341aea (&quot;net/smc: build and send V2 CLC proposal&quot;)
    > Signed-off-by: Guangguan Wang &lt;guangguan.wang@linux.alibaba.com&gt;
    > Reviewed-by: Wen Gu &lt;guwen@linux.alibaba.com&gt;
    > Reviewed-by: D. Wythe &lt;alibuda@linux.alibaba.com&gt;
    > Signed-off-by: David S. Miller &lt;davem@davemloft.net&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ tools/net/ynl: fix sub-message key lookup for nested attributes (@Donald Hunter in [1c2d7999d152900](https://github.com/sophgo/linux-riscv/commit/1c2d7999d152900) at 2024-12-27 13:02:02)
    > [ Upstream commit 663ad7481f068057f6f692c5368c47150e855370 ]
    > Use the correct attribute space for sub-message key lookup in nested
    > attributes when adding attributes. This fixes rt_link where the &quot;kind&quot;
    > key and &quot;data&quot; sub-message are nested attributes in &quot;linkinfo&quot;.
    > For example:
    > ./tools/net/ynl/cli.py \
    > --create \
    > --spec Documentation/netlink/specs/rt_link.yaml \
    > --do newlink \
    > --json &#x27;{&quot;link&quot;: 99,
    > &quot;linkinfo&quot;: { &quot;kind&quot;: &quot;vlan&quot;, &quot;data&quot;: {&quot;id&quot;: 4 } }
    > }&#x27;
    > Signed-off-by: Donald Hunter &lt;donald.hunter@gmail.com&gt;
    > Fixes: ab463c4342d1 (&quot;tools/net/ynl: Add support for encoding sub-messages&quot;)
    > Link: https://patch.msgid.link/20241213130711.40267-1-donald.hunter@gmail.com
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ tools: hv: change permissions of NetworkManager configuration file (@Olaf Hering in [d72139fa20246bb](https://github.com/sophgo/linux-riscv/commit/d72139fa20246bb) at 2024-12-27 13:02:01)
    > [ Upstream commit 91ae69c7ed9e262f24240c425ad1eef2cf6639b7 ]
    > Align permissions of the resulting .nmconnection file, instead of
    > the input file from hv_kvp_daemon. To avoid the tiny time frame
    > where the output file is world-readable, use umask instead of chmod.
    > Fixes: 42999c904612 (&quot;hv/hv_kvp_daemon:Support for keyfile based connection profile&quot;)
    > Signed-off-by: Olaf Hering &lt;olaf@aepfle.de&gt;
    > Reviewed-by: Shradha Gupta &lt;shradhagupta@linux.microsoft.com&gt;
    > Link: https://lore.kernel.org/r/20241016143521.3735-1-olaf@aepfle.de
    > Signed-off-by: Wei Liu &lt;wei.liu@kernel.org&gt;
    > Message-ID: &lt;20241016143521.3735-1-olaf@aepfle.de&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ cxl/region: Fix region creation for greater than x2 switches (@Huaisheng Ye in [cec68375b8e1562](https://github.com/sophgo/linux-riscv/commit/cec68375b8e1562) at 2024-12-27 13:02:01)
    > [ Upstream commit 76467a94810c2aa4dd3096903291ac6df30c399e ]
    > The cxl_port_setup_targets() algorithm fails to identify valid target list
    > ordering in the presence of 4-way and above switches resulting in
    > &#x27;cxl create-region&#x27; failures of the form:
    > $ cxl create-region -d decoder0.0 -g 1024 -s 2G -t ram -w 8 -m mem4 mem1 mem6 mem3 mem2 mem5 mem7 mem0
    > cxl region: create_region: region0: failed to set target7 to mem0
    > cxl region: cmd_create_region: created 0 regions
    > [kernel debug message]
    > check_last_peer:1213: cxl region0: pci0000:0c:port1: cannot host mem6:decoder7.0 at 2
    > bus_remove_device:574: bus: &#x27;cxl&#x27;: remove device region0
    > QEMU can create this failing topology:
    > ACPI0017:00 [root0]
    > |
    > HB_0 [port1]
    > /             \
    > RP_0             RP_1
    > |                 |
    > USP [port2]           USP [port3]
    > /    /    \    \        /   /    \    \
    > DSP   DSP   DSP   DSP   DSP  DSP   DSP  DSP
    > |     |     |     |     |    |     |    |
    > mem4  mem6  mem2  mem7  mem1 mem3  mem5  mem0
    > Pos:      0     2     4     6     1    3     5    7
    > HB: Host Bridge
    > RP: Root Port
    > USP: Upstream Port
    > DSP: Downstream Port
    > ...with the following command steps:
    > $ qemu-system-x86_64 -machine q35,cxl&#x3D;on,accel&#x3D;tcg  \
    > -smp cpus&#x3D;8 \
    > -m 8G \
    > -hda /home/work/vm-images/centos-stream8-02.qcow2 \
    > -object memory-backend-ram,size&#x3D;4G,id&#x3D;m0 \
    > -object memory-backend-ram,size&#x3D;4G,id&#x3D;m1 \
    > -object memory-backend-ram,size&#x3D;2G,id&#x3D;cxl-mem0 \
    > -object memory-backend-ram,size&#x3D;2G,id&#x3D;cxl-mem1 \
    > -object memory-backend-ram,size&#x3D;2G,id&#x3D;cxl-mem2 \
    > -object memory-backend-ram,size&#x3D;2G,id&#x3D;cxl-mem3 \
    > -object memory-backend-ram,size&#x3D;2G,id&#x3D;cxl-mem4 \
    > -object memory-backend-ram,size&#x3D;2G,id&#x3D;cxl-mem5 \
    > -object memory-backend-ram,size&#x3D;2G,id&#x3D;cxl-mem6 \
    > -object memory-backend-ram,size&#x3D;2G,id&#x3D;cxl-mem7 \
    > -numa node,memdev&#x3D;m0,cpus&#x3D;0-3,nodeid&#x3D;0 \
    > -numa node,memdev&#x3D;m1,cpus&#x3D;4-7,nodeid&#x3D;1 \
    > -netdev user,id&#x3D;net0,hostfwd&#x3D;tcp::2222-:22 \
    > -device virtio-net-pci,netdev&#x3D;net0 \
    > -device pxb-cxl,bus_nr&#x3D;12,bus&#x3D;pcie.0,id&#x3D;cxl.1 \
    > -device cxl-rp,port&#x3D;0,bus&#x3D;cxl.1,id&#x3D;root_port0,chassis&#x3D;0,slot&#x3D;0 \
    > -device cxl-rp,port&#x3D;1,bus&#x3D;cxl.1,id&#x3D;root_port1,chassis&#x3D;0,slot&#x3D;1 \
    > -device cxl-upstream,bus&#x3D;root_port0,id&#x3D;us0 \
    > -device cxl-downstream,port&#x3D;0,bus&#x3D;us0,id&#x3D;swport0,chassis&#x3D;0,slot&#x3D;4 \
    > -device cxl-type3,bus&#x3D;swport0,volatile-memdev&#x3D;cxl-mem0,id&#x3D;cxl-vmem0 \
    > -device cxl-downstream,port&#x3D;1,bus&#x3D;us0,id&#x3D;swport1,chassis&#x3D;0,slot&#x3D;5 \
    > -device cxl-type3,bus&#x3D;swport1,volatile-memdev&#x3D;cxl-mem1,id&#x3D;cxl-vmem1 \
    > -device cxl-downstream,port&#x3D;2,bus&#x3D;us0,id&#x3D;swport2,chassis&#x3D;0,slot&#x3D;6 \
    > -device cxl-type3,bus&#x3D;swport2,volatile-memdev&#x3D;cxl-mem2,id&#x3D;cxl-vmem2 \
    > -device cxl-downstream,port&#x3D;3,bus&#x3D;us0,id&#x3D;swport3,chassis&#x3D;0,slot&#x3D;7 \
    > -device cxl-type3,bus&#x3D;swport3,volatile-memdev&#x3D;cxl-mem3,id&#x3D;cxl-vmem3 \
    > -device cxl-upstream,bus&#x3D;root_port1,id&#x3D;us1 \
    > -device cxl-downstream,port&#x3D;4,bus&#x3D;us1,id&#x3D;swport4,chassis&#x3D;0,slot&#x3D;8 \
    > -device cxl-type3,bus&#x3D;swport4,volatile-memdev&#x3D;cxl-mem4,id&#x3D;cxl-vmem4 \
    > -device cxl-downstream,port&#x3D;5,bus&#x3D;us1,id&#x3D;swport5,chassis&#x3D;0,slot&#x3D;9 \
    > -device cxl-type3,bus&#x3D;swport5,volatile-memdev&#x3D;cxl-mem5,id&#x3D;cxl-vmem5 \
    > -device cxl-downstream,port&#x3D;6,bus&#x3D;us1,id&#x3D;swport6,chassis&#x3D;0,slot&#x3D;10 \
    > -device cxl-type3,bus&#x3D;swport6,volatile-memdev&#x3D;cxl-mem6,id&#x3D;cxl-vmem6 \
    > -device cxl-downstream,port&#x3D;7,bus&#x3D;us1,id&#x3D;swport7,chassis&#x3D;0,slot&#x3D;11 \
    > -device cxl-type3,bus&#x3D;swport7,volatile-memdev&#x3D;cxl-mem7,id&#x3D;cxl-vmem7 \
    > -M cxl-fmw.0.targets.0&#x3D;cxl.1,cxl-fmw.0.size&#x3D;32G &amp;
    > In Guest OS:
    > $ cxl create-region -d decoder0.0 -g 1024 -s 2G -t ram -w 8 -m mem4 mem1 mem6 mem3 mem2 mem5 mem7 mem0
    > Fix the method to calculate @distance by iterativeley multiplying the
    > number of targets per switch port. This also follows the algorithm
    > recommended here [1].
    > Fixes: 27b3f8d13830 (&quot;cxl/region: Program target lists&quot;)
    > Link: http://lore.kernel.org/6538824b52349_7258329466@dwillia2-xfh.jf.intel.com.notmuch [1]
    > Signed-off-by: Huaisheng Ye &lt;huaisheng.ye@intel.com&gt;
    > Tested-by: Li Zhijian &lt;lizhijian@fujitsu.com&gt;
    > [djbw: add a comment explaining &#x27;distance&#x27;]
    > Signed-off-by: Dan Williams &lt;dan.j.williams@intel.com&gt;
    > Link: https://patch.msgid.link/173378716722.1270362.9546805175813426729.stgit@dwillia2-xfh.jf.intel.com
    > Signed-off-by: Dave Jiang &lt;dave.jiang@intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ xfs: fix zero byte checking in the superblock scrubber (@Darrick J. Wong in [bc1f8a86e34a070](https://github.com/sophgo/linux-riscv/commit/bc1f8a86e34a070) at 2024-12-27 13:02:01)
    > commit c004a793e0ec34047c3bd423bcd8966f5fac88dc upstream.
    > The logic to check that the region past the end of the superblock is all
    > zeroes is wrong -- we don&#x27;t want to check only the bytes past the end of
    > the maximally sized ondisk superblock structure as currently defined in
    > xfs_format.h; we want to check the bytes beyond the end of the ondisk as
    > defined by the feature bits.
    > Port the superblock size logic from xfs_repair and then put it to use in
    > xfs_scrub.
    > Cc: &lt;stable@vger.kernel.org&gt; # v4.15
    > Fixes: 21fb4cb1981ef7 (&quot;xfs: scrub the secondary superblocks&quot;)
    > Signed-off-by: &quot;Darrick J. Wong&quot; &lt;djwong@kernel.org&gt;
    > Reviewed-by: Christoph Hellwig &lt;hch@lst.de&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ cxl/pci: Fix potential bogus return value upon successful probing (@Davidlohr Bueso in [87d5a852f0bc2f7](https://github.com/sophgo/linux-riscv/commit/87d5a852f0bc2f7) at 2024-12-27 13:02:01)
    > [ Upstream commit da4d8c83358163df9a4addaeba0ef8bcb03b22e8 ]
    > If cxl_pci_ras_unmask() returns non-zero, cxl_pci_probe() will end up
    > returning that value, instead of zero.
    > Fixes: 248529edc86f (&quot;cxl: add RAS status unmasking for CXL&quot;)
    > Reviewed-by: Fan Ni &lt;fan.ni@samsung.com&gt;
    > Signed-off-by: Davidlohr Bueso &lt;dave@stgolabs.net&gt;
    > Reviewed-by: Ira Weiny &lt;ira.weiny@intel.com&gt;
    > Link: https://patch.msgid.link/20241115170032.108445-1-dave@stgolabs.net
    > Signed-off-by: Dave Jiang &lt;dave.jiang@intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ net/smc: protect link down work from execute after lgr freed (@Guangguan Wang in [841b1824750d3b8](https://github.com/sophgo/linux-riscv/commit/841b1824750d3b8) at 2024-12-27 13:02:01)
    > [ Upstream commit 2b33eb8f1b3e8c2f87cfdbc8cc117f6bdfabc6ec ]
    > link down work may be scheduled before lgr freed but execute
    > after lgr freed, which may result in crash. So it is need to
    > hold a reference before shedule link down work, and put the
    > reference after work executed or canceled.
    > The relevant crash call stack as follows:
    > list_del corruption. prev-&gt;next should be ffffb638c9c0fe20,
    > but was 0000000000000000
    > ------------[ cut here ]------------
    > kernel BUG at lib/list_debug.c:51!
    > invalid opcode: 0000 [#1] SMP NOPTI
    > CPU: 6 PID: 978112 Comm: kworker/6:119 Kdump: loaded Tainted: G #1
    > Hardware name: Alibaba Cloud Alibaba Cloud ECS, BIOS 2221b89 04/01/2014
    > Workqueue: events smc_link_down_work [smc]
    > RIP: 0010:__list_del_entry_valid.cold+0x31/0x47
    > RSP: 0018:ffffb638c9c0fdd8 EFLAGS: 00010086
    > RAX: 0000000000000054 RBX: ffff942fb75e5128 RCX: 0000000000000000
    > RDX: ffff943520930aa0 RSI: ffff94352091fc80 RDI: ffff94352091fc80
    > RBP: 0000000000000000 R08: 0000000000000000 R09: ffffb638c9c0fc38
    > R10: ffffb638c9c0fc30 R11: ffffffffa015eb28 R12: 0000000000000002
    > R13: ffffb638c9c0fe20 R14: 0000000000000001 R15: ffff942f9cd051c0
    > FS:  0000000000000000(0000) GS:ffff943520900000(0000) knlGS:0000000000000000
    > CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
    > CR2: 00007f4f25214000 CR3: 000000025fbae004 CR4: 00000000007706e0
    > DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
    > DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
    > PKRU: 55555554
    > Call Trace:
    > rwsem_down_write_slowpath+0x17e/0x470
    > smc_link_down_work+0x3c/0x60 [smc]
    > process_one_work+0x1ac/0x350
    > worker_thread+0x49/0x2f0
    > ? rescuer_thread+0x360/0x360
    > kthread+0x118/0x140
    > ? __kthread_bind_mask+0x60/0x60
    > ret_from_fork+0x1f/0x30
    > Fixes: 541afa10c126 (&quot;net/smc: add smcr_port_err() and smcr_link_down() processing&quot;)
    > Signed-off-by: Guangguan Wang &lt;guangguan.wang@linux.alibaba.com&gt;
    > Reviewed-by: Tony Lu &lt;tonylu@linux.alibaba.com&gt;
    > Signed-off-by: David S. Miller &lt;davem@davemloft.net&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ net/smc: check sndbuf_space again after NOSPACE flag is set in smc_poll (@Guangguan Wang in [45455e780f65722](https://github.com/sophgo/linux-riscv/commit/45455e780f65722) at 2024-12-27 13:02:01)
    > [ Upstream commit 679e9ddcf90dbdf98aaaa71a492454654b627bcb ]
    > When application sending data more than sndbuf_space, there have chances
    > application will sleep in epoll_wait, and will never be wakeup again. This
    > is caused by a race between smc_poll and smc_cdc_tx_handler.
    > application                                      tasklet
    > smc_tx_sendmsg(len &gt; sndbuf_space)   |
    > epoll_wait for EPOLL_OUT,timeout&#x3D;0   |
    > smc_poll                           |
    > if (!smc-&gt;conn.sndbuf_space)     |
    > |  smc_cdc_tx_handler
    > |    atomic_add sndbuf_space
    > |    smc_tx_sndbuf_nonfull
    > |      if (!test_bit SOCK_NOSPACE)
    > |        do not sk_write_space;
    > set_bit SOCK_NOSPACE;          |
    > return mask&#x3D;0;                   |
    > Application will sleep in epoll_wait as smc_poll returns 0. And
    > smc_cdc_tx_handler will not call sk_write_space because the SOCK_NOSPACE
    > has not be set. If there is no inflight cdc msg, sk_write_space will not be
    > called any more, and application will sleep in epoll_wait forever.
    > So check sndbuf_space again after NOSPACE flag is set to break the race.
    > Fixes: 8dce2786a290 (&quot;net/smc: smc_poll improvements&quot;)
    > Signed-off-by: Guangguan Wang &lt;guangguan.wang@linux.alibaba.com&gt;
    > Suggested-by: Paolo Abeni &lt;pabeni@redhat.com&gt;
    > Signed-off-by: David S. Miller &lt;davem@davemloft.net&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ xfs: fix sb_spino_align checks for large fsblock sizes (@Darrick J. Wong in [07f2f8083a7ae22](https://github.com/sophgo/linux-riscv/commit/07f2f8083a7ae22) at 2024-12-27 13:02:01)
    > commit 7f8a44f37229fc76bfcafa341a4b8862368ef44a upstream.
    > For a sparse inodes filesystem, mkfs.xfs computes the values of
    > sb_spino_align and sb_inoalignmt with the following code:
    > int     cluster_size &#x3D; XFS_INODE_BIG_CLUSTER_SIZE;
    > if (cfg-&gt;sb_feat.crcs_enabled)
    > cluster_size *&#x3D; cfg-&gt;inodesize / XFS_DINODE_MIN_SIZE;
    > sbp-&gt;sb_spino_align &#x3D; cluster_size &gt;&gt; cfg-&gt;blocklog;
    > sbp-&gt;sb_inoalignmt &#x3D; XFS_INODES_PER_CHUNK *
    > cfg-&gt;inodesize &gt;&gt; cfg-&gt;blocklog;
    > On a V5 filesystem with 64k fsblocks and 512 byte inodes, this results
    > in cluster_size &#x3D; 8192 * (512 / 256) &#x3D; 16384.  As a result,
    > sb_spino_align and sb_inoalignmt are both set to zero.  Unfortunately,
    > this trips the new sb_spino_align check that was just added to
    > xfs_validate_sb_common, and the mkfs fails:
    > # mkfs.xfs -f -b size&#x3D;64k, /dev/sda
    > meta-data&#x3D;/dev/sda               isize&#x3D;512    agcount&#x3D;4, agsize&#x3D;81136 blks
    > &#x3D;                       sectsz&#x3D;512   attr&#x3D;2, projid32bit&#x3D;1
    > &#x3D;                       crc&#x3D;1        finobt&#x3D;1, sparse&#x3D;1, rmapbt&#x3D;1
    > &#x3D;                       reflink&#x3D;1    bigtime&#x3D;1 inobtcount&#x3D;1 nrext64&#x3D;1
    > &#x3D;                       exchange&#x3D;0   metadir&#x3D;0
    > data     &#x3D;                       bsize&#x3D;65536  blocks&#x3D;324544, imaxpct&#x3D;25
    > &#x3D;                       sunit&#x3D;0      swidth&#x3D;0 blks
    > naming   &#x3D;version 2              bsize&#x3D;65536  ascii-ci&#x3D;0, ftype&#x3D;1, parent&#x3D;0
    > log      &#x3D;internal log           bsize&#x3D;65536  blocks&#x3D;5006, version&#x3D;2
    > &#x3D;                       sectsz&#x3D;512   sunit&#x3D;0 blks, lazy-count&#x3D;1
    > realtime &#x3D;none                   extsz&#x3D;65536  blocks&#x3D;0, rtextents&#x3D;0
    > &#x3D;                       rgcount&#x3D;0    rgsize&#x3D;0 extents
    > Discarding blocks...Sparse inode alignment (0) is invalid.
    > Metadata corruption detected at 0x560ac5a80bbe, xfs_sb block 0x0/0x200
    > libxfs_bwrite: write verifier failed on xfs_sb bno 0x0/0x1
    > mkfs.xfs: Releasing dirty buffer to free list!
    > found dirty buffer (bulk) on free list!
    > Sparse inode alignment (0) is invalid.
    > Metadata corruption detected at 0x560ac5a80bbe, xfs_sb block 0x0/0x200
    > libxfs_bwrite: write verifier failed on xfs_sb bno 0x0/0x1
    > mkfs.xfs: writing AG headers failed, err&#x3D;22
    > Prior to commit 59e43f5479cce1 this all worked fine, even if &quot;sparse&quot;
    > inodes are somewhat meaningless when everything fits in a single
    > fsblock.  Adjust the checks to handle existing filesystems.
    > Cc: &lt;stable@vger.kernel.org&gt; # v6.13-rc1
    > Fixes: 59e43f5479cce1 (&quot;xfs: sb_spino_align is not verified&quot;)
    > Signed-off-by: &quot;Darrick J. Wong&quot; &lt;djwong@kernel.org&gt;
    > Reviewed-by: Christoph Hellwig &lt;hch@lst.de&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ erofs: reference &#x60;struct erofs_device_info&#x60; for erofs_map_dev (@Gao Xiang in [f067d3f69d19629](https://github.com/sophgo/linux-riscv/commit/f067d3f69d19629) at 2024-12-27 13:02:00)
    > [ Upstream commit f8d920a402aec3482931cb5f1539ed438740fc49 ]
    > Record &#x60;m_sb&#x60; and &#x60;m_dif&#x60; to replace &#x60;m_fscache&#x60;, &#x60;m_daxdev&#x60;, &#x60;m_fp&#x60;
    > and &#x60;m_dax_part_off&#x60; in order to simplify the codebase.
    > Note that &#x60;m_bdev&#x60; is still left since it can be assigned from
    > &#x60;sb-&gt;s_bdev&#x60; directly.
    > Reviewed-by: Chao Yu &lt;chao@kernel.org&gt;
    > Signed-off-by: Gao Xiang &lt;hsiangkao@linux.alibaba.com&gt;
    > Link: https://lore.kernel.org/r/20241212235401.2857246-1-hsiangkao@linux.alibaba.com
    > Stable-dep-of: 6422cde1b0d5 (&quot;erofs: use buffered I/O for file-backed mounts by default&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ erofs: add erofs_sb_free() helper (@Gao Xiang in [910798ecd33d45b](https://github.com/sophgo/linux-riscv/commit/910798ecd33d45b) at 2024-12-27 13:02:00)
    > [ Upstream commit e2de3c1bf6a0c99b089bd706a62da8f988918858 ]
    > Unify the common parts of erofs_fc_free() and erofs_kill_sb() as
    > erofs_sb_free().
    > Thus, fput() in erofs_fc_get_tree() is no longer needed, too.
    > Reviewed-by: Chao Yu &lt;chao@kernel.org&gt;
    > Signed-off-by: Gao Xiang &lt;hsiangkao@linux.alibaba.com&gt;
    > Link: https://lore.kernel.org/r/20241212133504.2047178-1-hsiangkao@linux.alibaba.com
    > Stable-dep-of: 6422cde1b0d5 (&quot;erofs: use buffered I/O for file-backed mounts by default&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ xfs: sb_spino_align is not verified (@Dave Chinner in [825fe7dae3b8a58](https://github.com/sophgo/linux-riscv/commit/825fe7dae3b8a58) at 2024-12-27 13:02:00)
    > commit 59e43f5479cce106d71c0b91a297c7ad1913176c upstream.
    > It&#x27;s just read in from the superblock and used without doing any
    > validity checks at all on the value.
    > Fixes: fb4f2b4e5a82 (&quot;xfs: add sparse inode chunk alignment superblock field&quot;)
    > Signed-off-by: Dave Chinner &lt;dchinner@redhat.com&gt;
    > Reviewed-by: Darrick J. Wong &lt;djwong@kernel.org&gt;
    > Signed-off-by: Carlos Maiolino &lt;cem@kernel.org&gt;
    > [djwong: actually tag for 6.12 because upstream maintainer ignored cc-stable tag]
    > Link: https://lore.kernel.org/linux-xfs/20241024165544.GI21853@frogsfrogsfrogs/
    > Signed-off-by: &quot;Darrick J. Wong&quot; &lt;djwong@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ xfs: fix off-by-one error in fsmap&#x27;s end_daddr usage (@Darrick J. Wong in [5ca4ca38bc74c2e](https://github.com/sophgo/linux-riscv/commit/5ca4ca38bc74c2e) at 2024-12-27 13:02:00)
    > commit a440a28ddbdcb861150987b4d6e828631656b92f upstream.
    > In commit ca6448aed4f10a, we created an &quot;end_daddr&quot; variable to fix
    > fsmap reporting when the end of the range requested falls in the middle
    > of an unknown (aka free on the rmapbt) region.  Unfortunately, I didn&#x27;t
    > notice that the the code sets end_daddr to the last sector of the device
    > but then uses that quantity to compute the length of the synthesized
    > mapping.
    > Zizhi Wo later observed that when end_daddr isn&#x27;t set, we still don&#x27;t
    > report the last fsblock on a device because in that case (aka when
    > info-&gt;last is true), the info-&gt;high mapping that we pass to
    > xfs_getfsmap_group_helper has a startblock that points to the last
    > fsblock.  This is also wrong because the code uses startblock to
    > compute the length of the synthesized mapping.
    > Fix the second problem by setting end_daddr unconditionally, and fix the
    > first problem by setting start_daddr to one past the end of the range to
    > query.
    > Cc: &lt;stable@vger.kernel.org&gt; # v6.11
    > Fixes: ca6448aed4f10a (&quot;xfs: Fix missing interval for missing_owner in xfs fsmap&quot;)
    > Signed-off-by: &quot;Darrick J. Wong&quot; &lt;djwong@kernel.org&gt;
    > Reported-by: Zizhi Wo &lt;wozizhi@huawei.com&gt;
    > Reviewed-by: Christoph Hellwig &lt;hch@lst.de&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ xfs: fix sparse inode limits on runt AG (@Dave Chinner in [5b935d8b7024c89](https://github.com/sophgo/linux-riscv/commit/5b935d8b7024c89) at 2024-12-27 13:02:00)
    > commit 13325333582d4820d39b9e8f63d6a54e745585d9 upstream.
    > The runt AG at the end of a filesystem is almost always smaller than
    > the mp-&gt;m_sb.sb_agblocks. Unfortunately, when setting the max_agbno
    > limit for the inode chunk allocation, we do not take this into
    > account. This means we can allocate a sparse inode chunk that
    > overlaps beyond the end of an AG. When we go to allocate an inode
    > from that sparse chunk, the irec fails validation because the
    > agbno of the start of the irec is beyond valid limits for the runt
    > AG.
    > Prevent this from happening by taking into account the size of the
    > runt AG when allocating inode chunks. Also convert the various
    > checks for valid inode chunk agbnos to use xfs_ag_block_count()
    > so that they will also catch such issues in the future.
    > Fixes: 56d1115c9bc7 (&quot;xfs: allocate sparse inode chunks on full chunk allocation failure&quot;)
    > Signed-off-by: Dave Chinner &lt;dchinner@redhat.com&gt;
    > Reviewed-by: Darrick J. Wong &lt;djwong@kernel.org&gt;
    > Signed-off-by: Carlos Maiolino &lt;cem@kernel.org&gt;
    > [djwong: backport to stable because upstream maintainer ignored cc-stable]
    > Link: https://lore.kernel.org/linux-xfs/20241112231539.GG9438@frogsfrogsfrogs/
    > Signed-off-by: &quot;Darrick J. Wong&quot; &lt;djwong@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ erofs: use &#x60;struct erofs_device_info&#x60; for the primary device (@Gao Xiang in [3e0d81efcb45d53](https://github.com/sophgo/linux-riscv/commit/3e0d81efcb45d53) at 2024-12-27 13:02:00)
    > [ Upstream commit 7b00af2c5414dc01e0718deef7ead81102867636 ]
    > Instead of just listing each one directly in &#x60;struct erofs_sb_info&#x60;
    > except that we still use &#x60;sb-&gt;s_bdev&#x60; for the primary block device.
    > Reviewed-by: Chao Yu &lt;chao@kernel.org&gt;
    > Signed-off-by: Gao Xiang &lt;hsiangkao@linux.alibaba.com&gt;
    > Link: https://lore.kernel.org/r/20241216125310.930933-2-hsiangkao@linux.alibaba.com
    > Stable-dep-of: 6422cde1b0d5 (&quot;erofs: use buffered I/O for file-backed mounts by default&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ erofs: use buffered I/O for file-backed mounts by default (@Gao Xiang in [30424481090d8e0](https://github.com/sophgo/linux-riscv/commit/30424481090d8e0) at 2024-12-27 13:02:00)
    > [ Upstream commit 6422cde1b0d5a31b206b263417c1c2b3c80fe82c ]
    > For many use cases (e.g. container images are just fetched from remote),
    > performance will be impacted if underlay page cache is up-to-date but
    > direct i/o flushes dirty pages first.
    > Instead, let&#x27;s use buffered I/O by default to keep in sync with loop
    > devices and add a (re)mount option to explicitly give a try to use
    > direct I/O if supported by the underlying files.
    > The container startup time is improved as below:
    > [workload] docker.io/library/workpress:latest
    > unpack        1st run  non-1st runs
    > EROFS snapshotter buffered I/O file  4.586404265s  0.308s   0.198s
    > EROFS snapshotter direct I/O file    4.581742849s  2.238s   0.222s
    > EROFS snapshotter loop               4.596023152s  0.346s   0.201s
    > Overlayfs snapshotter                5.382851037s  0.206s   0.214s
    > Fixes: fb176750266a (&quot;erofs: add file-backed mount support&quot;)
    > Cc: Derek McGowan &lt;derek@mcg.dev&gt;
    > Reviewed-by: Chao Yu &lt;chao@kernel.org&gt;
    > Signed-off-by: Gao Xiang &lt;hsiangkao@linux.alibaba.com&gt;
    > Link: https://lore.kernel.org/r/20241212134336.2059899-1-hsiangkao@linux.alibaba.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ sched/dlserver: Fix dlserver double enqueue (@Vineeth Pillai (Google) in [bdd68033d11a90b](https://github.com/sophgo/linux-riscv/commit/bdd68033d11a90b) at 2024-12-27 13:01:59)
    > [ Upstream commit b53127db1dbf7f1047cf35c10922d801dcd40324 ]
    > dlserver can get dequeued during a dlserver pick_task due to the delayed
    > deueue feature and this can lead to issues with dlserver logic as it
    > still thinks that dlserver is on the runqueue. The dlserver throttling
    > and replenish logic gets confused and can lead to double enqueue of
    > dlserver.
    > Double enqueue of dlserver could happend due to couple of reasons:
    > Case 1
    > ------
    > Delayed dequeue feature[1] can cause dlserver being stopped during a
    > pick initiated by dlserver:
    > __pick_next_task
    > pick_task_dl -&gt; server_pick_task
    > pick_task_fair
    > pick_next_entity (if (sched_delayed))
    > dequeue_entities
    > dl_server_stop
    > server_pick_task goes ahead with update_curr_dl_se without knowing that
    > dlserver is dequeued and this confuses the logic and may lead to
    > unintended enqueue while the server is stopped.
    > Case 2
    > ------
    > A race condition between a task dequeue on one cpu and same task&#x27;s enqueue
    > on this cpu by a remote cpu while the lock is released causing dlserver
    > double enqueue.
    > One cpu would be in the schedule() and releasing RQ-lock:
    > current-&gt;state &#x3D; TASK_INTERRUPTIBLE();
    > schedule();
    > deactivate_task()
    > dl_stop_server();
    > pick_next_task()
    > pick_next_task_fair()
    > sched_balance_newidle()
    > rq_unlock(this_rq)
    > at which point another CPU can take our RQ-lock and do:
    > try_to_wake_up()
    > ttwu_queue()
    > rq_lock()
    > ...
    > activate_task()
    > dl_server_start() --&gt; first enqueue
    > wakeup_preempt() :&#x3D; check_preempt_wakeup_fair()
    > update_curr()
    > update_curr_task()
    > if (current-&gt;dl_server)
    > dl_server_update()
    > enqueue_dl_entity() --&gt; second enqueue
    > This bug was not apparent as the enqueue in dl_server_start doesn&#x27;t
    > usually happen because of the defer logic. But as a side effect of the
    > first case(dequeue during dlserver pick), dl_throttled and dl_yield will
    > be set and this causes the time accounting of dlserver to messup and
    > then leading to a enqueue in dl_server_start.
    > Have an explicit flag representing the status of dlserver to avoid the
    > confusion. This is set in dl_server_start and reset in dlserver_stop.
    > Fixes: 63ba8422f876 (&quot;sched/deadline: Introduce deadline servers&quot;)
    > Suggested-by: Peter Zijlstra &lt;peterz@infradead.org&gt;
    > Signed-off-by: &quot;Vineeth Pillai (Google)&quot; &lt;vineeth@bitbyteword.org&gt;
    > Signed-off-by: Peter Zijlstra (Intel) &lt;peterz@infradead.org&gt;
    > Tested-by: Marcel Ziswiler &lt;marcel.ziswiler@codethink.co.uk&gt; # ROCK 5B
    > Link: https://lkml.kernel.org/r/20241213032244.877029-1-vineeth@bitbyteword.org
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ sched/dlserver: Fix dlserver time accounting (@Vineeth Pillai (Google) in [baedaacee165744](https://github.com/sophgo/linux-riscv/commit/baedaacee165744) at 2024-12-27 13:01:59)
    > [ Upstream commit c7f7e9c73178e0e342486fd31e7f363ef60e3f83 ]
    > dlserver time is accounted when:
    > - dlserver is active and the dlserver proxies the cfs task.
    > - dlserver is active but deferred and cfs task runs after being picked
    > through the normal fair class pick.
    > dl_server_update is called in two places to make sure that both the
    > above times are accounted for. But it doesn&#x27;t check if dlserver is
    > active or not. Now that we have this dl_server_active flag, we can
    > consolidate dl_server_update into one place and all we need to check is
    > whether dlserver is active or not. When dlserver is active there is only
    > two possible conditions:
    > - dlserver is deferred.
    > - cfs task is running on behalf of dlserver.
    > Fixes: a110a81c52a9 (&quot;sched/deadline: Deferrable dl server&quot;)
    > Signed-off-by: &quot;Vineeth Pillai (Google)&quot; &lt;vineeth@bitbyteword.org&gt;
    > Signed-off-by: Peter Zijlstra (Intel) &lt;peterz@infradead.org&gt;
    > Tested-by: Marcel Ziswiler &lt;marcel.ziswiler@codethink.co.uk&gt; # ROCK 5B
    > Link: https://lore.kernel.org/r/20241213032244.877029-2-vineeth@bitbyteword.org
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ i2c: pnx: Fix timeout in wait functions (@Vladimir Riabchun in [9945c014cb01397](https://github.com/sophgo/linux-riscv/commit/9945c014cb01397) at 2024-12-27 13:01:59)
    > [ Upstream commit 7363f2d4c18557c99c536b70489187bb4e05c412 ]
    > Since commit f63b94be6942 (&quot;i2c: pnx: Fix potential deadlock warning
    > from del_timer_sync() call in isr&quot;) jiffies are stored in
    > i2c_pnx_algo_data.timeout, but wait_timeout and wait_reset are still
    > using it as milliseconds. Convert jiffies back to milliseconds to wait
    > for the expected amount of time.
    > Fixes: f63b94be6942 (&quot;i2c: pnx: Fix potential deadlock warning from del_timer_sync() call in isr&quot;)
    > Signed-off-by: Vladimir Riabchun &lt;ferr.lambarginio@gmail.com&gt;
    > Signed-off-by: Andi Shyti &lt;andi.shyti@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ s390/ipl: Fix never less than zero warning (@Alexander Gordeev in [97645ed2f3eb15a](https://github.com/sophgo/linux-riscv/commit/97645ed2f3eb15a) at 2024-12-27 13:01:59)
    > [ Upstream commit 5fa49dd8e521a42379e5e41fcf2c92edaaec0a8b ]
    > DEFINE_IPL_ATTR_STR_RW() macro produces &quot;unsigned &#x27;len&#x27; is never less
    > than zero.&quot; warning when sys_vmcmd_on_*_store() callbacks are defined.
    > Reported-by: kernel test robot &lt;lkp@intel.com&gt;
    > Closes: https://lore.kernel.org/oe-kbuild-all/202412081614.5uel8F6W-lkp@intel.com/
    > Fixes: 247576bf624a (&quot;s390/ipl: Do not accept z/VM CP diag X&#x27;008&#x27; cmds longer than max length&quot;)
    > Reviewed-by: Heiko Carstens &lt;hca@linux.ibm.com&gt;
    > Signed-off-by: Alexander Gordeev &lt;agordeev@linux.ibm.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ s390/mm: Consider KMSAN modules metadata for paging levels (@Vasily Gorbik in [532d40c321fb857](https://github.com/sophgo/linux-riscv/commit/532d40c321fb857) at 2024-12-27 13:01:59)
    > [ Upstream commit 282da38b465395c930687974627c24f47ddce5ff ]
    > The calculation determining whether to use three- or four-level paging
    > didn&#x27;t account for KMSAN modules metadata. Include this metadata in the
    > virtual memory size calculation to ensure correct paging mode selection
    > and avoiding potentially unnecessary physical memory size limitations.
    > Fixes: 65ca73f9fb36 (&quot;s390/mm: define KMSAN metadata for vmalloc and modules&quot;)
    > Acked-by: Heiko Carstens &lt;hca@linux.ibm.com&gt;
    > Reviewed-by: Alexander Gordeev &lt;agordeev@linux.ibm.com&gt;
    > Reviewed-by: Ilya Leoshkevich &lt;iii@linux.ibm.com&gt;
    > Signed-off-by: Vasily Gorbik &lt;gor@linux.ibm.com&gt;
    > Signed-off-by: Alexander Gordeev &lt;agordeev@linux.ibm.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ erofs: fix PSI memstall accounting (@Gao Xiang in [0653fa6ee045965](https://github.com/sophgo/linux-riscv/commit/0653fa6ee045965) at 2024-12-27 13:01:59)
    > [ Upstream commit 1a2180f6859c73c674809f9f82e36c94084682ba ]
    > Max Kellermann recently reported psi_group_cpu.tasks[NR_MEMSTALL] is
    > incorrect in the 6.11.9 kernel.
    > The root cause appears to be that, since the problematic commit, bio
    > can be NULL, causing psi_memstall_leave() to be skipped in
    > z_erofs_submit_queue().
    > Reported-by: Max Kellermann &lt;max.kellermann@ionos.com&gt;
    > Closes: https://lore.kernel.org/r/CAKPOu+8tvSowiJADW2RuKyofL_CSkm_SuyZA7ME5vMLWmL6pqw@mail.gmail.com
    > Fixes: 9e2f9d34dd12 (&quot;erofs: handle overlapped pclusters out of crafted images properly&quot;)
    > Reviewed-by: Chao Yu &lt;chao@kernel.org&gt;
    > Signed-off-by: Gao Xiang &lt;hsiangkao@linux.alibaba.com&gt;
    > Link: https://lore.kernel.org/r/20241127085236.3538334-1-hsiangkao@linux.alibaba.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ sched/eevdf: More PELT vs DELAYED_DEQUEUE (@Peter Zijlstra in [ecffd162e97eec8](https://github.com/sophgo/linux-riscv/commit/ecffd162e97eec8) at 2024-12-27 13:01:58)
    > [ Upstream commit 76f2f783294d7d55c2564e2dfb0a7279ba0bc264 ]
    > Vincent and Dietmar noted that while
    > commit fc1892becd56 (&quot;sched/eevdf: Fixup PELT vs DELAYED_DEQUEUE&quot;) fixes
    > the entity runnable stats, it does not adjust the cfs_rq runnable stats,
    > which are based off of h_nr_running.
    > Track h_nr_delayed such that we can discount those and adjust the
    > signal.
    > Fixes: fc1892becd56 (&quot;sched/eevdf: Fixup PELT vs DELAYED_DEQUEUE&quot;)
    > Closes: https://lore.kernel.org/lkml/a9a45193-d0c6-4ba2-a822-464ad30b550e@arm.com/
    > Closes: https://lore.kernel.org/lkml/CAKfTPtCNUvWE_GX5LyvTF-WdxUT&#x3D;ZgvZZv-4t&#x3D;eWntg5uOFqiQ@mail.gmail.com/
    > [ Fixes checkpatch warnings and rebased ]
    > Signed-off-by: Peter Zijlstra (Intel) &lt;peterz@infradead.org&gt;
    > Reported-by: Dietmar Eggemann &lt;dietmar.eggemann@arm.com&gt;
    > Reported-by: Vincent Guittot &lt;vincent.guittot@linaro.org&gt;
    > Signed-off-by: &quot;Peter Zijlstra (Intel)&quot; &lt;peterz@infradead.org&gt;
    > Signed-off-by: Vincent Guittot &lt;vincent.guittot@linaro.org&gt;
    > Signed-off-by: Peter Zijlstra (Intel) &lt;peterz@infradead.org&gt;
    > Reviewed-by: Dietmar Eggemann &lt;dietmar.eggemann@arm.com&gt;
    > Tested-by: K Prateek Nayak &lt;kprateek.nayak@amd.com&gt;
    > Link: https://lore.kernel.org/r/20241202174606.4074512-3-vincent.guittot@linaro.org
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ p2sb: Factor out p2sb_read_from_cache() (@Shin&#x27;ichiro Kawasaki in [e6e1555d217063f](https://github.com/sophgo/linux-riscv/commit/e6e1555d217063f) at 2024-12-27 13:01:58)
    > [ Upstream commit 9244524d60ddea55f4df54c51200e8fef2032447 ]
    > To prepare for the following fix, factor out the code to read the P2SB
    > resource from the cache to the new function p2sb_read_from_cache().
    > Signed-off-by: Shin&#x27;ichiro Kawasaki &lt;shinichiro.kawasaki@wdc.com&gt;
    > Reviewed-by: Hans de Goede &lt;hdegoede@redhat.com&gt;
    > Link: https://lore.kernel.org/r/20241128002836.373745-2-shinichiro.kawasaki@wdc.com
    > Reviewed-by: Ilpo Järvinen &lt;ilpo.jarvinen@linux.intel.com&gt;
    > Signed-off-by: Ilpo Järvinen &lt;ilpo.jarvinen@linux.intel.com&gt;
    > Stable-dep-of: 360c400d0f56 (&quot;p2sb: Do not scan and remove the P2SB device when it is unhidden&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ p2sb: Introduce the global flag p2sb_hidden_by_bios (@Shin&#x27;ichiro Kawasaki in [de96c4de9c87bf2](https://github.com/sophgo/linux-riscv/commit/de96c4de9c87bf2) at 2024-12-27 13:01:58)
    > [ Upstream commit ae3e6ebc5ab046d434c05c58a3e3f7e94441fec2 ]
    > To prepare for the following fix, introduce the global flag
    > p2sb_hidden_by_bios. Check if the BIOS hides the P2SB device and store
    > the result in the flag. This allows to refer to the check result across
    > functions.
    > Signed-off-by: Shin&#x27;ichiro Kawasaki &lt;shinichiro.kawasaki@wdc.com&gt;
    > Reviewed-by: Hans de Goede &lt;hdegoede@redhat.com&gt;
    > Link: https://lore.kernel.org/r/20241128002836.373745-3-shinichiro.kawasaki@wdc.com
    > Reviewed-by: Ilpo Järvinen &lt;ilpo.jarvinen@linux.intel.com&gt;
    > Signed-off-by: Ilpo Järvinen &lt;ilpo.jarvinen@linux.intel.com&gt;
    > Stable-dep-of: 360c400d0f56 (&quot;p2sb: Do not scan and remove the P2SB device when it is unhidden&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ p2sb: Do not scan and remove the P2SB device when it is unhidden (@Shin&#x27;ichiro Kawasaki in [68298822cc958a1](https://github.com/sophgo/linux-riscv/commit/68298822cc958a1) at 2024-12-27 13:01:58)
    > [ Upstream commit 360c400d0f568636c1b98d1d5f9f49aa3d420c70 ]
    > When drivers access P2SB device resources, it calls p2sb_bar(). Before
    > the commit 5913320eb0b3 (&quot;platform/x86: p2sb: Allow p2sb_bar() calls
    > during PCI device probe&quot;), p2sb_bar() obtained the resources and then
    > called pci_stop_and_remove_bus_device() for clean up. Then the P2SB
    > device disappeared. The commit 5913320eb0b3 introduced the P2SB device
    > resource cache feature in the boot process. During the resource cache,
    > pci_stop_and_remove_bus_device() is called for the P2SB device, then the
    > P2SB device disappears regardless of whether p2sb_bar() is called or
    > not. Such P2SB device disappearance caused a confusion [1]. To avoid the
    > confusion, avoid the pci_stop_and_remove_bus_device() call when the BIOS
    > does not hide the P2SB device.
    > For that purpose, cache the P2SB device resources only if the BIOS hides
    > the P2SB device. Call p2sb_scan_and_cache() only if p2sb_hidden_by_bios
    > is true. This allows removing two branches from p2sb_scan_and_cache().
    > When p2sb_bar() is called, get the resources from the cache if the P2SB
    > device is hidden. Otherwise, read the resources from the unhidden P2SB
    > device.
    > Reported-by: Daniel Walker (danielwa) &lt;danielwa@cisco.com&gt;
    > Closes: https://lore.kernel.org/lkml/ZzTI+biIUTvFT6NC@goliath/ [1]
    > Fixes: 5913320eb0b3 (&quot;platform/x86: p2sb: Allow p2sb_bar() calls during PCI device probe&quot;)
    > Signed-off-by: Shin&#x27;ichiro Kawasaki &lt;shinichiro.kawasaki@wdc.com&gt;
    > Reviewed-by: Hans de Goede &lt;hdegoede@redhat.com&gt;
    > Link: https://lore.kernel.org/r/20241128002836.373745-5-shinichiro.kawasaki@wdc.com
    > Reviewed-by: Ilpo Järvinen &lt;ilpo.jarvinen@linux.intel.com&gt;
    > Signed-off-by: Ilpo Järvinen &lt;ilpo.jarvinen@linux.intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ sched/fair: Fix NEXT_BUDDY (@K Prateek Nayak in [5dbe6816c491976](https://github.com/sophgo/linux-riscv/commit/5dbe6816c491976) at 2024-12-27 13:01:58)
    > [ Upstream commit 493afbd187c4c9cc1642792c0d9ba400c3d6d90d ]
    > Adam reports that enabling NEXT_BUDDY insta triggers a WARN in
    > pick_next_entity().
    > Moving clear_buddies() up before the delayed dequeue bits ensures
    > no -&gt;next buddy becomes delayed. Further ensure no new -&gt;next buddy
    > ever starts as delayed.
    > Fixes: 152e11f6df29 (&quot;sched/fair: Implement delayed dequeue&quot;)
    > Reported-by: Adam Li &lt;adamli@os.amperecomputing.com&gt;
    > Signed-off-by: K Prateek Nayak &lt;kprateek.nayak@amd.com&gt;
    > Signed-off-by: Peter Zijlstra (Intel) &lt;peterz@infradead.org&gt;
    > Tested-by: Adam Li &lt;adamli@os.amperecomputing.com&gt;
    > Link: https://lkml.kernel.org/r/670a0d54-e398-4b1f-8a6e-90784e2fdf89@amd.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ p2sb: Move P2SB hide and unhide code to p2sb_scan_and_cache() (@Shin&#x27;ichiro Kawasaki in [5969df5eaad46bb](https://github.com/sophgo/linux-riscv/commit/5969df5eaad46bb) at 2024-12-27 13:01:58)
    > [ Upstream commit 0286070c74ee48391fc07f7f617460479472d221 ]
    > To prepare for the following fix, move the code to hide and unhide the
    > P2SB device from p2sb_cache_resources() to p2sb_scan_and_cache().
    > Signed-off-by: Shin&#x27;ichiro Kawasaki &lt;shinichiro.kawasaki@wdc.com&gt;
    > Reviewed-by: Hans de Goede &lt;hdegoede@redhat.com&gt;
    > Link: https://lore.kernel.org/r/20241128002836.373745-4-shinichiro.kawasaki@wdc.com
    > Reviewed-by: Ilpo Järvinen &lt;ilpo.jarvinen@linux.intel.com&gt;
    > Signed-off-by: Ilpo Järvinen &lt;ilpo.jarvinen@linux.intel.com&gt;
    > Stable-dep-of: 360c400d0f56 (&quot;p2sb: Do not scan and remove the P2SB device when it is unhidden&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ sched/fair: Fix sched_can_stop_tick() for fair tasks (@Vincent Guittot in [0ee98301f1f026e](https://github.com/sophgo/linux-riscv/commit/0ee98301f1f026e) at 2024-12-27 13:01:58)
    > [ Upstream commit c1f43c342e1f2e32f0620bf2e972e2a9ea0a1e60 ]
    > We can&#x27;t stop the tick of a rq if there are at least 2 tasks enqueued in
    > the whole hierarchy and not only at the root cfs rq.
    > rq-&gt;cfs.nr_running tracks the number of sched_entity at one level
    > whereas rq-&gt;cfs.h_nr_running tracks all queued tasks in the
    > hierarchy.
    > Fixes: 11cc374f4643b (&quot;sched_ext: Simplify scx_can_stop_tick() invocation in sched_can_stop_tick()&quot;)
    > Signed-off-by: Vincent Guittot &lt;vincent.guittot@linaro.org&gt;
    > Signed-off-by: Peter Zijlstra (Intel) &lt;peterz@infradead.org&gt;
    > Reviewed-by: Dietmar Eggemann &lt;dietmar.eggemann@arm.com&gt;
    > Link: https://lore.kernel.org/r/20241202174606.4074512-2-vincent.guittot@linaro.org
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ net: sched: fix ordering of qlen adjustment (@Lion Ackermann in [e3e54ad9eff8bda](https://github.com/sophgo/linux-riscv/commit/e3e54ad9eff8bda) at 2024-12-27 13:01:57)
    > commit 5eb7de8cd58e73851cd37ff8d0666517d9926948 upstream.
    > Changes to sch-&gt;q.qlen around qdisc_tree_reduce_backlog() need to happen
    > _before_ a call to said function because otherwise it may fail to notify
    > parent qdiscs when the child is about to become empty.
    > Signed-off-by: Lion Ackermann &lt;nnamrec@gmail.com&gt;
    > Acked-by: Toke Høiland-Jørgensen &lt;toke@toke.dk&gt;
    > Signed-off-by: David S. Miller &lt;davem@davemloft.net&gt;
    > Cc: Artem Metla &lt;ametla@google.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ firmware: arm_scmi: Fix i.MX build dependency (@Arnd Bergmann in [e385c781a3052b8](https://github.com/sophgo/linux-riscv/commit/e385c781a3052b8) at 2024-12-27 13:01:57)
    > [ Upstream commit 514b2262ade48a0503ac6aa03c3bfb8c5be69b21 ]
    > The newly added SCMI vendor driver references functions in the
    > protocol driver but needs a Kconfig dependency to ensure it can link,
    > essentially the Kconfig dependency needs to be reversed to match the
    > link time dependency:
    > |  arm-linux-gnueabi-ld: sound/soc/fsl/fsl_mqs.o: in function &#x60;fsl_mqs_sm_write&#x27;:
    > |  	fsl_mqs.c:(.text+0x1aa): undefined reference to &#x60;scmi_imx_misc_ctrl_set&#x27;
    > |  arm-linux-gnueabi-ld: sound/soc/fsl/fsl_mqs.o: in function &#x60;fsl_mqs_sm_read&#x27;:
    > |  	fsl_mqs.c:(.text+0x1ee): undefined reference to &#x60;scmi_imx_misc_ctrl_get&#x27;
    > This however only works after changing the dependency in the SND_SOC_FSL_MQS
    > driver as well, which uses &#x27;select IMX_SCMI_MISC_DRV&#x27; to turn on a
    > driver it depends on. This is generally a bad idea, so the best solution
    > is to change that into a dependency.
    > To allow the ASoC driver to keep building with the SCMI support, this
    > needs to be an optional dependency that enforces the link-time
    > dependency if IMX_SCMI_MISC_DRV is a loadable module but not
    > depend on it if that is disabled.
    > Fixes: 61c9f03e22fc (&quot;firmware: arm_scmi: Add initial support for i.MX MISC protocol&quot;)
    > Fixes: 101c9023594a (&quot;ASoC: fsl_mqs: Support accessing registers by scmi interface&quot;)
    > Signed-off-by: Arnd Bergmann &lt;arnd@arndb.de&gt;
    > Acked-by: Mark Brown &lt;broonie@kernel.org&gt;
    > Acked-by: Shengjiu Wang &lt;shengjiu.wang@gmail.com&gt;
    > Message-Id: &lt;20241115230555.2435004-1-arnd@kernel.org&gt;
    > Signed-off-by: Sudeep Holla &lt;sudeep.holla@arm.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ net: stmmac: fix TSO DMA API usage causing oops (@Russell King (Oracle) in [9d5dd7ccea1b46a](https://github.com/sophgo/linux-riscv/commit/9d5dd7ccea1b46a) at 2024-12-27 13:01:57)
    > [ Upstream commit 4c49f38e20a57f8abaebdf95b369295b153d1f8e ]
    > Commit 66600fac7a98 (&quot;net: stmmac: TSO: Fix unbalanced DMA map/unmap
    > for non-paged SKB data&quot;) moved the assignment of tx_skbuff_dma[]&#x27;s
    > members to be later in stmmac_tso_xmit().
    > The buf (dma cookie) and len stored in this structure are passed to
    > dma_unmap_single() by stmmac_tx_clean(). The DMA API requires that
    > the dma cookie passed to dma_unmap_single() is the same as the value
    > returned from dma_map_single(). However, by moving the assignment
    > later, this is not the case when priv-&gt;dma_cap.addr64 &gt; 32 as &quot;des&quot;
    > is offset by proto_hdr_len.
    > This causes problems such as:
    > dwc-eth-dwmac 2490000.ethernet eth0: Tx DMA map failed
    > and with DMA_API_DEBUG enabled:
    > DMA-API: dwc-eth-dwmac 2490000.ethernet: device driver tries to +free DMA memory it has not allocated [device address&#x3D;0x000000ffffcf65c0] [size&#x3D;66 bytes]
    > Fix this by maintaining &quot;des&quot; as the original DMA cookie, and use
    > tso_des to pass the offset DMA cookie to stmmac_tso_allocator().
    > Full details of the crashes can be found at:
    > https://lore.kernel.org/all/d8112193-0386-4e14-b516-37c2d838171a@nvidia.com/
    > https://lore.kernel.org/all/klkzp5yn5kq5efgtrow6wbvnc46bcqfxs65nz3qy77ujr5turc@bwwhelz2l4dw/
    > Reported-by: Jon Hunter &lt;jonathanh@nvidia.com&gt;
    > Reported-by: Thierry Reding &lt;thierry.reding@gmail.com&gt;
    > Fixes: 66600fac7a98 (&quot;net: stmmac: TSO: Fix unbalanced DMA map/unmap for non-paged SKB data&quot;)
    > Tested-by: Jon Hunter &lt;jonathanh@nvidia.com&gt;
    > Signed-off-by: Russell King (Oracle) &lt;rmk+kernel@armlinux.org.uk&gt;
    > Reviewed-by: Furong Xu &lt;0x1207@gmail.com&gt;
    > Link: https://patch.msgid.link/E1tJXcx-006N4Z-PC@rmk-PC.armlinux.org.uk
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ firmware: arm_ffa: Fix the race around setting ffa_dev-&gt;properties (@Levi Yun in [891c43f4f9a8c67](https://github.com/sophgo/linux-riscv/commit/891c43f4f9a8c67) at 2024-12-27 13:01:57)
    > [ Upstream commit 6fe437cfe2cdc797b03f63b338a13fac96ed6a08 ]
    > Currently, ffa_dev-&gt;properties is set after the ffa_device_register()
    > call return in ffa_setup_partitions(). This could potentially result in
    > a race where the partition&#x27;s properties is accessed while probing
    > struct ffa_device before it is set.
    > Update the ffa_device_register() to receive ffa_partition_info so all
    > the data from the partition information received from the firmware can
    > be updated into the struct ffa_device before the calling device_register()
    > in ffa_device_register().
    > Fixes: e781858488b9 (&quot;firmware: arm_ffa: Add initial FFA bus support for device enumeration&quot;)
    > Signed-off-by: Levi Yun &lt;yeoreum.yun@arm.com&gt;
    > Message-Id: &lt;20241203143109.1030514-2-yeoreum.yun@arm.com&gt;
    > Signed-off-by: Sudeep Holla &lt;sudeep.holla@arm.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ RISC-V: KVM: Fix csr_write -&gt; csr_set for HVIEN PMU overflow bit (@Michael Neuling in [5d4380ec054e7bc](https://github.com/sophgo/linux-riscv/commit/5d4380ec054e7bc) at 2024-12-27 13:01:57)
    > [ Upstream commit ea6398a5af81e3e7fb3da5d261694d479a321fd9 ]
    > This doesn&#x27;t cause a problem currently as HVIEN isn&#x27;t used elsewhere
    > yet. Found by inspection.
    > Signed-off-by: Michael Neuling &lt;michaelneuling@tenstorrent.com&gt;
    > Fixes: 16b0bde9a37c (&quot;RISC-V: KVM: Add perf sampling support for guests&quot;)
    > Reviewed-by: Atish Patra &lt;atishp@rivosinc.com&gt;
    > Reviewed-by: Anup Patel &lt;anup@brainfault.org&gt;
    > Link: https://lore.kernel.org/r/20241127041840.419940-1-michaelneuling@tenstorrent.com
    > Signed-off-by: Anup Patel &lt;anup@brainfault.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ x86/xen: remove hypercall page (@Juergen Gross in [f6e1c44d731a9fc](https://github.com/sophgo/linux-riscv/commit/f6e1c44d731a9fc) at 2024-12-19 17:13:24)
    > commit 7fa0da5373685e7ed249af3fa317ab1e1ba8b0a6 upstream.
    > The hypercall page is no longer needed. It can be removed, as from the
    > Xen perspective it is optional.
    > But, from Linux&#x27;s perspective, it removes naked RET instructions that
    > escape the speculative protections that Call Depth Tracking and/or
    > Untrain Ret are trying to achieve.
    > This is part of XSA-466 / CVE-2024-53241.
    > Reported-by: Andrew Cooper &lt;andrew.cooper3@citrix.com&gt;
    > Signed-off-by: Juergen Gross &lt;jgross@suse.com&gt;
    > Reviewed-by: Andrew Cooper &lt;andrew.cooper3@citrix.com&gt;
    > Reviewed-by: Jan Beulich &lt;jbeulich@suse.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ Linux 6.12.6 (@Greg Kroah-Hartman in [e9d65b48ce1aba5](https://github.com/sophgo/linux-riscv/commit/e9d65b48ce1aba5) at 2024-12-19 17:13:24)
    > Link: https://lore.kernel.org/r/20241217170546.209657098@linuxfoundation.org
    > Tested-by: Ronald Warsow &lt;rwarsow@gmx.de&gt;
    > Tested-by: Florian Fainelli &lt;florian.fainelli@broadcom.com&gt;
    > Tested-by: Shuah Khan &lt;skhan@linuxfoundation.org&gt;
    > Tested-by: Ron Economos &lt;re@w6rz.net&gt;
    > Tested-by: Takeshi Ogasawara &lt;takeshi.ogasawara@futuring-girl.com&gt;
    > Tested-by: Mark Brown &lt;broonie@kernel.org&gt;
    > Tested-by: Peter Schneider &lt;pschneider1968@googlemail.com&gt;
    > Tested-by: Salvatore Bonaccorso &lt;carnil@debian.org&gt;
    > Tested-by: Jon Hunter &lt;jonathanh@nvidia.com&gt;
    > Tested-by: Justin M. Forbes &lt;jforbes@fedoraproject.org&gt;
    > Tested-by: Harshit Mogalapalli &lt;harshit.m.mogalapalli@oracle.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ x86/static-call: fix 32-bit build (@Juergen Gross in [5013bd1e23dc00d](https://github.com/sophgo/linux-riscv/commit/5013bd1e23dc00d) at 2024-12-19 17:13:24)
    > commit 349f0086ba8b2a169877d21ff15a4d9da3a60054 upstream.
    > In 32-bit x86 builds CONFIG_STATIC_CALL_INLINE isn&#x27;t set, leading to
    > static_call_initialized not being available.
    > Define it as &quot;0&quot; in that case.
    > Reported-by: Stephen Rothwell &lt;sfr@canb.auug.org.au&gt;
    > Fixes: 0ef8047b737d (&quot;x86/static-call: provide a way to do very early static-call updates&quot;)
    > Signed-off-by: Juergen Gross &lt;jgross@suse.com&gt;
    > Acked-by: Peter Zijlstra (Intel) &lt;peterz@infradead.org&gt;
    > Signed-off-by: Linus Torvalds &lt;torvalds@linux-foundation.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ x86/static-call: provide a way to do very early static-call updates (@Juergen Gross in [fa0f23a60ea5c20](https://github.com/sophgo/linux-riscv/commit/fa0f23a60ea5c20) at 2024-12-19 17:13:23)
    > commit 0ef8047b737d7480a5d4c46d956e97c190f13050 upstream.
    > Add static_call_update_early() for updating static-call targets in
    > very early boot.
    > This will be needed for support of Xen guest type specific hypercall
    > functions.
    > This is part of XSA-466 / CVE-2024-53241.
    > Reported-by: Andrew Cooper &lt;andrew.cooper3@citrix.com&gt;
    > Signed-off-by: Juergen Gross &lt;jgross@suse.com&gt;
    > Co-developed-by: Peter Zijlstra &lt;peterz@infradead.org&gt;
    > Co-developed-by: Josh Poimboeuf &lt;jpoimboe@redhat.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ x86/xen: don&#x27;t do PV iret hypercall through hypercall page (@Juergen Gross in [f7c3fdad0a47406](https://github.com/sophgo/linux-riscv/commit/f7c3fdad0a47406) at 2024-12-19 17:13:23)
    > commit a2796dff62d6c6bfc5fbebdf2bee0d5ac0438906 upstream.
    > Instead of jumping to the Xen hypercall page for doing the iret
    > hypercall, directly code the required sequence in xen-asm.S.
    > This is done in preparation of no longer using hypercall page at all,
    > as it has shown to cause problems with speculation mitigations.
    > This is part of XSA-466 / CVE-2024-53241.
    > Reported-by: Andrew Cooper &lt;andrew.cooper3@citrix.com&gt;
    > Signed-off-by: Juergen Gross &lt;jgross@suse.com&gt;
    > Reviewed-by: Jan Beulich &lt;jbeulich@suse.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ objtool/x86: allow syscall instruction (@Juergen Gross in [c6eef3643608616](https://github.com/sophgo/linux-riscv/commit/c6eef3643608616) at 2024-12-19 17:13:23)
    > commit dda014ba59331dee4f3b773a020e109932f4bd24 upstream.
    > The syscall instruction is used in Xen PV mode for doing hypercalls.
    > Allow syscall to be used in the kernel in case it is tagged with an
    > unwind hint for objtool.
    > This is part of XSA-466 / CVE-2024-53241.
    > Reported-by: Andrew Cooper &lt;andrew.cooper3@citrix.com&gt;
    > Signed-off-by: Juergen Gross &lt;jgross@suse.com&gt;
    > Co-developed-by: Peter Zijlstra &lt;peterz@infradead.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ xen/netfront: fix crash when removing device (@Juergen Gross in [7728e974ffbf14f](https://github.com/sophgo/linux-riscv/commit/7728e974ffbf14f) at 2024-12-19 17:13:23)
    > commit f9244fb55f37356f75c739c57323d9422d7aa0f8 upstream.
    > When removing a netfront device directly after a suspend/resume cycle
    > it might happen that the queues have not been setup again, causing a
    > crash during the attempt to stop the queues another time.
    > Fix that by checking the queues are existing before trying to stop
    > them.
    > This is XSA-465 / CVE-2024-53240.
    > Reported-by: Marek Marczykowski-Górecki &lt;marmarek@invisiblethingslab.com&gt;
    > Fixes: d50b7914fae0 (&quot;xen-netfront: Fix NULL sring after live migration&quot;)
    > Signed-off-by: Juergen Gross &lt;jgross@suse.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ x86: make get_cpu_vendor() accessible from Xen code (@Juergen Gross in [505b3523644d80f](https://github.com/sophgo/linux-riscv/commit/505b3523644d80f) at 2024-12-19 17:13:23)
    > commit efbcd61d9bebb771c836a3b8bfced8165633db7c upstream.
    > In order to be able to differentiate between AMD and Intel based
    > systems for very early hypercalls without having to rely on the Xen
    > hypercall page, make get_cpu_vendor() non-static.
    > Refactor early_cpu_init() for the same reason by splitting out the
    > loop initializing cpu_devs() into an externally callable function.
    > This is part of XSA-466 / CVE-2024-53241.
    > Reported-by: Andrew Cooper &lt;andrew.cooper3@citrix.com&gt;
    > Signed-off-by: Juergen Gross &lt;jgross@suse.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ x86/xen: use new hypercall functions instead of hypercall page (@Juergen Gross in [42d50bb38a691ea](https://github.com/sophgo/linux-riscv/commit/42d50bb38a691ea) at 2024-12-19 17:13:23)
    > commit b1c2cb86f4a7861480ad54bb9a58df3cbebf8e92 upstream.
    > Call the Xen hypervisor via the new xen_hypercall_func static-call
    > instead of the hypercall page.
    > This is part of XSA-466 / CVE-2024-53241.
    > Reported-by: Andrew Cooper &lt;andrew.cooper3@citrix.com&gt;
    > Signed-off-by: Juergen Gross &lt;jgross@suse.com&gt;
    > Co-developed-by: Peter Zijlstra &lt;peterz@infradead.org&gt;
    > Co-developed-by: Josh Poimboeuf &lt;jpoimboe@redhat.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ x86/xen: add central hypercall functions (@Juergen Gross in [3fbfac0f3044172](https://github.com/sophgo/linux-riscv/commit/3fbfac0f3044172) at 2024-12-19 17:13:23)
    > commit b4845bb6383821a9516ce30af3a27dc873e37fd4 upstream.
    > Add generic hypercall functions usable for all normal (i.e. not iret)
    > hypercalls. Depending on the guest type and the processor vendor
    > different functions need to be used due to the to be used instruction
    > for entering the hypervisor:
    > - PV guests need to use syscall
    > - HVM/PVH guests on Intel need to use vmcall
    > - HVM/PVH guests on AMD and Hygon need to use vmmcall
    > As PVH guests need to issue hypercalls very early during boot, there
    > is a 4th hypercall function needed for HVM/PVH which can be used on
    > Intel and AMD processors. It will check the vendor type and then set
    > the Intel or AMD specific function to use via static_call().
    > This is part of XSA-466 / CVE-2024-53241.
    > Reported-by: Andrew Cooper &lt;andrew.cooper3@citrix.com&gt;
    > Signed-off-by: Juergen Gross &lt;jgross@suse.com&gt;
    > Co-developed-by: Peter Zijlstra &lt;peterz@infradead.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ block: Fix potential deadlock while freezing queue and acquiring sysfs_lock (@Nilay Shroff in [f1a494df8350da2](https://github.com/sophgo/linux-riscv/commit/f1a494df8350da2) at 2024-12-19 17:13:22)
    > [ Upstream commit be26ba96421ab0a8fa2055ccf7db7832a13c44d2 ]
    > For storing a value to a queue attribute, the queue_attr_store function
    > first freezes the queue (-&gt;q_usage_counter(io)) and then acquire
    > -&gt;sysfs_lock. This seems not correct as the usual ordering should be to
    > acquire -&gt;sysfs_lock before freezing the queue. This incorrect ordering
    > causes the following lockdep splat which we are able to reproduce always
    > simply by accessing /sys/kernel/debug file using ls command:
    > [   57.597146] WARNING: possible circular locking dependency detected
    > [   57.597154] 6.12.0-10553-gb86545e02e8c #20 Tainted: G        W
    > [   57.597162] ------------------------------------------------------
    > [   57.597168] ls/4605 is trying to acquire lock:
    > [   57.597176] c00000003eb56710 (&amp;mm-&gt;mmap_lock){++++}-{4:4}, at: __might_fault+0x58/0xc0
    > [   57.597200]
    > but task is already holding lock:
    > [   57.597207] c0000018e27c6810 (&amp;sb-&gt;s_type-&gt;i_mutex_key#3){++++}-{4:4}, at: iterate_dir+0x94/0x1d4
    > [   57.597226]
    > which lock already depends on the new lock.
    > [   57.597233]
    > the existing dependency chain (in reverse order) is:
    > [   57.597241]
    > -&gt; #5 (&amp;sb-&gt;s_type-&gt;i_mutex_key#3){++++}-{4:4}:
    > [   57.597255]        down_write+0x6c/0x18c
    > [   57.597264]        start_creating+0xb4/0x24c
    > [   57.597274]        debugfs_create_dir+0x2c/0x1e8
    > [   57.597283]        blk_register_queue+0xec/0x294
    > [   57.597292]        add_disk_fwnode+0x2e4/0x548
    > [   57.597302]        brd_alloc+0x2c8/0x338
    > [   57.597309]        brd_init+0x100/0x178
    > [   57.597317]        do_one_initcall+0x88/0x3e4
    > [   57.597326]        kernel_init_freeable+0x3cc/0x6e0
    > [   57.597334]        kernel_init+0x34/0x1cc
    > [   57.597342]        ret_from_kernel_user_thread+0x14/0x1c
    > [   57.597350]
    > -&gt; #4 (&amp;q-&gt;debugfs_mutex){+.+.}-{4:4}:
    > [   57.597362]        __mutex_lock+0xfc/0x12a0
    > [   57.597370]        blk_register_queue+0xd4/0x294
    > [   57.597379]        add_disk_fwnode+0x2e4/0x548
    > [   57.597388]        brd_alloc+0x2c8/0x338
    > [   57.597395]        brd_init+0x100/0x178
    > [   57.597402]        do_one_initcall+0x88/0x3e4
    > [   57.597410]        kernel_init_freeable+0x3cc/0x6e0
    > [   57.597418]        kernel_init+0x34/0x1cc
    > [   57.597426]        ret_from_kernel_user_thread+0x14/0x1c
    > [   57.597434]
    > -&gt; #3 (&amp;q-&gt;sysfs_lock){+.+.}-{4:4}:
    > [   57.597446]        __mutex_lock+0xfc/0x12a0
    > [   57.597454]        queue_attr_store+0x9c/0x110
    > [   57.597462]        sysfs_kf_write+0x70/0xb0
    > [   57.597471]        kernfs_fop_write_iter+0x1b0/0x2ac
    > [   57.597480]        vfs_write+0x3dc/0x6e8
    > [   57.597488]        ksys_write+0x84/0x140
    > [   57.597495]        system_call_exception+0x130/0x360
    > [   57.597504]        system_call_common+0x160/0x2c4
    > [   57.597516]
    > -&gt; #2 (&amp;q-&gt;q_usage_counter(io)#21){++++}-{0:0}:
    > [   57.597530]        __submit_bio+0x5ec/0x828
    > [   57.597538]        submit_bio_noacct_nocheck+0x1e4/0x4f0
    > [   57.597547]        iomap_readahead+0x2a0/0x448
    > [   57.597556]        xfs_vm_readahead+0x28/0x3c
    > [   57.597564]        read_pages+0x88/0x41c
    > [   57.597571]        page_cache_ra_unbounded+0x1ac/0x2d8
    > [   57.597580]        filemap_get_pages+0x188/0x984
    > [   57.597588]        filemap_read+0x13c/0x4bc
    > [   57.597596]        xfs_file_buffered_read+0x88/0x17c
    > [   57.597605]        xfs_file_read_iter+0xac/0x158
    > [   57.597614]        vfs_read+0x2d4/0x3b4
    > [   57.597622]        ksys_read+0x84/0x144
    > [   57.597629]        system_call_exception+0x130/0x360
    > [   57.597637]        system_call_common+0x160/0x2c4
    > [   57.597647]
    > -&gt; #1 (mapping.invalidate_lock#2){++++}-{4:4}:
    > [   57.597661]        down_read+0x6c/0x220
    > [   57.597669]        filemap_fault+0x870/0x100c
    > [   57.597677]        xfs_filemap_fault+0xc4/0x18c
    > [   57.597684]        __do_fault+0x64/0x164
    > [   57.597693]        __handle_mm_fault+0x1274/0x1dac
    > [   57.597702]        handle_mm_fault+0x248/0x484
    > [   57.597711]        ___do_page_fault+0x428/0xc0c
    > [   57.597719]        hash__do_page_fault+0x30/0x68
    > [   57.597727]        do_hash_fault+0x90/0x35c
    > [   57.597736]        data_access_common_virt+0x210/0x220
    > [   57.597745]        _copy_from_user+0xf8/0x19c
    > [   57.597754]        sel_write_load+0x178/0xd54
    > [   57.597762]        vfs_write+0x108/0x6e8
    > [   57.597769]        ksys_write+0x84/0x140
    > [   57.597777]        system_call_exception+0x130/0x360
    > [   57.597785]        system_call_common+0x160/0x2c4
    > [   57.597794]
    > -&gt; #0 (&amp;mm-&gt;mmap_lock){++++}-{4:4}:
    > [   57.597806]        __lock_acquire+0x17cc/0x2330
    > [   57.597814]        lock_acquire+0x138/0x400
    > [   57.597822]        __might_fault+0x7c/0xc0
    > [   57.597830]        filldir64+0xe8/0x390
    > [   57.597839]        dcache_readdir+0x80/0x2d4
    > [   57.597846]        iterate_dir+0xd8/0x1d4
    > [   57.597855]        sys_getdents64+0x88/0x2d4
    > [   57.597864]        system_call_exception+0x130/0x360
    > [   57.597872]        system_call_common+0x160/0x2c4
    > [   57.597881]
    > other info that might help us debug this:
    > [   57.597888] Chain exists of:
    > &amp;mm-&gt;mmap_lock --&gt; &amp;q-&gt;debugfs_mutex --&gt; &amp;sb-&gt;s_type-&gt;i_mutex_key#3
    > [   57.597905]  Possible unsafe locking scenario:
    > [   57.597911]        CPU0                    CPU1
    > [   57.597917]        ----                    ----
    > [   57.597922]   rlock(&amp;sb-&gt;s_type-&gt;i_mutex_key#3);
    > [   57.597932]                                lock(&amp;q-&gt;debugfs_mutex);
    > [   57.597940]                                lock(&amp;sb-&gt;s_type-&gt;i_mutex_key#3);
    > [   57.597950]   rlock(&amp;mm-&gt;mmap_lock);
    > [   57.597958]
    > ** DEADLOCK ***
    > [   57.597965] 2 locks held by ls/4605:
    > [   57.597971]  #0: c0000000137c12f8 (&amp;f-&gt;f_pos_lock){+.+.}-{4:4}, at: fdget_pos+0xcc/0x154
    > [   57.597989]  #1: c0000018e27c6810 (&amp;sb-&gt;s_type-&gt;i_mutex_key#3){++++}-{4:4}, at: iterate_dir+0x94/0x1d4
    > Prevent the above lockdep warning by acquiring -&gt;sysfs_lock before
    > freezing the queue while storing a queue attribute in queue_attr_store
    > function. Later, we also found[1] another function __blk_mq_update_nr_
    > hw_queues where we first freeze queue and then acquire the -&gt;sysfs_lock.
    > So we&#x27;ve also updated lock ordering in __blk_mq_update_nr_hw_queues
    > function and ensured that in all code paths we follow the correct lock
    > ordering i.e. acquire -&gt;sysfs_lock before freezing the queue.
    > [1] https://lore.kernel.org/all/CAFj5m9Ke8+EHKQBs_Nk6hqd&#x3D;LGXtk4mUxZUN5&#x3D;&#x3D;ZcCjnZSBwHw@mail.gmail.com/
    > Reported-by: kjain@linux.ibm.com
    > Fixes: af2814149883 (&quot;block: freeze the queue in queue_attr_store&quot;)
    > Tested-by: kjain@linux.ibm.com
    > Cc: hch@lst.de
    > Cc: axboe@kernel.dk
    > Cc: ritesh.list@gmail.com
    > Cc: ming.lei@redhat.com
    > Cc: gjoyce@linux.ibm.com
    > Signed-off-by: Nilay Shroff &lt;nilay@linux.ibm.com&gt;
    > Reviewed-by: Ming Lei &lt;ming.lei@redhat.com&gt;
    > Link: https://lore.kernel.org/r/20241210144222.1066229-1-nilay@linux.ibm.com
    > Signed-off-by: Jens Axboe &lt;axboe@kernel.dk&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ blk-iocost: Avoid using clamp() on inuse in __propagate_weights() (@Nathan Chancellor in [eea698975153f1c](https://github.com/sophgo/linux-riscv/commit/eea698975153f1c) at 2024-12-19 17:13:22)
    > [ Upstream commit 57e420c84f9ab55ba4c5e2ae9c5f6c8e1ea834d2 ]
    > After a recent change to clamp() and its variants [1] that increases the
    > coverage of the check that high is greater than low because it can be
    > done through inlining, certain build configurations (such as s390
    > defconfig) fail to build with clang with:
    > block/blk-iocost.c:1101:11: error: call to &#x27;__compiletime_assert_557&#x27; declared with &#x27;error&#x27; attribute: clamp() low limit 1 greater than high limit active
    > 1101 |                 inuse &#x3D; clamp_t(u32, inuse, 1, active);
    > |                         ^
    > include/linux/minmax.h:218:36: note: expanded from macro &#x27;clamp_t&#x27;
    > 218 | #define clamp_t(type, val, lo, hi) __careful_clamp(type, val, lo, hi)
    > |                                    ^
    > include/linux/minmax.h:195:2: note: expanded from macro &#x27;__careful_clamp&#x27;
    > 195 |         __clamp_once(type, val, lo, hi, __UNIQUE_ID(v_), __UNIQUE_ID(l_), __UNIQUE_ID(h_))
    > |         ^
    > include/linux/minmax.h:188:2: note: expanded from macro &#x27;__clamp_once&#x27;
    > 188 |         BUILD_BUG_ON_MSG(statically_true(ulo &gt; uhi),                            \
    > |         ^
    > __propagate_weights() is called with an active value of zero in
    > ioc_check_iocgs(), which results in the high value being less than the
    > low value, which is undefined because the value returned depends on the
    > order of the comparisons.
    > The purpose of this expression is to ensure inuse is not more than
    > active and at least 1. This could be written more simply with a ternary
    > expression that uses min(inuse, active) as the condition so that the
    > value of that condition can be used if it is not zero and one if it is.
    > Do this conversion to resolve the error and add a comment to deter
    > people from turning this back into clamp().
    > Fixes: 7caa47151ab2 (&quot;blkcg: implement blk-iocost&quot;)
    > Link: https://lore.kernel.org/r/34d53778977747f19cce2abb287bb3e6@AcuMS.aculab.com/ [1]
    > Suggested-by: David Laight &lt;david.laight@aculab.com&gt;
    > Reported-by: Linux Kernel Functional Testing &lt;lkft@linaro.org&gt;
    > Closes: https://lore.kernel.org/llvm/CA+G9fYsD7mw13wredcZn0L-KBA3yeoVSTuxnss-AEWMN3ha0cA@mail.gmail.com/
    > Reported-by: kernel test robot &lt;lkp@intel.com&gt;
    > Closes: https://lore.kernel.org/oe-kbuild-all/202412120322.3GfVe3vF-lkp@intel.com/
    > Signed-off-by: Nathan Chancellor &lt;nathan@kernel.org&gt;
    > Acked-by: Tejun Heo &lt;tj@kernel.org&gt;
    > Signed-off-by: Jens Axboe &lt;axboe@kernel.dk&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ blk-mq: move cpuhp callback registering out of q-&gt;sysfs_lock (@Ming Lei in [c1291ea131d1862](https://github.com/sophgo/linux-riscv/commit/c1291ea131d1862) at 2024-12-19 17:13:22)
    > [ Upstream commit 22465bbac53c821319089016f268a2437de9b00a ]
    > Registering and unregistering cpuhp callback requires global cpu hotplug lock,
    > which is used everywhere. Meantime q-&gt;sysfs_lock is used in block layer
    > almost everywhere.
    > It is easy to trigger lockdep warning[1] by connecting the two locks.
    > Fix the warning by moving blk-mq&#x27;s cpuhp callback registering out of
    > q-&gt;sysfs_lock. Add one dedicated global lock for covering registering &amp;
    > unregistering hctx&#x27;s cpuhp, and it is safe to do so because hctx is
    > guaranteed to be live if our request_queue is live.
    > [1] https://lore.kernel.org/lkml/Z04pz3AlvI4o0Mr8@agluck-desk3/
    > Cc: Reinette Chatre &lt;reinette.chatre@intel.com&gt;
    > Cc: Fenghua Yu &lt;fenghua.yu@intel.com&gt;
    > Cc: Peter Newman &lt;peternewman@google.com&gt;
    > Cc: Babu Moger &lt;babu.moger@amd.com&gt;
    > Reported-by: Luck Tony &lt;tony.luck@intel.com&gt;
    > Signed-off-by: Ming Lei &lt;ming.lei@redhat.com&gt;
    > Tested-by: Tony Luck &lt;tony.luck@intel.com&gt;
    > Link: https://lore.kernel.org/r/20241206111611.978870-3-ming.lei@redhat.com
    > Signed-off-by: Jens Axboe &lt;axboe@kernel.dk&gt;
    > Stable-dep-of: be26ba96421a (&quot;block: Fix potential deadlock while freezing queue and acquiring sysfs_lock&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/xe/reg_sr: Remove register pool (@Lucas De Marchi in [b0193a31a0ca5a0](https://github.com/sophgo/linux-riscv/commit/b0193a31a0ca5a0) at 2024-12-19 17:13:22)
    > [ Upstream commit d7b028656c29b22fcde1c6ee1df5b28fbba987b5 ]
    > That pool implementation doesn&#x27;t really work: if the krealloc happens to
    > move the memory and return another address, the entries in the xarray
    > become invalid, leading to use-after-free later:
    > BUG: KASAN: slab-use-after-free in xe_reg_sr_apply_mmio+0x570/0x760 [xe]
    > Read of size 4 at addr ffff8881244b2590 by task modprobe/2753
    > Allocated by task 2753:
    > kasan_save_stack+0x39/0x70
    > kasan_save_track+0x14/0x40
    > kasan_save_alloc_info+0x37/0x60
    > __kasan_kmalloc+0xc3/0xd0
    > __kmalloc_node_track_caller_noprof+0x200/0x6d0
    > krealloc_noprof+0x229/0x380
    > Simplify the code to fix the bug. A better pooling strategy may be added
    > back later if needed.
    > Fixes: dd08ebf6c352 (&quot;drm/xe: Introduce a new DRM driver for Intel GPUs&quot;)
    > Reviewed-by: Matt Roper &lt;matthew.d.roper@intel.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20241209232739.147417-2-lucas.demarchi@intel.com
    > Signed-off-by: Lucas De Marchi &lt;lucas.demarchi@intel.com&gt;
    > (cherry picked from commit e5283bd4dfecbd3335f43b62a68e24dae23f59e4)
    > Signed-off-by: Thomas Hellström &lt;thomas.hellstrom@linux.intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ kselftest/arm64: abi: fix SVCR detection (@Weizhao Ouyang in [7ccd62135403ef2](https://github.com/sophgo/linux-riscv/commit/7ccd62135403ef2) at 2024-12-19 17:13:22)
    > [ Upstream commit ce03573a1917532da06057da9f8e74a2ee9e2ac9 ]
    > When using svcr_in to check ZA and Streaming Mode, we should make sure
    > that the value in x2 is correct, otherwise it may trigger an Illegal
    > instruction if FEAT_SVE and !FEAT_SME.
    > Fixes: 43e3f85523e4 (&quot;kselftest/arm64: Add SME support to syscall ABI test&quot;)
    > Signed-off-by: Weizhao Ouyang &lt;o451686892@gmail.com&gt;
    > Reviewed-by: Mark Brown &lt;broonie@kernel.org&gt;
    > Link: https://lore.kernel.org/r/20241211111639.12344-1-o451686892@gmail.com
    > Signed-off-by: Catalin Marinas &lt;catalin.marinas@arm.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ rust: kbuild: set &#x60;bindgen&#x60;&#x27;s Rust target version (@Miguel Ojeda in [5804b6a7f67c7a1](https://github.com/sophgo/linux-riscv/commit/5804b6a7f67c7a1) at 2024-12-19 17:13:22)
    > commit 7a5f93ea5862da91488975acaa0c7abd508f192b upstream.
    > Each &#x60;bindgen&#x60; release may upgrade the list of Rust targets. For instance,
    > currently, in their master branch [1], the latest ones are:
    > Nightly &#x3D;&gt; {
    > vectorcall_abi: #124485,
    > ptr_metadata: #81513,
    > layout_for_ptr: #69835,
    > },
    > Stable_1_77(77) &#x3D;&gt; { offset_of: #106655 },
    > Stable_1_73(73) &#x3D;&gt; { thiscall_abi: #42202 },
    > Stable_1_71(71) &#x3D;&gt; { c_unwind_abi: #106075 },
    > Stable_1_68(68) &#x3D;&gt; { abi_efiapi: #105795 },
    > By default, the highest stable release in their list is used, and users
    > are expected to set one if they need to support older Rust versions
    > (e.g. see [2]).
    > Thus, over time, new Rust features are used by default, and at some
    > point, it is likely that &#x60;bindgen&#x60; will emit Rust code that requires a
    > Rust version higher than our minimum (or perhaps enabling an unstable
    > feature). Currently, there is no problem because the maximum they have,
    > as seen above, is Rust 1.77.0, and our current minimum is Rust 1.78.0.
    > Therefore, set a Rust target explicitly now to prevent going forward in
    > time too much and thus getting potential build failures at some point.
    > Since we also support a minimum &#x60;bindgen&#x60; version, and since &#x60;bindgen&#x60;
    > does not support passing unknown Rust target versions, we need to use
    > the list of our minimum &#x60;bindgen&#x60; version, rather than the latest. So,
    > since &#x60;bindgen&#x60; 0.65.1 had this list [3], we need to use Rust 1.68.0:
    > /// Rust stable 1.64
    > ///  * &#x60;core_ffi_c&#x60; ([Tracking issue](https://github.com/rust-lang/rust/issues/94501))
    > &#x3D;&gt; Stable_1_64 &#x3D;&gt; 1.64;
    > /// Rust stable 1.68
    > ///  * &#x60;abi_efiapi&#x60; calling convention ([Tracking issue](https://github.com/rust-lang/rust/issues/65815))
    > &#x3D;&gt; Stable_1_68 &#x3D;&gt; 1.68;
    > /// Nightly rust
    > ///  * &#x60;thiscall&#x60; calling convention ([Tracking issue](https://github.com/rust-lang/rust/issues/42202))
    > ///  * &#x60;vectorcall&#x60; calling convention (no tracking issue)
    > ///  * &#x60;c_unwind&#x60; calling convention ([Tracking issue](https://github.com/rust-lang/rust/issues/74990))
    > &#x3D;&gt; Nightly &#x3D;&gt; nightly;
    > ...
    > /// Latest stable release of Rust
    > pub const LATEST_STABLE_RUST: RustTarget &#x3D; RustTarget::Stable_1_68;
    > Thus add the &#x60;--rust-target 1.68&#x60; parameter. Add a comment as well
    > explaining this.
    > An alternative would be to use the currently running (i.e. actual) &#x60;rustc&#x60;
    > and &#x60;bindgen&#x60; versions to pick a &quot;better&quot; Rust target version. However,
    > that would introduce more moving parts depending on the user setup and
    > is also more complex to implement.
    > Starting with &#x60;bindgen&#x60; 0.71.0 [4], we will be able to set any future
    > Rust version instead, i.e. we will be able to set here our minimum
    > supported Rust version. Christian implemented it [5] after seeing this
    > patch. Thanks!
    > Cc: Christian Poveda &lt;git@pvdrz.com&gt;
    > Cc: Emilio Cobos Álvarez &lt;emilio@crisal.io&gt;
    > Cc: stable@vger.kernel.org # needed for 6.12.y; unneeded for 6.6.y; do not apply to 6.1.y
    > Fixes: c844fa64a2d4 (&quot;rust: start supporting several &#x60;bindgen&#x60; versions&quot;)
    > Link: https://github.com/rust-lang/rust-bindgen/blob/21c60f473f4e824d4aa9b2b508056320d474b110/bindgen/features.rs#L97-L105 [1]
    > Link: https://github.com/rust-lang/rust-bindgen/issues/2960 [2]
    > Link: https://github.com/rust-lang/rust-bindgen/blob/7d243056d335fdc4537f7bca73c06d01aae24ddc/bindgen/features.rs#L131-L150 [3]
    > Link: https://github.com/rust-lang/rust-bindgen/blob/main/CHANGELOG.md#0710-2024-12-06 [4]
    > Link: https://github.com/rust-lang/rust-bindgen/pull/2993 [5]
    > Reviewed-by: Alice Ryhl &lt;aliceryhl@google.com&gt;
    > Link: https://lore.kernel.org/r/20241123180323.255997-1-ojeda@kernel.org
    > Signed-off-by: Miguel Ojeda &lt;ojeda@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ KVM: arm64: Disable MPAM visibility by default and ignore VMM writes (@James Morse in [1e04ca11a444520](https://github.com/sophgo/linux-riscv/commit/1e04ca11a444520) at 2024-12-19 17:13:22)
    > commit 6685f5d572c22e1003e7c0d089afe1c64340ab1f upstream.
    > commit 011e5f5bf529f (&quot;arm64/cpufeature: Add remaining feature bits in
    > ID_AA64PFR0 register&quot;) exposed the MPAM field of AA64PFR0_EL1 to guests,
    > but didn&#x27;t add trap handling. A previous patch supplied the missing trap
    > handling.
    > Existing VMs that have the MPAM field of ID_AA64PFR0_EL1 set need to
    > be migratable, but there is little point enabling the MPAM CPU
    > interface on new VMs until there is something a guest can do with it.
    > Clear the MPAM field from the guest&#x27;s ID_AA64PFR0_EL1 and on hardware
    > that supports MPAM, politely ignore the VMMs attempts to set this bit.
    > Guests exposed to this bug have the sanitised value of the MPAM field,
    > so only the correct value needs to be ignored. This means the field
    > can continue to be used to block migration to incompatible hardware
    > (between MPAM&#x3D;1 and MPAM&#x3D;5), and the VMM can&#x27;t rely on the field
    > being ignored.
    > Signed-off-by: James Morse &lt;james.morse@arm.com&gt;
    > Co-developed-by: Joey Gouly &lt;joey.gouly@arm.com&gt;
    > Signed-off-by: Joey Gouly &lt;joey.gouly@arm.com&gt;
    > Reviewed-by: Gavin Shan &lt;gshan@redhat.com&gt;
    > Tested-by: Shameer Kolothum &lt;shameerali.kolothum.thodi@huawei.com&gt;
    > Reviewed-by: Marc Zyngier &lt;maz@kernel.org&gt;
    > Link: https://lore.kernel.org/r/20241030160317.2528209-7-joey.gouly@arm.com
    > Signed-off-by: Oliver Upton &lt;oliver.upton@linux.dev&gt;
    > [maz: adapted to lack of ID_FILTERED()]
    > Signed-off-by: Marc Zyngier &lt;maz@kernel.org&gt;
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ Bluetooth: btmtk: avoid UAF in btmtk_process_coredump (@Thadeu Lima de Souza Cascardo in [d20ff1d3cb40479](https://github.com/sophgo/linux-riscv/commit/d20ff1d3cb40479) at 2024-12-19 17:13:21)
    > [ Upstream commit b548f5e9456c568155499d9ebac675c0d7a296e8 ]
    > hci_devcd_append may lead to the release of the skb, so it cannot be
    > accessed once it is called.
    > &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;
    > BUG: KASAN: slab-use-after-free in btmtk_process_coredump+0x2a7/0x2d0 [btmtk]
    > Read of size 4 at addr ffff888033cfabb0 by task kworker/0:3/82
    > CPU: 0 PID: 82 Comm: kworker/0:3 Tainted: G     U             6.6.40-lockdep-03464-g1d8b4eb3060e #1 b0b3c1cc0c842735643fb411799d97921d1f688c
    > Hardware name: Google Yaviks_Ufs/Yaviks_Ufs, BIOS Google_Yaviks_Ufs.15217.552.0 05/07/2024
    > Workqueue: events btusb_rx_work [btusb]
    > Call Trace:
    > &lt;TASK&gt;
    > dump_stack_lvl+0xfd/0x150
    > print_report+0x131/0x780
    > kasan_report+0x177/0x1c0
    > btmtk_process_coredump+0x2a7/0x2d0 [btmtk 03edd567dd71a65958807c95a65db31d433e1d01]
    > btusb_recv_acl_mtk+0x11c/0x1a0 [btusb 675430d1e87c4f24d0c1f80efe600757a0f32bec]
    > btusb_rx_work+0x9e/0xe0 [btusb 675430d1e87c4f24d0c1f80efe600757a0f32bec]
    > worker_thread+0xe44/0x2cc0
    > kthread+0x2ff/0x3a0
    > ret_from_fork+0x51/0x80
    > ret_from_fork_asm+0x1b/0x30
    > &lt;/TASK&gt;
    > Allocated by task 82:
    > stack_trace_save+0xdc/0x190
    > kasan_set_track+0x4e/0x80
    > __kasan_slab_alloc+0x4e/0x60
    > kmem_cache_alloc+0x19f/0x360
    > skb_clone+0x132/0xf70
    > btusb_recv_acl_mtk+0x104/0x1a0 [btusb]
    > btusb_rx_work+0x9e/0xe0 [btusb]
    > worker_thread+0xe44/0x2cc0
    > kthread+0x2ff/0x3a0
    > ret_from_fork+0x51/0x80
    > ret_from_fork_asm+0x1b/0x30
    > Freed by task 1733:
    > stack_trace_save+0xdc/0x190
    > kasan_set_track+0x4e/0x80
    > kasan_save_free_info+0x28/0xb0
    > ____kasan_slab_free+0xfd/0x170
    > kmem_cache_free+0x183/0x3f0
    > hci_devcd_rx+0x91a/0x2060 [bluetooth]
    > worker_thread+0xe44/0x2cc0
    > kthread+0x2ff/0x3a0
    > ret_from_fork+0x51/0x80
    > ret_from_fork_asm+0x1b/0x30
    > The buggy address belongs to the object at ffff888033cfab40
    > which belongs to the cache skbuff_head_cache of size 232
    > The buggy address is located 112 bytes inside of
    > freed 232-byte region [ffff888033cfab40, ffff888033cfac28)
    > The buggy address belongs to the physical page:
    > page:00000000a174ba93 refcount:1 mapcount:0 mapping:0000000000000000 index:0x0 pfn:0x33cfa
    > head:00000000a174ba93 order:1 entire_mapcount:0 nr_pages_mapped:0 pincount:0
    > anon flags: 0x4000000000000840(slab|head|zone&#x3D;1)
    > page_type: 0xffffffff()
    > raw: 4000000000000840 ffff888100848a00 0000000000000000 0000000000000001
    > raw: 0000000000000000 0000000080190019 00000001ffffffff 0000000000000000
    > page dumped because: kasan: bad access detected
    > Memory state around the buggy address:
    > ffff888033cfaa80: fb fb fb fb fb fb fb fb fb fb fb fb fb fc fc fc
    > ffff888033cfab00: fc fc fc fc fc fc fc fc fa fb fb fb fb fb fb fb
    > &gt;ffff888033cfab80: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
    > ^
    > ffff888033cfac00: fb fb fb fb fb fc fc fc fc fc fc fc fc fc fc fc
    > ffff888033cfac80: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
    > &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;
    > Check if we need to call hci_devcd_complete before calling
    > hci_devcd_append. That requires that we check data-&gt;cd_info.cnt &gt;&#x3D;
    > MTK_COREDUMP_NUM instead of data-&gt;cd_info.cnt &gt; MTK_COREDUMP_NUM, as we
    > increment data-&gt;cd_info.cnt only once the call to hci_devcd_append
    > succeeds.
    > Fixes: 0b7015132878 (&quot;Bluetooth: btusb: mediatek: add MediaTek devcoredump support&quot;)
    > Signed-off-by: Thadeu Lima de Souza Cascardo &lt;cascardo@igalia.com&gt;
    > Signed-off-by: Luiz Augusto von Dentz &lt;luiz.von.dentz@intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ Bluetooth: iso: Fix circular lock in iso_conn_big_sync (@Iulia Tanasescu in [cbe640d6cae590b](https://github.com/sophgo/linux-riscv/commit/cbe640d6cae590b) at 2024-12-19 17:13:21)
    > [ Upstream commit 7a17308c17880d259105f6e591eb1bc77b9612f0 ]
    > This fixes the circular locking dependency warning below, by reworking
    > iso_sock_recvmsg, to ensure that the socket lock is always released
    > before calling a function that locks hdev.
    > [  561.670344] &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;
    > [  561.670346] WARNING: possible circular locking dependency detected
    > [  561.670349] 6.12.0-rc6+ #26 Not tainted
    > [  561.670351] ------------------------------------------------------
    > [  561.670353] iso-tester/3289 is trying to acquire lock:
    > [  561.670355] ffff88811f600078 (&amp;hdev-&gt;lock){+.+.}-{3:3},
    > at: iso_conn_big_sync+0x73/0x260 [bluetooth]
    > [  561.670405]
    > but task is already holding lock:
    > [  561.670407] ffff88815af58258 (sk_lock-AF_BLUETOOTH){+.+.}-{0:0},
    > at: iso_sock_recvmsg+0xbf/0x500 [bluetooth]
    > [  561.670450]
    > which lock already depends on the new lock.
    > [  561.670452]
    > the existing dependency chain (in reverse order) is:
    > [  561.670453]
    > -&gt; #2 (sk_lock-AF_BLUETOOTH){+.+.}-{0:0}:
    > [  561.670458]        lock_acquire+0x7c/0xc0
    > [  561.670463]        lock_sock_nested+0x3b/0xf0
    > [  561.670467]        bt_accept_dequeue+0x1a5/0x4d0 [bluetooth]
    > [  561.670510]        iso_sock_accept+0x271/0x830 [bluetooth]
    > [  561.670547]        do_accept+0x3dd/0x610
    > [  561.670550]        __sys_accept4+0xd8/0x170
    > [  561.670553]        __x64_sys_accept+0x74/0xc0
    > [  561.670556]        x64_sys_call+0x17d6/0x25f0
    > [  561.670559]        do_syscall_64+0x87/0x150
    > [  561.670563]        entry_SYSCALL_64_after_hwframe+0x76/0x7e
    > [  561.670567]
    > -&gt; #1 (sk_lock-AF_BLUETOOTH-BTPROTO_ISO){+.+.}-{0:0}:
    > [  561.670571]        lock_acquire+0x7c/0xc0
    > [  561.670574]        lock_sock_nested+0x3b/0xf0
    > [  561.670577]        iso_sock_listen+0x2de/0xf30 [bluetooth]
    > [  561.670617]        __sys_listen_socket+0xef/0x130
    > [  561.670620]        __x64_sys_listen+0xe1/0x190
    > [  561.670623]        x64_sys_call+0x2517/0x25f0
    > [  561.670626]        do_syscall_64+0x87/0x150
    > [  561.670629]        entry_SYSCALL_64_after_hwframe+0x76/0x7e
    > [  561.670632]
    > -&gt; #0 (&amp;hdev-&gt;lock){+.+.}-{3:3}:
    > [  561.670636]        __lock_acquire+0x32ad/0x6ab0
    > [  561.670639]        lock_acquire.part.0+0x118/0x360
    > [  561.670642]        lock_acquire+0x7c/0xc0
    > [  561.670644]        __mutex_lock+0x18d/0x12f0
    > [  561.670647]        mutex_lock_nested+0x1b/0x30
    > [  561.670651]        iso_conn_big_sync+0x73/0x260 [bluetooth]
    > [  561.670687]        iso_sock_recvmsg+0x3e9/0x500 [bluetooth]
    > [  561.670722]        sock_recvmsg+0x1d5/0x240
    > [  561.670725]        sock_read_iter+0x27d/0x470
    > [  561.670727]        vfs_read+0x9a0/0xd30
    > [  561.670731]        ksys_read+0x1a8/0x250
    > [  561.670733]        __x64_sys_read+0x72/0xc0
    > [  561.670736]        x64_sys_call+0x1b12/0x25f0
    > [  561.670738]        do_syscall_64+0x87/0x150
    > [  561.670741]        entry_SYSCALL_64_after_hwframe+0x76/0x7e
    > [  561.670744]
    > other info that might help us debug this:
    > [  561.670745] Chain exists of:
    > &amp;hdev-&gt;lock --&gt; sk_lock-AF_BLUETOOTH-BTPROTO_ISO --&gt; sk_lock-AF_BLUETOOTH
    > [  561.670751]  Possible unsafe locking scenario:
    > [  561.670753]        CPU0                    CPU1
    > [  561.670754]        ----                    ----
    > [  561.670756]   lock(sk_lock-AF_BLUETOOTH);
    > [  561.670758]                                lock(sk_lock
    > AF_BLUETOOTH-BTPROTO_ISO);
    > [  561.670761]                                lock(sk_lock-AF_BLUETOOTH);
    > [  561.670764]   lock(&amp;hdev-&gt;lock);
    > [  561.670767]
    > ** DEADLOCK ***
    > Fixes: 07a9342b94a9 (&quot;Bluetooth: ISO: Send BIG Create Sync via hci_sync&quot;)
    > Signed-off-by: Iulia Tanasescu &lt;iulia.tanasescu@nxp.com&gt;
    > Signed-off-by: Luiz Augusto von Dentz &lt;luiz.von.dentz@intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ net: renesas: rswitch: fix initial MPIC register setting (@Nikita Yushchenko in [b7f75516fe11ad2](https://github.com/sophgo/linux-riscv/commit/b7f75516fe11ad2) at 2024-12-19 17:13:21)
    > [ Upstream commit fb9e6039c325cc205a368046dc03c56c87df2310 ]
    > MPIC.PIS must be set per phy interface type.
    > MPIC.LSC must be set per speed.
    > Do that strictly per datasheet, instead of hardcoding MPIC.PIS to GMII.
    > Fixes: 3590918b5d07 (&quot;net: ethernet: renesas: Add support for &quot;Ethernet Switch&quot;&quot;)
    > Signed-off-by: Nikita Yushchenko &lt;nikita.yoush@cogentembedded.com&gt;
    > Reviewed-by: Michal Swiatkowski &lt;michal.swiatkowski@linux.intel.com&gt;
    > Link: https://patch.msgid.link/20241211053012.368914-1-nikita.yoush@cogentembedded.com
    > Signed-off-by: Paolo Abeni &lt;pabeni@redhat.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/xe: fix the ERR_PTR() returned on failure to allocate tiny pt (@Mirsad Todorovac in [3c73dad37c31563](https://github.com/sophgo/linux-riscv/commit/3c73dad37c31563) at 2024-12-19 17:13:21)
    > [ Upstream commit ed69b28b3a5e39871ba5599992f80562d6ee59db ]
    > Running coccinelle spatch gave the following warning:
    > ./drivers/gpu/drm/xe/tests/xe_migrate.c:226:5-11: inconsistent IS_ERR
    > and PTR_ERR on line 228.
    > The code reports PTR_ERR(pt) when IS_ERR(tiny) is checked:
    > → 211  pt &#x3D; xe_bo_create_pin_map(xe, tile, m-&gt;q-&gt;vm, XE_PAGE_SIZE,
    > 212                            ttm_bo_type_kernel,
    > 213                            XE_BO_FLAG_VRAM_IF_DGFX(tile) |
    > 214                            XE_BO_FLAG_PINNED);
    > 215  if (IS_ERR(pt)) {
    > 216          KUNIT_FAIL(test, &quot;Failed to allocate fake pt: %li\n&quot;,
    > 217                     PTR_ERR(pt));
    > 218          goto free_big;
    > 219  }
    > 220
    > 221  tiny &#x3D; xe_bo_create_pin_map(xe, tile, m-&gt;q-&gt;vm,
    > → 222                              2 * SZ_4K,
    > 223                              ttm_bo_type_kernel,
    > 224                              XE_BO_FLAG_VRAM_IF_DGFX(tile) |
    > 225                              XE_BO_FLAG_PINNED);
    > → 226  if (IS_ERR(tiny)) {
    > → 227          KUNIT_FAIL(test, &quot;Failed to allocate fake pt: %li\n&quot;,
    > → 228                     PTR_ERR(pt));
    > 229          goto free_pt;
    > 230  }
    > Now, the IS_ERR(tiny) and the corresponding PTR_ERR(pt) do not match.
    > Returning PTR_ERR(tiny), as the last failed function call, seems logical.
    > Fixes: dd08ebf6c352 (&quot;drm/xe: Introduce a new DRM driver for Intel GPUs&quot;)
    > Signed-off-by: Mirsad Todorovac &lt;mtodorovac69@gmail.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20241121212057.1526634-2-mtodorovac69@gmail.com
    > Signed-off-by: Rodrigo Vivi &lt;rodrigo.vivi@intel.com&gt;
    > (cherry picked from commit cb57c75098c1c449a007ba301f9073f96febaaa9)
    > Signed-off-by: Thomas Hellström &lt;thomas.hellstrom@linux.intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ net: dsa: microchip: KSZ9896 register regmap alignment to 32 bit boundaries (@Jesse Van Gavere in [124bedb2889b0da](https://github.com/sophgo/linux-riscv/commit/124bedb2889b0da) at 2024-12-19 17:13:21)
    > [ Upstream commit 5af53577c64fa84da032d490b701127fe8d1a6aa ]
    > Commit 8d7ae22ae9f8 (&quot;net: dsa: microchip: KSZ9477 register regmap
    > alignment to 32 bit boundaries&quot;) fixed an issue whereby regmap_reg_range
    > did not allow writes as 32 bit words to KSZ9477 PHY registers, this fix
    > for KSZ9896 is adapted from there as the same errata is present in
    > KSZ9896C as &quot;Module 5: Certain PHY registers must be written as pairs
    > instead of singly&quot; the explanation below is likewise taken from this
    > commit.
    > The commit provided code
    > to apply &quot;Module 6: Certain PHY registers must be written as pairs instead
    > of singly&quot; errata for KSZ9477 as this chip for certain PHY registers
    > (0xN120 to 0xN13F, N&#x3D;1,2,3,4,5) must be accessed as 32 bit words instead
    > of 16 or 8 bit access.
    > Otherwise, adjacent registers (no matter if reserved or not) are
    > overwritten with 0x0.
    > Without this patch some registers (e.g. 0x113c or 0x1134) required for 32
    > bit access are out of valid regmap ranges.
    > As a result, following error is observed and KSZ9896 is not properly
    > configured:
    > ksz-switch spi1.0: can&#x27;t rmw 32bit reg 0x113c: -EIO
    > ksz-switch spi1.0: can&#x27;t rmw 32bit reg 0x1134: -EIO
    > ksz-switch spi1.0 lan1 (uninitialized): failed to connect to PHY: -EIO
    > ksz-switch spi1.0 lan1 (uninitialized): error -5 setting up PHY for tree 0, switch 0, port 0
    > The solution is to modify regmap_reg_range to allow accesses with 4 bytes
    > boundaries.
    > Fixes: 5c844d57aa78 (&quot;net: dsa: microchip: fix writes to phy registers &gt;&#x3D; 0x10&quot;)
    > Signed-off-by: Jesse Van Gavere &lt;jesse.vangavere@scioteq.com&gt;
    > Link: https://patch.msgid.link/20241211092932.26881-1-jesse.vangavere@scioteq.com
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ net: dsa: tag_ocelot_8021q: fix broken reception (@Robert Hodaszi in [0d66dd4904272bb](https://github.com/sophgo/linux-riscv/commit/0d66dd4904272bb) at 2024-12-19 17:13:21)
    > [ Upstream commit 36ff681d2283410742489ce77e7b01419eccf58c ]
    > The blamed commit changed the dsa_8021q_rcv() calling convention to
    > accept pre-populated source_port and switch_id arguments. If those are
    > not available, as in the case of tag_ocelot_8021q, the arguments must be
    > pre-initialized with -1.
    > Due to the bug of passing uninitialized arguments in tag_ocelot_8021q,
    > dsa_8021q_rcv() does not detect that it needs to populate the
    > source_port and switch_id, and this makes dsa_conduit_find_user() fail,
    > which leads to packet loss on reception.
    > Fixes: dcfe7673787b (&quot;net: dsa: tag_sja1105: absorb logic for not overwriting precise info into dsa_8021q_rcv()&quot;)
    > Signed-off-by: Robert Hodaszi &lt;robert.hodaszi@digi.com&gt;
    > Reviewed-by: Vladimir Oltean &lt;vladimir.oltean@nxp.com&gt;
    > Link: https://patch.msgid.link/20241211144741.1415758-1-robert.hodaszi@digi.com
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ Bluetooth: hci_event: Fix using rcu_read_(un)lock while iterating (@Luiz Augusto von Dentz in [f9ecc90b5d501b3](https://github.com/sophgo/linux-riscv/commit/f9ecc90b5d501b3) at 2024-12-19 17:13:20)
    > [ Upstream commit 581dd2dc168fe0ed2a7a5534a724f0d3751c93ae ]
    > The usage of rcu_read_(un)lock while inside list_for_each_entry_rcu is
    > not safe since for the most part entries fetched this way shall be
    > treated as rcu_dereference:
    > Note that the value returned by rcu_dereference() is valid
    > only within the enclosing RCU read-side critical section [1]_.
    > For example, the following is **not** legal::
    > rcu_read_lock();
    > p &#x3D; rcu_dereference(head.next);
    > rcu_read_unlock();
    > x &#x3D; p-&gt;address;	/* BUG!!! */
    > rcu_read_lock();
    > y &#x3D; p-&gt;data;	/* BUG!!! */
    > rcu_read_unlock();
    > Fixes: a0bfde167b50 (&quot;Bluetooth: ISO: Add support for connecting multiple BISes&quot;)
    > Signed-off-by: Luiz Augusto von Dentz &lt;luiz.von.dentz@intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ Bluetooth: SCO: Add support for 16 bits transparent voice setting (@Frédéric Danis in [d0f4a51246e2935](https://github.com/sophgo/linux-riscv/commit/d0f4a51246e2935) at 2024-12-19 17:13:20)
    > [ Upstream commit 29a651451e6c264f58cd9d9a26088e579d17b242 ]
    > The voice setting is used by sco_connect() or sco_conn_defer_accept()
    > after being set by sco_sock_setsockopt().
    > The PCM part of the voice setting is used for offload mode through PCM
    > chipset port.
    > This commits add support for mSBC 16 bits offloading, i.e. audio data
    > not transported over HCI.
    > The BCM4349B1 supports 16 bits transparent data on its I2S port.
    > If BT_VOICE_TRANSPARENT is used when accepting a SCO connection, this
    > gives only garbage audio while using BT_VOICE_TRANSPARENT_16BIT gives
    > correct audio.
    > This has been tested with connection to iPhone 14 and Samsung S24.
    > Fixes: ad10b1a48754 (&quot;Bluetooth: Add Bluetooth socket voice option&quot;)
    > Signed-off-by: Frédéric Danis &lt;frederic.danis@collabora.com&gt;
    > Signed-off-by: Luiz Augusto von Dentz &lt;luiz.von.dentz@intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ Bluetooth: iso: Fix circular lock in iso_listen_bis (@Iulia Tanasescu in [c541d7b5e17987e](https://github.com/sophgo/linux-riscv/commit/c541d7b5e17987e) at 2024-12-19 17:13:20)
    > [ Upstream commit 168e28305b871d8ec604a8f51f35467b8d7ba05b ]
    > This fixes the circular locking dependency warning below, by
    > releasing the socket lock before enterning iso_listen_bis, to
    > avoid any potential deadlock with hdev lock.
    > [   75.307983] &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;
    > [   75.307984] WARNING: possible circular locking dependency detected
    > [   75.307985] 6.12.0-rc6+ #22 Not tainted
    > [   75.307987] ------------------------------------------------------
    > [   75.307987] kworker/u81:2/2623 is trying to acquire lock:
    > [   75.307988] ffff8fde1769da58 (sk_lock-AF_BLUETOOTH-BTPROTO_ISO)
    > at: iso_connect_cfm+0x253/0x840 [bluetooth]
    > [   75.308021]
    > but task is already holding lock:
    > [   75.308022] ffff8fdd61a10078 (&amp;hdev-&gt;lock)
    > at: hci_le_per_adv_report_evt+0x47/0x2f0 [bluetooth]
    > [   75.308053]
    > which lock already depends on the new lock.
    > [   75.308054]
    > the existing dependency chain (in reverse order) is:
    > [   75.308055]
    > -&gt; #1 (&amp;hdev-&gt;lock){+.+.}-{3:3}:
    > [   75.308057]        __mutex_lock+0xad/0xc50
    > [   75.308061]        mutex_lock_nested+0x1b/0x30
    > [   75.308063]        iso_sock_listen+0x143/0x5c0 [bluetooth]
    > [   75.308085]        __sys_listen_socket+0x49/0x60
    > [   75.308088]        __x64_sys_listen+0x4c/0x90
    > [   75.308090]        x64_sys_call+0x2517/0x25f0
    > [   75.308092]        do_syscall_64+0x87/0x150
    > [   75.308095]        entry_SYSCALL_64_after_hwframe+0x76/0x7e
    > [   75.308098]
    > -&gt; #0 (sk_lock-AF_BLUETOOTH-BTPROTO_ISO){+.+.}-{0:0}:
    > [   75.308100]        __lock_acquire+0x155e/0x25f0
    > [   75.308103]        lock_acquire+0xc9/0x300
    > [   75.308105]        lock_sock_nested+0x32/0x90
    > [   75.308107]        iso_connect_cfm+0x253/0x840 [bluetooth]
    > [   75.308128]        hci_connect_cfm+0x6c/0x190 [bluetooth]
    > [   75.308155]        hci_le_per_adv_report_evt+0x27b/0x2f0 [bluetooth]
    > [   75.308180]        hci_le_meta_evt+0xe7/0x200 [bluetooth]
    > [   75.308206]        hci_event_packet+0x21f/0x5c0 [bluetooth]
    > [   75.308230]        hci_rx_work+0x3ae/0xb10 [bluetooth]
    > [   75.308254]        process_one_work+0x212/0x740
    > [   75.308256]        worker_thread+0x1bd/0x3a0
    > [   75.308258]        kthread+0xe4/0x120
    > [   75.308259]        ret_from_fork+0x44/0x70
    > [   75.308261]        ret_from_fork_asm+0x1a/0x30
    > [   75.308263]
    > other info that might help us debug this:
    > [   75.308264]  Possible unsafe locking scenario:
    > [   75.308264]        CPU0                CPU1
    > [   75.308265]        ----                ----
    > [   75.308265]   lock(&amp;hdev-&gt;lock);
    > [   75.308267]                            lock(sk_lock-
    > AF_BLUETOOTH-BTPROTO_ISO);
    > [   75.308268]                            lock(&amp;hdev-&gt;lock);
    > [   75.308269]   lock(sk_lock-AF_BLUETOOTH-BTPROTO_ISO);
    > [   75.308270]
    > ** DEADLOCK ***
    > [   75.308271] 4 locks held by kworker/u81:2/2623:
    > [   75.308272]  #0: ffff8fdd66e52148 ((wq_completion)hci0#2){+.+.}-{0:0},
    > at: process_one_work+0x443/0x740
    > [   75.308276]  #1: ffffafb488b7fe48 ((work_completion)(&amp;hdev-&gt;rx_work)),
    > at: process_one_work+0x1ce/0x740
    > [   75.308280]  #2: ffff8fdd61a10078 (&amp;hdev-&gt;lock){+.+.}-{3:3}
    > at: hci_le_per_adv_report_evt+0x47/0x2f0 [bluetooth]
    > [   75.308304]  #3: ffffffffb6ba4900 (rcu_read_lock){....}-{1:2},
    > at: hci_connect_cfm+0x29/0x190 [bluetooth]
    > Fixes: 02171da6e86a (&quot;Bluetooth: ISO: Add hcon for listening bis sk&quot;)
    > Signed-off-by: Iulia Tanasescu &lt;iulia.tanasescu@nxp.com&gt;
    > Signed-off-by: Luiz Augusto von Dentz &lt;luiz.von.dentz@intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ASoC: Intel: sof_sdw: Add space for a terminator into DAIs array (@Charles Keepax in [b21a849764a4111](https://github.com/sophgo/linux-riscv/commit/b21a849764a4111) at 2024-12-19 17:13:20)
    > [ Upstream commit 255cc582e6e16191a20d54bcdbca6c91d3e90c5e ]
    > The code uses the initialised member of the asoc_sdw_dailink struct to
    > determine if a member of the array is in use. However in the case the
    > array is completely full this will lead to an access 1 past the end of
    > the array, expand the array by one entry to include a space for a
    > terminator.
    > Fixes: 27fd36aefa00 (&quot;ASoC: Intel: sof-sdw: Add new code for parsing the snd_soc_acpi structs&quot;)
    > Reviewed-by: Bard Liao &lt;yung-chuan.liao@linux.intel.com&gt;
    > Reviewed-by: Péter Ujfalusi &lt;peter.ujfalusi@linux.intel.com&gt;
    > Signed-off-by: Charles Keepax &lt;ckeepax@opensource.cirrus.com&gt;
    > Link: https://patch.msgid.link/20241212105742.1508574-1-ckeepax@opensource.cirrus.com
    > Signed-off-by: Mark Brown &lt;broonie@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ Bluetooth: iso: Fix recursive locking warning (@Iulia Tanasescu in [827f30b1dfaf304](https://github.com/sophgo/linux-riscv/commit/827f30b1dfaf304) at 2024-12-19 17:13:20)
    > [ Upstream commit 9bde7c3b3ad0e1f39d6df93dd1c9caf63e19e50f ]
    > This updates iso_sock_accept to use nested locking for the parent
    > socket, to avoid lockdep warnings caused because the parent and
    > child sockets are locked by the same thread:
    > [   41.585683] &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;
    > [   41.585688] WARNING: possible recursive locking detected
    > [   41.585694] 6.12.0-rc6+ #22 Not tainted
    > [   41.585701] --------------------------------------------
    > [   41.585705] iso-tester/3139 is trying to acquire lock:
    > [   41.585711] ffff988b29530a58 (sk_lock-AF_BLUETOOTH)
    > at: bt_accept_dequeue+0xe3/0x280 [bluetooth]
    > [   41.585905]
    > but task is already holding lock:
    > [   41.585909] ffff988b29533a58 (sk_lock-AF_BLUETOOTH)
    > at: iso_sock_accept+0x61/0x2d0 [bluetooth]
    > [   41.586064]
    > other info that might help us debug this:
    > [   41.586069]  Possible unsafe locking scenario:
    > [   41.586072]        CPU0
    > [   41.586076]        ----
    > [   41.586079]   lock(sk_lock-AF_BLUETOOTH);
    > [   41.586086]   lock(sk_lock-AF_BLUETOOTH);
    > [   41.586093]
    > ** DEADLOCK ***
    > [   41.586097]  May be due to missing lock nesting notation
    > [   41.586101] 1 lock held by iso-tester/3139:
    > [   41.586107]  #0: ffff988b29533a58 (sk_lock-AF_BLUETOOTH)
    > at: iso_sock_accept+0x61/0x2d0 [bluetooth]
    > Fixes: ccf74f2390d6 (&quot;Bluetooth: Add BTPROTO_ISO socket type&quot;)
    > Signed-off-by: Iulia Tanasescu &lt;iulia.tanasescu@nxp.com&gt;
    > Signed-off-by: Luiz Augusto von Dentz &lt;luiz.von.dentz@intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ Bluetooth: iso: Always release hdev at the end of iso_listen_bis (@Iulia Tanasescu in [4ca50db1c567d65](https://github.com/sophgo/linux-riscv/commit/4ca50db1c567d65) at 2024-12-19 17:13:20)
    > [ Upstream commit 9c76fff747a73ba01d1d87ed53dd9c00cb40ba05 ]
    > Since hci_get_route holds the device before returning, the hdev
    > should be released with hci_dev_put at the end of iso_listen_bis
    > even if the function returns with an error.
    > Fixes: 02171da6e86a (&quot;Bluetooth: ISO: Add hcon for listening bis sk&quot;)
    > Signed-off-by: Iulia Tanasescu &lt;iulia.tanasescu@nxp.com&gt;
    > Signed-off-by: Luiz Augusto von Dentz &lt;luiz.von.dentz@intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ACPICA: events/evxfregn: don&#x27;t release the ContextMutex that was never acquired (@Daniil Tatianin in [458aa6704c00cea](https://github.com/sophgo/linux-riscv/commit/458aa6704c00cea) at 2024-12-19 17:13:20)
    > [ Upstream commit c53d96a4481f42a1635b96d2c1acbb0a126bfd54 ]
    > This bug was first introduced in c27f3d011b08, where the author of the
    > patch probably meant to do DeleteMutex instead of ReleaseMutex. The
    > mutex leak was noticed later on and fixed in e4dfe108371, but the bogus
    > MutexRelease line was never removed, so do it now.
    > Link: https://github.com/acpica/acpica/pull/982
    > Fixes: c27f3d011b08 (&quot;ACPICA: Fix race in generic_serial_bus (I2C) and GPIO op_region parameter handling&quot;)
    > Signed-off-by: Daniil Tatianin &lt;d-tatianin@yandex-team.ru&gt;
    > Link: https://patch.msgid.link/20241122082954.658356-1-d-tatianin@yandex-team.ru
    > Signed-off-by: Rafael J. Wysocki &lt;rafael.j.wysocki@intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ team: Fix initial vlan_feature set in __team_compute_features (@Daniel Borkmann in [eddf3105e6198a3](https://github.com/sophgo/linux-riscv/commit/eddf3105e6198a3) at 2024-12-19 17:13:19)
    > [ Upstream commit 396699ac2cb1bc4e3485abb48a1e3e41956de0cd ]
    > Similarly as with bonding, fix the calculation of vlan_features to reuse
    > netdev_base_features() in order derive the set in the same way as
    > ndo_fix_features before iterating through the slave devices to refine the
    > feature set.
    > Fixes: 3625920b62c3 (&quot;teaming: fix vlan_features computing&quot;)
    > Signed-off-by: Daniel Borkmann &lt;daniel@iogearbox.net&gt;
    > Cc: Nikolay Aleksandrov &lt;razor@blackwall.org&gt;
    > Cc: Ido Schimmel &lt;idosch@idosch.org&gt;
    > Cc: Jiri Pirko &lt;jiri@nvidia.com&gt;
    > Reviewed-by: Nikolay Aleksandrov &lt;razor@blackwall.org&gt;
    > Reviewed-by: Hangbin Liu &lt;liuhangbin@gmail.com&gt;
    > Link: https://patch.msgid.link/20241210141245.327886-4-daniel@iogearbox.net
    > Signed-off-by: Paolo Abeni &lt;pabeni@redhat.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ team: Fix feature propagation of NETIF_F_GSO_ENCAP_ALL (@Daniel Borkmann in [e500152469fdb36](https://github.com/sophgo/linux-riscv/commit/e500152469fdb36) at 2024-12-19 17:13:19)
    > [ Upstream commit 98712844589e06d9aa305b5077169942139fd75c ]
    > Similar to bonding driver, add NETIF_F_GSO_ENCAP_ALL to TEAM_VLAN_FEATURES
    > in order to support slave devices which propagate NETIF_F_GSO_UDP_TUNNEL &amp;
    > NETIF_F_GSO_UDP_TUNNEL_CSUM as vlan_features.
    > Fixes: 3625920b62c3 (&quot;teaming: fix vlan_features computing&quot;)
    > Signed-off-by: Daniel Borkmann &lt;daniel@iogearbox.net&gt;
    > Cc: Nikolay Aleksandrov &lt;razor@blackwall.org&gt;
    > Cc: Ido Schimmel &lt;idosch@idosch.org&gt;
    > Cc: Jiri Pirko &lt;jiri@nvidia.com&gt;
    > Reviewed-by: Nikolay Aleksandrov &lt;razor@blackwall.org&gt;
    > Reviewed-by: Hangbin Liu &lt;liuhangbin@gmail.com&gt;
    > Link: https://patch.msgid.link/20241210141245.327886-5-daniel@iogearbox.net
    > Signed-off-by: Paolo Abeni &lt;pabeni@redhat.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ bonding: Fix feature propagation of NETIF_F_GSO_ENCAP_ALL (@Daniel Borkmann in [c6b9b1f67b6d6d4](https://github.com/sophgo/linux-riscv/commit/c6b9b1f67b6d6d4) at 2024-12-19 17:13:19)
    > [ Upstream commit 77b11c8bf3a228d1c63464534c2dcc8d9c8bf7ff ]
    > Drivers like mlx5 expose NIC&#x27;s vlan_features such as
    > NETIF_F_GSO_UDP_TUNNEL &amp; NETIF_F_GSO_UDP_TUNNEL_CSUM which are
    > later not propagated when the underlying devices are bonded and
    > a vlan device created on top of the bond.
    > Right now, the more cumbersome workaround for this is to create
    > the vlan on top of the mlx5 and then enslave the vlan devices
    > to a bond.
    > To fix this, add NETIF_F_GSO_ENCAP_ALL to BOND_VLAN_FEATURES
    > such that bond_compute_features() can probe and propagate the
    > vlan_features from the slave devices up to the vlan device.
    > Given the following bond:
    > # ethtool -i enp2s0f{0,1}np{0,1}
    > driver: mlx5_core
    > [...]
    > # ethtool -k enp2s0f0np0 | grep udp
    > tx-udp_tnl-segmentation: on
    > tx-udp_tnl-csum-segmentation: on
    > tx-udp-segmentation: on
    > rx-udp_tunnel-port-offload: on
    > rx-udp-gro-forwarding: off
    > # ethtool -k enp2s0f1np1 | grep udp
    > tx-udp_tnl-segmentation: on
    > tx-udp_tnl-csum-segmentation: on
    > tx-udp-segmentation: on
    > rx-udp_tunnel-port-offload: on
    > rx-udp-gro-forwarding: off
    > # ethtool -k bond0 | grep udp
    > tx-udp_tnl-segmentation: on
    > tx-udp_tnl-csum-segmentation: on
    > tx-udp-segmentation: on
    > rx-udp_tunnel-port-offload: off [fixed]
    > rx-udp-gro-forwarding: off
    > Before:
    > # ethtool -k bond0.100 | grep udp
    > tx-udp_tnl-segmentation: off [requested on]
    > tx-udp_tnl-csum-segmentation: off [requested on]
    > tx-udp-segmentation: on
    > rx-udp_tunnel-port-offload: off [fixed]
    > rx-udp-gro-forwarding: off
    > After:
    > # ethtool -k bond0.100 | grep udp
    > tx-udp_tnl-segmentation: on
    > tx-udp_tnl-csum-segmentation: on
    > tx-udp-segmentation: on
    > rx-udp_tunnel-port-offload: off [fixed]
    > rx-udp-gro-forwarding: off
    > Various users have run into this reporting performance issues when
    > configuring Cilium in vxlan tunneling mode and having the combination
    > of bond &amp; vlan for the core devices connecting the Kubernetes cluster
    > to the outside world.
    > Fixes: a9b3ace44c7d (&quot;bonding: fix vlan_features computing&quot;)
    > Signed-off-by: Daniel Borkmann &lt;daniel@iogearbox.net&gt;
    > Cc: Nikolay Aleksandrov &lt;razor@blackwall.org&gt;
    > Cc: Ido Schimmel &lt;idosch@idosch.org&gt;
    > Cc: Jiri Pirko &lt;jiri@nvidia.com&gt;
    > Reviewed-by: Nikolay Aleksandrov &lt;razor@blackwall.org&gt;
    > Reviewed-by: Hangbin Liu &lt;liuhangbin@gmail.com&gt;
    > Link: https://patch.msgid.link/20241210141245.327886-3-daniel@iogearbox.net
    > Signed-off-by: Paolo Abeni &lt;pabeni@redhat.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ bonding: Fix initial {vlan,mpls}_feature set in bond_compute_features (@Daniel Borkmann in [6069914e0f42c77](https://github.com/sophgo/linux-riscv/commit/6069914e0f42c77) at 2024-12-19 17:13:19)
    > [ Upstream commit d064ea7fe2a24938997b5e88e6b61cbb0a4bb906 ]
    > If a bonding device has slave devices, then the current logic to derive
    > the feature set for the master bond device is limited in that flags which
    > are fully supported by the underlying slave devices cannot be propagated
    > up to vlan devices which sit on top of bond devices. Instead, these get
    > blindly masked out via current NETIF_F_ALL_FOR_ALL logic.
    > vlan_features and mpls_features should reuse netdev_base_features() in
    > order derive the set in the same way as ndo_fix_features before iterating
    > through the slave devices to refine the feature set.
    > Fixes: a9b3ace44c7d (&quot;bonding: fix vlan_features computing&quot;)
    > Fixes: 2e770b507ccd (&quot;net: bonding: Inherit MPLS features from slave devices&quot;)
    > Signed-off-by: Daniel Borkmann &lt;daniel@iogearbox.net&gt;
    > Cc: Nikolay Aleksandrov &lt;razor@blackwall.org&gt;
    > Cc: Ido Schimmel &lt;idosch@idosch.org&gt;
    > Cc: Jiri Pirko &lt;jiri@nvidia.com&gt;
    > Reviewed-by: Nikolay Aleksandrov &lt;razor@blackwall.org&gt;
    > Reviewed-by: Hangbin Liu &lt;liuhangbin@gmail.com&gt;
    > Link: https://patch.msgid.link/20241210141245.327886-2-daniel@iogearbox.net
    > Signed-off-by: Paolo Abeni &lt;pabeni@redhat.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ net, team, bonding: Add netdev_base_features helper (@Daniel Borkmann in [4b8fd0751a2a609](https://github.com/sophgo/linux-riscv/commit/4b8fd0751a2a609) at 2024-12-19 17:13:19)
    > [ Upstream commit d2516c3a53705f783bb6868df0f4a2b977898a71 ]
    > Both bonding and team driver have logic to derive the base feature
    > flags before iterating over their slave devices to refine the set
    > via netdev_increment_features().
    > Add a small helper netdev_base_features() so this can be reused
    > instead of having it open-coded multiple times.
    > Signed-off-by: Daniel Borkmann &lt;daniel@iogearbox.net&gt;
    > Cc: Nikolay Aleksandrov &lt;razor@blackwall.org&gt;
    > Cc: Ido Schimmel &lt;idosch@idosch.org&gt;
    > Cc: Jiri Pirko &lt;jiri@nvidia.com&gt;
    > Reviewed-by: Hangbin Liu &lt;liuhangbin@gmail.com&gt;
    > Reviewed-by: Nikolay Aleksandrov &lt;razor@blackwall.org&gt;
    > Link: https://patch.msgid.link/20241210141245.327886-1-daniel@iogearbox.net
    > Signed-off-by: Paolo Abeni &lt;pabeni@redhat.com&gt;
    > Stable-dep-of: d064ea7fe2a2 (&quot;bonding: Fix initial {vlan,mpls}_feature set in bond_compute_features&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ net/sched: netem: account for backlog updates from child qdisc (@Martin Ottens in [356078a5c55ec8d](https://github.com/sophgo/linux-riscv/commit/356078a5c55ec8d) at 2024-12-19 17:13:19)
    > [ Upstream commit f8d4bc455047cf3903cd6f85f49978987dbb3027 ]
    > In general, &#x27;qlen&#x27; of any classful qdisc should keep track of the
    > number of packets that the qdisc itself and all of its children holds.
    > In case of netem, &#x27;qlen&#x27; only accounts for the packets in its internal
    > tfifo. When netem is used with a child qdisc, the child qdisc can use
    > &#x27;qdisc_tree_reduce_backlog&#x27; to inform its parent, netem, about created
    > or dropped SKBs. This function updates &#x27;qlen&#x27; and the backlog statistics
    > of netem, but netem does not account for changes made by a child qdisc.
    > &#x27;qlen&#x27; then indicates the wrong number of packets in the tfifo.
    > If a child qdisc creates new SKBs during enqueue and informs its parent
    > about this, netem&#x27;s &#x27;qlen&#x27; value is increased. When netem dequeues the
    > newly created SKBs from the child, the &#x27;qlen&#x27; in netem is not updated.
    > If &#x27;qlen&#x27; reaches the configured sch-&gt;limit, the enqueue function stops
    > working, even though the tfifo is not full.
    > Reproduce the bug:
    > Ensure that the sender machine has GSO enabled. Configure netem as root
    > qdisc and tbf as its child on the outgoing interface of the machine
    > as follows:
    > $ tc qdisc add dev &lt;oif&gt; root handle 1: netem delay 100ms limit 100
    > $ tc qdisc add dev &lt;oif&gt; parent 1:0 tbf rate 50Mbit burst 1542 latency 50ms
    > Send bulk TCP traffic out via this interface, e.g., by running an iPerf3
    > client on the machine. Check the qdisc statistics:
    > $ tc -s qdisc show dev &lt;oif&gt;
    > Statistics after 10s of iPerf3 TCP test before the fix (note that
    > netem&#x27;s backlog &gt; limit, netem stopped accepting packets):
    > qdisc netem 1: root refcnt 2 limit 1000 delay 100ms
    > Sent 2767766 bytes 1848 pkt (dropped 652, overlimits 0 requeues 0)
    > backlog 4294528236b 1155p requeues 0
    > qdisc tbf 10: parent 1:1 rate 50Mbit burst 1537b lat 50ms
    > Sent 2767766 bytes 1848 pkt (dropped 327, overlimits 7601 requeues 0)
    > backlog 0b 0p requeues 0
    > Statistics after the fix:
    > qdisc netem 1: root refcnt 2 limit 1000 delay 100ms
    > Sent 37766372 bytes 24974 pkt (dropped 9, overlimits 0 requeues 0)
    > backlog 0b 0p requeues 0
    > qdisc tbf 10: parent 1:1 rate 50Mbit burst 1537b lat 50ms
    > Sent 37766372 bytes 24974 pkt (dropped 327, overlimits 96017 requeues 0)
    > backlog 0b 0p requeues 0
    > tbf segments the GSO SKBs (tbf_segment) and updates the netem&#x27;s &#x27;qlen&#x27;.
    > The interface fully stops transferring packets and &quot;locks&quot;. In this case,
    > the child qdisc and tfifo are empty, but &#x27;qlen&#x27; indicates the tfifo is at
    > its limit and no more packets are accepted.
    > This patch adds a counter for the entries in the tfifo. Netem&#x27;s &#x27;qlen&#x27; is
    > only decreased when a packet is returned by its dequeue function, and not
    > during enqueuing into the child qdisc. External updates to &#x27;qlen&#x27; are thus
    > accounted for and only the behavior of the backlog statistics changes. As
    > in other qdiscs, &#x27;qlen&#x27; then keeps track of  how many packets are held in
    > netem and all of its children. As before, sch-&gt;limit remains as the
    > maximum number of packets in the tfifo. The same applies to netem&#x27;s
    > backlog statistics.
    > Fixes: 50612537e9ab (&quot;netem: fix classful handling&quot;)
    > Signed-off-by: Martin Ottens &lt;martin.ottens@fau.de&gt;
    > Acked-by: Jamal Hadi Salim &lt;jhs@mojatatu.com&gt;
    > Link: https://patch.msgid.link/20241210131412.1837202-1-martin.ottens@fau.de
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ASoC: fsl_spdif: change IFACE_PCM to IFACE_MIXER (@Shengjiu Wang in [c3a2fb308678ddc](https://github.com/sophgo/linux-riscv/commit/c3a2fb308678ddc) at 2024-12-19 17:13:18)
    > [ Upstream commit bb76e82bfe57fdd1fe595cb0ccd33159df49ed09 ]
    > As the snd_soc_card_get_kcontrol() is updated to use
    > snd_ctl_find_id_mixer() in
    > commit 897cc72b0837 (&quot;ASoC: soc-card: Use
    > snd_ctl_find_id_mixer() instead of open-coding&quot;)
    > which make the iface fix to be IFACE_MIXER.
    > Fixes: 897cc72b0837 (&quot;ASoC: soc-card: Use snd_ctl_find_id_mixer() instead of open-coding&quot;)
    > Signed-off-by: Shengjiu Wang &lt;shengjiu.wang@nxp.com&gt;
    > Link: https://patch.msgid.link/20241126053254.3657344-3-shengjiu.wang@nxp.com
    > Signed-off-by: Mark Brown &lt;broonie@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ selftests: netfilter: Stabilize rpath.sh (@Phil Sutter in [baf9d7f5a75f646](https://github.com/sophgo/linux-riscv/commit/baf9d7f5a75f646) at 2024-12-19 17:13:18)
    > [ Upstream commit d92906fd1b940681b4509f7bb8ae737789fb4695 ]
    > On some systems, neighbor discoveries from ns1 for fec0:42::1 (i.e., the
    > martian trap address) would happen at the wrong time and cause
    > false-negative test result.
    > Problem analysis also discovered that IPv6 martian ping test was broken
    > in that sent neighbor discoveries, not echo requests were inadvertently
    > trapped
    > Avoid the race condition by introducing the neighbors to each other
    > upfront. Also pin down the firewall rules to matching on echo requests
    > only.
    > Fixes: efb056e5f1f0 (&quot;netfilter: ip6t_rpfilter: Fix regression with VRF interfaces&quot;)
    > Signed-off-by: Phil Sutter &lt;phil@nwl.cc&gt;
    > Signed-off-by: Pablo Neira Ayuso &lt;pablo@netfilter.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ net: mana: Fix memory leak in mana_gd_setup_irqs (@Maxim Levitsky in [9fda340cbfbf790](https://github.com/sophgo/linux-riscv/commit/9fda340cbfbf790) at 2024-12-19 17:13:18)
    > [ Upstream commit bb1e3eb57d2cc38951f9a9f1b8c298ced175798f ]
    > Commit 8afefc361209 (&quot;net: mana: Assigning IRQ affinity on HT cores&quot;)
    > added memory allocation in mana_gd_setup_irqs of &#x27;irqs&#x27; but the code
    > doesn&#x27;t free this temporary array in the success path.
    > This was caught by kmemleak.
    > Fixes: 8afefc361209 (&quot;net: mana: Assigning IRQ affinity on HT cores&quot;)
    > Signed-off-by: Maxim Levitsky &lt;mlevitsk@redhat.com&gt;
    > Reviewed-by: Michal Swiatkowski &lt;michal.swiatkowski@linux.intel.com&gt;
    > Reviewed-by: Kalesh AP &lt;kalesh-anakkur.purayil@broadcom.com&gt;
    > Reviewed-by: Saurabh Sengar &lt;ssengar@linux.microsoft.com&gt;
    > Reviewed-by: Yury Norov &lt;yury.norov@gmail.com&gt;
    > Link: https://patch.msgid.link/20241209175751.287738-2-mlevitsk@redhat.com
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ net: mana: Fix irq_contexts memory leak in mana_gd_setup_irqs (@Maxim Levitsky in [9f468bfed1fba8d](https://github.com/sophgo/linux-riscv/commit/9f468bfed1fba8d) at 2024-12-19 17:13:18)
    > [ Upstream commit 9a5beb6ca6305de5c5210efab0702ea79b62eb39 ]
    > gc-&gt;irq_contexts is not freeded if one of the later operations
    > fail.
    > Suggested-by: Michael Kelley &lt;mhklinux@outlook.com&gt;
    > Fixes: 8afefc361209 (&quot;net: mana: Assigning IRQ affinity on HT cores&quot;)
    > Signed-off-by: Maxim Levitsky &lt;mlevitsk@redhat.com&gt;
    > Reviewed-by: Michal Swiatkowski &lt;michal.swiatkowski@linux.intel.com&gt;
    > Reviewed-by: Kalesh AP &lt;kalesh-anakkur.purayil@broadcom.com&gt;
    > Reviewed-by: Saurabh Sengar &lt;ssengar@linux.microsoft.com&gt;
    > Reviewed-by: Yury Norov &lt;yury.norov@gmail.com&gt;
    > Link: https://patch.msgid.link/20241209175751.287738-3-mlevitsk@redhat.com
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ netfilter: nf_tables: do not defer rule destruction via call_rcu (@Florian Westphal in [7cf0bd232b565d9](https://github.com/sophgo/linux-riscv/commit/7cf0bd232b565d9) at 2024-12-19 17:13:18)
    > [ Upstream commit b04df3da1b5c6f6dc7cdccc37941740c078c4043 ]
    > nf_tables_chain_destroy can sleep, it can&#x27;t be used from call_rcu
    > callbacks.
    > Moreover, nf_tables_rule_release() is only safe for error unwinding,
    > while transaction mutex is held and the to-be-desroyed rule was not
    > exposed to either dataplane or dumps, as it deactives+frees without
    > the required synchronize_rcu() in-between.
    > nft_rule_expr_deactivate() callbacks will change -&gt;use counters
    > of other chains/sets, see e.g. nft_lookup .deactivate callback, these
    > must be serialized via transaction mutex.
    > Also add a few lockdep asserts to make this more explicit.
    > Calling synchronize_rcu() isn&#x27;t ideal, but fixing this without is hard
    > and way more intrusive.  As-is, we can get:
    > WARNING: .. net/netfilter/nf_tables_api.c:5515 nft_set_destroy+0x..
    > Workqueue: events nf_tables_trans_destroy_work
    > RIP: 0010:nft_set_destroy+0x3fe/0x5c0
    > Call Trace:
    > &lt;TASK&gt;
    > nf_tables_trans_destroy_work+0x6b7/0xad0
    > process_one_work+0x64a/0xce0
    > worker_thread+0x613/0x10d0
    > In case the synchronize_rcu becomes an issue, we can explore alternatives.
    > One way would be to allocate nft_trans_rule objects + one nft_trans_chain
    > object, deactivate the rules + the chain and then defer the freeing to the
    > nft destroy workqueue.  We&#x27;d still need to keep the synchronize_rcu path as
    > a fallback to handle -ENOMEM corner cases though.
    > Reported-by: syzbot+b26935466701e56cfdc2@syzkaller.appspotmail.com
    > Closes: https://lore.kernel.org/all/67478d92.050a0220.253251.0062.GAE@google.com/T/
    > Fixes: c03d278fdf35 (&quot;netfilter: nf_tables: wait for rcu grace period on net_device removal&quot;)
    > Signed-off-by: Florian Westphal &lt;fw@strlen.de&gt;
    > Signed-off-by: Pablo Neira Ayuso &lt;pablo@netfilter.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ net: dsa: felix: fix stuck CPU-injected packets with short taprio windows (@Vladimir Oltean in [62380275954e53a](https://github.com/sophgo/linux-riscv/commit/62380275954e53a) at 2024-12-19 17:13:18)
    > [ Upstream commit acfcdb78d5d4cdb78e975210c8825b9a112463f6 ]
    > With this port schedule:
    > tc qdisc replace dev $send_if parent root handle 100 taprio \
    > num_tc 8 queues 1@0 1@1 1@2 1@3 1@4 1@5 1@6 1@7 \
    > map 0 1 2 3 4 5 6 7 \
    > base-time 0 cycle-time 10000 \
    > sched-entry S 01 1250 \
    > sched-entry S 02 1250 \
    > sched-entry S 04 1250 \
    > sched-entry S 08 1250 \
    > sched-entry S 10 1250 \
    > sched-entry S 20 1250 \
    > sched-entry S 40 1250 \
    > sched-entry S 80 1250 \
    > flags 2
    > ptp4l would fail to take TX timestamps of Pdelay_Resp messages like this:
    > increasing tx_timestamp_timeout may correct this issue, but it is likely caused by a driver bug
    > ptp4l[4134.168]: port 2: send peer delay response failed
    > It turns out that the driver can&#x27;t take their TX timestamps because it
    > can&#x27;t transmit them in the first place. And there&#x27;s nothing special
    > about the Pdelay_Resp packets - they&#x27;re just regular 68 byte packets.
    > But with this taprio configuration, the switch would refuse to send even
    > the ETH_ZLEN minimum packet size.
    > This should have definitely not been the case. When applying the taprio
    > config, the driver prints:
    > mscc_felix 0000:00:00.5: port 0 tc 0 min gate length 1250 ns not enough for max frame size 1526 at 1000 Mbps, dropping frames over 132 octets including FCS
    > mscc_felix 0000:00:00.5: port 0 tc 1 min gate length 1250 ns not enough for max frame size 1526 at 1000 Mbps, dropping frames over 132 octets including FCS
    > mscc_felix 0000:00:00.5: port 0 tc 2 min gate length 1250 ns not enough for max frame size 1526 at 1000 Mbps, dropping frames over 132 octets including FCS
    > mscc_felix 0000:00:00.5: port 0 tc 3 min gate length 1250 ns not enough for max frame size 1526 at 1000 Mbps, dropping frames over 132 octets including FCS
    > mscc_felix 0000:00:00.5: port 0 tc 4 min gate length 1250 ns not enough for max frame size 1526 at 1000 Mbps, dropping frames over 132 octets including FCS
    > mscc_felix 0000:00:00.5: port 0 tc 5 min gate length 1250 ns not enough for max frame size 1526 at 1000 Mbps, dropping frames over 132 octets including FCS
    > mscc_felix 0000:00:00.5: port 0 tc 6 min gate length 1250 ns not enough for max frame size 1526 at 1000 Mbps, dropping frames over 132 octets including FCS
    > mscc_felix 0000:00:00.5: port 0 tc 7 min gate length 1250 ns not enough for max frame size 1526 at 1000 Mbps, dropping frames over 132 octets including FCS
    > and thus, everything under 132 bytes - ETH_FCS_LEN should have been sent
    > without problems. Yet it&#x27;s not.
    > For the forwarding path, the configuration is fine, yet packets injected
    > from Linux get stuck with this schedule no matter what.
    > The first hint that the static guard bands are the cause of the problem
    > is that reverting Michael Walle&#x27;s commit 297c4de6f780 (&quot;net: dsa: felix:
    > re-enable TAS guard band mode&quot;) made things work. It must be that the
    > guard bands are calculated incorrectly.
    > I remembered that there is a magic constant in the driver, set to 33 ns
    > for no logical reason other than experimentation, which says &quot;never let
    > the static guard bands get so large as to leave less than this amount of
    > remaining space in the time slot, because the queue system will refuse
    > to schedule packets otherwise, and they will get stuck&quot;. I had a hunch
    > that my previous experimentally-determined value was only good for
    > packets coming from the forwarding path, and that the CPU injection path
    > needed more.
    > I came to the new value of 35 ns through binary search, after seeing
    > that with 544 ns (the bit time required to send the Pdelay_Resp packet
    > at gigabit) it works. Again, this is purely experimental, there&#x27;s no
    > logic and the manual doesn&#x27;t say anything.
    > The new driver prints for this schedule look like this:
    > mscc_felix 0000:00:00.5: port 0 tc 0 min gate length 1250 ns not enough for max frame size 1526 at 1000 Mbps, dropping frames over 131 octets including FCS
    > mscc_felix 0000:00:00.5: port 0 tc 1 min gate length 1250 ns not enough for max frame size 1526 at 1000 Mbps, dropping frames over 131 octets including FCS
    > mscc_felix 0000:00:00.5: port 0 tc 2 min gate length 1250 ns not enough for max frame size 1526 at 1000 Mbps, dropping frames over 131 octets including FCS
    > mscc_felix 0000:00:00.5: port 0 tc 3 min gate length 1250 ns not enough for max frame size 1526 at 1000 Mbps, dropping frames over 131 octets including FCS
    > mscc_felix 0000:00:00.5: port 0 tc 4 min gate length 1250 ns not enough for max frame size 1526 at 1000 Mbps, dropping frames over 131 octets including FCS
    > mscc_felix 0000:00:00.5: port 0 tc 5 min gate length 1250 ns not enough for max frame size 1526 at 1000 Mbps, dropping frames over 131 octets including FCS
    > mscc_felix 0000:00:00.5: port 0 tc 6 min gate length 1250 ns not enough for max frame size 1526 at 1000 Mbps, dropping frames over 131 octets including FCS
    > mscc_felix 0000:00:00.5: port 0 tc 7 min gate length 1250 ns not enough for max frame size 1526 at 1000 Mbps, dropping frames over 131 octets including FCS
    > So yes, the maximum MTU is now even smaller by 1 byte than before.
    > This is maybe counter-intuitive, but makes more sense with a diagram of
    > one time slot.
    > Before:
    > Gate open                                   Gate close
    > |                                                    |
    > v           1250 ns total time slot duration         v
    > &lt;----------------------------------------------------&gt;
    > &lt;----&gt;&lt;----------------------------------------------&gt;
    > 33 ns            1217 ns static guard band
    > useful
    > Gate open                                   Gate close
    > |                                                    |
    > v           1250 ns total time slot duration         v
    > &lt;----------------------------------------------------&gt;
    > &lt;-----&gt;&lt;---------------------------------------------&gt;
    > 35 ns            1215 ns static guard band
    > useful
    > The static guard band implemented by this switch hardware directly
    > determines the maximum allowable MTU for that traffic class. The larger
    > it is, the earlier the switch will stop scheduling frames for
    > transmission, because otherwise they might overrun the gate close time
    > (and avoiding that is the entire purpose of Michael&#x27;s patch).
    > So, we now have guard bands smaller by 2 ns, thus, in this particular
    > case, we lose a byte of the maximum MTU.
    > Fixes: 11afdc6526de (&quot;net: dsa: felix: tc-taprio intervals smaller than MTU should send at least one packet&quot;)
    > Signed-off-by: Vladimir Oltean &lt;vladimir.oltean@nxp.com&gt;
    > Reviewed-by: Michael Walle &lt;mwalle@kernel.org&gt;
    > Link: https://patch.msgid.link/20241210132640.3426788-1-vladimir.oltean@nxp.com
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ netfilter: IDLETIMER: Fix for possible ABBA deadlock (@Phil Sutter in [45fe76573a2557f](https://github.com/sophgo/linux-riscv/commit/45fe76573a2557f) at 2024-12-19 17:13:18)
    > [ Upstream commit f36b01994d68ffc253c8296e2228dfe6e6431c03 ]
    > Deletion of the last rule referencing a given idletimer may happen at
    > the same time as a read of its file in sysfs:
    > | &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;
    > | WARNING: possible circular locking dependency detected
    > | 6.12.0-rc7-01692-g5e9a28f41134-dirty #594 Not tainted
    > | ------------------------------------------------------
    > | iptables/3303 is trying to acquire lock:
    > | ffff8881057e04b8 (kn-&gt;active#48){++++}-{0:0}, at: __kernfs_remove+0x20
    > |
    > | but task is already holding lock:
    > | ffffffffa0249068 (list_mutex){+.+.}-{3:3}, at: idletimer_tg_destroy_v]
    > |
    > | which lock already depends on the new lock.
    > A simple reproducer is:
    > | #!/bin/bash
    > |
    > | while true; do
    > |         iptables -A INPUT -i foo -j IDLETIMER --timeout 10 --label &quot;testme&quot;
    > |         iptables -D INPUT -i foo -j IDLETIMER --timeout 10 --label &quot;testme&quot;
    > | done &amp;
    > | while true; do
    > |         cat /sys/class/xt_idletimer/timers/testme &gt;/dev/null
    > | done
    > Avoid this by freeing list_mutex right after deleting the element from
    > the list, then continuing with the teardown.
    > Fixes: 0902b469bd25 (&quot;netfilter: xtables: idletimer target implementation&quot;)
    > Signed-off-by: Phil Sutter &lt;phil@nwl.cc&gt;
    > Signed-off-by: Pablo Neira Ayuso &lt;pablo@netfilter.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ libperf: evlist: Fix --cpu argument on hybrid platform (@James Clark in [eef2a7d8113c25e](https://github.com/sophgo/linux-riscv/commit/eef2a7d8113c25e) at 2024-12-19 17:13:17)
    > [ Upstream commit f7e36d02d771ee14acae1482091718460cffb321 ]
    > Since the linked fixes: commit, specifying a CPU on hybrid platforms
    > results in an error because Perf tries to open an extended type event
    > on &quot;any&quot; CPU which isn&#x27;t valid. Extended type events can only be opened
    > on CPUs that match the type.
    > Before (working):
    > $ perf record --cpu 1 -- true
    > [ perf record: Woken up 1 times to write data ]
    > [ perf record: Captured and wrote 2.385 MB perf.data (7 samples) ]
    > After (not working):
    > $ perf record -C 1 -- true
    > WARNING: A requested CPU in &#x27;1&#x27; is not supported by PMU &#x27;cpu_atom&#x27; (CPUs 16-27) for event &#x27;cycles:P&#x27;
    > Error:
    > The sys_perf_event_open() syscall returned with 22 (Invalid argument) for event (cpu_atom/cycles:P/).
    > /bin/dmesg | grep -i perf may provide additional information.
    > (Ignore the warning message, that&#x27;s expected and not particularly
    > relevant to this issue).
    > This is because perf_cpu_map__intersect() of the user specified CPU (1)
    > and one of the PMU&#x27;s CPUs (16-27) correctly results in an empty (NULL)
    > CPU map. However for the purposes of opening an event, libperf converts
    > empty CPU maps into an any CPU (-1) which the kernel rejects.
    > Fix it by deleting evsels with empty CPU maps in the specific case where
    > user requested CPU maps are evaluated.
    > Fixes: 251aa040244a (&quot;perf parse-events: Wildcard most &quot;numeric&quot; events&quot;)
    > Reviewed-by: Ian Rogers &lt;irogers@google.com&gt;
    > Tested-by: Thomas Falcon &lt;thomas.falcon@intel.com&gt;
    > Signed-off-by: James Clark &lt;james.clark@linaro.org&gt;
    > Tested-by: Arnaldo Carvalho de Melo &lt;acme@redhat.com&gt;
    > Link: https://lore.kernel.org/r/20241114160450.295844-2-james.clark@linaro.org
    > Signed-off-by: Namhyung Kim &lt;namhyung@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ASoC: tas2781: Fix calibration issue in stress test (@Shenghao Ding in [e4ac72dd79e0687](https://github.com/sophgo/linux-riscv/commit/e4ac72dd79e0687) at 2024-12-19 17:13:17)
    > [ Upstream commit 2aa13da97e2b92d20a8ad4ead10da89f880b64e7 ]
    > One specific test condition: the default registers of p[j].reg ~
    > p[j+3].reg are 0, TASDEVICE_REG(0x00, 0x14, 0x38)(PLT_FLAG_REG),
    > TASDEVICE_REG(0x00, 0x14, 0x40)(SINEGAIN_REG), and
    > TASDEVICE_REG(0x00, 0x14, 0x44)(SINEGAIN2_REG). After first calibration,
    > they are freshed to TASDEVICE_REG(0x00, 0x1a, 0x20), TASDEVICE_REG(0x00,
    > 0x16, 0x58)(PLT_FLAG_REG), TASDEVICE_REG(0x00, 0x14, 0x44)(SINEGAIN_REG),
    > and TASDEVICE_REG(0x00, 0x16, 0x64)(SINEGAIN2_REG) via &quot;Calibration Start&quot;
    > kcontrol. In second calibration, the p[j].reg ~ p[j+3].reg have already
    > become tas2781_cali_start_reg. However, p[j+2].reg, TASDEVICE_REG(0x00,
    > 0x14, 0x44)(SINEGAIN_REG), will be freshed to TASDEVICE_REG(0x00, 0x16,
    > 0x64), which is the third register in the input params of the kcontrol.
    > This is why only first calibration can work, the second-time, third-time
    > or more-time calibration always failed without reboot. Of course, if no
    > p[j].reg is in the list of tas2781_cali_start_reg, this stress test can
    > work well.
    > Fixes: 49e2e353fb0d (&quot;ASoC: tas2781: Add Calibration Kcontrols for Chromebook&quot;)
    > Signed-off-by: Shenghao Ding &lt;shenghao-ding@ti.com&gt;
    > Link: https://patch.msgid.link/20241211043859.1328-1-shenghao-ding@ti.com
    > Signed-off-by: Mark Brown &lt;broonie@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ net: renesas: rswitch: avoid use-after-put for a device tree node (@Nikita Yushchenko in [92007a28f954130](https://github.com/sophgo/linux-riscv/commit/92007a28f954130) at 2024-12-19 17:13:17)
    > [ Upstream commit 66b7e9f85b8459c823b11e9af69dbf4be5eb6be8 ]
    > The device tree node saved in the rswitch_device structure is used at
    > several driver locations. So passing this node to of_node_put() after
    > the first use is wrong.
    > Move of_node_put() for this node to exit paths.
    > Fixes: b46f1e579329 (&quot;net: renesas: rswitch: Simplify struct phy * handling&quot;)
    > Signed-off-by: Nikita Yushchenko &lt;nikita.yoush@cogentembedded.com&gt;
    > Reviewed-by: Yoshihiro Shimoda &lt;yoshihiro.shimoda.uh@renesas.com&gt;
    > Link: https://patch.msgid.link/20241208095004.69468-5-nikita.yoush@cogentembedded.com
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ASoC: fsl_xcvr: change IFACE_PCM to IFACE_MIXER (@Shengjiu Wang in [1e65b0511203030](https://github.com/sophgo/linux-riscv/commit/1e65b0511203030) at 2024-12-19 17:13:17)
    > [ Upstream commit 7c17f7780a48b5ed36b6d13a06004fac993e75af ]
    > As the snd_soc_card_get_kcontrol() is updated to use
    > snd_ctl_find_id_mixer() in
    > commit 897cc72b0837 (&quot;ASoC: soc-card: Use
    > snd_ctl_find_id_mixer() instead of open-coding&quot;)
    > which make the iface fix to be IFACE_MIXER.
    > Fixes: 897cc72b0837 (&quot;ASoC: soc-card: Use snd_ctl_find_id_mixer() instead of open-coding&quot;)
    > Signed-off-by: Shengjiu Wang &lt;shengjiu.wang@nxp.com&gt;
    > Link: https://patch.msgid.link/20241126053254.3657344-2-shengjiu.wang@nxp.com
    > Signed-off-by: Mark Brown &lt;broonie@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ Bluetooth: Improve setsockopt() handling of malformed user input (@Michal Luczaj in [13ba06e2601e8a3](https://github.com/sophgo/linux-riscv/commit/13ba06e2601e8a3) at 2024-12-19 17:13:17)
    > [ Upstream commit 3e643e4efa1e87432204b62f9cfdea3b2508c830 ]
    > The bt_copy_from_sockptr() return value is being misinterpreted by most
    > users: a non-zero result is mistakenly assumed to represent an error code,
    > but actually indicates the number of bytes that could not be copied.
    > Remove bt_copy_from_sockptr() and adapt callers to use
    > copy_safe_from_sockptr().
    > For sco_sock_setsockopt() (case BT_CODEC) use copy_struct_from_sockptr() to
    > scrub parts of uninitialized buffer.
    > Opportunistically, rename &#x60;len&#x60; to &#x60;optlen&#x60; in hci_sock_setsockopt_old()
    > and hci_sock_setsockopt().
    > Fixes: 51eda36d33e4 (&quot;Bluetooth: SCO: Fix not validating setsockopt user input&quot;)
    > Fixes: a97de7bff13b (&quot;Bluetooth: RFCOMM: Fix not validating setsockopt user input&quot;)
    > Fixes: 4f3951242ace (&quot;Bluetooth: L2CAP: Fix not validating setsockopt user input&quot;)
    > Fixes: 9e8742cdfc4b (&quot;Bluetooth: ISO: Fix not validating setsockopt user input&quot;)
    > Fixes: b2186061d604 (&quot;Bluetooth: hci_sock: Fix not validating setsockopt user input&quot;)
    > Reviewed-by: Luiz Augusto von Dentz &lt;luiz.von.dentz@intel.com&gt;
    > Reviewed-by: David Wei &lt;dw@davidwei.uk&gt;
    > Signed-off-by: Michal Luczaj &lt;mhal@rbox.co&gt;
    > Signed-off-by: Luiz Augusto von Dentz &lt;luiz.von.dentz@intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ net: renesas: rswitch: handle stop vs interrupt race (@Nikita Yushchenko in [0e01edde2559b0b](https://github.com/sophgo/linux-riscv/commit/0e01edde2559b0b) at 2024-12-19 17:13:17)
    > [ Upstream commit 3dd002f20098b9569f8fd7f8703f364571e2e975 ]
    > Currently the stop routine of rswitch driver does not immediately
    > prevent hardware from continuing to update descriptors and requesting
    > interrupts.
    > It can happen that when rswitch_stop() executes the masking of
    > interrupts from the queues of the port being closed, napi poll for
    > that port is already scheduled or running on a different CPU. When
    > execution of this napi poll completes, it will unmask the interrupts.
    > And unmasked interrupt can fire after rswitch_stop() returns from
    > napi_disable() call. Then, the handler won&#x27;t mask it, because
    > napi_schedule_prep() will return false, and interrupt storm will
    > happen.
    > This can&#x27;t be fixed by making rswitch_stop() call napi_disable() before
    > masking interrupts. In this case, the interrupt storm will happen if
    > interrupt fires between napi_disable() and masking.
    > Fix this by checking for priv-&gt;opened_ports bit when unmasking
    > interrupts after napi poll. For that to be consistent, move
    > priv-&gt;opened_ports changes into spinlock-protected areas, and reorder
    > other operations in rswitch_open() and rswitch_stop() accordingly.
    > Signed-off-by: Nikita Yushchenko &lt;nikita.yoush@cogentembedded.com&gt;
    > Reviewed-by: Yoshihiro Shimoda &lt;yoshihiro.shimoda.uh@renesas.com&gt;
    > Fixes: 3590918b5d07 (&quot;net: ethernet: renesas: Add support for &quot;Ethernet Switch&quot;&quot;)
    > Link: https://patch.msgid.link/20241209113204.175015-1-nikita.yoush@cogentembedded.com
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ bnxt_en: Fix aggregation ID mask to prevent oops on 5760X chips (@Michael Chan in [fe9274027697c69](https://github.com/sophgo/linux-riscv/commit/fe9274027697c69) at 2024-12-19 17:13:16)
    > [ Upstream commit 24c6843b7393ebc80962b59d7ae71af91bf0dcc1 ]
    > The 5760X (P7) chip&#x27;s HW GRO/LRO interface is very similar to that of
    > the previous generation (5750X or P5).  However, the aggregation ID
    > fields in the completion structures on P7 have been redefined from
    > 16 bits to 12 bits.  The freed up 4 bits are redefined for part of the
    > metadata such as the VLAN ID.  The aggregation ID mask was not modified
    > when adding support for P7 chips.  Including the extra 4 bits for the
    > aggregation ID can potentially cause the driver to store or fetch the
    > packet header of GRO/LRO packets in the wrong TPA buffer.  It may hit
    > the BUG() condition in __skb_pull() because the SKB contains no valid
    > packet header:
    > kernel BUG at include/linux/skbuff.h:2766!
    > Oops: invalid opcode: 0000 1 PREEMPT SMP NOPTI
    > CPU: 4 UID: 0 PID: 0 Comm: swapper/4 Kdump: loaded Tainted: G           OE      6.12.0-rc2+ #7
    > Tainted: [O]&#x3D;OOT_MODULE, [E]&#x3D;UNSIGNED_MODULE
    > Hardware name: Dell Inc. PowerEdge R760/0VRV9X, BIOS 1.0.1 12/27/2022
    > RIP: 0010:eth_type_trans+0xda/0x140
    > Code: 80 00 00 00 eb c1 8b 47 70 2b 47 74 48 8b 97 d0 00 00 00 83 f8 01 7e 1b 48 85 d2 74 06 66 83 3a ff 74 09 b8 00 04 00 00 eb a5 &lt;0f&gt; 0b b8 00 01 00 00 eb 9c 48 85 ff 74 eb 31 f6 b9 02 00 00 00 48
    > RSP: 0018:ff615003803fcc28 EFLAGS: 00010283
    > RAX: 00000000000022d2 RBX: 0000000000000003 RCX: ff2e8c25da334040
    > RDX: 0000000000000040 RSI: ff2e8c25c1ce8000 RDI: ff2e8c25869f9000
    > RBP: ff2e8c258c31c000 R08: ff2e8c25da334000 R09: 0000000000000001
    > R10: ff2e8c25da3342c0 R11: ff2e8c25c1ce89c0 R12: ff2e8c258e0990b0
    > R13: ff2e8c25bb120000 R14: ff2e8c25c1ce89c0 R15: ff2e8c25869f9000
    > FS:  0000000000000000(0000) GS:ff2e8c34be300000(0000) knlGS:0000000000000000
    > CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
    > CR2: 000055f05317e4c8 CR3: 000000108bac6006 CR4: 0000000000773ef0
    > DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
    > DR3: 0000000000000000 DR6: 00000000fffe07f0 DR7: 0000000000000400
    > PKRU: 55555554
    > Call Trace:
    > &lt;IRQ&gt;
    > ? die+0x33/0x90
    > ? do_trap+0xd9/0x100
    > ? eth_type_trans+0xda/0x140
    > ? do_error_trap+0x65/0x80
    > ? eth_type_trans+0xda/0x140
    > ? exc_invalid_op+0x4e/0x70
    > ? eth_type_trans+0xda/0x140
    > ? asm_exc_invalid_op+0x16/0x20
    > ? eth_type_trans+0xda/0x140
    > bnxt_tpa_end+0x10b/0x6b0 [bnxt_en]
    > ? bnxt_tpa_start+0x195/0x320 [bnxt_en]
    > bnxt_rx_pkt+0x902/0xd90 [bnxt_en]
    > ? __bnxt_tx_int.constprop.0+0x89/0x300 [bnxt_en]
    > ? kmem_cache_free+0x343/0x440
    > ? __bnxt_tx_int.constprop.0+0x24f/0x300 [bnxt_en]
    > __bnxt_poll_work+0x193/0x370 [bnxt_en]
    > bnxt_poll_p5+0x9a/0x300 [bnxt_en]
    > ? try_to_wake_up+0x209/0x670
    > __napi_poll+0x29/0x1b0
    > Fix it by redefining the aggregation ID mask for P5_PLUS chips to be
    > 12 bits.  This will work because the maximum aggregation ID is less
    > than 4096 on all P5_PLUS chips.
    > Fixes: 13d2d3d381ee (&quot;bnxt_en: Add new P7 hardware interface definitions&quot;)
    > Reviewed-by: Damodharam Ammepalli &lt;damodharam.ammepalli@broadcom.com&gt;
    > Reviewed-by: Kalesh AP &lt;kalesh-anakkur.purayil@broadcom.com&gt;
    > Reviewed-by: Andy Gospodarek &lt;andrew.gospodarek@broadcom.com&gt;
    > Signed-off-by: Michael Chan &lt;michael.chan@broadcom.com&gt;
    > Reviewed-by: Simon Horman &lt;horms@kernel.org&gt;
    > Link: https://patch.msgid.link/20241209015448.1937766-1-michael.chan@broadcom.com
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ net: renesas: rswitch: fix possible early skb release (@Nikita Yushchenko in [f36e30822f1a4e6](https://github.com/sophgo/linux-riscv/commit/f36e30822f1a4e6) at 2024-12-19 17:13:16)
    > [ Upstream commit 5cb099902b6b6292b3a85ffa1bb844e0ba195945 ]
    > When sending frame split into multiple descriptors, hardware processes
    > descriptors one by one, including writing back DT values. The first
    > descriptor could be already marked as completed when processing of
    > next descriptors for the same frame is still in progress.
    > Although only the last descriptor is configured to generate interrupt,
    > completion of the first descriptor could be noticed by the driver when
    > handling interrupt for the previous frame.
    > Currently, driver stores skb in the entry that corresponds to the first
    > descriptor. This results into skb could be unmapped and freed when
    > hardware did not complete the send yet. This opens a window for
    > corrupting the data being sent.
    > Fix this by saving skb in the entry that corresponds to the last
    > descriptor used to send the frame.
    > Fixes: d2c96b9d5f83 (&quot;net: rswitch: Add jumbo frames handling for TX&quot;)
    > Signed-off-by: Nikita Yushchenko &lt;nikita.yoush@cogentembedded.com&gt;
    > Reviewed-by: Yoshihiro Shimoda &lt;yoshihiro.shimoda.uh@renesas.com&gt;
    > Link: https://patch.msgid.link/20241208095004.69468-2-nikita.yoush@cogentembedded.com
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ block: get wp_offset by bdev_offset_from_zone_start (@LongPing Wei in [e7b02a0febbcd76](https://github.com/sophgo/linux-riscv/commit/e7b02a0febbcd76) at 2024-12-19 17:13:16)
    > [ Upstream commit 790eb09e59709a1ffc1c64fe4aae2789120851b0 ]
    > Call bdev_offset_from_zone_start() instead of open-coding it.
    > Fixes: dd291d77cc90 (&quot;block: Introduce zone write plugging&quot;)
    > Signed-off-by: LongPing Wei &lt;weilongping@oppo.com&gt;
    > Reviewed-by: Damien Le Moal &lt;dlemoal@kernel.org&gt;
    > Reviewed-by: Bart Van Assche &lt;bvanassche@acm.org&gt;
    > Link: https://lore.kernel.org/r/20241107020439.1644577-1-weilongping@oppo.com
    > Signed-off-by: Jens Axboe &lt;axboe@kernel.dk&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ net: renesas: rswitch: fix leaked pointer on error path (@Nikita Yushchenko in [df3aa9c5600d14f](https://github.com/sophgo/linux-riscv/commit/df3aa9c5600d14f) at 2024-12-19 17:13:16)
    > [ Upstream commit bb617328bafa1023d8e9c25a25345a564c66c14f ]
    > If error path is taken while filling descriptor for a frame, skb
    > pointer is left in the entry. Later, on the ring entry reuse, the
    > same entry could be used as a part of a multi-descriptor frame,
    > and skb for that new frame could be stored in a different entry.
    > Then, the stale pointer will reach the completion routine, and passed
    > to the release operation.
    > Fix that by clearing the saved skb pointer at the error path.
    > Fixes: d2c96b9d5f83 (&quot;net: rswitch: Add jumbo frames handling for TX&quot;)
    > Signed-off-by: Nikita Yushchenko &lt;nikita.yoush@cogentembedded.com&gt;
    > Reviewed-by: Yoshihiro Shimoda &lt;yoshihiro.shimoda.uh@renesas.com&gt;
    > Link: https://patch.msgid.link/20241208095004.69468-4-nikita.yoush@cogentembedded.com
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ net: renesas: rswitch: fix race window between tx start and complete (@Nikita Yushchenko in [d39c2d9577c4a35](https://github.com/sophgo/linux-riscv/commit/d39c2d9577c4a35) at 2024-12-19 17:13:16)
    > [ Upstream commit 0c9547e6ccf40455b0574cf589be3b152a3edf5b ]
    > If hardware is already transmitting, it can start handling the
    > descriptor being written to immediately after it observes updated DT
    > field, before the queue is kicked by a write to GWTRC.
    > If the start_xmit() execution is preempted at unfortunate moment, this
    > transmission can complete, and interrupt handled, before gq-&gt;cur gets
    > updated. With the current implementation of completion, this will cause
    > the last entry not completed.
    > Fix that by changing completion loop to check DT values directly, instead
    > of depending on gq-&gt;cur.
    > Fixes: 3590918b5d07 (&quot;net: ethernet: renesas: Add support for &quot;Ethernet Switch&quot;&quot;)
    > Signed-off-by: Nikita Yushchenko &lt;nikita.yoush@cogentembedded.com&gt;
    > Reviewed-by: Yoshihiro Shimoda &lt;yoshihiro.shimoda.uh@renesas.com&gt;
    > Link: https://patch.msgid.link/20241208095004.69468-3-nikita.yoush@cogentembedded.com
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ Documentation: networking: Add a caveat to nexthop_compat_mode sysctl (@Petr Machata in [3f5bf3dc6f310bb](https://github.com/sophgo/linux-riscv/commit/3f5bf3dc6f310bb) at 2024-12-19 17:13:16)
    > [ Upstream commit bbe4b41259a3e255a16d795486d331c1670b4e75 ]
    > net.ipv4.nexthop_compat_mode was added when nexthop objects were added to
    > provide the view of nexthop objects through the usual lens of the route
    > UAPI. As nexthop objects evolved, the information provided through this
    > lens became incomplete. For example, details of resilient nexthop groups
    > are obviously omitted.
    > Now that 16-bit nexthop group weights are a thing, the 8-bit UAPI cannot
    > convey the &gt;8-bit weight accurately. Instead of inventing workarounds for
    > an obsolete interface, just document the expectations of inaccuracy.
    > Fixes: b72a6a7ab957 (&quot;net: nexthop: Increase weight to u16&quot;)
    > Signed-off-by: Petr Machata &lt;petrm@nvidia.com&gt;
    > Reviewed-by: Ido Schimmel &lt;idosch@nvidia.com&gt;
    > Reviewed-by: David Ahern &lt;dsahern@kernel.org&gt;
    > Link: https://patch.msgid.link/b575e32399ccacd09079b2a218255164535123bd.1733740749.git.petrm@nvidia.com
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ cifs: Fix rmdir failure due to ongoing I/O on deleted file (@David Howells in [0dfcc215b4ce799](https://github.com/sophgo/linux-riscv/commit/0dfcc215b4ce799) at 2024-12-19 17:13:16)
    > [ Upstream commit bb57c81e97e0082abfb0406ed6f67c615c3d206c ]
    > The cifs_io_request struct (a wrapper around netfs_io_request) holds open
    > the file on the server, even beyond the local Linux file being closed.
    > This can cause problems with Windows-based filesystems as the file&#x27;s name
    > still exists after deletion until the file is closed, preventing the parent
    > directory from being removed and causing spurious test failures in xfstests
    > due to inability to remove a directory.  The symptom looks something like
    > this in the test output:
    > rm: cannot remove &#x27;/mnt/scratch/test/p0/d3&#x27;: Directory not empty
    > rm: cannot remove &#x27;/mnt/scratch/test/p1/dc/dae&#x27;: Directory not empty
    > Fix this by waiting in unlink and rename for any outstanding I/O requests
    > to be completed on the target file before removing that file.
    > Note that this doesn&#x27;t prevent Linux from trying to start new requests
    > after deletion if it still has the file open locally - something that&#x27;s
    > perfectly acceptable on a UNIX system.
    > Note also that whilst I&#x27;ve marked this as fixing the commit to make cifs
    > use netfslib, I don&#x27;t know that it won&#x27;t occur before that.
    > Fixes: 3ee1a1fc3981 (&quot;cifs: Cut over to using netfslib&quot;)
    > Signed-off-by: David Howells &lt;dhowells@redhat.com&gt;
    > Acked-by: Paulo Alcantara (Red Hat) &lt;pc@manguebit.com&gt;
    > cc: Jeff Layton &lt;jlayton@kernel.org&gt;
    > cc: linux-cifs@vger.kernel.org
    > cc: netfs@lists.linux.dev
    > cc: linux-fsdevel@vger.kernel.org
    > Signed-off-by: Steve French &lt;stfrench@microsoft.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ASoC: amd: yc: Fix the wrong return value (@Venkata Prasad Potturu in [f5e71ae56cb7e38](https://github.com/sophgo/linux-riscv/commit/f5e71ae56cb7e38) at 2024-12-19 17:13:15)
    > [ Upstream commit 984795e76def5c903724b8d6a8228e356bbdf2af ]
    > With the current implementation, when ACP driver fails to read
    > ACPI _WOV entry then the DMI overrides code won&#x27;t invoke,
    > may cause regressions for some BIOS versions.
    > Add a condition check to jump to check the DMI entries incase of
    > ACP driver fail to read ACPI _WOV method.
    > Fixes: 4095cf872084 (ASoC: amd: yc: Fix for enabling DMIC on acp6x via _DSD entry)
    > Signed-off-by: Venkata Prasad Potturu &lt;venkataprasad.potturu@amd.com&gt;
    > Link: https://patch.msgid.link/20241210091026.996860-1-venkataprasad.potturu@amd.com
    > Signed-off-by: Mark Brown &lt;broonie@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ACPI: resource: Fix memory resource type union access (@Ilpo Järvinen in [889825d9a47542a](https://github.com/sophgo/linux-riscv/commit/889825d9a47542a) at 2024-12-19 17:13:15)
    > [ Upstream commit 7899ca9f3bd2b008e9a7c41f2a9f1986052d7e96 ]
    > In acpi_decode_space() addr-&gt;info.mem.caching is checked on main level
    > for any resource type but addr-&gt;info.mem is part of union and thus
    > valid only if the resource type is memory range.
    > Move the check inside the preceeding switch/case to only execute it
    > when the union is of correct type.
    > Fixes: fcb29bbcd540 (&quot;ACPI: Add prefetch decoding to the address space parser&quot;)
    > Signed-off-by: Ilpo Järvinen &lt;ilpo.jarvinen@linux.intel.com&gt;
    > Link: https://patch.msgid.link/20241202100614.20731-1-ilpo.jarvinen@linux.intel.com
    > Signed-off-by: Rafael J. Wysocki &lt;rafael.j.wysocki@intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ qca_spi: Fix clock speed for multiple QCA7000 (@Stefan Wahren in [6df6cab9b6ebee4](https://github.com/sophgo/linux-riscv/commit/6df6cab9b6ebee4) at 2024-12-19 17:13:15)
    > [ Upstream commit 4dba406fac06b009873fe7a28231b9b7e4288b09 ]
    > Storing the maximum clock speed in module parameter qcaspi_clkspeed
    > has the unintended side effect that the first probed instance
    > defines the value for all other instances. Fix this issue by storing
    > it in max_speed_hz of the relevant SPI device.
    > This fix keeps the priority of the speed parameter (module parameter,
    > device tree property, driver default). Btw this uses the opportunity
    > to get the rid of the unused member clkspeed.
    > Fixes: 291ab06ecf67 (&quot;net: qualcomm: new Ethernet over SPI driver for QCA7000&quot;)
    > Signed-off-by: Stefan Wahren &lt;wahrenst@gmx.net&gt;
    > Link: https://patch.msgid.link/20241206184643.123399-2-wahrenst@gmx.net
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ qca_spi: Make driver probing reliable (@Stefan Wahren in [586241f4160e143](https://github.com/sophgo/linux-riscv/commit/586241f4160e143) at 2024-12-19 17:13:15)
    > [ Upstream commit becc6399ce3b724cffe9ccb7ef0bff440bb1b62b ]
    > The module parameter qcaspi_pluggable controls if QCA7000 signature
    > should be checked at driver probe (current default) or not. Unfortunately
    > this could fail in case the chip is temporary in reset, which isn&#x27;t under
    > total control by the Linux host. So disable this check per default
    > in order to avoid unexpected probe failures.
    > Fixes: 291ab06ecf67 (&quot;net: qualcomm: new Ethernet over SPI driver for QCA7000&quot;)
    > Signed-off-by: Stefan Wahren &lt;wahrenst@gmx.net&gt;
    > Link: https://patch.msgid.link/20241206184643.123399-3-wahrenst@gmx.net
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ cxgb4: use port number to set mac addr (@Anumula Murali Mohan Reddy in [51403c89a789477](https://github.com/sophgo/linux-riscv/commit/51403c89a789477) at 2024-12-19 17:13:15)
    > [ Upstream commit 356983f569c1f5991661fc0050aa263792f50616 ]
    > t4_set_vf_mac_acl() uses pf to set mac addr, but t4vf_get_vf_mac_acl()
    > uses port number to get mac addr, this leads to error when an attempt
    > to set MAC address on VF&#x27;s of PF2 and PF3.
    > This patch fixes the issue by using port number to set mac address.
    > Fixes: e0cdac65ba26 (&quot;cxgb4vf: configure ports accessible by the VF&quot;)
    > Signed-off-by: Anumula Murali Mohan Reddy &lt;anumula@chelsio.com&gt;
    > Signed-off-by: Potnuri Bharat Teja &lt;bharat@chelsio.com&gt;
    > Reviewed-by: Simon Horman &lt;horms@kernel.org&gt;
    > Link: https://patch.msgid.link/20241206062014.49414-1-anumula@chelsio.com
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ALSA: control: Avoid WARN() for symlink errors (@Takashi Iwai in [36c0764474b637b](https://github.com/sophgo/linux-riscv/commit/36c0764474b637b) at 2024-12-19 17:13:15)
    > [ Upstream commit b2e538a9827dd04ab5273bf4be8eb2edb84357b0 ]
    > Using WARN() for showing the error of symlink creations don&#x27;t give
    > more information than telling that something goes wrong, since the
    > usual code path is a lregister callback from each control element
    > creation.  More badly, the use of WARN() rather confuses fuzzer as if
    > it were serious issues.
    > This patch downgrades the warning messages to use the normal dev_err()
    > instead of WARN().  For making it clearer, add the function name to
    > the prefix, too.
    > Fixes: a135dfb5de15 (&quot;ALSA: led control - add sysfs kcontrol LED marking layer&quot;)
    > Reported-by: syzbot+4e7919b09c67ffd198ae@syzkaller.appspotmail.com
    > Closes: https://lore.kernel.org/675664c7.050a0220.a30f1.018c.GAE@google.com
    > Link: https://patch.msgid.link/20241209095614.4273-1-tiwai@suse.de
    > Signed-off-by: Takashi Iwai &lt;tiwai@suse.de&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ Documentation: PM: Clarify pm_runtime_resume_and_get() return value (@Paul Barker in [0749982c51daf04](https://github.com/sophgo/linux-riscv/commit/0749982c51daf04) at 2024-12-19 17:13:15)
    > [ Upstream commit ccb84dc8f4a02e7d30ffd388522996546b4d00e1 ]
    > Update the documentation to match the behaviour of the code.
    > pm_runtime_resume_and_get() always returns 0 on success, even if
    > __pm_runtime_resume() returns 1.
    > Fixes: 2c412337cfe6 (&quot;PM: runtime: Add documentation for pm_runtime_resume_and_get()&quot;)
    > Signed-off-by: Paul Barker &lt;paul.barker.ct@bp.renesas.com&gt;
    > Link: https://patch.msgid.link/20241203143729.478-1-paul.barker.ct@bp.renesas.com
    > [ rjw: Subject and changelog edits, adjusted new comment formatting ]
    > Signed-off-by: Rafael J. Wysocki &lt;rafael.j.wysocki@intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ spi: aspeed: Fix an error handling path in aspeed_spi_[read|write]_user() (@Christophe JAILLET in [771e7fc9f186b52](https://github.com/sophgo/linux-riscv/commit/771e7fc9f186b52) at 2024-12-19 17:13:14)
    > [ Upstream commit c84dda3751e945a67d71cbe3af4474aad24a5794 ]
    > A aspeed_spi_start_user() is not balanced by a corresponding
    > aspeed_spi_stop_user().
    > Add the missing call.
    > Fixes: e3228ed92893 (&quot;spi: spi-mem: Convert Aspeed SMC driver to spi-mem&quot;)
    > Signed-off-by: Christophe JAILLET &lt;christophe.jaillet@wanadoo.fr&gt;
    > Link: https://patch.msgid.link/4052aa2f9a9ea342fa6af83fa991b55ce5d5819e.1732051814.git.christophe.jaillet@wanadoo.fr
    > Signed-off-by: Mark Brown &lt;broonie@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ net: sparx5: fix FDMA performance issue (@Daniel Machon in [730ab6397a18179](https://github.com/sophgo/linux-riscv/commit/730ab6397a18179) at 2024-12-19 17:13:14)
    > [ Upstream commit f004f2e535e2b66ccbf5ac35f8eaadeac70ad7b7 ]
    > The FDMA handler is responsible for scheduling a NAPI poll, which will
    > eventually fetch RX packets from the FDMA queue. Currently, the FDMA
    > handler is run in a threaded context. For some reason, this kills
    > performance.  Admittedly, I did not do a thorough investigation to see
    > exactly what causes the issue, however, I noticed that in the other
    > driver utilizing the same FDMA engine, we run the FDMA handler in hard
    > IRQ context.
    > Fix this performance issue, by  running the FDMA handler in hard IRQ
    > context, not deferring any work to a thread.
    > Prior to this change, the RX UDP performance was:
    > Interval           Transfer     Bitrate         Jitter
    > 0.00-10.20  sec    44.6 MBytes  36.7 Mbits/sec  0.027 ms
    > After this change, the rx UDP performance is:
    > Interval           Transfer     Bitrate         Jitter
    > 0.00-9.12   sec    1.01 GBytes  953 Mbits/sec   0.020 ms
    > Fixes: 10615907e9b5 (&quot;net: sparx5: switchdev: adding frame DMA functionality&quot;)
    > Signed-off-by: Daniel Machon &lt;daniel.machon@microchip.com&gt;
    > Signed-off-by: David S. Miller &lt;davem@davemloft.net&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ net: mscc: ocelot: perform error cleanup in ocelot_hwstamp_set() (@Vladimir Oltean in [6a4c7173a64551f](https://github.com/sophgo/linux-riscv/commit/6a4c7173a64551f) at 2024-12-19 17:13:14)
    > [ Upstream commit 43a4166349a254446e7a3db65f721c6a30daccf3 ]
    > An unsupported RX filter will leave the port with TX timestamping still
    > applied as per the new request, rather than the old setting. When
    > parsing the tx_type, don&#x27;t apply it just yet, but delay that until after
    > we&#x27;ve parsed the rx_filter as well (and potentially returned -ERANGE for
    > that).
    > Similarly, copy_to_user() may fail, which is a rare occurrence, but
    > should still be treated by unwinding what was done.
    > Fixes: 96ca08c05838 (&quot;net: mscc: ocelot: set up traps for PTP packets&quot;)
    > Signed-off-by: Vladimir Oltean &lt;vladimir.oltean@nxp.com&gt;
    > Link: https://patch.msgid.link/20241205145519.1236778-6-vladimir.oltean@nxp.com
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ net: sparx5: fix the maximum frame length register (@Daniel Machon in [53654cd4c896ebd](https://github.com/sophgo/linux-riscv/commit/53654cd4c896ebd) at 2024-12-19 17:13:14)
    > [ Upstream commit ddd7ba006078a2bef5971b2dc5f8383d47f96207 ]
    > On port initialization, we configure the maximum frame length accepted
    > by the receive module associated with the port. This value is currently
    > written to the MAX_LEN field of the DEV10G_MAC_ENA_CFG register, when in
    > fact, it should be written to the DEV10G_MAC_MAXLEN_CFG register. Fix
    > this.
    > Fixes: 946e7fd5053a (&quot;net: sparx5: add port module support&quot;)
    > Signed-off-by: Daniel Machon &lt;daniel.machon@microchip.com&gt;
    > Signed-off-by: David S. Miller &lt;davem@davemloft.net&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ net: mscc: ocelot: be resilient to loss of PTP packets during transmission (@Vladimir Oltean in [266ac61e59119a9](https://github.com/sophgo/linux-riscv/commit/266ac61e59119a9) at 2024-12-19 17:13:14)
    > [ Upstream commit b454abfab52543c44b581afc807b9f97fc1e7a3a ]
    > The Felix DSA driver presents unique challenges that make the simplistic
    > ocelot PTP TX timestamping procedure unreliable: any transmitted packet
    > may be lost in hardware before it ever leaves our local system.
    > This may happen because there is congestion on the DSA conduit, the
    > switch CPU port or even user port (Qdiscs like taprio may delay packets
    > indefinitely by design).
    > The technical problem is that the kernel, i.e. ocelot_port_add_txtstamp_skb(),
    > runs out of timestamp IDs eventually, because it never detects that
    > packets are lost, and keeps the IDs of the lost packets on hold
    > indefinitely. The manifestation of the issue once the entire timestamp
    > ID range becomes busy looks like this in dmesg:
    > mscc_felix 0000:00:00.5: port 0 delivering skb without TX timestamp
    > mscc_felix 0000:00:00.5: port 1 delivering skb without TX timestamp
    > At the surface level, we need a timeout timer so that the kernel knows a
    > timestamp ID is available again. But there is a deeper problem with the
    > implementation, which is the monotonically increasing ocelot_port-&gt;ts_id.
    > In the presence of packet loss, it will be impossible to detect that and
    > reuse one of the holes created in the range of free timestamp IDs.
    > What we actually need is a bitmap of 63 timestamp IDs tracking which one
    > is available. That is able to use up holes caused by packet loss, but
    > also gives us a unique opportunity to not implement an actual timer_list
    > for the timeout timer (very complicated in terms of locking).
    > We could only declare a timestamp ID stale on demand (lazily), aka when
    > there&#x27;s no other timestamp ID available. There are pros and cons to this
    > approach: the implementation is much more simple than per-packet timers
    > would be, but most of the stale packets would be quasi-leaked - not
    > really leaked, but blocked in driver memory, since this algorithm sees
    > no reason to free them.
    > An improved technique would be to check for stale timestamp IDs every
    > time we allocate a new one. Assuming a constant flux of PTP packets,
    > this avoids stale packets being blocked in memory, but of course,
    > packets lost at the end of the flux are still blocked until the flux
    > resumes (nobody left to kick them out).
    > Since implementing per-packet timers is way too complicated, this should
    > be good enough.
    > Testing procedure:
    > Persistently block traffic class 5 and try to run PTP on it:
    > $ tc qdisc replace dev swp3 parent root taprio num_tc 8 \
    > map 0 1 2 3 4 5 6 7 queues 1@0 1@1 1@2 1@3 1@4 1@5 1@6 1@7 \
    > base-time 0 sched-entry S 0xdf 100000 flags 0x2
    > [  126.948141] mscc_felix 0000:00:00.5: port 3 tc 5 min gate length 0 ns not enough for max frame size 1526 at 1000 Mbps, dropping frames over 1 octets including FCS
    > $ ptp4l -i swp3 -2 -P -m --socket_priority 5 --fault_reset_interval ASAP --logSyncInterval -3
    > ptp4l[70.351]: port 1 (swp3): INITIALIZING to LISTENING on INIT_COMPLETE
    > ptp4l[70.354]: port 0 (/var/run/ptp4l): INITIALIZING to LISTENING on INIT_COMPLETE
    > ptp4l[70.358]: port 0 (/var/run/ptp4lro): INITIALIZING to LISTENING on INIT_COMPLETE
    > [   70.394583] mscc_felix 0000:00:00.5: port 3 timestamp id 0
    > ptp4l[70.406]: timed out while polling for tx timestamp
    > ptp4l[70.406]: increasing tx_timestamp_timeout or increasing kworker priority may correct this issue, but a driver bug likely causes it
    > ptp4l[70.406]: port 1 (swp3): send peer delay response failed
    > ptp4l[70.407]: port 1 (swp3): clearing fault immediately
    > ptp4l[70.952]: port 1 (swp3): new foreign master d858d7.fffe.00ca6d-1
    > [   71.394858] mscc_felix 0000:00:00.5: port 3 timestamp id 1
    > ptp4l[71.400]: timed out while polling for tx timestamp
    > ptp4l[71.400]: increasing tx_timestamp_timeout or increasing kworker priority may correct this issue, but a driver bug likely causes it
    > ptp4l[71.401]: port 1 (swp3): send peer delay response failed
    > ptp4l[71.401]: port 1 (swp3): clearing fault immediately
    > [   72.393616] mscc_felix 0000:00:00.5: port 3 timestamp id 2
    > ptp4l[72.401]: timed out while polling for tx timestamp
    > ptp4l[72.402]: increasing tx_timestamp_timeout or increasing kworker priority may correct this issue, but a driver bug likely causes it
    > ptp4l[72.402]: port 1 (swp3): send peer delay response failed
    > ptp4l[72.402]: port 1 (swp3): clearing fault immediately
    > ptp4l[72.952]: port 1 (swp3): new foreign master d858d7.fffe.00ca6d-1
    > [   73.395291] mscc_felix 0000:00:00.5: port 3 timestamp id 3
    > ptp4l[73.400]: timed out while polling for tx timestamp
    > ptp4l[73.400]: increasing tx_timestamp_timeout or increasing kworker priority may correct this issue, but a driver bug likely causes it
    > ptp4l[73.400]: port 1 (swp3): send peer delay response failed
    > ptp4l[73.400]: port 1 (swp3): clearing fault immediately
    > [   74.394282] mscc_felix 0000:00:00.5: port 3 timestamp id 4
    > ptp4l[74.400]: timed out while polling for tx timestamp
    > ptp4l[74.401]: increasing tx_timestamp_timeout or increasing kworker priority may correct this issue, but a driver bug likely causes it
    > ptp4l[74.401]: port 1 (swp3): send peer delay response failed
    > ptp4l[74.401]: port 1 (swp3): clearing fault immediately
    > ptp4l[74.953]: port 1 (swp3): new foreign master d858d7.fffe.00ca6d-1
    > [   75.396830] mscc_felix 0000:00:00.5: port 3 invalidating stale timestamp ID 0 which seems lost
    > [   75.405760] mscc_felix 0000:00:00.5: port 3 timestamp id 0
    > ptp4l[75.410]: timed out while polling for tx timestamp
    > ptp4l[75.411]: increasing tx_timestamp_timeout or increasing kworker priority may correct this issue, but a driver bug likely causes it
    > ptp4l[75.411]: port 1 (swp3): send peer delay response failed
    > ptp4l[75.411]: port 1 (swp3): clearing fault immediately
    > (...)
    > Remove the blocking condition and see that the port recovers:
    > $ same tc command as above, but use &quot;sched-entry S 0xff&quot; instead
    > $ same ptp4l command as above
    > ptp4l[99.489]: port 1 (swp3): INITIALIZING to LISTENING on INIT_COMPLETE
    > ptp4l[99.490]: port 0 (/var/run/ptp4l): INITIALIZING to LISTENING on INIT_COMPLETE
    > ptp4l[99.492]: port 0 (/var/run/ptp4lro): INITIALIZING to LISTENING on INIT_COMPLETE
    > [  100.403768] mscc_felix 0000:00:00.5: port 3 invalidating stale timestamp ID 0 which seems lost
    > [  100.412545] mscc_felix 0000:00:00.5: port 3 invalidating stale timestamp ID 1 which seems lost
    > [  100.421283] mscc_felix 0000:00:00.5: port 3 invalidating stale timestamp ID 2 which seems lost
    > [  100.430015] mscc_felix 0000:00:00.5: port 3 invalidating stale timestamp ID 3 which seems lost
    > [  100.438744] mscc_felix 0000:00:00.5: port 3 invalidating stale timestamp ID 4 which seems lost
    > [  100.447470] mscc_felix 0000:00:00.5: port 3 timestamp id 0
    > [  100.505919] mscc_felix 0000:00:00.5: port 3 timestamp id 0
    > ptp4l[100.963]: port 1 (swp3): new foreign master d858d7.fffe.00ca6d-1
    > [  101.405077] mscc_felix 0000:00:00.5: port 3 timestamp id 0
    > [  101.507953] mscc_felix 0000:00:00.5: port 3 timestamp id 0
    > [  102.405405] mscc_felix 0000:00:00.5: port 3 timestamp id 0
    > [  102.509391] mscc_felix 0000:00:00.5: port 3 timestamp id 0
    > [  103.406003] mscc_felix 0000:00:00.5: port 3 timestamp id 0
    > [  103.510011] mscc_felix 0000:00:00.5: port 3 timestamp id 0
    > [  104.405601] mscc_felix 0000:00:00.5: port 3 timestamp id 0
    > [  104.510624] mscc_felix 0000:00:00.5: port 3 timestamp id 0
    > ptp4l[104.965]: selected best master clock d858d7.fffe.00ca6d
    > ptp4l[104.966]: port 1 (swp3): assuming the grand master role
    > ptp4l[104.967]: port 1 (swp3): LISTENING to GRAND_MASTER on RS_GRAND_MASTER
    > [  105.106201] mscc_felix 0000:00:00.5: port 3 timestamp id 0
    > [  105.232420] mscc_felix 0000:00:00.5: port 3 timestamp id 0
    > [  105.359001] mscc_felix 0000:00:00.5: port 3 timestamp id 0
    > [  105.405500] mscc_felix 0000:00:00.5: port 3 timestamp id 0
    > [  105.485356] mscc_felix 0000:00:00.5: port 3 timestamp id 0
    > [  105.511220] mscc_felix 0000:00:00.5: port 3 timestamp id 0
    > [  105.610938] mscc_felix 0000:00:00.5: port 3 timestamp id 0
    > [  105.737237] mscc_felix 0000:00:00.5: port 3 timestamp id 0
    > (...)
    > Notice that in this new usage pattern, a non-congested port should
    > basically use timestamp ID 0 all the time, progressing to higher numbers
    > only if there are unacknowledged timestamps in flight. Compare this to
    > the old usage, where the timestamp ID used to monotonically increase
    > modulo OCELOT_MAX_PTP_ID.
    > In terms of implementation, this simplifies the bookkeeping of the
    > ocelot_port :: ts_id and ptp_skbs_in_flight. Since we need to traverse
    > the list of two-step timestampable skbs for each new packet anyway, the
    > information can already be computed and does not need to be stored.
    > Also, ocelot_port-&gt;tx_skbs is always accessed under the switch-wide
    > ocelot-&gt;ts_id_lock IRQ-unsafe spinlock, so we don&#x27;t need the skb queue&#x27;s
    > lock and can use the unlocked primitives safely.
    > This problem was actually detected using the tc-taprio offload, and is
    > causing trouble in TSN scenarios, which Felix (NXP LS1028A / VSC9959)
    > supports but Ocelot (VSC7514) does not. Thus, I&#x27;ve selected the commit
    > to blame as the one adding initial timestamping support for the Felix
    > switch.
    > Fixes: c0bcf537667c (&quot;net: dsa: ocelot: add hardware timestamping support for Felix&quot;)
    > Signed-off-by: Vladimir Oltean &lt;vladimir.oltean@nxp.com&gt;
    > Link: https://patch.msgid.link/20241205145519.1236778-5-vladimir.oltean@nxp.com
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ regulator: axp20x: AXP717: set ramp_delay (@Philippe Simons in [10eb845a87193ef](https://github.com/sophgo/linux-riscv/commit/10eb845a87193ef) at 2024-12-19 17:13:14)
    > [ Upstream commit f07ae52f5cf6a5584fdf7c8c652f027d90bc8b74 ]
    > AXP717 datasheet says that regulator ramp delay is 15.625 us/step,
    > which is 10mV in our case.
    > Add a AXP_DESC_RANGES_DELAY macro and update AXP_DESC_RANGES macro to
    > expand to AXP_DESC_RANGES_DELAY with ramp_delay &#x3D; 0
    > For DCDC4, steps is 100mv
    > Add a AXP_DESC_DELAY macro and update AXP_DESC macro to
    > expand to AXP_DESC_DELAY with ramp_delay &#x3D; 0
    > This patch fix crashes when using CPU DVFS.
    > Signed-off-by: Philippe Simons &lt;simons.philippe@gmail.com&gt;
    > Tested-by: Hironori KIKUCHI &lt;kikuchan98@gmail.com&gt;
    > Tested-by: Chris Morgan &lt;macromorgan@hotmail.com&gt;
    > Reviewed-by: Chen-Yu Tsai &lt;wens@csie.org&gt;
    > Fixes: d2ac3df75c3a (&quot;regulator: axp20x: add support for the AXP717&quot;)
    > Link: https://patch.msgid.link/20241208124308.5630-1-simons.philippe@gmail.com
    > Signed-off-by: Mark Brown &lt;broonie@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ net: mscc: ocelot: fix memory leak on ocelot_port_add_txtstamp_skb() (@Vladimir Oltean in [b12cdb8f2e9c72f](https://github.com/sophgo/linux-riscv/commit/b12cdb8f2e9c72f) at 2024-12-19 17:13:13)
    > [ Upstream commit 4b01bec25bef62544228bce06db6a3afa5d3d6bb ]
    > If ocelot_port_add_txtstamp_skb() fails, for example due to a full PTP
    > timestamp FIFO, we must undo the skb_clone_sk() call with kfree_skb().
    > Otherwise, the reference to the skb clone is lost.
    > Fixes: 52849bcf0029 (&quot;net: mscc: ocelot: avoid overflowing the PTP timestamp FIFO&quot;)
    > Signed-off-by: Vladimir Oltean &lt;vladimir.oltean@nxp.com&gt;
    > Link: https://patch.msgid.link/20241205145519.1236778-2-vladimir.oltean@nxp.com
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ptp: kvm: x86: Return EOPNOTSUPP instead of ENODEV from kvm_arch_ptp_init() (@Thomas Weißschuh in [aca99e1fa9d7f14](https://github.com/sophgo/linux-riscv/commit/aca99e1fa9d7f14) at 2024-12-19 17:13:13)
    > [ Upstream commit 5e7aa97c7acf171275ac02a8bb018c31b8918d13 ]
    > The caller, ptp_kvm_init(), emits a warning if kvm_arch_ptp_init() exits
    > with any error which is not EOPNOTSUPP:
    > &quot;fail to initialize ptp_kvm&quot;
    > Replace ENODEV with EOPNOTSUPP to avoid this spurious warning,
    > aligning with the ARM implementation.
    > Fixes: a86ed2cfa13c (&quot;ptp: Don&#x27;t print an error if ptp_kvm is not supported&quot;)
    > Signed-off-by: Thomas Weißschuh &lt;linux@weissschuh.net&gt;
    > Link: https://patch.msgid.link/20241203-kvm_ptp-eopnotsuppp-v2-1-d1d060f27aa6@weissschuh.net
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ net: defer final &#x27;struct net&#x27; free in netns dismantle (@Eric Dumazet in [6610c7f8a8d47fd](https://github.com/sophgo/linux-riscv/commit/6610c7f8a8d47fd) at 2024-12-19 17:13:13)
    > [ Upstream commit 0f6ede9fbc747e2553612271bce108f7517e7a45 ]
    > Ilya reported a slab-use-after-free in dst_destroy [1]
    > Issue is in xfrm6_net_init() and xfrm4_net_init() :
    > They copy xfrm[46]_dst_ops_template into net-&gt;xfrm.xfrm[46]_dst_ops.
    > But net structure might be freed before all the dst callbacks are
    > called. So when dst_destroy() calls later :
    > if (dst-&gt;ops-&gt;destroy)
    > dst-&gt;ops-&gt;destroy(dst);
    > dst-&gt;ops points to the old net-&gt;xfrm.xfrm[46]_dst_ops, which has been freed.
    > See a relevant issue fixed in :
    > ac888d58869b (&quot;net: do not delay dst_entries_add() in dst_release()&quot;)
    > A fix is to queue the &#x27;struct net&#x27; to be freed after one
    > another cleanup_net() round (and existing rcu_barrier())
    > [1]
    > BUG: KASAN: slab-use-after-free in dst_destroy (net/core/dst.c:112)
    > Read of size 8 at addr ffff8882137ccab0 by task swapper/37/0
    > Dec 03 05:46:18 kernel:
    > CPU: 37 UID: 0 PID: 0 Comm: swapper/37 Kdump: loaded Not tainted 6.12.0 #67
    > Hardware name: Red Hat KVM/RHEL, BIOS 1.16.1-1.el9 04/01/2014
    > Call Trace:
    > &lt;IRQ&gt;
    > dump_stack_lvl (lib/dump_stack.c:124)
    > print_address_description.constprop.0 (mm/kasan/report.c:378)
    > ? dst_destroy (net/core/dst.c:112)
    > print_report (mm/kasan/report.c:489)
    > ? dst_destroy (net/core/dst.c:112)
    > ? kasan_addr_to_slab (mm/kasan/common.c:37)
    > kasan_report (mm/kasan/report.c:603)
    > ? dst_destroy (net/core/dst.c:112)
    > ? rcu_do_batch (kernel/rcu/tree.c:2567)
    > dst_destroy (net/core/dst.c:112)
    > rcu_do_batch (kernel/rcu/tree.c:2567)
    > ? __pfx_rcu_do_batch (kernel/rcu/tree.c:2491)
    > ? lockdep_hardirqs_on_prepare (kernel/locking/lockdep.c:4339 kernel/locking/lockdep.c:4406)
    > rcu_core (kernel/rcu/tree.c:2825)
    > handle_softirqs (kernel/softirq.c:554)
    > __irq_exit_rcu (kernel/softirq.c:589 kernel/softirq.c:428 kernel/softirq.c:637)
    > irq_exit_rcu (kernel/softirq.c:651)
    > sysvec_apic_timer_interrupt (arch/x86/kernel/apic/apic.c:1049 arch/x86/kernel/apic/apic.c:1049)
    > &lt;/IRQ&gt;
    > &lt;TASK&gt;
    > asm_sysvec_apic_timer_interrupt (./arch/x86/include/asm/idtentry.h:702)
    > RIP: 0010:default_idle (./arch/x86/include/asm/irqflags.h:37 ./arch/x86/include/asm/irqflags.h:92 arch/x86/kernel/process.c:743)
    > Code: 00 4d 29 c8 4c 01 c7 4c 29 c2 e9 6e ff ff ff 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 66 90 0f 00 2d c7 c9 27 00 fb f4 &lt;fa&gt; c3 cc cc cc cc 66 66 2e 0f 1f 84 00 00 00 00 00 0f 1f 40 00 90
    > RSP: 0018:ffff888100d2fe00 EFLAGS: 00000246
    > RAX: 00000000001870ed RBX: 1ffff110201a5fc2 RCX: ffffffffb61a3e46
    > RDX: 0000000000000000 RSI: 0000000000000000 RDI: ffffffffb3d4d123
    > RBP: 0000000000000000 R08: 0000000000000001 R09: ffffed11c7e1835d
    > R10: ffff888e3f0c1aeb R11: 0000000000000000 R12: 0000000000000000
    > R13: ffff888100d20000 R14: dffffc0000000000 R15: 0000000000000000
    > ? ct_kernel_exit.constprop.0 (kernel/context_tracking.c:148)
    > ? cpuidle_idle_call (kernel/sched/idle.c:186)
    > default_idle_call (./include/linux/cpuidle.h:143 kernel/sched/idle.c:118)
    > cpuidle_idle_call (kernel/sched/idle.c:186)
    > ? __pfx_cpuidle_idle_call (kernel/sched/idle.c:168)
    > ? lock_release (kernel/locking/lockdep.c:467 kernel/locking/lockdep.c:5848)
    > ? lockdep_hardirqs_on_prepare (kernel/locking/lockdep.c:4347 kernel/locking/lockdep.c:4406)
    > ? tsc_verify_tsc_adjust (arch/x86/kernel/tsc_sync.c:59)
    > do_idle (kernel/sched/idle.c:326)
    > cpu_startup_entry (kernel/sched/idle.c:423 (discriminator 1))
    > start_secondary (arch/x86/kernel/smpboot.c:202 arch/x86/kernel/smpboot.c:282)
    > ? __pfx_start_secondary (arch/x86/kernel/smpboot.c:232)
    > ? soft_restart_cpu (arch/x86/kernel/head_64.S:452)
    > common_startup_64 (arch/x86/kernel/head_64.S:414)
    > &lt;/TASK&gt;
    > Dec 03 05:46:18 kernel:
    > Allocated by task 12184:
    > kasan_save_stack (mm/kasan/common.c:48)
    > kasan_save_track (./arch/x86/include/asm/current.h:49 mm/kasan/common.c:60 mm/kasan/common.c:69)
    > __kasan_slab_alloc (mm/kasan/common.c:319 mm/kasan/common.c:345)
    > kmem_cache_alloc_noprof (mm/slub.c:4085 mm/slub.c:4134 mm/slub.c:4141)
    > copy_net_ns (net/core/net_namespace.c:421 net/core/net_namespace.c:480)
    > create_new_namespaces (kernel/nsproxy.c:110)
    > unshare_nsproxy_namespaces (kernel/nsproxy.c:228 (discriminator 4))
    > ksys_unshare (kernel/fork.c:3313)
    > __x64_sys_unshare (kernel/fork.c:3382)
    > do_syscall_64 (arch/x86/entry/common.c:52 arch/x86/entry/common.c:83)
    > entry_SYSCALL_64_after_hwframe (arch/x86/entry/entry_64.S:130)
    > Dec 03 05:46:18 kernel:
    > Freed by task 11:
    > kasan_save_stack (mm/kasan/common.c:48)
    > kasan_save_track (./arch/x86/include/asm/current.h:49 mm/kasan/common.c:60 mm/kasan/common.c:69)
    > kasan_save_free_info (mm/kasan/generic.c:582)
    > __kasan_slab_free (mm/kasan/common.c:271)
    > kmem_cache_free (mm/slub.c:4579 mm/slub.c:4681)
    > cleanup_net (net/core/net_namespace.c:456 net/core/net_namespace.c:446 net/core/net_namespace.c:647)
    > process_one_work (kernel/workqueue.c:3229)
    > worker_thread (kernel/workqueue.c:3304 kernel/workqueue.c:3391)
    > kthread (kernel/kthread.c:389)
    > ret_from_fork (arch/x86/kernel/process.c:147)
    > ret_from_fork_asm (arch/x86/entry/entry_64.S:257)
    > Dec 03 05:46:18 kernel:
    > Last potentially related work creation:
    > kasan_save_stack (mm/kasan/common.c:48)
    > __kasan_record_aux_stack (mm/kasan/generic.c:541)
    > insert_work (./include/linux/instrumented.h:68 ./include/asm-generic/bitops/instrumented-non-atomic.h:141 kernel/workqueue.c:788 kernel/workqueue.c:795 kernel/workqueue.c:2186)
    > __queue_work (kernel/workqueue.c:2340)
    > queue_work_on (kernel/workqueue.c:2391)
    > xfrm_policy_insert (net/xfrm/xfrm_policy.c:1610)
    > xfrm_add_policy (net/xfrm/xfrm_user.c:2116)
    > xfrm_user_rcv_msg (net/xfrm/xfrm_user.c:3321)
    > netlink_rcv_skb (net/netlink/af_netlink.c:2536)
    > xfrm_netlink_rcv (net/xfrm/xfrm_user.c:3344)
    > netlink_unicast (net/netlink/af_netlink.c:1316 net/netlink/af_netlink.c:1342)
    > netlink_sendmsg (net/netlink/af_netlink.c:1886)
    > sock_write_iter (net/socket.c:729 net/socket.c:744 net/socket.c:1165)
    > vfs_write (fs/read_write.c:590 fs/read_write.c:683)
    > ksys_write (fs/read_write.c:736)
    > do_syscall_64 (arch/x86/entry/common.c:52 arch/x86/entry/common.c:83)
    > entry_SYSCALL_64_after_hwframe (arch/x86/entry/entry_64.S:130)
    > Dec 03 05:46:18 kernel:
    > Second to last potentially related work creation:
    > kasan_save_stack (mm/kasan/common.c:48)
    > __kasan_record_aux_stack (mm/kasan/generic.c:541)
    > insert_work (./include/linux/instrumented.h:68 ./include/asm-generic/bitops/instrumented-non-atomic.h:141 kernel/workqueue.c:788 kernel/workqueue.c:795 kernel/workqueue.c:2186)
    > __queue_work (kernel/workqueue.c:2340)
    > queue_work_on (kernel/workqueue.c:2391)
    > __xfrm_state_insert (./include/linux/workqueue.h:723 net/xfrm/xfrm_state.c:1150 net/xfrm/xfrm_state.c:1145 net/xfrm/xfrm_state.c:1513)
    > xfrm_state_update (./include/linux/spinlock.h:396 net/xfrm/xfrm_state.c:1940)
    > xfrm_add_sa (net/xfrm/xfrm_user.c:912)
    > xfrm_user_rcv_msg (net/xfrm/xfrm_user.c:3321)
    > netlink_rcv_skb (net/netlink/af_netlink.c:2536)
    > xfrm_netlink_rcv (net/xfrm/xfrm_user.c:3344)
    > netlink_unicast (net/netlink/af_netlink.c:1316 net/netlink/af_netlink.c:1342)
    > netlink_sendmsg (net/netlink/af_netlink.c:1886)
    > sock_write_iter (net/socket.c:729 net/socket.c:744 net/socket.c:1165)
    > vfs_write (fs/read_write.c:590 fs/read_write.c:683)
    > ksys_write (fs/read_write.c:736)
    > do_syscall_64 (arch/x86/entry/common.c:52 arch/x86/entry/common.c:83)
    > entry_SYSCALL_64_after_hwframe (arch/x86/entry/entry_64.S:130)
    > Fixes: a8a572a6b5f2 (&quot;xfrm: dst_entries_init() per-net dst_ops&quot;)
    > Reported-by: Ilya Maximets &lt;i.maximets@ovn.org&gt;
    > Closes: https://lore.kernel.org/netdev/CANn89iKKYDVpB&#x3D;MtmfH7nyv2p&#x3D;rJWSLedO5k7wSZgtY_tO8WQg@mail.gmail.com/T/#m02c98c3009fe66382b73cfb4db9cf1df6fab3fbf
    > Signed-off-by: Eric Dumazet &lt;edumazet@google.com&gt;
    > Acked-by: Paolo Abeni &lt;pabeni@redhat.com&gt;
    > Reviewed-by: Kuniyuki Iwashima &lt;kuniyu@amazon.com&gt;
    > Link: https://patch.msgid.link/20241204125455.3871859-1-edumazet@google.com
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ bnxt_en: Fix GSO type for HW GRO packets on 5750X chips (@Michael Chan in [35fe39bc39af72b](https://github.com/sophgo/linux-riscv/commit/35fe39bc39af72b) at 2024-12-19 17:13:13)
    > [ Upstream commit de37faf41ac55619dd329229a9bd9698faeabc52 ]
    > The existing code is using RSS profile to determine IPV4/IPV6 GSO type
    > on all chips older than 5760X.  This won&#x27;t work on 5750X chips that may
    > be using modified RSS profiles.  This commit from 2018 has updated the
    > driver to not use RSS profile for HW GRO packets on newer chips:
    > 50f011b63d8c (&quot;bnxt_en: Update RSS setup and GRO-HW logic according to the latest spec.&quot;)
    > However, a recent commit to add support for the newest 5760X chip broke
    > the logic.  If the GRO packet needs to be re-segmented by the stack, the
    > wrong GSO type will cause the packet to be dropped.
    > Fix it to only use RSS profile to determine GSO type on the oldest
    > 5730X/5740X chips which cannot use the new method and is safe to use the
    > RSS profiles.
    > Also fix the L3/L4 hash type for RX packets by not using the RSS
    > profile for the same reason.  Use the ITYPE field in the RX completion
    > to determine L3/L4 hash types correctly.
    > Fixes: a7445d69809f (&quot;bnxt_en: Add support for new RX and TPA_START completion types for P7&quot;)
    > Reviewed-by: Colin Winegarden &lt;colin.winegarden@broadcom.com&gt;
    > Reviewed-by: Somnath Kotur &lt;somnath.kotur@broadcom.com&gt;
    > Reviewed-by: Kalesh AP &lt;kalesh-anakkur.purayil@broadcom.com&gt;
    > Signed-off-by: Michael Chan &lt;michael.chan@broadcom.com&gt;
    > Link: https://patch.msgid.link/20241204215918.1692597-2-michael.chan@broadcom.com
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ net: lapb: increase LAPB_HEADER_LEN (@Eric Dumazet in [2b351355bbd50ae](https://github.com/sophgo/linux-riscv/commit/2b351355bbd50ae) at 2024-12-19 17:13:13)
    > [ Upstream commit a6d75ecee2bf828ac6a1b52724aba0a977e4eaf4 ]
    > It is unclear if net/lapb code is supposed to be ready for 8021q.
    > We can at least avoid crashes like the following :
    > skbuff: skb_under_panic: text:ffffffff8aabe1f6 len:24 put:20 head:ffff88802824a400 data:ffff88802824a3fe tail:0x16 end:0x140 dev:nr0.2
    > ------------[ cut here ]------------
    > kernel BUG at net/core/skbuff.c:206 !
    > Oops: invalid opcode: 0000 [#1] PREEMPT SMP KASAN PTI
    > CPU: 1 UID: 0 PID: 5508 Comm: dhcpcd Not tainted 6.12.0-rc7-syzkaller-00144-g66418447d27b #0
    > Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 10/30/2024
    > RIP: 0010:skb_panic net/core/skbuff.c:206 [inline]
    > RIP: 0010:skb_under_panic+0x14b/0x150 net/core/skbuff.c:216
    > Code: 0d 8d 48 c7 c6 2e 9e 29 8e 48 8b 54 24 08 8b 0c 24 44 8b 44 24 04 4d 89 e9 50 41 54 41 57 41 56 e8 1a 6f 37 02 48 83 c4 20 90 &lt;0f&gt; 0b 0f 1f 00 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 f3
    > RSP: 0018:ffffc90002ddf638 EFLAGS: 00010282
    > RAX: 0000000000000086 RBX: dffffc0000000000 RCX: 7a24750e538ff600
    > RDX: 0000000000000000 RSI: 0000000000000201 RDI: 0000000000000000
    > RBP: ffff888034a86650 R08: ffffffff8174b13c R09: 1ffff920005bbe60
    > R10: dffffc0000000000 R11: fffff520005bbe61 R12: 0000000000000140
    > R13: ffff88802824a400 R14: ffff88802824a3fe R15: 0000000000000016
    > FS:  00007f2a5990d740(0000) GS:ffff8880b8700000(0000) knlGS:0000000000000000
    > CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
    > CR2: 000000110c2631fd CR3: 0000000029504000 CR4: 00000000003526f0
    > DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
    > DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
    > Call Trace:
    > &lt;TASK&gt;
    > skb_push+0xe5/0x100 net/core/skbuff.c:2636
    > nr_header+0x36/0x320 net/netrom/nr_dev.c:69
    > dev_hard_header include/linux/netdevice.h:3148 [inline]
    > vlan_dev_hard_header+0x359/0x480 net/8021q/vlan_dev.c:83
    > dev_hard_header include/linux/netdevice.h:3148 [inline]
    > lapbeth_data_transmit+0x1f6/0x2a0 drivers/net/wan/lapbether.c:257
    > lapb_data_transmit+0x91/0xb0 net/lapb/lapb_iface.c:447
    > lapb_transmit_buffer+0x168/0x1f0 net/lapb/lapb_out.c:149
    > lapb_establish_data_link+0x84/0xd0
    > lapb_device_event+0x4e0/0x670
    > notifier_call_chain+0x19f/0x3e0 kernel/notifier.c:93
    > __dev_notify_flags+0x207/0x400
    > dev_change_flags+0xf0/0x1a0 net/core/dev.c:8922
    > devinet_ioctl+0xa4e/0x1aa0 net/ipv4/devinet.c:1188
    > inet_ioctl+0x3d7/0x4f0 net/ipv4/af_inet.c:1003
    > sock_do_ioctl+0x158/0x460 net/socket.c:1227
    > sock_ioctl+0x626/0x8e0 net/socket.c:1346
    > vfs_ioctl fs/ioctl.c:51 [inline]
    > __do_sys_ioctl fs/ioctl.c:907 [inline]
    > __se_sys_ioctl+0xf9/0x170 fs/ioctl.c:893
    > do_syscall_x64 arch/x86/entry/common.c:52 [inline]
    > do_syscall_64+0xf3/0x230 arch/x86/entry/common.c:83
    > Fixes: 1da177e4c3f4 (&quot;Linux-2.6.12-rc2&quot;)
    > Reported-by: syzbot+fb99d1b0c0f81d94a5e2@syzkaller.appspotmail.com
    > Closes: https://lore.kernel.org/netdev/67506220.050a0220.17bd51.006c.GAE@google.com/T/#u
    > Signed-off-by: Eric Dumazet &lt;edumazet@google.com&gt;
    > Reviewed-by: Simon Horman &lt;horms@kernel.org&gt;
    > Link: https://patch.msgid.link/20241204141031.4030267-1-edumazet@google.com
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ net: mscc: ocelot: ocelot-&gt;ts_id_lock and ocelot_port-&gt;tx_skbs.lock are IRQ-safe (@Vladimir Oltean in [2a80ea8b2541ebb](https://github.com/sophgo/linux-riscv/commit/2a80ea8b2541ebb) at 2024-12-19 17:13:13)
    > [ Upstream commit 0c53cdb95eb4a604062e326636971d96dd9b1b26 ]
    > ocelot_get_txtstamp() is a threaded IRQ handler, requested explicitly as
    > such by both ocelot_ptp_rdy_irq_handler() and vsc9959_irq_handler().
    > As such, it runs with IRQs enabled, and not in hardirq context. Thus,
    > ocelot_port_add_txtstamp_skb() has no reason to turn off IRQs, it cannot
    > be preempted by ocelot_get_txtstamp(). For the same reason,
    > dev_kfree_skb_any_reason() will always evaluate as kfree_skb_reason() in
    > this calling context, so just simplify the dev_kfree_skb_any() call to
    > kfree_skb().
    > Also, ocelot_port_txtstamp_request() runs from NET_TX softirq context,
    > not with hardirqs enabled. Thus, ocelot_get_txtstamp() which shares the
    > ocelot_port-&gt;tx_skbs.lock lock with it, has no reason to disable hardirqs.
    > This is part of a larger rework of the TX timestamping procedure.
    > A logical subportion of the rework has been split into a separate
    > change.
    > Signed-off-by: Vladimir Oltean &lt;vladimir.oltean@nxp.com&gt;
    > Link: https://patch.msgid.link/20241205145519.1236778-4-vladimir.oltean@nxp.com
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Stable-dep-of: b454abfab525 (&quot;net: mscc: ocelot: be resilient to loss of PTP packets during transmission&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ net: mscc: ocelot: improve handling of TX timestamp for unknown skb (@Vladimir Oltean in [123515f97cab450](https://github.com/sophgo/linux-riscv/commit/123515f97cab450) at 2024-12-19 17:13:13)
    > [ Upstream commit b6fba4b3f0becb794e274430f3a0839d8ba31262 ]
    > This condition, theoretically impossible to trigger, is not really
    > handled well. By &quot;continuing&quot;, we are skipping the write to SYS_PTP_NXT
    > which advances the timestamp FIFO to the next entry. So we are reading
    > the same FIFO entry all over again, printing stack traces and eventually
    > killing the kernel.
    > No real problem has been observed here. This is part of a larger rework
    > of the timestamp IRQ procedure, with this logical change split out into
    > a patch of its own. We will need to &quot;goto next_ts&quot; for other conditions
    > as well.
    > Fixes: 9fde506e0c53 (&quot;net: mscc: ocelot: warn when a PTP IRQ is raised for an unknown skb&quot;)
    > Signed-off-by: Vladimir Oltean &lt;vladimir.oltean@nxp.com&gt;
    > Link: https://patch.msgid.link/20241205145519.1236778-3-vladimir.oltean@nxp.com
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ wifi: cfg80211: sme: init n_channels before channels[] access (@Haoyu Li in [c2f296183c61207](https://github.com/sophgo/linux-riscv/commit/c2f296183c61207) at 2024-12-19 17:13:12)
    > [ Upstream commit f1d3334d604cc32db63f6e2b3283011e02294e54 ]
    > With the __counted_by annocation in cfg80211_scan_request struct,
    > the &quot;n_channels&quot; struct member must be set before accessing the
    > &quot;channels&quot; array. Failing to do so will trigger a runtime warning
    > when enabling CONFIG_UBSAN_BOUNDS and CONFIG_FORTIFY_SOURCE.
    > Fixes: e3eac9f32ec0 (&quot;wifi: cfg80211: Annotate struct cfg80211_scan_request with __counted_by&quot;)
    > Signed-off-by: Haoyu Li &lt;lihaoyu499@gmail.com&gt;
    > Link: https://patch.msgid.link/20241203152049.348806-1-lihaoyu499@gmail.com
    > Signed-off-by: Johannes Berg &lt;johannes.berg@intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ tipc: fix NULL deref in cleanup_bearer() (@Eric Dumazet in [a852c82eda4991e](https://github.com/sophgo/linux-riscv/commit/a852c82eda4991e) at 2024-12-19 17:13:12)
    > [ Upstream commit b04d86fff66b15c07505d226431f808c15b1703c ]
    > syzbot found [1] that after blamed commit, ub-&gt;ubsock-&gt;sk
    > was NULL when attempting the atomic_dec() :
    > atomic_dec(&amp;tipc_net(sock_net(ub-&gt;ubsock-&gt;sk))-&gt;wq_count);
    > Fix this by caching the tipc_net pointer.
    > [1]
    > Oops: general protection fault, probably for non-canonical address 0xdffffc0000000006: 0000 [#1] PREEMPT SMP KASAN PTI
    > KASAN: null-ptr-deref in range [0x0000000000000030-0x0000000000000037]
    > CPU: 0 UID: 0 PID: 5896 Comm: kworker/0:3 Not tainted 6.13.0-rc1-next-20241203-syzkaller #0
    > Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 09/13/2024
    > Workqueue: events cleanup_bearer
    > RIP: 0010:read_pnet include/net/net_namespace.h:387 [inline]
    > RIP: 0010:sock_net include/net/sock.h:655 [inline]
    > RIP: 0010:cleanup_bearer+0x1f7/0x280 net/tipc/udp_media.c:820
    > Code: 18 48 89 d8 48 c1 e8 03 42 80 3c 28 00 74 08 48 89 df e8 3c f7 99 f6 48 8b 1b 48 83 c3 30 e8 f0 e4 60 00 48 89 d8 48 c1 e8 03 &lt;42&gt; 80 3c 28 00 74 08 48 89 df e8 1a f7 99 f6 49 83 c7 e8 48 8b 1b
    > RSP: 0018:ffffc9000410fb70 EFLAGS: 00010206
    > RAX: 0000000000000006 RBX: 0000000000000030 RCX: ffff88802fe45a00
    > RDX: 0000000000000001 RSI: 0000000000000008 RDI: ffffc9000410f900
    > RBP: ffff88807e1f0908 R08: ffffc9000410f907 R09: 1ffff92000821f20
    > R10: dffffc0000000000 R11: fffff52000821f21 R12: ffff888031d19980
    > R13: dffffc0000000000 R14: dffffc0000000000 R15: ffff88807e1f0918
    > FS:  0000000000000000(0000) GS:ffff8880b8600000(0000) knlGS:0000000000000000
    > CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
    > CR2: 0000556ca050b000 CR3: 0000000031c0c000 CR4: 00000000003526f0
    > DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
    > DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
    > Fixes: 6a2fa13312e5 (&quot;tipc: Fix use-after-free of kernel socket in cleanup_bearer().&quot;)
    > Reported-by: syzbot+46aa5474f179dacd1a3b@syzkaller.appspotmail.com
    > Closes: https://lore.kernel.org/netdev/67508b5f.050a0220.17bd51.0070.GAE@google.com/T/#u
    > Signed-off-by: Eric Dumazet &lt;edumazet@google.com&gt;
    > Reviewed-by: Kuniyuki Iwashima &lt;kuniyu@amazon.com&gt;
    > Link: https://patch.msgid.link/20241204170548.4152658-1-edumazet@google.com
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ net/mlx5: DR, prevent potential error pointer dereference (@Dan Carpenter in [a59c61a1869ceef](https://github.com/sophgo/linux-riscv/commit/a59c61a1869ceef) at 2024-12-19 17:13:12)
    > [ Upstream commit 11776cff0b563c8b8a4fa76cab620bfb633a8cb8 ]
    > The dr_domain_add_vport_cap() function generally returns NULL on error
    > but sometimes we want it to return ERR_PTR(-EBUSY) so the caller can
    > retry.  The problem here is that &quot;ret&quot; can be either -EBUSY or -ENOMEM
    > and if it&#x27;s and -ENOMEM then the error pointer is propogated back and
    > eventually dereferenced in dr_ste_v0_build_src_gvmi_qpn_tag().
    > Fixes: 11a45def2e19 (&quot;net/mlx5: DR, Add support for SF vports&quot;)
    > Signed-off-by: Dan Carpenter &lt;dan.carpenter@linaro.org&gt;
    > Reviewed-by: Tariq Toukan &lt;tariqt@nvidia.com&gt;
    > Link: https://patch.msgid.link/07477254-e179-43e2-b1b3-3b9db4674195@stanley.mountain
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ selftests: mlxsw: sharedbuffer: Remove h1 ingress test case (@Danielle Ratson in [735742ef07b9422](https://github.com/sophgo/linux-riscv/commit/735742ef07b9422) at 2024-12-19 17:13:12)
    > [ Upstream commit cf3515c556907b4da290967a2a6cbbd9ee0ee723 ]
    > The test is sending only one packet generated with mausezahn from $h1 to
    > $h2. However, for some reason, it is testing for non-zero maximum occupancy
    > in both the ingress pool of $h1 and $h2. The former only passes when $h2
    > happens to send a packet.
    > Avoid intermittent failures by removing unintentional test case
    > regarding the ingress pool of $h1.
    > Fixes: a865ad999603 (&quot;selftests: mlxsw: Add shared buffer traffic test&quot;)
    > Signed-off-by: Danielle Ratson &lt;danieller@nvidia.com&gt;
    > Reviewed-by: Ido Schimmel &lt;idosch@nvidia.com&gt;
    > Signed-off-by: Ido Schimmel &lt;idosch@nvidia.com&gt;
    > Signed-off-by: Petr Machata &lt;petrm@nvidia.com&gt;
    > Link: https://patch.msgid.link/5b7344608d5e06f38209e48d8af8c92fa11b6742.1733414773.git.petrm@nvidia.com
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ selftests: mlxsw: sharedbuffer: Remove duplicate test cases (@Danielle Ratson in [0e69887a8932291](https://github.com/sophgo/linux-riscv/commit/0e69887a8932291) at 2024-12-19 17:13:12)
    > [ Upstream commit 6c46ad4d1bb2e8ec2265296e53765190f6e32f33 ]
    > On both port_tc_ip_test() and port_tc_arp_test(), the max occupancy is
    > checked on $h2 twice, when only the error message is different and does not
    > match the check itself.
    > Remove the two duplicated test cases from the test.
    > Fixes: a865ad999603 (&quot;selftests: mlxsw: Add shared buffer traffic test&quot;)
    > Signed-off-by: Danielle Ratson &lt;danieller@nvidia.com&gt;
    > Reviewed-by: Ido Schimmel &lt;idosch@nvidia.com&gt;
    > Signed-off-by: Ido Schimmel &lt;idosch@nvidia.com&gt;
    > Signed-off-by: Petr Machata &lt;petrm@nvidia.com&gt;
    > Link: https://patch.msgid.link/d9eb26f6fc16a06a30b5c2c16ad80caf502bc561.1733414773.git.petrm@nvidia.com
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ selftests: mlxsw: sharedbuffer: Ensure no extra packets are counted (@Danielle Ratson in [04ac4bd0faf7c71](https://github.com/sophgo/linux-riscv/commit/04ac4bd0faf7c71) at 2024-12-19 17:13:12)
    > [ Upstream commit 5f2c7ab15fd806043db1a7d54b5ec36be0bd93b1 ]
    > The test assumes that the packet it is sending is the only packet being
    > passed to the device.
    > However, it is not the case and so other packets are filling the buffers
    > as well. Therefore, the test sometimes fails because it is reading a
    > maximum occupancy that is larger than expected.
    > Add egress filters on $h1 and $h2 that will guarantee the above.
    > Fixes: a865ad999603 (&quot;selftests: mlxsw: Add shared buffer traffic test&quot;)
    > Signed-off-by: Danielle Ratson &lt;danieller@nvidia.com&gt;
    > Reviewed-by: Ido Schimmel &lt;idosch@nvidia.com&gt;
    > Signed-off-by: Ido Schimmel &lt;idosch@nvidia.com&gt;
    > Signed-off-by: Petr Machata &lt;petrm@nvidia.com&gt;
    > Link: https://patch.msgid.link/64c28bc9b1cc1d78c4a73feda7cedbe9526ccf8b.1733414773.git.petrm@nvidia.com
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ amdgpu/uvd: get ring reference from rq scheduler (@David (Ming Qiang) Wu in [cc9b20ddc2d2924](https://github.com/sophgo/linux-riscv/commit/cc9b20ddc2d2924) at 2024-12-19 17:13:11)
    > [ Upstream commit 47f402a3e08113e0f5d8e1e6fcc197667a16022f ]
    > base.sched may not be set for each instance and should not
    > be used for cases such as non-IB tests.
    > Fixes: 2320c9e6a768 (&quot;drm/sched: memset() &#x27;job&#x27; in drm_sched_job_init()&quot;)
    > Signed-off-by: David (Ming Qiang) Wu &lt;David.Wu3@amd.com&gt;
    > Reviewed-by: Christian König &lt;christian.koenig@amd.com&gt;
    > Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ batman-adv: Remove uninitialized data in full table TT response (@Remi Pommarel in [b2abe3570749a8b](https://github.com/sophgo/linux-riscv/commit/b2abe3570749a8b) at 2024-12-19 17:13:11)
    > [ Upstream commit 8038806db64da15721775d6b834990cacbfcf0b2 ]
    > The number of entries filled by batadv_tt_tvlv_generate() can be less
    > than initially expected in batadv_tt_prepare_tvlv_{global,local}_data()
    > (changes can be removed by batadv_tt_local_event() in ADD+DEL sequence
    > in the meantime as the lock held during the whole tvlv global/local data
    > generation).
    > Thus tvlv_len could be bigger than the actual TT entry size that need
    > to be sent so full table TT_RESPONSE could hold invalid TT entries such
    > as below.
    > 00:00:00:00:00:00   -1 [....] (  0) 88:12:4e:ad:7e:ba (179) (0x45845380)
    > 00:00:00:00:78:79 4092 [.W..] (  0) 88:12:4e:ad:7e:3c (145) (0x8ebadb8b)
    > Remove the extra allocated space to avoid sending uninitialized entries
    > for full table TT_RESPONSE in both batadv_send_other_tt_response() and
    > batadv_send_my_tt_response().
    > Fixes: 7ea7b4a14275 (&quot;batman-adv: make the TT CRC logic VLAN specific&quot;)
    > Signed-off-by: Remi Pommarel &lt;repk@triplefau.lt&gt;
    > Signed-off-by: Sven Eckelmann &lt;sven@narfation.org&gt;
    > Signed-off-by: Simon Wunderlich &lt;sw@simonwunderlich.de&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ wifi: mac80211: fix station NSS capability initialization order (@Benjamin Lin in [80579c198dd2e89](https://github.com/sophgo/linux-riscv/commit/80579c198dd2e89) at 2024-12-19 17:13:11)
    > [ Upstream commit 819e0f1e58e0ba3800cd9eb96b2a39e44e49df97 ]
    > Station&#x27;s spatial streaming capability should be initialized before
    > handling VHT OMN, because the handling requires the capability information.
    > Fixes: a8bca3e9371d (&quot;wifi: mac80211: track capability/opmode NSS separately&quot;)
    > Signed-off-by: Benjamin Lin &lt;benjamin-jw.lin@mediatek.com&gt;
    > Link: https://patch.msgid.link/20241118080722.9603-1-benjamin-jw.lin@mediatek.com
    > [rewrite subject]
    > Signed-off-by: Johannes Berg &lt;johannes.berg@intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ perf machine: Initialize machine-&gt;env to address a segfault (@Arnaldo Carvalho de Melo in [6234eda09372153](https://github.com/sophgo/linux-riscv/commit/6234eda09372153) at 2024-12-19 17:13:11)
    > [ Upstream commit 88a6e2f67cc94f751a74409ab4c21e5fc8ea6757 ]
    > Its used from trace__run(), for the &#x27;perf trace&#x27; live mode, i.e. its
    > strace-like, non-perf.data file processing mode, the most common one.
    > The trace__run() function will set trace-&gt;host using machine__new_host()
    > that is supposed to give a machine instance representing the running
    > machine, and since we&#x27;ll use perf_env__arch_strerrno() to get the right
    > errno -&gt; string table, we need to use machine-&gt;env, so initialize it in
    > machine__new_host().
    > Before the patch:
    > (gdb) run trace --errno-summary -a sleep 1
    > &lt;SNIP&gt;
    > Summary of events:
    > gvfs-afc-volume (3187), 2 events, 0.0%
    > syscall            calls  errors  total       min       avg       max       stddev
    > (msec)    (msec)    (msec)    (msec)        (%)
    > --------------- --------  ------ -------- --------- --------- ---------     ------
    > pselect6               1      0     0.000     0.000     0.000     0.000      0.00%
    > GUsbEventThread (3519), 2 events, 0.0%
    > syscall            calls  errors  total       min       avg       max       stddev
    > (msec)    (msec)    (msec)    (msec)        (%)
    > --------------- --------  ------ -------- --------- --------- ---------     ------
    > poll                   1      0     0.000     0.000     0.000     0.000      0.00%
    > &lt;SNIP&gt;
    > Program received signal SIGSEGV, Segmentation fault.
    > 0x00000000005caba0 in perf_env__arch_strerrno (env&#x3D;0x0, err&#x3D;110) at util/env.c:478
    > 478		if (env-&gt;arch_strerrno &#x3D;&#x3D; NULL)
    > (gdb) bt
    > #0  0x00000000005caba0 in perf_env__arch_strerrno (env&#x3D;0x0, err&#x3D;110) at util/env.c:478
    > #1  0x00000000004b75d2 in thread__dump_stats (ttrace&#x3D;0x14f58f0, trace&#x3D;0x7fffffffa5b0, fp&#x3D;0x7ffff6ff74e0 &lt;_IO_2_1_stderr_&gt;) at builtin-trace.c:4673
    > #2  0x00000000004b78bf in trace__fprintf_thread (fp&#x3D;0x7ffff6ff74e0 &lt;_IO_2_1_stderr_&gt;, thread&#x3D;0x10fa0b0, trace&#x3D;0x7fffffffa5b0) at builtin-trace.c:4708
    > #3  0x00000000004b7ad9 in trace__fprintf_thread_summary (trace&#x3D;0x7fffffffa5b0, fp&#x3D;0x7ffff6ff74e0 &lt;_IO_2_1_stderr_&gt;) at builtin-trace.c:4747
    > #4  0x00000000004b656e in trace__run (trace&#x3D;0x7fffffffa5b0, argc&#x3D;2, argv&#x3D;0x7fffffffde60) at builtin-trace.c:4456
    > #5  0x00000000004ba43e in cmd_trace (argc&#x3D;2, argv&#x3D;0x7fffffffde60) at builtin-trace.c:5487
    > #6  0x00000000004c0414 in run_builtin (p&#x3D;0xec3068 &lt;commands+648&gt;, argc&#x3D;5, argv&#x3D;0x7fffffffde60) at perf.c:351
    > #7  0x00000000004c06bb in handle_internal_command (argc&#x3D;5, argv&#x3D;0x7fffffffde60) at perf.c:404
    > #8  0x00000000004c0814 in run_argv (argcp&#x3D;0x7fffffffdc4c, argv&#x3D;0x7fffffffdc40) at perf.c:448
    > #9  0x00000000004c0b5d in main (argc&#x3D;5, argv&#x3D;0x7fffffffde60) at perf.c:560
    > (gdb)
    > After:
    > root@number:~# perf trace -a --errno-summary sleep 1
    > &lt;SNIP&gt;
    > pw-data-loop (2685), 1410 events, 16.0%
    > syscall            calls  errors  total       min       avg       max       stddev
    > (msec)    (msec)    (msec)    (msec)        (%)
    > --------------- --------  ------ -------- --------- --------- ---------     ------
    > epoll_wait           188      0   983.428     0.000     5.231    15.595      8.68%
    > ioctl                 94      0     0.811     0.004     0.009     0.016      2.82%
    > read                 188      0     0.322     0.001     0.002     0.006      5.15%
    > write                141      0     0.280     0.001     0.002     0.018      8.39%
    > timerfd_settime       94      0     0.138     0.001     0.001     0.007      6.47%
    > gnome-control-c (179406), 1848 events, 20.9%
    > syscall            calls  errors  total       min       avg       max       stddev
    > (msec)    (msec)    (msec)    (msec)        (%)
    > --------------- --------  ------ -------- --------- --------- ---------     ------
    > poll                 222      0   959.577     0.000     4.322    21.414     11.40%
    > recvmsg              150      0     0.539     0.001     0.004     0.013      5.12%
    > write                300      0     0.442     0.001     0.001     0.007      3.29%
    > read                 150      0     0.183     0.001     0.001     0.009      5.53%
    > getpid               102      0     0.101     0.000     0.001     0.008      7.82%
    > root@number:~#
    > Fixes: 54373b5d53c1f6aa (&quot;perf env: Introduce perf_env__arch_strerrno()&quot;)
    > Reported-by: Veronika Molnarova &lt;vmolnaro@redhat.com&gt;
    > Signed-off-by: Arnaldo Carvalho de Melo &lt;acme@redhat.com&gt;
    > Acked-by: Veronika Molnarova &lt;vmolnaro@redhat.com&gt;
    > Acked-by: Michael Petlan &lt;mpetlan@redhat.com&gt;
    > Tested-by: Michael Petlan &lt;mpetlan@redhat.com&gt;
    > Link: https://lore.kernel.org/r/Z0XffUgNSv_9OjOi@x1
    > Signed-off-by: Namhyung Kim &lt;namhyung@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ acpi: nfit: vmalloc-out-of-bounds Read in acpi_nfit_ctl (@Suraj Sonawane in [212846fafb753a4](https://github.com/sophgo/linux-riscv/commit/212846fafb753a4) at 2024-12-19 17:13:11)
    > [ Upstream commit 265e98f72bac6c41a4492d3e30a8e5fd22fe0779 ]
    > Fix an issue detected by syzbot with KASAN:
    > BUG: KASAN: vmalloc-out-of-bounds in cmd_to_func drivers/acpi/nfit/
    > core.c:416 [inline]
    > BUG: KASAN: vmalloc-out-of-bounds in acpi_nfit_ctl+0x20e8/0x24a0
    > drivers/acpi/nfit/core.c:459
    > The issue occurs in cmd_to_func when the call_pkg-&gt;nd_reserved2
    > array is accessed without verifying that call_pkg points to a buffer
    > that is appropriately sized as a struct nd_cmd_pkg. This can lead
    > to out-of-bounds access and undefined behavior if the buffer does not
    > have sufficient space.
    > To address this, a check was added in acpi_nfit_ctl() to ensure that
    > buf is not NULL and that buf_len is less than sizeof(*call_pkg)
    > before accessing it. This ensures safe access to the members of
    > call_pkg, including the nd_reserved2 array.
    > Reported-by: syzbot+7534f060ebda6b8b51b3@syzkaller.appspotmail.com
    > Closes: https://syzkaller.appspot.com/bug?extid&#x3D;7534f060ebda6b8b51b3
    > Tested-by: syzbot+7534f060ebda6b8b51b3@syzkaller.appspotmail.com
    > Fixes: ebe9f6f19d80 (&quot;acpi/nfit: Fix bus command validation&quot;)
    > Signed-off-by: Suraj Sonawane &lt;surajsonawane0215@gmail.com&gt;
    > Reviewed-by: Alison Schofield &lt;alison.schofield@intel.com&gt;
    > Reviewed-by: Dave Jiang &lt;dave.jiang@intel.com&gt;
    > Link: https://patch.msgid.link/20241118162609.29063-1-surajsonawane0215@gmail.com
    > Signed-off-by: Ira Weiny &lt;ira.weiny@intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ batman-adv: Do not let TT changes list grows indefinitely (@Remi Pommarel in [14a122007c04059](https://github.com/sophgo/linux-riscv/commit/14a122007c04059) at 2024-12-19 17:13:11)
    > [ Upstream commit fff8f17c1a6fc802ca23bbd3a276abfde8cc58e6 ]
    > When TT changes list is too big to fit in packet due to MTU size, an
    > empty OGM is sent expected other node to send TT request to get the
    > changes. The issue is that tt.last_changeset was not built thus the
    > originator was responding with previous changes to those TT requests
    > (see batadv_send_my_tt_response). Also the changes list was never
    > cleaned up effectively never ending growing from this point onwards,
    > repeatedly sending the same TT response changes over and over, and
    > creating a new empty OGM every OGM interval expecting for the local
    > changes to be purged.
    > When there is more TT changes that can fit in packet, drop all changes,
    > send empty OGM and wait for TT request so we can respond with a full
    > table instead.
    > Fixes: e1bf0c14096f (&quot;batman-adv: tvlv - convert tt data sent within OGMs&quot;)
    > Signed-off-by: Remi Pommarel &lt;repk@triplefau.lt&gt;
    > Acked-by: Antonio Quartulli &lt;Antonio@mandelbit.com&gt;
    > Signed-off-by: Sven Eckelmann &lt;sven@narfation.org&gt;
    > Signed-off-by: Simon Wunderlich &lt;sw@simonwunderlich.de&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ batman-adv: Do not send uninitialized TT changes (@Remi Pommarel in [075704ca741a5c4](https://github.com/sophgo/linux-riscv/commit/075704ca741a5c4) at 2024-12-19 17:13:11)
    > [ Upstream commit f2f7358c3890e7366cbcb7512b4bc8b4394b2d61 ]
    > The number of TT changes can be less than initially expected in
    > batadv_tt_tvlv_container_update() (changes can be removed by
    > batadv_tt_local_event() in ADD+DEL sequence between reading
    > tt_diff_entries_num and actually iterating the change list under lock).
    > Thus tt_diff_len could be bigger than the actual changes size that need
    > to be sent. Because batadv_send_my_tt_response sends the whole
    > packet, uninitialized data can be interpreted as TT changes on other
    > nodes leading to weird TT global entries on those nodes such as:
    > 00:00:00:00:00:00   -1 [....] (  0) 88:12:4e:ad:7e:ba (179) (0x45845380)
    > 00:00:00:00:78:79 4092 [.W..] (  0) 88:12:4e:ad:7e:3c (145) (0x8ebadb8b)
    > All of the above also applies to OGM tvlv container buffer&#x27;s tvlv_len.
    > Remove the extra allocated space to avoid sending uninitialized TT
    > changes in batadv_send_my_tt_response() and batadv_v_ogm_send_softif().
    > Fixes: e1bf0c14096f (&quot;batman-adv: tvlv - convert tt data sent within OGMs&quot;)
    > Signed-off-by: Remi Pommarel &lt;repk@triplefau.lt&gt;
    > Signed-off-by: Sven Eckelmann &lt;sven@narfation.org&gt;
    > Signed-off-by: Simon Wunderlich &lt;sw@simonwunderlich.de&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ wifi: mac80211: fix a queue stall in certain cases of CSA (@Emmanuel Grumbach in [fbe94d4ab93e1bd](https://github.com/sophgo/linux-riscv/commit/fbe94d4ab93e1bd) at 2024-12-19 17:13:10)
    > [ Upstream commit 11ac0d7c3b5ba58232fb7dacb54371cbe75ec183 ]
    > If we got an unprotected action frame with CSA and then we heard the
    > beacon with the CSA IE, we&#x27;ll block the queues with the CSA reason
    > twice. Since this reason is refcounted, we won&#x27;t wake up the queues
    > since we wake them up only once and the ref count will never reach 0.
    > This led to blocked queues that prevented any activity (even
    > disconnection wouldn&#x27;t reset the queue state and the only way to recover
    > would be to reload the kernel module.
    > Fix this by not refcounting the CSA reason.
    > It becomes now pointless to maintain the csa_blocked_queues state.
    > Remove it.
    > Signed-off-by: Emmanuel Grumbach &lt;emmanuel.grumbach@intel.com&gt;
    > Fixes: 414e090bc41d (&quot;wifi: mac80211: restrict public action ECSA frame handling&quot;)
    > Closes: https://bugzilla.kernel.org/show_bug.cgi?id&#x3D;219447
    > Signed-off-by: Miri Korenblit &lt;miriam.rachel.korenblit@intel.com&gt;
    > Link: https://patch.msgid.link/20241119173108.5ea90828c2cc.I4f89e58572fb71ae48e47a81e74595cac410fbac@changeid
    > Signed-off-by: Johannes Berg &lt;johannes.berg@intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ wifi: nl80211: fix NL80211_ATTR_MLO_LINK_ID off-by-one (@Lin Ma in [f850d1d9f1106f5](https://github.com/sophgo/linux-riscv/commit/f850d1d9f1106f5) at 2024-12-19 17:13:10)
    > [ Upstream commit 2e3dbf938656986cce73ac4083500d0bcfbffe24 ]
    > Since the netlink attribute range validation provides inclusive
    > checking, the *max* of attribute NL80211_ATTR_MLO_LINK_ID should be
    > IEEE80211_MLD_MAX_NUM_LINKS - 1 otherwise causing an off-by-one.
    > One crash stack for demonstration:
    > &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;
    > BUG: KASAN: wild-memory-access in ieee80211_tx_control_port+0x3b6/0xca0 net/mac80211/tx.c:5939
    > Read of size 6 at addr 001102080000000c by task fuzzer.386/9508
    > CPU: 1 PID: 9508 Comm: syz.1.386 Not tainted 6.1.70 #2
    > Call Trace:
    > &lt;TASK&gt;
    > __dump_stack lib/dump_stack.c:88 [inline]
    > dump_stack_lvl+0x177/0x231 lib/dump_stack.c:106
    > print_report+0xe0/0x750 mm/kasan/report.c:398
    > kasan_report+0x139/0x170 mm/kasan/report.c:495
    > kasan_check_range+0x287/0x290 mm/kasan/generic.c:189
    > memcpy+0x25/0x60 mm/kasan/shadow.c:65
    > ieee80211_tx_control_port+0x3b6/0xca0 net/mac80211/tx.c:5939
    > rdev_tx_control_port net/wireless/rdev-ops.h:761 [inline]
    > nl80211_tx_control_port+0x7b3/0xc40 net/wireless/nl80211.c:15453
    > genl_family_rcv_msg_doit+0x22e/0x320 net/netlink/genetlink.c:756
    > genl_family_rcv_msg net/netlink/genetlink.c:833 [inline]
    > genl_rcv_msg+0x539/0x740 net/netlink/genetlink.c:850
    > netlink_rcv_skb+0x1de/0x420 net/netlink/af_netlink.c:2508
    > genl_rcv+0x24/0x40 net/netlink/genetlink.c:861
    > netlink_unicast_kernel net/netlink/af_netlink.c:1326 [inline]
    > netlink_unicast+0x74b/0x8c0 net/netlink/af_netlink.c:1352
    > netlink_sendmsg+0x882/0xb90 net/netlink/af_netlink.c:1874
    > sock_sendmsg_nosec net/socket.c:716 [inline]
    > __sock_sendmsg net/socket.c:728 [inline]
    > ____sys_sendmsg+0x5cc/0x8f0 net/socket.c:2499
    > ___sys_sendmsg+0x21c/0x290 net/socket.c:2553
    > __sys_sendmsg net/socket.c:2582 [inline]
    > __do_sys_sendmsg net/socket.c:2591 [inline]
    > __se_sys_sendmsg+0x19e/0x270 net/socket.c:2589
    > do_syscall_x64 arch/x86/entry/common.c:51 [inline]
    > do_syscall_64+0x45/0x90 arch/x86/entry/common.c:81
    > entry_SYSCALL_64_after_hwframe+0x63/0xcd
    > Update the policy to ensure correct validation.
    > Fixes: 7b0a0e3c3a88 (&quot;wifi: cfg80211: do some rework towards MLO link APIs&quot;)
    > Signed-off-by: Lin Ma &lt;linma@zju.edu.cn&gt;
    > Suggested-by: Cengiz Can &lt;cengiz.can@canonical.com&gt;
    > Link: https://patch.msgid.link/20241130170526.96698-1-linma@zju.edu.cn
    > Signed-off-by: Johannes Berg &lt;johannes.berg@intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ perf tools: Fix build-id event recording (@Namhyung Kim in [ce1ecccd6d4e1fc](https://github.com/sophgo/linux-riscv/commit/ce1ecccd6d4e1fc) at 2024-12-19 17:13:10)
    > [ Upstream commit 23c44f6c83257923b179461694edcf62749bedd5 ]
    > The build-id events written at the end of the record session are broken
    > due to unexpected data.  The write_buildid() writes the fixed length
    > event first and then variable length filename.
    > But a recent change made it write more data in the padding area
    > accidentally.  So readers of the event see zero-filled data for the
    > next entry and treat it incorrectly.  This resulted in wrong kernel
    > symbols because the kernel DSO loaded a random vmlinux image in the
    > path as it didn&#x27;t have a valid build-id.
    > Fixes: ae39ba16554e (&quot;perf inject: Fix build ID injection&quot;)
    > Reported-by: Linus Torvalds &lt;torvalds@linux-foundation.org&gt;
    > Tested-by: Arnaldo Carvalho de Melo &lt;acme@redhat.com&gt;
    > Reviewed-by: Ian Rogers &lt;irogers@google.com&gt;
    > Link: https://lore.kernel.org/r/Z0aRFFW9xMh3mqKB@google.com
    > Signed-off-by: Namhyung Kim &lt;namhyung@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ bpf: Augment raw_tp arguments with PTR_MAYBE_NULL (@Kumar Kartikeya Dwivedi in [b2fc4b17fc13810](https://github.com/sophgo/linux-riscv/commit/b2fc4b17fc13810) at 2024-12-19 17:13:10)
    > commit 838a10bd2ebfe11a60dd67687533a7cfc220cc86 upstream.
    > Arguments to a raw tracepoint are tagged as trusted, which carries the
    > semantics that the pointer will be non-NULL.  However, in certain cases,
    > a raw tracepoint argument may end up being NULL. More context about this
    > issue is available in [0].
    > Thus, there is a discrepancy between the reality, that raw_tp arguments can
    > actually be NULL, and the verifier&#x27;s knowledge, that they are never NULL,
    > causing explicit NULL check branch to be dead code eliminated.
    > A previous attempt [1], i.e. the second fixed commit, was made to
    > simulate symbolic execution as if in most accesses, the argument is a
    > non-NULL raw_tp, except for conditional jumps.  This tried to suppress
    > branch prediction while preserving compatibility, but surfaced issues
    > with production programs that were difficult to solve without increasing
    > verifier complexity. A more complete discussion of issues and fixes is
    > available at [2].
    > Fix this by maintaining an explicit list of tracepoints where the
    > arguments are known to be NULL, and mark the positional arguments as
    > PTR_MAYBE_NULL. Additionally, capture the tracepoints where arguments
    > are known to be ERR_PTR, and mark these arguments as scalar values to
    > prevent potential dereference.
    > Each hex digit is used to encode NULL-ness (0x1) or ERR_PTR-ness (0x2),
    > shifted by the zero-indexed argument number x 4. This can be represented
    > as follows:
    > 1st arg: 0x1
    > 2nd arg: 0x10
    > 3rd arg: 0x100
    > ... and so on (likewise for ERR_PTR case).
    > In the future, an automated pass will be used to produce such a list, or
    > insert __nullable annotations automatically for tracepoints. Each
    > compilation unit will be analyzed and results will be collated to find
    > whether a tracepoint pointer is definitely not null, maybe null, or an
    > unknown state where verifier conservatively marks it PTR_MAYBE_NULL.
    > A proof of concept of this tool from Eduard is available at [3].
    > Note that in case we don&#x27;t find a specification in the raw_tp_null_args
    > array and the tracepoint belongs to a kernel module, we will
    > conservatively mark the arguments as PTR_MAYBE_NULL. This is because
    > unlike for in-tree modules, out-of-tree module tracepoints may pass NULL
    > freely to the tracepoint. We don&#x27;t protect against such tracepoints
    > passing ERR_PTR (which is uncommon anyway), lest we mark all such
    > arguments as SCALAR_VALUE.
    > While we are it, let&#x27;s adjust the test raw_tp_null to not perform
    > dereference of the skb-&gt;mark, as that won&#x27;t be allowed anymore, and make
    > it more robust by using inline assembly to test the dead code
    > elimination behavior, which should still stay the same.
    > [0]: https://lore.kernel.org/bpf/ZrCZS6nisraEqehw@jlelli-thinkpadt14gen4.remote.csb
    > [1]: https://lore.kernel.org/all/20241104171959.2938862-1-memxor@gmail.com
    > [2]: https://lore.kernel.org/bpf/20241206161053.809580-1-memxor@gmail.com
    > [3]: https://github.com/eddyz87/llvm-project/tree/nullness-for-tracepoint-params
    > Reported-by: Juri Lelli &lt;juri.lelli@redhat.com&gt; # original bug
    > Reported-by: Manu Bretelle &lt;chantra@meta.com&gt; # bugs in masking fix
    > Fixes: 3f00c5239344 (&quot;bpf: Allow trusted pointers to be passed to KF_TRUSTED_ARGS kfuncs&quot;)
    > Fixes: cb4158ce8ec8 (&quot;bpf: Mark raw_tp arguments with PTR_MAYBE_NULL&quot;)
    > Reviewed-by: Eduard Zingerman &lt;eddyz87@gmail.com&gt;
    > Co-developed-by: Jiri Olsa &lt;jolsa@kernel.org&gt;
    > Signed-off-by: Jiri Olsa &lt;jolsa@kernel.org&gt;
    > Signed-off-by: Kumar Kartikeya Dwivedi &lt;memxor@gmail.com&gt;
    > Link: https://lore.kernel.org/r/20241213221929.3495062-3-memxor@gmail.com
    > Signed-off-by: Alexei Starovoitov &lt;ast@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ bpf, sockmap: Fix update element with same (@Michal Luczaj in [2bd517bafc38f7c](https://github.com/sophgo/linux-riscv/commit/2bd517bafc38f7c) at 2024-12-19 17:13:10)
    > commit 75e072a390da9a22e7ae4a4e8434dfca5da499fb upstream.
    > Consider a sockmap entry being updated with the same socket:
    > osk &#x3D; stab-&gt;sks[idx];
    > sock_map_add_link(psock, link, map, &amp;stab-&gt;sks[idx]);
    > stab-&gt;sks[idx] &#x3D; sk;
    > if (osk)
    > sock_map_unref(osk, &amp;stab-&gt;sks[idx]);
    > Due to sock_map_unref(), which invokes sock_map_del_link(), all the
    > psock&#x27;s links for stab-&gt;sks[idx] are torn:
    > list_for_each_entry_safe(link, tmp, &amp;psock-&gt;link, list) {
    > if (link-&gt;link_raw &#x3D;&#x3D; link_raw) {
    > ...
    > list_del(&amp;link-&gt;list);
    > sk_psock_free_link(link);
    > }
    > }
    > And that includes the new link sock_map_add_link() added just before
    > the unref.
    > This results in a sockmap holding a socket, but without the respective
    > link. This in turn means that close(sock) won&#x27;t trigger the cleanup,
    > i.e. a closed socket will not be automatically removed from the sockmap.
    > Stop tearing the links when a matching link_raw is found.
    > Fixes: 604326b41a6f (&quot;bpf, sockmap: convert to generic sk_msg interface&quot;)
    > Signed-off-by: Michal Luczaj &lt;mhal@rbox.co&gt;
    > Signed-off-by: Daniel Borkmann &lt;daniel@iogearbox.net&gt;
    > Reviewed-by: John Fastabend &lt;john.fastabend@gmail.com&gt;
    > Link: https://lore.kernel.org/bpf/20241202-sockmap-replace-v1-1-1e88579e7bd5@rbox.co
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ wifi: mac80211: init cnt before accessing elem in ieee80211_copy_mbssid_beacon (@Haoyu Li in [1145c393651c6b5](https://github.com/sophgo/linux-riscv/commit/1145c393651c6b5) at 2024-12-19 17:13:10)
    > [ Upstream commit 496db69fd860570145f7c266b31f3af85fca5b00 ]
    > With the new __counted_by annocation in cfg80211_mbssid_elems,
    > the &quot;cnt&quot; struct member must be set before accessing the &quot;elem&quot;
    > array. Failing to do so will trigger a runtime warning when enabling
    > CONFIG_UBSAN_BOUNDS and CONFIG_FORTIFY_SOURCE.
    > Fixes: c14679d7005a (&quot;wifi: cfg80211: Annotate struct cfg80211_mbssid_elems with __counted_by&quot;)
    > Signed-off-by: Haoyu Li &lt;lihaoyu499@gmail.com&gt;
    > Link: https://patch.msgid.link/20241123172500.311853-1-lihaoyu499@gmail.com
    > Signed-off-by: Johannes Berg &lt;johannes.berg@intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ bpf: Fix theoretical prog_array UAF in __uprobe_perf_func() (@Jann Horn in [e6d1dec1424c3ff](https://github.com/sophgo/linux-riscv/commit/e6d1dec1424c3ff) at 2024-12-19 17:13:09)
    > commit 7d0d673627e20cfa3b21a829a896ce03b58a4f1c upstream.
    > Currently, the pointer stored in call-&gt;prog_array is loaded in
    > __uprobe_perf_func(), with no RCU annotation and no immediately visible
    > RCU protection, so it looks as if the loaded pointer can immediately be
    > dangling.
    > Later, bpf_prog_run_array_uprobe() starts a RCU-trace read-side critical
    > section, but this is too late. It then uses rcu_dereference_check(), but
    > this use of rcu_dereference_check() does not actually dereference anything.
    > Fix it by aligning the semantics to bpf_prog_run_array(): Let the caller
    > provide rcu_read_lock_trace() protection and then load call-&gt;prog_array
    > with rcu_dereference_check().
    > This issue seems to be theoretical: I don&#x27;t know of any way to reach this
    > code without having handle_swbp() further up the stack, which is already
    > holding a rcu_read_lock_trace() lock, so where we take
    > rcu_read_lock_trace() in __uprobe_perf_func()/bpf_prog_run_array_uprobe()
    > doesn&#x27;t actually have any effect.
    > Fixes: 8c7dcb84e3b7 (&quot;bpf: implement sleepable uprobes by chaining gps&quot;)
    > Suggested-by: Andrii Nakryiko &lt;andrii@kernel.org&gt;
    > Signed-off-by: Jann Horn &lt;jannh@google.com&gt;
    > Signed-off-by: Andrii Nakryiko &lt;andrii@kernel.org&gt;
    > Link: https://lore.kernel.org/bpf/20241210-bpf-fix-uprobe-uaf-v4-1-5fc8959b2b74@google.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ bpf,perf: Fix invalid prog_array access in perf_event_detach_bpf_prog (@Jiri Olsa in [dfb15ddf3b65e0d](https://github.com/sophgo/linux-riscv/commit/dfb15ddf3b65e0d) at 2024-12-19 17:13:09)
    > commit 978c4486cca5c7b9253d3ab98a88c8e769cb9bbd upstream.
    > Syzbot reported [1] crash that happens for following tracing scenario:
    > - create tracepoint perf event with attr.inherit&#x3D;1, attach it to the
    > process and set bpf program to it
    > - attached process forks -&gt; chid creates inherited event
    > the new child event shares the parent&#x27;s bpf program and tp_event
    > (hence prog_array) which is global for tracepoint
    > - exit both process and its child -&gt; release both events
    > - first perf_event_detach_bpf_prog call will release tp_event-&gt;prog_array
    > and second perf_event_detach_bpf_prog will crash, because
    > tp_event-&gt;prog_array is NULL
    > The fix makes sure the perf_event_detach_bpf_prog checks prog_array
    > is valid before it tries to remove the bpf program from it.
    > [1] https://lore.kernel.org/bpf/Z1MR6dCIKajNS6nU@krava/T/#m91dbf0688221ec7a7fc95e896a7ef9ff93b0b8ad
    > Fixes: 0ee288e69d03 (&quot;bpf,perf: Fix perf_event_detach_bpf_prog error handling&quot;)
    > Reported-by: syzbot+2e0d2840414ce817aaac@syzkaller.appspotmail.com
    > Signed-off-by: Jiri Olsa &lt;jolsa@kernel.org&gt;
    > Signed-off-by: Andrii Nakryiko &lt;andrii@kernel.org&gt;
    > Link: https://lore.kernel.org/bpf/20241208142507.1207698-1-jolsa@kernel.org
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ bpf, sockmap: Fix race between element replace and close() (@Michal Luczaj in [bf2318e288f636a](https://github.com/sophgo/linux-riscv/commit/bf2318e288f636a) at 2024-12-19 17:13:09)
    > commit ed1fc5d76b81a4d681211333c026202cad4d5649 upstream.
    > Element replace (with a socket different from the one stored) may race
    > with socket&#x27;s close() link popping &amp; unlinking. __sock_map_delete()
    > unconditionally unrefs the (wrong) element:
    > // set map[0] &#x3D; s0
    > map_update_elem(map, 0, s0)
    > // drop fd of s0
    > close(s0)
    > sock_map_close()
    > lock_sock(sk)               (s0!)
    > sock_map_remove_links(sk)
    > link &#x3D; sk_psock_link_pop()
    > sock_map_unlink(sk, link)
    > sock_map_delete_from_link
    > // replace map[0] with s1
    > map_update_elem(map, 0, s1)
    > sock_map_update_elem
    > (s1!)       lock_sock(sk)
    > sock_map_update_common
    > psock &#x3D; sk_psock(sk)
    > spin_lock(&amp;stab-&gt;lock)
    > osk &#x3D; stab-&gt;sks[idx]
    > sock_map_add_link(..., &amp;stab-&gt;sks[idx])
    > sock_map_unref(osk, &amp;stab-&gt;sks[idx])
    > psock &#x3D; sk_psock(osk)
    > sk_psock_put(sk, psock)
    > if (refcount_dec_and_test(&amp;psock))
    > sk_psock_drop(sk, psock)
    > spin_unlock(&amp;stab-&gt;lock)
    > unlock_sock(sk)
    > __sock_map_delete
    > spin_lock(&amp;stab-&gt;lock)
    > sk &#x3D; *psk                        // s1 replaced s0; sk &#x3D;&#x3D; s1
    > if (!sk_test || sk_test &#x3D;&#x3D; sk)   // sk_test (s0) !&#x3D; sk (s1); no branch
    > sk &#x3D; xchg(psk, NULL)
    > if (sk)
    > sock_map_unref(sk, psk)        // unref s1; sks[idx] will dangle
    > psock &#x3D; sk_psock(sk)
    > sk_psock_put(sk, psock)
    > if (refcount_dec_and_test())
    > sk_psock_drop(sk, psock)
    > spin_unlock(&amp;stab-&gt;lock)
    > release_sock(sk)
    > Then close(map) enqueues bpf_map_free_deferred, which finally calls
    > sock_map_free(). This results in some refcount_t warnings along with
    > a KASAN splat [1].
    > Fix __sock_map_delete(), do not allow sock_map_unref() on elements that
    > may have been replaced.
    > [1]:
    > BUG: KASAN: slab-use-after-free in sock_map_free+0x10e/0x330
    > Write of size 4 at addr ffff88811f5b9100 by task kworker/u64:12/1063
    > CPU: 14 UID: 0 PID: 1063 Comm: kworker/u64:12 Not tainted 6.12.0+ #125
    > Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS Arch Linux 1.16.3-1-1 04/01/2014
    > Workqueue: events_unbound bpf_map_free_deferred
    > Call Trace:
    > &lt;TASK&gt;
    > dump_stack_lvl+0x68/0x90
    > print_report+0x174/0x4f6
    > kasan_report+0xb9/0x190
    > kasan_check_range+0x10f/0x1e0
    > sock_map_free+0x10e/0x330
    > bpf_map_free_deferred+0x173/0x320
    > process_one_work+0x846/0x1420
    > worker_thread+0x5b3/0xf80
    > kthread+0x29e/0x360
    > ret_from_fork+0x2d/0x70
    > ret_from_fork_asm+0x1a/0x30
    > &lt;/TASK&gt;
    > Allocated by task 1202:
    > kasan_save_stack+0x1e/0x40
    > kasan_save_track+0x10/0x30
    > __kasan_slab_alloc+0x85/0x90
    > kmem_cache_alloc_noprof+0x131/0x450
    > sk_prot_alloc+0x5b/0x220
    > sk_alloc+0x2c/0x870
    > unix_create1+0x88/0x8a0
    > unix_create+0xc5/0x180
    > __sock_create+0x241/0x650
    > __sys_socketpair+0x1ce/0x420
    > __x64_sys_socketpair+0x92/0x100
    > do_syscall_64+0x93/0x180
    > entry_SYSCALL_64_after_hwframe+0x76/0x7e
    > Freed by task 46:
    > kasan_save_stack+0x1e/0x40
    > kasan_save_track+0x10/0x30
    > kasan_save_free_info+0x37/0x60
    > __kasan_slab_free+0x4b/0x70
    > kmem_cache_free+0x1a1/0x590
    > __sk_destruct+0x388/0x5a0
    > sk_psock_destroy+0x73e/0xa50
    > process_one_work+0x846/0x1420
    > worker_thread+0x5b3/0xf80
    > kthread+0x29e/0x360
    > ret_from_fork+0x2d/0x70
    > ret_from_fork_asm+0x1a/0x30
    > The buggy address belongs to the object at ffff88811f5b9080
    > which belongs to the cache UNIX-STREAM of size 1984
    > The buggy address is located 128 bytes inside of
    > freed 1984-byte region [ffff88811f5b9080, ffff88811f5b9840)
    > The buggy address belongs to the physical page:
    > page: refcount:1 mapcount:0 mapping:0000000000000000 index:0x0 pfn:0x11f5b8
    > head: order:3 mapcount:0 entire_mapcount:0 nr_pages_mapped:0 pincount:0
    > memcg:ffff888127d49401
    > flags: 0x17ffffc0000040(head|node&#x3D;0|zone&#x3D;2|lastcpupid&#x3D;0x1fffff)
    > page_type: f5(slab)
    > raw: 0017ffffc0000040 ffff8881042e4500 dead000000000122 0000000000000000
    > raw: 0000000000000000 00000000800f000f 00000001f5000000 ffff888127d49401
    > head: 0017ffffc0000040 ffff8881042e4500 dead000000000122 0000000000000000
    > head: 0000000000000000 00000000800f000f 00000001f5000000 ffff888127d49401
    > head: 0017ffffc0000003 ffffea00047d6e01 ffffffffffffffff 0000000000000000
    > head: 0000000000000008 0000000000000000 00000000ffffffff 0000000000000000
    > page dumped because: kasan: bad access detected
    > Memory state around the buggy address:
    > ffff88811f5b9000: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
    > ffff88811f5b9080: fa fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
    > ^
    > ffff88811f5b9180: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
    > ffff88811f5b9200: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
    > Disabling lock debugging due to kernel taint
    > refcount_t: addition on 0; use-after-free.
    > WARNING: CPU: 14 PID: 1063 at lib/refcount.c:25 refcount_warn_saturate+0xce/0x150
    > CPU: 14 UID: 0 PID: 1063 Comm: kworker/u64:12 Tainted: G    B              6.12.0+ #125
    > Tainted: [B]&#x3D;BAD_PAGE
    > Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS Arch Linux 1.16.3-1-1 04/01/2014
    > Workqueue: events_unbound bpf_map_free_deferred
    > RIP: 0010:refcount_warn_saturate+0xce/0x150
    > Code: 34 73 eb 03 01 e8 82 53 ad fe 0f 0b eb b1 80 3d 27 73 eb 03 00 75 a8 48 c7 c7 80 bd 95 84 c6 05 17 73 eb 03 01 e8 62 53 ad fe &lt;0f&gt; 0b eb 91 80 3d 06 73 eb 03 00 75 88 48 c7 c7 e0 bd 95 84 c6 05
    > RSP: 0018:ffff88815c49fc70 EFLAGS: 00010282
    > RAX: 0000000000000000 RBX: ffff88811f5b9100 RCX: 0000000000000000
    > RDX: 0000000000000000 RSI: 0000000000000004 RDI: 0000000000000001
    > RBP: 0000000000000002 R08: 0000000000000001 R09: ffffed10bcde6349
    > R10: ffff8885e6f31a4b R11: 0000000000000000 R12: ffff88813be0b000
    > R13: ffff88811f5b9100 R14: ffff88811f5b9080 R15: ffff88813be0b024
    > FS:  0000000000000000(0000) GS:ffff8885e6f00000(0000) knlGS:0000000000000000
    > CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
    > CR2: 000055dda99b0250 CR3: 000000015dbac000 CR4: 0000000000752ef0
    > PKRU: 55555554
    > Call Trace:
    > &lt;TASK&gt;
    > ? __warn.cold+0x5f/0x1ff
    > ? refcount_warn_saturate+0xce/0x150
    > ? report_bug+0x1ec/0x390
    > ? handle_bug+0x58/0x90
    > ? exc_invalid_op+0x13/0x40
    > ? asm_exc_invalid_op+0x16/0x20
    > ? refcount_warn_saturate+0xce/0x150
    > sock_map_free+0x2e5/0x330
    > bpf_map_free_deferred+0x173/0x320
    > process_one_work+0x846/0x1420
    > worker_thread+0x5b3/0xf80
    > kthread+0x29e/0x360
    > ret_from_fork+0x2d/0x70
    > ret_from_fork_asm+0x1a/0x30
    > &lt;/TASK&gt;
    > irq event stamp: 10741
    > hardirqs last  enabled at (10741): [&lt;ffffffff84400ec6&gt;] asm_sysvec_apic_timer_interrupt+0x16/0x20
    > hardirqs last disabled at (10740): [&lt;ffffffff811e532d&gt;] handle_softirqs+0x60d/0x770
    > softirqs last  enabled at (10506): [&lt;ffffffff811e55a9&gt;] __irq_exit_rcu+0x109/0x210
    > softirqs last disabled at (10301): [&lt;ffffffff811e55a9&gt;] __irq_exit_rcu+0x109/0x210
    > refcount_t: underflow; use-after-free.
    > WARNING: CPU: 14 PID: 1063 at lib/refcount.c:28 refcount_warn_saturate+0xee/0x150
    > CPU: 14 UID: 0 PID: 1063 Comm: kworker/u64:12 Tainted: G    B   W          6.12.0+ #125
    > Tainted: [B]&#x3D;BAD_PAGE, [W]&#x3D;WARN
    > Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS Arch Linux 1.16.3-1-1 04/01/2014
    > Workqueue: events_unbound bpf_map_free_deferred
    > RIP: 0010:refcount_warn_saturate+0xee/0x150
    > Code: 17 73 eb 03 01 e8 62 53 ad fe 0f 0b eb 91 80 3d 06 73 eb 03 00 75 88 48 c7 c7 e0 bd 95 84 c6 05 f6 72 eb 03 01 e8 42 53 ad fe &lt;0f&gt; 0b e9 6e ff ff ff 80 3d e6 72 eb 03 00 0f 85 61 ff ff ff 48 c7
    > RSP: 0018:ffff88815c49fc70 EFLAGS: 00010282
    > RAX: 0000000000000000 RBX: ffff88811f5b9100 RCX: 0000000000000000
    > RDX: 0000000000000000 RSI: 0000000000000004 RDI: 0000000000000001
    > RBP: 0000000000000003 R08: 0000000000000001 R09: ffffed10bcde6349
    > R10: ffff8885e6f31a4b R11: 0000000000000000 R12: ffff88813be0b000
    > R13: ffff88811f5b9100 R14: ffff88811f5b9080 R15: ffff88813be0b024
    > FS:  0000000000000000(0000) GS:ffff8885e6f00000(0000) knlGS:0000000000000000
    > CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
    > CR2: 000055dda99b0250 CR3: 000000015dbac000 CR4: 0000000000752ef0
    > PKRU: 55555554
    > Call Trace:
    > &lt;TASK&gt;
    > ? __warn.cold+0x5f/0x1ff
    > ? refcount_warn_saturate+0xee/0x150
    > ? report_bug+0x1ec/0x390
    > ? handle_bug+0x58/0x90
    > ? exc_invalid_op+0x13/0x40
    > ? asm_exc_invalid_op+0x16/0x20
    > ? refcount_warn_saturate+0xee/0x150
    > sock_map_free+0x2d3/0x330
    > bpf_map_free_deferred+0x173/0x320
    > process_one_work+0x846/0x1420
    > worker_thread+0x5b3/0xf80
    > kthread+0x29e/0x360
    > ret_from_fork+0x2d/0x70
    > ret_from_fork_asm+0x1a/0x30
    > &lt;/TASK&gt;
    > irq event stamp: 10741
    > hardirqs last  enabled at (10741): [&lt;ffffffff84400ec6&gt;] asm_sysvec_apic_timer_interrupt+0x16/0x20
    > hardirqs last disabled at (10740): [&lt;ffffffff811e532d&gt;] handle_softirqs+0x60d/0x770
    > softirqs last  enabled at (10506): [&lt;ffffffff811e55a9&gt;] __irq_exit_rcu+0x109/0x210
    > softirqs last disabled at (10301): [&lt;ffffffff811e55a9&gt;] __irq_exit_rcu+0x109/0x210
    > Fixes: 604326b41a6f (&quot;bpf, sockmap: convert to generic sk_msg interface&quot;)
    > Signed-off-by: Michal Luczaj &lt;mhal@rbox.co&gt;
    > Signed-off-by: Daniel Borkmann &lt;daniel@iogearbox.net&gt;
    > Reviewed-by: John Fastabend &lt;john.fastabend@gmail.com&gt;
    > Link: https://lore.kernel.org/bpf/20241202-sockmap-replace-v1-3-1e88579e7bd5@rbox.co
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ xfs: unlock inodes when erroring out of xfs_trans_alloc_dir (@Darrick J. Wong in [6aefe5d97ae57b1](https://github.com/sophgo/linux-riscv/commit/6aefe5d97ae57b1) at 2024-12-19 17:13:09)
    > commit 53b001a21c9dff73b64e8c909c41991f01d5d00f upstream.
    > Debugging a filesystem patch with generic/475 caused the system to hang
    > after observing the following sequences in dmesg:
    > XFS (dm-0): metadata I/O error in &quot;xfs_imap_to_bp+0x61/0xe0 [xfs]&quot; at daddr 0x491520 len 32 error 5
    > XFS (dm-0): metadata I/O error in &quot;xfs_btree_read_buf_block+0xba/0x160 [xfs]&quot; at daddr 0x3445608 len 8 error 5
    > XFS (dm-0): metadata I/O error in &quot;xfs_imap_to_bp+0x61/0xe0 [xfs]&quot; at daddr 0x138e1c0 len 32 error 5
    > XFS (dm-0): log I/O error -5
    > XFS (dm-0): Metadata I/O Error (0x1) detected at xfs_trans_read_buf_map+0x1ea/0x4b0 [xfs] (fs/xfs/xfs_trans_buf.c:311).  Shutting down filesystem.
    > XFS (dm-0): Please unmount the filesystem and rectify the problem(s)
    > XFS (dm-0): Internal error dqp-&gt;q_ino.reserved &lt; dqp-&gt;q_ino.count at line 869 of file fs/xfs/xfs_trans_dquot.c.  Caller xfs_trans_dqresv+0x236/0x440 [xfs]
    > XFS (dm-0): Corruption detected. Unmount and run xfs_repair
    > XFS (dm-0): Unmounting Filesystem be6bcbcc-9921-4deb-8d16-7cc94e335fa7
    > The system is stuck in unmount trying to lock a couple of inodes so that
    > they can be purged.  The dquot corruption notice above is a clue to what
    > happened -- a link() call tried to set up a transaction to link a child
    > into a directory.  Quota reservation for the transaction failed after IO
    > errors shut down the filesystem, but then we forgot to unlock the inodes
    > on our way out.  Fix that.
    > Cc: &lt;stable@vger.kernel.org&gt; # v6.10
    > Fixes: bd5562111d5839 (&quot;xfs: Hold inode locks in xfs_trans_alloc_dir&quot;)
    > Signed-off-by: &quot;Darrick J. Wong&quot; &lt;djwong@kernel.org&gt;
    > Reviewed-by: Christoph Hellwig &lt;hch@lst.de&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ bpf: Check size for BTF-based ctx access of pointer members (@Kumar Kartikeya Dwivedi in [2c3ca17a071a2f5](https://github.com/sophgo/linux-riscv/commit/2c3ca17a071a2f5) at 2024-12-19 17:13:09)
    > commit 659b9ba7cb2d7adb64618b87ddfaa528a143766e upstream.
    > Robert Morris reported the following program type which passes the
    > verifier in [0]:
    > SEC(&quot;struct_ops/bpf_cubic_init&quot;)
    > void BPF_PROG(bpf_cubic_init, struct sock *sk)
    > {
    > asm volatile(&quot;r2 &#x3D; *(u16*)(r1 + 0)&quot;);     // verifier should demand u64
    > asm volatile(&quot;*(u32 *)(r2 +1504) &#x3D; 0&quot;);   // 1280 in some configs
    > }
    > The second line may or may not work, but the first instruction shouldn&#x27;t
    > pass, as it&#x27;s a narrow load into the context structure of the struct ops
    > callback. The code falls back to btf_ctx_access to ensure correctness
    > and obtaining the types of pointers. Ensure that the size of the access
    > is correctly checked to be 8 bytes, otherwise the verifier thinks the
    > narrow load obtained a trusted BTF pointer and will permit loads/stores
    > as it sees fit.
    > Perform the check on size after we&#x27;ve verified that the load is for a
    > pointer field, as for scalar values narrow loads are fine. Access to
    > structs passed as arguments to a BPF program are also treated as
    > scalars, therefore no adjustment is needed in their case.
    > Existing verifier selftests are broken by this change, but because they
    > were incorrect. Verifier tests for d_path were performing narrow load
    > into context to obtain path pointer, had this program actually run it
    > would cause a crash. The same holds for verifier_btf_ctx_access tests.
    > [0]: https://lore.kernel.org/bpf/51338.1732985814@localhost
    > Fixes: 9e15db66136a (&quot;bpf: Implement accurate raw_tp context access via BTF&quot;)
    > Reported-by: Robert Morris &lt;rtm@mit.edu&gt;
    > Signed-off-by: Kumar Kartikeya Dwivedi &lt;memxor@gmail.com&gt;
    > Link: https://lore.kernel.org/r/20241212092050.3204165-2-memxor@gmail.com
    > Signed-off-by: Alexei Starovoitov &lt;ast@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ xfs: only run precommits once per transaction object (@Darrick J. Wong in [202f2350e6a060b](https://github.com/sophgo/linux-riscv/commit/202f2350e6a060b) at 2024-12-19 17:13:09)
    > commit 44d9b07e52db25035680713c3428016cadcd2ea1 upstream.
    > Committing a transaction tx0 with a defer ops chain of (A, B, C)
    > creates a chain of transactions that looks like this:
    > tx0 -&gt; txA -&gt; txB -&gt; txC
    > Prior to commit cb042117488dbf, __xfs_trans_commit would run precommits
    > on tx0, then call xfs_defer_finish_noroll to convert A-C to tx[A-C].
    > Unfortunately, after the finish_noroll loop we forgot to run precommits
    > on txC.  That was fixed by adding the second precommit call.
    > Unfortunately, none of us remembered that xfs_defer_finish_noroll
    > calls __xfs_trans_commit a second time to commit tx0 before finishing
    > work A in txA and committing that.  In other words, we run precommits
    > twice on tx0:
    > xfs_trans_commit(tx0)
    > __xfs_trans_commit(tx0, false)
    > xfs_trans_run_precommits(tx0)
    > xfs_defer_finish_noroll(tx0)
    > xfs_trans_roll(tx0)
    > txA &#x3D; xfs_trans_dup(tx0)
    > __xfs_trans_commit(tx0, true)
    > xfs_trans_run_precommits(tx0)
    > This currently isn&#x27;t an issue because the inode item precommit is
    > idempotent; the iunlink item precommit deletes itself so it can&#x27;t be
    > called again; and the buffer/dquot item precommits only check the incore
    > objects for corruption.  However, it doesn&#x27;t make sense to run
    > precommits twice.
    > Fix this situation by only running precommits after finish_noroll.
    > Cc: &lt;stable@vger.kernel.org&gt; # v6.4
    > Fixes: cb042117488dbf (&quot;xfs: defered work could create precommits&quot;)
    > Signed-off-by: &quot;Darrick J. Wong&quot; &lt;djwong@kernel.org&gt;
    > Reviewed-by: Christoph Hellwig &lt;hch@lst.de&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ xfs: set XFS_SICK_INO_SYMLINK_ZAPPED explicitly when zapping a symlink (@Darrick J. Wong in [9a741ed41242ca4](https://github.com/sophgo/linux-riscv/commit/9a741ed41242ca4) at 2024-12-19 17:13:08)
    > commit 6f4669708a69fd21f0299c2d5c4780a6ce358ab5 upstream.
    > If we need to reset a symlink target to the &quot;durr it&#x27;s busted&quot; string,
    > then we clear the zapped flag as well.  However, this should be using
    > the provided helper so that we don&#x27;t set the zapped state on an
    > otherwise ok symlink.
    > Cc: &lt;stable@vger.kernel.org&gt; # v6.10
    > Fixes: 2651923d8d8db0 (&quot;xfs: online repair of symbolic links&quot;)
    > Signed-off-by: &quot;Darrick J. Wong&quot; &lt;djwong@kernel.org&gt;
    > Reviewed-by: Christoph Hellwig &lt;hch@lst.de&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ xfs: update btree keys correctly when _insrec splits an inode root block (@Darrick J. Wong in [8fb661bfcb92355](https://github.com/sophgo/linux-riscv/commit/8fb661bfcb92355) at 2024-12-19 17:13:08)
    > commit 6d7b4bc1c3e00b1a25b7a05141a64337b4629337 upstream.
    > In commit 2c813ad66a72, I partially fixed a bug wherein xfs_btree_insrec
    > would erroneously try to update the parent&#x27;s key for a block that had
    > been split if we decided to insert the new record into the new block.
    > The solution was to detect this situation and update the in-core key
    > value that we pass up to the caller so that the caller will (eventually)
    > add the new block to the parent level of the tree with the correct key.
    > However, I missed a subtlety about the way inode-rooted btrees work.  If
    > the full block was a maximally sized inode root block, we&#x27;ll solve that
    > fullness by moving the root block&#x27;s records to a new block, resizing the
    > root block, and updating the root to point to the new block.  We don&#x27;t
    > pass a pointer to the new block to the caller because that work has
    > already been done.  The new record will /always/ land in the new block,
    > so in this case we need to use xfs_btree_update_keys to update the keys.
    > This bug can theoretically manifest itself in the very rare case that we
    > split a bmbt root block and the new record lands in the very first slot
    > of the new block, though I&#x27;ve never managed to trigger it in practice.
    > However, it is very easy to reproduce by running generic/522 with the
    > realtime rmapbt patchset if rtinherit&#x3D;1.
    > Cc: &lt;stable@vger.kernel.org&gt; # v4.8
    > Fixes: 2c813ad66a7218 (&quot;xfs: support btrees with overlapping intervals for keys&quot;)
    > Signed-off-by: &quot;Darrick J. Wong&quot; &lt;djwong@kernel.org&gt;
    > Reviewed-by: Christoph Hellwig &lt;hch@lst.de&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ xfs: fix scrub tracepoints when inode-rooted btrees are involved (@Darrick J. Wong in [704d5733bf3977c](https://github.com/sophgo/linux-riscv/commit/704d5733bf3977c) at 2024-12-19 17:13:08)
    > commit ffc3ea4f3c1cc83a86b7497b0c4b0aee7de5480d upstream.
    > Fix a minor mistakes in the scrub tracepoints that can manifest when
    > inode-rooted btrees are enabled.  The existing code worked fine for bmap
    > btrees, but we should tighten the code up to be less sloppy.
    > Cc: &lt;stable@vger.kernel.org&gt; # v5.7
    > Fixes: 92219c292af8dd (&quot;xfs: convert btree cursor inode-private member names&quot;)
    > Signed-off-by: &quot;Darrick J. Wong&quot; &lt;djwong@kernel.org&gt;
    > Reviewed-by: Christoph Hellwig &lt;hch@lst.de&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ xfs: return a 64-bit block count from xfs_btree_count_blocks (@Darrick J. Wong in [3e2f62d1d773fc3](https://github.com/sophgo/linux-riscv/commit/3e2f62d1d773fc3) at 2024-12-19 17:13:08)
    > commit bd27c7bcdca25ce8067ebb94ded6ac1bd7b47317 upstream.
    > With the nrext64 feature enabled, it&#x27;s possible for a data fork to have
    > 2^48 extent mappings.  Even with a 64k fsblock size, that maps out to
    > a bmbt containing more than 2^32 blocks.  Therefore, this predicate must
    > return a u64 count to avoid an integer wraparound that will cause scrub
    > to do the wrong thing.
    > It&#x27;s unlikely that any such filesystem currently exists, because the
    > incore bmbt would consume more than 64GB of kernel memory on its own,
    > and so far nobody except me has driven a filesystem that far, judging
    > from the lack of complaints.
    > Cc: &lt;stable@vger.kernel.org&gt; # v5.19
    > Fixes: df9ad5cc7a5240 (&quot;xfs: Introduce macros to represent new maximum extent counts for data/attr forks&quot;)
    > Signed-off-by: &quot;Darrick J. Wong&quot; &lt;djwong@kernel.org&gt;
    > Reviewed-by: Christoph Hellwig &lt;hch@lst.de&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ xfs: fix null bno_hint handling in xfs_rtallocate_rtg (@Darrick J. Wong in [3b6616ffc99b82a](https://github.com/sophgo/linux-riscv/commit/3b6616ffc99b82a) at 2024-12-19 17:13:08)
    > commit af9f02457f461b23307fe826a37be61ba6e32c92 upstream.
    > xfs_bmap_rtalloc initializes the bno_hint variable to NULLRTBLOCK (aka
    > NULLFSBLOCK).  If the allocation request is for a file range that&#x27;s
    > adjacent to an existing mapping, it will then change bno_hint to the
    > blkno hint in the bmalloca structure.
    > In other words, bno_hint is either a rt block number, or it&#x27;s all 1s.
    > Unfortunately, commit ec12f97f1b8a8f didn&#x27;t take the NULLRTBLOCK state
    > into account, which means that it tries to translate that into a
    > realtime extent number.  We then end up with an obnoxiously high rtx
    > number and pointlessly feed that to the near allocator.  This often
    > fails and falls back to the by-size allocator.  Seeing as we had no
    > locality hint anyway, this is a waste of time.
    > Fix the code to detect a lack of bno_hint correctly.  This was detected
    > by running xfs/009 with metadir enabled and a 28k rt extent size.
    > Cc: &lt;stable@vger.kernel.org&gt; # v6.12
    > Fixes: ec12f97f1b8a8f (&quot;xfs: make the rtalloc start hint a xfs_rtblock_t&quot;)
    > Signed-off-by: &quot;Darrick J. Wong&quot; &lt;djwong@kernel.org&gt;
    > Reviewed-by: Christoph Hellwig &lt;hch@lst.de&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ xfs: don&#x27;t drop errno values when we fail to ficlone the entire range (@Darrick J. Wong in [31ecfd1d4f742a1](https://github.com/sophgo/linux-riscv/commit/31ecfd1d4f742a1) at 2024-12-19 17:13:08)
    > commit 7ce31f20a0771d71779c3b0ec9cdf474cc3c8e9a upstream.
    > Way back when we first implemented FICLONE for XFS, life was simple --
    > either the the entire remapping completed, or something happened and we
    > had to return an errno explaining what happened.  Neither of those
    > ioctls support returning partial results, so it&#x27;s all or nothing.
    > Then things got complicated when copy_file_range came along, because it
    > actually can return the number of bytes copied, so commit 3f68c1f562f1e4
    > tried to make it so that we could return a partial result if the
    > REMAP_FILE_CAN_SHORTEN flag is set.  This is also how FIDEDUPERANGE can
    > indicate that the kernel performed a partial deduplication.
    > Unfortunately, the logic is wrong if an error stops the remapping and
    > CAN_SHORTEN is not set.  Because those callers cannot return partial
    > results, it is an error for -&gt;remap_file_range to return a positive
    > quantity that is less than the @len passed in.  Implementations really
    > should be returning a negative errno in this case, because that&#x27;s what
    > btrfs (which introduced FICLONE{,RANGE}) did.
    > Therefore, -&gt;remap_range implementations cannot silently drop an errno
    > that they might have when the number of bytes remapped is less than the
    > number of bytes requested and CAN_SHORTEN is not set.
    > Found by running generic/562 on a 64k fsblock filesystem and wondering
    > why it reported corrupt files.
    > Cc: &lt;stable@vger.kernel.org&gt; # v4.20
    > Fixes: 3fc9f5e409319e (&quot;xfs: remove xfs_reflink_remap_range&quot;)
    > Really-Fixes: 3f68c1f562f1e4 (&quot;xfs: support returning partial reflink results&quot;)
    > Signed-off-by: &quot;Darrick J. Wong&quot; &lt;djwong@kernel.org&gt;
    > Reviewed-by: Christoph Hellwig &lt;hch@lst.de&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ xfs: return from xfs_symlink_verify early on V4 filesystems (@Darrick J. Wong in [181cb9643633b80](https://github.com/sophgo/linux-riscv/commit/181cb9643633b80) at 2024-12-19 17:13:08)
    > commit 7f8b718c58783f3ff0810b39e2f62f50ba2549f6 upstream.
    > V4 symlink blocks didn&#x27;t have headers, so return early if this is a V4
    > filesystem.
    > Cc: &lt;stable@vger.kernel.org&gt; # v5.1
    > Fixes: 39708c20ab5133 (&quot;xfs: miscellaneous verifier magic value fixups&quot;)
    > Signed-off-by: &quot;Darrick J. Wong&quot; &lt;djwong@kernel.org&gt;
    > Reviewed-by: Christoph Hellwig &lt;hch@lst.de&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ drm/amd/pm: Set SMU v13.0.7 default workload type (@Kenneth Feng in [bd882c3ca13e93e](https://github.com/sophgo/linux-riscv/commit/bd882c3ca13e93e) at 2024-12-19 17:13:07)
    > commit 3912a78cf72eb45f8153a395162b08fef9c5ec3d upstream.
    > Set the default workload type to bootup type on smu v13.0.7.
    > This is because of the constraint on smu v13.0.7.
    > Gfx activity has an even higher set point on 3D fullscreen
    > mode than the one on bootup mode. This causes the 3D fullscreen
    > mode&#x27;s performance is worse than the bootup mode&#x27;s performance
    > for the lightweighted/medium workload. For the high workload,
    > the performance is the same between 3D fullscreen mode and bootup
    > mode.
    > v2: set the default workload in ASIC specific file
    > Signed-off-by: Kenneth Feng &lt;kenneth.feng@amd.com&gt;
    > Reviewed-by: Yang Wang &lt;kevinyang.wang@amd.com&gt;
    > Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Cc: stable@vger.kernel.org # 6.11.x
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ drm/amdkfd: Dereference null return value (@Andrew Martin in [768442d918932c4](https://github.com/sophgo/linux-riscv/commit/768442d918932c4) at 2024-12-19 17:13:07)
    > commit a592bb19abdc2072875c87da606461bfd7821b08 upstream.
    > In the function pqm_uninit there is a call-assignment of &quot;pdd &#x3D;
    > kfd_get_process_device_data&quot; which could be null, and this value was
    > later dereferenced without checking.
    > Fixes: fb91065851cd (&quot;drm/amdkfd: Refactor queue wptr_bo GART mapping&quot;)
    > Signed-off-by: Andrew Martin &lt;Andrew.Martin@amd.com&gt;
    > Reviewed-by: Felix Kuehling &lt;felix.kuehling@amd.com&gt;
    > Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ drm/amdgpu: fix UVD contiguous CS mapping problem (@Christian König in [6c4102522abf040](https://github.com/sophgo/linux-riscv/commit/6c4102522abf040) at 2024-12-19 17:13:07)
    > commit 12f325bcd2411e571dbb500bf6862c812c479735 upstream.
    > When starting the mpv player, Radeon R9 users are observing
    > the below error in dmesg.
    > [drm:amdgpu_uvd_cs_pass2 [amdgpu]]
    > ERROR* msg/fb buffer ff00f7c000-ff00f7e000 out of 256MB segment!
    > The patch tries to set the TTM_PL_FLAG_CONTIGUOUS for both user
    > flag(AMDGPU_GEM_CREATE_VRAM_CONTIGUOUS) set and not set cases.
    > v2: Make the TTM_PL_FLAG_CONTIGUOUS mandatory for user BO&#x27;s.
    > v3: revert back to v1, but fix the check instead (chk).
    > Closes:https://gitlab.freedesktop.org/drm/amd/-/issues/3599
    > Closes:https://gitlab.freedesktop.org/drm/amd/-/issues/3501
    > Signed-off-by: Arunpravin Paneer Selvam &lt;Arunpravin.PaneerSelvam@amd.com&gt;
    > Signed-off-by: Christian König &lt;christian.koenig@amd.com&gt;
    > Reviewed-by: Arunpravin Paneer Selvam &lt;Arunpravin.PaneerSelvam@amd.com&gt;
    > Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Cc: stable@vger.kernel.org # 6.10+
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ drm/amdgpu: fix when the cleaner shader is emitted (@Christian König in [5a6bd9350424fcb](https://github.com/sophgo/linux-riscv/commit/5a6bd9350424fcb) at 2024-12-19 17:13:07)
    > commit f4df208177d02f1c90f3644da3a2453080b8c24f upstream.
    > Emitting the cleaner shader must come after the check if a VM switch is
    > necessary or not.
    > Otherwise we will emit the cleaner shader every time and not just when it is
    > necessary because we switched between applications.
    > This can otherwise crash on gang submit and probably decreases performance
    > quite a bit.
    > v2: squash in fix from Srini (Alex)
    > Signed-off-by: Christian König &lt;christian.koenig@amd.com&gt;
    > Fixes: ee7a846ea27b (&quot;drm/amdgpu: Emit cleaner shader at end of IB submission&quot;)
    > Acked-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ drm/amdkfd: hard-code MALL cacheline size for gfx11, gfx12 (@Harish Kasiviswanathan in [2d981e170fb2528](https://github.com/sophgo/linux-riscv/commit/2d981e170fb2528) at 2024-12-19 17:13:07)
    > commit d50bf3f0fab636574c163ba8b5863e12b1ed19bd upstream.
    > This information is not available in ip discovery table.
    > Signed-off-by: Harish Kasiviswanathan &lt;Harish.Kasiviswanathan@amd.com&gt;
    > Reviewed-by: David Belanger &lt;david.belanger@amd.com&gt;
    > Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ drm/amdkfd: hard-code cacheline size for gfx11 (@Harish Kasiviswanathan in [01bdb31fc5aac3a](https://github.com/sophgo/linux-riscv/commit/01bdb31fc5aac3a) at 2024-12-19 17:13:07)
    > commit 321048c4a3e375416b51b4093978f9ce2aa4d391 upstream.
    > This information is not available in ip discovery table.
    > Signed-off-by: Harish Kasiviswanathan &lt;Harish.Kasiviswanathan@amd.com&gt;
    > Reviewed-by: David Belanger &lt;david.belanger@amd.com&gt;
    > Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ iommu/vt-d: Fix qi_batch NULL pointer with nested parent domain (@Yi Liu in [ffd774c34774fd4](https://github.com/sophgo/linux-riscv/commit/ffd774c34774fd4) at 2024-12-19 17:13:06)
    > commit 74536f91962d5f6af0a42414773ce61e653c10ee upstream.
    > The qi_batch is allocated when assigning cache tag for a domain. While
    > for nested parent domain, it is missed. Hence, when trying to map pages
    > to the nested parent, NULL dereference occurred. Also, there is potential
    > memleak since there is no lock around domain-&gt;qi_batch allocation.
    > To solve it, add a helper for qi_batch allocation, and call it in both
    > the __cache_tag_assign_domain() and __cache_tag_assign_parent_domain().
    > BUG: kernel NULL pointer dereference, address: 0000000000000200
    > #PF: supervisor read access in kernel mode
    > #PF: error_code(0x0000) - not-present page
    > PGD 8104795067 P4D 0
    > Oops: Oops: 0000 [#1] PREEMPT SMP NOPTI
    > CPU: 223 UID: 0 PID: 4357 Comm: qemu-system-x86 Not tainted 6.13.0-rc1-00028-g4b50c3c3b998-dirty #2632
    > Call Trace:
    > ? __die+0x24/0x70
    > ? page_fault_oops+0x80/0x150
    > ? do_user_addr_fault+0x63/0x7b0
    > ? exc_page_fault+0x7c/0x220
    > ? asm_exc_page_fault+0x26/0x30
    > ? cache_tag_flush_range_np+0x13c/0x260
    > intel_iommu_iotlb_sync_map+0x1a/0x30
    > iommu_map+0x61/0xf0
    > batch_to_domain+0x188/0x250
    > iopt_area_fill_domains+0x125/0x320
    > ? rcu_is_watching+0x11/0x50
    > iopt_map_pages+0x63/0x100
    > iopt_map_common.isra.0+0xa7/0x190
    > iopt_map_user_pages+0x6a/0x80
    > iommufd_ioas_map+0xcd/0x1d0
    > iommufd_fops_ioctl+0x118/0x1c0
    > __x64_sys_ioctl+0x93/0xc0
    > do_syscall_64+0x71/0x140
    > entry_SYSCALL_64_after_hwframe+0x76/0x7e
    > Fixes: 705c1cdf1e73 (&quot;iommu/vt-d: Introduce batched cache invalidation&quot;)
    > Cc: stable@vger.kernel.org
    > Co-developed-by: Lu Baolu &lt;baolu.lu@linux.intel.com&gt;
    > Signed-off-by: Lu Baolu &lt;baolu.lu@linux.intel.com&gt;
    > Signed-off-by: Yi Liu &lt;yi.l.liu@intel.com&gt;
    > Reviewed-by: Kevin Tian &lt;kevin.tian@intel.com&gt;
    > Link: https://lore.kernel.org/r/20241210130322.17175-1-yi.l.liu@intel.com
    > Signed-off-by: Joerg Roedel &lt;jroedel@suse.de&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ drm/i915: Fix NULL pointer dereference in capture_engine (@Eugene Kobyak in [e6ebe4f14a267bc](https://github.com/sophgo/linux-riscv/commit/e6ebe4f14a267bc) at 2024-12-19 17:13:06)
    > commit da0b986256ae9a78b0215214ff44f271bfe237c1 upstream.
    > When the intel_context structure contains NULL,
    > it raises a NULL pointer dereference error in drm_info().
    > Fixes: e8a3319c31a1 (&quot;drm/i915: Allow error capture without a request&quot;)
    > Closes: https://gitlab.freedesktop.org/drm/i915/kernel/-/issues/12309
    > Reviewed-by: Andi Shyti &lt;andi.shyti@linux.intel.com&gt;
    > Cc: John Harrison &lt;John.C.Harrison@Intel.com&gt;
    > Cc: &lt;stable@vger.kernel.org&gt; # v6.3+
    > Signed-off-by: Eugene Kobyak &lt;eugene.kobyak@intel.com&gt;
    > Signed-off-by: Andi Shyti &lt;andi.shyti@linux.intel.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/xmsgfynkhycw3cf56akp4he2ffg44vuratocsysaowbsnhutzi@augnqbm777at
    > (cherry picked from commit 754302a5bc1bd8fd3b7d85c168b0a1af6d4bba4d)
    > Signed-off-by: Tvrtko Ursulin &lt;tursulin@ursulin.net&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ drm/amdkfd: pause autosuspend when creating pdd (@Jesse.zhang@amd.com in [bfb6f5ea906b847](https://github.com/sophgo/linux-riscv/commit/bfb6f5ea906b847) at 2024-12-19 17:13:06)
    > commit 438b39ac74e2a9dc0a5c9d653b7d8066877e86b1 upstream.
    > When using MES creating a pdd will require talking to the GPU to
    > setup the relevant context. The code here forgot to wake up the GPU
    > in case it was in suspend, this causes KVM to EFAULT for passthrough
    > GPU for example. This issue can be masked if the GPU was woken up by
    > other things (e.g. opening the KMS node) first and have not yet gone to sleep.
    > v4: do the allocation of proc_ctx_bo in a lazy fashion
    > when the first queue is created in a process (Felix)
    > Signed-off-by: Jesse Zhang &lt;jesse.zhang@amd.com&gt;
    > Reviewed-by: Yunxiang Li &lt;Yunxiang.Li@amd.com&gt;
    > Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ drm/i915: Fix memory leak by correcting cache object name in error handler (@Jiasheng Jiang in [b9dd95dc5eec2ed](https://github.com/sophgo/linux-riscv/commit/b9dd95dc5eec2ed) at 2024-12-19 17:13:06)
    > commit 2828e5808bcd5aae7fdcd169cac1efa2701fa2dd upstream.
    > Replace &quot;slab_priorities&quot; with &quot;slab_dependencies&quot; in the error handler
    > to avoid memory leak.
    > Fixes: 32eb6bcfdda9 (&quot;drm/i915: Make request allocation caches global&quot;)
    > Cc: &lt;stable@vger.kernel.org&gt; # v5.2+
    > Signed-off-by: Jiasheng Jiang &lt;jiashengjiangcool@outlook.com&gt;
    > Reviewed-by: Nirmoy Das &lt;nirmoy.das@intel.com&gt;
    > Reviewed-by: Andi Shyti &lt;andi.shyti@linux.intel.com&gt;
    > Signed-off-by: Andi Shyti &lt;andi.shyti@linux.intel.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20241127201042.29620-1-jiashengjiangcool@gmail.com
    > (cherry picked from commit 9bc5e7dc694d3112bbf0fa4c46ef0fa0f114937a)
    > Signed-off-by: Tvrtko Ursulin &lt;tursulin@ursulin.net&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ iommu/vt-d: Remove cache tags before disabling ATS (@Lu Baolu in [9a0a72d3ed919eb](https://github.com/sophgo/linux-riscv/commit/9a0a72d3ed919eb) at 2024-12-19 17:13:06)
    > commit 1f2557e08a617a4b5e92a48a1a9a6f86621def18 upstream.
    > The current implementation removes cache tags after disabling ATS,
    > leading to potential memory leaks and kernel crashes. Specifically,
    > CACHE_TAG_DEVTLB type cache tags may still remain in the list even
    > after the domain is freed, causing a use-after-free condition.
    > This issue really shows up when multiple VFs from different PFs
    > passed through to a single user-space process via vfio-pci. In such
    > cases, the kernel may crash with kernel messages like:
    > BUG: kernel NULL pointer dereference, address: 0000000000000014
    > PGD 19036a067 P4D 1940a3067 PUD 136c9b067 PMD 0
    > Oops: Oops: 0000 [#1] PREEMPT SMP NOPTI
    > CPU: 74 UID: 0 PID: 3183 Comm: testCli Not tainted 6.11.9 #2
    > RIP: 0010:cache_tag_flush_range+0x9b/0x250
    > Call Trace:
    > &lt;TASK&gt;
    > ? __die+0x1f/0x60
    > ? page_fault_oops+0x163/0x590
    > ? exc_page_fault+0x72/0x190
    > ? asm_exc_page_fault+0x22/0x30
    > ? cache_tag_flush_range+0x9b/0x250
    > ? cache_tag_flush_range+0x5d/0x250
    > intel_iommu_tlb_sync+0x29/0x40
    > intel_iommu_unmap_pages+0xfe/0x160
    > __iommu_unmap+0xd8/0x1a0
    > vfio_unmap_unpin+0x182/0x340 [vfio_iommu_type1]
    > vfio_remove_dma+0x2a/0xb0 [vfio_iommu_type1]
    > vfio_iommu_type1_ioctl+0xafa/0x18e0 [vfio_iommu_type1]
    > Move cache_tag_unassign_domain() before iommu_disable_pci_caps() to fix
    > it.
    > Fixes: 3b1d9e2b2d68 (&quot;iommu/vt-d: Add cache tag assignment interface&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Lu Baolu &lt;baolu.lu@linux.intel.com&gt;
    > Reviewed-by: Kevin Tian &lt;kevin.tian@intel.com&gt;
    > Link: https://lore.kernel.org/r/20241129020506.576413-1-baolu.lu@linux.intel.com
    > Signed-off-by: Joerg Roedel &lt;jroedel@suse.de&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ drm/i915/color: Stop using non-posted DSB writes for legacy LUT (@Ville Syrjälä in [8ce157e38f4a092](https://github.com/sophgo/linux-riscv/commit/8ce157e38f4a092) at 2024-12-19 17:13:06)
    > commit cd3da567e2e46b8f75549637b960a83b024d6b6e upstream.
    > DSB LUT register writes vs. palette anti-collision logic
    > appear to interact in interesting ways:
    > - posted DSB writes simply vanish into thin air while
    > anti-collision is active
    > - non-posted DSB writes actually get blocked by the anti-collision
    > logic, but unfortunately this ends up hogging the bus for
    > long enough that unrelated parallel CPU MMIO accesses start
    > to disappear instead
    > Even though we are updating the LUT during vblank we aren&#x27;t
    > immune to the anti-collision logic because it kicks in briefly
    > for pipe prefill (initiated at frame start). The safe time
    > window for performing the LUT update is thus between the
    > undelayed vblank and frame start. Turns out that with low
    > enough CDCLK frequency (DSB execution speed depends on CDCLK)
    > we can exceed that.
    > As we are currently using non-posted writes for the legacy LUT
    > updates, in which case we can hit the far more severe failure
    > mode. The problem is exacerbated by the fact that non-posted
    > writes are much slower than posted writes (~4x it seems).
    > To mititage the problem let&#x27;s switch to using posted DSB
    > writes for legacy LUT updates (which will involve using the
    > double write approach to avoid other problems with DSB
    > vs. legacy LUT writes). Despite writing each register twice
    > this will in fact make the legacy LUT update faster when
    > compared to the non-posted write approach, making the
    > problem less likely to appear. The failure mode is also
    > less severe.
    > This isn&#x27;t the 100% solution we need though. That will involve
    > estimating how long the LUT update will take, and pushing
    > frame start and/or delayed vblank forward to guarantee that
    > the update will have finished by the time the pipe prefill
    > starts...
    > Cc: stable@vger.kernel.org
    > Fixes: 34d8311f4a1c (&quot;drm/i915/dsb: Re-instate DSB for LUT updates&quot;)
    > Fixes: 25ea3411bd23 (&quot;drm/i915/dsb: Use non-posted register writes for legacy LUT&quot;)
    > Closes: https://gitlab.freedesktop.org/drm/i915/kernel/-/issues/12494
    > Signed-off-by: Ville Syrjälä &lt;ville.syrjala@linux.intel.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20241120164123.12706-3-ville.syrjala@linux.intel.com
    > Reviewed-by: Uma Shankar &lt;uma.shankar@intel.com&gt;
    > (cherry picked from commit 2504a316b35d49522f39cf0dc01830d7c36a9be4)
    > Signed-off-by: Tvrtko Ursulin &lt;tursulin@ursulin.net&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ drm/xe: Call invalidation_fence_fini for PT inval fences in error state (@Daniele Ceraolo Spurio in [840527f4a818372](https://github.com/sophgo/linux-riscv/commit/840527f4a818372) at 2024-12-19 17:13:06)
    > commit cefade70f346160f47cc24776160329e2ee63653 upstream.
    > Invalidation_fence_init takes a PM reference, which is released in its
    > _fini counterpart, so we need to make sure that the latter is called,
    > even if the fence is in an error state.
    > Since we already have a function that calls _fini() and signals the
    > fence in the tlb inval code, we can expose that and call it from the PT
    > code.
    > Fixes: f002702290fc (&quot;drm/xe: Hold a PM ref when GT TLB invalidations are inflight&quot;)
    > Signed-off-by: Daniele Ceraolo Spurio &lt;daniele.ceraolospurio@intel.com&gt;
    > Cc: &lt;stable@vger.kernel.org&gt; # v6.11+
    > Cc: Matthew Brost &lt;matthew.brost@intel.com&gt;
    > Cc: Nirmoy Das &lt;nirmoy.das@intel.com&gt;
    > Cc: Rodrigo Vivi &lt;rodrigo.vivi@intel.com&gt;
    > Reviewed-by: Nirmoy Das &lt;nirmoy.das@intel.com&gt;
    > Reviewed-by: Matthew Brost &lt;matthew.brost@intel.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20241206015022.1567113-1-daniele.ceraolospurio@intel.com
    > (cherry picked from commit 65338639b79ce88aef5263cd518cde570a3c7c8e)
    > Signed-off-by: Thomas Hellström &lt;thomas.hellstrom@linux.intel.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ usb: typec: anx7411: fix fwnode_handle reference leak (@Joe Hattori in [f4911ecc0034b0f](https://github.com/sophgo/linux-riscv/commit/f4911ecc0034b0f) at 2024-12-19 17:13:05)
    > commit 645d56e4cc74e953284809d096532c1955918a28 upstream.
    > An fwnode_handle and usb_role_switch are obtained with an incremented
    > refcount in anx7411_typec_port_probe(), however the refcounts are not
    > decremented in the error path. The fwnode_handle is also not decremented
    > in the .remove() function. Therefore, call fwnode_handle_put() and
    > usb_role_switch_put() accordingly.
    > Fixes: fe6d8a9c8e64 (&quot;usb: typec: anx7411: Add Analogix PD ANX7411 support&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Joe Hattori &lt;joe@pf.is.s.u-tokyo.ac.jp&gt;
    > Reviewed-by: Heikki Krogerus &lt;heikki.krogerus@linux.intel.com&gt;
    > Link: https://lore.kernel.org/r/20241121023429.962848-1-joe@pf.is.s.u-tokyo.ac.jp
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ usb: gadget: u_serial: Fix the issue that gs_start_io crashed due to accessing null pointer (@Lianqin Hu in [dd6b0ca6025f64c](https://github.com/sophgo/linux-riscv/commit/dd6b0ca6025f64c) at 2024-12-19 17:13:05)
    > commit 4cfbca86f6a8b801f3254e0e3c8f2b1d2d64be2b upstream.
    > Considering that in some extreme cases,
    > when u_serial driver is accessed by multiple threads,
    > Thread A is executing the open operation and calling the gs_open,
    > Thread B is executing the disconnect operation and calling the
    > gserial_disconnect function,The port-&gt;port_usb pointer will be set to NULL.
    > E.g.
    > Thread A                                 Thread B
    > gs_open()                                gadget_unbind_driver()
    > gs_start_io()                            composite_disconnect()
    > gs_start_rx()                            gserial_disconnect()
    > ...                                      ...
    > spin_unlock(&amp;port-&gt;port_lock)
    > status &#x3D; usb_ep_queue()                  spin_lock(&amp;port-&gt;port_lock)
    > spin_lock(&amp;port-&gt;port_lock)              port-&gt;port_usb &#x3D; NULL
    > gs_free_requests(port-&gt;port_usb-&gt;in)     spin_unlock(&amp;port-&gt;port_lock)
    > Crash
    > This causes thread A to access a null pointer (port-&gt;port_usb is null)
    > when calling the gs_free_requests function, causing a crash.
    > If port_usb is NULL, the release request will be skipped as it
    > will be done by gserial_disconnect.
    > So add a null pointer check to gs_start_io before attempting
    > to access the value of the pointer port-&gt;port_usb.
    > Call trace:
    > gs_start_io+0x164/0x25c
    > gs_open+0x108/0x13c
    > tty_open+0x314/0x638
    > chrdev_open+0x1b8/0x258
    > do_dentry_open+0x2c4/0x700
    > vfs_open+0x2c/0x3c
    > path_openat+0xa64/0xc60
    > do_filp_open+0xb8/0x164
    > do_sys_openat2+0x84/0xf0
    > __arm64_sys_openat+0x70/0x9c
    > invoke_syscall+0x58/0x114
    > el0_svc_common+0x80/0xe0
    > do_el0_svc+0x1c/0x28
    > el0_svc+0x38/0x68
    > Fixes: c1dca562be8a (&quot;usb gadget: split out serial core&quot;)
    > Cc: stable@vger.kernel.org
    > Suggested-by: Prashanth K &lt;quic_prashk@quicinc.com&gt;
    > Signed-off-by: Lianqin Hu &lt;hulianqin@vivo.com&gt;
    > Acked-by: Prashanth K &lt;quic_prashk@quicinc.com&gt;
    > Link: https://lore.kernel.org/r/TYUPR06MB62178DC3473F9E1A537DCD02D2362@TYUPR06MB6217.apcprd06.prod.outlook.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ usb: typec: ucsi: Fix completion notifications (@Łukasz Bartosik in [d32babf3feea356](https://github.com/sophgo/linux-riscv/commit/d32babf3feea356) at 2024-12-19 17:13:05)
    > commit e37b383df91ba9bde9c6a31bf3ea9072561c5126 upstream.
    > OPM                         PPM                         LPM
    > |        1.send cmd         |                           |
    > |--------------------------&gt;|                           |
    > |                           |--                         |
    > |                           |  | 2.set busy bit in CCI  |
    > |                           |&lt;-                         |
    > |      3.notify the OPM     |                           |
    > |&lt;--------------------------|                           |
    > |                           | 4.send cmd to be executed |
    > |                           |--------------------------&gt;|
    > |                           |                           |
    > |                           |      5.cmd completed      |
    > |                           |&lt;--------------------------|
    > |                           |                           |
    > |                           |--                         |
    > |                           |  | 6.set cmd completed    |
    > |                           |&lt;-       bit in CCI        |
    > |                           |                           |
    > |     7.notify the OPM      |                           |
    > |&lt;--------------------------|                           |
    > |                           |                           |
    > |   8.handle notification   |                           |
    > |   from point 3, read CCI  |                           |
    > |&lt;--------------------------|                           |
    > |                           |                           |
    > When the PPM receives command from the OPM (p.1) it sets the busy bit
    > in the CCI (p.2), sends notification to the OPM (p.3) and forwards the
    > command to be executed by the LPM (p.4). When the PPM receives command
    > completion from the LPM (p.5) it sets command completion bit in the CCI
    > (p.6) and sends notification to the OPM (p.7). If command execution by
    > the LPM is fast enough then when the OPM starts handling the notification
    > from p.3 in p.8 and reads the CCI value it will see command completion bit
    > set and will call complete(). Then complete() might be called again when
    > the OPM handles notification from p.7.
    > This fix replaces test_bit() with test_and_clear_bit()
    > in ucsi_notify_common() in order to call complete() only
    > once per request.
    > This fix also reinitializes completion variable in
    > ucsi_sync_control_common() before a command is sent.
    > Fixes: 584e8df58942 (&quot;usb: typec: ucsi: extract common code for command handling&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Łukasz Bartosik &lt;ukaszb@chromium.org&gt;
    > Reviewed-by: Dmitry Baryshkov &lt;dmitry.baryshkov@linaro.org&gt;
    > Reviewed-by: Heikki Krogerus &lt;heikki.krogerus@linux.intel.com&gt;
    > Reviewed-by: Benson Leung &lt;bleung@chromium.org&gt;
    > Link: https://lore.kernel.org/r/20241203102318.3386345-1-ukaszb@chromium.org
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ usb: dwc3: imx8mp: fix software node kernel dump (@Xu Yang in [b089cdb7e1992dc](https://github.com/sophgo/linux-riscv/commit/b089cdb7e1992dc) at 2024-12-19 17:13:05)
    > commit a4faee01179a4d9cbad9ba6be2da8637c68c1438 upstream.
    > When unbind and bind the device again, kernel will dump below warning:
    > [  173.972130] sysfs: cannot create duplicate filename &#x27;/devices/platform/soc/4c010010.usb/software_node&#x27;
    > [  173.981564] CPU: 2 UID: 0 PID: 536 Comm: sh Not tainted 6.12.0-rc6-06344-g2aed7c4a5c56 #144
    > [  173.989923] Hardware name: NXP i.MX95 15X15 board (DT)
    > [  173.995062] Call trace:
    > [  173.997509]  dump_backtrace+0x90/0xe8
    > [  174.001196]  show_stack+0x18/0x24
    > [  174.004524]  dump_stack_lvl+0x74/0x8c
    > [  174.008198]  dump_stack+0x18/0x24
    > [  174.011526]  sysfs_warn_dup+0x64/0x80
    > [  174.015201]  sysfs_do_create_link_sd+0xf0/0xf8
    > [  174.019656]  sysfs_create_link+0x20/0x40
    > [  174.023590]  software_node_notify+0x90/0x100
    > [  174.027872]  device_create_managed_software_node+0xec/0x108
    > ...
    > The &#x27;4c010010.usb&#x27; device is a platform device created during the initcall
    > and is never removed, which causes its associated software node to persist
    > indefinitely.
    > The existing device_create_managed_software_node() does not provide a
    > corresponding removal function.
    > Replace device_create_managed_software_node() with the
    > device_add_software_node() and device_remove_software_node() pair to ensure
    > proper addition and removal of software nodes, addressing this issue.
    > Fixes: a9400f1979a0 (&quot;usb: dwc3: imx8mp: add 2 software managed quirk properties for host mode&quot;)
    > Cc: stable@vger.kernel.org
    > Reviewed-by: Frank Li &lt;Frank.Li@nxp.com&gt;
    > Signed-off-by: Xu Yang &lt;xu.yang_2@nxp.com&gt;
    > Acked-by: Thinh Nguyen &lt;Thinh.Nguyen@synopsys.com&gt;
    > Link: https://lore.kernel.org/r/20241126032841.2458338-1-xu.yang_2@nxp.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ usb: dwc3: xilinx: make sure pipe clock is deselected in usb2 only mode (@Neal Frager in [9e77eb481ba6958](https://github.com/sophgo/linux-riscv/commit/9e77eb481ba6958) at 2024-12-19 17:13:05)
    > commit a48f744bef9ee74814a9eccb030b02223e48c76c upstream.
    > When the USB3 PHY is not defined in the Linux device tree, there could
    > still be a case where there is a USB3 PHY active on the board and enabled
    > by the first stage bootloader. If serdes clock is being used then the USB
    > will fail to enumerate devices in 2.0 only mode.
    > To solve this, make sure that the PIPE clock is deselected whenever the
    > USB3 PHY is not defined and guarantees that the USB2 only mode will work
    > in all cases.
    > Fixes: 9678f3361afc (&quot;usb: dwc3: xilinx: Skip resets and USB3 register settings for USB2.0 mode&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Neal Frager &lt;neal.frager@amd.com&gt;
    > Signed-off-by: Radhey Shyam Pandey &lt;radhey.shyam.pandey@amd.com&gt;
    > Acked-by: Peter Korsgaard &lt;peter@korsgaard.com&gt;
    > Link: https://lore.kernel.org/r/1733163111-1414816-1-git-send-email-radhey.shyam.pandey@amd.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ usb: typec: anx7411: fix OF node reference leaks in anx7411_typec_switch_probe() (@Joe Hattori in [7737279ce67ce0e](https://github.com/sophgo/linux-riscv/commit/7737279ce67ce0e) at 2024-12-19 17:13:05)
    > commit ef42b906df5c57d0719b69419df9dfd25f25c161 upstream.
    > The refcounts of the OF nodes obtained by of_get_child_by_name() calls
    > in anx7411_typec_switch_probe() are not decremented. Replace them with
    > device_get_named_child_node() calls and store the return values to the
    > newly created fwnode_handle fields in anx7411_data, and call
    > fwnode_handle_put() on them in the error path and in the unregister
    > functions.
    > Fixes: e45d7337dc0e (&quot;usb: typec: anx7411: Use of_get_child_by_name() instead of of_find_node_by_name()&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Joe Hattori &lt;joe@pf.is.s.u-tokyo.ac.jp&gt;
    > Reviewed-by: Heikki Krogerus &lt;heikki.krogerus@linux.intel.com&gt;
    > Link: https://lore.kernel.org/r/20241126014909.3687917-1-joe@pf.is.s.u-tokyo.ac.jp
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ iommu/tegra241-cmdqv: do not use smp_processor_id in preemptible context (@Luis Claudio R. Goncalves in [568e3a7546f66f5](https://github.com/sophgo/linux-riscv/commit/568e3a7546f66f5) at 2024-12-19 17:13:05)
    > commit 1f806218164d1bb93f3db21eaf61254b08acdf03 upstream.
    > During boot some of the calls to tegra241_cmdqv_get_cmdq() will happen
    > in preemptible context. As this function calls smp_processor_id(), if
    > CONFIG_DEBUG_PREEMPT is enabled, these calls will trigger a series of
    > &quot;BUG: using smp_processor_id() in preemptible&quot; backtraces.
    > As tegra241_cmdqv_get_cmdq() only calls smp_processor_id() to use the
    > CPU number as a factor to balance out traffic on cmdq usage, it is safe
    > to use raw_smp_processor_id() here.
    > Cc: &lt;stable@vger.kernel.org&gt;
    > Fixes: 918eb5c856f6 (&quot;iommu/arm-smmu-v3: Add in-kernel support for NVIDIA Tegra241 (Grace) CMDQV&quot;)
    > Signed-off-by: Luis Claudio R. Goncalves &lt;lgoncalv@redhat.com&gt;
    > Reviewed-by: Jason Gunthorpe &lt;jgg@nvidia.com&gt;
    > Reviewed-by: Nicolin Chen &lt;nicolinc@nvidia.com&gt;
    > Tested-by: Nicolin Chen &lt;nicolinc@nvidia.com&gt;
    > Link: https://lore.kernel.org/r/Z1L1mja3nXzsJ0Pk@uudg.org
    > Signed-off-by: Will Deacon &lt;will@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ usb: gadget: midi2: Fix interpretation of is_midi1 bits (@Takashi Iwai in [f73c42713523d6b](https://github.com/sophgo/linux-riscv/commit/f73c42713523d6b) at 2024-12-19 17:13:04)
    > commit 82937056967da052cbc04b4435c13db84192dc52 upstream.
    > The UMP Function Block info m1.0 field (represented by is_midi1 sysfs
    > entry) is an enumeration from 0 to 2, while the midi2 gadget driver
    > incorrectly copies it to the corresponding snd_ump_block_info.flags
    > bits as-is.  This made the wrong bit flags set when m1.0 &#x3D; 2.
    > This patch corrects the wrong interpretation of is_midi1 bits.
    > Fixes: 29ee7a4dddd5 (&quot;usb: gadget: midi2: Add configfs support&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Takashi Iwai &lt;tiwai@suse.de&gt;
    > Link: https://lore.kernel.org/r/20241127070213.8232-1-tiwai@suse.de
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ scsi: ufs: core: Update compl_time_stamp_local_clock after completing a cqe (@liuderong in [cab34b0c9da7ab8](https://github.com/sophgo/linux-riscv/commit/cab34b0c9da7ab8) at 2024-12-19 17:13:04)
    > commit f103396ae31851d00b561ff9f8a32a441953ff8b upstream.
    > lrbp-&gt;compl_time_stamp_local_clock is set to zero after sending a sqe
    > but it is not updated after completing a cqe.  Thus the printed
    > information in ufshcd_print_tr() will always be zero.
    > Update lrbp-&gt;cmpl_time_stamp_local_clock after completing a cqe.
    > Log sample:
    > ufshcd-qcom 1d84000.ufshc: UPIU[8] - issue time 8750227249 us
    > ufshcd-qcom 1d84000.ufshc: UPIU[8] - complete time 0 us
    > Fixes: c30d8d010b5e (&quot;scsi: ufs: core: Prepare for completion in MCQ&quot;)
    > Reviewed-by: Bean Huo &lt;beanhuo@micron.com&gt;
    > Reviewed-by: Peter Wang &lt;peter.wang@mediatek.com&gt;
    > Signed-off-by: liuderong &lt;liuderong@oppo.com&gt;
    > Link: https://lore.kernel.org/r/1733470182-220841-1-git-send-email-liuderong@oppo.com
    > Reviewed-by: Avri Altman &lt;avri.altman@wdc.com&gt;
    > Signed-off-by: Martin K. Petersen &lt;martin.petersen@oracle.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ usb: dwc2: Fix HCD port connection race (@Stefan Wahren in [681cdeb6dfd1f1e](https://github.com/sophgo/linux-riscv/commit/681cdeb6dfd1f1e) at 2024-12-19 17:13:04)
    > commit 1cf1bd88f129f3bd647fead4dca270a5894274bb upstream.
    > On Raspberry Pis without onboard USB hub frequent device reconnects
    > can trigger a interrupt storm after DWC2 entered host clock gating.
    > This is caused by a race between _dwc2_hcd_suspend() and the port
    > interrupt, which sets port_connect_status. The issue occurs if
    > port_connect_status is still 1, but there is no connection anymore:
    > usb 1-1: USB disconnect, device number 25
    > dwc2 3f980000.usb: _dwc2_hcd_suspend: port_connect_status: 1
    > dwc2 3f980000.usb: Entering host clock gating.
    > Disabling IRQ #66
    > irq 66: nobody cared (try booting with the &quot;irqpoll&quot; option)
    > CPU: 0 UID: 0 PID: 0 Comm: swapper/0 Not tainted 6.12.0-gc1bb81b13202-dirty #322
    > Hardware name: BCM2835
    > Call trace:
    > unwind_backtrace from show_stack+0x10/0x14
    > show_stack from dump_stack_lvl+0x50/0x64
    > dump_stack_lvl from __report_bad_irq+0x38/0xc0
    > __report_bad_irq from note_interrupt+0x2ac/0x2f4
    > note_interrupt from handle_irq_event+0x88/0x8c
    > handle_irq_event from handle_level_irq+0xb4/0x1ac
    > handle_level_irq from generic_handle_domain_irq+0x24/0x34
    > generic_handle_domain_irq from bcm2836_chained_handle_irq+0x24/0x28
    > bcm2836_chained_handle_irq from generic_handle_domain_irq+0x24/0x34
    > generic_handle_domain_irq from generic_handle_arch_irq+0x34/0x44
    > generic_handle_arch_irq from __irq_svc+0x88/0xb0
    > Exception stack(0xc1d01f20 to 0xc1d01f68)
    > 1f20: 0004ef3c 00000001 00000000 00000000 c1d09780 c1f6bb5c c1d04e54 c1c60ca8
    > 1f40: c1d04e94 00000000 00000000 c1d092a8 c1f6af20 c1d01f70 c1211b98 c1212f40
    > 1f60: 60000013 ffffffff
    > __irq_svc from default_idle_call+0x1c/0xb0
    > default_idle_call from do_idle+0x21c/0x284
    > do_idle from cpu_startup_entry+0x28/0x2c
    > cpu_startup_entry from kernel_init+0x0/0x12c
    > handlers:
    > [&lt;e3a25c00&gt;] dwc2_handle_common_intr
    > [&lt;58bf98a3&gt;] usb_hcd_irq
    > Disabling IRQ #66
    > So avoid this by reading the connection status directly.
    > Fixes: 113f86d0c302 (&quot;usb: dwc2: Update partial power down entering by system suspend&quot;)
    > Signed-off-by: Stefan Wahren &lt;wahrenst@gmx.net&gt;
    > Link: https://lore.kernel.org/r/20241202001631.75473-4-wahrenst@gmx.net
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ usb: dwc2: hcd: Fix GetPortStatus &amp; SetPortFeature (@Stefan Wahren in [5aae028263d9ff2](https://github.com/sophgo/linux-riscv/commit/5aae028263d9ff2) at 2024-12-19 17:13:04)
    > commit a8d3e4a734599c7d0f6735f8db8a812e503395dd upstream.
    > On Rasperry Pis without onboard USB hub the power cycle during
    > power connect init only disable the port but never enabled it again:
    > usb usb1-port1: attempt power cycle
    > The port relevant part in dwc2_hcd_hub_control() is skipped in case
    > port_connect_status &#x3D; 0 under the assumption the core is or will be soon
    > in device mode. But this assumption is wrong, because after ClearPortFeature
    > USB_PORT_FEAT_POWER the port_connect_status will also be 0 and
    > SetPortFeature (incl. USB_PORT_FEAT_POWER) will be a no-op.
    > Fix the behavior of dwc2_hcd_hub_control() by replacing the
    > port_connect_status check with dwc2_is_device_mode().
    > Link: https://github.com/raspberrypi/linux/issues/6247
    > Fixes: 7359d482eb4d (&quot;staging: HCD files for the DWC2 driver&quot;)
    > Signed-off-by: Stefan Wahren &lt;wahrenst@gmx.net&gt;
    > Link: https://lore.kernel.org/r/20241202001631.75473-3-wahrenst@gmx.net
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ usb: dwc2: Fix HCD resume (@Stefan Wahren in [54db591cb797193](https://github.com/sophgo/linux-riscv/commit/54db591cb797193) at 2024-12-19 17:13:04)
    > commit 336f72d3cbf5cc17df2947bbbd2ba6e2509f17e8 upstream.
    > The Raspberry Pi can suffer on interrupt storms on HCD resume. The dwc2
    > driver sometimes misses to enable HCD_FLAG_HW_ACCESSIBLE before re-enabling
    > the interrupts. This causes a situation where both handler ignore a incoming
    > port interrupt and force the upper layers to disable the dwc2 interrupt
    > line. This leaves the USB interface in a unusable state:
    > irq 66: nobody cared (try booting with the &quot;irqpoll&quot; option)
    > CPU: 0 PID: 0 Comm: swapper/0 Tainted: G W          6.10.0-rc3
    > Hardware name: BCM2835
    > Call trace:
    > unwind_backtrace from show_stack+0x10/0x14
    > show_stack from dump_stack_lvl+0x50/0x64
    > dump_stack_lvl from __report_bad_irq+0x38/0xc0
    > __report_bad_irq from note_interrupt+0x2ac/0x2f4
    > note_interrupt from handle_irq_event+0x88/0x8c
    > handle_irq_event from handle_level_irq+0xb4/0x1ac
    > handle_level_irq from generic_handle_domain_irq+0x24/0x34
    > generic_handle_domain_irq from bcm2836_chained_handle_irq+0x24/0x28
    > bcm2836_chained_handle_irq from generic_handle_domain_irq+0x24/0x34
    > generic_handle_domain_irq from generic_handle_arch_irq+0x34/0x44
    > generic_handle_arch_irq from __irq_svc+0x88/0xb0
    > Exception stack(0xc1b01f20 to 0xc1b01f68)
    > 1f20: 0005c0d4 00000001 00000000 00000000 c1b09780 c1d6b32c c1b04e54 c1a5eae8
    > 1f40: c1b04e90 00000000 00000000 00000000 c1d6a8a0 c1b01f70 c11d2da8 c11d4160
    > 1f60: 60000013 ffffffff
    > __irq_svc from default_idle_call+0x1c/0xb0
    > default_idle_call from do_idle+0x21c/0x284
    > do_idle from cpu_startup_entry+0x28/0x2c
    > cpu_startup_entry from kernel_init+0x0/0x12c
    > handlers:
    > [&lt;f539e0f4&gt;] dwc2_handle_common_intr
    > [&lt;75cd278b&gt;] usb_hcd_irq
    > Disabling IRQ #66
    > So enable the HCD_FLAG_HW_ACCESSIBLE flag in case there is a port
    > connection.
    > Fixes: c74c26f6e398 (&quot;usb: dwc2: Fix partial power down exiting by system resume&quot;)
    > Closes: https://lore.kernel.org/linux-usb/3fd0c2fb-4752-45b3-94eb-42352703e1fd@gmx.net/T/
    > Link: https://lore.kernel.org/all/5e8cbce0-3260-2971-484f-fc73a3b2bd28@synopsys.com/
    > Signed-off-by: Stefan Wahren &lt;wahrenst@gmx.net&gt;
    > Link: https://lore.kernel.org/r/20241202001631.75473-2-wahrenst@gmx.net
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ usb: ehci-hcd: fix call balance of clocks handling routines (@Vitalii Mordan in [0967e8e734b8d2d](https://github.com/sophgo/linux-riscv/commit/0967e8e734b8d2d) at 2024-12-19 17:13:04)
    > commit 97264eaaba0122a5b7e8ddd7bf4ff3ac57c2b170 upstream.
    > If the clocks priv-&gt;iclk and priv-&gt;fclk were not enabled in ehci_hcd_sh_probe,
    > they should not be disabled in any path.
    > Conversely, if they was enabled in ehci_hcd_sh_probe, they must be disabled
    > in all error paths to ensure proper cleanup.
    > Found by Linux Verification Center (linuxtesting.org) with Klever.
    > Fixes: 63c845522263 (&quot;usb: ehci-hcd: Add support for SuperH EHCI.&quot;)
    > Cc: stable@vger.kernel.org # ff30bd6a6618: sh: clk: Fix clk_enable() to return 0 on NULL clk
    > Signed-off-by: Vitalii Mordan &lt;mordan@ispras.ru&gt;
    > Reviewed-by: Alan Stern &lt;stern@rowland.harvard.edu&gt;
    > Link: https://lore.kernel.org/r/20241121114700.2100520-1-mordan@ispras.ru
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ gpio: graniterapids: Determine if GPIO pad can be used by driver (@Alan Borzeszkowski in [e1ae3051044064a](https://github.com/sophgo/linux-riscv/commit/e1ae3051044064a) at 2024-12-19 17:13:03)
    > commit 0588504d28dedde6789aec17a6ece6fa8e477725 upstream.
    > Add check of HOSTSW_MODE bit to determine if GPIO pad can be used by the
    > driver.
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Alan Borzeszkowski &lt;alan.borzeszkowski@linux.intel.com&gt;
    > Signed-off-by: Mika Westerberg &lt;mika.westerberg@linux.intel.com&gt;
    > Acked-by: Andy Shevchenko &lt;andy@kernel.org&gt;
    > Link: https://lore.kernel.org/r/20241204070415.1034449-6-mika.westerberg@linux.intel.com
    > Signed-off-by: Bartosz Golaszewski &lt;bartosz.golaszewski@linaro.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ gpio: graniterapids: Check if GPIO line can be used for IRQs (@Alan Borzeszkowski in [d7a7e501fb720e5](https://github.com/sophgo/linux-riscv/commit/d7a7e501fb720e5) at 2024-12-19 17:13:03)
    > commit c0ec4890d6454980c53c3cc164140115c4a671f2 upstream.
    > GPIO line can only be used as interrupt if its INTSEL register is
    > programmed by the BIOS.
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Alan Borzeszkowski &lt;alan.borzeszkowski@linux.intel.com&gt;
    > Signed-off-by: Mika Westerberg &lt;mika.westerberg@linux.intel.com&gt;
    > Acked-by: Andy Shevchenko &lt;andy@kernel.org&gt;
    > Link: https://lore.kernel.org/r/20241204070415.1034449-7-mika.westerberg@linux.intel.com
    > Signed-off-by: Bartosz Golaszewski &lt;bartosz.golaszewski@linaro.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ gpio: graniterapids: Fix invalid RXEVCFG register bitmask (@Shankar Bandal in [9e45c2eea3f71f2](https://github.com/sophgo/linux-riscv/commit/9e45c2eea3f71f2) at 2024-12-19 17:13:03)
    > commit 15636b00a055474033426b94b6372728b2163a1e upstream.
    > Correct RX Level/Edge Configuration register (RXEVCFG) bitmask.
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Shankar Bandal &lt;shankar.bandal@intel.com&gt;
    > Signed-off-by: Alan Borzeszkowski &lt;alan.borzeszkowski@linux.intel.com&gt;
    > Signed-off-by: Mika Westerberg &lt;mika.westerberg@linux.intel.com&gt;
    > Acked-by: Andy Shevchenko &lt;andy@kernel.org&gt;
    > Link: https://lore.kernel.org/r/20241204070415.1034449-5-mika.westerberg@linux.intel.com
    > Signed-off-by: Bartosz Golaszewski &lt;bartosz.golaszewski@linaro.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ gpio: graniterapids: Fix invalid GPI_IS register offset (@Shankar Bandal in [7247fa29c7bb5e3](https://github.com/sophgo/linux-riscv/commit/7247fa29c7bb5e3) at 2024-12-19 17:13:03)
    > commit 0fe329b55231cca489f9bed1db0e778d077fdaf9 upstream.
    > Update GPI Interrupt Status register offset to correct value.
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Shankar Bandal &lt;shankar.bandal@intel.com&gt;
    > Signed-off-by: Alan Borzeszkowski &lt;alan.borzeszkowski@linux.intel.com&gt;
    > Signed-off-by: Mika Westerberg &lt;mika.westerberg@linux.intel.com&gt;
    > Acked-by: Andy Shevchenko &lt;andy@kernel.org&gt;
    > Link: https://lore.kernel.org/r/20241204070415.1034449-4-mika.westerberg@linux.intel.com
    > Signed-off-by: Bartosz Golaszewski &lt;bartosz.golaszewski@linaro.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ bpf: Revert &quot;bpf: Mark raw_tp arguments with PTR_MAYBE_NULL&quot; (@Kumar Kartikeya Dwivedi in [5de70cdf42c18c7](https://github.com/sophgo/linux-riscv/commit/5de70cdf42c18c7) at 2024-12-19 17:13:03)
    > commit c00d738e1673ab801e1577e4e3c780ccf88b1a5b upstream.
    > This patch reverts commit
    > cb4158ce8ec8 (&quot;bpf: Mark raw_tp arguments with PTR_MAYBE_NULL&quot;). The
    > patch was well-intended and meant to be as a stop-gap fixing branch
    > prediction when the pointer may actually be NULL at runtime. Eventually,
    > it was supposed to be replaced by an automated script or compiler pass
    > detecting possibly NULL arguments and marking them accordingly.
    > However, it caused two main issues observed for production programs and
    > failed to preserve backwards compatibility. First, programs relied on
    > the verifier not exploring &#x3D;&#x3D; NULL branch when pointer is not NULL, thus
    > they started failing with a &#x27;dereference of scalar&#x27; error.  Next,
    > allowing raw_tp arguments to be modified surfaced the warning in the
    > verifier that warns against reg-&gt;off when PTR_MAYBE_NULL is set.
    > More information, context, and discusson on both problems is available
    > in [0]. Overall, this approach had several shortcomings, and the fixes
    > would further complicate the verifier&#x27;s logic, and the entire masking
    > scheme would have to be removed eventually anyway.
    > Hence, revert the patch in preparation of a better fix avoiding these
    > issues to replace this commit.
    > [0]: https://lore.kernel.org/bpf/20241206161053.809580-1-memxor@gmail.com
    > Reported-by: Manu Bretelle &lt;chantra@meta.com&gt;
    > Fixes: cb4158ce8ec8 (&quot;bpf: Mark raw_tp arguments with PTR_MAYBE_NULL&quot;)
    > Signed-off-by: Kumar Kartikeya Dwivedi &lt;memxor@gmail.com&gt;
    > Link: https://lore.kernel.org/r/20241213221929.3495062-2-memxor@gmail.com
    > Signed-off-by: Alexei Starovoitov &lt;ast@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ usb: core: hcd: only check primary hcd skip_phy_initialization (@Xu Yang in [2588c29afdc87dd](https://github.com/sophgo/linux-riscv/commit/2588c29afdc87dd) at 2024-12-19 17:13:03)
    > commit d2ec94fbc431cc77ed53d4480bdc856669c2b5aa upstream.
    > Before commit 53a2d95df836 (&quot;usb: core: add phy notify connect and
    > disconnect&quot;), phy initialization will be skipped even when shared hcd
    > doesn&#x27;t set skip_phy_initialization flag. However, the situation is
    > changed after the commit. The hcd.c will initialize phy when add shared
    > hcd. This behavior is unexpected for some platforms which will handle phy
    > initialization by themselves. To avoid the issue, this will only check
    > skip_phy_initialization flag of primary hcd since shared hcd normally
    > follow primary hcd setting.
    > Fixes: 53a2d95df836 (&quot;usb: core: add phy notify connect and disconnect&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Xu Yang &lt;xu.yang_2@nxp.com&gt;
    > Link: https://lore.kernel.org/r/20241105090120.2438366-1-xu.yang_2@nxp.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ ata: sata_highbank: fix OF node reference leak in highbank_initialize_phys() (@Joe Hattori in [22671807181c42b](https://github.com/sophgo/linux-riscv/commit/22671807181c42b) at 2024-12-19 17:13:03)
    > commit 676fe1f6f74db988191dab5df3bf256908177072 upstream.
    > The OF node reference obtained by of_parse_phandle_with_args() is not
    > released on early return. Add a of_node_put() call before returning.
    > Fixes: 8996b89d6bc9 (&quot;ata: add platform driver for Calxeda AHCI controller&quot;)
    > Signed-off-by: Joe Hattori &lt;joe@pf.is.s.u-tokyo.ac.jp&gt;
    > Signed-off-by: Damien Le Moal &lt;dlemoal@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ gpio: graniterapids: Fix vGPIO driver crash (@Alan Borzeszkowski in [e631cab10c6b287](https://github.com/sophgo/linux-riscv/commit/e631cab10c6b287) at 2024-12-19 17:13:02)
    > commit eb9640fd1ce666610b77f5997596e9570a36378f upstream.
    > Move setting irq_chip.name from probe() function to the initialization
    > of &quot;irq_chip&quot; struct in order to fix vGPIO driver crash during bootup.
    > Crash was caused by unauthorized modification of irq_chip.name field
    > where irq_chip struct was initialized as const.
    > This behavior is a consequence of suboptimal implementation of
    > gpio_irq_chip_set_chip(), which should be changed to avoid
    > casting away const qualifier.
    > Crash log:
    > BUG: unable to handle page fault for address: ffffffffc0ba81c0
    > /#PF: supervisor write access in kernel mode
    > /#PF: error_code(0x0003) - permissions violation
    > CPU: 33 UID: 0 PID: 1075 Comm: systemd-udevd Not tainted 6.12.0-rc6-00077-g2e1b3cc9d7f7 #1
    > Hardware name: Intel Corporation Kaseyville RP/Kaseyville RP, BIOS KVLDCRB1.PGS.0026.D73.2410081258 10/08/2024
    > RIP: 0010:gnr_gpio_probe+0x171/0x220 [gpio_graniterapids]
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Alan Borzeszkowski &lt;alan.borzeszkowski@linux.intel.com&gt;
    > Signed-off-by: Mika Westerberg &lt;mika.westerberg@linux.intel.com&gt;
    > Acked-by: Andy Shevchenko &lt;andy@kernel.org&gt;
    > Link: https://lore.kernel.org/r/20241204070415.1034449-2-mika.westerberg@linux.intel.com
    > Signed-off-by: Bartosz Golaszewski &lt;bartosz.golaszewski@linaro.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ drm/panic: remove spurious empty line to clean warning (@Miguel Ojeda in [8f2cf4d32b1578d](https://github.com/sophgo/linux-riscv/commit/8f2cf4d32b1578d) at 2024-12-19 17:13:02)
    > commit 4011b351b1b5a953aaa7c6b3915f908b3cc1be96 upstream.
    > Clippy in the upcoming Rust 1.83.0 spots a spurious empty line since the
    > &#x60;clippy::empty_line_after_doc_comments&#x60; warning is now enabled by default
    > given it is part of the &#x60;suspicious&#x60; group [1]:
    > error: empty line after doc comment
    > --&gt; drivers/gpu/drm/drm_panic_qr.rs:931:1
    > |
    > 931 | / /// They must remain valid for the duration of the function call.
    > 932 | |
    > | |_
    > 933 |   #[no_mangle]
    > 934 | / pub unsafe extern &quot;C&quot; fn drm_panic_qr_generate(
    > 935 | |     url: *const i8,
    > 936 | |     data: *mut u8,
    > 937 | |     data_len: usize,
    > ...   |
    > 940 | |     tmp_size: usize,
    > 941 | | ) -&gt; u8 {
    > | |_______- the comment documents this function
    > |
    > &#x3D; help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#empty_line_after_doc_comments
    > &#x3D; note: &#x60;-D clippy::empty-line-after-doc-comments&#x60; implied by &#x60;-D warnings&#x60;
    > &#x3D; help: to override &#x60;-D warnings&#x60; add &#x60;#[allow(clippy::empty_line_after_doc_comments)]&#x60;
    > &#x3D; help: if the empty line is unintentional remove it
    > Thus remove the empty line.
    > Cc: stable@vger.kernel.org
    > Fixes: cb5164ac43d0 (&quot;drm/panic: Add a QR code panic screen&quot;)
    > Link: https://github.com/rust-lang/rust-clippy/pull/13091 [1]
    > Reviewed-by: Jocelyn Falempe &lt;jfalempe@redhat.com&gt;
    > Link: https://lore.kernel.org/r/20241125233332.697497-1-ojeda@kernel.org
    > Signed-off-by: Miguel Ojeda &lt;ojeda@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ crypto: hisilicon/debugfs - fix the struct pointer incorrectly offset problem (@Chenghai Huang in [71c359f6a4f73ce](https://github.com/sophgo/linux-riscv/commit/71c359f6a4f73ce) at 2024-12-19 17:13:02)
    > commit cd26cd65476711e2c69e0a049c0eeef4b743f5ac upstream.
    > Offset based on (id * size) is wrong for sqc and cqc.
    > (*sqc/*cqc + 1) can already offset sizeof(struct(Xqc)) length.
    > Fixes: 15f112f9cef5 (&quot;crypto: hisilicon/debugfs - mask the unnecessary info from the dump&quot;)
    > Cc: &lt;stable@vger.kernel.org&gt;
    > Signed-off-by: Chenghai Huang &lt;huangchenghai2@huawei.com&gt;
    > Signed-off-by: Herbert Xu &lt;herbert@gondor.apana.org.au&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ gpio: graniterapids: Fix incorrect BAR assignment (@Alan Borzeszkowski in [6832fcfb44da11c](https://github.com/sophgo/linux-riscv/commit/6832fcfb44da11c) at 2024-12-19 17:13:02)
    > commit 7382d2f0e802077c36495e325da8d253a15fb441 upstream.
    > Base Address of vGPIO MMIO register is provided directly by the BIOS
    > instead of using offsets. Update address assignment to reflect this
    > change in driver.
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Alan Borzeszkowski &lt;alan.borzeszkowski@linux.intel.com&gt;
    > Signed-off-by: Mika Westerberg &lt;mika.westerberg@linux.intel.com&gt;
    > Acked-by: Andy Shevchenko &lt;andy@kernel.org&gt;
    > Link: https://lore.kernel.org/r/20241204070415.1034449-3-mika.westerberg@linux.intel.com
    > Signed-off-by: Bartosz Golaszewski &lt;bartosz.golaszewski@linaro.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ usb: host: max3421-hcd: Correctly abort a USB request. (@Mark Tomlinson in [15e56cd38546866](https://github.com/sophgo/linux-riscv/commit/15e56cd38546866) at 2024-12-19 17:13:02)
    > commit 0d2ada05227881f3d0722ca2364e3f7a860a301f upstream.
    > If the current USB request was aborted, the spi thread would not respond
    > to any further requests. This is because the &quot;curr_urb&quot; pointer would
    > not become NULL, so no further requests would be taken off the queue.
    > The solution here is to set the &quot;urb_done&quot; flag, as this will cause the
    > correct handling of the URB. Also clear interrupts that should only be
    > expected if an URB is in progress.
    > Fixes: 2d53139f3162 (&quot;Add support for using a MAX3421E chip as a host driver.&quot;)
    > Cc: stable &lt;stable@kernel.org&gt;
    > Signed-off-by: Mark Tomlinson &lt;mark.tomlinson@alliedtelesis.co.nz&gt;
    > Link: https://lore.kernel.org/r/20241124221430.1106080-1-mark.tomlinson@alliedtelesis.co.nz
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ block: Ignore REQ_NOWAIT for zone reset and zone finish operations (@Damien Le Moal in [0eae680d03fb15b](https://github.com/sophgo/linux-riscv/commit/0eae680d03fb15b) at 2024-12-19 17:13:02)
    > commit 5eb3317aa5a2ffe4574ab1a12cf9bc9447ca26c0 upstream.
    > There are currently any issuer of REQ_OP_ZONE_RESET and
    > REQ_OP_ZONE_FINISH operations that set REQ_NOWAIT. However, as we cannot
    > handle this flag correctly due to the potential request allocation
    > failure that may happen in blk_mq_submit_bio() after blk_zone_plug_bio()
    > has handled the zone write plug write pointer updates for the targeted
    > zones, modify blk_zone_wplug_handle_reset_or_finish() to warn if this
    > flag is set and ignore it.
    > Fixes: dd291d77cc90 (&quot;block: Introduce zone write plugging&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Damien Le Moal &lt;dlemoal@kernel.org&gt;
    > Reviewed-by: Christoph Hellwig &lt;hch@lst.de&gt;
    > Reviewed-by: Martin K. Petersen &lt;martin.petersen@oracle.com&gt;
    > Link: https://lore.kernel.org/r/20241209122357.47838-3-dlemoal@kernel.org
    > Signed-off-by: Jens Axboe &lt;axboe@kernel.dk&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ spi: rockchip: Fix PM runtime count on no-op cs (@Christian Loehle in [e9bce603fb21255](https://github.com/sophgo/linux-riscv/commit/e9bce603fb21255) at 2024-12-19 17:13:01)
    > commit 0bb394067a792e7119abc9e0b7158ef19381f456 upstream.
    > The early bail out that caused an out-of-bounds write was removed with
    > commit 5c018e378f91 (&quot;spi: spi-rockchip: Fix out of bounds array
    > access&quot;)
    > Unfortunately that caused the PM runtime count to be unbalanced and
    > underflowed on the first call. To fix that reintroduce a no-op check
    > by reading the register directly.
    > Cc: stable@vger.kernel.org
    > Fixes: 5c018e378f91 (&quot;spi: spi-rockchip: Fix out of bounds array access&quot;)
    > Signed-off-by: Christian Loehle &lt;christian.loehle@arm.com&gt;
    > Link: https://patch.msgid.link/1f2b3af4-2b7a-4ac8-ab95-c80120ebf44c@arm.com
    > Signed-off-by: Mark Brown &lt;broonie@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ gpio: ljca: Initialize num before accessing item in ljca_gpio_config (@Haoyu Li in [e4dbfa63612b755](https://github.com/sophgo/linux-riscv/commit/e4dbfa63612b755) at 2024-12-19 17:13:01)
    > commit 3396995f9fb6bcbe0004a68118a22f98bab6e2b9 upstream.
    > With the new __counted_by annocation in ljca_gpio_packet, the &quot;num&quot;
    > struct member must be set before accessing the &quot;item&quot; array. Failing to
    > do so will trigger a runtime warning when enabling CONFIG_UBSAN_BOUNDS
    > and CONFIG_FORTIFY_SOURCE.
    > Fixes: 1034cc423f1b (&quot;gpio: update Intel LJCA USB GPIO driver&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Haoyu Li &lt;lihaoyu499@gmail.com&gt;
    > Link: https://lore.kernel.org/stable/20241203141451.342316-1-lihaoyu499%40gmail.com
    > Signed-off-by: Bartosz Golaszewski &lt;bartosz.golaszewski@linaro.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ ALSA: hda/realtek: Fix headset mic on Acer Nitro 5 (@Hridesh MG in [abf985f61a0141a](https://github.com/sophgo/linux-riscv/commit/abf985f61a0141a) at 2024-12-19 17:13:01)
    > commit 5a69e3d0a1b0f07e58c353560cfcb1ea20a6f040 upstream.
    > Add a PCI quirk to enable microphone input on the headphone jack on
    > the Acer Nitro 5 AN515-58 laptop.
    > Signed-off-by: Hridesh MG &lt;hridesh699@gmail.com&gt;
    > Cc: &lt;stable@vger.kernel.org&gt;
    > Link: https://patch.msgid.link/20241205171843.7787-1-hridesh699@gmail.com
    > Signed-off-by: Takashi Iwai &lt;tiwai@suse.de&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ memcg: slub: fix SUnreclaim for post charged objects (@Shakeel Butt in [825bccd94343a59](https://github.com/sophgo/linux-riscv/commit/825bccd94343a59) at 2024-12-19 17:13:01)
    > commit b7ffecbe198e2dfc44abf92ceb90f46150f7527a upstream.
    > Large kmalloc directly allocates from the page allocator and then use
    > lruvec_stat_mod_folio() to increment the unreclaimable slab stats for
    > global and memcg. However when post memcg charging of slab objects was
    > added in commit 9028cdeb38e1 (&quot;memcg: add charging of already allocated
    > slab objects&quot;), it missed to correctly handle the unreclaimable slab
    > stats for memcg.
    > One user visisble effect of that bug is that the node level
    > unreclaimable slab stat will work correctly but the memcg level stat can
    > underflow as kernel correctly handles the free path but the charge path
    > missed to increment the memcg level unreclaimable slab stat. Let&#x27;s fix
    > by correctly handle in the post charge code path.
    > Fixes: 9028cdeb38e1 (&quot;memcg: add charging of already allocated slab objects&quot;)
    > Signed-off-by: Shakeel Butt &lt;shakeel.butt@linux.dev&gt;
    > Cc: &lt;stable@vger.kernel.org&gt;
    > Signed-off-by: Vlastimil Babka &lt;vbabka@suse.cz&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ gpio: graniterapids: Fix GPIO Ack functionality (@Alan Borzeszkowski in [6e564f2ae92414f](https://github.com/sophgo/linux-riscv/commit/6e564f2ae92414f) at 2024-12-19 17:13:01)
    > commit 0bb18e34abdde7bf58fca8542e2dcf621924ea19 upstream.
    > Interrupt status (GPI_IS) register is cleared by writing 1 to it, not 0.
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Alan Borzeszkowski &lt;alan.borzeszkowski@linux.intel.com&gt;
    > Signed-off-by: Mika Westerberg &lt;mika.westerberg@linux.intel.com&gt;
    > Acked-by: Andy Shevchenko &lt;andy@kernel.org&gt;
    > Link: https://lore.kernel.org/r/20241204070415.1034449-8-mika.westerberg@linux.intel.com
    > Signed-off-by: Bartosz Golaszewski &lt;bartosz.golaszewski@linaro.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ ALSA: usb-audio: Add implicit feedback quirk for Yamaha THR5 (@Jaakko Salo in [3be6628c47462ce](https://github.com/sophgo/linux-riscv/commit/3be6628c47462ce) at 2024-12-19 17:13:01)
    > commit 82fdcf9b518b205da040046fbe7747fb3fd18657 upstream.
    > Use implicit feedback from the capture endpoint to fix popping
    > sounds during playback.
    > Link: https://bugzilla.kernel.org/show_bug.cgi?id&#x3D;219567
    > Signed-off-by: Jaakko Salo &lt;jaakkos@gmail.com&gt;
    > Cc: &lt;stable@vger.kernel.org&gt;
    > Link: https://patch.msgid.link/20241206164448.8136-1-jaakkos@gmail.com
    > Signed-off-by: Takashi Iwai &lt;tiwai@suse.de&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ riscv: Fix IPIs usage in kfence_protect_page() (@Alexandre Ghiti in [3abfc4130c42220](https://github.com/sophgo/linux-riscv/commit/3abfc4130c42220) at 2024-12-19 17:13:01)
    > commit b3431a8bb336cece8adc452437befa7d4534b2fd upstream.
    > flush_tlb_kernel_range() may use IPIs to flush the TLBs of all the
    > cores, which triggers the following warning when the irqs are disabled:
    > [    3.455330] WARNING: CPU: 1 PID: 0 at kernel/smp.c:815 smp_call_function_many_cond+0x452/0x520
    > [    3.456647] Modules linked in:
    > [    3.457218] CPU: 1 UID: 0 PID: 0 Comm: swapper/1 Not tainted 6.12.0-rc7-00010-g91d3de7240b8 #1
    > [    3.457416] Hardware name: QEMU QEMU Virtual Machine, BIOS
    > [    3.457633] epc : smp_call_function_many_cond+0x452/0x520
    > [    3.457736]  ra : on_each_cpu_cond_mask+0x1e/0x30
    > [    3.457786] epc : ffffffff800b669a ra : ffffffff800b67c2 sp : ff2000000000bb50
    > [    3.457824]  gp : ffffffff815212b8 tp : ff6000008014f080 t0 : 000000000000003f
    > [    3.457859]  t1 : ffffffff815221e0 t2 : 000000000000000f s0 : ff2000000000bc10
    > [    3.457920]  s1 : 0000000000000040 a0 : ffffffff815221e0 a1 : 0000000000000001
    > [    3.457953]  a2 : 0000000000010000 a3 : 0000000000000003 a4 : 0000000000000000
    > [    3.458006]  a5 : 0000000000000000 a6 : ffffffffffffffff a7 : 0000000000000000
    > [    3.458042]  s2 : ffffffff815223be s3 : 00fffffffffff000 s4 : ff600001ffe38fc0
    > [    3.458076]  s5 : ff600001ff950d00 s6 : 0000000200000120 s7 : 0000000000000001
    > [    3.458109]  s8 : 0000000000000001 s9 : ff60000080841ef0 s10: 0000000000000001
    > [    3.458141]  s11: ffffffff81524812 t3 : 0000000000000001 t4 : ff60000080092bc0
    > [    3.458172]  t5 : 0000000000000000 t6 : ff200000000236d0
    > [    3.458203] status: 0000000200000100 badaddr: ffffffff800b669a cause: 0000000000000003
    > [    3.458373] [&lt;ffffffff800b669a&gt;] smp_call_function_many_cond+0x452/0x520
    > [    3.458593] [&lt;ffffffff800b67c2&gt;] on_each_cpu_cond_mask+0x1e/0x30
    > [    3.458625] [&lt;ffffffff8000e4ca&gt;] __flush_tlb_range+0x118/0x1ca
    > [    3.458656] [&lt;ffffffff8000e6b2&gt;] flush_tlb_kernel_range+0x1e/0x26
    > [    3.458683] [&lt;ffffffff801ea56a&gt;] kfence_protect+0xc0/0xce
    > [    3.458717] [&lt;ffffffff801e9456&gt;] kfence_guarded_free+0xc6/0x1c0
    > [    3.458742] [&lt;ffffffff801e9d6c&gt;] __kfence_free+0x62/0xc6
    > [    3.458764] [&lt;ffffffff801c57d8&gt;] kfree+0x106/0x32c
    > [    3.458786] [&lt;ffffffff80588cf2&gt;] detach_buf_split+0x188/0x1a8
    > [    3.458816] [&lt;ffffffff8058708c&gt;] virtqueue_get_buf_ctx+0xb6/0x1f6
    > [    3.458839] [&lt;ffffffff805871da&gt;] virtqueue_get_buf+0xe/0x16
    > [    3.458880] [&lt;ffffffff80613d6a&gt;] virtblk_done+0x5c/0xe2
    > [    3.458908] [&lt;ffffffff8058766e&gt;] vring_interrupt+0x6a/0x74
    > [    3.458930] [&lt;ffffffff800747d8&gt;] __handle_irq_event_percpu+0x7c/0xe2
    > [    3.458956] [&lt;ffffffff800748f0&gt;] handle_irq_event+0x3c/0x86
    > [    3.458978] [&lt;ffffffff800786cc&gt;] handle_simple_irq+0x9e/0xbe
    > [    3.459004] [&lt;ffffffff80073934&gt;] generic_handle_domain_irq+0x1c/0x2a
    > [    3.459027] [&lt;ffffffff804bf87c&gt;] imsic_handle_irq+0xba/0x120
    > [    3.459056] [&lt;ffffffff80073934&gt;] generic_handle_domain_irq+0x1c/0x2a
    > [    3.459080] [&lt;ffffffff804bdb76&gt;] riscv_intc_aia_irq+0x24/0x34
    > [    3.459103] [&lt;ffffffff809d0452&gt;] handle_riscv_irq+0x2e/0x4c
    > [    3.459133] [&lt;ffffffff809d923e&gt;] call_on_irq_stack+0x32/0x40
    > So only flush the local TLB and let the lazy kfence page fault handling
    > deal with the faults which could happen when a core has an old protected
    > pte version cached in its TLB. That leads to potential inaccuracies which
    > can be tolerated when using kfence.
    > Fixes: 47513f243b45 (&quot;riscv: Enable KFENCE for riscv64&quot;)
    > Signed-off-by: Alexandre Ghiti &lt;alexghiti@rivosinc.com&gt;
    > Cc: stable@vger.kernel.org
    > Link: https://lore.kernel.org/r/20241209074125.52322-1-alexghiti@rivosinc.com
    > Signed-off-by: Palmer Dabbelt &lt;palmer@rivosinc.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ block: Use a zone write plug BIO work for REQ_NOWAIT BIOs (@Damien Le Moal in [eea49fcea50aaff](https://github.com/sophgo/linux-riscv/commit/eea49fcea50aaff) at 2024-12-19 17:13:00)
    > commit cae005670887cb07ceafc25bb32e221e56286488 upstream.
    > For zoned block devices, a write BIO issued to a zone that has no
    > on-going writes will be prepared for execution and allowed to execute
    > immediately by blk_zone_wplug_handle_write() (called from
    > blk_zone_plug_bio()). However, if this BIO specifies REQ_NOWAIT, the
    > allocation of a request for its execution in blk_mq_submit_bio() may
    > fail after blk_zone_plug_bio() completed, marking the target zone of the
    > BIO as plugged. When this BIO is retried later on, it will be blocked as
    > the zone write plug of the target zone is in a plugged state without any
    > on-going write operation (completion of write operations trigger
    > unplugging of the next write BIOs for a zone). This leads to a BIO that
    > is stuck in a zone write plug and never completes, which results in
    > various issues such as hung tasks.
    > Avoid this problem by always executing REQ_NOWAIT write BIOs using the
    > BIO work of a zone write plug. This ensure that we never block the BIO
    > issuer and can thus safely ignore the REQ_NOWAIT flag when executing the
    > BIO from the zone write plug BIO work.
    > Since such BIO may be the first write BIO issued to a zone with no
    > on-going write, modify disk_zone_wplug_add_bio() to schedule the zone
    > write plug BIO work if the write plug is not already marked with the
    > BLK_ZONE_WPLUG_PLUGGED flag. This scheduling is otherwise not necessary
    > as the completion of the on-going write for the zone will schedule the
    > execution of the next plugged BIOs.
    > blk_zone_wplug_handle_write() is also fixed to better handle zone write
    > plug allocation failures for REQ_NOWAIT BIOs by failing a write BIO
    > using bio_wouldblock_error() instead of bio_io_error().
    > Reported-by: Bart Van Assche &lt;bvanassche@acm.org&gt;
    > Fixes: dd291d77cc90 (&quot;block: Introduce zone write plugging&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Damien Le Moal &lt;dlemoal@kernel.org&gt;
    > Reviewed-by: Christoph Hellwig &lt;hch@lst.de&gt;
    > Reviewed-by: Martin K. Petersen &lt;martin.petersen@oracle.com&gt;
    > Link: https://lore.kernel.org/r/20241209122357.47838-2-dlemoal@kernel.org
    > Signed-off-by: Jens Axboe &lt;axboe@kernel.dk&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ block: Switch to using refcount_t for zone write plugs (@Damien Le Moal in [cbd06d98087c3e4](https://github.com/sophgo/linux-riscv/commit/cbd06d98087c3e4) at 2024-12-19 17:13:00)
    > commit 4122fef16b172f7c1838fcf74340268c86ed96db upstream.
    > Replace the raw atomic_t reference counting of zone write plugs with a
    > refcount_t.  No functional changes.
    > Reported-by: kernel test robot &lt;lkp@intel.com&gt;
    > Closes: https://lore.kernel.org/oe-kbuild-all/202411050650.ilIZa8S7-lkp@intel.com/
    > Signed-off-by: Damien Le Moal &lt;dlemoal@kernel.org&gt;
    > Reviewed-by: Christoph Hellwig &lt;hch@lst.de&gt;
    > Link: https://lore.kernel.org/r/20241107065438.236348-1-dlemoal@kernel.org
    > Signed-off-by: Jens Axboe &lt;axboe@kernel.dk&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ dm: Fix dm-zoned-reclaim zone write pointer alignment (@Damien Le Moal in [a4b656ea1b903da](https://github.com/sophgo/linux-riscv/commit/a4b656ea1b903da) at 2024-12-19 17:13:00)
    > commit b76b840fd93374240b59825f1ab8e2f5c9907acb upstream.
    > The zone reclaim processing of the dm-zoned device mapper uses
    > blkdev_issue_zeroout() to align the write pointer of a zone being used
    > for reclaiming another zone, to write the valid data blocks from the
    > zone being reclaimed at the same position relative to the zone start in
    > the reclaim target zone.
    > The first call to blkdev_issue_zeroout() will try to use hardware
    > offload using a REQ_OP_WRITE_ZEROES operation if the device reports a
    > non-zero max_write_zeroes_sectors queue limit. If this operation fails
    > because of the lack of hardware support, blkdev_issue_zeroout() falls
    > back to using a regular write operation with the zero-page as buffer.
    > Currently, such REQ_OP_WRITE_ZEROES failure is automatically handled by
    > the block layer zone write plugging code which will execute a report
    > zones operation to ensure that the write pointer of the target zone of
    > the failed operation has not changed and to &quot;rewind&quot; the zone write
    > pointer offset of the target zone as it was advanced when the write zero
    > operation was submitted. So the REQ_OP_WRITE_ZEROES failure does not
    > cause any issue and blkdev_issue_zeroout() works as expected.
    > However, since the automatic recovery of zone write pointers by the zone
    > write plugging code can potentially cause deadlocks with queue freeze
    > operations, a different recovery must be implemented in preparation for
    > the removal of zone write plugging report zones based recovery.
    > Do this by introducing the new function blk_zone_issue_zeroout(). This
    > function first calls blkdev_issue_zeroout() with the flag
    > BLKDEV_ZERO_NOFALLBACK to intercept failures on the first execution
    > which attempt to use the device hardware offload with the
    > REQ_OP_WRITE_ZEROES operation. If this attempt fails, a report zone
    > operation is issued to restore the zone write pointer offset of the
    > target zone to the correct position and blkdev_issue_zeroout() is called
    > again without the BLKDEV_ZERO_NOFALLBACK flag. The report zones
    > operation performing this recovery is implemented using the helper
    > function disk_zone_sync_wp_offset() which calls the gendisk report_zones
    > file operation with the callback disk_report_zones_cb(). This callback
    > updates the target write pointer offset of the target zone using the new
    > function disk_zone_wplug_sync_wp_offset().
    > dmz_reclaim_align_wp() is modified to change its call to
    > blkdev_issue_zeroout() to a call to blk_zone_issue_zeroout() without any
    > other change needed as the two functions are functionnally equivalent.
    > Fixes: dd291d77cc90 (&quot;block: Introduce zone write plugging&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Damien Le Moal &lt;dlemoal@kernel.org&gt;
    > Reviewed-by: Christoph Hellwig &lt;hch@lst.de&gt;
    > Acked-by: Mike Snitzer &lt;snitzer@kernel.org&gt;
    > Reviewed-by: Martin K. Petersen &lt;martin.petersen@oracle.com&gt;
    > Link: https://lore.kernel.org/r/20241209122357.47838-4-dlemoal@kernel.org
    > Signed-off-by: Jens Axboe &lt;axboe@kernel.dk&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ block: Prevent potential deadlocks in zone write plug error recovery (@Damien Le Moal in [7fa80134cf26632](https://github.com/sophgo/linux-riscv/commit/7fa80134cf26632) at 2024-12-19 17:13:00)
    > commit fe0418eb9bd69a19a948b297c8de815e05f3cde1 upstream.
    > Zone write plugging for handling writes to zones of a zoned block
    > device always execute a zone report whenever a write BIO to a zone
    > fails. The intent of this is to ensure that the tracking of a zone write
    > pointer is always correct to ensure that the alignment to a zone write
    > pointer of write BIOs can be checked on submission and that we can
    > always correctly emulate zone append operations using regular write
    > BIOs.
    > However, this error recovery scheme introduces a potential deadlock if a
    > device queue freeze is initiated while BIOs are still plugged in a zone
    > write plug and one of these write operation fails. In such case, the
    > disk zone write plug error recovery work is scheduled and executes a
    > report zone. This in turn can result in a request allocation in the
    > underlying driver to issue the report zones command to the device. But
    > with the device queue freeze already started, this allocation will
    > block, preventing the report zone execution and the continuation of the
    > processing of the plugged BIOs. As plugged BIOs hold a queue usage
    > reference, the queue freeze itself will never complete, resulting in a
    > deadlock.
    > Avoid this problem by completely removing from the zone write plugging
    > code the use of report zones operations after a failed write operation,
    > instead relying on the device user to either execute a report zones,
    > reset the zone, finish the zone, or give up writing to the device (which
    > is a fairly common pattern for file systems which degrade to read-only
    > after write failures). This is not an unreasonnable requirement as all
    > well-behaved applications, FSes and device mapper already use report
    > zones to recover from write errors whenever possible by comparing the
    > current position of a zone write pointer with what their assumption
    > about the position is.
    > The changes to remove the automatic error recovery are as follows:
    > - Completely remove the error recovery work and its associated
    > resources (zone write plug list head, disk error list, and disk
    > zone_wplugs_work work struct). This also removes the functions
    > disk_zone_wplug_set_error() and disk_zone_wplug_clear_error().
    > - Change the BLK_ZONE_WPLUG_ERROR zone write plug flag into
    > BLK_ZONE_WPLUG_NEED_WP_UPDATE. This new flag is set for a zone write
    > plug whenever a write opration targetting the zone of the zone write
    > plug fails. This flag indicates that the zone write pointer offset is
    > not reliable and that it must be updated when the next report zone,
    > reset zone, finish zone or disk revalidation is executed.
    > - Modify blk_zone_write_plug_bio_endio() to set the
    > BLK_ZONE_WPLUG_NEED_WP_UPDATE flag for the target zone of a failed
    > write BIO.
    > - Modify the function disk_zone_wplug_set_wp_offset() to clear this
    > new flag, thus implementing recovery of a correct write pointer
    > offset with the reset (all) zone and finish zone operations.
    > - Modify blkdev_report_zones() to always use the disk_report_zones_cb()
    > callback so that disk_zone_wplug_sync_wp_offset() can be called for
    > any zone marked with the BLK_ZONE_WPLUG_NEED_WP_UPDATE flag.
    > This implements recovery of a correct write pointer offset for zone
    > write plugs marked with BLK_ZONE_WPLUG_NEED_WP_UPDATE and within
    > the range of the report zones operation executed by the user.
    > - Modify blk_revalidate_seq_zone() to call
    > disk_zone_wplug_sync_wp_offset() for all sequential write required
    > zones when a zoned block device is revalidated, thus always resolving
    > any inconsistency between the write pointer offset of zone write
    > plugs and the actual write pointer position of sequential zones.
    > Fixes: dd291d77cc90 (&quot;block: Introduce zone write plugging&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Damien Le Moal &lt;dlemoal@kernel.org&gt;
    > Reviewed-by: Christoph Hellwig &lt;hch@lst.de&gt;
    > Reviewed-by: Martin K. Petersen &lt;martin.petersen@oracle.com&gt;
    > Link: https://lore.kernel.org/r/20241209122357.47838-5-dlemoal@kernel.org
    > Signed-off-by: Jens Axboe &lt;axboe@kernel.dk&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ riscv: Fix wrong usage of __pa() on a fixmap address (@Alexandre Ghiti in [7174f13ea28aabf](https://github.com/sophgo/linux-riscv/commit/7174f13ea28aabf) at 2024-12-19 17:13:00)
    > commit c796e187201242992d6d292bfeff41aadfdf3f29 upstream.
    > riscv uses fixmap addresses to map the dtb so we can&#x27;t use __pa() which
    > is reserved for linear mapping addresses.
    > Fixes: b2473a359763 (&quot;of/fdt: add dt_phys arg to early_init_dt_scan and early_init_dt_verify&quot;)
    > Signed-off-by: Alexandre Ghiti &lt;alexghiti@rivosinc.com&gt;
    > Link: https://lore.kernel.org/r/20241209074508.53037-1-alexghiti@rivosinc.com
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Palmer Dabbelt &lt;palmer@rivosinc.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ blk-cgroup: Fix UAF in blkcg_unpin_online() (@Tejun Heo in [29d1e06560f0f61](https://github.com/sophgo/linux-riscv/commit/29d1e06560f0f61) at 2024-12-19 17:13:00)
    > commit 86e6ca55b83c575ab0f2e105cf08f98e58d3d7af upstream.
    > blkcg_unpin_online() walks up the blkcg hierarchy putting the online pin. To
    > walk up, it uses blkcg_parent(blkcg) but it was calling that after
    > blkcg_destroy_blkgs(blkcg) which could free the blkcg, leading to the
    > following UAF:
    > &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;
    > BUG: KASAN: slab-use-after-free in blkcg_unpin_online+0x15a/0x270
    > Read of size 8 at addr ffff8881057678c0 by task kworker/9:1/117
    > CPU: 9 UID: 0 PID: 117 Comm: kworker/9:1 Not tainted 6.13.0-rc1-work-00182-gb8f52214c61a-dirty #48
    > Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS unknown 02/02/2022
    > Workqueue: cgwb_release cgwb_release_workfn
    > Call Trace:
    > &lt;TASK&gt;
    > dump_stack_lvl+0x27/0x80
    > print_report+0x151/0x710
    > kasan_report+0xc0/0x100
    > blkcg_unpin_online+0x15a/0x270
    > cgwb_release_workfn+0x194/0x480
    > process_scheduled_works+0x71b/0xe20
    > worker_thread+0x82a/0xbd0
    > kthread+0x242/0x2c0
    > ret_from_fork+0x33/0x70
    > ret_from_fork_asm+0x1a/0x30
    > &lt;/TASK&gt;
    > ...
    > Freed by task 1944:
    > kasan_save_track+0x2b/0x70
    > kasan_save_free_info+0x3c/0x50
    > __kasan_slab_free+0x33/0x50
    > kfree+0x10c/0x330
    > css_free_rwork_fn+0xe6/0xb30
    > process_scheduled_works+0x71b/0xe20
    > worker_thread+0x82a/0xbd0
    > kthread+0x242/0x2c0
    > ret_from_fork+0x33/0x70
    > ret_from_fork_asm+0x1a/0x30
    > Note that the UAF is not easy to trigger as the free path is indirected
    > behind a couple RCU grace periods and a work item execution. I could only
    > trigger it with artifical msleep() injected in blkcg_unpin_online().
    > Fix it by reading the parent pointer before destroying the blkcg&#x27;s blkg&#x27;s.
    > Signed-off-by: Tejun Heo &lt;tj@kernel.org&gt;
    > Reported-by: Abagail ren &lt;renzezhongucas@gmail.com&gt;
    > Suggested-by: Linus Torvalds &lt;torvalds@linuxfoundation.org&gt;
    > Fixes: 4308a434e5e0 (&quot;blkcg: don&#x27;t offline parent blkcg first&quot;)
    > Cc: stable@vger.kernel.org # v5.7+
    > Signed-off-by: Jens Axboe &lt;axboe@kernel.dk&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ virtio_net: ensure netdev_tx_reset_queue is called on tx ring resize (@Koichiro Den in [edd776618eee1e8](https://github.com/sophgo/linux-riscv/commit/edd776618eee1e8) at 2024-12-19 17:12:59)
    > commit 1480f0f61b675567ca5d0943d6ef2e39172dcafd upstream.
    > virtnet_tx_resize() flushes remaining tx skbs, requiring DQL counters to
    > be reset when flushing has actually occurred. Add
    > virtnet_sq_free_unused_buf_done() as a callback for virtqueue_reset() to
    > handle this.
    > Fixes: c8bd1f7f3e61 (&quot;virtio_net: add support for Byte Queue Limits&quot;)
    > Cc: &lt;stable@vger.kernel.org&gt; # v6.11+
    > Signed-off-by: Koichiro Den &lt;koichiro.den@canonical.com&gt;
    > Acked-by: Jason Wang &lt;jasowang@redhat.com&gt;
    > Reviewed-by: Xuan Zhuo &lt;xuanzhuo@linux.alibaba.com&gt;
    > Signed-off-by: Paolo Abeni &lt;pabeni@redhat.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ virtio_net: correct netdev_tx_reset_queue() invocation point (@Koichiro Den in [b4294d4ac61fbb3](https://github.com/sophgo/linux-riscv/commit/b4294d4ac61fbb3) at 2024-12-19 17:12:59)
    > commit 3ddccbefebdbe0c4c72a248676e4d39ac66a8e26 upstream.
    > When virtnet_close is followed by virtnet_open, some TX completions can
    > possibly remain unconsumed, until they are finally processed during the
    > first NAPI poll after the netdev_tx_reset_queue(), resulting in a crash
    > [1]. Commit b96ed2c97c79 (&quot;virtio_net: move netdev_tx_reset_queue() call
    > before RX napi enable&quot;) was not sufficient to eliminate all BQL crash
    > cases for virtio-net.
    > This issue can be reproduced with the latest net-next master by running:
    > &#x60;while :; do ip l set DEV down; ip l set DEV up; done&#x60; under heavy network
    > TX load from inside the machine.
    > netdev_tx_reset_queue() can actually be dropped from virtnet_open path;
    > the device is not stopped in any case. For BQL core part, it&#x27;s just like
    > traffic nearly ceases to exist for some period. For stall detector added
    > to BQL, even if virtnet_close could somehow lead to some TX completions
    > delayed for long, followed by virtnet_open, we can just take it as stall
    > as mentioned in commit 6025b9135f7a (&quot;net: dqs: add NIC stall detector
    > based on BQL&quot;). Note also that users can still reset stall_max via sysfs.
    > So, drop netdev_tx_reset_queue() from virtnet_enable_queue_pair(). This
    > eliminates the BQL crashes. As a result, netdev_tx_reset_queue() is now
    > explicitly required in freeze/restore path. This patch adds it to
    > immediately after free_unused_bufs(), following the rule of thumb:
    > netdev_tx_reset_queue() should follow any SKB freeing not followed by
    > netdev_tx_completed_queue(). This seems the most consistent and
    > streamlined approach, and now netdev_tx_reset_queue() runs whenever
    > free_unused_bufs() is done.
    > [1]:
    > ------------[ cut here ]------------
    > kernel BUG at lib/dynamic_queue_limits.c:99!
    > Oops: invalid opcode: 0000 [#1] PREEMPT SMP NOPTI
    > CPU: 7 UID: 0 PID: 1598 Comm: ip Tainted: G    N 6.12.0net-next_main+ #2
    > Tainted: [N]&#x3D;TEST
    > Hardware name: QEMU Standard PC (Q35 + ICH9, 2009), \
    > BIOS rel-1.16.3-0-ga6ed6b701f0a-prebuilt.qemu.org 04/01/2014
    > RIP: 0010:dql_completed+0x26b/0x290
    > Code: b7 c2 49 89 e9 44 89 da 89 c6 4c 89 d7 e8 ed 17 47 00 58 65 ff 0d
    > 4d 27 90 7e 0f 85 fd fe ff ff e8 ea 53 8d ff e9 f3 fe ff ff &lt;0f&gt; 0b 01
    > d2 44 89 d1 29 d1 ba 00 00 00 00 0f 48 ca e9 28 ff ff ff
    > RSP: 0018:ffffc900002b0d08 EFLAGS: 00010297
    > RAX: 0000000000000000 RBX: ffff888102398c80 RCX: 0000000080190009
    > RDX: 0000000000000000 RSI: 000000000000006a RDI: 0000000000000000
    > RBP: ffff888102398c00 R08: 0000000000000000 R09: 0000000000000000
    > R10: 00000000000000ca R11: 0000000000015681 R12: 0000000000000001
    > R13: ffffc900002b0d68 R14: ffff88811115e000 R15: ffff8881107aca40
    > FS:  00007f41ded69500(0000) GS:ffff888667dc0000(0000)
    > knlGS:0000000000000000
    > CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
    > CR2: 0000556ccc2dc1a0 CR3: 0000000104fd8003 CR4: 0000000000772ef0
    > PKRU: 55555554
    > Call Trace:
    > &lt;IRQ&gt;
    > ? die+0x32/0x80
    > ? do_trap+0xd9/0x100
    > ? dql_completed+0x26b/0x290
    > ? dql_completed+0x26b/0x290
    > ? do_error_trap+0x6d/0xb0
    > ? dql_completed+0x26b/0x290
    > ? exc_invalid_op+0x4c/0x60
    > ? dql_completed+0x26b/0x290
    > ? asm_exc_invalid_op+0x16/0x20
    > ? dql_completed+0x26b/0x290
    > __free_old_xmit+0xff/0x170 [virtio_net]
    > free_old_xmit+0x54/0xc0 [virtio_net]
    > virtnet_poll+0xf4/0xe30 [virtio_net]
    > ? __update_load_avg_cfs_rq+0x264/0x2d0
    > ? update_curr+0x35/0x260
    > ? reweight_entity+0x1be/0x260
    > __napi_poll.constprop.0+0x28/0x1c0
    > net_rx_action+0x329/0x420
    > ? enqueue_hrtimer+0x35/0x90
    > ? trace_hardirqs_on+0x1d/0x80
    > ? kvm_sched_clock_read+0xd/0x20
    > ? sched_clock+0xc/0x30
    > ? kvm_sched_clock_read+0xd/0x20
    > ? sched_clock+0xc/0x30
    > ? sched_clock_cpu+0xd/0x1a0
    > handle_softirqs+0x138/0x3e0
    > do_softirq.part.0+0x89/0xc0
    > &lt;/IRQ&gt;
    > &lt;TASK&gt;
    > __local_bh_enable_ip+0xa7/0xb0
    > virtnet_open+0xc8/0x310 [virtio_net]
    > __dev_open+0xfa/0x1b0
    > __dev_change_flags+0x1de/0x250
    > dev_change_flags+0x22/0x60
    > do_setlink.isra.0+0x2df/0x10b0
    > ? rtnetlink_rcv_msg+0x34f/0x3f0
    > ? netlink_rcv_skb+0x54/0x100
    > ? netlink_unicast+0x23e/0x390
    > ? netlink_sendmsg+0x21e/0x490
    > ? ____sys_sendmsg+0x31b/0x350
    > ? avc_has_perm_noaudit+0x67/0xf0
    > ? cred_has_capability.isra.0+0x75/0x110
    > ? __nla_validate_parse+0x5f/0xee0
    > ? __pfx___probestub_irq_enable+0x3/0x10
    > ? __create_object+0x5e/0x90
    > ? security_capable+0x3b/0x70
    > rtnl_newlink+0x784/0xaf0
    > ? avc_has_perm_noaudit+0x67/0xf0
    > ? cred_has_capability.isra.0+0x75/0x110
    > ? stack_depot_save_flags+0x24/0x6d0
    > ? __pfx_rtnl_newlink+0x10/0x10
    > rtnetlink_rcv_msg+0x34f/0x3f0
    > ? do_syscall_64+0x6c/0x180
    > ? entry_SYSCALL_64_after_hwframe+0x76/0x7e
    > ? __pfx_rtnetlink_rcv_msg+0x10/0x10
    > netlink_rcv_skb+0x54/0x100
    > netlink_unicast+0x23e/0x390
    > netlink_sendmsg+0x21e/0x490
    > ____sys_sendmsg+0x31b/0x350
    > ? copy_msghdr_from_user+0x6d/0xa0
    > ___sys_sendmsg+0x86/0xd0
    > ? __pte_offset_map+0x17/0x160
    > ? preempt_count_add+0x69/0xa0
    > ? __call_rcu_common.constprop.0+0x147/0x610
    > ? preempt_count_add+0x69/0xa0
    > ? preempt_count_add+0x69/0xa0
    > ? _raw_spin_trylock+0x13/0x60
    > ? trace_hardirqs_on+0x1d/0x80
    > __sys_sendmsg+0x66/0xc0
    > do_syscall_64+0x6c/0x180
    > entry_SYSCALL_64_after_hwframe+0x76/0x7e
    > RIP: 0033:0x7f41defe5b34
    > Code: 15 e1 12 0f 00 f7 d8 64 89 02 b8 ff ff ff ff eb bf 0f 1f 44 00 00
    > f3 0f 1e fa 80 3d 35 95 0f 00 00 74 13 b8 2e 00 00 00 0f 05 &lt;48&gt; 3d 00
    > f0 ff ff 77 4c c3 0f 1f 00 55 48 89 e5 48 83 ec 20 89 55
    > RSP: 002b:00007ffe5336ecc8 EFLAGS: 00000202 ORIG_RAX: 000000000000002e
    > RAX: ffffffffffffffda RBX: 0000000000000003 RCX: 00007f41defe5b34
    > RDX: 0000000000000000 RSI: 00007ffe5336ed30 RDI: 0000000000000003
    > RBP: 00007ffe5336eda0 R08: 0000000000000010 R09: 0000000000000001
    > R10: 00007ffe5336f6f9 R11: 0000000000000202 R12: 0000000000000003
    > R13: 0000000067452259 R14: 0000556ccc28b040 R15: 0000000000000000
    > &lt;/TASK&gt;
    > [...]
    > Fixes: c8bd1f7f3e61 (&quot;virtio_net: add support for Byte Queue Limits&quot;)
    > Cc: &lt;stable@vger.kernel.org&gt; # v6.11+
    > Signed-off-by: Koichiro Den &lt;koichiro.den@canonical.com&gt;
    > Acked-by: Jason Wang &lt;jasowang@redhat.com&gt;
    > Reviewed-by: Xuan Zhuo &lt;xuanzhuo@linux.alibaba.com&gt;
    > [ pabeni: trimmed possibly troublesome separator ]
    > Signed-off-by: Paolo Abeni &lt;pabeni@redhat.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ perf ftrace: Fix undefined behavior in cmp_profile_data() (@Kuan-Wei Chiu in [9891675bba06e9e](https://github.com/sophgo/linux-riscv/commit/9891675bba06e9e) at 2024-12-19 17:12:59)
    > commit 246dfe3dc199246bd64635163115f2691623fc53 upstream.
    > The comparison function cmp_profile_data() violates the C standard&#x27;s
    > requirements for qsort() comparison functions, which mandate symmetry
    > and transitivity:
    > Symmetry: If x &lt; y, then y &gt; x.
    > Transitivity: If x &lt; y and y &lt; z, then x &lt; z.
    > When v1 and v2 are equal, the function incorrectly returns 1, breaking
    > symmetry and transitivity. This causes undefined behavior, which can
    > lead to memory corruption in certain versions of glibc [1].
    > Fix the issue by returning 0 when v1 and v2 are equal, ensuring
    > compliance with the C standard and preventing undefined behavior.
    > Link: https://www.qualys.com/2024/01/30/qsort.txt [1]
    > Fixes: 0f223813edd0 (&quot;perf ftrace: Add &#x27;profile&#x27; command&quot;)
    > Fixes: 74ae366c37b7 (&quot;perf ftrace profile: Add -s/--sort option&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Kuan-Wei Chiu &lt;visitorckw@gmail.com&gt;
    > Reviewed-by: Namhyung Kim &lt;namhyung@kernel.org&gt;
    > Reviewed-by: Arnaldo Carvalho de Melo &lt;acme@redhat.com&gt;
    > Cc: jserv@ccns.ncku.edu.tw
    > Cc: chuang@cs.nycu.edu.tw
    > Link: https://lore.kernel.org/r/20241209134226.1939163-1-visitorckw@gmail.com
    > Signed-off-by: Namhyung Kim &lt;namhyung@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ tcp: check space before adding MPTCP SYN options (@MoYuanhao in [8aa9d1ff5b7fe19](https://github.com/sophgo/linux-riscv/commit/8aa9d1ff5b7fe19) at 2024-12-19 17:12:59)
    > commit 06d64ab46f19ac12f59a1d2aa8cd196b2e4edb5b upstream.
    > Ensure there is enough space before adding MPTCP options in
    > tcp_syn_options().
    > Without this check, &#x27;remaining&#x27; could underflow, and causes issues. If
    > there is not enough space, MPTCP should not be used.
    > Signed-off-by: MoYuanhao &lt;moyuanhao3676@163.com&gt;
    > Fixes: cec37a6e41aa (&quot;mptcp: Handle MP_CAPABLE options for outgoing connections&quot;)
    > Cc: stable@vger.kernel.org
    > Acked-by: Matthieu Baerts (NGI0) &lt;matttbe@kernel.org&gt;
    > [ Matt: Add Fixes, cc Stable, update Description ]
    > Signed-off-by: Matthieu Baerts (NGI0) &lt;matttbe@kernel.org&gt;
    > Reviewed-by: Eric Dumazet &lt;edumazet@google.com&gt;
    > Link: https://patch.msgid.link/20241209-net-mptcp-check-space-syn-v1-1-2da992bb6f74@kernel.org
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ riscv: mm: Do not call pmd dtor on vmemmap page table teardown (@Björn Töpel in [344945806f2f7af](https://github.com/sophgo/linux-riscv/commit/344945806f2f7af) at 2024-12-19 17:12:59)
    > commit 21f1b85c8912262adf51707e63614a114425eb10 upstream.
    > The vmemmap&#x27;s, which is used for RV64 with SPARSEMEM_VMEMMAP, page
    > tables are populated using pmd (page middle directory) hugetables.
    > However, the pmd allocation is not using the generic mechanism used by
    > the VMA code (e.g. pmd_alloc()), or the RISC-V specific
    > create_pgd_mapping()/alloc_pmd_late(). Instead, the vmemmap page table
    > code allocates a page, and calls vmemmap_set_pmd(). This results in
    > that the pmd ctor is *not* called, nor would it make sense to do so.
    > Now, when tearing down a vmemmap page table pmd, the cleanup code
    > would unconditionally, and incorrectly call the pmd dtor, which
    > results in a crash (best case).
    > This issue was found when running the HMM selftests:
    > | tools/testing/selftests/mm# ./test_hmm.sh smoke
    > | ... # when unloading the test_hmm.ko module
    > | page: refcount:1 mapcount:0 mapping:0000000000000000 index:0x0 pfn:0x10915b
    > | flags: 0x1000000000000000(node&#x3D;0|zone&#x3D;1)
    > | raw: 1000000000000000 0000000000000000 dead000000000122 0000000000000000
    > | raw: 0000000000000000 0000000000000000 00000001ffffffff 0000000000000000
    > | page dumped because: VM_BUG_ON_PAGE(ptdesc-&gt;pmd_huge_pte)
    > | ------------[ cut here ]------------
    > | kernel BUG at include/linux/mm.h:3080!
    > | Kernel BUG [#1]
    > | Modules linked in: test_hmm(-) sch_fq_codel fuse drm drm_panel_orientation_quirks backlight dm_mod
    > | CPU: 1 UID: 0 PID: 514 Comm: modprobe Tainted: G        W          6.12.0-00982-gf2a4f1682d07 #2
    > | Tainted: [W]&#x3D;WARN
    > | Hardware name: riscv-virtio qemu/qemu, BIOS 2024.10 10/01/2024
    > | epc : remove_pgd_mapping+0xbec/0x1070
    > |  ra : remove_pgd_mapping+0xbec/0x1070
    > | epc : ffffffff80010a68 ra : ffffffff80010a68 sp : ff20000000a73940
    > |  gp : ffffffff827b2d88 tp : ff6000008785da40 t0 : ffffffff80fbce04
    > |  t1 : 0720072007200720 t2 : 706d756420656761 s0 : ff20000000a73a50
    > |  s1 : ff6000008915cff8 a0 : 0000000000000039 a1 : 0000000000000008
    > |  a2 : ff600003fff0de20 a3 : 0000000000000000 a4 : 0000000000000000
    > |  a5 : 0000000000000000 a6 : c0000000ffffefff a7 : ffffffff824469b8
    > |  s2 : ff1c0000022456c0 s3 : ff1ffffffdbfffff s4 : ff6000008915c000
    > |  s5 : ff6000008915c000 s6 : ff6000008915c000 s7 : ff1ffffffdc00000
    > |  s8 : 0000000000000001 s9 : ff1ffffffdc00000 s10: ffffffff819a31f0
    > |  s11: ffffffffffffffff t3 : ffffffff8000c950 t4 : ff60000080244f00
    > |  t5 : ff60000080244000 t6 : ff20000000a73708
    > | status: 0000000200000120 badaddr: ffffffff80010a68 cause: 0000000000000003
    > | [&lt;ffffffff80010a68&gt;] remove_pgd_mapping+0xbec/0x1070
    > | [&lt;ffffffff80fd238e&gt;] vmemmap_free+0x14/0x1e
    > | [&lt;ffffffff8032e698&gt;] section_deactivate+0x220/0x452
    > | [&lt;ffffffff8032ef7e&gt;] sparse_remove_section+0x4a/0x58
    > | [&lt;ffffffff802f8700&gt;] __remove_pages+0x7e/0xba
    > | [&lt;ffffffff803760d8&gt;] memunmap_pages+0x2bc/0x3fe
    > | [&lt;ffffffff02a3ca28&gt;] dmirror_device_remove_chunks+0x2ea/0x518 [test_hmm]
    > | [&lt;ffffffff02a3e026&gt;] hmm_dmirror_exit+0x3e/0x1018 [test_hmm]
    > | [&lt;ffffffff80102c14&gt;] __riscv_sys_delete_module+0x15a/0x2a6
    > | [&lt;ffffffff80fd020c&gt;] do_trap_ecall_u+0x1f2/0x266
    > | [&lt;ffffffff80fde0a2&gt;] _new_vmalloc_restore_context_a0+0xc6/0xd2
    > | Code: bf51 7597 0184 8593 76a5 854a 4097 0029 80e7 2c00 (9002) 7597
    > | ---[ end trace 0000000000000000 ]---
    > | Kernel panic - not syncing: Fatal exception in interrupt
    > Add a check to avoid calling the pmd dtor, if the calling context is
    > vmemmap_free().
    > Fixes: c75a74f4ba19 (&quot;riscv: mm: Add memory hotplugging support&quot;)
    > Signed-off-by: Björn Töpel &lt;bjorn@rivosinc.com&gt;
    > Reviewed-by: Alexandre Ghiti &lt;alexghiti@rivosinc.com&gt;
    > Link: https://lore.kernel.org/r/20241120131203.1859787-1-bjorn@kernel.org
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Palmer Dabbelt &lt;palmer@rivosinc.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ splice: do not checksum AF_UNIX sockets (@Frederik Deweerdt in [26702b3439f56eb](https://github.com/sophgo/linux-riscv/commit/26702b3439f56eb) at 2024-12-19 17:12:59)
    > commit 6bd8614fc2d076fc21b7488c9f279853960964e2 upstream.
    > When &#x60;skb_splice_from_iter&#x60; was introduced, it inadvertently added
    > checksumming for AF_UNIX sockets. This resulted in significant
    > slowdowns, for example when using sendfile over unix sockets.
    > Using the test code in [1] in my test setup (2G single core qemu),
    > the client receives a 1000M file in:
    > - without the patch: 1482ms (+/- 36ms)
    > - with the patch: 652.5ms (+/- 22.9ms)
    > This commit addresses the issue by marking checksumming as unnecessary in
    > &#x60;unix_stream_sendmsg&#x60;
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Frederik Deweerdt &lt;deweerdt.lkml@gmail.com&gt;
    > Fixes: 2e910b95329c (&quot;net: Add a function to splice pages into an skbuff for MSG_SPLICE_PAGES&quot;)
    > Reviewed-by: Kuniyuki Iwashima &lt;kuniyu@amazon.com&gt;
    > Reviewed-by: Eric Dumazet &lt;edumazet@google.com&gt;
    > Reviewed-by: Joe Damato &lt;jdamato@fastly.com&gt;
    > Link: https://patch.msgid.link/Z1fMaHkRf8cfubuE@xiberoa
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ virtio_ring: add a func argument &#x27;recycle_done&#x27; to virtqueue_resize() (@Koichiro Den in [098b9821fe262ec](https://github.com/sophgo/linux-riscv/commit/098b9821fe262ec) at 2024-12-19 17:12:59)
    > commit 8d6712c892019b9b9dc5c7039edd3c9d770b510b upstream.
    > When virtqueue_resize() has actually recycled all unused buffers,
    > additional work may be required in some cases. Relying solely on its
    > return status is fragile, so introduce a new function argument
    > &#x27;recycle_done&#x27;, which is invoked when the recycle really occurs.
    > Cc: &lt;stable@vger.kernel.org&gt; # v6.11+
    > Signed-off-by: Koichiro Den &lt;koichiro.den@canonical.com&gt;
    > Acked-by: Jason Wang &lt;jasowang@redhat.com&gt;
    > Reviewed-by: Xuan Zhuo &lt;xuanzhuo@linux.alibaba.com&gt;
    > Signed-off-by: Paolo Abeni &lt;pabeni@redhat.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ perf/x86/intel/ds: Unconditionally drain PEBS DS when changing PEBS_DATA_CFG (@Kan Liang in [c0ab5e01a51a5bd](https://github.com/sophgo/linux-riscv/commit/c0ab5e01a51a5bd) at 2024-12-19 17:12:58)
    > commit 9f3de72a0c37005f897d69e4bdd59c25b8898447 upstream.
    > The PEBS kernel warnings can still be observed with the below case.
    > when the below commands are running in parallel for a while.
    > while true;
    > do
    > perf record --no-buildid -a --intr-regs&#x3D;AX  \
    > -e cpu/event&#x3D;0xd0,umask&#x3D;0x81/pp \
    > -c 10003 -o /dev/null ./triad;
    > done &amp;
    > while true;
    > do
    > perf record -e &#x27;cpu/mem-loads,ldlat&#x3D;3/uP&#x27; -W -d -- ./dtlb
    > done
    > The commit b752ea0c28e3 (&quot;perf/x86/intel/ds: Flush PEBS DS when changing
    > PEBS_DATA_CFG&quot;) intends to flush the entire PEBS buffer before the
    > hardware is reprogrammed. However, it fails in the above case.
    > The first perf command utilizes the large PEBS, while the second perf
    > command only utilizes a single PEBS. When the second perf event is
    > added, only the n_pebs++. The intel_pmu_pebs_enable() is invoked after
    > intel_pmu_pebs_add(). So the cpuc-&gt;n_pebs &#x3D;&#x3D; cpuc-&gt;n_large_pebs check in
    > the intel_pmu_drain_large_pebs() fails. The PEBS DS is not flushed.
    > The new PEBS event should not be taken into account when flushing the
    > existing PEBS DS.
    > The check is unnecessary here. Before the hardware is reprogrammed, all
    > the stale records must be drained unconditionally.
    > For single PEBS or PEBS-vi-pt, the DS must be empty. The drain_pebs()
    > can handle the empty case. There is no harm to unconditionally drain the
    > PEBS DS.
    > Fixes: b752ea0c28e3 (&quot;perf/x86/intel/ds: Flush PEBS DS when changing PEBS_DATA_CFG&quot;)
    > Signed-off-by: Kan Liang &lt;kan.liang@linux.intel.com&gt;
    > Signed-off-by: Peter Zijlstra (Intel) &lt;peterz@infradead.org&gt;
    > Cc: stable@vger.kernel.org
    > Link: https://lore.kernel.org/r/20241119135504.1463839-2-kan.liang@linux.intel.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ sched/deadline: Fix replenish_dl_new_period dl_server condition (@Juri Lelli in [a3d85c14899bc53](https://github.com/sophgo/linux-riscv/commit/a3d85c14899bc53) at 2024-12-19 17:12:58)
    > commit 22368fe1f9bbf39db2b5b52859589883273e80ce upstream.
    > The condition in replenish_dl_new_period() that checks if a reservation
    > (dl_server) is deferred and is not handling a starvation case is
    > obviously wrong.
    > Fix it.
    > Fixes: a110a81c52a9 (&quot;sched/deadline: Deferrable dl server&quot;)
    > Signed-off-by: Juri Lelli &lt;juri.lelli@redhat.com&gt;
    > Signed-off-by: Peter Zijlstra (Intel) &lt;peterz@infradead.org&gt;
    > Cc: stable@vger.kernel.org
    > Link: https://lkml.kernel.org/r/20241127063740.8278-1-juri.lelli@redhat.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ ksmbd: fix racy issue from session lookup and expire (@Namjae Jeon in [a39e31e22a535d4](https://github.com/sophgo/linux-riscv/commit/a39e31e22a535d4) at 2024-12-19 17:12:58)
    > commit b95629435b84b9ecc0c765995204a4d8a913ed52 upstream.
    > Increment the session reference count within the lock for lookup to avoid
    > racy issue with session expire.
    > Cc: stable@vger.kernel.org
    > Reported-by: zdi-disclosures@trendmicro.com # ZDI-CAN-25737
    > Signed-off-by: Namjae Jeon &lt;linkinjeon@kernel.org&gt;
    > Signed-off-by: Steve French &lt;stfrench@microsoft.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ bpf: Fix UAF via mismatching bpf_prog/attachment RCU flavors (@Jann Horn in [9b53d2c2a38a1ef](https://github.com/sophgo/linux-riscv/commit/9b53d2c2a38a1ef) at 2024-12-19 17:12:58)
    > commit ef1b808e3b7c98612feceedf985c2fbbeb28f956 upstream.
    > Uprobes always use bpf_prog_run_array_uprobe() under tasks-trace-RCU
    > protection. But it is possible to attach a non-sleepable BPF program to a
    > uprobe, and non-sleepable BPF programs are freed via normal RCU (see
    > __bpf_prog_put_noref()). This leads to UAF of the bpf_prog because a normal
    > RCU grace period does not imply a tasks-trace-RCU grace period.
    > Fix it by explicitly waiting for a tasks-trace-RCU grace period after
    > removing the attachment of a bpf_prog to a perf_event.
    > Fixes: 8c7dcb84e3b7 (&quot;bpf: implement sleepable uprobes by chaining gps&quot;)
    > Suggested-by: Andrii Nakryiko &lt;andrii@kernel.org&gt;
    > Suggested-by: Alexei Starovoitov &lt;ast@kernel.org&gt;
    > Signed-off-by: Jann Horn &lt;jannh@google.com&gt;
    > Signed-off-by: Andrii Nakryiko &lt;andrii@kernel.org&gt;
    > Cc: stable@vger.kernel.org
    > Link: https://lore.kernel.org/bpf/20241210-bpf-fix-actual-uprobe-uaf-v1-1-19439849dd44@google.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ serial: sh-sci: Check if TX data was written to device in .tx_empty() (@Claudiu Beznea in [7415bc5198efa97](https://github.com/sophgo/linux-riscv/commit/7415bc5198efa97) at 2024-12-19 17:12:58)
    > commit 7cc0e0a43a91052477c2921f924a37d9c3891f0c upstream.
    > On the Renesas RZ/G3S, when doing suspend to RAM, the uart_suspend_port()
    > is called. The uart_suspend_port() calls 3 times the
    > struct uart_port::ops::tx_empty() before shutting down the port.
    > According to the documentation, the struct uart_port::ops::tx_empty()
    > API tests whether the transmitter FIFO and shifter for the port is
    > empty.
    > The Renesas RZ/G3S SCIFA IP reports the number of data units stored in the
    > transmit FIFO through the FDR (FIFO Data Count Register). The data units
    > in the FIFOs are written in the shift register and transmitted from there.
    > The TEND bit in the Serial Status Register reports if the data was
    > transmitted from the shift register.
    > In the previous code, in the tx_empty() API implemented by the sh-sci
    > driver, it is considered that the TX is empty if the hardware reports the
    > TEND bit set and the number of data units in the FIFO is zero.
    > According to the HW manual, the TEND bit has the following meaning:
    > 0: Transmission is in the waiting state or in progress.
    > 1: Transmission is completed.
    > It has been noticed that when opening the serial device w/o using it and
    > then switch to a power saving mode, the tx_empty() call in the
    > uart_port_suspend() function fails, leading to the &quot;Unable to drain
    > transmitter&quot; message being printed on the console. This is because the
    > TEND&#x3D;0 if nothing has been transmitted and the FIFOs are empty. As the
    > TEND&#x3D;0 has double meaning (waiting state, in progress) we can&#x27;t
    > determined the scenario described above.
    > Add a software workaround for this. This sets a variable if any data has
    > been sent on the serial console (when using PIO) or if the DMA callback has
    > been called (meaning something has been transmitted). In the tx_empty()
    > API the status of the DMA transaction is also checked and if it is
    > completed or in progress the code falls back in checking the hardware
    > registers instead of relying on the software variable.
    > Fixes: 73a19e4c0301 (&quot;serial: sh-sci: Add DMA support.&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Claudiu Beznea &lt;claudiu.beznea.uj@bp.renesas.com&gt;
    > Link: https://lore.kernel.org/r/20241125115856.513642-1-claudiu.beznea.uj@bp.renesas.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ usb: misc: onboard_usb_dev: skip suspend/resume sequence for USB5744 SMBus support (@Radhey Shyam Pandey in [1832e61d879cfed](https://github.com/sophgo/linux-riscv/commit/1832e61d879cfed) at 2024-12-19 17:12:58)
    > commit ce15d6b3d5c3c6f78290066be0f0a4fd89cdeb5b upstream.
    > USB5744 SMBus initialization is done once in probe() and doing it in resume
    > is not supported so avoid going into suspend and reset the HUB.
    > There is a sysfs property &#x27;always_powered_in_suspend&#x27; to implement this
    > feature but since default state should be set to a working configuration
    > so override this property value.
    > It fixes the suspend/resume testcase on Kria KR260 Robotics Starter Kit.
    > Fixes: 6782311d04df (&quot;usb: misc: onboard_usb_dev: add Microchip usb5744 SMBus programming support&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Radhey Shyam Pandey &lt;radhey.shyam.pandey@amd.com&gt;
    > Link: https://lore.kernel.org/r/1733165302-1694891-1-git-send-email-radhey.shyam.pandey@amd.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ clk: en7523: Fix wrong BUS clock for EN7581 (@Christian Marangi in [0535f67fbafa9de](https://github.com/sophgo/linux-riscv/commit/0535f67fbafa9de) at 2024-12-19 17:12:58)
    > commit 2eb75f86d52565367211c51334d15fe672633085 upstream.
    > The Documentation for EN7581 had a typo and still referenced the EN7523
    > BUS base source frequency. This was in conflict with a different page in
    > the Documentration that state that the BUS runs at 300MHz (600MHz source
    > with divisor set to 2) and the actual watchdog that tick at half the BUS
    > clock (150MHz). This was verified with the watchdog by timing the
    > seconds that the system takes to reboot (due too watchdog) and by
    > operating on different values of the BUS divisor.
    > The correct values for source of BUS clock are 600MHz and 540MHz.
    > This was also confirmed by Airoha.
    > Cc: stable@vger.kernel.org
    > Fixes: 66bc47326ce2 (&quot;clk: en7523: Add EN7581 support&quot;)
    > Signed-off-by: Christian Marangi &lt;ansuelsmth@gmail.com&gt;
    > Link: https://lore.kernel.org/r/20241116105710.19748-1-ansuelsmth@gmail.com
    > Acked-by: Lorenzo Bianconi &lt;lorenzo@kernel.org&gt;
    > Signed-off-by: Stephen Boyd &lt;sboyd@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ Linux 6.12.5 (@Greg Kroah-Hartman in [7143efb58e33b6b](https://github.com/sophgo/linux-riscv/commit/7143efb58e33b6b) at 2024-12-14 19:04:17)
    > Link: https://lore.kernel.org/r/20241212144306.641051666@linuxfoundation.org
    > Tested-by: Luna Jernberg &lt;droidbittin@gmail.com&gt;
    > Tested-by: Ronald Warsow &lt;rwarsow@gmx.de&gt;
    > Tested-by: Salvatore Bonaccorso &lt;carnil@debian.org&gt;
    > Tested-by: Christian Heusel &lt;christian@heusel.eu&gt;
    > Tested-by: Peter Schneider &lt;pschneider1968@googlemail.com&gt;
    > Tested-by: Jon Hunter &lt;jonathanh@nvidia.com&gt;
    > Tested-by: Mark Brown &lt;broonie@kernel.org&gt;
    > Tested-by: Shuah Khan &lt;skhan@linuxfoundation.org&gt;
    > Tested-by: SeongJae Park &lt;sj@kernel.org&gt;
    > Link: https://lore.kernel.org/r/20241213145925.077514874@linuxfoundation.org
    > Tested-by: Ronald Warsow &lt;rwarsow@gmx.de&gt;
    > Tested-by: Luna Jernberg &lt;droidbittin@gmail.com&gt;
    > Tested-by: Ron Economos &lt;re@w6rz.net&gt;
    > Tested-by: Willy Tarreau &lt;w@1wt.eu&gt;
    > Tested-by: Takeshi Ogasawara &lt;takeshi.ogasawara@futuring-girl.com&gt;
    > Tested-by: kernelci.org bot &lt;bot@kernelci.org&gt;
    > Tested-by: Linux Kernel Functional Testing &lt;lkft@linaro.org&gt;
    > Tested-by: Miguel Ojeda &lt;ojeda@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ s390/pci: Fix leak of struct zpci_dev when zpci_add_device() fails (@Niklas Schnelle in [ef6bb8f4d8d3559](https://github.com/sophgo/linux-riscv/commit/ef6bb8f4d8d3559) at 2024-12-14 19:04:16)
    > commit 48796104c864cf4dafa80bd8c2ce88f9c92a65ea upstream.
    > Prior to commit 0467cdde8c43 (&quot;s390/pci: Sort PCI functions prior to
    > creating virtual busses&quot;) the IOMMU was initialized and the device was
    > registered as part of zpci_create_device() with the struct zpci_dev
    > freed if either resulted in an error. With that commit this was moved
    > into a separate function called zpci_add_device().
    > While this new function logs when adding failed, it expects the caller
    > not to use and to free the struct zpci_dev on error. This difference
    > between it and zpci_create_device() was missed while changing the
    > callers and the incompletely initialized struct zpci_dev may get used in
    > zpci_scan_configured_device in the error path. This then leads to
    > a crash due to the device not being registered with the zbus. It was
    > also not freed in this case. Fix this by handling the error return of
    > zpci_add_device(). Since in this case the zdev was not added to the
    > zpci_list it can simply be discarded and freed. Also make this more
    > explicit by moving the kref_init() into zpci_add_device() and document
    > that zpci_zdev_get()/zpci_zdev_put() must be used after adding.
    > Cc: stable@vger.kernel.org
    > Fixes: 0467cdde8c43 (&quot;s390/pci: Sort PCI functions prior to creating virtual busses&quot;)
    > Reviewed-by: Gerd Bayer &lt;gbayer@linux.ibm.com&gt;
    > Reviewed-by: Matthew Rosato &lt;mjrosato@linux.ibm.com&gt;
    > Signed-off-by: Niklas Schnelle &lt;schnelle@linux.ibm.com&gt;
    > Signed-off-by: Heiko Carstens &lt;hca@linux.ibm.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ ALSA: hda/realtek: Fix spelling mistake &quot;Firelfy&quot; -&gt; &quot;Firefly&quot; (@Colin Ian King in [a8c03c6dc1bd943](https://github.com/sophgo/linux-riscv/commit/a8c03c6dc1bd943) at 2024-12-14 19:04:16)
    > commit 20c3b3e5f2641eff3d85f33e6a468ac052b169bd upstream.
    > There is a spelling mistake in a literal string in the alc269_fixup_tbl
    > quirk table. Fix it.
    > Fixes: 0d08f0eec961 (&quot;ALSA: hda/realtek: fix micmute LEDs don&#x27;t work on HP Laptops&quot;)
    > Signed-off-by: Colin Ian King &lt;colin.i.king@gmail.com&gt;
    > Link: https://patch.msgid.link/20241205102833.476190-1-colin.i.king@gmail.com
    > Signed-off-by: Takashi Iwai &lt;tiwai@suse.de&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ timekeeping: Remove CONFIG_DEBUG_TIMEKEEPING (@Thomas Gleixner in [7b7a9175c63bac4](https://github.com/sophgo/linux-riscv/commit/7b7a9175c63bac4) at 2024-12-14 19:04:16)
    > commit d44d26987bb3df6d76556827097fc9ce17565cb8 upstream.
    > Since 135225a363ae timekeeping_cycles_to_ns() handles large offsets which
    > would lead to 64bit multiplication overflows correctly. It&#x27;s also protected
    > against negative motion of the clocksource unconditionally, which was
    > exclusive to x86 before.
    > timekeeping_advance() handles large offsets already correctly.
    > That means the value of CONFIG_DEBUG_TIMEKEEPING which analyzed these cases
    > is very close to zero. Remove all of it.
    > Signed-off-by: Thomas Gleixner &lt;tglx@linutronix.de&gt;
    > Acked-by: John Stultz &lt;jstultz@google.com&gt;
    > Link: https://lore.kernel.org/all/20241031120328.536010148@linutronix.de
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ softirq: Allow raising SCHED_SOFTIRQ from SMP-call-function on RT kernel (@K Prateek Nayak in [6aeef0214de7429](https://github.com/sophgo/linux-riscv/commit/6aeef0214de7429) at 2024-12-14 19:04:16)
    > commit 6675ce20046d149e1e1ffe7e9577947dee17aad5 upstream.
    > do_softirq_post_smp_call_flush() on PREEMPT_RT kernels carries a
    > WARN_ON_ONCE() for any SOFTIRQ being raised from an SMP-call-function.
    > Since do_softirq_post_smp_call_flush() is called with preempt disabled,
    > raising a SOFTIRQ during flush_smp_call_function_queue() can lead to
    > longer preempt disabled sections.
    > Since commit b2a02fc43a1f (&quot;smp: Optimize
    > send_call_function_single_ipi()&quot;) IPIs to an idle CPU in
    > TIF_POLLING_NRFLAG mode can be optimized out by instead setting
    > TIF_NEED_RESCHED bit in idle task&#x27;s thread_info and relying on the
    > flush_smp_call_function_queue() in the idle-exit path to run the
    > SMP-call-function.
    > To trigger an idle load balancing, the scheduler queues
    > nohz_csd_function() responsible for triggering an idle load balancing on
    > a target nohz idle CPU and sends an IPI. Only now, this IPI is optimized
    > out and the SMP-call-function is executed from
    > flush_smp_call_function_queue() in do_idle() which can raise a
    > SCHED_SOFTIRQ to trigger the balancing.
    > So far, this went undetected since, the need_resched() check in
    > nohz_csd_function() would make it bail out of idle load balancing early
    > as the idle thread does not clear TIF_POLLING_NRFLAG before calling
    > flush_smp_call_function_queue(). The need_resched() check was added with
    > the intent to catch a new task wakeup, however, it has recently
    > discovered to be unnecessary and will be removed in the subsequent
    > commit after which nohz_csd_function() can raise a SCHED_SOFTIRQ from
    > flush_smp_call_function_queue() to trigger an idle load balance on an
    > idle target in TIF_POLLING_NRFLAG mode.
    > nohz_csd_function() bails out early if &quot;idle_cpu()&quot; check for the
    > target CPU, and does not lock the target CPU&#x27;s rq until the very end,
    > once it has found tasks to run on the CPU and will not inhibit the
    > wakeup of, or running of a newly woken up higher priority task. Account
    > for this and prevent a WARN_ON_ONCE() when SCHED_SOFTIRQ is raised from
    > flush_smp_call_function_queue().
    > Signed-off-by: K Prateek Nayak &lt;kprateek.nayak@amd.com&gt;
    > Signed-off-by: Peter Zijlstra (Intel) &lt;peterz@infradead.org&gt;
    > Link: https://lore.kernel.org/r/20241119054432.6405-2-kprateek.nayak@amd.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ clocksource: Make negative motion detection more robust (@Thomas Gleixner in [1a678f6829a8c93](https://github.com/sophgo/linux-riscv/commit/1a678f6829a8c93) at 2024-12-14 19:04:16)
    > commit 76031d9536a076bf023bedbdb1b4317fc801dd67 upstream.
    > Guenter reported boot stalls on a emulated ARM 32-bit platform, which has a
    > 24-bit wide clocksource.
    > It turns out that the calculated maximal idle time, which limits idle
    > sleeps to prevent clocksource wrap arounds, is close to the point where the
    > negative motion detection triggers.
    > max_idle_ns:                    597268854 ns
    > negative motion tripping point: 671088640 ns
    > If the idle wakeup is delayed beyond that point, the clocksource
    > advances far enough to trigger the negative motion detection. This
    > prevents the clock to advance and in the worst case the system stalls
    > completely if the consecutive sleeps based on the stale clock are
    > delayed as well.
    > Cure this by calculating a more robust cut-off value for negative motion,
    > which covers 87.5% of the actual clocksource counter width. Compare the
    > delta against this value to catch negative motion. This is specifically for
    > clock sources with a small counter width as their wrap around time is close
    > to the half counter width. For clock sources with wide counters this is not
    > a problem because the maximum idle time is far from the half counter width
    > due to the math overflow protection constraints.
    > For the case at hand this results in a tripping point of 1174405120ns.
    > Note, that this cannot prevent issues when the delay exceeds the 87.5%
    > margin, but that&#x27;s not different from the previous unchecked version which
    > allowed arbitrary time jumps.
    > Systems with small counter width are prone to invalid results, but this
    > problem is unlikely to be seen on real hardware. If such a system
    > completely stalls for more than half a second, then there are other more
    > urgent problems than the counter wrapping around.
    > Fixes: c163e40af9b2 (&quot;timekeeping: Always check for negative motion&quot;)
    > Reported-by: Guenter Roeck &lt;linux@roeck-us.net&gt;
    > Signed-off-by: Thomas Gleixner &lt;tglx@linutronix.de&gt;
    > Tested-by: Guenter Roeck &lt;linux@roeck-us.net&gt;
    > Link: https://lore.kernel.org/all/8734j5ul4x.ffs@tglx
    > Closes: https://lore.kernel.org/all/387b120b-d68a-45e8-b6ab-768cd95d11c2@roeck-us.net
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ ALSA: hda: Fix build error without CONFIG_SND_DEBUG (@Takashi Iwai in [eaf83f14c67eb71](https://github.com/sophgo/linux-riscv/commit/eaf83f14c67eb71) at 2024-12-14 19:04:15)
    > commit 0ddf2784d6c29e59409a62b8f32dc5abe56135a4 upstream.
    > The macro should have been defined without setting the non-existing
    > name field in the case of CONFIG_SND_DEBUG&#x3D;n.
    > Reported-by: Stephen Rothwell &lt;sfr@canb.auug.org.au&gt;
    > Closes: https://lore.kernel.org/20241011131046.5eb3905a@canb.auug.org.au
    > Fixes: 5b1913a79c3e (&quot;ALSA: hda: Use own quirk lookup helper&quot;)
    > Link: https://patch.msgid.link/20241011072152.14657-1-tiwai@suse.de
    > Signed-off-by: Takashi Iwai &lt;tiwai@suse.de&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ ASoC: Intel: avs: Fix return status of avs_pcm_hw_constraints_init() (@Amadeusz Sławiński in [b050c6284a20bf7](https://github.com/sophgo/linux-riscv/commit/b050c6284a20bf7) at 2024-12-14 19:04:15)
    > commit a0aae96be5ffc5b456ca07bfe1385b721c20e184 upstream.
    > Check for return code from avs_pcm_hw_constraints_init() in
    > avs_dai_fe_startup() only checks if value is different from 0. Currently
    > function can return positive value, change it to return 0 on success.
    > Reviewed-by: Cezary Rojewski &lt;cezary.rojewski@intel.com&gt;
    > Signed-off-by: Amadeusz Sławiński &lt;amadeuszx.slawinski@linux.intel.com&gt;
    > I&#x27;ve observed KASAN on our setups and while patch itself is correct
    > regardless. Problem seems to be caused by recent changes to rates, as
    > this started happening after recent patchsets and doesn&#x27;t reproduce with
    > those reverted
    > https://lore.kernel.org/linux-sound/20240905-alsa-12-24-128-v1-0-8371948d3921@baylibre.com/
    > https://lore.kernel.org/linux-sound/20240911135756.24434-1-tiwai@suse.de/
    > I&#x27;ve tested using Mark tree, where they are both applied and for some
    > reason snd_pcm_hw_constraint_minmax() started returning positive value,
    > while previously it returned 0. I&#x27;m bit worried if it signals some
    > potential deeper problem regarding constraints with above changes.
    > Link: https://patch.msgid.link/20241010112008.545526-1-amadeuszx.slawinski@linux.intel.com
    > Signed-off-by: Mark Brown &lt;broonie@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ drm/amdgpu: rework resume handling for display (v2) (@Alex Deucher in [99a02eab8251534](https://github.com/sophgo/linux-riscv/commit/99a02eab8251534) at 2024-12-14 19:04:15)
    > commit 73dae652dcac776296890da215ee7dec357a1032 upstream.
    > Split resume into a 3rd step to handle displays when DCC is
    > enabled on DCN 4.0.1.  Move display after the buffer funcs
    > have been re-enabled so that the GPU will do the move and
    > properly set the DCC metadata for DCN.
    > v2: fix fence irq resume ordering
    > Reviewed-by: Christian König &lt;christian.koenig@amd.com&gt;
    > Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Cc: stable@vger.kernel.org # 6.11.x
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ Revert &quot;drm/amd/display: parse umc_info or vram_info based on ASIC&quot; (@Alex Deucher in [87917ad3034ea93](https://github.com/sophgo/linux-riscv/commit/87917ad3034ea93) at 2024-12-14 19:04:15)
    > commit 3c2296b1eec55b50c64509ba15406142d4a958dc upstream.
    > This reverts commit 2551b4a321a68134360b860113dd460133e856e5.
    > This was not the root cause.  Revert.
    > Link: https://gitlab.freedesktop.org/drm/amd/-/issues/3678
    > Reviewed-by: Harry Wentland &lt;harry.wentland@amd.com&gt;
    > Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Cc: aurabindo.pillai@amd.com
    > Cc: hamishclaxton@gmail.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ net/mlx5: unique names for per device caches (@Sebastian Ott in [871caea15202cc0](https://github.com/sophgo/linux-riscv/commit/871caea15202cc0) at 2024-12-14 19:04:15)
    > commit 25872a079bbbe952eb660249cc9f40fa75623e68 upstream.
    > Add the device name to the per device kmem_cache names to
    > ensure their uniqueness. This fixes warnings like this:
    > &quot;kmem_cache of name &#x27;mlx5_fs_fgs&#x27; already exists&quot;.
    > Signed-off-by: Sebastian Ott &lt;sebott@redhat.com&gt;
    > Reviewed-by: Breno Leitao &lt;leitao@debian.org&gt;
    > Reviewed-by: Tariq Toukan &lt;tariqt@nvidia.com&gt;
    > Link: https://patch.msgid.link/20241023134146.28448-1-sebott@redhat.com
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Matt Fleming &lt;mfleming@cloudflare.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ ocfs2: Revert &quot;ocfs2: fix the la space leak when unmounting an ocfs2 volume&quot; (@Heming Zhao in [81d2c5968dba33c](https://github.com/sophgo/linux-riscv/commit/81d2c5968dba33c) at 2024-12-14 19:04:15)
    > This reverts commit dfe6c5692fb5 (&quot;ocfs2: fix the la space leak when
    > unmounting an ocfs2 volume&quot;).
    > In commit dfe6c5692fb5, the commit log &quot;This bug has existed since the
    > initial OCFS2 code.&quot; is wrong. The correct introduction commit is
    > 30dd3478c3cd (&quot;ocfs2: correctly use ocfs2_find_next_zero_bit()&quot;).
    > The influence of commit dfe6c5692fb5 is that it provides a correct
    > fix for the latest kernel. however, it shouldn&#x27;t be pushed to stable
    > branches. Let&#x27;s use this commit to revert all branches that include
    > dfe6c5692fb5 and use a new fix method to fix commit 30dd3478c3cd.
    > Fixes: dfe6c5692fb5 (&quot;ocfs2: fix the la space leak when unmounting an ocfs2 volume&quot;)
    > Signed-off-by: Heming Zhao &lt;heming.zhao@suse.com&gt;
    > Cc: &lt;stable@vger.kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ jffs2: Prevent rtime decompress memory corruption (@Kinsey Moore in [dc39b08fcc3831b](https://github.com/sophgo/linux-riscv/commit/dc39b08fcc3831b) at 2024-12-14 19:04:14)
    > commit fe051552f5078fa02d593847529a3884305a6ffe upstream.
    > The rtime decompression routine does not fully check bounds during the
    > entirety of the decompression pass and can corrupt memory outside the
    > decompression buffer if the compressed data is corrupted. This adds the
    > required check to prevent this failure mode.
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Kinsey Moore &lt;kinsey.moore@oarcorp.com&gt;
    > Signed-off-by: Richard Weinberger &lt;richard@nod.at&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ media: ipu6: use the IPU6 DMA mapping APIs to do mapping (@Bingbu Cao in [d38610a978d68cb](https://github.com/sophgo/linux-riscv/commit/d38610a978d68cb) at 2024-12-14 19:04:14)
    > commit 1d4a000289979cc7f2887c8407b1bfe2a0918354 upstream.
    > dma_ops is removed from the IPU6 auxiliary device, ISYS driver
    > should use the IPU6 DMA mapping APIs directly instead of depending
    > on the device callbacks.
    > ISYS driver switch from the videobuf2 DMA contig memory allocator to
    > scatter/gather memory allocator.
    > Signed-off-by: Bingbu Cao &lt;bingbu.cao@intel.com&gt;
    > [Sakari Ailus: Rebased on recent videobuf2 wait changes.]
    > Signed-off-by: Sakari Ailus &lt;sakari.ailus@linux.intel.com&gt;
    > Signed-off-by: Hans Verkuil &lt;hverkuil@xs4all.nl&gt;
    > Reviewed-by: Hans de Goede &lt;hdegoede@redhat.com&gt;
    > Signed-off-by: Stanislaw Gruszka &lt;stanislaw.gruszka@linux.intel.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ vfio/mlx5: Align the page tracking max message size with the device capability (@Yishai Hadas in [ad4095d1259d037](https://github.com/sophgo/linux-riscv/commit/ad4095d1259d037) at 2024-12-14 19:04:14)
    > [ Upstream commit 9c7c5430bca36e9636eabbba0b3b53251479c7ab ]
    > Align the page tracking maximum message size with the device&#x27;s
    > capability instead of relying on PAGE_SIZE.
    > This adjustment resolves a mismatch on systems where PAGE_SIZE is 64K,
    > but the firmware only supports a maximum message size of 4K.
    > Now that we rely on the device&#x27;s capability for max_message_size, we
    > must account for potential future increases in its value.
    > Key considerations include:
    > - Supporting message sizes that exceed a single system page (e.g., an 8K
    > message on a 4K system).
    > - Ensuring the RQ size is adjusted to accommodate at least 4
    > WQEs/messages, in line with the device specification.
    > The above has been addressed as part of the patch.
    > Fixes: 79c3cf279926 (&quot;vfio/mlx5: Init QP based resources for dirty tracking&quot;)
    > Reviewed-by: Cédric Le Goater &lt;clg@redhat.com&gt;
    > Tested-by: Yingshun Cui &lt;yicui@redhat.com&gt;
    > Signed-off-by: Yishai Hadas &lt;yishaih@nvidia.com&gt;
    > Link: https://lore.kernel.org/r/20241205122654.235619-1-yishaih@nvidia.com
    > Signed-off-by: Alex Williamson &lt;alex.williamson@redhat.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ selftests/ftrace: adjust offset for kprobe syntax error test (@Hari Bathini in [7f91d9206220409](https://github.com/sophgo/linux-riscv/commit/7f91d9206220409) at 2024-12-14 19:04:14)
    > [ Upstream commit 777f290ab328de333b85558bb6807a69a59b36ba ]
    > In &#x27;NOFENTRY_ARGS&#x27; test case for syntax check, any offset X of
    > &#x60;vfs_read+X&#x60; except function entry offset (0) fits the criterion,
    > even if that offset is not at instruction boundary, as the parser
    > comes before probing. But with &quot;ENDBR64&quot; instruction on x86, offset
    > 4 is treated as function entry. So, X can&#x27;t be 4 as well. Thus, 8
    > was used as offset for the test case. On 64-bit powerpc though, any
    > offset &lt;&#x3D; 16 can be considered function entry depending on build
    > configuration (see arch_kprobe_on_func_entry() for implementation
    > details). So, use &#x60;vfs_read+20&#x60; to accommodate that scenario too.
    > Link: https://lore.kernel.org/r/20241129202621.721159-1-hbathini@linux.ibm.com
    > Fixes: 4231f30fcc34a (&quot;selftests/ftrace: Add BTF arguments test cases&quot;)
    > Suggested-by: Masami Hiramatsu &lt;mhiramat@kernel.org&gt;
    > Signed-off-by: Hari Bathini &lt;hbathini@linux.ibm.com&gt;
    > Acked-by: Steven Rostedt (Google) &lt;rostedt@goodmis.org&gt;
    > Signed-off-by: Shuah Khan &lt;skhan@linuxfoundation.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ KVM: x86/mmu: Ensure that kvm_release_pfn_clean() takes exact pfn from kvm_faultin_pfn() (@Nikolay Kuratov in [547b7f8fdebc77c](https://github.com/sophgo/linux-riscv/commit/547b7f8fdebc77c) at 2024-12-14 19:04:14)
    > Since 5.16 and prior to 6.13 KVM can&#x27;t be used with FSDAX
    > guest memory (PMD pages). To reproduce the issue you need to reserve
    > guest memory with &#x60;memmap&#x3D;&#x60; cmdline, create and mount FS in DAX mode
    > (tested both XFS and ext4), see doc link below. ndctl command for test:
    > ndctl create-namespace -v -e namespace1.0 --map&#x3D;dev --mode&#x3D;fsdax -a 2M
    > Then pass memory object to qemu like:
    > -m 8G -object memory-backend-file,id&#x3D;ram0,size&#x3D;8G,\
    > mem-path&#x3D;/mnt/pmem/guestmem,share&#x3D;on,prealloc&#x3D;on,dump&#x3D;off,align&#x3D;2097152 \
    > -numa node,memdev&#x3D;ram0,cpus&#x3D;0-1
    > QEMU fails to run guest with error: kvm run failed Bad address
    > and there are two warnings in dmesg:
    > WARN_ON_ONCE(!page_count(page)) in kvm_is_zone_device_page() and
    > WARN_ON_ONCE(folio_ref_count(folio) &lt;&#x3D; 0) in try_grab_folio() (v6.6.63)
    > It looks like in the past assumption was made that pfn won&#x27;t change from
    > faultin_pfn() to release_pfn_clean(), e.g. see
    > commit 4cd071d13c5c (&quot;KVM: x86/mmu: Move calls to thp_adjust() down a level&quot;)
    > But kvm_page_fault structure made pfn part of mutable state, so
    > now release_pfn_clean() can take hugepage-adjusted pfn.
    > And it works for all cases (/dev/shm, hugetlb, devdax) except fsdax.
    > Apparently in fsdax mode faultin-pfn and adjusted-pfn may refer to
    > different folios, so we&#x27;re getting get_page/put_page imbalance.
    > To solve this preserve faultin pfn in separate local variable
    > and pass it in kvm_release_pfn_clean().
    > Patch tested for all mentioned guest memory backends with tdp_mmu&#x3D;{0,1}.
    > No bug in upstream as it was solved fundamentally by
    > commit 8dd861cc07e2 (&quot;KVM: x86/mmu: Put refcounted pages instead of blindly releasing pfns&quot;)
    > and related patch series.
    > Link: https://nvdimm.docs.kernel.org/2mib_fs_dax.html
    > Fixes: 2f6305dd5676 (&quot;KVM: MMU: change kvm_tdp_mmu_map() arguments to kvm_page_fault&quot;)
    > Co-developed-by: Sean Christopherson &lt;seanjc@google.com&gt;
    > Signed-off-by: Sean Christopherson &lt;seanjc@google.com&gt;
    > Reviewed-by: Sean Christopherson &lt;seanjc@google.com&gt;
    > Signed-off-by: Nikolay Kuratov &lt;kniv@yandex-team.ru&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ jffs2: Fix rtime decompressor (@Richard Weinberger in [4904a01e4737375](https://github.com/sophgo/linux-riscv/commit/4904a01e4737375) at 2024-12-14 19:04:14)
    > commit b29bf7119d6bbfd04aabb8d82b060fe2a33ef890 upstream.
    > The fix for a memory corruption contained a off-by-one error and
    > caused the compressor to fail in legit cases.
    > Cc: Kinsey Moore &lt;kinsey.moore@oarcorp.com&gt;
    > Cc: stable@vger.kernel.org
    > Fixes: fe051552f5078 (&quot;jffs2: Prevent rtime decompress memory corruption&quot;)
    > Signed-off-by: Richard Weinberger &lt;richard@nod.at&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ btrfs: drop unused parameter data from btrfs_fill_super() (@David Sterba in [b633b3c3e370abc](https://github.com/sophgo/linux-riscv/commit/b633b3c3e370abc) at 2024-12-14 19:04:13)
    > [ Upstream commit 01c5db782e3ad1aea1d06a1765c710328c145f10 ]
    > The only caller passes NULL, we can drop the parameter. This is since
    > the new mount option parser done in 3bb17a25bcb09a (&quot;btrfs: add get_tree
    > callback for new mount API&quot;).
    > Reviewed-by: Anand Jain &lt;anand.jain@oracle.com&gt;
    > Signed-off-by: David Sterba &lt;dsterba@suse.com&gt;
    > Stable-dep-of: 951a3f59d268 (&quot;btrfs: fix mount failure due to remount races&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ x86: Fix build regression with CONFIG_KEXEC_JUMP enabled (@Damien Le Moal in [7913d1f737c4f84](https://github.com/sophgo/linux-riscv/commit/7913d1f737c4f84) at 2024-12-14 19:04:13)
    > [ Upstream commit aeb68937614f4aeceaaa762bd7f0212ce842b797 ]
    > Build 6.13-rc12 for x86_64 with gcc 14.2.1 fails with the error:
    > ld: vmlinux.o: in function &#x60;virtual_mapped&#x27;:
    > linux/arch/x86/kernel/relocate_kernel_64.S:249:(.text+0x5915b): undefined reference to &#x60;saved_context_gdt_desc&#x27;
    > when CONFIG_KEXEC_JUMP is enabled.
    > This was introduced by commit 07fa619f2a40 (&quot;x86/kexec: Restore GDT on
    > return from ::preserve_context kexec&quot;) which introduced a use of
    > saved_context_gdt_desc without a declaration for it.
    > Fix that by including asm/asm-offsets.h where saved_context_gdt_desc
    > is defined (indirectly in include/generated/asm-offsets.h which
    > asm/asm-offsets.h includes).
    > Fixes: 07fa619f2a40 (&quot;x86/kexec: Restore GDT on return from ::preserve_context kexec&quot;)
    > Signed-off-by: Damien Le Moal &lt;dlemoal@kernel.org&gt;
    > Acked-by: Borislav Petkov (AMD) &lt;bp@alien8.de&gt;
    > Acked-by: David Woodhouse &lt;dwmw@amazon.co.uk&gt;
    > Closes: https://lore.kernel.org/oe-kbuild-all/202411270006.ZyyzpYf8-lkp@intel.com/
    > Signed-off-by: Linus Torvalds &lt;torvalds@linux-foundation.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ btrfs: fix mount failure due to remount races (@Qu Wenruo in [653b704e7db65e1](https://github.com/sophgo/linux-riscv/commit/653b704e7db65e1) at 2024-12-14 19:04:13)
    > [ Upstream commit 951a3f59d268fe1397aaeb9a96fcb1944890c4cb ]
    > [BUG]
    > The following reproducer can cause btrfs mount to fail:
    > dev&#x3D;&quot;/dev/test/scratch1&quot;
    > mnt1&#x3D;&quot;/mnt/test&quot;
    > mnt2&#x3D;&quot;/mnt/scratch&quot;
    > mkfs.btrfs -f $dev
    > mount $dev $mnt1
    > btrfs subvolume create $mnt1/subvol1
    > btrfs subvolume create $mnt1/subvol2
    > umount $mnt1
    > mount $dev $mnt1 -o subvol&#x3D;subvol1
    > while mount -o remount,ro $mnt1; do mount -o remount,rw $mnt1; done &amp;
    > bg&#x3D;$!
    > while mount $dev $mnt2 -o subvol&#x3D;subvol2; do umount $mnt2; done
    > kill $bg
    > wait
    > umount -R $mnt1
    > umount -R $mnt2
    > The script will fail with the following error:
    > mount: /mnt/scratch: /dev/mapper/test-scratch1 already mounted on /mnt/test.
    > dmesg(1) may have more information after failed mount system call.
    > umount: /mnt/test: target is busy.
    > umount: /mnt/scratch/: not mounted
    > And there is no kernel error message.
    > [CAUSE]
    > During the btrfs mount, to support mounting different subvolumes with
    > different RO/RW flags, we need to detect that and retry if needed:
    > Retry with matching RO flags if the initial mount fail with -EBUSY.
    > The problem is, during that retry we do not hold any super block lock
    > (s_umount), this means there can be a remount process changing the RO
    > flags of the original fs super block.
    > If so, we can have an EBUSY error during retry.  And this time we treat
    > any failure as an error, without any retry and cause the above EBUSY
    > mount failure.
    > [FIX]
    > The current retry behavior is racy because we do not have a super block
    > thus no way to hold s_umount to prevent the race with remount.
    > Solve the root problem by allowing fc-&gt;sb_flags to mismatch from the
    > sb-&gt;s_flags at btrfs_get_tree_super().
    > Then at the re-entry point btrfs_get_tree_subvol(), manually check the
    > fc-&gt;s_flags against sb-&gt;s_flags, if it&#x27;s a RO-&gt;RW mismatch, then
    > reconfigure with s_umount lock hold.
    > Reported-by: Enno Gotthold &lt;egotthold@suse.com&gt;
    > Reported-by: Fabian Vogt &lt;fvogt@suse.com&gt;
    > [ Special thanks for the reproducer and early analysis pointing to btrfs. ]
    > Fixes: f044b318675f (&quot;btrfs: handle the ro-&gt;rw transition for mounting different subvolumes&quot;)
    > Link: https://bugzilla.suse.com/show_bug.cgi?id&#x3D;1231836
    > Signed-off-by: Qu Wenruo &lt;wqu@suse.com&gt;
    > Reviewed-by: David Sterba &lt;dsterba@suse.com&gt;
    > Signed-off-by: David Sterba &lt;dsterba@suse.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ btrfs: fix missing snapshot drew unlock when root is dead during swap activation (@Filipe Manana in [650214c925e8a90](https://github.com/sophgo/linux-riscv/commit/650214c925e8a90) at 2024-12-14 19:04:13)
    > [ Upstream commit 9c803c474c6c002d8ade68ebe99026cc39c37f85 ]
    > When activating a swap file we acquire the root&#x27;s snapshot drew lock and
    > then check if the root is dead, failing and returning with -EPERM if it&#x27;s
    > dead but without unlocking the root&#x27;s snapshot lock. Fix this by adding
    > the missing unlock.
    > Fixes: 60021bd754c6 (&quot;btrfs: prevent subvol with swapfile from being deleted&quot;)
    > Reviewed-by: Johannes Thumshirn &lt;johannes.thumshirn@wdc.com&gt;
    > Reviewed-by: David Sterba &lt;dsterba@suse.com&gt;
    > Reviewed-by: Qu Wenruo &lt;wqu@suse.com&gt;
    > Signed-off-by: Filipe Manana &lt;fdmanana@suse.com&gt;
    > Signed-off-by: David Sterba &lt;dsterba@suse.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ tracing/eprobe: Fix to release eprobe when failed to add dyn_event (@Masami Hiramatsu (Google) in [364dc8070baf12f](https://github.com/sophgo/linux-riscv/commit/364dc8070baf12f) at 2024-12-14 19:04:13)
    > [ Upstream commit 494b332064c0ce2f7392fa92632bc50191c1b517 ]
    > Fix eprobe event to unregister event call and release eprobe when it fails
    > to add dynamic event correctly.
    > Link: https://lore.kernel.org/all/173289886698.73724.1959899350183686006.stgit@devnote2/
    > Fixes: 7491e2c44278 (&quot;tracing: Add a probe that attaches to trace events&quot;)
    > Signed-off-by: Masami Hiramatsu (Google) &lt;mhiramat@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ Revert &quot;unicode: Don&#x27;t special case ignorable code points&quot; (@Linus Torvalds in [0a5152f5fbe7640](https://github.com/sophgo/linux-riscv/commit/0a5152f5fbe7640) at 2024-12-14 19:04:13)
    > [ Upstream commit 231825b2e1ff6ba799c5eaf396d3ab2354e37c6b ]
    > This reverts commit 5c26d2f1d3f5e4be3e196526bead29ecb139cf91.
    > It turns out that we can&#x27;t do this, because while the old behavior of
    > ignoring ignorable code points was most definitely wrong, we have
    > case-folding filesystems with on-disk hash values with that wrong
    > behavior.
    > So now you can&#x27;t look up those names, because they hash to something
    > different.
    > Of course, it&#x27;s also entirely possible that in the meantime people have
    > created *new* files with the new (&quot;more correct&quot;) case folding logic,
    > and reverting will just make other things break.
    > The correct solution is to not do case folding in filesystems, but
    > sadly, people seem to never really understand that.  People still see it
    > as a feature, not a bug.
    > Reported-by: Qi Han &lt;hanqi@vivo.com&gt;
    > Link: https://bugzilla.kernel.org/show_bug.cgi?id&#x3D;219586
    > Cc: Gabriel Krisman Bertazi &lt;krisman@suse.de&gt;
    > Requested-by: Jaegeuk Kim &lt;jaegeuk@kernel.org&gt;
    > Signed-off-by: Linus Torvalds &lt;torvalds@linux-foundation.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ clk: en7523: Initialize num before accessing hws in en7523_register_clocks() (@Haoyu Li in [07bc1978d59bfb5](https://github.com/sophgo/linux-riscv/commit/07bc1978d59bfb5) at 2024-12-14 19:04:13)
    > [ Upstream commit 52fd1709e41d3a85b48bcfe2404a024ebaf30c3b ]
    > With the new __counted_by annotation in clk_hw_onecell_data, the &quot;num&quot;
    > struct member must be set before accessing the &quot;hws&quot; array. Failing to
    > do so will trigger a runtime warning when enabling CONFIG_UBSAN_BOUNDS
    > and CONFIG_FORTIFY_SOURCE.
    > Fixes: f316cdff8d67 (&quot;clk: Annotate struct clk_hw_onecell_data with __counted_by&quot;)
    > Signed-off-by: Haoyu Li &lt;lihaoyu499@gmail.com&gt;
    > Link: https://lore.kernel.org/r/20241203142915.345523-1-lihaoyu499@gmail.com
    > Signed-off-by: Stephen Boyd &lt;sboyd@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ sched/fair: Check idle_cpu() before need_resched() to detect ilb CPU turning busy (@K Prateek Nayak in [f9e144a54428a21](https://github.com/sophgo/linux-riscv/commit/f9e144a54428a21) at 2024-12-14 19:04:12)
    > [ Upstream commit ff47a0acfcce309cf9e175149c75614491953c8f ]
    > Commit b2a02fc43a1f (&quot;smp: Optimize send_call_function_single_ipi()&quot;)
    > optimizes IPIs to idle CPUs in TIF_POLLING_NRFLAG mode by setting the
    > TIF_NEED_RESCHED flag in idle task&#x27;s thread info and relying on
    > flush_smp_call_function_queue() in idle exit path to run the
    > call-function. A softirq raised by the call-function is handled shortly
    > after in do_softirq_post_smp_call_flush() but the TIF_NEED_RESCHED flag
    > remains set and is only cleared later when schedule_idle() calls
    > __schedule().
    > need_resched() check in _nohz_idle_balance() exists to bail out of load
    > balancing if another task has woken up on the CPU currently in-charge of
    > idle load balancing which is being processed in SCHED_SOFTIRQ context.
    > Since the optimization mentioned above overloads the interpretation of
    > TIF_NEED_RESCHED, check for idle_cpu() before going with the existing
    > need_resched() check which can catch a genuine task wakeup on an idle
    > CPU processing SCHED_SOFTIRQ from do_softirq_post_smp_call_flush(), as
    > well as the case where ksoftirqd needs to be preempted as a result of
    > new task wakeup or slice expiry.
    > In case of PREEMPT_RT or threadirqs, although the idle load balancing
    > may be inhibited in some cases on the ilb CPU, the fact that ksoftirqd
    > is the only fair task going back to sleep will trigger a newidle balance
    > on the CPU which will alleviate some imbalance if it exists if idle
    > balance fails to do so.
    > Fixes: b2a02fc43a1f (&quot;smp: Optimize send_call_function_single_ipi()&quot;)
    > Signed-off-by: K Prateek Nayak &lt;kprateek.nayak@amd.com&gt;
    > Signed-off-by: Peter Zijlstra (Intel) &lt;peterz@infradead.org&gt;
    > Link: https://lore.kernel.org/r/20241119054432.6405-4-kprateek.nayak@amd.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ sched/deadline: Fix warning in migrate_enable for boosted tasks (@Wander Lairson Costa in [e41074904d9ed3f](https://github.com/sophgo/linux-riscv/commit/e41074904d9ed3f) at 2024-12-14 19:04:12)
    > [ Upstream commit 0664e2c311b9fa43b33e3e81429cd0c2d7f9c638 ]
    > When running the following command:
    > while true; do
    > stress-ng --cyclic 30 --timeout 30s --minimize --quiet
    > done
    > a warning is eventually triggered:
    > WARNING: CPU: 43 PID: 2848 at kernel/sched/deadline.c:794
    > setup_new_dl_entity+0x13e/0x180
    > ...
    > Call Trace:
    > &lt;TASK&gt;
    > ? show_trace_log_lvl+0x1c4/0x2df
    > ? enqueue_dl_entity+0x631/0x6e0
    > ? setup_new_dl_entity+0x13e/0x180
    > ? __warn+0x7e/0xd0
    > ? report_bug+0x11a/0x1a0
    > ? handle_bug+0x3c/0x70
    > ? exc_invalid_op+0x14/0x70
    > ? asm_exc_invalid_op+0x16/0x20
    > enqueue_dl_entity+0x631/0x6e0
    > enqueue_task_dl+0x7d/0x120
    > __do_set_cpus_allowed+0xe3/0x280
    > __set_cpus_allowed_ptr_locked+0x140/0x1d0
    > __set_cpus_allowed_ptr+0x54/0xa0
    > migrate_enable+0x7e/0x150
    > rt_spin_unlock+0x1c/0x90
    > group_send_sig_info+0xf7/0x1a0
    > ? kill_pid_info+0x1f/0x1d0
    > kill_pid_info+0x78/0x1d0
    > kill_proc_info+0x5b/0x110
    > __x64_sys_kill+0x93/0xc0
    > do_syscall_64+0x5c/0xf0
    > entry_SYSCALL_64_after_hwframe+0x6e/0x76
    > RIP: 0033:0x7f0dab31f92b
    > This warning occurs because set_cpus_allowed dequeues and enqueues tasks
    > with the ENQUEUE_RESTORE flag set. If the task is boosted, the warning
    > is triggered. A boosted task already had its parameters set by
    > rt_mutex_setprio, and a new call to setup_new_dl_entity is unnecessary,
    > hence the WARN_ON call.
    > Check if we are requeueing a boosted task and avoid calling
    > setup_new_dl_entity if that&#x27;s the case.
    > Fixes: 295d6d5e3736 (&quot;sched/deadline: Fix switching to -deadline&quot;)
    > Signed-off-by: Wander Lairson Costa &lt;wander@redhat.com&gt;
    > Signed-off-by: Peter Zijlstra (Intel) &lt;peterz@infradead.org&gt;
    > Acked-by: Juri Lelli &lt;juri.lelli@redhat.com&gt;
    > Link: https://lore.kernel.org/r/20240724142253.27145-2-wander@redhat.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ btrfs: drop unused parameter options from open_ctree() (@David Sterba in [b680ec3ad29b8b6](https://github.com/sophgo/linux-riscv/commit/b680ec3ad29b8b6) at 2024-12-14 19:04:12)
    > [ Upstream commit 87cbab86366e75dec52f787e0e0b17b2aea769ca ]
    > Since the new mount option parser in commit ad21f15b0f79 (&quot;btrfs:
    > switch to the new mount API&quot;) we don&#x27;t pass the options like that
    > anymore.
    > Reviewed-by: Anand Jain &lt;anand.jain@oracle.com&gt;
    > Signed-off-by: David Sterba &lt;dsterba@suse.com&gt;
    > Stable-dep-of: 951a3f59d268 (&quot;btrfs: fix mount failure due to remount races&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ sched/core: Prevent wakeup of ksoftirqd during idle load balance (@K Prateek Nayak in [b4ec68868c20385](https://github.com/sophgo/linux-riscv/commit/b4ec68868c20385) at 2024-12-14 19:04:12)
    > [ Upstream commit e932c4ab38f072ce5894b2851fea8bc5754bb8e5 ]
    > Scheduler raises a SCHED_SOFTIRQ to trigger a load balancing event on
    > from the IPI handler on the idle CPU. If the SMP function is invoked
    > from an idle CPU via flush_smp_call_function_queue() then the HARD-IRQ
    > flag is not set and raise_softirq_irqoff() needlessly wakes ksoftirqd
    > because soft interrupts are handled before ksoftirqd get on the CPU.
    > Adding a trace_printk() in nohz_csd_func() at the spot of raising
    > SCHED_SOFTIRQ and enabling trace events for sched_switch, sched_wakeup,
    > and softirq_entry (for SCHED_SOFTIRQ vector alone) helps observing the
    > current behavior:
    > &lt;idle&gt;-0   [000] dN.1.:  nohz_csd_func: Raising SCHED_SOFTIRQ from nohz_csd_func
    > &lt;idle&gt;-0   [000] dN.4.:  sched_wakeup: comm&#x3D;ksoftirqd/0 pid&#x3D;16 prio&#x3D;120 target_cpu&#x3D;000
    > &lt;idle&gt;-0   [000] .Ns1.:  softirq_entry: vec&#x3D;7 [action&#x3D;SCHED]
    > &lt;idle&gt;-0   [000] .Ns1.:  softirq_exit: vec&#x3D;7  [action&#x3D;SCHED]
    > &lt;idle&gt;-0   [000] d..2.:  sched_switch: prev_comm&#x3D;swapper/0 prev_pid&#x3D;0 prev_prio&#x3D;120 prev_state&#x3D;R &#x3D;&#x3D;&gt; next_comm&#x3D;ksoftirqd/0 next_pid&#x3D;16 next_prio&#x3D;120
    > ksoftirqd/0-16  [000] d..2.:  sched_switch: prev_comm&#x3D;ksoftirqd/0 prev_pid&#x3D;16 prev_prio&#x3D;120 prev_state&#x3D;S &#x3D;&#x3D;&gt; next_comm&#x3D;swapper/0 next_pid&#x3D;0 next_prio&#x3D;120
    > ...
    > Use __raise_softirq_irqoff() to raise the softirq. The SMP function call
    > is always invoked on the requested CPU in an interrupt handler. It is
    > guaranteed that soft interrupts are handled at the end.
    > Following are the observations with the changes when enabling the same
    > set of events:
    > &lt;idle&gt;-0       [000] dN.1.: nohz_csd_func: Raising SCHED_SOFTIRQ for nohz_idle_balance
    > &lt;idle&gt;-0       [000] dN.1.: softirq_raise: vec&#x3D;7 [action&#x3D;SCHED]
    > &lt;idle&gt;-0       [000] .Ns1.: softirq_entry: vec&#x3D;7 [action&#x3D;SCHED]
    > No unnecessary ksoftirqd wakeups are seen from idle task&#x27;s context to
    > service the softirq.
    > Fixes: b2a02fc43a1f (&quot;smp: Optimize send_call_function_single_ipi()&quot;)
    > Closes: https://lore.kernel.org/lkml/fcf823f-195e-6c9a-eac3-25f870cb35ac@inria.fr/ [1]
    > Reported-by: Julia Lawall &lt;julia.lawall@inria.fr&gt;
    > Suggested-by: Sebastian Andrzej Siewior &lt;bigeasy@linutronix.de&gt;
    > Signed-off-by: K Prateek Nayak &lt;kprateek.nayak@amd.com&gt;
    > Signed-off-by: Peter Zijlstra (Intel) &lt;peterz@infradead.org&gt;
    > Reviewed-by: Sebastian Andrzej Siewior &lt;bigeasy@linutronix.de&gt;
    > Link: https://lore.kernel.org/r/20241119054432.6405-5-kprateek.nayak@amd.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ sched/core: Remove the unnecessary need_resched() check in nohz_csd_func() (@K Prateek Nayak in [a39ad4f507bf528](https://github.com/sophgo/linux-riscv/commit/a39ad4f507bf528) at 2024-12-14 19:04:12)
    > [ Upstream commit ea9cffc0a154124821531991d5afdd7e8b20d7aa ]
    > The need_resched() check currently in nohz_csd_func() can be tracked
    > to have been added in scheduler_ipi() back in 2011 via commit
    > ca38062e57e9 (&quot;sched: Use resched IPI to kick off the nohz idle balance&quot;)
    > Since then, it has travelled quite a bit but it seems like an idle_cpu()
    > check currently is sufficient to detect the need to bail out from an
    > idle load balancing. To justify this removal, consider all the following
    > case where an idle load balancing could race with a task wakeup:
    > o Since commit f3dd3f674555b (&quot;sched: Remove the limitation of WF_ON_CPU
    > on wakelist if wakee cpu is idle&quot;) a target perceived to be idle
    > (target_rq-&gt;nr_running &#x3D;&#x3D; 0) will return true for
    > ttwu_queue_cond(target) which will offload the task wakeup to the idle
    > target via an IPI.
    > In all such cases target_rq-&gt;ttwu_pending will be set to 1 before
    > queuing the wake function.
    > If an idle load balance races here, following scenarios are possible:
    > - The CPU is not in TIF_POLLING_NRFLAG mode in which case an actual
    > IPI is sent to the CPU to wake it out of idle. If the
    > nohz_csd_func() queues before sched_ttwu_pending(), the idle load
    > balance will bail out since idle_cpu(target) returns 0 since
    > target_rq-&gt;ttwu_pending is 1. If the nohz_csd_func() is queued after
    > sched_ttwu_pending() it should see rq-&gt;nr_running to be non-zero and
    > bail out of idle load balancing.
    > - The CPU is in TIF_POLLING_NRFLAG mode and instead of an actual IPI,
    > the sender will simply set TIF_NEED_RESCHED for the target to put it
    > out of idle and flush_smp_call_function_queue() in do_idle() will
    > execute the call function. Depending on the ordering of the queuing
    > of nohz_csd_func() and sched_ttwu_pending(), the idle_cpu() check in
    > nohz_csd_func() should either see target_rq-&gt;ttwu_pending &#x3D; 1 or
    > target_rq-&gt;nr_running to be non-zero if there is a genuine task
    > wakeup racing with the idle load balance kick.
    > o The waker CPU perceives the target CPU to be busy
    > (targer_rq-&gt;nr_running !&#x3D; 0) but the CPU is in fact going idle and due
    > to a series of unfortunate events, the system reaches a case where the
    > waker CPU decides to perform the wakeup by itself in ttwu_queue() on
    > the target CPU but target is concurrently selected for idle load
    > balance (XXX: Can this happen? I&#x27;m not sure, but we&#x27;ll consider the
    > mother of all coincidences to estimate the worst case scenario).
    > ttwu_do_activate() calls enqueue_task() which would increment
    > &quot;rq-&gt;nr_running&quot; post which it calls wakeup_preempt() which is
    > responsible for setting TIF_NEED_RESCHED (via a resched IPI or by
    > setting TIF_NEED_RESCHED on a TIF_POLLING_NRFLAG idle CPU) The key
    > thing to note in this case is that rq-&gt;nr_running is already non-zero
    > in case of a wakeup before TIF_NEED_RESCHED is set which would
    > lead to idle_cpu() check returning false.
    > In all cases, it seems that need_resched() check is unnecessary when
    > checking for idle_cpu() first since an impending wakeup racing with idle
    > load balancer will either set the &quot;rq-&gt;ttwu_pending&quot; or indicate a newly
    > woken task via &quot;rq-&gt;nr_running&quot;.
    > Chasing the reason why this check might have existed in the first place,
    > I came across  Peter&#x27;s suggestion on the fist iteration of Suresh&#x27;s
    > patch from 2011 [1] where the condition to raise the SCHED_SOFTIRQ was:
    > sched_ttwu_do_pending(list);
    > if (unlikely((rq-&gt;idle &#x3D;&#x3D; current) &amp;&amp;
    > rq-&gt;nohz_balance_kick &amp;&amp;
    > !need_resched()))
    > raise_softirq_irqoff(SCHED_SOFTIRQ);
    > Since the condition to raise the SCHED_SOFIRQ was preceded by
    > sched_ttwu_do_pending() (which is equivalent of sched_ttwu_pending()) in
    > the current upstream kernel, the need_resched() check was necessary to
    > catch a newly queued task. Peter suggested modifying it to:
    > if (idle_cpu() &amp;&amp; rq-&gt;nohz_balance_kick &amp;&amp; !need_resched())
    > raise_softirq_irqoff(SCHED_SOFTIRQ);
    > where idle_cpu() seems to have replaced &quot;rq-&gt;idle &#x3D;&#x3D; current&quot; check.
    > Even back then, the idle_cpu() check would have been sufficient to catch
    > a new task being enqueued. Since commit b2a02fc43a1f (&quot;smp: Optimize
    > send_call_function_single_ipi()&quot;) overloads the interpretation of
    > TIF_NEED_RESCHED for TIF_POLLING_NRFLAG idling, remove the
    > need_resched() check in nohz_csd_func() to raise SCHED_SOFTIRQ based
    > on Peter&#x27;s suggestion.
    > Fixes: b2a02fc43a1f (&quot;smp: Optimize send_call_function_single_ipi()&quot;)
    > Suggested-by: Peter Zijlstra &lt;peterz@infradead.org&gt;
    > Signed-off-by: K Prateek Nayak &lt;kprateek.nayak@amd.com&gt;
    > Signed-off-by: Peter Zijlstra (Intel) &lt;peterz@infradead.org&gt;
    > Link: https://lore.kernel.org/r/20241119054432.6405-3-kprateek.nayak@amd.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/xe/guc: Copy GuC log prior to dumping (@John Harrison in [e7fd13686ae06c4](https://github.com/sophgo/linux-riscv/commit/e7fd13686ae06c4) at 2024-12-14 19:04:11)
    > [ Upstream commit a59a403419aa03d5e44c8cf014e415490395b17f ]
    > Add an extra stage to the GuC log print to copy the log buffer into
    > regular host memory first, rather than printing the live GPU buffer
    > object directly. Doing so helps prevent inconsistencies due to the log
    > being updated as it is being dumped. It also allows the use of the
    > ASCII85 helper function for printing the log in a more compact form
    > than a straight hex dump.
    > v2: Use %zx instead of %lx for size_t prints.
    > v3: Replace hexdump code with ascii85 call (review feedback from
    > Matthew B). Move chunking code into next patch as that reduces the
    > deltas of both.
    > v4: Add a prefix to the ASCII85 output to aid tool parsing.
    > Signed-off-by: John Harrison &lt;John.C.Harrison@Intel.com&gt;
    > Reviewed-by: Julia Filipchuk &lt;julia.filipchuk@intel.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20241003004611.2323493-6-John.C.Harrison@Intel.com
    > Stable-dep-of: 5dce85fecb87 (&quot;drm/xe: Move the coredump registration to the worker thread&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/xe/devcoredump: Add ASCII85 dump helper function (@John Harrison in [e3e6bea207ffa3e](https://github.com/sophgo/linux-riscv/commit/e3e6bea207ffa3e) at 2024-12-14 19:04:11)
    > [ Upstream commit ec1455ce7e35a31289d2dbc1070b980538698921 ]
    > There is a need to include the GuC log and other large binary objects
    > in core dumps and via dmesg. So add a helper for dumping to a printer
    > function via conversion to ASCII85 encoding.
    > Another issue with dumping such a large buffer is that it can be slow,
    > especially if dumping to dmesg over a serial port. So add a yield to
    > prevent the &#x27;task has been stuck for 120s&#x27; kernel hang check feature
    > from firing.
    > v2: Add a prefix to the output string. Fix memory allocation bug.
    > v3: Correct a string size calculation and clean up a define (review
    > feedback from Julia F).
    > Signed-off-by: John Harrison &lt;John.C.Harrison@Intel.com&gt;
    > Reviewed-by: Julia Filipchuk &lt;julia.filipchuk@intel.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20241003004611.2323493-5-John.C.Harrison@Intel.com
    > Stable-dep-of: 5dce85fecb87 (&quot;drm/xe: Move the coredump registration to the worker thread&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/xe/forcewake: Add a helper xe_force_wake_ref_has_domain() (@Himal Prasad Ghimiray in [deb05f8431f31e0](https://github.com/sophgo/linux-riscv/commit/deb05f8431f31e0) at 2024-12-14 19:04:11)
    > [ Upstream commit 9d62b07027f0710b7af03d78780d0a6c2425bc1e ]
    > The helper xe_force_wake_ref_has_domain() checks if the input domain
    > has been successfully reference-counted and awakened in the reference.
    > v2
    > - Fix commit message and kernel-doc (Michal)
    > - Remove unnecessary paranthesis (Michal)
    > Cc: Michal Wajdeczko &lt;michal.wajdeczko@intel.com&gt;
    > Cc: Badal Nilawar &lt;badal.nilawar@intel.com&gt;
    > Cc: Rodrigo Vivi &lt;rodrigo.vivi@intel.com&gt;
    > Signed-off-by: Himal Prasad Ghimiray &lt;himal.prasad.ghimiray@intel.com&gt;
    > Reviewed-by: Badal Nilawar &lt;badal.nilawar@intel.com&gt;
    > Reviewed-by: Michal Wajdeczko &lt;michal.wajdeczko@intel.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20241014075601.2324382-4-himal.prasad.ghimiray@intel.com
    > Signed-off-by: Rodrigo Vivi &lt;rodrigo.vivi@intel.com&gt;
    > Stable-dep-of: 5dce85fecb87 (&quot;drm/xe: Move the coredump registration to the worker thread&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/xe/devcoredump: Update handling of xe_force_wake_get return (@Himal Prasad Ghimiray in [7bcf6b3cc92a0e6](https://github.com/sophgo/linux-riscv/commit/7bcf6b3cc92a0e6) at 2024-12-14 19:04:11)
    > [ Upstream commit 9ffd6ec2de08ef4ac5f17f6131d1db57613493f9 ]
    > xe_force_wake_get() now returns the reference count-incremented domain
    > mask. If it fails for individual domains, the return value will always
    > be 0. However, for XE_FORCEWAKE_ALL, it may return a non-zero value even
    > in the event of failure. Use helper xe_force_wake_ref_has_domain to
    > verify all domains are initialized or not. Update the return handling of
    > xe_force_wake_get() to reflect this behavior, and ensure that the return
    > value is passed as input to xe_force_wake_put().
    > v3
    > - return xe_wakeref_t instead of int in xe_force_wake_get()
    > v5
    > - return unsigned int for xe_force_wake_get()
    > v6
    > - use helper xe_force_wake_ref_has_domain()
    > v7
    > - Fix commit message
    > Cc: Rodrigo Vivi &lt;rodrigo.vivi@intel.com&gt;
    > Cc: Lucas De Marchi &lt;lucas.demarchi@intel.com&gt;
    > Signed-off-by: Himal Prasad Ghimiray &lt;himal.prasad.ghimiray@intel.com&gt;
    > Reviewed-by: Nirmoy Das &lt;nirmoy.das@intel.com&gt;
    > Reviewed-by: Badal Nilawar &lt;badal.nilawar@intel.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20241014075601.2324382-12-himal.prasad.ghimiray@intel.com
    > Signed-off-by: Rodrigo Vivi &lt;rodrigo.vivi@intel.com&gt;
    > Stable-dep-of: 5dce85fecb87 (&quot;drm/xe: Move the coredump registration to the worker thread&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ sched: fix warning in sched_setaffinity (@Josh Don in [5c3fb75f538cfcb](https://github.com/sophgo/linux-riscv/commit/5c3fb75f538cfcb) at 2024-12-14 19:04:11)
    > [ Upstream commit 70ee7947a29029736a1a06c73a48ff37674a851b ]
    > Commit 8f9ea86fdf99b added some logic to sched_setaffinity that included
    > a WARN when a per-task affinity assignment races with a cpuset update.
    > Specifically, we can have a race where a cpuset update results in the
    > task affinity no longer being a subset of the cpuset. That&#x27;s fine; we
    > have a fallback to instead use the cpuset mask. However, we have a WARN
    > set up that will trigger if the cpuset mask has no overlap at all with
    > the requested task affinity. This shouldn&#x27;t be a warning condition; its
    > trivial to create this condition.
    > Reproduced the warning by the following setup:
    > - $PID inside a cpuset cgroup
    > - another thread repeatedly switching the cpuset cpus from 1-2 to just 1
    > - another thread repeatedly setting the $PID affinity (via taskset) to 2
    > Fixes: 8f9ea86fdf99b (&quot;sched: Always preserve the user requested cpumask&quot;)
    > Signed-off-by: Josh Don &lt;joshdon@google.com&gt;
    > Acked-and-tested-by: Vincent Guittot &lt;vincent.guittot@linaro.org&gt;
    > Signed-off-by: Peter Zijlstra (Intel) &lt;peterz@infradead.org&gt;
    > Acked-by: Waiman Long &lt;longman@redhat.com&gt;
    > Tested-by: Madadi Vineeth Reddy &lt;vineethr@linux.ibm.com&gt;
    > Link: https://lkml.kernel.org/r/20241111182738.1832953-1-joshdon@google.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/amd/display: Add option to retrieve detile buffer size (@Sung Lee in [4a2fcf88be76f88](https://github.com/sophgo/linux-riscv/commit/4a2fcf88be76f88) at 2024-12-14 19:04:11)
    > [ Upstream commit 6a7fd76b949efe40fb6d6677f480e624e0cb6e40 ]
    > [WHY]
    > For better power profiling knowing the detile
    > buffer size at a given point in time
    > would be useful.
    > [HOW]
    > Add interface to retrieve detile buffer from
    > dc state.
    > Cc: Mario Limonciello &lt;mario.limonciello@amd.com&gt;
    > Cc: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Cc: stable@vger.kernel.org
    > Reviewed-by: Aric Cyr &lt;aric.cyr@amd.com&gt;
    > Signed-off-by: Sung Lee &lt;Sung.Lee@amd.com&gt;
    > Signed-off-by: Alex Hung &lt;alex.hung@amd.com&gt;
    > Tested-by: Daniel Wheeler &lt;daniel.wheeler@amd.com&gt;
    > Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ io_uring/tctx: work around xa_store() allocation error issue (@Jens Axboe in [d5b2ddf1f90c724](https://github.com/sophgo/linux-riscv/commit/d5b2ddf1f90c724) at 2024-12-14 19:04:10)
    > [ Upstream commit 7eb75ce7527129d7f1fee6951566af409a37a1c4 ]
    > syzbot triggered the following WARN_ON:
    > WARNING: CPU: 0 PID: 16 at io_uring/tctx.c:51 __io_uring_free+0xfa/0x140 io_uring/tctx.c:51
    > which is the
    > WARN_ON_ONCE(!xa_empty(&amp;tctx-&gt;xa));
    > sanity check in __io_uring_free() when a io_uring_task is going through
    > its final put. The syzbot test case includes injecting memory allocation
    > failures, and it very much looks like xa_store() can fail one of its
    > memory allocations and end up with -&gt;head being non-NULL even though no
    > entries exist in the xarray.
    > Until this issue gets sorted out, work around it by attempting to
    > iterate entries in our xarray, and WARN_ON_ONCE() if one is found.
    > Reported-by: syzbot+cc36d44ec9f368e443d3@syzkaller.appspotmail.com
    > Link: https://lore.kernel.org/io-uring/673c1643.050a0220.87769.0066.GAE@google.com/
    > Signed-off-by: Jens Axboe &lt;axboe@kernel.dk&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ scsi: ufs: pltfrm: Dellocate HBA during ufshcd_pltfrm_remove() (@Manivannan Sadhasivam in [cd188519d2467ab](https://github.com/sophgo/linux-riscv/commit/cd188519d2467ab) at 2024-12-14 19:04:10)
    > [ Upstream commit 897df60c16d54ad515a3d0887edab5c63da06d1f ]
    > This will ensure that the scsi host is cleaned up properly using
    > scsi_host_dev_release(). Otherwise, it may lead to memory leaks.
    > Cc: stable@vger.kernel.org # 4.4
    > Fixes: 03b1781aa978 (&quot;[SCSI] ufs: Add Platform glue driver for ufshcd&quot;)
    > Signed-off-by: Manivannan Sadhasivam &lt;manivannan.sadhasivam@linaro.org&gt;
    > Link: https://lore.kernel.org/r/20241111-ufs_bug_fix-v1-5-45ad8b62f02e@linaro.org
    > Reviewed-by: Peter Wang &lt;peter.wang@mediatek.com&gt;
    > Reviewed-by: Bean Huo &lt;beanhuo@micron.com&gt;
    > Reviewed-by: Bart Van Assche &lt;bvanassche@acm.org&gt;
    > Signed-off-by: Martin K. Petersen &lt;martin.petersen@oracle.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ smb: client: don&#x27;t try following DFS links in cifs_tree_connect() (@Paulo Alcantara in [a21406d31414fd9](https://github.com/sophgo/linux-riscv/commit/a21406d31414fd9) at 2024-12-14 19:04:10)
    > [ Upstream commit 36008fe6e3dc588e5e9ceae6e82c7f69399eb5d8 ]
    > We can&#x27;t properly support chasing DFS links in cifs_tree_connect()
    > because
    > (1) We don&#x27;t support creating new sessions while we&#x27;re reconnecting,
    > which would be required for DFS interlinks.
    > (2) -&gt;is_path_accessible() can&#x27;t be called from cifs_tree_connect()
    > as it would deadlock with smb2_reconnect().  This is required for
    > checking if new DFS target is a nested DFS link.
    > By unconditionally trying to get an DFS referral from new DFS target
    > isn&#x27;t correct because if the new DFS target (interlink) is an DFS
    > standalone namespace, then we would end up getting -ELOOP and then
    > potentially leaving tcon disconnected.
    > Signed-off-by: Paulo Alcantara (Red Hat) &lt;pc@manguebit.com&gt;
    > Signed-off-by: Steve French &lt;stfrench@microsoft.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/xe/devcoredump: Use drm_puts and already cached local variables (@John Harrison in [7e4b4543078f87e](https://github.com/sophgo/linux-riscv/commit/7e4b4543078f87e) at 2024-12-14 19:04:10)
    > [ Upstream commit 9d86d080cfb3ab935c842ac5525a90430a14c998 ]
    > There are a bunch of calls to drm_printf with static strings. Switch
    > them to drm_puts instead.
    > There are also a bunch of &#x27;coredump-&gt;snapshot.XXX&#x27; references when
    > &#x27;coredump-&gt;snapshot&#x27; has alread been cached locally as &#x27;ss&#x27;. So use
    > &#x27;ss-&gt;XXX&#x27; instead.
    > Signed-off-by: John Harrison &lt;John.C.Harrison@Intel.com&gt;
    > Reviewed-by: Julia Filipchuk &lt;julia.filipchuk@intel.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20241003004611.2323493-3-John.C.Harrison@Intel.com
    > Stable-dep-of: 5dce85fecb87 (&quot;drm/xe: Move the coredump registration to the worker thread&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/xe/devcoredump: Improve section headings and add tile info (@John Harrison in [47c45a050d09736](https://github.com/sophgo/linux-riscv/commit/47c45a050d09736) at 2024-12-14 19:04:10)
    > [ Upstream commit c28fd6c358db44c87a1408f27ba412c94e25e6c2 ]
    > The xe_guc_exec_queue_snapshot is not really a GuC internal thing and
    > is definitely not a GuC CT thing. So give it its own section heading.
    > The snapshot itself is really a capture of the submission backend&#x27;s
    > internal state. Although all it currently prints out is the submission
    > contexts. So label it as &#x27;Contexts&#x27;. If more general state is added
    > later then it could be change to &#x27;Submission backend&#x27; or some such.
    > Further, everything from the GuC CT section onwards is GT specific but
    > there was no indication of which GT it was related to (and that is
    > impossible to work out from the other fields that are given). So add a
    > GT section heading. Also include the tile id of the GT, because again
    > significant information.
    > Lastly, drop a couple of unnecessary line feeds within sections.
    > v2: Add GT section heading, add tile id to device section.
    > Signed-off-by: John Harrison &lt;John.C.Harrison@Intel.com&gt;
    > Reviewed-by: Julia Filipchuk &lt;julia.filipchuk@intel.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20241003004611.2323493-4-John.C.Harrison@Intel.com
    > Stable-dep-of: 5dce85fecb87 (&quot;drm/xe: Move the coredump registration to the worker thread&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ setlocalversion: work around &quot;git describe&quot; performance (@Rasmus Villemoes in [1f659d3c13f8e27](https://github.com/sophgo/linux-riscv/commit/1f659d3c13f8e27) at 2024-12-14 19:04:10)
    > [ Upstream commit 523f3dbc187a9618d4fd80c2b438e4d490705dcd ]
    > Contrary to expectations, passing a single candidate tag to &quot;git
    > describe&quot; is slower than not passing any --match options.
    > $ time git describe --debug
    > ...
    > traversed 10619 commits
    > ...
    > v6.12-rc5-63-g0fc810ae3ae1
    > real    0m0.169s
    > $ time git describe --match&#x3D;v6.12-rc5 --debug
    > ...
    > traversed 1310024 commits
    > v6.12-rc5-63-g0fc810ae3ae1
    > real    0m1.281s
    > In fact, the --debug output shows that git traverses all or most of
    > history. For some repositories and/or git versions, those 1.3s are
    > actually 10-15 seconds.
    > This has been acknowledged as a performance bug in git [1], and a fix
    > is on its way [2]. However, no solution is yet in git.git, and even
    > when one lands, it will take quite a while before it finds its way to
    > a release and for $random_kernel_developer to pick that up.
    > So rewrite the logic to use plumbing commands. For each of the
    > candidate values of $tag, we ask: (1) is $tag even an annotated
    > tag? (2) Is it eligible to describe HEAD, i.e. an ancestor of
    > HEAD? (3) If so, how many commits are in $tag..HEAD?
    > I have tested that this produces the same output as the current script
    > for ~700 random commits between v6.9..v6.10. For those 700 commits,
    > and in my git repo, the &#x27;make -s kernelrelease&#x27; command is on average
    > ~4 times faster with this patch applied (geometric mean of ratios).
    > For the commit mentioned in Josh&#x27;s original report [3], the
    > time-consuming part of setlocalversion goes from
    > $ time git describe --match&#x3D;v6.12-rc5 c1e939a21eb1
    > v6.12-rc5-44-gc1e939a21eb1
    > real    0m1.210s
    > to
    > $ time git rev-list --count --left-right v6.12-rc5..c1e939a21eb1
    > 0       44
    > real    0m0.037s
    > [1] https://lore.kernel.org/git/20241101113910.GA2301440@coredump.intra.peff.net/
    > [2] https://lore.kernel.org/git/20241106192236.GC880133@coredump.intra.peff.net/
    > [3] https://lore.kernel.org/lkml/309549cafdcfe50c4fceac3263220cc3d8b109b2.1730337435.git.jpoimboe@kernel.org/
    > Reported-by: Sean Christopherson &lt;seanjc@google.com&gt;
    > Closes: https://lore.kernel.org/lkml/ZPtlxmdIJXOe0sEy@google.com/
    > Reported-by: Josh Poimboeuf &lt;jpoimboe@kernel.org&gt;
    > Closes: https://lore.kernel.org/lkml/309549cafdcfe50c4fceac3263220cc3d8b109b2.1730337435.git.jpoimboe@kernel.org/
    > Tested-by: Josh Poimboeuf &lt;jpoimboe@kernel.org&gt;
    > Signed-off-by: Rasmus Villemoes &lt;linux@rasmusvillemoes.dk&gt;
    > Signed-off-by: Masahiro Yamada &lt;masahiroy@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ rtc: cmos: avoid taking rtc_lock for extended period of time (@Dmitry Torokhov in [f43324df566a29c](https://github.com/sophgo/linux-riscv/commit/f43324df566a29c) at 2024-12-14 19:04:09)
    > [ Upstream commit 0a6efab33eab4e973db26d9f90c3e97a7a82e399 ]
    > On my device reading entirety of /sys/devices/pnp0/00:03/cmos_nvram0/nvmem
    > takes about 9 msec during which time interrupts are off on the CPU that
    > does the read and the thread that performs the read can not be migrated
    > or preempted by another higher priority thread (RT or not).
    > Allow readers and writers be preempted by taking and releasing rtc_lock
    > spinlock for each individual byte read or written rather than once per
    > read/write request.
    > Signed-off-by: Dmitry Torokhov &lt;dmitry.torokhov@gmail.com&gt;
    > Reviewed-by: Mateusz Jończyk &lt;mat.jonczyk@o2.pl&gt;
    > Link: https://lore.kernel.org/r/Zxv8QWR21AV4ztC5@google.com
    > Signed-off-by: Alexandre Belloni &lt;alexandre.belloni@bootlin.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ irqchip/gicv3-its: Add workaround for hip09 ITS erratum 162100801 (@Zhou Wang in [9ac8c1da9f82e62](https://github.com/sophgo/linux-riscv/commit/9ac8c1da9f82e62) at 2024-12-14 19:04:09)
    > [ Upstream commit f82e62d470cc990ebd9d691f931dd418e4e9cea9 ]
    > When enabling GICv4.1 in hip09, VMAPP fails to clear some caches during
    > the unmap operation, which can causes vSGIs to be lost.
    > To fix the issue, invalidate the related vPE cache through GICR_INVALLR
    > after VMOVP.
    > Suggested-by: Marc Zyngier &lt;maz@kernel.org&gt;
    > Co-developed-by: Nianyao Tang &lt;tangnianyao@huawei.com&gt;
    > Signed-off-by: Nianyao Tang &lt;tangnianyao@huawei.com&gt;
    > Signed-off-by: Zhou Wang &lt;wangzhou1@hisilicon.com&gt;
    > Signed-off-by: Thomas Gleixner &lt;tglx@linutronix.de&gt;
    > Reviewed-by: Marc Zyngier &lt;maz@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ Revert &quot;nvme: make keep-alive synchronous operation&quot; (@Nilay Shroff in [950210c9c721f0b](https://github.com/sophgo/linux-riscv/commit/950210c9c721f0b) at 2024-12-14 19:04:09)
    > [ Upstream commit 84488282166de6b6760ada8030e87aaa08bce3aa ]
    > This reverts commit d06923670b5a5f609603d4a9fee4dec02d38de9c.
    > It was realized that the fix implemented to contain the race condition
    > among the keep alive task and the fabric shutdown code path in the commit
    > d06923670b5ia (&quot;nvme: make keep-alive synchronous operation&quot;) is not
    > optimal. The reason being keep-alive runs under the workqueue and making
    > it synchronous would waste a workqueue context.
    > Furthermore, we later found that the above race condition is a regression
    > caused due to the changes implemented in commit a54a93d0e359 (&quot;nvme: move
    > stopping keep-alive into nvme_uninit_ctrl()&quot;). So we decided to revert the
    > commit d06923670b5a (&quot;nvme: make keep-alive synchronous operation&quot;) and
    > then fix the regression.
    > Link: https://lore.kernel.org/all/196f4013-3bbf-43ff-98b4-9cb2a96c20c2@grimberg.me/
    > Reviewed-by: Ming Lei &lt;ming.lei@redhat.com&gt;
    > Signed-off-by: Nilay Shroff &lt;nilay@linux.ibm.com&gt;
    > Signed-off-by: Keith Busch &lt;kbusch@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ misc: eeprom: eeprom_93cx6: Add quirk for extra read clock cycle (@Parker Newman in [65570470175cc6a](https://github.com/sophgo/linux-riscv/commit/65570470175cc6a) at 2024-12-14 19:04:09)
    > [ Upstream commit 7738a7ab9d12c5371ed97114ee2132d4512e9fd5 ]
    > Add a quirk similar to eeprom_93xx46 to add an extra clock cycle before
    > reading data from the EEPROM.
    > The 93Cx6 family of EEPROMs output a &quot;dummy 0 bit&quot; between the writing
    > of the op-code/address from the host to the EEPROM and the reading of
    > the actual data from the EEPROM.
    > More info can be found on page 6 of the AT93C46 datasheet (linked below).
    > Similar notes are found in other 93xx6 datasheets.
    > In summary the read operation for a 93Cx6 EEPROM is:
    > Write to EEPROM:	110[A5-A0]	(9 bits)
    > Read from EEPROM:	0[D15-D0]	(17 bits)
    > Where:
    > 110 is the start bit and READ OpCode
    > [A5-A0] is the address to read from
    > 0 is a &quot;dummy bit&quot; preceding the actual data
    > [D15-D0] is the actual data.
    > Looking at the READ timing diagrams in the 93Cx6 datasheets the dummy
    > bit should be clocked out on the last address bit clock cycle meaning it
    > should be discarded naturally.
    > However, depending on the hardware configuration sometimes this dummy
    > bit is not discarded. This is the case with Exar PCI UARTs which require
    > an extra clock cycle between sending the address and reading the data.
    > Datasheet: https://ww1.microchip.com/downloads/en/DeviceDoc/Atmel-5193-SEEPROM-AT93C46D-Datasheet.pdf
    > Reviewed-by: Andy Shevchenko &lt;andriy.shevchenko@linux.intel.com&gt;
    > Signed-off-by: Parker Newman &lt;pnewman@connecttech.com&gt;
    > Link: https://lore.kernel.org/r/0f23973efefccd2544705a0480b4ad4c2353e407.1727880931.git.pnewman@connecttech.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ powerpc/prom_init: Fixup missing powermac #size-cells (@Michael Ellerman in [296a109fa77110b](https://github.com/sophgo/linux-riscv/commit/296a109fa77110b) at 2024-12-14 19:04:09)
    > [ Upstream commit cf89c9434af122f28a3552e6f9cc5158c33ce50a ]
    > On some powermacs &#x60;escc&#x60; nodes are missing &#x60;#size-cells&#x60; properties,
    > which is deprecated and now triggers a warning at boot since commit
    > 045b14ca5c36 (&quot;of: WARN on deprecated #address-cells/#size-cells
    > handling&quot;).
    > For example:
    > Missing &#x27;#size-cells&#x27; in /pci@f2000000/mac-io@c/escc@13000
    > WARNING: CPU: 0 PID: 0 at drivers/of/base.c:133 of_bus_n_size_cells+0x98/0x108
    > Hardware name: PowerMac3,1 7400 0xc0209 PowerMac
    > ...
    > Call Trace:
    > of_bus_n_size_cells+0x98/0x108 (unreliable)
    > of_bus_default_count_cells+0x40/0x60
    > __of_get_address+0xc8/0x21c
    > __of_address_to_resource+0x5c/0x228
    > pmz_init_port+0x5c/0x2ec
    > pmz_probe.isra.0+0x144/0x1e4
    > pmz_console_init+0x10/0x48
    > console_init+0xcc/0x138
    > start_kernel+0x5c4/0x694
    > As powermacs boot via prom_init it&#x27;s possible to add the missing
    > properties to the device tree during boot, avoiding the warning. Note
    > that &#x60;escc-legacy&#x60; nodes are also missing &#x60;#size-cells&#x60; properties, but
    > they are skipped by the macio driver, so leave them alone.
    > Depends-on: 045b14ca5c36 (&quot;of: WARN on deprecated #address-cells/#size-cells handling&quot;)
    > Signed-off-by: Michael Ellerman &lt;mpe@ellerman.id.au&gt;
    > Reviewed-by: Rob Herring &lt;robh@kernel.org&gt;
    > Signed-off-by: Madhavan Srinivasan &lt;maddy@linux.ibm.com&gt;
    > Link: https://patch.msgid.link/20241126025710.591683-1-mpe@ellerman.id.au
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ serial: 8250_dw: Add Sophgo SG2044 quirk (@Inochi Amaoto in [1648c7000f9dd12](https://github.com/sophgo/linux-riscv/commit/1648c7000f9dd12) at 2024-12-14 19:04:09)
    > [ Upstream commit cad4dda82c7eedcfc22597267e710ccbcf39d572 ]
    > SG2044 relys on an internal divisor when calculating bitrate, which
    > means a wrong clock for the most common bitrates. So add a quirk for
    > this uart device to skip the set rate call and only relys on the
    > internal UART divisor.
    > Reviewed-by: Andy Shevchenko &lt;andriy.shevchenko@linux.intel.com&gt;
    > Reviewed-by: Ilpo Järvinen &lt;ilpo.jarvinen@linux.intel.com&gt;
    > Signed-off-by: Inochi Amaoto &lt;inochiama@gmail.com&gt;
    > Link: https://lore.kernel.org/r/20241024062105.782330-4-inochiama@gmail.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ASoC: amd: yc: fix internal mic on Redmi G 2022 (@Alex Far in [e451d7ca7870fe3](https://github.com/sophgo/linux-riscv/commit/e451d7ca7870fe3) at 2024-12-14 19:04:08)
    > [ Upstream commit 67a0463d339059eeeead9cd015afa594659cfdaf ]
    > This laptop model requires an additional detection quirk to enable the
    > internal microphone
    > Signed-off-by: Alex Far &lt;anf1980@gmail.com&gt;
    > Link: https://patch.msgid.link/ZzjrZY3sImcqTtGx@RedmiG
    > Signed-off-by: Mark Brown &lt;broonie@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ iio: adc: ad7192: properly check spi_get_device_match_data() (@Nuno Sa in [c5d8facf107a259](https://github.com/sophgo/linux-riscv/commit/c5d8facf107a259) at 2024-12-14 19:04:08)
    > [ Upstream commit b7f99fa1b64af2f696b13cec581cb4cd7d3982b8 ]
    > spi_get_device_match_data() can return a NULL pointer. Hence, let&#x27;s
    > check for it.
    > Signed-off-by: Nuno Sa &lt;nuno.sa@analog.com&gt;
    > Link: https://patch.msgid.link/20241014-fix-error-check-v1-1-089e1003d12f@analog.com
    > Signed-off-by: Jonathan Cameron &lt;Jonathan.Cameron@huawei.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ usb: typec: ucsi: glink: be more precise on orientation-aware ports (@Dmitry Baryshkov in [b03142825986f19](https://github.com/sophgo/linux-riscv/commit/b03142825986f19) at 2024-12-14 19:04:08)
    > [ Upstream commit de9df030ccb5d3e31ee0c715d74cd77c619748f8 ]
    > Instead of checking if any of the USB-C ports have orientation GPIO and
    > thus is orientation-aware, check for the GPIO for the port being
    > registered. There are no boards that are affected by this change at this
    > moment, so the patch is not marked as a fix, but it might affect other
    > boards in future.
    > Reviewed-by: Abel Vesa &lt;abel.vesa@linaro.org&gt;
    > Reviewed-by: Neil Armstrong &lt;neil.armstrong@linaro.org&gt;
    > Reviewed-by: Johan Hovold &lt;johan+linaro@kernel.org&gt;
    > Tested-by: Johan Hovold &lt;johan+linaro@kernel.org&gt;
    > Signed-off-by: Dmitry Baryshkov &lt;dmitry.baryshkov@linaro.org&gt;
    > Link: https://lore.kernel.org/r/20241109-ucsi-glue-fixes-v2-2-8b21ff4f9fbe@linaro.org
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/amdgpu/vcn: reset fw_shared when VCPU buffers corrupted on vcn v4.0.3 (@Xiang Liu in [3c1d06bbad22558](https://github.com/sophgo/linux-riscv/commit/3c1d06bbad22558) at 2024-12-14 19:04:08)
    > [ Upstream commit 928cd772e18ffbd7723cb2361db4a8ccf2222235 ]
    > It is not necessarily corrupted. When there is RAS fatal error, device
    > memory access is blocked. Hence vcpu bo cannot be saved to system memory
    > as in a regular suspend sequence before going for reset. In other full
    > device reset cases, that gets saved and restored during resume.
    > v2: Remove redundant code like vcn_v4_0 did
    > v2: Refine commit message
    > v3: Drop the volatile
    > v3: Refine commit message
    > Signed-off-by: Xiang Liu &lt;xiang.liu@amd.com&gt;
    > Acked-by: Christian König &lt;christian.koenig@amd.com&gt;
    > Reviewed-by: Stanley.Yang &lt;Stanley.Yang@amd.com&gt;
    > Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ iio: light: ltr501: Add LTER0303 to the supported devices (@Andy Shevchenko in [359eebd5e7f62b2](https://github.com/sophgo/linux-riscv/commit/359eebd5e7f62b2) at 2024-12-14 19:04:08)
    > [ Upstream commit c26acb09ccbef47d1fddaf0783c1392d0462122c ]
    > It has been found that the (non-vendor issued) ACPI ID for Lite-On
    > LTR303 is present in Microsoft catalog. Add it to the list of the
    > supported devices.
    > Link: https://www.catalog.update.microsoft.com/Search.aspx?q&#x3D;lter0303
    > Closes: https://lore.kernel.org/r/9cdda3e0-d56e-466f-911f-96ffd6f602c8@redhat.com
    > Reported-by: Hans de Goede &lt;hdegoede@redhat.com&gt;
    > Reviewed-by: Hans de Goede &lt;hdegoede@redhat.com&gt;
    > Signed-off-by: Andy Shevchenko &lt;andriy.shevchenko@linux.intel.com&gt;
    > Link: https://patch.msgid.link/20241024191200.229894-24-andriy.shevchenko@linux.intel.com
    > Signed-off-by: Jonathan Cameron &lt;Jonathan.Cameron@huawei.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ASoC: amd: yc: Add quirk for microphone on Lenovo Thinkpad T14s Gen 6 21M1CTO1WW (@Uwe Kleine-König in [01e49d7f3f506c2](https://github.com/sophgo/linux-riscv/commit/01e49d7f3f506c2) at 2024-12-14 19:04:08)
    > [ Upstream commit cbc86dd0a4fe9f8c41075328c2e740b68419d639 ]
    > Add a quirk for Tova&#x27;s Lenovo Thinkpad T14s with product name 21M1.
    > Suggested-by: Tova &lt;blueaddagio@laposte.net&gt;
    > Link: https://bugs.debian.org/1087673
    > Signed-off-by: Uwe Kleine-König &lt;ukleinek@debian.org&gt;
    > Link: https://patch.msgid.link/20241122075606.213132-2-ukleinek@debian.org
    > Signed-off-by: Mark Brown &lt;broonie@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ MIPS: Loongson64: DTS: Really fix PCIe port nodes for ls7a (@Xi Ruoyao in [01575f2ff8ba578](https://github.com/sophgo/linux-riscv/commit/01575f2ff8ba578) at 2024-12-14 19:04:08)
    > [ Upstream commit 4fbd66d8254cedfd1218393f39d83b6c07a01917 ]
    > Fix the dtc warnings:
    > arch/mips/boot/dts/loongson/ls7a-pch.dtsi:68.16-416.5: Warning (interrupt_provider): /bus@10000000/pci@1a000000: &#x27;#interrupt-cells&#x27; found, but node is not an interrupt provider
    > arch/mips/boot/dts/loongson/ls7a-pch.dtsi:68.16-416.5: Warning (interrupt_provider): /bus@10000000/pci@1a000000: &#x27;#interrupt-cells&#x27; found, but node is not an interrupt provider
    > arch/mips/boot/dts/loongson/loongson64g_4core_ls7a.dtb: Warning (interrupt_map): Failed prerequisite &#x27;interrupt_provider&#x27;
    > And a runtime warning introduced in commit 045b14ca5c36 (&quot;of: WARN on
    > deprecated #address-cells/#size-cells handling&quot;):
    > WARNING: CPU: 0 PID: 1 at drivers/of/base.c:106 of_bus_n_addr_cells+0x9c/0xe0
    > Missing &#x27;#address-cells&#x27; in /bus@10000000/pci@1a000000/pci_bridge@9,0
    > The fix is similar to commit d89a415ff8d5 (&quot;MIPS: Loongson64: DTS: Fix PCIe
    > port nodes for ls7a&quot;), which has fixed the issue for ls2k (despite its
    > subject mentions ls7a).
    > Signed-off-by: Xi Ruoyao &lt;xry111@xry111.site&gt;
    > Signed-off-by: Thomas Bogendoerfer &lt;tsbogend@alpha.franken.de&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ usb: chipidea: udc: create bounce buffer for problem sglist entries if possible (@Xu Yang in [f14e63cf8649bd2](https://github.com/sophgo/linux-riscv/commit/f14e63cf8649bd2) at 2024-12-14 19:04:07)
    > [ Upstream commit edfcc455c85ccc5855f0c329ca5a2d85cc9fc6c6 ]
    > The chipidea controller doesn&#x27;t fully support sglist, such as it can not
    > transfer data spanned more dTDs to form a bus packet, so it can only work
    > on very limited cases.
    > The limitations as below:
    > 1. the end address of the first sg buffer must be 4KB aligned.
    > 2. the start and end address of the middle sg buffer must be 4KB aligned.
    > 3. the start address of the first sg buffer must be 4KB aligned.
    > However, not all the use cases violate these limitations. To make the
    > controller compatible with most of the cases, this will try to bounce the
    > problem sglist entries which can be found by sglist_get_invalid_entry().
    > Then a bounced line buffer (the size will roundup to page size) will be
    > allocated to replace the remaining problem sg entries. The data will be
    > copied between problem sg entries and bounce buffer according to the
    > transfer direction. The bounce buffer will be freed when the request
    > completed.
    > Acked-by: Peter Chen &lt;peter.chen@kernel.com&gt;
    > Signed-off-by: Xu Yang &lt;xu.yang_2@nxp.com&gt;
    > Link: https://lore.kernel.org/r/20240923081203.2851768-3-xu.yang_2@nxp.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ usb: typec: ucsi: Do not call ACPI _DSM method for UCSI read operations (@Saranya Gopal in [c0ca6fd5f6ebde8](https://github.com/sophgo/linux-riscv/commit/c0ca6fd5f6ebde8) at 2024-12-14 19:04:07)
    > [ Upstream commit fa48d7e81624efdf398b990a9049e9cd75a5aead ]
    > ACPI _DSM methods are needed only for UCSI write operations and for reading
    > CCI during RESET_PPM operation. So, remove _DSM calls from other places.
    > While there, remove the Zenbook quirk also since the default behavior
    > now aligns with the Zenbook quirk. With this change, GET_CONNECTOR_STATUS
    > returns at least 6 seconds faster than before in Arrowlake-S platforms.
    > Reviewed-by: Heikki Krogerus &lt;heikki.krogerus@linux.intel.com&gt;
    > Signed-off-by: Saranya Gopal &lt;saranya.gopal@intel.com&gt;
    > Reviewed-by: Christian A. Ehrhardt &lt;lk@c--e.de&gt;
    > Link: https://lore.kernel.org/r/20240830084342.460109-1-saranya.gopal@intel.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ usb: chipidea: add CI_HDRC_HAS_SHORT_PKT_LIMIT flag (@Xu Yang in [b89bbf32fc46e05](https://github.com/sophgo/linux-riscv/commit/b89bbf32fc46e05) at 2024-12-14 19:04:07)
    > [ Upstream commit ec841b8d73cff37f8960e209017efe1eb2fb21f2 ]
    > Currently, the imx deivice controller has below limitations:
    > 1. can&#x27;t generate short packet interrupt if IOC not set in dTD. So if one
    > request span more than one dTDs and only the last dTD set IOC, the usb
    > request will pending there if no more data comes.
    > 2. the controller can&#x27;t accurately deliver data to differtent usb requests
    > in some cases due to short packet. For example: one usb request span 3
    > dTDs, then if the controller received a short packet the next packet
    > will go to 2nd dTD of current request rather than the first dTD of next
    > request.
    > 3. can&#x27;t build a bus packet use multiple dTDs. For example: controller
    > needs to send one packet of 512 bytes use dTD1 (200 bytes) + dTD2
    > (312 bytes), actually the host side will see 200 bytes short packet.
    > Based on these limits, add CI_HDRC_HAS_SHORT_PKT_LIMIT flag and use it on
    > imx platforms.
    > Signed-off-by: Xu Yang &lt;xu.yang_2@nxp.com&gt;
    > Acked-by: Peter Chen &lt;peter.chen@kernel.org&gt;
    > Link: https://lore.kernel.org/r/20240923081203.2851768-1-xu.yang_2@nxp.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ usb: chipidea: udc: limit usb request length to max 16KB (@Xu Yang in [8a5c06ebc2ee82c](https://github.com/sophgo/linux-riscv/commit/8a5c06ebc2ee82c) at 2024-12-14 19:04:07)
    > [ Upstream commit ca8d18aa7b0f22d66a3ca9a90d8f73431b8eca89 ]
    > To let the device controller work properly on short packet limitations,
    > one usb request should only correspond to one dTD. Then every dTD will
    > set IOC. In theory, each dTD support up to 20KB data transfer if the
    > offset is 0. Due to we cannot predetermine the offset, this will limit
    > the usb request length to max 16KB. This should be fine since most of
    > the user transfer data based on this size policy.
    > Signed-off-by: Xu Yang &lt;xu.yang_2@nxp.com&gt;
    > Acked-by: Peter Chen &lt;peter.chen@kernel.org&gt;
    > Link: https://lore.kernel.org/r/20240923081203.2851768-2-xu.yang_2@nxp.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ regulator: qcom-rpmh: Update ranges for FTSMPS525 (@Melody Olvera in [4bbdddcefeb595f](https://github.com/sophgo/linux-riscv/commit/4bbdddcefeb595f) at 2024-12-14 19:04:07)
    > [ Upstream commit eeecf953d697cb7f0d916f9908a2b9f451bb2667 ]
    > All FTSMPS525 regulators support LV and MV ranges; however,
    > the boot loader firmware will determine which range to use as
    > the device boots.
    > Nonetheless, the driver cannot determine which range was selected,
    > so hardcoding the ranges as either LV or MV will not cover all cases
    > as it&#x27;s possible for the firmware to select a range not supported by
    > the driver&#x27;s current hardcoded values.
    > To this end, combine the ranges for the FTSMPS525s into one struct
    > and point all regulators to the updated combined struct. This should
    > work on all boards regardless of which range is selected by the firmware
    > and more accurately caputres the capability of this regulator on a
    > hardware level.
    > Signed-off-by: Melody Olvera &lt;quic_molvera@quicinc.com&gt;
    > Reviewed-by: Dmitry Baryshkov &lt;dmitry.baryshkov@linaro.org&gt;
    > Link: https://patch.msgid.link/20241112002645.2803506-1-quic_molvera@quicinc.com
    > Signed-off-by: Mark Brown &lt;broonie@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ usb: chipidea: udc: handle USB Error Interrupt if IOC not set (@Xu Yang in [37065eee084e3b5](https://github.com/sophgo/linux-riscv/commit/37065eee084e3b5) at 2024-12-14 19:04:07)
    > [ Upstream commit 548f48b66c0c5d4b9795a55f304b7298cde2a025 ]
    > As per USBSTS register description about UEI:
    > When completion of a USB transaction results in an error condition, this
    > bit is set by the Host/Device Controller. This bit is set along with the
    > USBINT bit, if the TD on which the error interrupt occurred also had its
    > interrupt on complete (IOC) bit set.
    > UI is set only when IOC set. Add checking UEI to fix miss call
    > isr_tr_complete_handler() when IOC have not set and transfer error happen.
    > Acked-by: Peter Chen &lt;peter.chen@kernel.com&gt;
    > Signed-off-by: Xu Yang &lt;xu.yang_2@nxp.com&gt;
    > Link: https://lore.kernel.org/r/20240926022906.473319-1-xu.yang_2@nxp.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ fs/ntfs3: Fix case when unmarked clusters intersect with zone (@Konstantin Komarov in [db7fc56646cafe3](https://github.com/sophgo/linux-riscv/commit/db7fc56646cafe3) at 2024-12-14 19:04:06)
    > [ Upstream commit 5fc982fe7eca9d0cf7b25832450ebd4f7c8e1c36 ]
    > Reported-by: syzbot+7f3761b790fa41d0f3d5@syzkaller.appspotmail.com
    > Signed-off-by: Konstantin Komarov &lt;almaz.alexandrovich@paragon-software.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ACPI: x86: Add skip i2c clients quirk for Acer Iconia One 8 A1-840 (@Hans de Goede in [ac0536c564ec226](https://github.com/sophgo/linux-riscv/commit/ac0536c564ec226) at 2024-12-14 19:04:06)
    > [ Upstream commit 82f250ed1a1dcde0ad2a1513f85af7f9514635e8 ]
    > The Acer Iconia One 8 A1-840 (not to be confused with the A1-840FHD which
    > is a different model) ships with Android 4.4 as factory OS and has the
    > usual broken DSDT issues for x86 Android tablets.
    > Add quirks to skip ACPI I2C client enumeration and disable ACPI battery/AC
    > and ACPI GPIO event handlers.
    > Also add the &quot;INT33F5&quot; HID for the TI PMIC used on this tablet to the list
    > of HIDs for which not to skip i2c_client instantiation, since we do want
    > an ACPI instantiated i2c_client for the PMIC.
    > Signed-off-by: Hans de Goede &lt;hdegoede@redhat.com&gt;
    > Link: https://patch.msgid.link/20241116095825.11660-1-hdegoede@redhat.com
    > Signed-off-by: Rafael J. Wysocki &lt;rafael.j.wysocki@intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ f2fs: add a sysfs node to limit max read extent count per-inode (@Chao Yu in [7c2e5ed2175e4ab](https://github.com/sophgo/linux-riscv/commit/7c2e5ed2175e4ab) at 2024-12-14 19:04:06)
    > [ Upstream commit 009a8241a8e5a14ea2dd0b8db42dbf283527dd44 ]
    > Quoted:
    > &quot;at this time, there are still 1086911 extent nodes in this zombie
    > extent tree that need to be cleaned up.
    > crash_arm64_sprd_v8.0.3++&gt; extent_tree.node_cnt ffffff80896cc500
    > node_cnt &#x3D; {
    > counter &#x3D; 1086911
    > },
    > &quot;
    > As reported by Xiuhong, there will be a huge number of extent nodes
    > in extent tree, it may potentially cause:
    > - slab memory fragments
    > - extreme long time shrink on extent tree
    > - low mapping efficiency
    > Let&#x27;s add a sysfs node to limit max read extent count for each inode,
    > by default, value of this threshold is 10240, it can be updated
    > according to user&#x27;s requirement.
    > Reported-by: Xiuhong Wang &lt;xiuhong.wang@unisoc.com&gt;
    > Closes: https://lore.kernel.org/linux-f2fs-devel/20241112110627.1314632-1-xiuhong.wang@unisoc.com/
    > Signed-off-by: Xiuhong Wang &lt;xiuhong.wang@unisoc.com&gt;
    > Signed-off-by: Zhiguo Niu &lt;zhiguo.niu@unisoc.com&gt;
    > Signed-off-by: Chao Yu &lt;chao@kernel.org&gt;
    > Signed-off-by: Jaegeuk Kim &lt;jaegeuk@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ LoongArch: Fix sleeping in atomic context for PREEMPT_RT (@Huacai Chen in [6575e0867bd478a](https://github.com/sophgo/linux-riscv/commit/6575e0867bd478a) at 2024-12-14 19:04:06)
    > [ Upstream commit 88fd2b70120d52c1010257d36776876941375490 ]
    > Commit bab1c299f3945ffe79 (&quot;LoongArch: Fix sleeping in atomic context in
    > setup_tlb_handler()&quot;) changes the gfp flag from GFP_KERNEL to GFP_ATOMIC
    > for alloc_pages_node(). However, for PREEMPT_RT kernels we can still get
    > a &quot;sleeping in atomic context&quot; error:
    > [    0.372259] BUG: sleeping function called from invalid context at kernel/locking/spinlock_rt.c:48
    > [    0.372266] in_atomic(): 1, irqs_disabled(): 1, non_block: 0, pid: 0, name: swapper/1
    > [    0.372268] preempt_count: 1, expected: 0
    > [    0.372270] RCU nest depth: 1, expected: 1
    > [    0.372272] 3 locks held by swapper/1/0:
    > [    0.372274]  #0: 900000000c9f5e60 (&amp;pcp-&gt;lock){+.+.}-{3:3}, at: get_page_from_freelist+0x524/0x1c60
    > [    0.372294]  #1: 90000000087013b8 (rcu_read_lock){....}-{1:3}, at: rt_spin_trylock+0x50/0x140
    > [    0.372305]  #2: 900000047fffd388 (&amp;zone-&gt;lock){+.+.}-{3:3}, at: __rmqueue_pcplist+0x30c/0xea0
    > [    0.372314] irq event stamp: 0
    > [    0.372316] hardirqs last  enabled at (0): [&lt;0000000000000000&gt;] 0x0
    > [    0.372322] hardirqs last disabled at (0): [&lt;9000000005947320&gt;] copy_process+0x9c0/0x26e0
    > [    0.372329] softirqs last  enabled at (0): [&lt;9000000005947320&gt;] copy_process+0x9c0/0x26e0
    > [    0.372335] softirqs last disabled at (0): [&lt;0000000000000000&gt;] 0x0
    > [    0.372341] CPU: 1 UID: 0 PID: 0 Comm: swapper/1 Not tainted 6.12.0-rc7+ #1891
    > [    0.372346] Hardware name: Loongson Loongson-3A5000-7A1000-1w-CRB/Loongson-LS3A5000-7A1000-1w-CRB, BIOS vUDK2018-LoongArch-V2.0.0-prebeta9 10/21/2022
    > [    0.372349] Stack : 0000000000000089 9000000005a0db9c 90000000071519c8 9000000100388000
    > [    0.372486]         900000010038b890 0000000000000000 900000010038b898 9000000007e53788
    > [    0.372492]         900000000815bcc8 900000000815bcc0 900000010038b700 0000000000000001
    > [    0.372498]         0000000000000001 4b031894b9d6b725 00000000055ec000 9000000100338fc0
    > [    0.372503]         00000000000000c4 0000000000000001 000000000000002d 0000000000000003
    > [    0.372509]         0000000000000030 0000000000000003 00000000055ec000 0000000000000003
    > [    0.372515]         900000000806d000 9000000007e53788 00000000000000b0 0000000000000004
    > [    0.372521]         0000000000000000 0000000000000000 900000000c9f5f10 0000000000000000
    > [    0.372526]         90000000076f12d8 9000000007e53788 9000000005924778 0000000000000000
    > [    0.372532]         00000000000000b0 0000000000000004 0000000000000000 0000000000070000
    > [    0.372537]         ...
    > [    0.372540] Call Trace:
    > [    0.372542] [&lt;9000000005924778&gt;] show_stack+0x38/0x180
    > [    0.372548] [&lt;90000000071519c4&gt;] dump_stack_lvl+0x94/0xe4
    > [    0.372555] [&lt;900000000599b880&gt;] __might_resched+0x1a0/0x260
    > [    0.372561] [&lt;90000000071675cc&gt;] rt_spin_lock+0x4c/0x140
    > [    0.372565] [&lt;9000000005cbb768&gt;] __rmqueue_pcplist+0x308/0xea0
    > [    0.372570] [&lt;9000000005cbed84&gt;] get_page_from_freelist+0x564/0x1c60
    > [    0.372575] [&lt;9000000005cc0d98&gt;] __alloc_pages_noprof+0x218/0x1820
    > [    0.372580] [&lt;900000000593b36c&gt;] tlb_init+0x1ac/0x298
    > [    0.372585] [&lt;9000000005924b74&gt;] per_cpu_trap_init+0x114/0x140
    > [    0.372589] [&lt;9000000005921964&gt;] cpu_probe+0x4e4/0xa60
    > [    0.372592] [&lt;9000000005934874&gt;] start_secondary+0x34/0xc0
    > [    0.372599] [&lt;900000000715615c&gt;] smpboot_entry+0x64/0x6c
    > This is because in PREEMPT_RT kernels normal spinlocks are replaced by
    > rt spinlocks and rt_spin_lock() will cause sleeping. Fix it by disabling
    > NUMA optimization completely for PREEMPT_RT kernels.
    > Signed-off-by: Huacai Chen &lt;chenhuacai@loongson.cn&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ fs/ntfs3: Fix warning in ni_fiemap (@Konstantin Komarov in [58edd785ea14271](https://github.com/sophgo/linux-riscv/commit/58edd785ea14271) at 2024-12-14 19:04:06)
    > [ Upstream commit e2705dd3d16d1000f1fd8193d82447065de8c899 ]
    > Use local runs_tree instead of cached. This way excludes rw_semaphore lock.
    > Reported-by: syzbot+1c25748a40fe79b8a119@syzkaller.appspotmail.com
    > Signed-off-by: Konstantin Komarov &lt;almaz.alexandrovich@paragon-software.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ACPI: x86: Clean up Asus entries in acpi_quirk_skip_dmi_ids[] (@Hans de Goede in [4806ed7abddcdb7](https://github.com/sophgo/linux-riscv/commit/4806ed7abddcdb7) at 2024-12-14 19:04:06)
    > [ Upstream commit bd8aa15848f5f21951cd0b0d01510b3ad1f777d4 ]
    > The Asus entries in the acpi_quirk_skip_dmi_ids[] table are the only
    > entries without a comment which model they apply to. Add these comments.
    > The Asus TF103C entry also is in the wrong place for what is supposed to
    > be an alphabetically sorted list. Move it up so that the list is properly
    > sorted and add a comment that the list is alphabetically sorted.
    > Signed-off-by: Hans de Goede &lt;hdegoede@redhat.com&gt;
    > Link: https://patch.msgid.link/20241116095825.11660-2-hdegoede@redhat.com
    > [ rjw: Changelog and subject edits ]
    > Signed-off-by: Rafael J. Wysocki &lt;rafael.j.wysocki@intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ remoteproc: qcom: pas: enable SAR2130P audio DSP support (@Dmitry Baryshkov in [fb80d442c8960c2](https://github.com/sophgo/linux-riscv/commit/fb80d442c8960c2) at 2024-12-14 19:04:05)
    > [ Upstream commit 009e288c989b3fe548a45c82da407d7bd00418a9 ]
    > Enable support for the Audio DSP on the Qualcomm SAR2130P platform,
    > reusing the SM8350 resources.
    > Signed-off-by: Dmitry Baryshkov &lt;dmitry.baryshkov@linaro.org&gt;
    > Reviewed-by: Neil Armstrong &lt;neil.armstrong@linaro.org&gt;
    > Link: https://lore.kernel.org/r/20241027-sar2130p-adsp-v1-3-bd204e39d24e@linaro.org
    > Signed-off-by: Bjorn Andersson &lt;andersson@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ f2fs: fix to shrink read extent node in batches (@Chao Yu in [924f7dd1e832e4e](https://github.com/sophgo/linux-riscv/commit/924f7dd1e832e4e) at 2024-12-14 19:04:05)
    > [ Upstream commit 3fc5d5a182f6a1f8bd4dc775feb54c369dd2c343 ]
    > We use rwlock to protect core structure data of extent tree during
    > its shrink, however, if there is a huge number of extent nodes in
    > extent tree, during shrink of extent tree, it may hold rwlock for
    > a very long time, which may trigger kernel hang issue.
    > This patch fixes to shrink read extent node in batches, so that,
    > critical region of the rwlock can be shrunk to avoid its extreme
    > long time hold.
    > Reported-by: Xiuhong Wang &lt;xiuhong.wang@unisoc.com&gt;
    > Closes: https://lore.kernel.org/linux-f2fs-devel/20241112110627.1314632-1-xiuhong.wang@unisoc.com/
    > Signed-off-by: Xiuhong Wang &lt;xiuhong.wang@unisoc.com&gt;
    > Signed-off-by: Zhiguo Niu &lt;zhiguo.niu@unisoc.com&gt;
    > Signed-off-by: Chao Yu &lt;chao@kernel.org&gt;
    > Signed-off-by: Jaegeuk Kim &lt;jaegeuk@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ f2fs: print message if fscorrupted was found in f2fs_new_node_page() (@Chao Yu in [6d41a2d5c168c3f](https://github.com/sophgo/linux-riscv/commit/6d41a2d5c168c3f) at 2024-12-14 19:04:05)
    > [ Upstream commit 81520c684ca67aea6a589461a3caebb9b11dcc90 ]
    > If fs corruption occurs in f2fs_new_node_page(), let&#x27;s print
    > more information about corrupted metadata into kernel log.
    > Meanwhile, it updates to record ERROR_INCONSISTENT_NAT instead
    > of ERROR_INVALID_BLKADDR if blkaddr in nat entry is not
    > NULL_ADDR which means nat bitmap and nat entry is inconsistent.
    > Signed-off-by: Chao Yu &lt;chao@kernel.org&gt;
    > Signed-off-by: Jaegeuk Kim &lt;jaegeuk@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ PCI: Add ACS quirk for Wangxun FF5xxx NICs (@Mengyuan Lou in [617bd1e6c39406b](https://github.com/sophgo/linux-riscv/commit/617bd1e6c39406b) at 2024-12-14 19:04:05)
    > [ Upstream commit aa46a3736afcb7b0793766d22479b8b99fc1b322 ]
    > Wangxun FF5xxx NICs are similar to SFxxx, RP1000 and RP2000 NICs.  They may
    > be multi-function devices, but they do not advertise an ACS capability.
    > But the hardware does isolate FF5xxx functions as though it had an ACS
    > capability and PCI_ACS_RR and PCI_ACS_CR were set in the ACS Control
    > register, i.e., all peer-to-peer traffic is directed upstream instead of
    > being routed internally.
    > Add ACS quirk for FF5xxx NICs in pci_quirk_wangxun_nic_acs() so the
    > functions can be in independent IOMMU groups.
    > Link: https://lore.kernel.org/r/E16053DB2B80E9A5+20241115024604.30493-1-mengyuanlou@net-swift.com
    > Signed-off-by: Mengyuan Lou &lt;mengyuanlou@net-swift.com&gt;
    > Signed-off-by: Bjorn Helgaas &lt;bhelgaas@google.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ PCI: Add &#x27;reset_subordinate&#x27; to reset hierarchy below bridge (@Keith Busch in [51276b5e28cfc6e](https://github.com/sophgo/linux-riscv/commit/51276b5e28cfc6e) at 2024-12-14 19:04:05)
    > [ Upstream commit 2fa046449a82a7d0f6d9721dd83e348816038444 ]
    > The &quot;bus&quot; and &quot;cxl_bus&quot; reset methods reset a device by asserting Secondary
    > Bus Reset on the bridge leading to the device.  These only work if the
    > device is the only device below the bridge.
    > Add a sysfs &#x27;reset_subordinate&#x27; attribute on bridges that can assert
    > Secondary Bus Reset regardless of how many devices are below the bridge.
    > This resets all the devices below a bridge in a single command, including
    > the locking and config space save/restore that reset methods normally do.
    > This may be the only way to reset devices that don&#x27;t support other reset
    > methods (ACPI, FLR, PM reset, etc).
    > Link: https://lore.kernel.org/r/20241025222755.3756162-1-kbusch@meta.com
    > Signed-off-by: Keith Busch &lt;kbusch@kernel.org&gt;
    > [bhelgaas: commit log, add capable(CAP_SYS_ADMIN) check]
    > Signed-off-by: Bjorn Helgaas &lt;bhelgaas@google.com&gt;
    > Reviewed-by: Alex Williamson &lt;alex.williamson@redhat.com&gt;
    > Reviewed-by: Amey Narkhede &lt;ameynarkhede03@gmail.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ i3c: Use i3cdev-&gt;desc-&gt;info instead of calling i3c_device_get_info() to avoid deadlock (@Defa Li in [1f51ae217d09c36](https://github.com/sophgo/linux-riscv/commit/1f51ae217d09c36) at 2024-12-14 19:04:05)
    > [ Upstream commit 6cf7b65f7029914dc0cd7db86fac9ee5159008c6 ]
    > A deadlock may happen since the i3c_master_register() acquires
    > &amp;i3cbus-&gt;lock twice. See the log below.
    > Use i3cdev-&gt;desc-&gt;info instead of calling i3c_device_info() to
    > avoid acquiring the lock twice.
    > v2:
    > - Modified the title and commit message
    > &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;
    > WARNING: possible recursive locking detected
    > 6.11.0-mainline
    > --------------------------------------------
    > init/1 is trying to acquire lock:
    > f1ffff80a6a40dc0 (&amp;i3cbus-&gt;lock){++++}-{3:3}, at: i3c_bus_normaluse_lock
    > but task is already holding lock:
    > f1ffff80a6a40dc0 (&amp;i3cbus-&gt;lock){++++}-{3:3}, at: i3c_master_register
    > other info that might help us debug this:
    > Possible unsafe locking scenario:
    > CPU0
    > ----
    > lock(&amp;i3cbus-&gt;lock);
    > lock(&amp;i3cbus-&gt;lock);
    > ** DEADLOCK ***
    > May be due to missing lock nesting notation
    > 2 locks held by init/1:
    > #0: fcffff809b6798f8 (&amp;dev-&gt;mutex){....}-{3:3}, at: __driver_attach
    > #1: f1ffff80a6a40dc0 (&amp;i3cbus-&gt;lock){++++}-{3:3}, at: i3c_master_register
    > stack backtrace:
    > CPU: 6 UID: 0 PID: 1 Comm: init
    > Call trace:
    > dump_backtrace+0xfc/0x17c
    > show_stack+0x18/0x28
    > dump_stack_lvl+0x40/0xc0
    > dump_stack+0x18/0x24
    > print_deadlock_bug+0x388/0x390
    > __lock_acquire+0x18bc/0x32ec
    > lock_acquire+0x134/0x2b0
    > down_read+0x50/0x19c
    > i3c_bus_normaluse_lock+0x14/0x24
    > i3c_device_get_info+0x24/0x58
    > i3c_device_uevent+0x34/0xa4
    > dev_uevent+0x310/0x384
    > kobject_uevent_env+0x244/0x414
    > kobject_uevent+0x14/0x20
    > device_add+0x278/0x460
    > device_register+0x20/0x34
    > i3c_master_register_new_i3c_devs+0x78/0x154
    > i3c_master_register+0x6a0/0x6d4
    > mtk_i3c_master_probe+0x3b8/0x4d8
    > platform_probe+0xa0/0xe0
    > really_probe+0x114/0x454
    > __driver_probe_device+0xa0/0x15c
    > driver_probe_device+0x3c/0x1ac
    > __driver_attach+0xc4/0x1f0
    > bus_for_each_dev+0x104/0x160
    > driver_attach+0x24/0x34
    > bus_add_driver+0x14c/0x294
    > driver_register+0x68/0x104
    > __platform_driver_register+0x20/0x30
    > init_module+0x20/0xfe4
    > do_one_initcall+0x184/0x464
    > do_init_module+0x58/0x1ec
    > load_module+0xefc/0x10c8
    > __arm64_sys_finit_module+0x238/0x33c
    > invoke_syscall+0x58/0x10c
    > el0_svc_common+0xa8/0xdc
    > do_el0_svc+0x1c/0x28
    > el0_svc+0x50/0xac
    > el0t_64_sync_handler+0x70/0xbc
    > el0t_64_sync+0x1a8/0x1ac
    > Signed-off-by: Defa Li &lt;defa.li@mediatek.com&gt;
    > Link: https://lore.kernel.org/r/20241107132549.25439-1-defa.li@mediatek.com
    > Signed-off-by: Alexandre Belloni &lt;alexandre.belloni@bootlin.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ PCI: starfive: Enable controller runtime PM before probing host bridge (@Mayank Rana in [ea1adfd7d0fc9ed](https://github.com/sophgo/linux-riscv/commit/ea1adfd7d0fc9ed) at 2024-12-14 19:04:04)
    > [ Upstream commit 6168efbebace0db443185d4c6701ca8170a8788d ]
    > A PCI controller device, e.g., StarFive, is parent to PCI host bridge
    > device. We must enable runtime PM of the controller before enabling runtime
    > PM of the host bridge, which will happen in pci_host_probe(), to avoid this
    > warning:
    > pcie-starfive 940000000.pcie: Enabling runtime PM for inactive device with active children
    > Fix this issue by enabling StarFive controller device&#x27;s runtime PM before
    > calling pci_host_probe() in plda_pcie_host_init().
    > Link: https://lore.kernel.org/r/20241111-runtime_pm-v7-1-9c164eefcd87@quicinc.com
    > Tested-by: Marek Szyprowski &lt;m.szyprowski@samsung.com&gt;
    > Signed-off-by: Mayank Rana &lt;quic_mrana@quicinc.com&gt;
    > [bhelgaas: commit log]
    > Signed-off-by: Bjorn Helgaas &lt;bhelgaas@google.com&gt;
    > Reviewed-by: Manivannan Sadhasivam &lt;manivannan.sadhasivam@linaro.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ PCI: qcom: Add support for IPQ9574 (@devi priya in [b51aa6a07ee0ba4](https://github.com/sophgo/linux-riscv/commit/b51aa6a07ee0ba4) at 2024-12-14 19:04:04)
    > [ Upstream commit a63b74f2e35be3829f256922037ae5cee6bb844a ]
    > Add the new IPQ9574 platform which is based on the Qcom IP rev. 1.27.0
    > and Synopsys IP rev. 5.80a.
    > The platform itself has four PCIe Gen3 controllers: two single-lane and
    > two dual-lane, all are based on Synopsys IP rev. 5.70a. As such, reuse
    > all the members of &#x27;ops_2_9_0&#x27;.
    > Link: https://lore.kernel.org/r/20240801054803.3015572-5-quic_srichara@quicinc.com
    > Co-developed-by: Anusha Rao &lt;quic_anusha@quicinc.com&gt;
    > Signed-off-by: Anusha Rao &lt;quic_anusha@quicinc.com&gt;
    > Signed-off-by: devi priya &lt;quic_devipriy@quicinc.com&gt;
    > Signed-off-by: Sricharan Ramabadhran &lt;quic_srichara@quicinc.com&gt;
    > [kwilczynski: commit log]
    > Signed-off-by: Krzysztof Wilczyński &lt;kwilczynski@kernel.org&gt;
    > Reviewed-by: Dmitry Baryshkov &lt;dmitry.baryshkov@linaro.org&gt;
    > Reviewed-by: Manivannan Sadhasivam &lt;manivannan.sadhasivam@linaro.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ PCI: Detect and trust built-in Thunderbolt chips (@Esther Shimanovich in [932a5f00a80885d](https://github.com/sophgo/linux-riscv/commit/932a5f00a80885d) at 2024-12-14 19:04:04)
    > [ Upstream commit 3b96b895127b7c0aed63d82c974b46340e8466c1 ]
    > Some computers with CPUs that lack Thunderbolt features use discrete
    > Thunderbolt chips to add Thunderbolt functionality. These Thunderbolt
    > chips are located within the chassis; between the Root Port labeled
    > ExternalFacingPort and the USB-C port.
    > These Thunderbolt PCIe devices should be labeled as fixed and trusted, as
    > they are built into the computer. Otherwise, security policies that rely on
    > those flags may have unintended results, such as preventing USB-C ports
    > from enumerating.
    > Detect the above scenario through the process of elimination.
    > 1) Integrated Thunderbolt host controllers already have Thunderbolt
    > implemented, so anything outside their external facing Root Port is
    > removable and untrusted.
    > Detect them using the following properties:
    > - Most integrated host controllers have the &quot;usb4-host-interface&quot;
    > ACPI property, as described here:
    > https://learn.microsoft.com/en-us/windows-hardware/drivers/pci/dsd-for-pcie-root-ports#mapping-native-protocols-pcie-displayport-tunneled-through-usb4-to-usb4-host-routers
    > - Integrated Thunderbolt PCIe Root Ports before Alder Lake do not
    > have the &quot;usb4-host-interface&quot; ACPI property. Identify those by
    > their PCI IDs instead.
    > 2) If a Root Port does not have integrated Thunderbolt capabilities, but
    > has the &quot;ExternalFacingPort&quot; ACPI property, that means the
    > manufacturer has opted to use a discrete Thunderbolt host controller
    > that is built into the computer.
    > This host controller can be identified by virtue of being located
    > directly below an external-facing Root Port that lacks integrated
    > Thunderbolt. Label it as trusted and fixed.
    > Everything downstream from it is untrusted and removable.
    > The &quot;ExternalFacingPort&quot; ACPI property is described here:
    > https://learn.microsoft.com/en-us/windows-hardware/drivers/pci/dsd-for-pcie-root-ports#identifying-externally-exposed-pcie-root-ports
    > Link: https://lore.kernel.org/r/20240910-trust-tbt-fix-v5-1-7a7a42a5f496@chromium.org
    > Suggested-by: Mika Westerberg &lt;mika.westerberg@linux.intel.com&gt;
    > Signed-off-by: Esther Shimanovich &lt;eshimanovich@chromium.org&gt;
    > Signed-off-by: Bjorn Helgaas &lt;bhelgaas@google.com&gt;
    > Tested-by: Mika Westerberg &lt;mika.westerberg@linux.intel.com&gt;
    > Tested-by: Mario Limonciello &lt;mario.limonciello@amd.com&gt;
    > Reviewed-by: Mika Westerberg &lt;mika.westerberg@linux.intel.com&gt;
    > Reviewed-by: Mario Limonciello &lt;mario.limonciello@amd.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ PCI: vmd: Add DID 8086:B06F and 8086:B60B for Intel client SKUs (@Nirmal Patel in [34883c93bd33041](https://github.com/sophgo/linux-riscv/commit/34883c93bd33041) at 2024-12-14 19:04:04)
    > [ Upstream commit b727484cace4be22be9321cc0bc9487648ba447b ]
    > Add support for this VMD device which supports the bus restriction mode.
    > The feature that turns off vector 0 for MSI-X remapping is also enabled.
    > Link: https://lore.kernel.org/r/20241011175657.249948-1-nirmal.patel@linux.intel.com
    > Signed-off-by: Nirmal Patel &lt;nirmal.patel@linux.ntel.com&gt;
    > Signed-off-by: Krzysztof Wilczyński &lt;kwilczynski@kernel.org&gt;
    > Reviewed-by: Manivannan Sadhasivam &lt;manivannan.sadhasivam@linaro.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ PCI: vmd: Set devices to D0 before enabling PM L1 Substates (@Jian-Hong Pan in [293debb105cf480](https://github.com/sophgo/linux-riscv/commit/293debb105cf480) at 2024-12-14 19:04:04)
    > [ Upstream commit d66041063192497a4a97d21dbf86b79a03a7f4fb ]
    > The remapped PCIe Root Port and the child device have PM L1 Substates
    > capability, but they are disabled originally.
    > Here is a failed example on ASUS B1400CEAE:
    > Capabilities: [900 v1] L1 PM Substates
    > L1SubCap: PCI-PM_L1.2+ PCI-PM_L1.1- ASPM_L1.2+ ASPM_L1.1- L1_PM_Substates+
    > PortCommonModeRestoreTime&#x3D;32us PortTPowerOnTime&#x3D;10us
    > L1SubCtl1: PCI-PM_L1.2- PCI-PM_L1.1- ASPM_L1.2+ ASPM_L1.1-
    > T_CommonMode&#x3D;0us LTR1.2_Threshold&#x3D;101376ns
    > L1SubCtl2: T_PwrOn&#x3D;50us
    > Enable PCI-PM L1 PM Substates for devices below VMD while they are in D0
    > (see PCIe r6.0, sec 5.5.4).
    > Link: https://lore.kernel.org/r/20241001083438.10070-4-jhp@endlessos.org
    > Link: https://bugzilla.kernel.org/show_bug.cgi?id&#x3D;218394
    > Signed-off-by: Jian-Hong Pan &lt;jhp@endlessos.org&gt;
    > Signed-off-by: Krzysztof Wilczyński &lt;kwilczynski@kernel.org&gt;
    > Signed-off-by: Bjorn Helgaas &lt;bhelgaas@google.com&gt;
    > Reviewed-by: Kuppuswamy Sathyanarayanan &lt;sathyanarayanan.kuppuswamy@linux.intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ i3c: mipi-i3c-hci: Mask ring interrupts before ring stop request (@Jarkko Nikula in [19cc5767334bfe9](https://github.com/sophgo/linux-riscv/commit/19cc5767334bfe9) at 2024-12-14 19:04:04)
    > [ Upstream commit 6ca2738174e4ee44edb2ab2d86ce74f015a0cc32 ]
    > Bus cleanup path in DMA mode may trigger a RING_OP_STAT interrupt when
    > the ring is being stopped. Depending on timing between ring stop request
    > completion, interrupt handler removal and code execution this may lead
    > to a NULL pointer dereference in hci_dma_irq_handler() if it gets to run
    > after the io_data pointer is set to NULL in hci_dma_cleanup().
    > Prevent this my masking the ring interrupts before ring stop request.
    > Signed-off-by: Jarkko Nikula &lt;jarkko.nikula@linux.intel.com&gt;
    > Link: https://lore.kernel.org/r/20240920144432.62370-2-jarkko.nikula@linux.intel.com
    > Signed-off-by: Alexandre Belloni &lt;alexandre.belloni@bootlin.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ mailbox: pcc: Check before sending MCTP PCC response ACK (@Adam Young in [d6855f060443520](https://github.com/sophgo/linux-riscv/commit/d6855f060443520) at 2024-12-14 19:04:03)
    > [ Upstream commit 7f9e19f207be0c534d517d65e01417ba968cdd34 ]
    > Type 4 PCC channels have an option to send back a response
    > to the platform when they are done processing the request.
    > The flag to indicate whether or not to respond is inside
    > the message body, and thus is not available to the pcc
    > mailbox.
    > If the flag is not set, still set command completion
    > bit after processing message.
    > In order to read the flag, this patch maps the shared
    > buffer to virtual memory. To avoid duplication of mapping
    > the shared buffer is then made available to be used by
    > the driver that uses the mailbox.
    > Signed-off-by: Adam Young &lt;admiyo@os.amperecomputing.com&gt;
    > Cc: Sudeep Holla &lt;sudeep.holla@arm.com&gt;
    > Signed-off-by: Jassi Brar &lt;jassisinghbrar@gmail.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ f2fs: fix f2fs_bug_on when uninstalling filesystem call f2fs_evict_inode. (@Qi Han in [9e28513fd285891](https://github.com/sophgo/linux-riscv/commit/9e28513fd285891) at 2024-12-14 19:04:03)
    > [ Upstream commit d5c367ef8287fb4d235c46a2f8c8d68715f3a0ca ]
    > creating a large files during checkpoint disable until it runs out of
    > space and then delete it, then remount to enable checkpoint again, and
    > then unmount the filesystem triggers the f2fs_bug_on as below:
    > ------------[ cut here ]------------
    > kernel BUG at fs/f2fs/inode.c:896!
    > CPU: 2 UID: 0 PID: 1286 Comm: umount Not tainted 6.11.0-rc7-dirty #360
    > Oops: invalid opcode: 0000 [#1] PREEMPT SMP NOPTI
    > RIP: 0010:f2fs_evict_inode+0x58c/0x610
    > Call Trace:
    > __die_body+0x15/0x60
    > die+0x33/0x50
    > do_trap+0x10a/0x120
    > f2fs_evict_inode+0x58c/0x610
    > do_error_trap+0x60/0x80
    > f2fs_evict_inode+0x58c/0x610
    > exc_invalid_op+0x53/0x60
    > f2fs_evict_inode+0x58c/0x610
    > asm_exc_invalid_op+0x16/0x20
    > f2fs_evict_inode+0x58c/0x610
    > evict+0x101/0x260
    > dispose_list+0x30/0x50
    > evict_inodes+0x140/0x190
    > generic_shutdown_super+0x2f/0x150
    > kill_block_super+0x11/0x40
    > kill_f2fs_super+0x7d/0x140
    > deactivate_locked_super+0x2a/0x70
    > cleanup_mnt+0xb3/0x140
    > task_work_run+0x61/0x90
    > The root cause is: creating large files during disable checkpoint
    > period results in not enough free segments, so when writing back root
    > inode will failed in f2fs_enable_checkpoint. When umount the file
    > system after enabling checkpoint, the root inode is dirty in
    > f2fs_evict_inode function, which triggers BUG_ON. The steps to
    > reproduce are as follows:
    > dd if&#x3D;/dev/zero of&#x3D;f2fs.img bs&#x3D;1M count&#x3D;55
    > mount f2fs.img f2fs_dir -o checkpoint&#x3D;disable:10%
    > dd if&#x3D;/dev/zero of&#x3D;big bs&#x3D;1M count&#x3D;50
    > sync
    > rm big
    > mount -o remount,checkpoint&#x3D;enable f2fs_dir
    > umount f2fs_dir
    > Let&#x27;s redirty inode when there is not free segments during checkpoint
    > is disable.
    > Signed-off-by: Qi Han &lt;hanqi@vivo.com&gt;
    > Reviewed-by: Chao Yu &lt;chao@kernel.org&gt;
    > Signed-off-by: Jaegeuk Kim &lt;jaegeuk@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ tools/rtla: Enhance argument parsing in timerlat_load.py (@furkanonder in [98bf83f0e44d1fe](https://github.com/sophgo/linux-riscv/commit/98bf83f0e44d1fe) at 2024-12-14 19:04:03)
    > [ Upstream commit bd26818343dc02936a4f2f7b63368d5e1e1773c8 ]
    > The enhancements made to timerlat_load.py are aimed at improving the clarity of argument parsing.
    > Summary of Changes:
    > - The cpu argument is now specified as an integer type in the argument
    > parser to enforce input validation, and the construction of affinity_mask
    > has been simplified to directly use the integer value of args.cpu.
    > - The prio argument is similarly updated to be of integer type for
    > consistency and validation, eliminating the need for the conversion of
    > args.prio to an integer, as this is now handled by the argument parser.
    > Cc: &quot;jkacur@redhat.com&quot; &lt;jkacur@redhat.com&gt;
    > Cc: &quot;lgoncalv@redhat.com&quot; &lt;lgoncalv@redhat.com&gt;
    > Link: https://lore.kernel.org/QfgO7ayKD9dsLk8_ZDebkAV0OF7wla7UmasbP9CBmui_sChOeizy512t3RqCHTjvQoUBUDP8dwEOVCdHQ5KvVNEiP69CynMY94SFDERWl94&#x3D;@protonmail.com
    > Signed-off-by: Furkan Onder &lt;furkanonder@protonmail.com&gt;
    > Reviewed-by: Tomas Glozar &lt;tglozar@redhat.com&gt;
    > Signed-off-by: Steven Rostedt (Google) &lt;rostedt@goodmis.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ KMSAN: uninit-value in inode_go_dump (5) (@Qianqiang Liu in [7e45af15cf724df](https://github.com/sophgo/linux-riscv/commit/7e45af15cf724df) at 2024-12-14 19:04:03)
    > [ Upstream commit f9417fcfca3c5e30a0b961e7250fab92cfa5d123 ]
    > When mounting of a corrupted disk image fails, the error message printed
    > can reference uninitialized inode fields.  To prevent that from happening,
    > always initialize those fields.
    > Reported-by: syzbot+aa0730b0a42646eb1359@syzkaller.appspotmail.com
    > Signed-off-by: Qianqiang Liu &lt;qianqiang.liu@163.com&gt;
    > Signed-off-by: Andreas Gruenbacher &lt;agruenba@redhat.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ tracing: Fix function name for trampoline (@Tatsuya S in [7214d3a64e6ec3b](https://github.com/sophgo/linux-riscv/commit/7214d3a64e6ec3b) at 2024-12-14 19:04:03)
    > [ Upstream commit 6ce5a6f0a07d37cc377df08a8d8a9c283420f323 ]
    > The issue that unrelated function name is shown on stack trace like
    > following even though it should be trampoline code address is caused by
    > the creation of trampoline code in the area where .init.text section
    > of module was freed after module is loaded.
    > bash-1344    [002] .....    43.644608: &lt;stack trace&gt;
    > &#x3D;&gt; (MODULE INIT FUNCTION)
    > &#x3D;&gt; vfs_write
    > &#x3D;&gt; ksys_write
    > &#x3D;&gt; do_syscall_64
    > &#x3D;&gt; entry_SYSCALL_64_after_hwframe
    > To resolve this, when function address of stack trace entry is in
    > trampoline, output without looking up symbol name.
    > Cc: Mathieu Desnoyers &lt;mathieu.desnoyers@efficios.com&gt;
    > Link: https://lore.kernel.org/20241021071454.34610-2-tatsuya.s2862@gmail.com
    > Signed-off-by: Tatsuya S &lt;tatsuya.s2862@gmail.com&gt;
    > Acked-by: Masami Hiramatsu (Google) &lt;mhiramat@kernel.org&gt;
    > Signed-off-by: Steven Rostedt (Google) &lt;rostedt@goodmis.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ verification/dot2: Improve dot parser robustness (@Gabriele Monaco in [67f21fdd35a90cf](https://github.com/sophgo/linux-riscv/commit/67f21fdd35a90cf) at 2024-12-14 19:04:03)
    > [ Upstream commit 571f8b3f866a6d990a50fe5c89fe0ea78784d70b ]
    > This patch makes the dot parser used by dot2c and dot2k slightly more
    > robust, namely:
    > allows parsing files with the gv extension (GraphViz)
    > correctly parses edges with any indentation
    > used to work only with a single character (e.g. &#x27;\t&#x27;)
    > Additionally it fixes a couple of warnings reported by pylint such as
    > wrong indentation and comparison to False instead of &#x60;not ...&#x60;
    > Link: https://lore.kernel.org/20241017064238.41394-2-gmonaco@redhat.com
    > Signed-off-by: Gabriele Monaco &lt;gmonaco@redhat.com&gt;
    > Signed-off-by: Steven Rostedt (Google) &lt;rostedt@goodmis.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ pinctrl: qcom-pmic-gpio: add support for PM8937 (@Barnabás Czémán in [ec6d6a0c448f165](https://github.com/sophgo/linux-riscv/commit/ec6d6a0c448f165) at 2024-12-14 19:04:02)
    > [ Upstream commit 89265a58ff24e3885c2c9ca722bc3aaa47018be9 ]
    > PM8937 has 8 GPIO-s with holes on GPIO3, GPIO4 and GPIO6.
    > Signed-off-by: Barnabás Czémán &lt;barnabas.czeman@mainlining.org&gt;
    > Reviewed-by: Dmitry Baryshkov &lt;dmitry.baryshkov@linaro.org&gt;
    > Link: https://lore.kernel.org/20241031-msm8917-v2-2-8a075faa89b1@mainlining.org
    > Signed-off-by: Linus Walleij &lt;linus.walleij@linaro.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ pinctrl: qcom: spmi-mpp: Add PM8937 compatible (@Barnabás Czémán in [d7145e6af9e787d](https://github.com/sophgo/linux-riscv/commit/d7145e6af9e787d) at 2024-12-14 19:04:02)
    > [ Upstream commit f755261190e88f5d19fe0a3b762f0bbaff6bd438 ]
    > The PM8937 provides 4 MPPs.
    > Add a compatible to support them.
    > Reviewed-by: Dmitry Baryshkov &lt;dmitry.baryshkov@linaro.org&gt;
    > Signed-off-by: Barnabás Czémán &lt;barnabas.czeman@mainlining.org&gt;
    > Link: https://lore.kernel.org/20241031-msm8917-v2-4-8a075faa89b1@mainlining.org
    > Signed-off-by: Linus Walleij &lt;linus.walleij@linaro.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ smb: client: memcpy() with surrounding object base address (@Kees Cook in [d58ed5c2813c029](https://github.com/sophgo/linux-riscv/commit/d58ed5c2813c029) at 2024-12-14 19:04:02)
    > [ Upstream commit f69b0187f8745a7a9584f6b13f5e792594b88b2e ]
    > Like commit f1f047bd7ce0 (&quot;smb: client: Fix -Wstringop-overflow issues&quot;),
    > adjust the memcpy() destination address to be based off the surrounding
    > object rather than based off the 4-byte &quot;Protocol&quot; member. This avoids a
    > build-time warning when compiling under CONFIG_FORTIFY_SOURCE with GCC 15:
    > In function &#x27;fortify_memcpy_chk&#x27;,
    > inlined from &#x27;CIFSSMBSetPathInfo&#x27; at ../fs/smb/client/cifssmb.c:5358:2:
    > ../include/linux/fortify-string.h:571:25: error: call to &#x27;__write_overflow_field&#x27; declared with attribute warning: detected write beyond size of field (1st parameter); maybe use struct_group()? [-Werror&#x3D;attribute-warning]
    > 571 |                         __write_overflow_field(p_size_field, size);
    > |                         ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    > Signed-off-by: Kees Cook &lt;kees@kernel.org&gt;
    > Reviewed-by: Gustavo A. R. Silva &lt;gustavoars@kernel.org&gt;
    > Signed-off-by: Steve French &lt;stfrench@microsoft.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ scsi: st: Add MTIOCGET and MTLOAD to ioctls allowed after device reset (@Kai Mäkisara in [b04ca7b0649dd0d](https://github.com/sophgo/linux-riscv/commit/b04ca7b0649dd0d) at 2024-12-14 19:04:02)
    > [ Upstream commit 0b120edb37dc9dd8ca82893d386922eb6b16f860 ]
    > Most drives rewind the tape when the device is reset. Reading and writing
    > are not allowed until something is done to make the tape position match the
    > user&#x27;s expectation (e.g., rewind the tape). Add MTIOCGET and MTLOAD to
    > operations allowed after reset. MTIOCGET is modified to not touch the tape
    > if pos_unknown is non-zero. The tape location is known after MTLOAD.
    > Signed-off-by: Kai Mäkisara &lt;Kai.Makisara@kolumbus.fi&gt;
    > Link: https://bugzilla.kernel.org/show_bug.cgi?id&#x3D;219419#c14
    > Link: https://lore.kernel.org/r/20241106095723.63254-3-Kai.Makisara@kolumbus.fi
    > Reviewed-by: John Meneghini &lt;jmeneghi@redhat.com&gt;
    > Tested-by: John Meneghini &lt;jmeneghi@redhat.com&gt;
    > Signed-off-by: Martin K. Petersen &lt;martin.petersen@oracle.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ thermal/drivers/qcom/tsens-v1: Add support for MSM8937 tsens (@Barnabás Czémán in [a5289e7085ff5ae](https://github.com/sophgo/linux-riscv/commit/a5289e7085ff5ae) at 2024-12-14 19:04:02)
    > [ Upstream commit e2ffb6c3a40ee714160e35e61f0a984028b5d550 ]
    > Add support for tsens v1.4 block what can be found in
    > MSM8937 and MSM8917.
    > Reviewed-by: Dmitry Baryshkov &lt;dmitry.baryshkov@linaro.org&gt;
    > Signed-off-by: Barnabás Czémán &lt;barnabas.czeman@mainlining.org&gt;
    > Link: https://lore.kernel.org/r/20241113-msm8917-v6-5-c348fb599fef@mainlining.org
    > Signed-off-by: Daniel Lezcano &lt;daniel.lezcano@linaro.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ nvdimm: rectify the illogical code within nd_dax_probe() (@Yi Yang in [1c67333b8febeb4](https://github.com/sophgo/linux-riscv/commit/1c67333b8febeb4) at 2024-12-14 19:04:02)
    > [ Upstream commit b61352101470f8b68c98af674e187cfaa7c43504 ]
    > When nd_dax is NULL, nd_pfn is consequently NULL as well. Nevertheless,
    > it is inadvisable to perform pointer arithmetic or address-taking on a
    > NULL pointer.
    > Introduce the nd_dax_devinit() function to enhance the code&#x27;s logic and
    > improve its readability.
    > Signed-off-by: Yi Yang &lt;yiyang13@huawei.com&gt;
    > Reviewed-by: Dave Jiang &lt;dave.jiang@intel.com&gt;
    > Link: https://patch.msgid.link/20241108085526.527957-1-yiyang13@huawei.com
    > Signed-off-by: Ira Weiny &lt;ira.weiny@intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ clk: qcom: clk-alpha-pll: Add NSS HUAYRA ALPHA PLL support for ipq9574 (@Devi Priya in [f29438bcfad0a3f](https://github.com/sophgo/linux-riscv/commit/f29438bcfad0a3f) at 2024-12-14 19:04:01)
    > [ Upstream commit 79dfed29aa3f714e0a94a39b2bfe9ac14ce19a6a ]
    > Add support for NSS Huayra alpha pll found on ipq9574 SoCs.
    > Programming sequence is the same as that of Huayra type Alpha PLL,
    > so we can re-use the same.
    > Reviewed-by: Dmitry Baryshkov &lt;dmitry.baryshkov@linaro.org&gt;
    > Signed-off-by: Devi Priya &lt;quic_devipriy@quicinc.com&gt;
    > Link: https://lore.kernel.org/r/20241028060506.246606-2-quic_srichara@quicinc.com
    > Signed-off-by: Bjorn Andersson &lt;andersson@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ clk: qcom: rpmh: add support for SAR2130P (@Dmitry Baryshkov in [ecc8f3c06edd29c](https://github.com/sophgo/linux-riscv/commit/ecc8f3c06edd29c) at 2024-12-14 19:04:01)
    > [ Upstream commit 2cc88de6261f01ebd4e2a3b4e29681fe87d0c089 ]
    > Define clocks as supported by the RPMh on the SAR2130P platform. The
    > msm-5.10 kernel declares just the CXO clock, the RF_CLK1 clock was added
    > following recommendation from Taniya Das.
    > Signed-off-by: Dmitry Baryshkov &lt;dmitry.baryshkov@linaro.org&gt;
    > Reviewed-by: Taniya Das &lt;quic_tdas@quicinc.com&gt;
    > Link: https://lore.kernel.org/r/20241027-sar2130p-clocks-v5-7-ecad2a1432ba@linaro.org
    > Signed-off-by: Bjorn Andersson &lt;andersson@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ leds: class: Protect brightness_show() with led_cdev-&gt;led_access mutex (@Mukesh Ojha in [bb4a6236a430cfc](https://github.com/sophgo/linux-riscv/commit/bb4a6236a430cfc) at 2024-12-14 19:04:01)
    > [ Upstream commit 4ca7cd938725a4050dcd62ae9472e931d603118d ]
    > There is NULL pointer issue observed if from Process A where hid device
    > being added which results in adding a led_cdev addition and later a
    > another call to access of led_cdev attribute from Process B can result
    > in NULL pointer issue.
    > Use mutex led_cdev-&gt;led_access to protect access to led-&gt;cdev and its
    > attribute inside brightness_show() and max_brightness_show() and also
    > update the comment for mutex that it should be used to protect the led
    > class device fields.
    > Process A 				Process B
    > kthread+0x114
    > worker_thread+0x244
    > process_scheduled_works+0x248
    > uhid_device_add_worker+0x24
    > hid_add_device+0x120
    > device_add+0x268
    > bus_probe_device+0x94
    > device_initial_probe+0x14
    > __device_attach+0xfc
    > bus_for_each_drv+0x10c
    > __device_attach_driver+0x14c
    > driver_probe_device+0x3c
    > __driver_probe_device+0xa0
    > really_probe+0x190
    > hid_device_probe+0x130
    > ps_probe+0x990
    > ps_led_register+0x94
    > devm_led_classdev_register_ext+0x58
    > led_classdev_register_ext+0x1f8
    > device_create_with_groups+0x48
    > device_create_groups_vargs+0xc8
    > device_add+0x244
    > kobject_uevent+0x14
    > kobject_uevent_env[jt]+0x224
    > mutex_unlock[jt]+0xc4
    > __mutex_unlock_slowpath+0xd4
    > wake_up_q+0x70
    > try_to_wake_up[jt]+0x48c
    > preempt_schedule_common+0x28
    > __schedule+0x628
    > __switch_to+0x174
    > el0t_64_sync+0x1a8/0x1ac
    > el0t_64_sync_handler+0x68/0xbc
    > el0_svc+0x38/0x68
    > do_el0_svc+0x1c/0x28
    > el0_svc_common+0x80/0xe0
    > invoke_syscall+0x58/0x114
    > __arm64_sys_read+0x1c/0x2c
    > ksys_read+0x78/0xe8
    > vfs_read+0x1e0/0x2c8
    > kernfs_fop_read_iter+0x68/0x1b4
    > seq_read_iter+0x158/0x4ec
    > kernfs_seq_show+0x44/0x54
    > sysfs_kf_seq_show+0xb4/0x130
    > dev_attr_show+0x38/0x74
    > brightness_show+0x20/0x4c
    > dualshock4_led_get_brightness+0xc/0x74
    > [ 3313.874295][ T4013] Unable to handle kernel NULL pointer dereference at virtual address 0000000000000060
    > [ 3313.874301][ T4013] Mem abort info:
    > [ 3313.874303][ T4013]   ESR &#x3D; 0x0000000096000006
    > [ 3313.874305][ T4013]   EC &#x3D; 0x25: DABT (current EL), IL &#x3D; 32 bits
    > [ 3313.874307][ T4013]   SET &#x3D; 0, FnV &#x3D; 0
    > [ 3313.874309][ T4013]   EA &#x3D; 0, S1PTW &#x3D; 0
    > [ 3313.874311][ T4013]   FSC &#x3D; 0x06: level 2 translation fault
    > [ 3313.874313][ T4013] Data abort info:
    > [ 3313.874314][ T4013]   ISV &#x3D; 0, ISS &#x3D; 0x00000006, ISS2 &#x3D; 0x00000000
    > [ 3313.874316][ T4013]   CM &#x3D; 0, WnR &#x3D; 0, TnD &#x3D; 0, TagAccess &#x3D; 0
    > [ 3313.874318][ T4013]   GCS &#x3D; 0, Overlay &#x3D; 0, DirtyBit &#x3D; 0, Xs &#x3D; 0
    > [ 3313.874320][ T4013] user pgtable: 4k pages, 39-bit VAs, pgdp&#x3D;00000008f2b0a000
    > ..
    > [ 3313.874332][ T4013] Dumping ftrace buffer:
    > [ 3313.874334][ T4013]    (ftrace buffer empty)
    > ..
    > ..
    > [ dd3313.874639][ T4013] CPU: 6 PID: 4013 Comm: InputReader
    > [ 3313.874648][ T4013] pc : dualshock4_led_get_brightness+0xc/0x74
    > [ 3313.874653][ T4013] lr : led_update_brightness+0x38/0x60
    > [ 3313.874656][ T4013] sp : ffffffc0b910bbd0
    > ..
    > ..
    > [ 3313.874685][ T4013] Call trace:
    > [ 3313.874687][ T4013]  dualshock4_led_get_brightness+0xc/0x74
    > [ 3313.874690][ T4013]  brightness_show+0x20/0x4c
    > [ 3313.874692][ T4013]  dev_attr_show+0x38/0x74
    > [ 3313.874696][ T4013]  sysfs_kf_seq_show+0xb4/0x130
    > [ 3313.874700][ T4013]  kernfs_seq_show+0x44/0x54
    > [ 3313.874703][ T4013]  seq_read_iter+0x158/0x4ec
    > [ 3313.874705][ T4013]  kernfs_fop_read_iter+0x68/0x1b4
    > [ 3313.874708][ T4013]  vfs_read+0x1e0/0x2c8
    > [ 3313.874711][ T4013]  ksys_read+0x78/0xe8
    > [ 3313.874714][ T4013]  __arm64_sys_read+0x1c/0x2c
    > [ 3313.874718][ T4013]  invoke_syscall+0x58/0x114
    > [ 3313.874721][ T4013]  el0_svc_common+0x80/0xe0
    > [ 3313.874724][ T4013]  do_el0_svc+0x1c/0x28
    > [ 3313.874727][ T4013]  el0_svc+0x38/0x68
    > [ 3313.874730][ T4013]  el0t_64_sync_handler+0x68/0xbc
    > [ 3313.874732][ T4013]  el0t_64_sync+0x1a8/0x1ac
    > Signed-off-by: Mukesh Ojha &lt;quic_mojha@quicinc.com&gt;
    > Reviewed-by: Anish Kumar &lt;yesanishhere@gmail.com&gt;
    > Link: https://lore.kernel.org/r/20241103160527.82487-1-quic_mojha@quicinc.com
    > Signed-off-by: Lee Jones &lt;lee@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ clk: qcom: dispcc-sm8550: enable support for SAR2130P (@Dmitry Baryshkov in [a6096f091c68b84](https://github.com/sophgo/linux-riscv/commit/a6096f091c68b84) at 2024-12-14 19:04:01)
    > [ Upstream commit 1335c7eb7012f23dc073b8ae4ffcfc1f6e69cfb3 ]
    > The display clock controller on SAR2130P is very close to the clock
    > controller on SM8550 (and SM8650). Reuse existing driver to add support
    > for the controller on SAR2130P.
    > Reviewed-by: Neil Armstrong &lt;neil.armstrong@linaro.org&gt;
    > Reviewed-by: Konrad Dybcio &lt;konrad.dybcio@oss.qualcomm.com&gt;
    > Signed-off-by: Dmitry Baryshkov &lt;dmitry.baryshkov@linaro.org&gt;
    > Link: https://lore.kernel.org/r/20241027-sar2130p-clocks-v5-10-ecad2a1432ba@linaro.org
    > Signed-off-by: Bjorn Andersson &lt;andersson@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ scsi: st: Don&#x27;t modify unknown block number in MTIOCGET (@Kai Mäkisara in [16f5f485774ed1d](https://github.com/sophgo/linux-riscv/commit/16f5f485774ed1d) at 2024-12-14 19:04:01)
    > [ Upstream commit 5bb2d6179d1a8039236237e1e94cfbda3be1ed9e ]
    > Struct mtget field mt_blkno -1 means it is unknown. Don&#x27;t add anything to
    > it.
    > Signed-off-by: Kai Mäkisara &lt;Kai.Makisara@kolumbus.fi&gt;
    > Link: https://bugzilla.kernel.org/show_bug.cgi?id&#x3D;219419#c14
    > Link: https://lore.kernel.org/r/20241106095723.63254-2-Kai.Makisara@kolumbus.fi
    > Reviewed-by: John Meneghini &lt;jmeneghi@redhat.com&gt;
    > Tested-by: John Meneghini &lt;jmeneghi@redhat.com&gt;
    > Signed-off-by: Martin K. Petersen &lt;martin.petersen@oracle.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ clk: qcom: tcsrcc-sm8550: add SAR2130P support (@Dmitry Baryshkov in [082b6e35ff2f42e](https://github.com/sophgo/linux-riscv/commit/082b6e35ff2f42e) at 2024-12-14 19:04:01)
    > [ Upstream commit d2e0a043530b9d6f37a8de8f05e0725667aba0a6 ]
    > The SAR2130P platform has the same TCSR Clock Controller as the SM8550,
    > except for the lack of the UFS clocks. Extend the SM8550 TCSRCC driver
    > to support SAR2130P.
    > Reviewed-by: Konrad Dybcio &lt;konrad.dybcio@oss.qualcomm.com&gt;
    > Signed-off-by: Dmitry Baryshkov &lt;dmitry.baryshkov@linaro.org&gt;
    > Link: https://lore.kernel.org/r/20241027-sar2130p-clocks-v5-9-ecad2a1432ba@linaro.org
    > Signed-off-by: Bjorn Andersson &lt;andersson@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ clk: qcom: rcg2: add clk_rcg2_shared_floor_ops (@Dmitry Baryshkov in [ec81102ae27f3c4](https://github.com/sophgo/linux-riscv/commit/ec81102ae27f3c4) at 2024-12-14 19:04:00)
    > [ Upstream commit aec8c0e28ce4a1f89fd82fcc06a5cc73147e9817 ]
    > Generally SDCC clocks use clk_rcg2_floor_ops, however on SAR2130P
    > platform it&#x27;s recommended to use rcg2_shared_ops for all Root Clock
    > Generators to park them instead of disabling. Implement a mix of those,
    > clk_rcg2_shared_floor_ops.
    > Signed-off-by: Dmitry Baryshkov &lt;dmitry.baryshkov@linaro.org&gt;
    > Link: https://lore.kernel.org/r/20241027-sar2130p-clocks-v5-6-ecad2a1432ba@linaro.org
    > Signed-off-by: Bjorn Andersson &lt;andersson@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ scsi: lpfc: Prevent NDLP reference count underflow in dev_loss_tmo callback (@Justin Tee in [e4913d4bc59227f](https://github.com/sophgo/linux-riscv/commit/e4913d4bc59227f) at 2024-12-14 19:04:00)
    > [ Upstream commit 4281f44ea8bfedd25938a0031bebba1473ece9ad ]
    > Current dev_loss_tmo handling checks whether there has been a previous
    > call to unregister with SCSI transport.  If so, the NDLP kref count is
    > decremented a second time in dev_loss_tmo as the final kref release.
    > However, this can sometimes result in a reference count underflow if
    > there is also a race to unregister with NVMe transport as well.  Add a
    > check for NVMe transport registration before decrementing the final
    > kref.  If NVMe transport is still registered, then the NVMe transport
    > unregistration is designated as the final kref decrement.
    > Signed-off-by: Justin Tee &lt;justin.tee@broadcom.com&gt;
    > Link: https://lore.kernel.org/r/20241031223219.152342-8-justintee8345@gmail.com
    > Signed-off-by: Martin K. Petersen &lt;martin.petersen@oracle.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ iommu/amd: Fix corruption when mapping large pages from 0 (@Jason Gunthorpe in [a95387d8f54c205](https://github.com/sophgo/linux-riscv/commit/a95387d8f54c205) at 2024-12-14 19:04:00)
    > [ Upstream commit e3a682eaf2af51a83f5313145ef592ce50fa787f ]
    > If a page is mapped starting at 0 that is equal to or larger than can fit
    > in the current mode (number of table levels) it results in corrupting the
    > mapping as the following logic assumes the mode is correct for the page
    > size being requested.
    > There are two issues here, the check if the address fits within the table
    > uses the start address, it should use the last address to ensure that last
    > byte of the mapping fits within the current table mode.
    > The second is if the mapping is exactly the size of the full page table it
    > has to add another level to instead hold a single IOPTE for the large
    > size.
    > Since both corner cases require a 0 IOVA to be hit and doesn&#x27;t start until
    > a page size of 2^48 it is unlikely to ever hit in a real system.
    > Reported-by: Alejandro Jimenez &lt;alejandro.j.jimenez@oracle.com&gt;
    > Signed-off-by: Jason Gunthorpe &lt;jgg@nvidia.com&gt;
    > Link: https://lore.kernel.org/r/0-v1-27ab08d646a1+29-amd_0map_jgg@nvidia.com
    > Signed-off-by: Joerg Roedel &lt;jroedel@suse.de&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ scsi: lpfc: Call lpfc_sli4_queue_unset() in restart and rmmod paths (@Justin Tee in [78ef7c3909a5be9](https://github.com/sophgo/linux-riscv/commit/78ef7c3909a5be9) at 2024-12-14 19:04:00)
    > [ Upstream commit d35f7672715d1ff3e3ad9bb4ae6ac6cb484200fe ]
    > During initialization, the driver allocates wq-&gt;pring in lpfc_wq_create
    > and lpfc_sli4_queue_unset() is the only place where kfree(wq-&gt;pring) is
    > called.
    > There is a possible memory leak in lpfc_sli_brdrestart_s4() (restart)
    > and lpfc_pci_remove_one_s4() (rmmod) paths because there are no calls to
    > lpfc_sli4_queue_unset() to kfree() the wq-&gt;pring.
    > Fix by inserting a call to lpfc_sli4_queue_unset() in
    > lpfc_sli_brdrestart_s4() and lpfc_sli4_hba_unset() routines.  Also, add
    > a check for the SLI_ACTIVE flag before issuing the Q_DESTROY mailbox
    > command.  If not set, then the mailbox command will obviously fail.  In
    > such cases, skip issuing the mailbox command and only execute the driver
    > resource clean up portions of the lpfc_*q_destroy routines.
    > Signed-off-by: Justin Tee &lt;justin.tee@broadcom.com&gt;
    > Link: https://lore.kernel.org/r/20241031223219.152342-4-justintee8345@gmail.com
    > Signed-off-by: Martin K. Petersen &lt;martin.petersen@oracle.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ scsi: lpfc: Check SLI_ACTIVE flag in FDMI cmpl before submitting follow up FDMI (@Justin Tee in [32a2d387822b41e](https://github.com/sophgo/linux-riscv/commit/32a2d387822b41e) at 2024-12-14 19:04:00)
    > [ Upstream commit 98f8d3588097e321be70f83b844fa67d4828fe5c ]
    > The lpfc_cmpl_ct_disc_fdmi() routine has incorrect logic that treats an
    > FDMI completion with error LOCAL_REJECT/SLI_ABORTED as a success status.
    > Under the erroneous assumption of successful completion, the routine
    > proceeds to issue follow up FDMI commands, which may never complete if
    > the HBA is in an errata state as indicated by the errored completion
    > status.  Fix by freeing FDMI cmd resources and early return when the
    > LPFC_SLI_ACTIVE flag is not set and a LOCAL_REJECT/SLI_ABORTED or
    > SLI_DOWN status is received.
    > Signed-off-by: Justin Tee &lt;justin.tee@broadcom.com&gt;
    > Link: https://lore.kernel.org/r/20241031223219.152342-6-justintee8345@gmail.com
    > Signed-off-by: Martin K. Petersen &lt;martin.petersen@oracle.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ bpf: put bpf_link&#x27;s program when link is safe to be deallocated (@Andrii Nakryiko in [2fcb921c2799c49](https://github.com/sophgo/linux-riscv/commit/2fcb921c2799c49) at 2024-12-14 19:04:00)
    > [ Upstream commit f44ec8733a8469143fde1984b5e6931b2e2f6f3f ]
    > In general, BPF link&#x27;s underlying BPF program should be considered to be
    > reachable through attach hook -&gt; link -&gt; prog chain, and, pessimistically,
    > we have to assume that as long as link&#x27;s memory is not safe to free,
    > attach hook&#x27;s code might hold a pointer to BPF program and use it.
    > As such, it&#x27;s not (generally) correct to put link&#x27;s program early before
    > waiting for RCU GPs to go through. More eager bpf_prog_put() that we
    > currently do is mostly correct due to BPF program&#x27;s release code doing
    > similar RCU GP waiting, but as will be shown in the following patches,
    > BPF program can be non-sleepable (and, thus, reliant on only &quot;classic&quot;
    > RCU GP), while BPF link&#x27;s attach hook can have sleepable semantics and
    > needs to be protected by RCU Tasks Trace, and for such cases BPF link
    > has to go through RCU Tasks Trace + &quot;classic&quot; RCU GPs before being
    > deallocated. And so, if we put BPF program early, we might free BPF
    > program before we free BPF link, leading to use-after-free situation.
    > So, this patch defers bpf_prog_put() until we are ready to perform
    > bpf_link&#x27;s deallocation. At worst, this delays BPF program freeing by
    > one extra RCU GP, but that seems completely acceptable. Alternatively,
    > we&#x27;d need more elaborate ways to determine BPF hook, BPF link, and BPF
    > program lifetimes, and how they relate to each other, which seems like
    > an unnecessary complication.
    > Note, for most BPF links we still will perform eager bpf_prog_put() and
    > link dealloc, so for those BPF links there are no observable changes
    > whatsoever. Only BPF links that use deferred dealloc might notice
    > slightly delayed freeing of BPF programs.
    > Also, to reduce code and logic duplication, extract program put + link
    > dealloc logic into bpf_link_dealloc() helper.
    > Link: https://lore.kernel.org/20241101181754.782341-1-andrii@kernel.org
    > Tested-by: Jordan Rife &lt;jrife@google.com&gt;
    > Signed-off-by: Andrii Nakryiko &lt;andrii@kernel.org&gt;
    > Signed-off-by: Steven Rostedt (Google) &lt;rostedt@goodmis.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ rtla/timerlat: Make timerlat_hist_cpu-&gt;*_count unsigned long long (@Tomas Glozar in [caa061be068bd57](https://github.com/sophgo/linux-riscv/commit/caa061be068bd57) at 2024-12-14 19:03:59)
    > [ Upstream commit 76b3102148135945b013797fac9b206273f0f777 ]
    > Do the same fix as in previous commit also for timerlat-hist.
    > Link: https://lore.kernel.org/20241011121015.2868751-2-tglozar@redhat.com
    > Reported-by: Attila Fazekas &lt;afazekas@redhat.com&gt;
    > Signed-off-by: Tomas Glozar &lt;tglozar@redhat.com&gt;
    > Signed-off-by: Steven Rostedt (Google) &lt;rostedt@goodmis.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ pinmux: Use sequential access to access desc-&gt;pinmux data (@Mukesh Ojha in [c11e2ec9a780f54](https://github.com/sophgo/linux-riscv/commit/c11e2ec9a780f54) at 2024-12-14 19:03:59)
    > [ Upstream commit 5a3e85c3c397c781393ea5fb2f45b1f60f8a4e6e ]
    > When two client of the same gpio call pinctrl_select_state() for the
    > same functionality, we are seeing NULL pointer issue while accessing
    > desc-&gt;mux_owner.
    > Let&#x27;s say two processes A, B executing in pin_request() for the same pin
    > and process A updates the desc-&gt;mux_usecount but not yet updated the
    > desc-&gt;mux_owner while process B see the desc-&gt;mux_usecount which got
    > updated by A path and further executes strcmp and while accessing
    > desc-&gt;mux_owner it crashes with NULL pointer.
    > Serialize the access to mux related setting with a mutex lock.
    > cpu0 (process A)			cpu1(process B)
    > pinctrl_select_state() {		  pinctrl_select_state() {
    > pin_request() {				pin_request() {
    > ...
    > ....
    > } else {
    > desc-&gt;mux_usecount++;
    > desc-&gt;mux_usecount &amp;&amp; strcmp(desc-&gt;mux_owner, owner)) {
    > if (desc-&gt;mux_usecount &gt; 1)
    > return 0;
    > desc-&gt;mux_owner &#x3D; owner;
    > }						}
    > Signed-off-by: Mukesh Ojha &lt;quic_mojha@quicinc.com&gt;
    > Link: https://lore.kernel.org/20241014192930.1539673-1-quic_mojha@quicinc.com
    > Signed-off-by: Linus Walleij &lt;linus.walleij@linaro.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ scsi: ufs: core: Make DMA mask configuration more flexible (@Bart Van Assche in [b865d4e569286c1](https://github.com/sophgo/linux-riscv/commit/b865d4e569286c1) at 2024-12-14 19:03:59)
    > [ Upstream commit 78bc671bd1501e2f6c571e063301a4fdc5db53b2 ]
    > Replace UFSHCD_QUIRK_BROKEN_64BIT_ADDRESS with
    > ufs_hba_variant_ops::set_dma_mask.  Update the Renesas driver
    > accordingly.  This patch enables supporting other configurations than
    > 32-bit or 64-bit DMA addresses, e.g. 36-bit DMA addresses.
    > Signed-off-by: Bart Van Assche &lt;bvanassche@acm.org&gt;
    > Link: https://lore.kernel.org/r/20241018194753.775074-1-bvanassche@acm.org
    > Reviewed-by: Avri Altman &lt;Avri.Altman@wdc.com&gt;
    > Reviewed-by: Peter Wang &lt;peter.wang@mediatek.com&gt;
    > Signed-off-by: Martin K. Petersen &lt;martin.petersen@oracle.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ scsi: hisi_sas: Create all dump files during debugfs initialization (@Yihang Li in [6c55f99123075e5](https://github.com/sophgo/linux-riscv/commit/6c55f99123075e5) at 2024-12-14 19:03:59)
    > [ Upstream commit 9f564f15f88490b484e02442dc4c4b11640ea172 ]
    > For the current debugfs of hisi_sas, after user triggers dump, the
    > driver allocate memory space to save the register information and create
    > debugfs files to display the saved information. In this process, the
    > debugfs files created after each dump.
    > Therefore, when the dump is triggered while the driver is unbind, the
    > following hang occurs:
    > [67840.853907] Unable to handle kernel NULL pointer dereference at virtual address 00000000000000a0
    > [67840.862947] Mem abort info:
    > [67840.865855]   ESR &#x3D; 0x0000000096000004
    > [67840.869713]   EC &#x3D; 0x25: DABT (current EL), IL &#x3D; 32 bits
    > [67840.875125]   SET &#x3D; 0, FnV &#x3D; 0
    > [67840.878291]   EA &#x3D; 0, S1PTW &#x3D; 0
    > [67840.881545]   FSC &#x3D; 0x04: level 0 translation fault
    > [67840.886528] Data abort info:
    > [67840.889524]   ISV &#x3D; 0, ISS &#x3D; 0x00000004, ISS2 &#x3D; 0x00000000
    > [67840.895117]   CM &#x3D; 0, WnR &#x3D; 0, TnD &#x3D; 0, TagAccess &#x3D; 0
    > [67840.900284]   GCS &#x3D; 0, Overlay &#x3D; 0, DirtyBit &#x3D; 0, Xs &#x3D; 0
    > [67840.905709] user pgtable: 4k pages, 48-bit VAs, pgdp&#x3D;0000002803a1f000
    > [67840.912263] [00000000000000a0] pgd&#x3D;0000000000000000, p4d&#x3D;0000000000000000
    > [67840.919177] Internal error: Oops: 0000000096000004 [#1] PREEMPT SMP
    > [67840.996435] pstate: 80400009 (Nzcv daif +PAN -UAO -TCO -DIT -SSBS BTYPE&#x3D;--)
    > [67841.003628] pc : down_write+0x30/0x98
    > [67841.007546] lr : start_creating.part.0+0x60/0x198
    > [67841.012495] sp : ffff8000b979ba20
    > [67841.016046] x29: ffff8000b979ba20 x28: 0000000000000010 x27: 0000000000024b40
    > [67841.023412] x26: 0000000000000012 x25: ffff20202b355ae8 x24: ffff20202b35a8c8
    > [67841.030779] x23: ffffa36877928208 x22: ffffa368b4972240 x21: ffff8000b979bb18
    > [67841.038147] x20: ffff00281dc1e3c0 x19: fffffffffffffffe x18: 0000000000000020
    > [67841.045515] x17: 0000000000000000 x16: ffffa368b128a530 x15: ffffffffffffffff
    > [67841.052888] x14: ffff8000b979bc18 x13: ffffffffffffffff x12: ffff8000b979bb18
    > [67841.060263] x11: 0000000000000000 x10: 0000000000000000 x9 : ffffa368b1289b18
    > [67841.067640] x8 : 0000000000000012 x7 : 0000000000000000 x6 : 00000000000003a9
    > [67841.075014] x5 : 0000000000000000 x4 : ffff002818c5cb00 x3 : 0000000000000001
    > [67841.082388] x2 : 0000000000000000 x1 : ffff002818c5cb00 x0 : 00000000000000a0
    > [67841.089759] Call trace:
    > [67841.092456]  down_write+0x30/0x98
    > [67841.096017]  start_creating.part.0+0x60/0x198
    > [67841.100613]  debugfs_create_dir+0x48/0x1f8
    > [67841.104950]  debugfs_create_files_v3_hw+0x88/0x348 [hisi_sas_v3_hw]
    > [67841.111447]  debugfs_snapshot_regs_v3_hw+0x708/0x798 [hisi_sas_v3_hw]
    > [67841.118111]  debugfs_trigger_dump_v3_hw_write+0x9c/0x120 [hisi_sas_v3_hw]
    > [67841.125115]  full_proxy_write+0x68/0xc8
    > [67841.129175]  vfs_write+0xd8/0x3f0
    > [67841.132708]  ksys_write+0x70/0x108
    > [67841.136317]  __arm64_sys_write+0x24/0x38
    > [67841.140440]  invoke_syscall+0x50/0x128
    > [67841.144385]  el0_svc_common.constprop.0+0xc8/0xf0
    > [67841.149273]  do_el0_svc+0x24/0x38
    > [67841.152773]  el0_svc+0x38/0xd8
    > [67841.156009]  el0t_64_sync_handler+0xc0/0xc8
    > [67841.160361]  el0t_64_sync+0x1a4/0x1a8
    > [67841.164189] Code: b9000882 d2800002 d2800023 f9800011 (c85ffc05)
    > [67841.170443] ---[ end trace 0000000000000000 ]---
    > To fix this issue, create all directories and files during debugfs
    > initialization. In this way, the driver only needs to allocate memory
    > space to save information each time the user triggers dumping.
    > Signed-off-by: Yihang Li &lt;liyihang9@huawei.com&gt;
    > Link: https://lore.kernel.org/r/20241008021822.2617339-13-liyihang9@huawei.com
    > Reviewed-by: Xingui Yang &lt;yangxingui@huawei.com&gt;
    > Signed-off-by: Martin K. Petersen &lt;martin.petersen@oracle.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ scsi: hisi_sas: Add cond_resched() for no forced preemption model (@Yihang Li in [601f8001373fc3f](https://github.com/sophgo/linux-riscv/commit/601f8001373fc3f) at 2024-12-14 19:03:59)
    > [ Upstream commit 2233c4a0b948211743659b24c13d6bd059fa75fc ]
    > For no forced preemption model kernel, in the scenario where the
    > expander is connected to 12 high performance SAS SSDs, the following
    > call trace may occur:
    > [  214.409199][  C240] watchdog: BUG: soft lockup - CPU#240 stuck for 22s! [irq/149-hisi_sa:3211]
    > [  214.568533][  C240] pstate: 60400009 (nZCv daif +PAN -UAO -TCO BTYPE&#x3D;--)
    > [  214.575224][  C240] pc : fput_many+0x8c/0xdc
    > [  214.579480][  C240] lr : fput+0x1c/0xf0
    > [  214.583302][  C240] sp : ffff80002de2b900
    > [  214.587298][  C240] x29: ffff80002de2b900 x28: ffff1082aa412000
    > [  214.593291][  C240] x27: ffff3062a0348c08 x26: ffff80003a9f6000
    > [  214.599284][  C240] x25: ffff1062bbac5c40 x24: 0000000000001000
    > [  214.605277][  C240] x23: 000000000000000a x22: 0000000000000001
    > [  214.611270][  C240] x21: 0000000000001000 x20: 0000000000000000
    > [  214.617262][  C240] x19: ffff3062a41ae580 x18: 0000000000010000
    > [  214.623255][  C240] x17: 0000000000000001 x16: ffffdb3a6efe5fc0
    > [  214.629248][  C240] x15: ffffffffffffffff x14: 0000000003ffffff
    > [  214.635241][  C240] x13: 000000000000ffff x12: 000000000000029c
    > [  214.641234][  C240] x11: 0000000000000006 x10: ffff80003a9f7fd0
    > [  214.647226][  C240] x9 : ffffdb3a6f0482fc x8 : 0000000000000001
    > [  214.653219][  C240] x7 : 0000000000000002 x6 : 0000000000000080
    > [  214.659212][  C240] x5 : ffff55480ee9b000 x4 : fffffde7f94c6554
    > [  214.665205][  C240] x3 : 0000000000000002 x2 : 0000000000000020
    > [  214.671198][  C240] x1 : 0000000000000021 x0 : ffff3062a41ae5b8
    > [  214.677191][  C240] Call trace:
    > [  214.680320][  C240]  fput_many+0x8c/0xdc
    > [  214.684230][  C240]  fput+0x1c/0xf0
    > [  214.687707][  C240]  aio_complete_rw+0xd8/0x1fc
    > [  214.692225][  C240]  blkdev_bio_end_io+0x98/0x140
    > [  214.696917][  C240]  bio_endio+0x160/0x1bc
    > [  214.701001][  C240]  blk_update_request+0x1c8/0x3bc
    > [  214.705867][  C240]  scsi_end_request+0x3c/0x1f0
    > [  214.710471][  C240]  scsi_io_completion+0x7c/0x1a0
    > [  214.715249][  C240]  scsi_finish_command+0x104/0x140
    > [  214.720200][  C240]  scsi_softirq_done+0x90/0x180
    > [  214.724892][  C240]  blk_mq_complete_request+0x5c/0x70
    > [  214.730016][  C240]  scsi_mq_done+0x48/0xac
    > [  214.734194][  C240]  sas_scsi_task_done+0xbc/0x16c [libsas]
    > [  214.739758][  C240]  slot_complete_v3_hw+0x260/0x760 [hisi_sas_v3_hw]
    > [  214.746185][  C240]  cq_thread_v3_hw+0xbc/0x190 [hisi_sas_v3_hw]
    > [  214.752179][  C240]  irq_thread_fn+0x34/0xa4
    > [  214.756435][  C240]  irq_thread+0xc4/0x130
    > [  214.760520][  C240]  kthread+0x108/0x13c
    > [  214.764430][  C240]  ret_from_fork+0x10/0x18
    > This is because in the hisi_sas driver, both the hardware interrupt
    > handler and the interrupt thread are executed on the same CPU. In the
    > performance test scenario, function irq_wait_for_interrupt() will always
    > return 0 if lots of interrupts occurs and the CPU will be continuously
    > consumed. As a result, the CPU cannot run the watchdog thread. When the
    > watchdog time exceeds the specified time, call trace occurs.
    > To fix it, add cond_resched() to execute the watchdog thread.
    > Signed-off-by: Yihang Li &lt;liyihang9@huawei.com&gt;
    > Link: https://lore.kernel.org/r/20241008021822.2617339-8-liyihang9@huawei.com
    > Reviewed-by: Xiang Chen &lt;chenxiang66@hisilicon.com&gt;
    > Signed-off-by: Martin K. Petersen &lt;martin.petersen@oracle.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ring-buffer: Limit time with disabled interrupts in rb_check_pages() (@Petr Pavlu in [09c083fbea760f8](https://github.com/sophgo/linux-riscv/commit/09c083fbea760f8) at 2024-12-14 19:03:59)
    > [ Upstream commit b237e1f7d2273fdcffac20100b72c002bdd770dd ]
    > The function rb_check_pages() validates the integrity of a specified
    > per-CPU tracing ring buffer. It does so by traversing the underlying
    > linked list and checking its next and prev links.
    > To guarantee that the list isn&#x27;t modified during the check, a caller
    > typically needs to take cpu_buffer-&gt;reader_lock. This prevents the check
    > from running concurrently, for example, with a potential reader which
    > can make the list temporarily inconsistent when swapping its old reader
    > page into the buffer.
    > A problem with this approach is that the time when interrupts are
    > disabled is non-deterministic, dependent on the ring buffer size. This
    > particularly affects PREEMPT_RT because the reader_lock is a raw
    > spinlock which doesn&#x27;t become sleepable on PREEMPT_RT kernels.
    > Modify the check so it still attempts to traverse the entire list, but
    > gives up the reader_lock between checking individual pages. Introduce
    > for this purpose a new variable ring_buffer_per_cpu.cnt which is bumped
    > any time the list is modified. The value is used by rb_check_pages() to
    > detect such a change and restart the check.
    > Cc: Masami Hiramatsu &lt;mhiramat@kernel.org&gt;
    > Cc: Mathieu Desnoyers &lt;mathieu.desnoyers@efficios.com&gt;
    > Link: https://lore.kernel.org/20241015112810.27203-1-petr.pavlu@suse.com
    > Signed-off-by: Petr Pavlu &lt;petr.pavlu@suse.com&gt;
    > Signed-off-by: Steven Rostedt (Google) &lt;rostedt@goodmis.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ tracing/ftrace: disable preemption in syscall probe (@Mathieu Desnoyers in [f63a1caae97d997](https://github.com/sophgo/linux-riscv/commit/f63a1caae97d997) at 2024-12-14 19:03:58)
    > [ Upstream commit 13d750c2c03e9861e15268574ed2c239cca9c9d5 ]
    > In preparation for allowing system call enter/exit instrumentation to
    > handle page faults, make sure that ftrace can handle this change by
    > explicitly disabling preemption within the ftrace system call tracepoint
    > probes to respect the current expectations within ftrace ring buffer
    > code.
    > This change does not yet allow ftrace to take page faults per se within
    > its probe, but allows its existing probes to adapt to the upcoming
    > change.
    > Cc: Michael Jeanson &lt;mjeanson@efficios.com&gt;
    > Cc: Masami Hiramatsu &lt;mhiramat@kernel.org&gt;
    > Cc: Peter Zijlstra &lt;peterz@infradead.org&gt;
    > Cc: Alexei Starovoitov &lt;ast@kernel.org&gt;
    > Cc: Yonghong Song &lt;yhs@fb.com&gt;
    > Cc: Paul E. McKenney &lt;paulmck@kernel.org&gt;
    > Cc: Ingo Molnar &lt;mingo@redhat.com&gt;
    > Cc: Arnaldo Carvalho de Melo &lt;acme@kernel.org&gt;
    > Cc: Mark Rutland &lt;mark.rutland@arm.com&gt;
    > Cc: Alexander Shishkin &lt;alexander.shishkin@linux.intel.com&gt;
    > Cc: Namhyung Kim &lt;namhyung@kernel.org&gt;
    > Cc: Andrii Nakryiko &lt;andrii.nakryiko@gmail.com&gt;
    > Cc: bpf@vger.kernel.org
    > Cc: Joel Fernandes &lt;joel@joelfernandes.org&gt;
    > Link: https://lore.kernel.org/20241009010718.2050182-3-mathieu.desnoyers@efficios.com
    > Acked-by: Masami Hiramatsu (Google) &lt;mhiramat@kernel.org&gt;
    > Signed-off-by: Mathieu Desnoyers &lt;mathieu.desnoyers@efficios.com&gt;
    > Signed-off-by: Steven Rostedt (Google) &lt;rostedt@goodmis.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ tracing: Use atomic64_inc_return() in trace_clock_counter() (@Uros Bizjak in [d1133dd57ef8a5f](https://github.com/sophgo/linux-riscv/commit/d1133dd57ef8a5f) at 2024-12-14 19:03:58)
    > [ Upstream commit eb887c4567d1b0e7684c026fe7df44afa96589e6 ]
    > Use atomic64_inc_return(&amp;ref) instead of atomic64_add_return(1, &amp;ref)
    > to use optimized implementation and ease register pressure around
    > the primitive for targets that implement optimized variant.
    > Cc: Steven Rostedt &lt;rostedt@goodmis.org&gt;
    > Cc: Masami Hiramatsu &lt;mhiramat@kernel.org&gt;
    > Cc: Mathieu Desnoyers &lt;mathieu.desnoyers@efficios.com&gt;
    > Link: https://lore.kernel.org/20241007085651.48544-1-ubizjak@gmail.com
    > Signed-off-by: Uros Bizjak &lt;ubizjak@gmail.com&gt;
    > Signed-off-by: Steven Rostedt (Google) &lt;rostedt@goodmis.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ netpoll: Use rcu_access_pointer() in __netpoll_setup (@Breno Leitao in [9556551a6d91d09](https://github.com/sophgo/linux-riscv/commit/9556551a6d91d09) at 2024-12-14 19:03:58)
    > [ Upstream commit c69c5e10adb903ae2438d4f9c16eccf43d1fcbc1 ]
    > The ndev-&gt;npinfo pointer in __netpoll_setup() is RCU-protected but is being
    > accessed directly for a NULL check. While no RCU read lock is held in this
    > context, we should still use proper RCU primitives for consistency and
    > correctness.
    > Replace the direct NULL check with rcu_access_pointer(), which is the
    > appropriate primitive when only checking for NULL without dereferencing
    > the pointer. This function provides the necessary ordering guarantees
    > without requiring RCU read-side protection.
    > Reviewed-by: Michal Kubiak &lt;michal.kubiak@intel.com&gt;
    > Signed-off-by: Breno Leitao &lt;leitao@debian.org&gt;
    > Link: https://patch.msgid.link/20241118-netpoll_rcu-v1-1-a1888dcb4a02@debian.org
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ rtla/timerlat: Make timerlat_top_cpu-&gt;*_count unsigned long long (@Tomas Glozar in [76e00648ebf42e1](https://github.com/sophgo/linux-riscv/commit/76e00648ebf42e1) at 2024-12-14 19:03:58)
    > [ Upstream commit 4eba4723c5254ba8251ecb7094a5078d5c300646 ]
    > Most fields of struct timerlat_top_cpu are unsigned long long, but the
    > fields {irq,thread,user}_count are int (32-bit signed).
    > This leads to overflow when tracing on a large number of CPUs for a long
    > enough time:
    > $ rtla timerlat top -a20 -c 1-127 -d 12h
    > ...
    > 0 12:00:00   |          IRQ Timer Latency (us)        |         Thread Timer Latency (us)
    > CPU COUNT      |      cur       min       avg       max |      cur       min       avg       max
    > 1 #43200096  |        0         0         1         2 |        3         2         6        12
    > ...
    > 127 #43200096  |        0         0         1         2 |        3         2         5        11
    > ALL #119144 e4 |                  0         5         4 |                  2        28        16
    > The average latency should be 0-1 for IRQ and 5-6 for thread, but is
    > reported as 5 and 28, about 4 to 5 times more, due to the count
    > overflowing when summed over all CPUs: 43200096 * 127 &#x3D; 5486412192,
    > however, 1191444898 (&#x3D; 5486412192 mod MAX_INT) is reported instead, as
    > seen on the last line of the output, and the averages are thus ~4.6
    > times higher than they should be (5486412192 / 1191444898 &#x3D; ~4.6).
    > Fix the issue by changing {irq,thread,user}_count fields to unsigned
    > long long, similarly to other fields in struct timerlat_top_cpu and to
    > the count variable in timerlat_top_print_sum.
    > Link: https://lore.kernel.org/20241011121015.2868751-1-tglozar@redhat.com
    > Reported-by: Attila Fazekas &lt;afazekas@redhat.com&gt;
    > Signed-off-by: Tomas Glozar &lt;tglozar@redhat.com&gt;
    > Signed-off-by: Steven Rostedt (Google) &lt;rostedt@goodmis.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ rtla: Fix consistency in getopt_long for timerlat_hist (@Gabriele Monaco in [5f87f1b22f3f3ae](https://github.com/sophgo/linux-riscv/commit/5f87f1b22f3f3ae) at 2024-12-14 19:03:58)
    > [ Upstream commit cfb1ea216c1656a4112becbc4bf757891933b902 ]
    > Commit e9a4062e1527 (&quot;rtla: Add --trace-buffer-size option&quot;) adds a new
    > long option to rtla utilities, but among all affected files,
    > timerlat_hist misses a trailing &#x60;:&#x60; in the corresponding short option
    > inside the getopt string (e.g. &#x60;\3:&#x60;). This patch propagates the &#x60;:&#x60;.
    > Although this change is not functionally required, it improves
    > consistency and slightly reduces the likelihood a future change would
    > introduce a problem.
    > Cc: John Kacur &lt;jkacur@redhat.com&gt;
    > Cc: Luis Goncalves &lt;lgoncalv@redhat.com&gt;
    > Cc: Tomas Glozar &lt;tglozar@redhat.com&gt;
    > Link: https://lore.kernel.org/20240926143417.54039-1-gmonaco@redhat.com
    > Signed-off-by: Gabriele Monaco &lt;gmonaco@redhat.com&gt;
    > Signed-off-by: Steven Rostedt (Google) &lt;rostedt@goodmis.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ pinctrl: freescale: fix COMPILE_TEST error with PINCTRL_IMX_SCU (@Esben Haabendal in [53835aaccc2c76d](https://github.com/sophgo/linux-riscv/commit/53835aaccc2c76d) at 2024-12-14 19:03:58)
    > [ Upstream commit 58414a31c5713afb5449fd74a26a843d34cc62e8 ]
    > When PINCTRL_IMX_SCU was selected by PINCTRL_IMX8DXL or PINCTRL_IMX8QM
    > combined with COMPILE_TEST on a non-arm platforms, the IMX_SCU
    > dependency could not be enabled.
    > Reported-by: kernel test robot &lt;lkp@intel.com&gt;
    > Closes: https://lore.kernel.org/oe-kbuild-all/202410031439.GyTSa0kX-lkp@intel.com/
    > Closes: https://lore.kernel.org/oe-kbuild-all/202410030852.q0Hukplf-lkp@intel.com/
    > Signed-off-by: Esben Haabendal &lt;esben@geanix.com&gt;
    > Link: https://lore.kernel.org/20241003-imx-pinctrl-compile-test-fix-v1-1-145ca1948cc3@geanix.com
    > Signed-off-by: Linus Walleij &lt;linus.walleij@linaro.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ tools/rtla: fix collision with glibc sched_attr/sched_set_attr (@Jan Stancek in [020d042d03e22d0](https://github.com/sophgo/linux-riscv/commit/020d042d03e22d0) at 2024-12-14 19:03:58)
    > [ Upstream commit 0eecee340672c4b512f6f4a8c6add26df05d130c ]
    > glibc commit 21571ca0d703 (&quot;Linux: Add the sched_setattr
    > and sched_getattr functions&quot;) now also provides &#x27;struct sched_attr&#x27;
    > and sched_setattr() which collide with the ones from rtla.
    > In file included from src/trace.c:11:
    > src/utils.h:49:8: error: redefinition of ‘struct sched_attr’
    > 49 | struct sched_attr {
    > |        ^~~~~~~~~~
    > In file included from /usr/include/bits/sched.h:60,
    > from /usr/include/sched.h:43,
    > from /usr/include/tracefs/tracefs.h:10,
    > from src/trace.c:4:
    > /usr/include/linux/sched/types.h:98:8: note: originally defined here
    > 98 | struct sched_attr {
    > |        ^~~~~~~~~~
    > Define &#x27;struct sched_attr&#x27; conditionally, similar to what strace did:
    > https://lore.kernel.org/all/20240930222913.3981407-1-raj.khem@gmail.com/
    > and rename rtla&#x27;s version of sched_setattr() to avoid collision.
    > Link: https://lore.kernel.org/8088f66a7a57c1b209cd8ae0ae7c336a7f8c930d.1728572865.git.jstancek@redhat.com
    > Signed-off-by: Jan Stancek &lt;jstancek@redhat.com&gt;
    > Signed-off-by: Steven Rostedt (Google) &lt;rostedt@goodmis.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ASoC: hdmi-codec: reorder channel allocation list (@Jonas Karlman in [f5cc301e98a6462](https://github.com/sophgo/linux-riscv/commit/f5cc301e98a6462) at 2024-12-14 19:03:57)
    > [ Upstream commit 82ff5abc2edcfba0c0f1a1be807795e2876f46e9 ]
    > The ordering in hdmi_codec_get_ch_alloc_table_idx() results in
    > wrong channel allocation for a number of cases, e.g. when ELD
    > reports FL|FR|LFE|FC|RL|RR or FL|FR|LFE|FC|RL|RR|RC|RLC|RRC:
    > ca_id 0x01 with speaker mask FL|FR|LFE is selected instead of
    > ca_id 0x03 with speaker mask FL|FR|LFE|FC for 4 channels
    > and
    > ca_id 0x04 with speaker mask FL|FR|RC gets selected instead of
    > ca_id 0x0b with speaker mask FL|FR|LFE|FC|RL|RR for 6 channels
    > Fix this by reordering the channel allocation list with most
    > specific speaker masks at the top.
    > Signed-off-by: Jonas Karlman &lt;jonas@kwiboo.se&gt;
    > Signed-off-by: Christian Hewitt &lt;christianshewitt@gmail.com&gt;
    > Link: https://patch.msgid.link/20241115044344.3510979-1-christianshewitt@gmail.com
    > Signed-off-by: Mark Brown &lt;broonie@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ Bluetooth: btusb: Add new VID/PID 0489/e111 for MT7925 (@Hao Qin in [b476133f037e6ac](https://github.com/sophgo/linux-riscv/commit/b476133f037e6ac) at 2024-12-14 19:03:57)
    > [ Upstream commit faa5fd605d2081b6c9fa2355b59582d4ccd24b16 ]
    > Add VID 0489 &amp; PID e111 for MediaTek MT7925 USB Bluetooth chip.
    > The information in /sys/kernel/debug/usb/devices about the Bluetooth
    > device is listed as the below.
    > T:  Bus&#x3D;02 Lev&#x3D;02 Prnt&#x3D;02 Port&#x3D;04 Cnt&#x3D;02 Dev#&#x3D;  4 Spd&#x3D;480  MxCh&#x3D; 0
    > D:  Ver&#x3D; 2.10 Cls&#x3D;ef(misc ) Sub&#x3D;02 Prot&#x3D;01 MxPS&#x3D;64 #Cfgs&#x3D;  1
    > P:  Vendor&#x3D;0489 ProdID&#x3D;e111 Rev&#x3D; 1.00
    > S:  Manufacturer&#x3D;MediaTek Inc.
    > S:  Product&#x3D;Wireless_Device
    > S:  SerialNumber&#x3D;000000000
    > C:* #Ifs&#x3D; 3 Cfg#&#x3D; 1 Atr&#x3D;e0 MxPwr&#x3D;100mA
    > A:  FirstIf#&#x3D; 0 IfCount&#x3D; 3 Cls&#x3D;e0(wlcon) Sub&#x3D;01 Prot&#x3D;01
    > I:* If#&#x3D; 0 Alt&#x3D; 0 #EPs&#x3D; 3 Cls&#x3D;e0(wlcon) Sub&#x3D;01 Prot&#x3D;01 Driver&#x3D;btusb
    > E:  Ad&#x3D;81(I) Atr&#x3D;03(Int.) MxPS&#x3D;  16 Ivl&#x3D;125us
    > E:  Ad&#x3D;82(I) Atr&#x3D;02(Bulk) MxPS&#x3D; 512 Ivl&#x3D;0ms
    > E:  Ad&#x3D;02(O) Atr&#x3D;02(Bulk) MxPS&#x3D; 512 Ivl&#x3D;0ms
    > I:* If#&#x3D; 1 Alt&#x3D; 0 #EPs&#x3D; 2 Cls&#x3D;e0(wlcon) Sub&#x3D;01 Prot&#x3D;01 Driver&#x3D;btusb
    > E:  Ad&#x3D;83(I) Atr&#x3D;01(Isoc) MxPS&#x3D;   0 Ivl&#x3D;1ms
    > E:  Ad&#x3D;03(O) Atr&#x3D;01(Isoc) MxPS&#x3D;   0 Ivl&#x3D;1ms
    > I:  If#&#x3D; 1 Alt&#x3D; 1 #EPs&#x3D; 2 Cls&#x3D;e0(wlcon) Sub&#x3D;01 Prot&#x3D;01 Driver&#x3D;btusb
    > E:  Ad&#x3D;83(I) Atr&#x3D;01(Isoc) MxPS&#x3D;   9 Ivl&#x3D;1ms
    > E:  Ad&#x3D;03(O) Atr&#x3D;01(Isoc) MxPS&#x3D;   9 Ivl&#x3D;1ms
    > I:  If#&#x3D; 1 Alt&#x3D; 2 #EPs&#x3D; 2 Cls&#x3D;e0(wlcon) Sub&#x3D;01 Prot&#x3D;01 Driver&#x3D;btusb
    > E:  Ad&#x3D;83(I) Atr&#x3D;01(Isoc) MxPS&#x3D;  17 Ivl&#x3D;1ms
    > E:  Ad&#x3D;03(O) Atr&#x3D;01(Isoc) MxPS&#x3D;  17 Ivl&#x3D;1ms
    > I:  If#&#x3D; 1 Alt&#x3D; 3 #EPs&#x3D; 2 Cls&#x3D;e0(wlcon) Sub&#x3D;01 Prot&#x3D;01 Driver&#x3D;btusb
    > E:  Ad&#x3D;83(I) Atr&#x3D;01(Isoc) MxPS&#x3D;  25 Ivl&#x3D;1ms
    > E:  Ad&#x3D;03(O) Atr&#x3D;01(Isoc) MxPS&#x3D;  25 Ivl&#x3D;1ms
    > I:  If#&#x3D; 1 Alt&#x3D; 4 #EPs&#x3D; 2 Cls&#x3D;e0(wlcon) Sub&#x3D;01 Prot&#x3D;01 Driver&#x3D;btusb
    > E:  Ad&#x3D;83(I) Atr&#x3D;01(Isoc) MxPS&#x3D;  33 Ivl&#x3D;1ms
    > E:  Ad&#x3D;03(O) Atr&#x3D;01(Isoc) MxPS&#x3D;  33 Ivl&#x3D;1ms
    > I:  If#&#x3D; 1 Alt&#x3D; 5 #EPs&#x3D; 2 Cls&#x3D;e0(wlcon) Sub&#x3D;01 Prot&#x3D;01 Driver&#x3D;btusb
    > E:  Ad&#x3D;83(I) Atr&#x3D;01(Isoc) MxPS&#x3D;  49 Ivl&#x3D;1ms
    > E:  Ad&#x3D;03(O) Atr&#x3D;01(Isoc) MxPS&#x3D;  49 Ivl&#x3D;1ms
    > I:  If#&#x3D; 1 Alt&#x3D; 6 #EPs&#x3D; 2 Cls&#x3D;e0(wlcon) Sub&#x3D;01 Prot&#x3D;01 Driver&#x3D;btusb
    > E:  Ad&#x3D;83(I) Atr&#x3D;01(Isoc) MxPS&#x3D;  63 Ivl&#x3D;1ms
    > E:  Ad&#x3D;03(O) Atr&#x3D;01(Isoc) MxPS&#x3D;  63 Ivl&#x3D;1ms
    > I:* If#&#x3D; 2 Alt&#x3D; 0 #EPs&#x3D; 2 Cls&#x3D;e0(wlcon) Sub&#x3D;01 Prot&#x3D;01 Driver&#x3D;(none)
    > E:  Ad&#x3D;8a(I) Atr&#x3D;03(Int.) MxPS&#x3D;  64 Ivl&#x3D;125us
    > E:  Ad&#x3D;0a(O) Atr&#x3D;03(Int.) MxPS&#x3D;  64 Ivl&#x3D;125us
    > I:  If#&#x3D; 2 Alt&#x3D; 1 #EPs&#x3D; 2 Cls&#x3D;e0(wlcon) Sub&#x3D;01 Prot&#x3D;01 Driver&#x3D;(none)
    > E:  Ad&#x3D;8a(I) Atr&#x3D;03(Int.) MxPS&#x3D; 512 Ivl&#x3D;125us
    > E:  Ad&#x3D;0a(O) Atr&#x3D;03(Int.) MxPS&#x3D; 512 Ivl&#x3D;125us
    > Signed-off-by: Hao Qin &lt;hao.qin@mediatek.com&gt;
    > Signed-off-by: Luiz Augusto von Dentz &lt;luiz.von.dentz@intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ rocker: fix link status detection in rocker_carrier_init() (@Dmitry Antipov in [4f995f5b1633b6e](https://github.com/sophgo/linux-riscv/commit/4f995f5b1633b6e) at 2024-12-14 19:03:57)
    > [ Upstream commit e64285ff41bb7a934bd815bd38f31119be62ac37 ]
    > Since &#x27;1 &lt;&lt; rocker_port-&gt;pport&#x27; may be undefined for port &gt;&#x3D; 32,
    > cast the left operand to &#x27;unsigned long long&#x27; like it&#x27;s done in
    > &#x27;rocker_port_set_enable()&#x27; above. Compile tested only.
    > Found by Linux Verification Center (linuxtesting.org) with SVACE.
    > Signed-off-by: Dmitry Antipov &lt;dmantipov@yandex.ru&gt;
    > Link: https://patch.msgid.link/20241114151946.519047-1-dmantipov@yandex.ru
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ net/neighbor: clear error in case strict check is not set (@Jakub Kicinski in [166cf430706daa4](https://github.com/sophgo/linux-riscv/commit/166cf430706daa4) at 2024-12-14 19:03:57)
    > [ Upstream commit 0de6a472c3b38432b2f184bd64eb70d9ea36d107 ]
    > Commit 51183d233b5a (&quot;net/neighbor: Update neigh_dump_info for strict
    > data checking&quot;) added strict checking. The err variable is not cleared,
    > so if we find no table to dump we will return the validation error even
    > if user did not want strict checking.
    > I think the only way to hit this is to send an buggy request, and ask
    > for a table which doesn&#x27;t exist, so there&#x27;s no point treating this
    > as a real fix. I only noticed it because a syzbot repro depended on it
    > to trigger another bug.
    > Reviewed-by: Simon Horman &lt;horms@kernel.org&gt;
    > Link: https://patch.msgid.link/20241115003221.733593-1-kuba@kernel.org
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ Bluetooth: btusb: Add 3 HWIDs for MT7925 (@Jiande Lu in [058067b73b9da46](https://github.com/sophgo/linux-riscv/commit/058067b73b9da46) at 2024-12-14 19:03:57)
    > [ Upstream commit de7dcf9d1df4b0009735756d0a2adff09c3f21d4 ]
    > Add below HWIDs for MediaTek MT7925 USB Bluetooth chip.
    > VID 0x0489, PID 0xe14f
    > VID 0x0489, PID 0xe150
    > VID 0x0489, PID 0xe151
    > Patch has been tested successfully and controller is recognized
    > device pair successfully.
    > MT7925 module bring up message as below.
    > Bluetooth: Core ver 2.22
    > Bluetooth: HCI device and connection manager initialized
    > Bluetooth: HCI socket layer initialized
    > Bluetooth: L2CAP socket layer initialized
    > Bluetooth: SCO socket layer initialized
    > Bluetooth: hci0: HW/SW Version: 0x00000000, Build Time: 20240816133202
    > Bluetooth: hci0: Device setup in 286558 usecs
    > Bluetooth: hci0: HCI Enhanced Setup Synchronous Connection command is advertised, but not supported.
    > Bluetooth: hci0: AOSP extensions version v1.00
    > Bluetooth: BNEP (Ethernet Emulation) ver 1.3
    > Bluetooth: BNEP filters: protocol multicast
    > Bluetooth: BNEP socket layer initialized
    > Bluetooth: MGMT ver 1.22
    > Bluetooth: RFCOMM TTY layer initialized
    > Bluetooth: RFCOMM socket layer initialized
    > Bluetooth: RFCOMM ver 1.11
    > Signed-off-by: Jiande Lu &lt;jiande.lu@mediatek.com&gt;
    > Signed-off-by: Luiz Augusto von Dentz &lt;luiz.von.dentz@intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ Bluetooth: btusb: Add new VID/PID 0489/e124 for MT7925 (@Jonathan McCrohan in [01649f8d6d93ad6](https://github.com/sophgo/linux-riscv/commit/01649f8d6d93ad6) at 2024-12-14 19:03:57)
    > [ Upstream commit 679cb60fd60774798719c3e449874a168642a8e6 ]
    > Add VID 0489 &amp; PID e124 for MediaTek MT7925 USB Bluetooth chip.
    > The information in /sys/kernel/debug/usb/devices about the Bluetooth
    > device is listed as the below.
    > T:  Bus&#x3D;01 Lev&#x3D;01 Prnt&#x3D;01 Port&#x3D;08 Cnt&#x3D;02 Dev#&#x3D;  3 Spd&#x3D;480  MxCh&#x3D; 0
    > D:  Ver&#x3D; 2.10 Cls&#x3D;ef(misc ) Sub&#x3D;02 Prot&#x3D;01 MxPS&#x3D;64 #Cfgs&#x3D;  1
    > P:  Vendor&#x3D;0489 ProdID&#x3D;e124 Rev&#x3D; 1.00
    > S:  Manufacturer&#x3D;MediaTek Inc.
    > S:  Product&#x3D;Wireless_Device
    > S:  SerialNumber&#x3D;000000000
    > C:* #Ifs&#x3D; 3 Cfg#&#x3D; 1 Atr&#x3D;e0 MxPwr&#x3D;100mA
    > A:  FirstIf#&#x3D; 0 IfCount&#x3D; 3 Cls&#x3D;e0(wlcon) Sub&#x3D;01 Prot&#x3D;01
    > I:* If#&#x3D; 0 Alt&#x3D; 0 #EPs&#x3D; 3 Cls&#x3D;e0(wlcon) Sub&#x3D;01 Prot&#x3D;01 Driver&#x3D;btusb
    > E:  Ad&#x3D;81(I) Atr&#x3D;03(Int.) MxPS&#x3D;  16 Ivl&#x3D;125us
    > E:  Ad&#x3D;82(I) Atr&#x3D;02(Bulk) MxPS&#x3D; 512 Ivl&#x3D;0ms
    > E:  Ad&#x3D;02(O) Atr&#x3D;02(Bulk) MxPS&#x3D; 512 Ivl&#x3D;0ms
    > I:* If#&#x3D; 1 Alt&#x3D; 0 #EPs&#x3D; 2 Cls&#x3D;e0(wlcon) Sub&#x3D;01 Prot&#x3D;01 Driver&#x3D;btusb
    > E:  Ad&#x3D;83(I) Atr&#x3D;01(Isoc) MxPS&#x3D;   0 Ivl&#x3D;1ms
    > E:  Ad&#x3D;03(O) Atr&#x3D;01(Isoc) MxPS&#x3D;   0 Ivl&#x3D;1ms
    > I:  If#&#x3D; 1 Alt&#x3D; 1 #EPs&#x3D; 2 Cls&#x3D;e0(wlcon) Sub&#x3D;01 Prot&#x3D;01 Driver&#x3D;btusb
    > E:  Ad&#x3D;83(I) Atr&#x3D;01(Isoc) MxPS&#x3D;   9 Ivl&#x3D;1ms
    > E:  Ad&#x3D;03(O) Atr&#x3D;01(Isoc) MxPS&#x3D;   9 Ivl&#x3D;1ms
    > I:  If#&#x3D; 1 Alt&#x3D; 2 #EPs&#x3D; 2 Cls&#x3D;e0(wlcon) Sub&#x3D;01 Prot&#x3D;01 Driver&#x3D;btusb
    > E:  Ad&#x3D;83(I) Atr&#x3D;01(Isoc) MxPS&#x3D;  17 Ivl&#x3D;1ms
    > E:  Ad&#x3D;03(O) Atr&#x3D;01(Isoc) MxPS&#x3D;  17 Ivl&#x3D;1ms
    > I:  If#&#x3D; 1 Alt&#x3D; 3 #EPs&#x3D; 2 Cls&#x3D;e0(wlcon) Sub&#x3D;01 Prot&#x3D;01 Driver&#x3D;btusb
    > E:  Ad&#x3D;83(I) Atr&#x3D;01(Isoc) MxPS&#x3D;  25 Ivl&#x3D;1ms
    > E:  Ad&#x3D;03(O) Atr&#x3D;01(Isoc) MxPS&#x3D;  25 Ivl&#x3D;1ms
    > I:  If#&#x3D; 1 Alt&#x3D; 4 #EPs&#x3D; 2 Cls&#x3D;e0(wlcon) Sub&#x3D;01 Prot&#x3D;01 Driver&#x3D;btusb
    > E:  Ad&#x3D;83(I) Atr&#x3D;01(Isoc) MxPS&#x3D;  33 Ivl&#x3D;1ms
    > E:  Ad&#x3D;03(O) Atr&#x3D;01(Isoc) MxPS&#x3D;  33 Ivl&#x3D;1ms
    > I:  If#&#x3D; 1 Alt&#x3D; 5 #EPs&#x3D; 2 Cls&#x3D;e0(wlcon) Sub&#x3D;01 Prot&#x3D;01 Driver&#x3D;btusb
    > E:  Ad&#x3D;83(I) Atr&#x3D;01(Isoc) MxPS&#x3D;  49 Ivl&#x3D;1ms
    > E:  Ad&#x3D;03(O) Atr&#x3D;01(Isoc) MxPS&#x3D;  49 Ivl&#x3D;1ms
    > I:  If#&#x3D; 1 Alt&#x3D; 6 #EPs&#x3D; 2 Cls&#x3D;e0(wlcon) Sub&#x3D;01 Prot&#x3D;01 Driver&#x3D;btusb
    > E:  Ad&#x3D;83(I) Atr&#x3D;01(Isoc) MxPS&#x3D;  63 Ivl&#x3D;1ms
    > E:  Ad&#x3D;03(O) Atr&#x3D;01(Isoc) MxPS&#x3D;  63 Ivl&#x3D;1ms
    > I:* If#&#x3D; 2 Alt&#x3D; 0 #EPs&#x3D; 2 Cls&#x3D;e0(wlcon) Sub&#x3D;01 Prot&#x3D;01 Driver&#x3D;(none)
    > E:  Ad&#x3D;8a(I) Atr&#x3D;03(Int.) MxPS&#x3D;  64 Ivl&#x3D;125us
    > E:  Ad&#x3D;0a(O) Atr&#x3D;03(Int.) MxPS&#x3D;  64 Ivl&#x3D;125us
    > I:  If#&#x3D; 2 Alt&#x3D; 1 #EPs&#x3D; 2 Cls&#x3D;e0(wlcon) Sub&#x3D;01 Prot&#x3D;01 Driver&#x3D;(none)
    > E:  Ad&#x3D;8a(I) Atr&#x3D;03(Int.) MxPS&#x3D; 512 Ivl&#x3D;125us
    > E:  Ad&#x3D;0a(O) Atr&#x3D;03(Int.) MxPS&#x3D; 512 Ivl&#x3D;125us
    > Signed-off-by: Jonathan McCrohan &lt;jmccrohan@gmail.com&gt;
    > Signed-off-by: Luiz Augusto von Dentz &lt;luiz.von.dentz@intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ Bluetooth: Set quirks for ATS2851 (@Danil Pylaev in [f64f7ff29701a25](https://github.com/sophgo/linux-riscv/commit/f64f7ff29701a25) at 2024-12-14 19:03:56)
    > [ Upstream commit 677a55ba11a82c2835550a82324cec5fcb2f9e2d ]
    > This adds quirks for broken ats2851 features.
    > Signed-off-by: Danil Pylaev &lt;danstiv404@gmail.com&gt;
    > Signed-off-by: Luiz Augusto von Dentz &lt;luiz.von.dentz@intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ Bluetooth: hci_conn: Use disable_delayed_work_sync (@Luiz Augusto von Dentz in [c55a4c5a04bae40](https://github.com/sophgo/linux-riscv/commit/c55a4c5a04bae40) at 2024-12-14 19:03:56)
    > [ Upstream commit 2b0f2fc9ed62e73c95df1fa8ed2ba3dac54699df ]
    > This makes use of disable_delayed_work_sync instead
    > cancel_delayed_work_sync as it not only cancel the ongoing work but also
    > disables new submit which is disarable since the object holding the work
    > is about to be freed.
    > Reported-by: syzbot+2446dd3cb07277388db6@syzkaller.appspotmail.com
    > Tested-by: syzbot+2446dd3cb07277388db6@syzkaller.appspotmail.com
    > Closes: https://syzkaller.appspot.com/bug?extid&#x3D;2446dd3cb07277388db6
    > Signed-off-by: Luiz Augusto von Dentz &lt;luiz.von.dentz@intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ Bluetooth: Add new quirks for ATS2851 (@Danil Pylaev in [b04b4fb91d423a5](https://github.com/sophgo/linux-riscv/commit/b04b4fb91d423a5) at 2024-12-14 19:03:56)
    > [ Upstream commit 94464a7b71634037b13d54021e0dfd0fb0d8c1f0 ]
    > This adds quirks for broken extended create connection,
    > and write auth payload timeout.
    > Signed-off-by: Danil Pylaev &lt;danstiv404@gmail.com&gt;
    > Signed-off-by: Luiz Augusto von Dentz &lt;luiz.von.dentz@intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ Bluetooth: hci_core: Fix not checking skb length on hci_acldata_packet (@Luiz Augusto von Dentz in [93a6160dc198ffe](https://github.com/sophgo/linux-riscv/commit/93a6160dc198ffe) at 2024-12-14 19:03:56)
    > [ Upstream commit 3fe288a8214e7dd784d1f9b7c9e448244d316b47 ]
    > This fixes not checking if skb really contains an ACL header otherwise
    > the code may attempt to access some uninitilized/invalid memory past the
    > valid skb-&gt;data.
    > Reported-by: syzbot+6ea290ba76d8c1eb1ac2@syzkaller.appspotmail.com
    > Tested-by: syzbot+6ea290ba76d8c1eb1ac2@syzkaller.appspotmail.com
    > Closes: https://syzkaller.appspot.com/bug?extid&#x3D;6ea290ba76d8c1eb1ac2
    > Signed-off-by: Luiz Augusto von Dentz &lt;luiz.von.dentz@intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ Bluetooth: Support new quirks for ATS2851 (@Danil Pylaev in [359fc41e3c4f51d](https://github.com/sophgo/linux-riscv/commit/359fc41e3c4f51d) at 2024-12-14 19:03:56)
    > [ Upstream commit 5bd3135924b4570dcecc8793f7771cb8d42d8b19 ]
    > This adds support for quirks for broken extended create connection,
    > and write auth payload timeout.
    > Signed-off-by: Danil Pylaev &lt;danstiv404@gmail.com&gt;
    > Signed-off-by: Luiz Augusto von Dentz &lt;luiz.von.dentz@intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ Bluetooth: btusb: Add USB HW IDs for MT7920/MT7925 (@Jiande Lu in [1de7ce1a88cdd05](https://github.com/sophgo/linux-riscv/commit/1de7ce1a88cdd05) at 2024-12-14 19:03:56)
    > [ Upstream commit a94bc93a305bdcb20cc62978c334cace932b1be0 ]
    > Add HW IDs for wireless module. These HW IDs are extracted from
    > Windows driver inf file and the test for card bring up successful.
    > MT7920 HW IDs test with below patch.
    > https://patchwork.kernel.org/project/bluetooth/
    > patch/20240930081257.23975-1-chris.lu@mediatek.com/
    > Patch has been tested successfully and controller is recognized
    > devices pair successfully.
    > MT7920 module bring up message as below.
    > Bluetooth: Core ver 2.22
    > Bluetooth: HCI device and connection manager initialized
    > Bluetooth: HCI socket layer initialized
    > Bluetooth: L2CAP socket layer initialized
    > Bluetooth: SCO socket layer initialized
    > Bluetooth: hci0: HW/SW Version: 0x008a008a, Build Time: 20240930111457
    > Bluetooth: hci0: Device setup in 143004 usecs
    > Bluetooth: hci0: HCI Enhanced Setup Synchronous Connection
    > command is advertised, but not supported.
    > Bluetooth: hci0: AOSP extensions version v1.00
    > Bluetooth: hci0: AOSP quality report is supported
    > Bluetooth: BNEP (Ethernet Emulation) ver 1.3
    > Bluetooth: BNEP filters: protocol multicast
    > Bluetooth: BNEP socket layer initialized
    > Bluetooth: MGMT ver 1.22
    > Bluetooth: RFCOMM TTY layer initialized
    > Bluetooth: RFCOMM socket layer initialized
    > Bluetooth: RFCOMM ver 1.11
    > MT7925 module bring up message as below.
    > Bluetooth: Core ver 2.22
    > Bluetooth: HCI device and connection manager initialized
    > Bluetooth: HCI socket layer initialized
    > Bluetooth: L2CAP socket layer initialized
    > Bluetooth: SCO socket layer initialized
    > Bluetooth: hci0: HW/SW Version: 0x00000000, Build Time: 20240816133202
    > Bluetooth: hci0: Device setup in 286558 usecs
    > Bluetooth: hci0: HCI Enhanced Setup Synchronous
    > Connection command is advertised, but not supported.
    > Bluetooth: hci0: AOSP extensions version v1.00
    > Bluetooth: BNEP (Ethernet Emulation) ver 1.3
    > Bluetooth: BNEP filters: protocol multicast
    > Bluetooth: BNEP socket layer initialized
    > Bluetooth: MGMT ver 1.22
    > Bluetooth: RFCOMM TTY layer initialized
    > Bluetooth: RFCOMM socket layer initialized
    > Bluetooth: RFCOMM ver 1.11
    > Signed-off-by: Jiande Lu &lt;jiande.lu@mediatek.com&gt;
    > Signed-off-by: Luiz Augusto von Dentz &lt;luiz.von.dentz@intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ Bluetooth: hci_conn: Reduce hci_conn_drop() calls in two functions (@Markus Elfring in [da561d5fb646097](https://github.com/sophgo/linux-riscv/commit/da561d5fb646097) at 2024-12-14 19:03:55)
    > [ Upstream commit d96b543c6f3b78b6440b68b5a5bbface553eff28 ]
    > An hci_conn_drop() call was immediately used after a null pointer check
    > for an hci_conn_link() call in two function implementations.
    > Thus call such a function only once instead directly before the checks.
    > This issue was transformed by using the Coccinelle software.
    > Signed-off-by: Markus Elfring &lt;elfring@users.sourceforge.net&gt;
    > Signed-off-by: Luiz Augusto von Dentz &lt;luiz.von.dentz@intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ bpf: Call free_htab_elem() after htab_unlock_bucket() (@Hou Tao in [a50b4aa3007e63a](https://github.com/sophgo/linux-riscv/commit/a50b4aa3007e63a) at 2024-12-14 19:03:55)
    > [ Upstream commit b9e9ed90b10c82a4e9d4d70a2890f06bfcdd3b78 ]
    > For htab of maps, when the map is removed from the htab, it may hold the
    > last reference of the map. bpf_map_fd_put_ptr() will invoke
    > bpf_map_free_id() to free the id of the removed map element. However,
    > bpf_map_fd_put_ptr() is invoked while holding a bucket lock
    > (raw_spin_lock_t), and bpf_map_free_id() attempts to acquire map_idr_lock
    > (spinlock_t), triggering the following lockdep warning:
    > &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;
    > [ BUG: Invalid wait context ]
    > 6.11.0-rc4+ #49 Not tainted
    > -----------------------------
    > test_maps/4881 is trying to lock:
    > ffffffff84884578 (map_idr_lock){+...}-{3:3}, at: bpf_map_free_id.part.0+0x21/0x70
    > other info that might help us debug this:
    > context-{5:5}
    > 2 locks held by test_maps/4881:
    > #0: ffffffff846caf60 (rcu_read_lock){....}-{1:3}, at: bpf_fd_htab_map_update_elem+0xf9/0x270
    > #1: ffff888149ced148 (&amp;htab-&gt;lockdep_key#2){....}-{2:2}, at: htab_map_update_elem+0x178/0xa80
    > stack backtrace:
    > CPU: 0 UID: 0 PID: 4881 Comm: test_maps Not tainted 6.11.0-rc4+ #49
    > Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), ...
    > Call Trace:
    > &lt;TASK&gt;
    > dump_stack_lvl+0x6e/0xb0
    > dump_stack+0x10/0x20
    > __lock_acquire+0x73e/0x36c0
    > lock_acquire+0x182/0x450
    > _raw_spin_lock_irqsave+0x43/0x70
    > bpf_map_free_id.part.0+0x21/0x70
    > bpf_map_put+0xcf/0x110
    > bpf_map_fd_put_ptr+0x9a/0xb0
    > free_htab_elem+0x69/0xe0
    > htab_map_update_elem+0x50f/0xa80
    > bpf_fd_htab_map_update_elem+0x131/0x270
    > htab_map_update_elem+0x50f/0xa80
    > bpf_fd_htab_map_update_elem+0x131/0x270
    > bpf_map_update_value+0x266/0x380
    > __sys_bpf+0x21bb/0x36b0
    > __x64_sys_bpf+0x45/0x60
    > x64_sys_call+0x1b2a/0x20d0
    > do_syscall_64+0x5d/0x100
    > entry_SYSCALL_64_after_hwframe+0x76/0x7e
    > One way to fix the lockdep warning is using raw_spinlock_t for
    > map_idr_lock as well. However, bpf_map_alloc_id() invokes
    > idr_alloc_cyclic() after acquiring map_idr_lock, it will trigger a
    > similar lockdep warning because the slab&#x27;s lock (s-&gt;cpu_slab-&gt;lock) is
    > still a spinlock.
    > Instead of changing map_idr_lock&#x27;s type, fix the issue by invoking
    > htab_put_fd_value() after htab_unlock_bucket(). However, only deferring
    > the invocation of htab_put_fd_value() is not enough, because the old map
    > pointers in htab of maps can not be saved during batched deletion.
    > Therefore, also defer the invocation of free_htab_elem(), so these
    > to-be-freed elements could be linked together similar to lru map.
    > There are four callers for -&gt;map_fd_put_ptr:
    > (1) alloc_htab_elem() (through htab_put_fd_value())
    > It invokes -&gt;map_fd_put_ptr() under a raw_spinlock_t. The invocation of
    > htab_put_fd_value() can not simply move after htab_unlock_bucket(),
    > because the old element has already been stashed in htab-&gt;extra_elems.
    > It may be reused immediately after htab_unlock_bucket() and the
    > invocation of htab_put_fd_value() after htab_unlock_bucket() may release
    > the newly-added element incorrectly. Therefore, saving the map pointer
    > of the old element for htab of maps before unlocking the bucket and
    > releasing the map_ptr after unlock. Beside the map pointer in the old
    > element, should do the same thing for the special fields in the old
    > element as well.
    > (2) free_htab_elem() (through htab_put_fd_value())
    > Its caller includes __htab_map_lookup_and_delete_elem(),
    > htab_map_delete_elem() and __htab_map_lookup_and_delete_batch().
    > For htab_map_delete_elem(), simply invoke free_htab_elem() after
    > htab_unlock_bucket(). For __htab_map_lookup_and_delete_batch(), just
    > like lru map, linking the to-be-freed element into node_to_free list
    > and invoking free_htab_elem() for these element after unlock. It is safe
    > to reuse batch_flink as the link for node_to_free, because these
    > elements have been removed from the hash llist.
    > Because htab of maps doesn&#x27;t support lookup_and_delete operation,
    > __htab_map_lookup_and_delete_elem() doesn&#x27;t have the problem, so kept
    > it as is.
    > (3) fd_htab_map_free()
    > It invokes -&gt;map_fd_put_ptr without raw_spinlock_t.
    > (4) bpf_fd_htab_map_update_elem()
    > It invokes -&gt;map_fd_put_ptr without raw_spinlock_t.
    > After moving free_htab_elem() outside htab bucket lock scope, using
    > pcpu_freelist_push() instead of __pcpu_freelist_push() to disable
    > the irq before freeing elements, and protecting the invocations of
    > bpf_mem_cache_free() with migrate_{disable|enable} pair.
    > Signed-off-by: Hou Tao &lt;houtao1@huawei.com&gt;
    > Link: https://lore.kernel.org/r/20241106063542.357743-2-houtao@huaweicloud.com
    > Signed-off-by: Alexei Starovoitov &lt;ast@kernel.org&gt;
    > Signed-off-by: Andrii Nakryiko &lt;andrii@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ mptcp: fix possible integer overflow in mptcp_reset_tout_timer (@Dmitry Kandybka in [9fbc0ece455e2c0](https://github.com/sophgo/linux-riscv/commit/9fbc0ece455e2c0) at 2024-12-14 19:03:55)
    > [ Upstream commit b169e76ebad22cbd055101ee5aa1a7bed0e66606 ]
    > In &#x27;mptcp_reset_tout_timer&#x27;, promote &#x27;probe_timestamp&#x27; to unsigned long
    > to avoid possible integer overflow. Compile tested only.
    > Found by Linux Verification Center (linuxtesting.org) with SVACE.
    > Signed-off-by: Dmitry Kandybka &lt;d.kandybka@gmail.com&gt;
    > Link: https://patch.msgid.link/20241107103657.1560536-1-d.kandybka@gmail.com
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ i2c: i801: Add support for Intel Panther Lake (@Jarkko Nikula in [6e72b117614ce77](https://github.com/sophgo/linux-riscv/commit/6e72b117614ce77) at 2024-12-14 19:03:55)
    > [ Upstream commit bd492b58371295d3ae26162b9666be584abad68a ]
    > Add SMBus PCI IDs on Intel Panther Lake-P and -U.
    > Signed-off-by: Jarkko Nikula &lt;jarkko.nikula@linux.intel.com&gt;
    > Signed-off-by: Andi Shyti &lt;andi.shyti@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ dsa: qca8k: Use nested lock to avoid splat (@Andrew Lunn in [1ab42ad28076304](https://github.com/sophgo/linux-riscv/commit/1ab42ad28076304) at 2024-12-14 19:03:55)
    > [ Upstream commit 078e0d596f7b5952dad8662ace8f20ed2165e2ce ]
    > qca8k_phy_eth_command() is used to probe the child MDIO bus while the
    > parent MDIO is locked. This causes lockdep splat, reporting a possible
    > deadlock. It is not an actually deadlock, because different locks are
    > used. By making use of mutex_lock_nested() we can avoid this false
    > positive.
    > Signed-off-by: Andrew Lunn &lt;andrew@lunn.ch&gt;
    > Link: https://patch.msgid.link/20241110175955.3053664-1-andrew@lunn.ch
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ Bluetooth: btusb: Add RTL8852BE device 0489:e123 to device tables (@Hilda Wu in [05c10ebcbfde413](https://github.com/sophgo/linux-riscv/commit/05c10ebcbfde413) at 2024-12-14 19:03:55)
    > [ Upstream commit 69b84ffce260ff13826dc10aeb3c3e5c2288a552 ]
    > Add the support ID 0489:e123 to usb_device_id table for
    > Realtek RTL8852B chip.
    > The device info from /sys/kernel/debug/usb/devices as below.
    > T:  Bus&#x3D;01 Lev&#x3D;01 Prnt&#x3D;01 Port&#x3D;07 Cnt&#x3D;04 Dev#&#x3D;  7 Spd&#x3D;12   MxCh&#x3D; 0
    > D:  Ver&#x3D; 1.00 Cls&#x3D;e0(wlcon) Sub&#x3D;01 Prot&#x3D;01 MxPS&#x3D;64 #Cfgs&#x3D;  1
    > P:  Vendor&#x3D;0489 ProdID&#x3D;e123 Rev&#x3D; 0.00
    > S:  Manufacturer&#x3D;Realtek
    > S:  Product&#x3D;Bluetooth Radio
    > S:  SerialNumber&#x3D;00e04c000001
    > C:* #Ifs&#x3D; 2 Cfg#&#x3D; 1 Atr&#x3D;e0 MxPwr&#x3D;500mA
    > I:* If#&#x3D; 0 Alt&#x3D; 0 #EPs&#x3D; 3 Cls&#x3D;e0(wlcon) Sub&#x3D;01 Prot&#x3D;01 Driver&#x3D;btusb
    > E:  Ad&#x3D;81(I) Atr&#x3D;03(Int.) MxPS&#x3D;  16 Ivl&#x3D;1ms
    > E:  Ad&#x3D;02(O) Atr&#x3D;02(Bulk) MxPS&#x3D;  64 Ivl&#x3D;0ms
    > E:  Ad&#x3D;82(I) Atr&#x3D;02(Bulk) MxPS&#x3D;  64 Ivl&#x3D;0ms
    > I:* If#&#x3D; 1 Alt&#x3D; 0 #EPs&#x3D; 2 Cls&#x3D;e0(wlcon) Sub&#x3D;01 Prot&#x3D;01 Driver&#x3D;btusb
    > E:  Ad&#x3D;03(O) Atr&#x3D;01(Isoc) MxPS&#x3D;   0 Ivl&#x3D;1ms
    > E:  Ad&#x3D;83(I) Atr&#x3D;01(Isoc) MxPS&#x3D;   0 Ivl&#x3D;1ms
    > I:  If#&#x3D; 1 Alt&#x3D; 1 #EPs&#x3D; 2 Cls&#x3D;e0(wlcon) Sub&#x3D;01 Prot&#x3D;01 Driver&#x3D;btusb
    > E:  Ad&#x3D;03(O) Atr&#x3D;01(Isoc) MxPS&#x3D;   9 Ivl&#x3D;1ms
    > E:  Ad&#x3D;83(I) Atr&#x3D;01(Isoc) MxPS&#x3D;   9 Ivl&#x3D;1ms
    > I:  If#&#x3D; 1 Alt&#x3D; 2 #EPs&#x3D; 2 Cls&#x3D;e0(wlcon) Sub&#x3D;01 Prot&#x3D;01 Driver&#x3D;btusb
    > E:  Ad&#x3D;03(O) Atr&#x3D;01(Isoc) MxPS&#x3D;  17 Ivl&#x3D;1ms
    > E:  Ad&#x3D;83(I) Atr&#x3D;01(Isoc) MxPS&#x3D;  17 Ivl&#x3D;1ms
    > I:  If#&#x3D; 1 Alt&#x3D; 3 #EPs&#x3D; 2 Cls&#x3D;e0(wlcon) Sub&#x3D;01 Prot&#x3D;01 Driver&#x3D;btusb
    > E:  Ad&#x3D;03(O) Atr&#x3D;01(Isoc) MxPS&#x3D;  25 Ivl&#x3D;1ms
    > E:  Ad&#x3D;83(I) Atr&#x3D;01(Isoc) MxPS&#x3D;  25 Ivl&#x3D;1ms
    > I:  If#&#x3D; 1 Alt&#x3D; 4 #EPs&#x3D; 2 Cls&#x3D;e0(wlcon) Sub&#x3D;01 Prot&#x3D;01 Driver&#x3D;btusb
    > E:  Ad&#x3D;03(O) Atr&#x3D;01(Isoc) MxPS&#x3D;  33 Ivl&#x3D;1ms
    > E:  Ad&#x3D;83(I) Atr&#x3D;01(Isoc) MxPS&#x3D;  33 Ivl&#x3D;1ms
    > I:  If#&#x3D; 1 Alt&#x3D; 5 #EPs&#x3D; 2 Cls&#x3D;e0(wlcon) Sub&#x3D;01 Prot&#x3D;01 Driver&#x3D;btusb
    > E:  Ad&#x3D;03(O) Atr&#x3D;01(Isoc) MxPS&#x3D;  49 Ivl&#x3D;1ms
    > E:  Ad&#x3D;83(I) Atr&#x3D;01(Isoc) MxPS&#x3D;  49 Ivl&#x3D;1ms
    > Signed-off-by: Hilda Wu &lt;hildawu@realtek.com&gt;
    > Signed-off-by: Luiz Augusto von Dentz &lt;luiz.von.dentz@intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ wifi: ipw2x00: libipw_rx_any(): fix bad alignment (@Jiapeng Chong in [d82d48ab0c8cb5b](https://github.com/sophgo/linux-riscv/commit/d82d48ab0c8cb5b) at 2024-12-14 19:03:54)
    > [ Upstream commit 4fa4f049dc0d9741b16c96bcbf0108c85368a2b9 ]
    > This patch fixes incorrect code alignment.
    > ./drivers/net/wireless/intel/ipw2x00/libipw_rx.c:871:2-3: code aligned with following code on line 882.
    > ./drivers/net/wireless/intel/ipw2x00/libipw_rx.c:886:2-3: code aligned with following code on line 900.
    > Reported-by: Abaci Robot &lt;abaci@linux.alibaba.com&gt;
    > Closes: https://bugzilla.openanolis.cn/show_bug.cgi?id&#x3D;11381
    > Signed-off-by: Jiapeng Chong &lt;jiapeng.chong@linux.alibaba.com&gt;
    > Signed-off-by: Kalle Valo &lt;kvalo@kernel.org&gt;
    > Link: https://patch.msgid.link/20241101060725.54640-1-jiapeng.chong@linux.alibaba.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ALSA: usb-audio: Make mic volume workarounds globally applicable (@Takashi Iwai in [920159e1bf176bd](https://github.com/sophgo/linux-riscv/commit/920159e1bf176bd) at 2024-12-14 19:03:54)
    > [ Upstream commit d6e6b9218ced5249b9136833ef5ec3f554ec7fde ]
    > It seems that many webcams have buggy firmware and don&#x27;t expose the
    > mic capture volume with the proper resolution.  We have workarounds in
    > mixer.c, but judging from the numbers, those can be better managed as
    > global quirk flags.
    > Link: https://patch.msgid.link/20241105120220.5740-2-tiwai@suse.de
    > Signed-off-by: Takashi Iwai &lt;tiwai@suse.de&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/amdgpu: skip amdgpu_device_cache_pci_state under sriov (@Victor Zhao in [8a71e5b65308c47](https://github.com/sophgo/linux-riscv/commit/8a71e5b65308c47) at 2024-12-14 19:03:54)
    > [ Upstream commit afe260df55ac280cd56306248cb6d8a6b0db095c ]
    > Under sriov, host driver will save and restore vf pci cfg space during
    > reset. And during device init, under sriov, pci_restore_state happens after
    > fullaccess released, and it can have race condition with mmio protection
    > enable from host side leading to missing interrupts.
    > So skip amdgpu_device_cache_pci_state for sriov.
    > Signed-off-by: Victor Zhao &lt;Victor.Zhao@amd.com&gt;
    > Acked-by: Lijo Lazar &lt;lijo.lazar@amd.com&gt;
    > Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/amdgpu: set the right AMDGPU sg segment limitation (@Prike Liang in [76649ccf97e2cd7](https://github.com/sophgo/linux-riscv/commit/76649ccf97e2cd7) at 2024-12-14 19:03:54)
    > [ Upstream commit e2e97435783979124ba92d6870415c57ecfef6a5 ]
    > The driver needs to set the correct max_segment_size;
    > otherwise debug_dma_map_sg() will complain about the
    > over-mapping of the AMDGPU sg length as following:
    > WARNING: CPU: 6 PID: 1964 at kernel/dma/debug.c:1178 debug_dma_map_sg+0x2dc/0x370
    > [  364.049444] Modules linked in: veth amdgpu(OE) amdxcp drm_exec gpu_sched drm_buddy drm_ttm_helper ttm(OE) drm_suballoc_helper drm_display_helper drm_kms_helper i2c_algo_bit rpcsec_gss_krb5 auth_rpcgss nfsv4 nfs lockd grace netfs xt_conntrack xt_MASQUERADE nf_conntrack_netlink xfrm_user xfrm_algo iptable_nat xt_addrtype iptable_filter br_netfilter nvme_fabrics overlay nfnetlink_cttimeout nfnetlink openvswitch nsh nf_conncount nf_nat nf_conntrack nf_defrag_ipv6 nf_defrag_ipv4 libcrc32c bridge stp llc amd_atl intel_rapl_msr intel_rapl_common sunrpc sch_fq_codel snd_hda_codec_realtek snd_hda_codec_generic snd_hda_scodec_component snd_hda_codec_hdmi snd_hda_intel snd_intel_dspcfg edac_mce_amd binfmt_misc snd_hda_codec snd_pci_acp6x snd_hda_core snd_acp_config snd_hwdep snd_soc_acpi kvm_amd snd_pcm kvm snd_seq_midi snd_seq_midi_event crct10dif_pclmul ghash_clmulni_intel sha512_ssse3 snd_rawmidi sha256_ssse3 sha1_ssse3 aesni_intel snd_seq nls_iso8859_1 crypto_simd snd_seq_device cryptd snd_timer rapl input_leds snd
    > [  364.049532]  ipmi_devintf wmi_bmof ccp serio_raw k10temp sp5100_tco soundcore ipmi_msghandler cm32181 industrialio mac_hid msr parport_pc ppdev lp parport drm efi_pstore ip_tables x_tables pci_stub crc32_pclmul nvme ahci libahci i2c_piix4 r8169 nvme_core i2c_designware_pci realtek i2c_ccgx_ucsi video wmi hid_generic cdc_ether usbnet usbhid hid r8152 mii
    > [  364.049576] CPU: 6 PID: 1964 Comm: rocminfo Tainted: G           OE      6.10.0-custom #492
    > [  364.049579] Hardware name: AMD Majolica-RN/Majolica-RN, BIOS RMJ1009A 06/13/2021
    > [  364.049582] RIP: 0010:debug_dma_map_sg+0x2dc/0x370
    > [  364.049585] Code: 89 4d b8 e8 36 b1 86 00 8b 4d b8 48 8b 55 b0 44 8b 45 a8 4c 8b 4d a0 48 89 c6 48 c7 c7 00 4b 74 bc 4c 89 4d b8 e8 b4 73 f3 ff &lt;0f&gt; 0b 4c 8b 4d b8 8b 15 c8 2c b8 01 85 d2 0f 85 ee fd ff ff 8b 05
    > [  364.049588] RSP: 0018:ffff9ca600b57ac0 EFLAGS: 00010286
    > [  364.049590] RAX: 0000000000000000 RBX: ffff88b7c132b0c8 RCX: 0000000000000027
    > [  364.049592] RDX: ffff88bb0f521688 RSI: 0000000000000001 RDI: ffff88bb0f521680
    > [  364.049594] RBP: ffff9ca600b57b20 R08: 000000000000006f R09: ffff9ca600b57930
    > [  364.049596] R10: ffff9ca600b57928 R11: ffffffffbcb46328 R12: 0000000000000000
    > [  364.049597] R13: 0000000000000001 R14: ffff88b7c19c0700 R15: ffff88b7c9059800
    > [  364.049599] FS:  00007fb2d3516e80(0000) GS:ffff88bb0f500000(0000) knlGS:0000000000000000
    > [  364.049601] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
    > [  364.049603] CR2: 000055610bd03598 CR3: 00000001049f6000 CR4: 0000000000350ef0
    > [  364.049605] Call Trace:
    > [  364.049607]  &lt;TASK&gt;
    > [  364.049609]  ? show_regs+0x6d/0x80
    > [  364.049614]  ? __warn+0x8c/0x140
    > [  364.049618]  ? debug_dma_map_sg+0x2dc/0x370
    > [  364.049621]  ? report_bug+0x193/0x1a0
    > [  364.049627]  ? handle_bug+0x46/0x80
    > [  364.049631]  ? exc_invalid_op+0x1d/0x80
    > [  364.049635]  ? asm_exc_invalid_op+0x1f/0x30
    > [  364.049642]  ? debug_dma_map_sg+0x2dc/0x370
    > [  364.049647]  __dma_map_sg_attrs+0x90/0xe0
    > [  364.049651]  dma_map_sgtable+0x25/0x40
    > [  364.049654]  amdgpu_bo_move+0x59a/0x850 [amdgpu]
    > [  364.049935]  ? srso_return_thunk+0x5/0x5f
    > [  364.049939]  ? amdgpu_ttm_tt_populate+0x5d/0xc0 [amdgpu]
    > [  364.050095]  ttm_bo_handle_move_mem+0xc3/0x180 [ttm]
    > [  364.050103]  ttm_bo_validate+0xc1/0x160 [ttm]
    > [  364.050108]  ? amdgpu_ttm_tt_get_user_pages+0xe5/0x1b0 [amdgpu]
    > [  364.050263]  amdgpu_amdkfd_gpuvm_alloc_memory_of_gpu+0xa12/0xc90 [amdgpu]
    > [  364.050473]  kfd_ioctl_alloc_memory_of_gpu+0x16b/0x3b0 [amdgpu]
    > [  364.050680]  kfd_ioctl+0x3c2/0x530 [amdgpu]
    > [  364.050866]  ? __pfx_kfd_ioctl_alloc_memory_of_gpu+0x10/0x10 [amdgpu]
    > [  364.051054]  ? srso_return_thunk+0x5/0x5f
    > [  364.051057]  ? tomoyo_file_ioctl+0x20/0x30
    > [  364.051063]  __x64_sys_ioctl+0x9c/0xd0
    > [  364.051068]  x64_sys_call+0x1219/0x20d0
    > [  364.051073]  do_syscall_64+0x51/0x120
    > [  364.051077]  entry_SYSCALL_64_after_hwframe+0x76/0x7e
    > [  364.051081] RIP: 0033:0x7fb2d2f1a94f
    > Signed-off-by: Prike Liang &lt;Prike.Liang@amd.com&gt;
    > Reviewed-by: Christian König &lt;christian.koenig@amd.com&gt;
    > Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ virtio-net: fix overflow inside virtnet_rq_alloc (@Xuan Zhuo in [67a11de8965c2ab](https://github.com/sophgo/linux-riscv/commit/67a11de8965c2ab) at 2024-12-14 19:03:54)
    > [ Upstream commit 6aacd1484468361d1d04badfe75f264fa5314864 ]
    > When the frag just got a page, then may lead to regression on VM.
    > Specially if the sysctl net.core.high_order_alloc_disable value is 1,
    > then the frag always get a page when do refill.
    > Which could see reliable crashes or scp failure (scp a file 100M in size
    > to VM).
    > The issue is that the virtnet_rq_dma takes up 16 bytes at the beginning
    > of a new frag. When the frag size is larger than PAGE_SIZE,
    > everything is fine. However, if the frag is only one page and the
    > total size of the buffer and virtnet_rq_dma is larger than one page, an
    > overflow may occur.
    > The commit f9dac92ba908 (&quot;virtio_ring: enable premapped mode whatever
    > use_dma_api&quot;) introduced this problem. And we reverted some commits to
    > fix this in last linux version. Now we try to enable it and fix this
    > bug directly.
    > Here, when the frag size is not enough, we reduce the buffer len to fix
    > this problem.
    > Reported-by: &quot;Si-Wei Liu&quot; &lt;si-wei.liu@oracle.com&gt;
    > Tested-by: Darren Kenny &lt;darren.kenny@oracle.com&gt;
    > Signed-off-by: Xuan Zhuo &lt;xuanzhuo@linux.alibaba.com&gt;
    > Acked-by: Jason Wang &lt;jasowang@redhat.com&gt;
    > Signed-off-by: Paolo Abeni &lt;pabeni@redhat.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ wifi: brcmfmac: Fix oops due to NULL pointer dereference in brcmf_sdiod_sglist_rw() (@Norbert van Bolhuis in [34941321b516bd7](https://github.com/sophgo/linux-riscv/commit/34941321b516bd7) at 2024-12-14 19:03:54)
    > [ Upstream commit 857282b819cbaa0675aaab1e7542e2c0579f52d7 ]
    > This patch fixes a NULL pointer dereference bug in brcmfmac that occurs
    > when a high &#x27;sd_sgentry_align&#x27; value applies (e.g. 512) and a lot of queued SKBs
    > are sent from the pkt queue.
    > The problem is the number of entries in the pre-allocated sgtable, it is
    > nents &#x3D; max(rxglom_size, txglom_size) + max(rxglom_size, txglom_size) &gt;&gt; 4 + 1.
    > Given the default [rt]xglom_size&#x3D;32 it&#x27;s actually 35 which is too small.
    > Worst case, the pkt queue can end up with 64 SKBs. This occurs when a new SKB
    > is added for each original SKB if tailroom isn&#x27;t enough to hold tail_pad.
    > At least one sg entry is needed for each SKB. So, eventually the &quot;skb_queue_walk loop&quot;
    > in brcmf_sdiod_sglist_rw may run out of sg entries. This makes sg_next return
    > NULL and this causes the oops.
    > The patch sets nents to max(rxglom_size, txglom_size) * 2 to be able handle
    > the worst-case.
    > Btw. this requires only 64-35&#x3D;29 * 16 (or 20 if CONFIG_NEED_SG_DMA_LENGTH) &#x3D; 464
    > additional bytes of memory.
    > Signed-off-by: Norbert van Bolhuis &lt;nvbolhuis@gmail.com&gt;
    > Signed-off-by: Kalle Valo &lt;kvalo@kernel.org&gt;
    > Link: https://patch.msgid.link/20241107132903.13513-1-nvbolhuis@gmail.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/amd/display: parse umc_info or vram_info based on ASIC (@Aurabindo Pillai in [f46e40df44a904a](https://github.com/sophgo/linux-riscv/commit/f46e40df44a904a) at 2024-12-14 19:03:53)
    > [ Upstream commit 2551b4a321a68134360b860113dd460133e856e5 ]
    > An upstream bug report suggests that there are production dGPUs that are
    > older than DCN401 but still have a umc_info in VBIOS tables with the
    > same version as expected for a DCN401 product. Hence, reading this
    > tables should be guarded with a version check.
    > Closes: https://gitlab.freedesktop.org/drm/amd/-/issues/3678
    > Reviewed-by: Dillon Varone &lt;dillon.varone@amd.com&gt;
    > Signed-off-by: Aurabindo Pillai &lt;aurabindo.pillai@amd.com&gt;
    > Signed-off-by: Zaeem Mohamed &lt;zaeem.mohamed@amd.com&gt;
    > Tested-by: Daniel Wheeler &lt;daniel.wheeler@amd.com&gt;
    > Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ fsl/fman: Validate cell-index value obtained from Device Tree (@Aleksandr Mishin in [bd9287ae1e85d08](https://github.com/sophgo/linux-riscv/commit/bd9287ae1e85d08) at 2024-12-14 19:03:53)
    > [ Upstream commit bd50c4125c98bd1a86f8e514872159700a9c678c ]
    > Cell-index value is obtained from Device Tree and then used to calculate
    > the index for accessing arrays port_mfl[], mac_mfl[] and intr_mng[].
    > In case of broken DT due to any error cell-index can contain any value
    > and it is possible to go beyond the array boundaries which can lead
    > at least to memory corruption.
    > Validate cell-index value obtained from Device Tree.
    > Found by Linux Verification Center (linuxtesting.org) with SVACE.
    > Reviewed-by: Sean Anderson &lt;sean.anderson@seco.com&gt;
    > Signed-off-by: Aleksandr Mishin &lt;amishin@t-argos.ru&gt;
    > Link: https://patch.msgid.link/20241028065824.15452-1-amishin@t-argos.ru
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/amd/display: Remove hw w/a toggle if on DP2/HPO (@Ausef Yousof in [8ffd4262463d8db](https://github.com/sophgo/linux-riscv/commit/8ffd4262463d8db) at 2024-12-14 19:03:53)
    > [ Upstream commit b4c804628485af2b46f0d24a87190735cac37d61 ]
    > [why&amp;how]
    > Applying a hw w/a only relevant to DIG FIFO causing corruption
    > using HPO, do not apply the w/a if on DP2/HPO
    > Reviewed-by: Charlene Liu &lt;charlene.liu@amd.com&gt;
    > Signed-off-by: Ausef Yousof &lt;Ausef.Yousof@amd.com&gt;
    > Signed-off-by: Zaeem Mohamed &lt;zaeem.mohamed@amd.com&gt;
    > Tested-by: Daniel Wheeler &lt;daniel.wheeler@amd.com&gt;
    > Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/amd/display: Prune Invalid Modes For HDMI Output (@Fangzhi Zuo in [60dde89f944cddf](https://github.com/sophgo/linux-riscv/commit/60dde89f944cddf) at 2024-12-14 19:03:53)
    > [ Upstream commit abdd2768d7630bc8ec3403aea24f4197bada3c1f ]
    > [Why]
    > 1. HDMI does not have 6 bpc support. Having 6 bpc pass validation
    > does not comply with spec.
    > 2. Validate 420 only for native HDMI, but not apply to pcon use
    > case.
    > 3. Current mode validation log is not readable.
    > [how]
    > 1. Cap 8 bpc for dp-hdmi converter.
    > 2. Validate yuv420 for pcon use case as well,
    > if rgb/yuv444 8bpc cannot fit into pcon bw limitation of
    > the link from the converter to HDMI sink.
    > 3. Add readable pixel_format and color_depth into debug log.
    > Reviewed-by: Wayne Lin &lt;wayne.lin@amd.com&gt;
    > Signed-off-by: Fangzhi Zuo &lt;Jerry.Zuo@amd.com&gt;
    > Signed-off-by: Zaeem Mohamed &lt;zaeem.mohamed@amd.com&gt;
    > Tested-by: Daniel Wheeler &lt;daniel.wheeler@amd.com&gt;
    > Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/panic: Add ABGR2101010 support (@Jocelyn Falempe in [229d16a670938d5](https://github.com/sophgo/linux-riscv/commit/229d16a670938d5) at 2024-12-14 19:03:53)
    > [ Upstream commit 04596969eea9e73b64d63be52aabfddb382e9ce6 ]
    > Add support for ABGR2101010, used by the nouveau driver.
    > Signed-off-by: Jocelyn Falempe &lt;jfalempe@redhat.com&gt;
    > Reviewed-by: Javier Martinez Canillas &lt;javierm@redhat.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20241022185553.1103384-2-jfalempe@redhat.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ net/tcp: Add missing lockdep annotations for TCP-AO hlist traversals (@Dmitry Safonov in [051f49d5176613d](https://github.com/sophgo/linux-riscv/commit/051f49d5176613d) at 2024-12-14 19:03:53)
    > [ Upstream commit 6b2d11e2d8fc130df4708be0b6b53fd3e6b54cf6 ]
    > Under CONFIG_PROVE_RCU_LIST + CONFIG_RCU_EXPERT
    > hlist_for_each_entry_rcu() provides very helpful splats, which help
    > to find possible issues. I missed CONFIG_RCU_EXPERT&#x3D;y in my testing
    > config the same as described in
    > a3e4bf7f9675 (&quot;configs/debug: make sure PROVE_RCU_LIST&#x3D;y takes effect&quot;).
    > The fix itself is trivial: add the very same lockdep annotations
    > as were used to dereference ao_info from the socket.
    > Reported-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Closes: https://lore.kernel.org/netdev/20241028152645.35a8be66@kernel.org/
    > Signed-off-by: Dmitry Safonov &lt;0x7f454c46@gmail.com&gt;
    > Link: https://patch.msgid.link/20241030-tcp-ao-hlist-lockdep-annotate-v1-1-bf641a64d7c6@gmail.com
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ dma-debug: fix a possible deadlock on radix_lock (@Levi Yun in [f2b95248a16c518](https://github.com/sophgo/linux-riscv/commit/f2b95248a16c518) at 2024-12-14 19:03:52)
    > [ Upstream commit 7543c3e3b9b88212fcd0aaf5cab5588797bdc7de ]
    > radix_lock() shouldn&#x27;t be held while holding dma_hash_entry[idx].lock
    > otherwise, there&#x27;s a possible deadlock scenario when
    > dma debug API is called holding rq_lock():
    > CPU0                   CPU1                       CPU2
    > dma_free_attrs()
    > check_unmap()          add_dma_entry()            __schedule() //out
    > (A) rq_lock()
    > get_hash_bucket()
    > (A) dma_entry_hash
    > check_sync()
    > (A) radix_lock()           (W) dma_entry_hash
    > dma_entry_free()
    > (W) radix_lock()
    > // CPU2&#x27;s one
    > (W) rq_lock()
    > CPU1 situation can happen when it extending radix tree and
    > it tries to wake up kswapd via wake_all_kswapd().
    > CPU2 situation can happen while perf_event_task_sched_out()
    > (i.e. dma sync operation is called while deleting perf_event using
    > etm and etr tmc which are Arm Coresight hwtracing driver backends).
    > To remove this possible situation, call dma_entry_free() after
    > put_hash_bucket() in check_unmap().
    > Reported-by: Denis Nikitin &lt;denik@chromium.org&gt;
    > Closes: https://lists.linaro.org/archives/list/coresight@lists.linaro.org/thread/2WMS7BBSF5OZYB63VT44U5YWLFP5HL6U/#RWM6MLQX5ANBTEQ2PRM7OXCBGCE6NPWU
    > Signed-off-by: Levi Yun &lt;yeoreum.yun@arm.com&gt;
    > Signed-off-by: Christoph Hellwig &lt;hch@lst.de&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/amd/display: Fix underflow when playing 8K video in full screen mode (@Leo Ma in [cc97e79832fba78](https://github.com/sophgo/linux-riscv/commit/cc97e79832fba78) at 2024-12-14 19:03:52)
    > [ Upstream commit 4007f07a47de4a277f4760cac3aed1b31d973eea ]
    > [Why&amp;How]
    > Flickering observed while playing 8k HEVC-10 bit video in full screen
    > mode with black border. We didn&#x27;t support this case for subvp.
    > Make change to the existing check to disable subvp for this corner case.
    > Reviewed-by: Alvin Lee &lt;alvin.lee2@amd.com&gt;
    > Signed-off-by: Leo Ma &lt;hanghong.ma@amd.com&gt;
    > Signed-off-by: Dillon Varone &lt;dillon.varone@amd.com&gt;
    > Signed-off-by: Tom Chung &lt;chiahsuan.chung@amd.com&gt;
    > Tested-by: Daniel Wheeler &lt;daniel.wheeler@amd.com&gt;
    > Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ jfs: fix array-index-out-of-bounds in jfs_readdir (@Ghanshyam Agrawal in [8ff7579554571d9](https://github.com/sophgo/linux-riscv/commit/8ff7579554571d9) at 2024-12-14 19:03:52)
    > [ Upstream commit 839f102efb168f02dfdd46717b7c6dddb26b015e ]
    > The stbl might contain some invalid values. Added a check to
    > return error code in that case.
    > Reported-by: syzbot+0315f8fe99120601ba88@syzkaller.appspotmail.com
    > Closes: https://syzkaller.appspot.com/bug?extid&#x3D;0315f8fe99120601ba88
    > Signed-off-by: Ghanshyam Agrawal &lt;ghanshyam1898@gmail.com&gt;
    > Signed-off-by: Dave Kleikamp &lt;dave.kleikamp@oracle.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ jfs: add a check to prevent array-index-out-of-bounds in dbAdjTree (@Nihar Chaithanya in [8a4311bbde70236](https://github.com/sophgo/linux-riscv/commit/8a4311bbde70236) at 2024-12-14 19:03:52)
    > [ Upstream commit a174706ba4dad895c40b1d2277bade16dfacdcd9 ]
    > When the value of lp is 0 at the beginning of the for loop, it will
    > become negative in the next assignment and we should bail out.
    > Reported-by: syzbot+412dea214d8baa3f7483@syzkaller.appspotmail.com
    > Closes: https://syzkaller.appspot.com/bug?extid&#x3D;412dea214d8baa3f7483
    > Tested-by: syzbot+412dea214d8baa3f7483@syzkaller.appspotmail.com
    > Signed-off-by: Nihar Chaithanya &lt;niharchaithanya@gmail.com&gt;
    > Signed-off-by: Dave Kleikamp &lt;dave.kleikamp@oracle.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ jfs: fix shift-out-of-bounds in dbSplit (@Ghanshyam Agrawal in [52756a57e978e27](https://github.com/sophgo/linux-riscv/commit/52756a57e978e27) at 2024-12-14 19:03:52)
    > [ Upstream commit a5f5e4698f8abbb25fe4959814093fb5bfa1aa9d ]
    > When dmt_budmin is less than zero, it causes errors
    > in the later stages. Added a check to return an error beforehand
    > in dbAllocCtl itself.
    > Reported-by: syzbot+b5ca8a249162c4b9a7d0@syzkaller.appspotmail.com
    > Closes: https://syzkaller.appspot.com/bug?extid&#x3D;b5ca8a249162c4b9a7d0
    > Signed-off-by: Ghanshyam Agrawal &lt;ghanshyam1898@gmail.com&gt;
    > Signed-off-by: Dave Kleikamp &lt;dave.kleikamp@oracle.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ mptcp: annotate data-races around subflow-&gt;fully_established (@Gang Yan in [477aa7116a76a8e](https://github.com/sophgo/linux-riscv/commit/477aa7116a76a8e) at 2024-12-14 19:03:52)
    > [ Upstream commit 581c8cbfa934aaa555daa4e843242fcecc160f05 ]
    > We introduce the same handling for potential data races with the
    > &#x27;fully_established&#x27; flag in subflow as previously done for
    > msk-&gt;fully_established.
    > Additionally, we make a crucial change: convert the subflow&#x27;s
    > &#x27;fully_established&#x27; from &#x27;bit_field&#x27; to &#x27;bool&#x27; type. This is
    > necessary because methods for avoiding data races don&#x27;t work well
    > with &#x27;bit_field&#x27;. Specifically, the &#x27;READ_ONCE&#x27; needs to know
    > the size of the variable being accessed, which is not supported in
    > &#x27;bit_field&#x27;. Also, &#x27;test_bit&#x27; expect the address of &#x27;bit_field&#x27;.
    > Closes: https://github.com/multipath-tcp/mptcp_net-next/issues/516
    > Signed-off-by: Gang Yan &lt;yangang@kylinos.cn&gt;
    > Reviewed-by: Matthieu Baerts (NGI0) &lt;matttbe@kernel.org&gt;
    > Signed-off-by: Matthieu Baerts (NGI0) &lt;matttbe@kernel.org&gt;
    > Link: https://patch.msgid.link/20241021-net-next-mptcp-misc-6-13-v1-2-1ef02746504a@kernel.org
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ jfs: array-index-out-of-bounds fix in dtReadFirst (@Ghanshyam Agrawal in [22dcbf7661c6ffc](https://github.com/sophgo/linux-riscv/commit/22dcbf7661c6ffc) at 2024-12-14 19:03:52)
    > [ Upstream commit ca84a2c9be482836b86d780244f0357e5a778c46 ]
    > The value of stbl can be sometimes out of bounds due
    > to a bad filesystem. Added a check with appopriate return
    > of error code in that case.
    > Reported-by: syzbot+65fa06e29859e41a83f3@syzkaller.appspotmail.com
    > Closes: https://syzkaller.appspot.com/bug?extid&#x3D;65fa06e29859e41a83f3
    > Signed-off-by: Ghanshyam Agrawal &lt;ghanshyam1898@gmail.com&gt;
    > Signed-off-by: Dave Kleikamp &lt;dave.kleikamp@oracle.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/amdgpu: clear RB_OVERFLOW bit when enabling interrupts for vega20_ih (@Victor Lu in [f034130a7e228ec](https://github.com/sophgo/linux-riscv/commit/f034130a7e228ec) at 2024-12-14 19:03:51)
    > [ Upstream commit 8b22f048331dfd45fdfbf0efdfb1d43deff7518d ]
    > Port this change to vega20_ih.c:
    > commit afbf7955ff01 (&quot;drm/amdgpu: clear RB_OVERFLOW bit when enabling interrupts&quot;)
    > Original commit message:
    > &quot;Why:
    > Setting IH_RB_WPTR register to 0 will not clear the RB_OVERFLOW bit
    > if RB_ENABLE is not set.
    > How to fix:
    > Set WPTR_OVERFLOW_CLEAR bit after RB_ENABLE bit is set.
    > The RB_ENABLE bit is required to be set, together with
    > WPTR_OVERFLOW_ENABLE bit so that setting WPTR_OVERFLOW_CLEAR bit
    > would clear the RB_OVERFLOW.&quot;
    > Signed-off-by: Victor Lu &lt;victorchengchi.lu@amd.com&gt;
    > Reviewed-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/amdgpu: refine error handling in amdgpu_ttm_tt_pin_userptr (@Lang Yu in [d86db5fd8a2330a](https://github.com/sophgo/linux-riscv/commit/d86db5fd8a2330a) at 2024-12-14 19:03:51)
    > [ Upstream commit 46186667f98fb7158c98f4ff5da62c427761ffcd ]
    > Free sg table when dma_map_sgtable() failed to avoid memory leak.
    > Signed-off-by: Lang Yu &lt;lang.yu@amd.com&gt;
    > Reviewed-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ASoC: Intel: soc-acpi-intel-arl-match: Add rt722 and rt1320 support (@Mac Chiang in [9f0cb200f469ce5](https://github.com/sophgo/linux-riscv/commit/9f0cb200f469ce5) at 2024-12-14 19:03:51)
    > [ Upstream commit f193fb888d1da45365daa7d0ff7a964c8305d407 ]
    > This patch adds support for the rt722 multi-function codec and the
    > rt1320 amplifier in the ARL board configuration.
    > Link 0: RT722 codec with three endpoints: Headset, Speaker, and DMIC.
    > Link 2: RT1320 amplifier.
    > Note:
    > The Speaker endpoint on the RT722 codec is not used.
    > Signed-off-by: Mac Chiang &lt;mac.chiang@intel.com&gt;
    > Signed-off-by: Bard Liao &lt;yung-chuan.liao@linux.intel.com&gt;
    > Link: https://patch.msgid.link/20241028072631.15536-4-yung-chuan.liao@linux.intel.com
    > Signed-off-by: Mark Brown &lt;broonie@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ netlink: specs: Add missing bitset attrs to ethtool spec (@Donald Hunter in [76d6bff2f847691](https://github.com/sophgo/linux-riscv/commit/76d6bff2f847691) at 2024-12-14 19:03:51)
    > [ Upstream commit b0b3683419b45e2971b6d413c506cb818b268d35 ]
    > There are a couple of attributes missing from the &#x27;bitset&#x27; attribute-set
    > in the ethtool netlink spec. Add them to the spec.
    > Reported-by: Kory Maincent &lt;kory.maincent@bootlin.com&gt;
    > Closes: https://lore.kernel.org/netdev/20241017180551.1259bf5c@kmaincent-XPS-13-7390/
    > Signed-off-by: Donald Hunter &lt;donald.hunter@gmail.com&gt;
    > Reviewed-by: Kory Maincent &lt;kory.maincent@bootlin.com&gt;
    > Tested-by: Kory Maincent &lt;kory.maincent@bootlin.com&gt;
    > Link: https://patch.msgid.link/20241018090630.22212-1-donald.hunter@gmail.com
    > Signed-off-by: Paolo Abeni &lt;pabeni@redhat.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/amdgpu: Dereference the ATCS ACPI buffer (@Prike Liang in [7560543ee11f193](https://github.com/sophgo/linux-riscv/commit/7560543ee11f193) at 2024-12-14 19:03:51)
    > [ Upstream commit 32e7ee293ff476c67b51be006e986021967bc525 ]
    > Need to dereference the atcs acpi buffer after
    > the method is executed, otherwise it will result in
    > a memory leak.
    > Signed-off-by: Prike Liang &lt;Prike.Liang@amd.com&gt;
    > Reviewed-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ASoC: sdw_utils: Add quirk to exclude amplifier function (@Mac Chiang in [4ed4aa24b0f85d5](https://github.com/sophgo/linux-riscv/commit/4ed4aa24b0f85d5) at 2024-12-14 19:03:51)
    > [ Upstream commit 358ee2c1493e5d2c59820ffd8087eb0e367be4c6 ]
    > When SKUs use the multi-function codec, which integrates
    > Headset, Amplifier and DMIC. The corresponding quirks provide
    > options to support internal amplifier/DMIC or not.
    > In the case of RT722, this SKU excludes the internal amplifier and
    > use an additional amplifier instead.
    > Signed-off-by: Mac Chiang &lt;mac.chiang@intel.com&gt;
    > Signed-off-by: Bard Liao &lt;yung-chuan.liao@linux.intel.com&gt;
    > Link: https://patch.msgid.link/20241028072631.15536-2-yung-chuan.liao@linux.intel.com
    > Signed-off-by: Mark Brown &lt;broonie@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/amd/display: Adding array index check to prevent memory corruption (@Leo Chen in [dff526dc3e27f54](https://github.com/sophgo/linux-riscv/commit/dff526dc3e27f54) at 2024-12-14 19:03:50)
    > [ Upstream commit 2c437d9a0b496168e1a1defd17b531f0a526dbe9 ]
    > [Why &amp; How]
    > Array indices out of bound caused memory corruption. Adding checks to
    > ensure that array index stays in bound.
    > Reviewed-by: Charlene Liu &lt;charlene.liu@amd.com&gt;
    > Reviewed-by: Nicholas Kazlauskas &lt;nicholas.kazlauskas@amd.com&gt;
    > Signed-off-by: Leo Chen &lt;leo.chen@amd.com&gt;
    > Signed-off-by: Wayne Lin &lt;wayne.lin@amd.com&gt;
    > Tested-by: Daniel Wheeler &lt;daniel.wheeler@amd.com&gt;
    > Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/amdgpu/gfx9: Add cleaner shader for GFX9.4.2 (@Srinivasan Shanmugam in [dbb662d6dde2914](https://github.com/sophgo/linux-riscv/commit/dbb662d6dde2914) at 2024-12-14 19:03:50)
    > [ Upstream commit 9343b904e7198e4804685133327dece7fe709bc1 ]
    > This commit adds the cleaner shader microcode for GFX9.4.2 GPUs. The
    > cleaner shader is a piece of GPU code that is used to clear or
    > initialize certain GPU resources, such as Local Data Share (LDS), Vector
    > General Purpose Registers (VGPRs), and Scalar General Purpose Registers
    > (SGPRs).
    > Clearing these resources is important for ensuring data isolation
    > between different workloads running on the GPU. Without the cleaner
    > shader, residual data from a previous workload could potentially be
    > accessed by a subsequent workload, leading to data leaks and incorrect
    > computation results.
    > The cleaner shader microcode is represented as an array of 32-bit words
    > (&#x60;gfx_9_4_2_cleaner_shader_hex&#x60;). This array is the binary
    > representation of the cleaner shader code, which is written in a
    > low-level GPU instruction set.
    > Also, this patch updates the &#x60;gfx_v9_0_sw_init&#x60; function to initialize
    > the cleaner shader if the MEC firmware version is 88 or higher. It sets
    > the &#x60;cleaner_shader_ptr&#x60; and &#x60;cleaner_shader_size&#x60; to the appropriate
    > values and attempts to initialize the cleaner shader.
    > When the cleaner shader feature is enabled, the AMDGPU driver loads this
    > array into a specific location in the GPU memory. The GPU then reads
    > this memory location to fetch and execute the cleaner shader
    > instructions.
    > The cleaner shader is executed automatically by the GPU at the end of
    > each workload, before the next workload starts. This ensures that all
    > GPU resources are in a clean state before the start of each workload.
    > This change ensures that the GPU memory is properly cleared between
    > different processes, preventing data leakage and enhancing security. It
    > also aligns with the serialization mechanism between KGD and KFD,
    > ensuring that the GPU state is consistent across different workloads.
    > Cc: Christian König &lt;christian.koenig@amd.com&gt;
    > Cc: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Signed-off-by: Srinivasan Shanmugam &lt;srinivasan.shanmugam@amd.com&gt;
    > Suggested-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Reviewed-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ net: sfp: change quirks for Alcatel Lucent G-010S-P (@Shengyu Qu in [cdacfe413b6a4fb](https://github.com/sophgo/linux-riscv/commit/cdacfe413b6a4fb) at 2024-12-14 19:03:50)
    > [ Upstream commit 90cb5f1776ba371478e2b08fbf7018c7bd781a8d ]
    > Seems Alcatel Lucent G-010S-P also have the same problem that it uses
    > TX_FAULT pin for SOC uart. So apply sfp_fixup_ignore_tx_fault to it.
    > Signed-off-by: Shengyu Qu &lt;wiagn233@outlook.com&gt;
    > Link: https://patch.msgid.link/TYCPR01MB84373677E45A7BFA5A28232C98792@TYCPR01MB8437.jpnprd01.prod.outlook.com
    > Signed-off-by: Paolo Abeni &lt;pabeni@redhat.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/panel: simple: Add Microchip AC69T88A LVDS Display panel (@Manikandan Muralidharan in [53145c20ab06044](https://github.com/sophgo/linux-riscv/commit/53145c20ab06044) at 2024-12-14 19:03:50)
    > [ Upstream commit 40da1463cd6879f542238b36c1148f517927c595 ]
    > Add support for Microchip AC69T88A 5 inch TFT LCD 800x480
    > Display module with LVDS interface.The panel uses the Sitronix
    > ST7262 800x480 Display driver
    > Signed-off-by: Manikandan Muralidharan &lt;manikandan.m@microchip.com&gt;
    > Signed-off-by: Dharma Balasubiramani &lt;dharma.b@microchip.com&gt;
    > Reviewed-by: Dmitry Baryshkov &lt;dmitry.baryshkov@linaro.org&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20240919091548.430285-2-manikandan.m@microchip.com
    > Signed-off-by: Dmitry Baryshkov &lt;dmitry.baryshkov@linaro.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ net: stmmac: Programming sequence for VLAN packets with split header (@Abhishek Chauhan in [3e75b36733dde25](https://github.com/sophgo/linux-riscv/commit/3e75b36733dde25) at 2024-12-14 19:03:50)
    > [ Upstream commit d10f1a4e44c3bf874701f86f8cc43490e1956acf ]
    > Currently reset state configuration of split header works fine for
    > non-tagged packets and we see no corruption in payload of any size
    > We need additional programming sequence with reset configuration to
    > handle VLAN tagged packets to avoid corruption in payload for packets
    > of size greater than 256 bytes.
    > Without this change ping application complains about corruption
    > in payload when the size of the VLAN packet exceeds 256 bytes.
    > With this change tagged and non-tagged packets of any size works fine
    > and there is no corruption seen.
    > Current configuration which has the issue for VLAN packet
    > ----------------------------------------------------------
    > Split happens at the position at Layer 3 header
    > |MAC-DA|MAC-SA|Vlan Tag|Ether type|IP header|IP data|Rest of the payload|
    > 2 bytes            ^
    > |
    > With the fix we are making sure that the split happens now at
    > Layer 2 which is end of ethernet header and start of IP payload
    > Ip traffic split
    > -----------------
    > Bits which take care of this are SPLM and SPLOFST
    > SPLM &#x3D; Split mode is set to Layer 2
    > SPLOFST &#x3D; These bits indicate the value of offset from the beginning
    > of Length/Type field at which header split should take place when the
    > appropriate SPLM is selected. Reset value is 2bytes.
    > Un-tagged data (without VLAN)
    > |MAC-DA|MAC-SA|Ether type|IP header|IP data|Rest of the payload|
    > 2bytes ^
    > |
    > Tagged data (with VLAN)
    > |MAC-DA|MAC-SA|VLAN Tag|Ether type|IP header|IP data|Rest of the payload|
    > 2bytes  ^
    > |
    > Non-IP traffic split such AV packet
    > ------------------------------------
    > Bits which take care of this are
    > SAVE &#x3D; Split AV Enable
    > SAVO &#x3D; Split AV Offset, similar to SPLOFST but this is for AVTP
    > packets.
    > |Preamble|MAC-DA|MAC-SA|VLAN tag|Ether type|IEEE 1722 payload|CRC|
    > 2bytes ^
    > |
    > Signed-off-by: Abhishek Chauhan &lt;quic_abchauha@quicinc.com&gt;
    > Reviewed-by: Simon Horman &lt;horms@kernel.org&gt;
    > Link: https://patch.msgid.link/20241016234313.3992214-1-quic_abchauha@quicinc.com
    > Signed-off-by: Paolo Abeni &lt;pabeni@redhat.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/sched: memset() &#x27;job&#x27; in drm_sched_job_init() (@Philipp Stanner in [2da108b4b5fb7ec](https://github.com/sophgo/linux-riscv/commit/2da108b4b5fb7ec) at 2024-12-14 19:03:50)
    > [ Upstream commit 2320c9e6a768d135c7b0039995182bb1a4e4fd22 ]
    > drm_sched_job_init() has no control over how users allocate struct
    > drm_sched_job. Unfortunately, the function can also not set some struct
    > members such as job-&gt;sched.
    > This could theoretically lead to UB by users dereferencing the struct&#x27;s
    > pointer members too early.
    > It is easier to debug such issues if these pointers are initialized to
    > NULL, so dereferencing them causes a NULL pointer exception.
    > Accordingly, drm_sched_entity_init() does precisely that and initializes
    > its struct with memset().
    > Initialize parameter &quot;job&quot; to 0 in drm_sched_job_init().
    > Signed-off-by: Philipp Stanner &lt;pstanner@redhat.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20241021105028.19794-2-pstanner@redhat.com
    > Reviewed-by: Christian König &lt;christian.koenig@amd.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ASoC: Intel: sof_sdw: Add quirks for some new Lenovo laptops (@Charles Keepax in [cccaab2b8d63ef5](https://github.com/sophgo/linux-riscv/commit/cccaab2b8d63ef5) at 2024-12-14 19:03:49)
    > [ Upstream commit 83c062ae81e89f73e3ab85953111a8b3daaaf98e ]
    > Add some more sidecar amplifier quirks.
    > Signed-off-by: Charles Keepax &lt;ckeepax@opensource.cirrus.com&gt;
    > Reviewed-by: Liam Girdwood &lt;liam.r.girdwood@intel.com&gt;
    > Signed-off-by: Bard Liao &lt;yung-chuan.liao@linux.intel.com&gt;
    > Link: https://patch.msgid.link/20241016030344.13535-5-yung-chuan.liao@linux.intel.com
    > Signed-off-by: Mark Brown &lt;broonie@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/xe/guc/ct: Flush g2h worker in case of g2h response timeout (@Badal Nilawar in [b9c6b66865d6029](https://github.com/sophgo/linux-riscv/commit/b9c6b66865d6029) at 2024-12-14 19:03:49)
    > [ Upstream commit e5152723380404acb8175e0777b1cea57f319a01 ]
    > In case if g2h worker doesn&#x27;t get opportunity to within specified
    > timeout delay then flush the g2h worker explicitly.
    > v2:
    > - Describe change in the comment and add TODO (Matt B/John H)
    > - Add xe_gt_warn on fence done after G2H flush (John H)
    > v3:
    > - Updated the comment with root cause
    > - Clean up xe_gt_warn message (John H)
    > Closes: https://gitlab.freedesktop.org/drm/xe/kernel/issues/1620
    > Closes: https://gitlab.freedesktop.org/drm/xe/kernel/issues/2902
    > Signed-off-by: Badal Nilawar &lt;badal.nilawar@intel.com&gt;
    > Cc: Matthew Brost &lt;matthew.brost@intel.com&gt;
    > Cc: Matthew Auld &lt;matthew.auld@intel.com&gt;
    > Cc: John Harrison &lt;John.C.Harrison@Intel.com&gt;
    > Cc: Himal Prasad Ghimiray &lt;himal.prasad.ghimiray@intel.com&gt;
    > Reviewed-by: Himal Prasad Ghimiray &lt;himal.prasad.ghimiray@intel.com&gt;
    > Acked-by: Matthew Brost &lt;matthew.brost@intel.com&gt;
    > Signed-off-by: Matthew Brost &lt;matthew.brost@intel.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20241017111410.2553784-2-badal.nilawar@intel.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ASoC: Intel: sof_sdw: Add quirk for cs42l43 system using host DMICs (@Charles Keepax in [b55418d835bd1cc](https://github.com/sophgo/linux-riscv/commit/b55418d835bd1cc) at 2024-12-14 19:03:49)
    > [ Upstream commit ea657f6b24e11651a39292082be84ad81a89e525 ]
    > Add quirk to inform the machine driver to not bind in the cs42l43
    > microphone DAI link.
    > Signed-off-by: Charles Keepax &lt;ckeepax@opensource.cirrus.com&gt;
    > Reviewed-by: Liam Girdwood &lt;liam.r.girdwood@intel.com&gt;
    > Signed-off-by: Bard Liao &lt;yung-chuan.liao@linux.intel.com&gt;
    > Link: https://patch.msgid.link/20241016030344.13535-4-yung-chuan.liao@linux.intel.com
    > Signed-off-by: Mark Brown &lt;broonie@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ bpf: Prevent tailcall infinite loop caused by freplace (@Leon Hwang in [987aa730bad3e1e](https://github.com/sophgo/linux-riscv/commit/987aa730bad3e1e) at 2024-12-14 19:03:49)
    > [ Upstream commit d6083f040d5d8f8d748462c77e90547097df936e ]
    > There is a potential infinite loop issue that can occur when using a
    > combination of tail calls and freplace.
    > In an upcoming selftest, the attach target for entry_freplace of
    > tailcall_freplace.c is subprog_tc of tc_bpf2bpf.c, while the tail call in
    > entry_freplace leads to entry_tc. This results in an infinite loop:
    > entry_tc -&gt; subprog_tc -&gt; entry_freplace --tailcall-&gt; entry_tc.
    > The problem arises because the tail_call_cnt in entry_freplace resets to
    > zero each time entry_freplace is executed, causing the tail call mechanism
    > to never terminate, eventually leading to a kernel panic.
    > To fix this issue, the solution is twofold:
    > 1. Prevent updating a program extended by an freplace program to a
    > prog_array map.
    > 2. Prevent extending a program that is already part of a prog_array map
    > with an freplace program.
    > This ensures that:
    > If a program or its subprogram has been extended by an freplace program,
    > it can no longer be updated to a prog_array map.
    > If a program has been added to a prog_array map, neither it nor its
    > subprograms can be extended by an freplace program.
    > Moreover, an extension program should not be tailcalled. As such, return
    > -EINVAL if the program has a type of BPF_PROG_TYPE_EXT when adding it to a
    > prog_array map.
    > Additionally, fix a minor code style issue by replacing eight spaces with a
    > tab for proper formatting.
    > Reviewed-by: Eduard Zingerman &lt;eddyz87@gmail.com&gt;
    > Signed-off-by: Leon Hwang &lt;leon.hwang@linux.dev&gt;
    > Link: https://lore.kernel.org/r/20241015150207.70264-2-leon.hwang@linux.dev
    > Signed-off-by: Alexei Starovoitov &lt;ast@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ASoC: sdw_utils: Add support for exclusion DAI quirks (@Charles Keepax in [93d419a5532e9a8](https://github.com/sophgo/linux-riscv/commit/93d419a5532e9a8) at 2024-12-14 19:03:49)
    > [ Upstream commit 3d9b44d0972be1298400e449cfbcc436df2e988e ]
    > The system contains a mechanism for certain DAI links to be included
    > based on a quirk. Add support for certain DAI links to excluded based on
    > a quirk, this is useful in situations where the vast majority of SKUs
    > utilise a feature so it is easier to quirk on those that don&#x27;t.
    > Signed-off-by: Charles Keepax &lt;ckeepax@opensource.cirrus.com&gt;
    > Reviewed-by: Liam Girdwood &lt;liam.r.girdwood@intel.com&gt;
    > Signed-off-by: Bard Liao &lt;yung-chuan.liao@linux.intel.com&gt;
    > Link: https://patch.msgid.link/20241016030344.13535-2-yung-chuan.liao@linux.intel.com
    > Signed-off-by: Mark Brown &lt;broonie@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ASoC: sdw_utils: Add a quirk to allow the cs42l43 mic DAI to be ignored (@Charles Keepax in [3b3526352977dd3](https://github.com/sophgo/linux-riscv/commit/3b3526352977dd3) at 2024-12-14 19:03:49)
    > [ Upstream commit a6f7afb39362ef70d08d23e5bfc0a14d69fafea1 ]
    > To support some systems using host microphones add a quirk to allow the
    > cs42l43 microphone DAI link to be ignored.
    > Signed-off-by: Charles Keepax &lt;ckeepax@opensource.cirrus.com&gt;
    > Reviewed-by: Liam Girdwood &lt;liam.r.girdwood@intel.com&gt;
    > Signed-off-by: Bard Liao &lt;yung-chuan.liao@linux.intel.com&gt;
    > Link: https://patch.msgid.link/20241016030344.13535-3-yung-chuan.liao@linux.intel.com
    > Signed-off-by: Mark Brown &lt;broonie@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ net: inet6: do not leave a dangling sk pointer in inet6_create() (@Ignat Korchagin in [f44fceb71d72d29](https://github.com/sophgo/linux-riscv/commit/f44fceb71d72d29) at 2024-12-14 19:03:48)
    > [ Upstream commit 9df99c395d0f55fb444ef39f4d6f194ca437d884 ]
    > sock_init_data() attaches the allocated sk pointer to the provided sock
    > object. If inet6_create() fails later, the sk object is released, but the
    > sock object retains the dangling sk pointer, which may cause use-after-free
    > later.
    > Clear the sock sk pointer on error.
    > Signed-off-by: Ignat Korchagin &lt;ignat@cloudflare.com&gt;
    > Reviewed-by: Kuniyuki Iwashima &lt;kuniyu@amazon.com&gt;
    > Reviewed-by: Eric Dumazet &lt;edumazet@google.com&gt;
    > Link: https://patch.msgid.link/20241014153808.51894-8-ignat@cloudflare.com
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ wifi: ath5k: add PCI ID for SX76X (@Rosen Penev in [778c0bbc9f43314](https://github.com/sophgo/linux-riscv/commit/778c0bbc9f43314) at 2024-12-14 19:03:48)
    > [ Upstream commit da0474012402d4729b98799d71a54c35dc5c5de3 ]
    > This is in two devices made by Gigaset, SX762 and SX763.
    > Signed-off-by: Rosen Penev &lt;rosenp@gmail.com&gt;
    > Link: https://patch.msgid.link/20240930180716.139894-2-rosenp@gmail.com
    > Signed-off-by: Jeff Johnson &lt;quic_jjohnson@quicinc.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ wifi: ath5k: add PCI ID for Arcadyan devices (@Rosen Penev in [6cd0f8f2f317435](https://github.com/sophgo/linux-riscv/commit/6cd0f8f2f317435) at 2024-12-14 19:03:48)
    > [ Upstream commit f3ced9bb90b0a287a1fa6184d16b0f104a78fa90 ]
    > Arcadyan made routers with this PCI ID containing an AR2417.
    > Signed-off-by: Rosen Penev &lt;rosenp@gmail.com&gt;
    > Link: https://patch.msgid.link/20240930180716.139894-3-rosenp@gmail.com
    > Signed-off-by: Jeff Johnson &lt;quic_jjohnson@quicinc.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ fanotify: allow reporting errors on failure to open fd (@Amir Goldstein in [5b6209c793ef056](https://github.com/sophgo/linux-riscv/commit/5b6209c793ef056) at 2024-12-14 19:03:48)
    > [ Upstream commit 522249f05c5551aec9ec0ba9b6438f1ec19c138d ]
    > When working in &quot;fd mode&quot;, fanotify_read() needs to open an fd
    > from a dentry to report event-&gt;fd to userspace.
    > Opening an fd from dentry can fail for several reasons.
    > For example, when tasks are gone and we try to open their
    > /proc files or we try to open a WRONLY file like in sysfs
    > or when trying to open a file that was deleted on the
    > remote network server.
    > Add a new flag FAN_REPORT_FD_ERROR for fanotify_init().
    > For a group with FAN_REPORT_FD_ERROR, we will send the
    > event with the error instead of the open fd, otherwise
    > userspace may not get the error at all.
    > For an overflow event, we report -EBADF to avoid confusing FAN_NOFD
    > with -EPERM.  Similarly for pidfd open errors we report either -ESRCH
    > or the open error instead of FAN_NOPIDFD and FAN_EPIDFD.
    > In any case, userspace will not know which file failed to
    > open, so add a debug print for further investigation.
    > Reported-by: Krishna Vivek Vitta &lt;kvitta@microsoft.com&gt;
    > Link: https://lore.kernel.org/linux-fsdevel/SI2P153MB07182F3424619EDDD1F393EED46D2@SI2P153MB0718.APCP153.PROD.OUTLOOK.COM/
    > Signed-off-by: Amir Goldstein &lt;amir73il@gmail.com&gt;
    > Signed-off-by: Jan Kara &lt;jack@suse.cz&gt;
    > Link: https://patch.msgid.link/20241003142922.111539-1-amir73il@gmail.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ wifi: ath10k: avoid NULL pointer error during sdio remove (@Kang Yang in [543c0924d446b21](https://github.com/sophgo/linux-riscv/commit/543c0924d446b21) at 2024-12-14 19:03:48)
    > [ Upstream commit 95c38953cb1ecf40399a676a1f85dfe2b5780a9a ]
    > When running &#x27;rmmod ath10k&#x27;, ath10k_sdio_remove() will free sdio
    > workqueue by destroy_workqueue(). But if CONFIG_INIT_ON_FREE_DEFAULT_ON
    > is set to yes, kernel panic will happen:
    > Call trace:
    > destroy_workqueue+0x1c/0x258
    > ath10k_sdio_remove+0x84/0x94
    > sdio_bus_remove+0x50/0x16c
    > device_release_driver_internal+0x188/0x25c
    > device_driver_detach+0x20/0x2c
    > This is because during &#x27;rmmod ath10k&#x27;, ath10k_sdio_remove() will call
    > ath10k_core_destroy() before destroy_workqueue(). wiphy_dev_release()
    > will finally be called in ath10k_core_destroy(). This function will free
    > struct cfg80211_registered_device *rdev and all its members, including
    > wiphy, dev and the pointer of sdio workqueue. Then the pointer of sdio
    > workqueue will be set to NULL due to CONFIG_INIT_ON_FREE_DEFAULT_ON.
    > After device release, destroy_workqueue() will use NULL pointer then the
    > kernel panic happen.
    > Call trace:
    > ath10k_sdio_remove
    > -&gt;ath10k_core_unregister
    > ……
    > -&gt;ath10k_core_stop
    > -&gt;ath10k_hif_stop
    > -&gt;ath10k_sdio_irq_disable
    > -&gt;ath10k_hif_power_down
    > -&gt;del_timer_sync(&amp;ar_sdio-&gt;sleep_timer)
    > -&gt;ath10k_core_destroy
    > -&gt;ath10k_mac_destroy
    > -&gt;ieee80211_free_hw
    > -&gt;wiphy_free
    > ……
    > -&gt;wiphy_dev_release
    > -&gt;destroy_workqueue
    > Need to call destroy_workqueue() before ath10k_core_destroy(), free
    > the work queue buffer first and then free pointer of work queue by
    > ath10k_core_destroy(). This order matches the error path order in
    > ath10k_sdio_probe().
    > No work will be queued on sdio workqueue between it is destroyed and
    > ath10k_core_destroy() is called. Based on the call_stack above, the
    > reason is:
    > Only ath10k_sdio_sleep_timer_handler(), ath10k_sdio_hif_tx_sg() and
    > ath10k_sdio_irq_disable() will queue work on sdio workqueue.
    > Sleep timer will be deleted before ath10k_core_destroy() in
    > ath10k_hif_power_down().
    > ath10k_sdio_irq_disable() only be called in ath10k_hif_stop().
    > ath10k_core_unregister() will call ath10k_hif_power_down() to stop hif
    > bus, so ath10k_sdio_hif_tx_sg() won&#x27;t be called anymore.
    > Tested-on: QCA6174 hw3.2 SDIO WLAN.RMH.4.4.1-00189
    > Signed-off-by: Kang Yang &lt;quic_kangyang@quicinc.com&gt;
    > Tested-by: David Ruth &lt;druth@chromium.org&gt;
    > Reviewed-by: David Ruth &lt;druth@chromium.org&gt;
    > Link: https://patch.msgid.link/20241008022246.1010-1-quic_kangyang@quicinc.com
    > Signed-off-by: Jeff Johnson &lt;quic_jjohnson@quicinc.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ af_packet: avoid erroring out after sock_init_data() in packet_create() (@Ignat Korchagin in [fd09880b16d33aa](https://github.com/sophgo/linux-riscv/commit/fd09880b16d33aa) at 2024-12-14 19:03:47)
    > [ Upstream commit 46f2a11cb82b657fd15bab1c47821b635e03838b ]
    > After sock_init_data() the allocated sk object is attached to the provided
    > sock object. On error, packet_create() frees the sk object leaving the
    > dangling pointer in the sock object on return. Some other code may try
    > to use this pointer and cause use-after-free.
    > Suggested-by: Eric Dumazet &lt;edumazet@google.com&gt;
    > Signed-off-by: Ignat Korchagin &lt;ignat@cloudflare.com&gt;
    > Reviewed-by: Kuniyuki Iwashima &lt;kuniyu@amazon.com&gt;
    > Reviewed-by: Willem de Bruijn &lt;willemb@google.com&gt;
    > Reviewed-by: Eric Dumazet &lt;edumazet@google.com&gt;
    > Link: https://patch.msgid.link/20241014153808.51894-2-ignat@cloudflare.com
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ net/sched: cbs: Fix integer overflow in cbs_set_port_rate() (@Elena Salomatkina in [ef18243f8ecb259](https://github.com/sophgo/linux-riscv/commit/ef18243f8ecb259) at 2024-12-14 19:03:47)
    > [ Upstream commit 397006ba5d918f9b74e734867e8fddbc36dc2282 ]
    > The subsequent calculation of port_rate &#x3D; speed * 1000 * BYTES_PER_KBIT,
    > where the BYTES_PER_KBIT is of type LL, may cause an overflow.
    > At least when speed &#x3D; SPEED_20000, the expression to the left of port_rate
    > will be greater than INT_MAX.
    > Found by Linux Verification Center (linuxtesting.org) with SVACE.
    > Signed-off-by: Elena Salomatkina &lt;esalomatkina@ispras.ru&gt;
    > Link: https://patch.msgid.link/20241013124529.1043-1-esalomatkina@ispras.ru
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ net: af_can: do not leave a dangling sk pointer in can_create() (@Ignat Korchagin in [8df832e6b945e1b](https://github.com/sophgo/linux-riscv/commit/8df832e6b945e1b) at 2024-12-14 19:03:47)
    > [ Upstream commit 811a7ca7320c062e15d0f5b171fe6ad8592d1434 ]
    > On error can_create() frees the allocated sk object, but sock_init_data()
    > has already attached it to the provided sock object. This will leave a
    > dangling sk pointer in the sock object and may cause use-after-free later.
    > Signed-off-by: Ignat Korchagin &lt;ignat@cloudflare.com&gt;
    > Reviewed-by: Vincent Mailhol &lt;mailhol.vincent@wanadoo.fr&gt;
    > Reviewed-by: Kuniyuki Iwashima &lt;kuniyu@amazon.com&gt;
    > Reviewed-by: Marc Kleine-Budde &lt;mkl@pengutronix.de&gt;
    > Link: https://patch.msgid.link/20241014153808.51894-5-ignat@cloudflare.com
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ net: inet: do not leave a dangling sk pointer in inet_create() (@Ignat Korchagin in [691d6d816f93b2a](https://github.com/sophgo/linux-riscv/commit/691d6d816f93b2a) at 2024-12-14 19:03:47)
    > [ Upstream commit 9365fa510c6f82e3aa550a09d0c5c6b44dbc78ff ]
    > sock_init_data() attaches the allocated sk object to the provided sock
    > object. If inet_create() fails later, the sk object is freed, but the
    > sock object retains the dangling pointer, which may create use-after-free
    > later.
    > Clear the sk pointer in the sock object on error.
    > Signed-off-by: Ignat Korchagin &lt;ignat@cloudflare.com&gt;
    > Reviewed-by: Kuniyuki Iwashima &lt;kuniyu@amazon.com&gt;
    > Reviewed-by: Eric Dumazet &lt;edumazet@google.com&gt;
    > Link: https://patch.msgid.link/20241014153808.51894-7-ignat@cloudflare.com
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ Bluetooth: L2CAP: do not leave dangling sk pointer on error in l2cap_sock_create() (@Ignat Korchagin in [61686abc2f3c2c6](https://github.com/sophgo/linux-riscv/commit/61686abc2f3c2c6) at 2024-12-14 19:03:47)
    > [ Upstream commit 7c4f78cdb8e7501e9f92d291a7d956591bf73be9 ]
    > bt_sock_alloc() allocates the sk object and attaches it to the provided
    > sock object. On error l2cap_sock_alloc() frees the sk object, but the
    > dangling pointer is still attached to the sock object, which may create
    > use-after-free in other code.
    > Signed-off-by: Ignat Korchagin &lt;ignat@cloudflare.com&gt;
    > Reviewed-by: Kuniyuki Iwashima &lt;kuniyu@amazon.com&gt;
    > Reviewed-by: Eric Dumazet &lt;edumazet@google.com&gt;
    > Link: https://patch.msgid.link/20241014153808.51894-3-ignat@cloudflare.com
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ Bluetooth: RFCOMM: avoid leaving dangling sk pointer in rfcomm_sock_alloc() (@Ignat Korchagin in [32df687e129ef0f](https://github.com/sophgo/linux-riscv/commit/32df687e129ef0f) at 2024-12-14 19:03:47)
    > [ Upstream commit 3945c799f12b8d1f49a3b48369ca494d981ac465 ]
    > bt_sock_alloc() attaches allocated sk object to the provided sock object.
    > If rfcomm_dlc_alloc() fails, we release the sk object, but leave the
    > dangling pointer in the sock object, which may cause use-after-free.
    > Fix this by swapping calls to bt_sock_alloc() and rfcomm_dlc_alloc().
    > Signed-off-by: Ignat Korchagin &lt;ignat@cloudflare.com&gt;
    > Reviewed-by: Kuniyuki Iwashima &lt;kuniyu@amazon.com&gt;
    > Reviewed-by: Eric Dumazet &lt;edumazet@google.com&gt;
    > Link: https://patch.msgid.link/20241014153808.51894-4-ignat@cloudflare.com
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ net: ieee802154: do not leave a dangling sk pointer in ieee802154_create() (@Ignat Korchagin in [03caa9bfb9fde97](https://github.com/sophgo/linux-riscv/commit/03caa9bfb9fde97) at 2024-12-14 19:03:47)
    > [ Upstream commit b4fcd63f6ef79c73cafae8cf4a114def5fc3d80d ]
    > sock_init_data() attaches the allocated sk object to the provided sock
    > object. If ieee802154_create() fails later, the allocated sk object is
    > freed, but the dangling pointer remains in the provided sock object, which
    > may allow use-after-free.
    > Clear the sk pointer in the sock object on error.
    > Signed-off-by: Ignat Korchagin &lt;ignat@cloudflare.com&gt;
    > Reviewed-by: Miquel Raynal &lt;miquel.raynal@bootlin.com&gt;
    > Reviewed-by: Kuniyuki Iwashima &lt;kuniyu@amazon.com&gt;
    > Reviewed-by: Eric Dumazet &lt;edumazet@google.com&gt;
    > Link: https://patch.msgid.link/20241014153808.51894-6-ignat@cloudflare.com
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ net: ethernet: fs_enet: Use %pa to format resource_size_t (@Simon Horman in [ff3e39bc3cc6629](https://github.com/sophgo/linux-riscv/commit/ff3e39bc3cc6629) at 2024-12-14 19:03:46)
    > [ Upstream commit 45fe45fada261e1e83fce2a07fa22835aec1cf0a ]
    > The correct format string for resource_size_t is %pa which
    > acts on the address of the variable to be formatted [1].
    > [1] https://elixir.bootlin.com/linux/v6.11.3/source/Documentation/core-api/printk-formats.rst#L229
    > Introduced by commit 9d9326d3bc0e (&quot;phy: Change mii_bus id field to a string&quot;)
    > Flagged by gcc-14 as:
    > drivers/net/ethernet/freescale/fs_enet/mii-bitbang.c: In function &#x27;fs_mii_bitbang_init&#x27;:
    > drivers/net/ethernet/freescale/fs_enet/mii-bitbang.c:126:46: warning: format &#x27;%x&#x27; expects argument of type &#x27;unsigned int&#x27;, but argument 4 has type &#x27;resource_size_t&#x27; {aka &#x27;long long unsigned int&#x27;} [-Wformat&#x3D;]
    > 126 |         snprintf(bus-&gt;id, MII_BUS_ID_SIZE, &quot;%x&quot;, res.start);
    > |                                             ~^   ~~~~~~~~~
    > |                                              |      |
    > |                                              |      resource_size_t {aka long long unsigned int}
    > |                                              unsigned int
    > |                                             %llx
    > No functional change intended.
    > Compile tested only.
    > Reported-by: Geert Uytterhoeven &lt;geert@linux-m68k.org&gt;
    > Closes: https://lore.kernel.org/netdev/711d7f6d-b785-7560-f4dc-c6aad2cce99@linux-m68k.org/
    > Signed-off-by: Simon Horman &lt;horms@kernel.org&gt;
    > Reviewed-by: Daniel Machon &lt;daniel.machon@microchip.com&gt;
    > Link: https://patch.msgid.link/20241014-net-pa-fmt-v1-2-dcc9afb8858b@kernel.org
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ samples/bpf: Fix a resource leak (@Zhu Jun in [fbdf26dcc6d697b](https://github.com/sophgo/linux-riscv/commit/fbdf26dcc6d697b) at 2024-12-14 19:03:46)
    > [ Upstream commit f3ef53174b23246fe9bc2bbc2542f3a3856fa1e2 ]
    > The opened file should be closed in show_sockopts(), otherwise resource
    > leak will occur that this problem was discovered by reading code
    > Signed-off-by: Zhu Jun &lt;zhujun2@cmss.chinamobile.com&gt;
    > Signed-off-by: Andrii Nakryiko &lt;andrii@kernel.org&gt;
    > Link: https://lore.kernel.org/bpf/20241010014126.2573-1-zhujun2@cmss.chinamobile.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/amd/display: Full exit out of IPS2 when all allow signals have been cleared (@Leo Chen in [9e5d6a4caebe926](https://github.com/sophgo/linux-riscv/commit/9e5d6a4caebe926) at 2024-12-14 19:03:46)
    > [ Upstream commit 0fe33e115fec305c35c66b78ad26e3755ab54b9c ]
    > [Why]
    > A race condition occurs between cursor movement and vertical interrupt control
    > thread from OS, with both threads trying to exit IPS2.
    > Vertical interrupt control thread clears the prev driver allow signal while not fully
    > finishing the IPS2 exit process.
    > [How]
    > We want to detect all the allow signals have been cleared before we perform the full exit.
    > Reviewed-by: Nicholas Kazlauskas &lt;nicholas.kazlauskas@amd.com&gt;
    > Signed-off-by: Leo Chen &lt;leo.chen@amd.com&gt;
    > Signed-off-by: Roman Li &lt;roman.li@amd.com&gt;
    > Tested-by: Daniel Wheeler &lt;daniel.wheeler@amd.com&gt;
    > Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ net: fec_mpc52xx_phy: Use %pa to format resource_size_t (@Simon Horman in [821e3dc5cb4451a](https://github.com/sophgo/linux-riscv/commit/821e3dc5cb4451a) at 2024-12-14 19:03:46)
    > [ Upstream commit 020bfdc4ed94be472138c891bde4d14241cf00fd ]
    > The correct format string for resource_size_t is %pa which
    > acts on the address of the variable to be formatted [1].
    > [1] https://elixir.bootlin.com/linux/v6.11.3/source/Documentation/core-api/printk-formats.rst#L229
    > Introduced by commit 9d9326d3bc0e (&quot;phy: Change mii_bus id field to a string&quot;)
    > Flagged by gcc-14 as:
    > drivers/net/ethernet/freescale/fec_mpc52xx_phy.c: In function &#x27;mpc52xx_fec_mdio_probe&#x27;:
    > drivers/net/ethernet/freescale/fec_mpc52xx_phy.c:97:46: warning: format &#x27;%x&#x27; expects argument of type &#x27;unsigned int&#x27;, but argument 4 has type &#x27;resource_size_t&#x27; {aka &#x27;long long unsigned int&#x27;} [-Wformat&#x3D;]
    > 97 |         snprintf(bus-&gt;id, MII_BUS_ID_SIZE, &quot;%x&quot;, res.start);
    > |                                             ~^   ~~~~~~~~~
    > |                                              |      |
    > |                                              |      resource_size_t {aka long long unsigned int}
    > |                                              unsigned int
    > |                                             %llx
    > No functional change intended.
    > Compile tested only.
    > Reported-by: Geert Uytterhoeven &lt;geert@linux-m68k.org&gt;
    > Closes: https://lore.kernel.org/netdev/711d7f6d-b785-7560-f4dc-c6aad2cce99@linux-m68k.org/
    > Signed-off-by: Simon Horman &lt;horms@kernel.org&gt;
    > Reviewed-by: Daniel Machon &lt;daniel.machon@microchip.com&gt;
    > Link: https://patch.msgid.link/20241014-net-pa-fmt-v1-1-dcc9afb8858b@kernel.org
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ accel/qaic: Add AIC080 support (@Jeffrey Hugo in [3151d7859f93836](https://github.com/sophgo/linux-riscv/commit/3151d7859f93836) at 2024-12-14 19:03:46)
    > [ Upstream commit b8128f7815ff135f0333c1b46dcdf1543c41b860 ]
    > Add basic support for the new AIC080 product. The PCIe Device ID is
    > 0xa080. AIC080 is a lower cost, lower performance SKU variant of AIC100.
    > From the qaic perspective, it is the same as AIC100.
    > Reviewed-by: Troy Hanson &lt;quic_thanson@quicinc.com&gt;
    > Signed-off-by: Jeffrey Hugo &lt;quic_jhugo@quicinc.com&gt;
    > Reviewed-by: Jacek Lawrynowicz &lt;jacek.lawrynowicz@linux.intel.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20241004195209.3910996-1-quic_jhugo@quicinc.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ wifi: ath12k: fix atomic calls in ath12k_mac_op_set_bitrate_mask() (@Kalle Valo in [2093f062b268057](https://github.com/sophgo/linux-riscv/commit/2093f062b268057) at 2024-12-14 19:03:46)
    > [ Upstream commit 8fac3266c68a8e647240b8ac8d0b82f1821edf85 ]
    > When I try to manually set bitrates:
    > iw wlan0 set bitrates legacy-2.4 1
    > I get sleeping from invalid context error, see below. Fix that by switching to
    > use recently introduced ieee80211_iterate_stations_mtx().
    > Do note that WCN6855 firmware is still crashing, I&#x27;m not sure if that firmware
    > even supports bitrate WMI commands and should we consider disabling
    > ath12k_mac_op_set_bitrate_mask() for WCN6855? But that&#x27;s for another patch.
    > BUG: sleeping function called from invalid context at drivers/net/wireless/ath/ath12k/wmi.c:420
    > in_atomic(): 0, irqs_disabled(): 0, non_block: 0, pid: 2236, name: iw
    > preempt_count: 0, expected: 0
    > RCU nest depth: 1, expected: 0
    > 3 locks held by iw/2236:
    > #0: ffffffffabc6f1d8 (cb_lock){++++}-{3:3}, at: genl_rcv+0x14/0x40
    > #1: ffff888138410810 (&amp;rdev-&gt;wiphy.mtx){+.+.}-{3:3}, at: nl80211_pre_doit+0x54d/0x800 [cfg80211]
    > #2: ffffffffab2cfaa0 (rcu_read_lock){....}-{1:2}, at: ieee80211_iterate_stations_atomic+0x2f/0x200 [mac80211]
    > CPU: 3 UID: 0 PID: 2236 Comm: iw Not tainted 6.11.0-rc7-wt-ath+ #1772
    > Hardware name: Intel(R) Client Systems NUC8i7HVK/NUC8i7HVB, BIOS HNKBLi70.86A.0067.2021.0528.1339 05/28/2021
    > Call Trace:
    > &lt;TASK&gt;
    > dump_stack_lvl+0xa4/0xe0
    > dump_stack+0x10/0x20
    > __might_resched+0x363/0x5a0
    > ? __alloc_skb+0x165/0x340
    > __might_sleep+0xad/0x160
    > ath12k_wmi_cmd_send+0xb1/0x3d0 [ath12k]
    > ? ath12k_wmi_init_wcn7850+0xa40/0xa40 [ath12k]
    > ? __netdev_alloc_skb+0x45/0x7b0
    > ? __asan_memset+0x39/0x40
    > ? ath12k_wmi_alloc_skb+0xf0/0x150 [ath12k]
    > ? reacquire_held_locks+0x4d0/0x4d0
    > ath12k_wmi_set_peer_param+0x340/0x5b0 [ath12k]
    > ath12k_mac_disable_peer_fixed_rate+0xa3/0x110 [ath12k]
    > ? ath12k_mac_vdev_stop+0x4f0/0x4f0 [ath12k]
    > ieee80211_iterate_stations_atomic+0xd4/0x200 [mac80211]
    > ath12k_mac_op_set_bitrate_mask+0x5d2/0x1080 [ath12k]
    > ? ath12k_mac_vif_chan+0x320/0x320 [ath12k]
    > drv_set_bitrate_mask+0x267/0x470 [mac80211]
    > ieee80211_set_bitrate_mask+0x4cc/0x8a0 [mac80211]
    > ? __this_cpu_preempt_check+0x13/0x20
    > nl80211_set_tx_bitrate_mask+0x2bc/0x530 [cfg80211]
    > ? nl80211_parse_tx_bitrate_mask+0x2320/0x2320 [cfg80211]
    > ? trace_contention_end+0xef/0x140
    > ? rtnl_unlock+0x9/0x10
    > ? nl80211_pre_doit+0x557/0x800 [cfg80211]
    > genl_family_rcv_msg_doit+0x1f0/0x2e0
    > ? genl_family_rcv_msg_attrs_parse.isra.0+0x250/0x250
    > ? ns_capable+0x57/0xd0
    > genl_family_rcv_msg+0x34c/0x600
    > ? genl_family_rcv_msg_dumpit+0x310/0x310
    > ? __lock_acquire+0xc62/0x1de0
    > ? he_set_mcs_mask.isra.0+0x8d0/0x8d0 [cfg80211]
    > ? nl80211_parse_tx_bitrate_mask+0x2320/0x2320 [cfg80211]
    > ? cfg80211_external_auth_request+0x690/0x690 [cfg80211]
    > genl_rcv_msg+0xa0/0x130
    > netlink_rcv_skb+0x14c/0x400
    > ? genl_family_rcv_msg+0x600/0x600
    > ? netlink_ack+0xd70/0xd70
    > ? rwsem_optimistic_spin+0x4f0/0x4f0
    > ? genl_rcv+0x14/0x40
    > ? down_read_killable+0x580/0x580
    > ? netlink_deliver_tap+0x13e/0x350
    > ? __this_cpu_preempt_check+0x13/0x20
    > genl_rcv+0x23/0x40
    > netlink_unicast+0x45e/0x790
    > ? netlink_attachskb+0x7f0/0x7f0
    > netlink_sendmsg+0x7eb/0xdb0
    > ? netlink_unicast+0x790/0x790
    > ? __this_cpu_preempt_check+0x13/0x20
    > ? selinux_socket_sendmsg+0x31/0x40
    > ? netlink_unicast+0x790/0x790
    > __sock_sendmsg+0xc9/0x160
    > ____sys_sendmsg+0x620/0x990
    > ? kernel_sendmsg+0x30/0x30
    > ? __copy_msghdr+0x410/0x410
    > ? __kasan_check_read+0x11/0x20
    > ? mark_lock+0xe6/0x1470
    > ___sys_sendmsg+0xe9/0x170
    > ? copy_msghdr_from_user+0x120/0x120
    > ? __lock_acquire+0xc62/0x1de0
    > ? do_fault_around+0x2c6/0x4e0
    > ? do_user_addr_fault+0x8c1/0xde0
    > ? reacquire_held_locks+0x220/0x4d0
    > ? do_user_addr_fault+0x8c1/0xde0
    > ? __kasan_check_read+0x11/0x20
    > ? __fdget+0x4e/0x1d0
    > ? sockfd_lookup_light+0x1a/0x170
    > __sys_sendmsg+0xd2/0x180
    > ? __sys_sendmsg_sock+0x20/0x20
    > ? reacquire_held_locks+0x4d0/0x4d0
    > ? debug_smp_processor_id+0x17/0x20
    > __x64_sys_sendmsg+0x72/0xb0
    > ? lockdep_hardirqs_on+0x7d/0x100
    > x64_sys_call+0x894/0x9f0
    > do_syscall_64+0x64/0x130
    > entry_SYSCALL_64_after_hwframe+0x4b/0x53
    > RIP: 0033:0x7f230fe04807
    > Code: 64 89 02 48 c7 c0 ff ff ff ff eb bb 0f 1f 80 00 00 00 00 f3 0f 1e fa 64 8b 04 25 18 00 00 00 85 c0 75 10 b8 2e 00 00 00 0f 05 &lt;48&gt; 3d 00 f0 ff ff 77 51 c3 48 83 ec 28 89 54 24 1c 48 89 74 24 10
    > RSP: 002b:00007ffe996a7ea8 EFLAGS: 00000246 ORIG_RAX: 000000000000002e
    > RAX: ffffffffffffffda RBX: 0000556f9f9c3390 RCX: 00007f230fe04807
    > RDX: 0000000000000000 RSI: 00007ffe996a7ee0 RDI: 0000000000000003
    > RBP: 0000556f9f9c88c0 R08: 0000000000000002 R09: 0000000000000000
    > R10: 0000556f965ca190 R11: 0000000000000246 R12: 0000556f9f9c8780
    > R13: 00007ffe996a7ee0 R14: 0000556f9f9c87d0 R15: 0000556f9f9c88c0
    > &lt;/TASK&gt;
    > Tested-on: WCN7850 hw2.0 PCI WLAN.HMT.1.0.c5-00481-QCAHMTSWPL_V1.0_V2.0_SILICONZ-3
    > Signed-off-by: Kalle Valo &lt;quic_kvalo@quicinc.com&gt;
    > Link: https://patch.msgid.link/20241007165932.78081-2-kvalo@kernel.org
    > Signed-off-by: Jeff Johnson &lt;quic_jjohnson@quicinc.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ALSA: hda/realtek: Use codec SSID matching for Lenovo devices (@Takashi Iwai in [c76d0ebea9b4b48](https://github.com/sophgo/linux-riscv/commit/c76d0ebea9b4b48) at 2024-12-14 19:03:45)
    > [ Upstream commit 504f052aa3435ab2f15af8b20bc4f4de8ff259c7 ]
    > Now we can perform the codec ID matching primarily, and reduce the
    > conditional application of the quirk for conflicting PCI SSIDs in
    > various Lenovo devices.
    > Here, HDA_CODEC_QUIRK() is applied at first so that the device with
    > the codec SSID matching is picked up, followed by SND_PCI_QUIRK() for
    > PCI SSID matching with the same ID number.
    > Signed-off-by: Takashi Iwai &lt;tiwai@suse.de&gt;
    > Link: https://patch.msgid.link/20241008120233.7154-4-tiwai@suse.de
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ r8169: don&#x27;t apply UDP padding quirk on RTL8126A (@Heiner Kallweit in [8945c33b0500a45](https://github.com/sophgo/linux-riscv/commit/8945c33b0500a45) at 2024-12-14 19:03:45)
    > [ Upstream commit 87e26448dbda4523b73a894d96f0f788506d3795 ]
    > Vendor drivers r8125/r8126 indicate that this quirk isn&#x27;t needed
    > any longer for RTL8126A. Mimic this in r8169.
    > Signed-off-by: Heiner Kallweit &lt;hkallweit1@gmail.com&gt;
    > Reviewed-by: Simon Horman &lt;horms@kernel.org&gt;
    > Link: https://patch.msgid.link/d1317187-aa81-4a69-b831-678436e4de62@gmail.com
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ALSA: hda/conexant: Use the new codec SSID matching (@Takashi Iwai in [753693b1ba0a9f1](https://github.com/sophgo/linux-riscv/commit/753693b1ba0a9f1) at 2024-12-14 19:03:45)
    > [ Upstream commit 1f55e3699fc9ced72400cdca39fe248bf2b288a2 ]
    > Now we can perform the codec ID matching primarily, and reduce the
    > conditional application of the quirk for conflicting PCI SSID between
    > System76 and Tuxedo devices.
    > Signed-off-by: Takashi Iwai &lt;tiwai@suse.de&gt;
    > Link: https://patch.msgid.link/20241008120233.7154-3-tiwai@suse.de
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/display: Fix building with GCC 15 (@Brahmajit Das in [07a4acea17f53f5](https://github.com/sophgo/linux-riscv/commit/07a4acea17f53f5) at 2024-12-14 19:03:45)
    > [ Upstream commit a500f3751d3c861be7e4463c933cf467240cca5d ]
    > GCC 15 enables -Werror&#x3D;unterminated-string-initialization by default.
    > This results in the following build error
    > drivers/gpu/drm/display/drm_dp_dual_mode_helper.c: In function ‘is_hdmi_adaptor’:
    > drivers/gpu/drm/display/drm_dp_dual_mode_helper.c:164:17: error: initializer-string for array of
    > ‘char’ is too long [-Werror&#x3D;unterminated-string-initialization]
    > 164 |                 &quot;DP-HDMI ADAPTOR\x04&quot;;
    > |                 ^~~~~~~~~~~~~~~~~~~~~
    > After discussion with Ville, the fix was to increase the size of
    > dp_dual_mode_hdmi_id array by one, so that it can accommodate the NULL
    > line character. This should let us build the kernel with GCC 15.
    > Signed-off-by: Brahmajit Das &lt;brahmajit.xyz@gmail.com&gt;
    > Reviewed-by: Jani Nikula &lt;jani.nikula@intel.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20241002092311.942822-1-brahmajit.xyz@gmail.com
    > Signed-off-by: Jani Nikula &lt;jani.nikula@intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ALSA: hda: Use own quirk lookup helper (@Takashi Iwai in [074b2b0a4d52c92](https://github.com/sophgo/linux-riscv/commit/074b2b0a4d52c92) at 2024-12-14 19:03:45)
    > [ Upstream commit 5b1913a79c3e0518d9c5db343fa9fc4edcea041f ]
    > For allowing the primary codec SSID matching (that works around the
    > conflicting PCI SSID problems), introduce a new struct hda_quirk,
    > which is compatible with the existing struct snd_pci_quirk along with
    > new helper functions and macros.
    > The existing snd_pci_quirk tables are replaced with hda_quirk tables
    > accordingly, while keeping SND_PCI_QUIRK() entry definitions as is.
    > This patch shouldn&#x27;t bring any behavior change, just some renaming and
    > shifting the code.  The actual change for the codec SSID matching will
    > follow after this.
    > Signed-off-by: Takashi Iwai &lt;tiwai@suse.de&gt;
    > Link: https://patch.msgid.link/20241008120233.7154-2-tiwai@suse.de
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/xe/xe3: Add initial set of workarounds (@Gustavo Sousa in [ee6219b9d0d2c05](https://github.com/sophgo/linux-riscv/commit/ee6219b9d0d2c05) at 2024-12-14 19:03:44)
    > [ Upstream commit 081cb8948cfe322076cd23f22f85ba68f73e2c4b ]
    > Implement the initial set of workarounds for Xe3 IPs.
    > Signed-off-by: Gustavo Sousa &lt;gustavo.sousa@intel.com&gt;
    > Signed-off-by: Matt Atwood &lt;matthew.s.atwood@intel.com&gt;
    > Reviewed-by: Matt Roper &lt;matthew.d.roper@intel.com&gt;
    > Signed-off-by: Matt Roper &lt;matthew.d.roper@intel.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20241008204626.55802-2-matthew.s.atwood@intel.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/amd/display: Fix garbage or black screen when resetting otg (@Zhongwei in [b33f6e83921f1a7](https://github.com/sophgo/linux-riscv/commit/b33f6e83921f1a7) at 2024-12-14 19:03:44)
    > [ Upstream commit ffa1e31f70d2e97c121709b44a8960f5d7becb10 ]
    > [Why]
    > For some EDP to MIPI panel, disabling OTG when link is alive like boot
    > case, the converter might output garbage or show no display because our
    > GPU is not sending required pixel data.
    > Alos Dig fifo underflow was found which might cause garbage, when
    > resetting otg for other types of EDP panels.
    > [How]
    > Skipping resetting OTG if the dig fifo is on. Make sure that the otg for
    > the pipe is the one that the dig fifo is selecting via the FE mask.
    > Reviewed-by: Nicholas Kazlauskas &lt;nicholas.kazlauskas@amd.com&gt;
    > Signed-off-by: Zhongwei &lt;Zhongwei.Zhang@amd.com&gt;
    > Signed-off-by: Rodrigo Siqueira &lt;rodrigo.siqueira@amd.com&gt;
    > Tested-by: Daniel Wheeler &lt;daniel.wheeler@amd.com&gt;
    > Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/amd/display: skip disable CRTC in seemless bootup case (@Fudongwang in [9921e7879be9fef](https://github.com/sophgo/linux-riscv/commit/9921e7879be9fef) at 2024-12-14 19:03:44)
    > [ Upstream commit 0e37e4b9afbd08df1f00a70bbb4d1ec273d18c9e ]
    > Resync FIFO is a workaround to write the same value to
    > DENTIST_DISPCLK_CNTL register after programming OTG_PIXEL_RATE_DIV
    > register, in case seemless boot, there is no OTG_PIXEL_RATE_DIV register
    > update, so skip CRTC disable when resync FIFO to avoid random FIFO error
    > and garbage.
    > Reviewed-by: Nicholas Kazlauskas &lt;nicholas.kazlauskas@amd.com&gt;
    > Signed-off-by: Fudongwang &lt;Fudong.Wang@amd.com&gt;
    > Signed-off-by: Rodrigo Siqueira &lt;rodrigo.siqueira@amd.com&gt;
    > Tested-by: Daniel Wheeler &lt;daniel.wheeler@amd.com&gt;
    > Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/amd/display: disable SG displays on cyan skillfish (@Alex Deucher in [61fda5faad77df5](https://github.com/sophgo/linux-riscv/commit/61fda5faad77df5) at 2024-12-14 19:03:44)
    > [ Upstream commit 66369db7fdd7d58d78673bf83d2b87ea623efb63 ]
    > These parts were mainly for compute workloads, but they have
    > a display that was available for the console.  These chips
    > should support SG display, but I don&#x27;t know that the support
    > was ever validated on Linux so disable it by default. It can
    > still be enabled by setting sg_display&#x3D;1 for those that
    > want to play with it.  These systems also generally had large
    > carve outs so SG display was less of a factor.
    > Closes: https://gitlab.freedesktop.org/drm/amd/-/issues/3356
    > Reviewed-by: Harry Wentland &lt;harry.wentland@amd.com&gt;
    > Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/xe/ptl: L3bank mask is not available on the media GT (@Shekhar Chauhan in [43a859bd40ce347](https://github.com/sophgo/linux-riscv/commit/43a859bd40ce347) at 2024-12-14 19:03:44)
    > [ Upstream commit 9ab440a9d0426cf7842240891cc457155db1a97e ]
    > On PTL platforms with media version 30.00, the fuse registers for
    > reporting L3 bank availability to the GT just read out as ~0 and do not
    > provide proper values.  Xe does not use the L3 bank mask for anything
    > internally; it only passes the mask through to userspace via the GT
    > topology query.
    > Since we don&#x27;t have any way to get the real L3 bank mask, we don&#x27;t want
    > to pass garbage to userspace.  Passing a zeroed mask or a copy of the
    > primary GT&#x27;s L3 bank mask would also be inaccurate and likely to cause
    > confusion for userspace.  The best approach is to simply not include L3
    > in the list of masks returned by the topology query in cases where we
    > aren&#x27;t able to provide a meaningful value.  This won&#x27;t change the
    > behavior for any existing platforms (where we can always obtain L3 masks
    > successfully for all GTs), it will only prevent us from mis-reporting
    > bad information on upcoming platform(s).
    > There&#x27;s a good chance this will become a formal workaround in the
    > future, but for now we don&#x27;t have a lineage number so &quot;no_media_l3&quot; is
    > used in place of a lineage as the OOB workaround descriptor.
    > v2:
    > - Re-calculate query size to properly match data returned. (Gustavo)
    > - Update kerneldoc to clarify that the L3bank mask may not be included
    > in the query results if the hardware doesn&#x27;t make it available.
    > (Gustavo)
    > Cc: Matt Atwood &lt;matthew.s.atwood@intel.com&gt;
    > Cc: Gustavo Sousa &lt;gustavo.sousa@intel.com&gt;
    > Signed-off-by: Shekhar Chauhan &lt;shekhar.chauhan@intel.com&gt;
    > Co-developed-by: Matt Roper &lt;matthew.d.roper@intel.com&gt;
    > Signed-off-by: Matt Roper &lt;matthew.d.roper@intel.com&gt;
    > Reviewed-by: Jonathan Cavitt &lt;jonathan.cavitt@intel.com&gt;
    > Reviewed-by: Gustavo Sousa &lt;gustavo.sousa@intel.com&gt;
    > Acked-by: Francois Dugast &lt;francois.dugast@intel.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20241007154143.2021124-2-matthew.d.roper@intel.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ dlm: fix possible lkb_resource null dereference (@Alexander Aring in [2db11504ef82a60](https://github.com/sophgo/linux-riscv/commit/2db11504ef82a60) at 2024-12-14 19:03:44)
    > [ Upstream commit b98333c67daf887c724cd692e88e2db9418c0861 ]
    > This patch fixes a possible null pointer dereference when this function is
    > called from request_lock() as lkb-&gt;lkb_resource is not assigned yet,
    > only after validate_lock_args() by calling attach_lkb(). Another issue
    > is that a resource name could be a non printable bytearray and we cannot
    > assume to be ASCII coded.
    > The log functionality is probably never being hit when DLM is used in
    > normal way and no debug logging is enabled. The null pointer dereference
    > can only occur on a new created lkb that does not have the resource
    > assigned yet, it probably never hits the null pointer dereference but we
    > should be sure that other changes might not change this behaviour and we
    > actually can hit the mentioned null pointer dereference.
    > In this patch we just drop the printout of the resource name, the lkb id
    > is enough to make a possible connection to a resource name if this
    > exists.
    > Signed-off-by: Alexander Aring &lt;aahringo@redhat.com&gt;
    > Signed-off-by: David Teigland &lt;teigland@redhat.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/mcde: Enable module autoloading (@Liao Chen in [f2a107b536494c7](https://github.com/sophgo/linux-riscv/commit/f2a107b536494c7) at 2024-12-14 19:03:43)
    > [ Upstream commit 8a16b5cdae26207ff4c22834559384ad3d7bc970 ]
    > Add MODULE_DEVICE_TABLE(), so modules could be properly autoloaded based
    > on the alias from of_device_id table.
    > Signed-off-by: Liao Chen &lt;liaochen4@huawei.com&gt;
    > Reviewed-by: Linus Walleij &lt;linus.walleij@linaro.org&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20240902113320.903147-4-liaochen4@huawei.com
    > Signed-off-by: Dmitry Baryshkov &lt;dmitry.baryshkov@linaro.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/amd/display: Fix out-of-bounds access in &#x27;dcn21_link_encoder_create&#x27; (@Srinivasan Shanmugam in [f01ddd589e16297](https://github.com/sophgo/linux-riscv/commit/f01ddd589e16297) at 2024-12-14 19:03:43)
    > [ Upstream commit 63de35a8fcfca59ae8750d469a7eb220c7557baf ]
    > An issue was identified in the dcn21_link_encoder_create function where
    > an out-of-bounds access could occur when the hpd_source index was used
    > to reference the link_enc_hpd_regs array. This array has a fixed size
    > and the index was not being checked against the array&#x27;s bounds before
    > accessing it.
    > This fix adds a conditional check to ensure that the hpd_source index is
    > within the valid range of the link_enc_hpd_regs array. If the index is
    > out of bounds, the function now returns NULL to prevent undefined
    > behavior.
    > References:
    > [   65.920507] ------------[ cut here ]------------
    > [   65.920510] UBSAN: array-index-out-of-bounds in drivers/gpu/drm/amd/amdgpu/../display/dc/resource/dcn21/dcn21_resource.c:1312:29
    > [   65.920519] index 7 is out of range for type &#x27;dcn10_link_enc_hpd_registers [5]&#x27;
    > [   65.920523] CPU: 3 PID: 1178 Comm: modprobe Tainted: G           OE      6.8.0-cleanershaderfeatureresetasdntipmi200nv2132 #13
    > [   65.920525] Hardware name: AMD Majolica-RN/Majolica-RN, BIOS WMJ0429N_Weekly_20_04_2 04/29/2020
    > [   65.920527] Call Trace:
    > [   65.920529]  &lt;TASK&gt;
    > [   65.920532]  dump_stack_lvl+0x48/0x70
    > [   65.920541]  dump_stack+0x10/0x20
    > [   65.920543]  __ubsan_handle_out_of_bounds+0xa2/0xe0
    > [   65.920549]  dcn21_link_encoder_create+0xd9/0x140 [amdgpu]
    > [   65.921009]  link_create+0x6d3/0xed0 [amdgpu]
    > [   65.921355]  create_links+0x18a/0x4e0 [amdgpu]
    > [   65.921679]  dc_create+0x360/0x720 [amdgpu]
    > [   65.921999]  ? dmi_matches+0xa0/0x220
    > [   65.922004]  amdgpu_dm_init+0x2b6/0x2c90 [amdgpu]
    > [   65.922342]  ? console_unlock+0x77/0x120
    > [   65.922348]  ? dev_printk_emit+0x86/0xb0
    > [   65.922354]  dm_hw_init+0x15/0x40 [amdgpu]
    > [   65.922686]  amdgpu_device_init+0x26a8/0x33a0 [amdgpu]
    > [   65.922921]  amdgpu_driver_load_kms+0x1b/0xa0 [amdgpu]
    > [   65.923087]  amdgpu_pci_probe+0x1b7/0x630 [amdgpu]
    > [   65.923087]  local_pci_probe+0x4b/0xb0
    > [   65.923087]  pci_device_probe+0xc8/0x280
    > [   65.923087]  really_probe+0x187/0x300
    > [   65.923087]  __driver_probe_device+0x85/0x130
    > [   65.923087]  driver_probe_device+0x24/0x110
    > [   65.923087]  __driver_attach+0xac/0x1d0
    > [   65.923087]  ? __pfx___driver_attach+0x10/0x10
    > [   65.923087]  bus_for_each_dev+0x7d/0xd0
    > [   65.923087]  driver_attach+0x1e/0x30
    > [   65.923087]  bus_add_driver+0xf2/0x200
    > [   65.923087]  driver_register+0x64/0x130
    > [   65.923087]  ? __pfx_amdgpu_init+0x10/0x10 [amdgpu]
    > [   65.923087]  __pci_register_driver+0x61/0x70
    > [   65.923087]  amdgpu_init+0x7d/0xff0 [amdgpu]
    > [   65.923087]  do_one_initcall+0x49/0x310
    > [   65.923087]  ? kmalloc_trace+0x136/0x360
    > [   65.923087]  do_init_module+0x6a/0x270
    > [   65.923087]  load_module+0x1fce/0x23a0
    > [   65.923087]  init_module_from_file+0x9c/0xe0
    > [   65.923087]  ? init_module_from_file+0x9c/0xe0
    > [   65.923087]  idempotent_init_module+0x179/0x230
    > [   65.923087]  __x64_sys_finit_module+0x5d/0xa0
    > [   65.923087]  do_syscall_64+0x76/0x120
    > [   65.923087]  entry_SYSCALL_64_after_hwframe+0x6e/0x76
    > [   65.923087] RIP: 0033:0x7f2d80f1e88d
    > [   65.923087] Code: 5b 41 5c c3 66 0f 1f 84 00 00 00 00 00 f3 0f 1e fa 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 &lt;48&gt; 3d 01 f0 ff ff 73 01 c3 48 8b 0d 73 b5 0f 00 f7 d8 64 89 01 48
    > [   65.923087] RSP: 002b:00007ffc7bc1aa78 EFLAGS: 00000246 ORIG_RAX: 0000000000000139
    > [   65.923087] RAX: ffffffffffffffda RBX: 0000564c9c1db130 RCX: 00007f2d80f1e88d
    > [   65.923087] RDX: 0000000000000000 RSI: 0000564c9c1e5480 RDI: 000000000000000f
    > [   65.923087] RBP: 0000000000040000 R08: 0000000000000000 R09: 0000000000000002
    > [   65.923087] R10: 000000000000000f R11: 0000000000000246 R12: 0000564c9c1e5480
    > [   65.923087] R13: 0000564c9c1db260 R14: 0000000000000000 R15: 0000564c9c1e54b0
    > [   65.923087]  &lt;/TASK&gt;
    > [   65.923927] ---[ end trace ]---
    > Cc: Tom Chung &lt;chiahsuan.chung@amd.com&gt;
    > Cc: Rodrigo Siqueira &lt;Rodrigo.Siqueira@amd.com&gt;
    > Cc: Roman Li &lt;roman.li@amd.com&gt;
    > Cc: Alex Hung &lt;alex.hung@amd.com&gt;
    > Cc: Aurabindo Pillai &lt;aurabindo.pillai@amd.com&gt;
    > Cc: Harry Wentland &lt;harry.wentland@amd.com&gt;
    > Cc: Hamza Mahfooz &lt;hamza.mahfooz@amd.com&gt;
    > Signed-off-by: Srinivasan Shanmugam &lt;srinivasan.shanmugam@amd.com&gt;
    > Reviewed-by: Roman Li &lt;roman.li@amd.com&gt;
    > Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/bridge: it6505: Enable module autoloading (@Liao Chen in [86f5f19d670f99d](https://github.com/sophgo/linux-riscv/commit/86f5f19d670f99d) at 2024-12-14 19:03:43)
    > [ Upstream commit 1e2ab24cd708b1c864ff983ee1504c0a409d2f8e ]
    > Add MODULE_DEVICE_TABLE(), so modules could be properly autoloaded based
    > on the alias from of_device_id table.
    > Signed-off-by: Liao Chen &lt;liaochen4@huawei.com&gt;
    > Reviewed-by: Neil Armstrong &lt;neil.armstrong@linaro.org&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20240902113320.903147-2-liaochen4@huawei.com
    > Signed-off-by: Dmitry Baryshkov &lt;dmitry.baryshkov@linaro.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ wifi: rtw89: check return value of ieee80211_probereq_get() for RNR (@Ping-Ke Shih in [7296e5611adb2c6](https://github.com/sophgo/linux-riscv/commit/7296e5611adb2c6) at 2024-12-14 19:03:43)
    > [ Upstream commit 630d5d8f2bf6b340202b6bc2c05d794bbd8e4c1c ]
    > The return value of ieee80211_probereq_get() might be NULL, so check it
    > before using to avoid NULL pointer access.
    > Addresses-Coverity-ID: 1529805 (&quot;Dereference null return value&quot;)
    > Signed-off-by: Ping-Ke Shih &lt;pkshih@realtek.com&gt;
    > Link: https://patch.msgid.link/20240919081216.28505-2-pkshih@realtek.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ASoC: Intel: sof_rt5682: Add HDMI-In capture with rt5682 support for MTL. (@Balamurugan C in [0becac5c4e1025b](https://github.com/sophgo/linux-riscv/commit/0becac5c4e1025b) at 2024-12-14 19:03:43)
    > [ Upstream commit 0f5d2228a99a4733b2a6652e16255be9caf2616a ]
    > Added match table entry on mtl machines to support HDMI-In capture
    > with rt5682 I2S audio codec. also added the respective quirk
    > configuration in rt5682 machine driver.
    > Signed-off-by: Balamurugan C &lt;balamurugan.c@intel.com&gt;
    > Reviewed-by: Pierre-Louis Bossart &lt;pierre-louis.bossart@linux.intel.com&gt;
    > Reviewed-by: Péter Ujfalusi &lt;peter.ujfalusi@linux.intel.com&gt;
    > Signed-off-by: Bard Liao &lt;yung-chuan.liao@linux.intel.com&gt;
    > Link: https://patch.msgid.link/20241004030135.67968-2-yung-chuan.liao@linux.intel.com
    > Signed-off-by: Mark Brown &lt;broonie@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/radeon/r600_cs: Fix possible int overflow in r600_packet3_check() (@Igor Artemiev in [015027aa6382ef6](https://github.com/sophgo/linux-riscv/commit/015027aa6382ef6) at 2024-12-14 19:03:43)
    > [ Upstream commit a1e2da6a5072f8abe5b0feaa91a5bcd9dc544a04 ]
    > It is possible, although unlikely, that an integer overflow will occur
    > when the result of radeon_get_ib_value() is shifted to the left.
    > Avoid it by casting one of the operands to larger data type (u64).
    > Found by Linux Verification Center (linuxtesting.org) with static
    > analysis tool SVACE.
    > Signed-off-by: Igor Artemiev &lt;Igor.A.Artemiev@mcst.ru&gt;
    > Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/xe/pciids: Add PVC&#x27;s PCI device ID macros (@Rodrigo Vivi in [ef3da232796a139](https://github.com/sophgo/linux-riscv/commit/ef3da232796a139) at 2024-12-14 19:03:42)
    > [ Upstream commit 5b40191152282e1f25d7b9826bcda41be927b39f ]
    > Add PVC PCI IDs to the xe_pciids.h header. They&#x27;re not yet used in the
    > driver.
    > Cc: Daniele Ceraolo Spurio &lt;daniele.ceraolospurio@intel.com&gt;
    > Cc: Lucas De Marchi &lt;lucas.demarchi@intel.com&gt;
    > Cc: Thomas Hellström &lt;thomas.hellstrom@linux.intel.com&gt;
    > Reviewed-by: Lucas De Marchi &lt;lucas.demarchi@intel.com&gt;
    > Acked-by: Simona Vetter &lt;simona.vetter@ffwll.ch&gt;
    > Signed-off-by: Rodrigo Vivi &lt;rodrigo.vivi@intel.com&gt;
    > Signed-off-by: Jani Nikula &lt;jani.nikula@intel.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/6ac1829493a53a3fec889c746648d627a0296892.1725624296.git.jani.nikula@intel.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/vc4: hvs: Set AXI panic modes for the HVS (@Dave Stevenson in [a06ef71dec3e493](https://github.com/sophgo/linux-riscv/commit/a06ef71dec3e493) at 2024-12-14 19:03:42)
    > [ Upstream commit 014eccc9da7bfc76a3107fceea37dd60f1d63630 ]
    > The HVS can change AXI request mode based on how full the COB
    > FIFOs are.
    > Until now the vc4 driver has been relying on the firmware to
    > have set these to sensible values.
    > With HVS channel 2 now being used for live video, change the
    > panic mode for all channels to be explicitly set by the driver,
    > and the same for all channels.
    > Reviewed-by: Maxime Ripard &lt;mripard@kernel.org&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20240621152055.4180873-7-dave.stevenson@raspberrypi.com
    > Signed-off-by: Dave Stevenson &lt;dave.stevenson@raspberrypi.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ wifi: rtw88: use ieee80211_purge_tx_queue() to purge TX skb (@Ping-Ke Shih in [9bca6528f20325d](https://github.com/sophgo/linux-riscv/commit/9bca6528f20325d) at 2024-12-14 19:03:42)
    > [ Upstream commit 3e5e4a801aaf4283390cc34959c6c48f910ca5ea ]
    > When removing kernel modules by:
    > rmmod rtw88_8723cs rtw88_8703b rtw88_8723x rtw88_sdio rtw88_core
    > Driver uses skb_queue_purge() to purge TX skb, but not report tx status
    > causing &quot;Have pending ack frames!&quot; warning. Use ieee80211_purge_tx_queue()
    > to correct this.
    > Since ieee80211_purge_tx_queue() doesn&#x27;t take locks, to prevent racing
    > between TX work and purge TX queue, flush and destroy TX work in advance.
    > wlan0: deauthenticating from aa:f5:fd:60:4c:a8 by local
    > choice (Reason: 3&#x3D;DEAUTH_LEAVING)
    > ------------[ cut here ]------------
    > Have pending ack frames!
    > WARNING: CPU: 3 PID: 9232 at net/mac80211/main.c:1691
    > ieee80211_free_ack_frame+0x5c/0x90 [mac80211]
    > CPU: 3 PID: 9232 Comm: rmmod Tainted: G         C
    > 6.10.1-200.fc40.aarch64 #1
    > Hardware name: pine64 Pine64 PinePhone Braveheart
    > (1.1)/Pine64 PinePhone Braveheart (1.1), BIOS 2024.01 01/01/2024
    > pstate: 60400005 (nZCv daif +PAN -UAO -TCO -DIT -SSBS BTYPE&#x3D;--)
    > pc : ieee80211_free_ack_frame+0x5c/0x90 [mac80211]
    > lr : ieee80211_free_ack_frame+0x5c/0x90 [mac80211]
    > sp : ffff80008c1b37b0
    > x29: ffff80008c1b37b0 x28: ffff000003be8000 x27: 0000000000000000
    > x26: 0000000000000000 x25: ffff000003dc14b8 x24: ffff80008c1b37d0
    > x23: ffff000000ff9f80 x22: 0000000000000000 x21: 000000007fffffff
    > x20: ffff80007c7e93d8 x19: ffff00006e66f400 x18: 0000000000000000
    > x17: ffff7ffffd2b3000 x16: ffff800083fc0000 x15: 0000000000000000
    > x14: 0000000000000000 x13: 2173656d61726620 x12: 6b636120676e6964
    > x11: 0000000000000000 x10: 000000000000005d x9 : ffff8000802af2b0
    > x8 : ffff80008c1b3430 x7 : 0000000000000001 x6 : 0000000000000001
    > x5 : 0000000000000000 x4 : 0000000000000000 x3 : 0000000000000000
    > x2 : 0000000000000000 x1 : 0000000000000000 x0 : ffff000003be8000
    > Call trace:
    > ieee80211_free_ack_frame+0x5c/0x90 [mac80211]
    > idr_for_each+0x74/0x110
    > ieee80211_free_hw+0x44/0xe8 [mac80211]
    > rtw_sdio_remove+0x9c/0xc0 [rtw88_sdio]
    > sdio_bus_remove+0x44/0x180
    > device_remove+0x54/0x90
    > device_release_driver_internal+0x1d4/0x238
    > driver_detach+0x54/0xc0
    > bus_remove_driver+0x78/0x108
    > driver_unregister+0x38/0x78
    > sdio_unregister_driver+0x2c/0x40
    > rtw_8723cs_driver_exit+0x18/0x1000 [rtw88_8723cs]
    > __do_sys_delete_module.isra.0+0x190/0x338
    > __arm64_sys_delete_module+0x1c/0x30
    > invoke_syscall+0x74/0x100
    > el0_svc_common.constprop.0+0x48/0xf0
    > do_el0_svc+0x24/0x38
    > el0_svc+0x3c/0x158
    > el0t_64_sync_handler+0x120/0x138
    > el0t_64_sync+0x194/0x198
    > ---[ end trace 0000000000000000 ]---
    > Reported-by: Peter Robinson &lt;pbrobinson@gmail.com&gt;
    > Closes: https://lore.kernel.org/linux-wireless/CALeDE9OAa56KMzgknaCD3quOgYuEHFx9_hcT&#x3D;OFgmMAb+8MPyA@mail.gmail.com/
    > Tested-by: Ping-Ke Shih &lt;pkshih@realtek.com&gt; # 8723DU
    > Signed-off-by: Ping-Ke Shih &lt;pkshih@realtek.com&gt;
    > Link: https://patch.msgid.link/20240822014255.10211-2-pkshih@realtek.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/xe/pciid: Add new PCI id for ARL (@Dnyaneshwar Bhadane in [9a13d81c74b1873](https://github.com/sophgo/linux-riscv/commit/9a13d81c74b1873) at 2024-12-14 19:03:42)
    > [ Upstream commit 35667a0330612bb25a689e4d3a687d47cede1d7a ]
    > Add new PCI id for ARL platform.
    > v2: Fix typo in PCI id (SaiTeja)
    > Signed-off-by: Dnyaneshwar Bhadane &lt;dnyaneshwar.bhadane@intel.com&gt;
    > Reviewed-by: Sai Teja Pottumuttu &lt;sai.teja.pottumuttu@intel.com&gt;
    > Reviewed-by: Tejas Upadhyay &lt;tejas.upadhyay@intel.com&gt;
    > Signed-off-by: Matt Roper &lt;matthew.d.roper@intel.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20240912115906.2730577-1-dnyaneshwar.bhadane@intel.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm: panel-orientation-quirks: Add quirk for AYA NEO Founder edition (@Joaquín Ignacio Aramendía in [5d7f35ed5f73925](https://github.com/sophgo/linux-riscv/commit/5d7f35ed5f73925) at 2024-12-14 19:03:42)
    > [ Upstream commit d7972d735ca80a40a571bf753c138263981a5698 ]
    > Add quirk orientation for AYA NEO Founder. The name appears with spaces in
    > DMI strings as other devices of the brand. The panel is the same as the
    > NEXT and 2021 models. Those could not be reused as the former has VENDOR
    > name as &quot;AYANEO&quot; without spaces and the latter has &quot;AYADEVICE&quot;.
    > Tested by the JELOS team that has been patching their own kernel for a
    > while now and confirmed by users in the AYA NEO and ChimeraOS discord
    > servers.
    > Signed-off-by: Joaquín Ignacio Aramendía &lt;samsagax@gmail.com&gt;
    > Signed-off-by: Tobias Jakobi &lt;tjakobi@math.uni-bielefeld.de&gt;
    > Reviewed-by: Dmitry Baryshkov &lt;dmitry.baryshkov@linaro.org&gt;
    > Reviewed-by: Hans de Goede &lt;hdegoede@redhat.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/f71889a0b39f13f4b78481bd030377ca15035680.1726492131.git.tjakobi@math.uni-bielefeld.de
    > Signed-off-by: Dmitry Baryshkov &lt;dmitry.baryshkov@linaro.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm: panel-orientation-quirks: Add quirk for AYA NEO 2 model (@Joaquín Ignacio Aramendía in [4150f223428a6ee](https://github.com/sophgo/linux-riscv/commit/4150f223428a6ee) at 2024-12-14 19:03:42)
    > [ Upstream commit 361ebf5ef843b0aa1704c72eb26b91cf76c3c5b7 ]
    > Add quirk orientation for AYA NEO 2. The name appears without spaces in
    > DMI strings. That made it difficult to reuse the 2021 match. Also the
    > display is larger in resolution.
    > Tested by the JELOS team that has been patching their own kernel for a
    > while now and confirmed by users in the AYA NEO and ChimeraOS discord
    > servers.
    > Signed-off-by: Joaquín Ignacio Aramendía &lt;samsagax@gmail.com&gt;
    > Signed-off-by: Tobias Jakobi &lt;tjakobi@math.uni-bielefeld.de&gt;
    > Reviewed-by: Dmitry Baryshkov &lt;dmitry.baryshkov@linaro.org&gt;
    > Reviewed-by: Hans de Goede &lt;hdegoede@redhat.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/2b35545b77a9fd8c9699b751ca282226dcecb1dd.1726492131.git.tjakobi@math.uni-bielefeld.de
    > Signed-off-by: Dmitry Baryshkov &lt;dmitry.baryshkov@linaro.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm: panel-orientation-quirks: Add quirk for AYA NEO GEEK (@Joaquín Ignacio Aramendía in [187d5ff497db4f9](https://github.com/sophgo/linux-riscv/commit/187d5ff497db4f9) at 2024-12-14 19:03:42)
    > [ Upstream commit 428656feb972ca99200fc127b5aecb574efd9d3d ]
    > Add quirk orientation for AYA NEO GEEK. The name appears without
    > spaces in DMI strings. The board name is completely different to
    > the previous models making it difficult to reuse their quirks
    > despite being the same resolution and using the same orientation.
    > Tested by the JELOS team that has been patching their own kernel for a
    > while now and confirmed by users in the AYA NEO and ChimeraOS discord
    > servers.
    > Signed-off-by: Joaquín Ignacio Aramendía &lt;samsagax@gmail.com&gt;
    > Signed-off-by: Tobias Jakobi &lt;tjakobi@math.uni-bielefeld.de&gt;
    > Reviewed-by: Dmitry Baryshkov &lt;dmitry.baryshkov@linaro.org&gt;
    > Reviewed-by: Hans de Goede &lt;hdegoede@redhat.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/40350b0d63fe2b54e7cba1e14be50917203f0079.1726492131.git.tjakobi@math.uni-bielefeld.de
    > Signed-off-by: Dmitry Baryshkov &lt;dmitry.baryshkov@linaro.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ sched_ext: add a missing rcu_read_lock/unlock pair at scx_select_cpu_dfl() (@Changwoo Min in [cd38a8f52940d41](https://github.com/sophgo/linux-riscv/commit/cd38a8f52940d41) at 2024-12-14 19:03:41)
    > [ Upstream commit f39489fea677ad78ca4ce1ab2d204a6639b868dc ]
    > When getting an LLC CPU mask in the default CPU selection policy,
    > scx_select_cpu_dfl(), a pointer to the sched_domain is dereferenced
    > using rcu_read_lock() without holding rcu_read_lock(). Such an unprotected
    > dereference often causes the following warning and can cause an invalid
    > memory access in the worst case.
    > Therefore, protect dereference of a sched_domain pointer using a pair
    > of rcu_read_lock() and unlock().
    > [   20.996135] &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;
    > [   20.996345] WARNING: suspicious RCU usage
    > [   20.996563] 6.11.0-virtme #17 Tainted: G        W
    > [   20.996576] -----------------------------
    > [   20.996576] kernel/sched/ext.c:3323 suspicious rcu_dereference_check() usage!
    > [   20.996576]
    > [   20.996576] other info that might help us debug this:
    > [   20.996576]
    > [   20.996576]
    > [   20.996576] rcu_scheduler_active &#x3D; 2, debug_locks &#x3D; 1
    > [   20.996576] 4 locks held by kworker/8:1/140:
    > [   20.996576]  #0: ffff8b18c00dd348 ((wq_completion)pm){+.+.}-{0:0}, at: process_one_work+0x4a0/0x590
    > [   20.996576]  #1: ffffb3da01f67e58 ((work_completion)(&amp;dev-&gt;power.work)){+.+.}-{0:0}, at: process_one_work+0x1ba/0x590
    > [   20.996576]  #2: ffffffffa316f9f0 (&amp;rcu_state.gp_wq){..-.}-{2:2}, at: swake_up_one+0x15/0x60
    > [   20.996576]  #3: ffff8b1880398a60 (&amp;p-&gt;pi_lock){-.-.}-{2:2}, at: try_to_wake_up+0x59/0x7d0
    > [   20.996576]
    > [   20.996576] stack backtrace:
    > [   20.996576] CPU: 8 UID: 0 PID: 140 Comm: kworker/8:1 Tainted: G        W          6.11.0-virtme #17
    > [   20.996576] Tainted: [W]&#x3D;WARN
    > [   20.996576] Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS Arch Linux 1.16.3-1-1 04/01/2014
    > [   20.996576] Workqueue: pm pm_runtime_work
    > [   20.996576] Sched_ext: simple (disabling+all), task: runnable_at&#x3D;-6ms
    > [   20.996576] Call Trace:
    > [   20.996576]  &lt;IRQ&gt;
    > [   20.996576]  dump_stack_lvl+0x6f/0xb0
    > [   20.996576]  lockdep_rcu_suspicious.cold+0x4e/0x96
    > [   20.996576]  scx_select_cpu_dfl+0x234/0x260
    > [   20.996576]  select_task_rq_scx+0xfb/0x190
    > [   20.996576]  select_task_rq+0x47/0x110
    > [   20.996576]  try_to_wake_up+0x110/0x7d0
    > [   20.996576]  swake_up_one+0x39/0x60
    > [   20.996576]  rcu_core+0xb08/0xe50
    > [   20.996576]  ? srso_alias_return_thunk+0x5/0xfbef5
    > [   20.996576]  ? mark_held_locks+0x40/0x70
    > [   20.996576]  handle_softirqs+0xd3/0x410
    > [   20.996576]  irq_exit_rcu+0x78/0xa0
    > [   20.996576]  sysvec_apic_timer_interrupt+0x73/0x80
    > [   20.996576]  &lt;/IRQ&gt;
    > [   20.996576]  &lt;TASK&gt;
    > [   20.996576]  asm_sysvec_apic_timer_interrupt+0x1a/0x20
    > [   20.996576] RIP: 0010:_raw_spin_unlock_irqrestore+0x36/0x70
    > [   20.996576] Code: f5 53 48 8b 74 24 10 48 89 fb 48 83 c7 18 e8 11 b4 36 ff 48 89 df e8 99 0d 37 ff f7 c5 00 02 00 00 75 17 9c 58 f6 c4 02 75 2b &lt;65&gt; ff 0d 5b 55 3c 5e 74 16 5b 5d e9 95 8e 28 00 e8 a5 ee 44 ff 9c
    > [   20.996576] RSP: 0018:ffffb3da01f67d20 EFLAGS: 00000246
    > [   20.996576] RAX: 0000000000000002 RBX: ffffffffa4640220 RCX: 0000000000000040
    > [   20.996576] RDX: 0000000000000000 RSI: 0000000000000000 RDI: ffffffffa1c7b27b
    > [   20.996576] RBP: 0000000000000246 R08: 0000000000000001 R09: 0000000000000000
    > [   20.996576] R10: 0000000000000001 R11: 000000000000021c R12: 0000000000000246
    > [   20.996576] R13: ffff8b1881363958 R14: 0000000000000000 R15: ffff8b1881363800
    > [   20.996576]  ? _raw_spin_unlock_irqrestore+0x4b/0x70
    > [   20.996576]  serial_port_runtime_resume+0xd4/0x1a0
    > [   20.996576]  ? __pfx_serial_port_runtime_resume+0x10/0x10
    > [   20.996576]  __rpm_callback+0x44/0x170
    > [   20.996576]  ? __pfx_serial_port_runtime_resume+0x10/0x10
    > [   20.996576]  rpm_callback+0x55/0x60
    > [   20.996576]  ? __pfx_serial_port_runtime_resume+0x10/0x10
    > [   20.996576]  rpm_resume+0x582/0x7b0
    > [   20.996576]  pm_runtime_work+0x7c/0xb0
    > [   20.996576]  process_one_work+0x1fb/0x590
    > [   20.996576]  worker_thread+0x18e/0x350
    > [   20.996576]  ? __pfx_worker_thread+0x10/0x10
    > [   20.996576]  kthread+0xe2/0x110
    > [   20.996576]  ? __pfx_kthread+0x10/0x10
    > [   20.996576]  ret_from_fork+0x34/0x50
    > [   20.996576]  ? __pfx_kthread+0x10/0x10
    > [   20.996576]  ret_from_fork_asm+0x1a/0x30
    > [   20.996576]  &lt;/TASK&gt;
    > [   21.056592] sched_ext: BPF scheduler &quot;simple&quot; disabled (unregistered from user space)
    > Signed-off-by: Changwoo Min &lt;changwoo@igalia.com&gt;
    > Acked-by: Andrea Righi &lt;arighi@nvidia.com&gt;
    > Signed-off-by: Tejun Heo &lt;tj@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ selftests/resctrl: Protect against array overflow when reading strings (@Reinette Chatre in [8b6752909058df4](https://github.com/sophgo/linux-riscv/commit/8b6752909058df4) at 2024-12-14 19:03:41)
    > [ Upstream commit 46058430fc5d39c114f7e1b9c6ff14c9f41bd531 ]
    > resctrl selftests discover system properties via a variety of sysfs files.
    > The MBM and MBA tests need to discover the event and umask with which to
    > configure the performance event used to measure read memory bandwidth.
    > This is done by parsing the contents of
    > /sys/bus/event_source/devices/uncore_imc_&lt;imc instance&gt;/events/cas_count_read
    > Similarly, the resctrl selftests discover the cache size via
    > /sys/bus/cpu/devices/cpu&lt;id&gt;/cache/index&lt;index&gt;/size.
    > Take care to do bounds checking when using fscanf() to read the
    > contents of files into a string buffer because by default fscanf() assumes
    > arbitrarily long strings. If the file contains more bytes than the array
    > can accommodate then an overflow will occur.
    > Provide a maximum field width to the conversion specifier to protect
    > against array overflow. The maximum is one less than the array size because
    > string input stores a terminating null byte that is not covered by the
    > maximum field width.
    > Signed-off-by: Reinette Chatre &lt;reinette.chatre@intel.com&gt;
    > Reviewed-by: Ilpo Järvinen &lt;ilpo.jarvinen@linux.intel.com&gt;
    > Signed-off-by: Shuah Khan &lt;skhan@linuxfoundation.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ HID: magicmouse: Apple Magic Trackpad 2 USB-C driver support (@Callahan Kovacs in [7f70c81a77f29c0](https://github.com/sophgo/linux-riscv/commit/7f70c81a77f29c0) at 2024-12-14 19:03:41)
    > [ Upstream commit 87a2f10395c82c2b4687bb8611a6c5663a12f9e7 ]
    > Adds driver support for the USB-C model of Apple&#x27;s Magic Trackpad 2.
    > The 2024 USB-C model is compatible with the existing Magic Trackpad 2
    > driver but has a different hardware ID.
    > Link: https://bugzilla.kernel.org/show_bug.cgi?id&#x3D;219470
    > Signed-off-by: Callahan Kovacs &lt;callahankovacs@gmail.com&gt;
    > Signed-off-by: Jiri Kosina &lt;jkosina@suse.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/xe/pciids: separate ARL and MTL PCI IDs (@Jani Nikula in [74bee8735bb399c](https://github.com/sophgo/linux-riscv/commit/74bee8735bb399c) at 2024-12-14 19:03:41)
    > [ Upstream commit cdb56a63f7eef34e89b045fc8bcae8d326bbdb19 ]
    > Avoid including PCI IDs for one platform to the PCI IDs of another. It&#x27;s
    > more clear to deal with them completely separately at the PCI ID macro
    > level.
    > Reviewed-by: Shekhar Chauhan &lt;shekhar.chauhan@intel.com&gt;
    > Signed-off-by: Jani Nikula &lt;jani.nikula@intel.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/a30cb0da7694a8eccceba66d676ac59aa0e96176.1725443121.git.jani.nikula@intel.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/xe/pciids: separate RPL-U and RPL-P PCI IDs (@Jani Nikula in [73b50c34acb9f51](https://github.com/sophgo/linux-riscv/commit/73b50c34acb9f51) at 2024-12-14 19:03:41)
    > [ Upstream commit d454902a690db47f1880f963514bbf0fc7a129a8 ]
    > Avoid including PCI IDs for one platform to the PCI IDs of another. It&#x27;s
    > more clear to deal with them completely separately at the PCI ID macro
    > level.
    > Reviewed-by: Sai Teja Pottumuttu &lt;sai.teja.pottumuttu@intel.com&gt;
    > Signed-off-by: Jani Nikula &lt;jani.nikula@intel.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/4868d36fbfa8c38ea2d490bca82cf6370b8d65dd.1725443121.git.jani.nikula@intel.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/vc4: hdmi: Avoid log spam for audio start failure (@Dom Cobley in [7315275ada2a6ea](https://github.com/sophgo/linux-riscv/commit/7315275ada2a6ea) at 2024-12-14 19:03:41)
    > [ Upstream commit b4e5646178e86665f5caef2894578600f597098a ]
    > We regularly get dmesg error reports of:
    > [   18.184066] hdmi-audio-codec hdmi-audio-codec.3.auto: ASoC: error at snd_soc_dai_startup on i2s-hifi: -19
    > [   18.184098]  MAI: soc_pcm_open() failed (-19)
    > These are generated for any disconnected hdmi interface when pulseaudio
    > attempts to open the associated ALSA device (numerous times). Each open
    > generates a kernel error message, generating general log spam.
    > The error messages all come from _soc_pcm_ret in sound/soc/soc-pcm.c#L39
    > which suggests returning ENOTSUPP, rather that ENODEV will be quiet.
    > And indeed it is.
    > Signed-off-by: Dom Cobley &lt;popcornmix@gmail.com&gt;
    > Reviewed-by: Maxime Ripard &lt;mripard@kernel.org&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20240621152055.4180873-5-dave.stevenson@raspberrypi.com
    > Signed-off-by: Dave Stevenson &lt;dave.stevenson@raspberrypi.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ mmc: sdhci-esdhc-imx: enable quirks SDHCI_QUIRK_NO_LED (@Peng Fan in [f7bfc223b9cb494](https://github.com/sophgo/linux-riscv/commit/f7bfc223b9cb494) at 2024-12-14 19:03:40)
    > [ Upstream commit 4dede2b76f4a760e948e1a49b1520881cb459bd3 ]
    > Enable SDHCI_QUIRK_NO_LED for i.MX7ULP, i.MX8MM, i.MX8QXP and
    > i.MXRT1050. Even there is LCTL register bit, there is no IOMUX PAD
    > for it. So there is no sense to enable LED for SDHCI for these SoCs.
    > Signed-off-by: Peng Fan &lt;peng.fan@nxp.com&gt;
    > Reviewed-by: Haibo Chen &lt;haibo.chen@nxp.com&gt;
    > Acked-by: Adrian Hunter &lt;adrian.hunter@intel.com&gt;
    > Link: https://lore.kernel.org/r/20240923062016.1165868-1-peng.fan@oss.nxp.com
    > Signed-off-by: Ulf Hansson &lt;ulf.hansson@linaro.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ mmc: core: Add SD card quirk for broken poweroff notification (@Keita Aihara in [bc7ff558d72c4b6](https://github.com/sophgo/linux-riscv/commit/bc7ff558d72c4b6) at 2024-12-14 19:03:40)
    > [ Upstream commit cd068d51594d9635bf6688fc78717572b78bce6a ]
    > GIGASTONE Gaming Plus microSD cards manufactured on 02/2022 report that
    > they support poweroff notification and cache, but they are not working
    > correctly.
    > Flush Cache bit never gets cleared in sd_flush_cache() and Poweroff
    > Notification Ready bit also never gets set to 1 within 1 second from the
    > end of busy of CMD49 in sd_poweroff_notify().
    > This leads to I/O error and runtime PM error state.
    > I observed that the same card manufactured on 01/2024 works as expected.
    > This problem seems similar to the Kingston cards fixed with
    > commit c467c8f08185 (&quot;mmc: Add MMC_QUIRK_BROKEN_SD_CACHE for Kingston
    > Canvas Go Plus from 11/2019&quot;) and should be handled using quirks.
    > CID for the problematic card is here.
    > 12345641535443002000000145016200
    > Manufacturer ID is 0x12 and defined as CID_MANFID_GIGASTONE as of now,
    > but would like comments on what naming is appropriate because MID list
    > is not public and not sure it&#x27;s right.
    > Signed-off-by: Keita Aihara &lt;keita.aihara@sony.com&gt;
    > Link: https://lore.kernel.org/r/20240913094417.GA4191647@sony.com
    > Signed-off-by: Ulf Hansson &lt;ulf.hansson@linaro.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ soc: imx8m: Probe the SoC driver as platform driver (@Marek Vasut in [997a3c04d7fa3d1](https://github.com/sophgo/linux-riscv/commit/997a3c04d7fa3d1) at 2024-12-14 19:03:40)
    > [ Upstream commit 9cc832d37799dbea950c4c8a34721b02b8b5a8ff ]
    > With driver_async_probe&#x3D;* on kernel command line, the following trace is
    > produced because on i.MX8M Plus hardware because the soc-imx8m.c driver
    > calls of_clk_get_by_name() which returns -EPROBE_DEFER because the clock
    > driver is not yet probed. This was not detected during regular testing
    > without driver_async_probe.
    > Convert the SoC code to platform driver and instantiate a platform device
    > in its current device_initcall() to probe the platform driver. Rework
    > .soc_revision callback to always return valid error code and return SoC
    > revision via parameter. This way, if anything in the .soc_revision callback
    > return -EPROBE_DEFER, it gets propagated to .probe and the .probe will get
    > retried later.
    > &quot;
    > ------------[ cut here ]------------
    > WARNING: CPU: 1 PID: 1 at drivers/soc/imx/soc-imx8m.c:115 imx8mm_soc_revision+0xdc/0x180
    > CPU: 1 UID: 0 PID: 1 Comm: swapper/0 Not tainted 6.11.0-next-20240924-00002-g2062bb554dea #603
    > Hardware name: DH electronics i.MX8M Plus DHCOM Premium Developer Kit (3) (DT)
    > pstate: 20000005 (nzCv daif -PAN -UAO -TCO -DIT -SSBS BTYPE&#x3D;--)
    > pc : imx8mm_soc_revision+0xdc/0x180
    > lr : imx8mm_soc_revision+0xd0/0x180
    > sp : ffff8000821fbcc0
    > x29: ffff8000821fbce0 x28: 0000000000000000 x27: ffff800081810120
    > x26: ffff8000818a9970 x25: 0000000000000006 x24: 0000000000824311
    > x23: ffff8000817f42c8 x22: ffff0000df8be210 x21: fffffffffffffdfb
    > x20: ffff800082780000 x19: 0000000000000001 x18: ffffffffffffffff
    > x17: ffff800081fff418 x16: ffff8000823e1000 x15: ffff0000c03b65e8
    > x14: ffff0000c00051b0 x13: ffff800082790000 x12: 0000000000000801
    > x11: ffff80008278ffff x10: ffff80008209d3a6 x9 : ffff80008062e95c
    > x8 : ffff8000821fb9a0 x7 : 0000000000000000 x6 : 00000000000080e3
    > x5 : ffff0000df8c03d8 x4 : 0000000000000000 x3 : 0000000000000000
    > x2 : 0000000000000000 x1 : fffffffffffffdfb x0 : fffffffffffffdfb
    > Call trace:
    > imx8mm_soc_revision+0xdc/0x180
    > imx8_soc_init+0xb0/0x1e0
    > do_one_initcall+0x94/0x1a8
    > kernel_init_freeable+0x240/0x2a8
    > kernel_init+0x28/0x140
    > ret_from_fork+0x10/0x20
    > ---[ end trace 0000000000000000 ]---
    > SoC: i.MX8MP revision 1.1
    > &quot;
    > Signed-off-by: Marek Vasut &lt;marex@denx.de&gt;
    > Signed-off-by: Shawn Guo &lt;shawnguo@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ media: cx231xx: Add support for Dexatek USB Video Grabber 1d19:6108 (@Rohan Barar in [87ace43e5105f4f](https://github.com/sophgo/linux-riscv/commit/87ace43e5105f4f) at 2024-12-14 19:03:40)
    > [ Upstream commit 61a830bc0ea69a05d8a4534f825c6aa618263649 ]
    > Add Dexatek Technology Ltd USB Video Grabber 1d19:6108 to the cx231xx
    > driver. This device is sold under the name &quot;BAUHN DVD Maker (DK8723)&quot; by
    > ALDI in Australia.
    > This device is similar to 1d19:6109, which is already included in cx231xx.
    > Both video and audio capture function correctly after installing the
    > patched cx231xx driver.
    > Patch Changelog
    > v1:
    > - Initial submission.
    > v2:
    > - Fix SoB + Improve subject.
    > v3:
    > - Rephrase message to not exceed 75 characters per line.
    > - Removed reference to external GitHub URL.
    > Signed-off-by: Rohan Barar &lt;rohan.barar@gmail.com&gt;
    > Signed-off-by: Hans Verkuil &lt;hverkuil-cisco@xs4all.nl&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ regmap: maple: Provide lockdep (sub)class for maple tree&#x27;s internal lock (@Cristian Ciocaltea in [0380da1da737d68](https://github.com/sophgo/linux-riscv/commit/0380da1da737d68) at 2024-12-14 19:03:40)
    > [ Upstream commit 1ed9b927e7dd8b8cff13052efe212a8ff72ec51d ]
    > In some cases when using the maple tree register cache, the lockdep
    > validator might complain about invalid deadlocks:
    > [7.131886]  Possible interrupt unsafe locking scenario:
    > [7.131890]        CPU0                    CPU1
    > [7.131893]        ----                    ----
    > [7.131896]   lock(&amp;mt-&gt;ma_lock);
    > [7.131904]                                local_irq_disable();
    > [7.131907]                                lock(rockchip_drm_vop2:3114:(&amp;vop2_regmap_config)-&gt;lock);
    > [7.131916]                                lock(&amp;mt-&gt;ma_lock);
    > [7.131925]   &lt;Interrupt&gt;
    > [7.131928]     lock(rockchip_drm_vop2:3114:(&amp;vop2_regmap_config)-&gt;lock);
    > [7.131936]
    > ** DEADLOCK ***
    > [7.131939] no locks held by swapper/0/0.
    > [7.131944]
    > the shortest dependencies between 2nd lock and 1st lock:
    > [7.131950]  -&gt; (&amp;mt-&gt;ma_lock){+.+.}-{2:2} {
    > [7.131966]     HARDIRQ-ON-W at:
    > [7.131973]                       lock_acquire+0x200/0x330
    > [7.131986]                       _raw_spin_lock+0x50/0x70
    > [7.131998]                       regcache_maple_write+0x68/0xe0
    > [7.132010]                       regcache_write+0x6c/0x90
    > [7.132019]                       _regmap_read+0x19c/0x1d0
    > [7.132029]                       _regmap_update_bits+0xc0/0x148
    > [7.132038]                       regmap_update_bits_base+0x6c/0xa8
    > [7.132048]                       rk8xx_probe+0x22c/0x3d8
    > [7.132057]                       rk8xx_spi_probe+0x74/0x88
    > [7.132065]                       spi_probe+0xa8/0xe0
    > [...]
    > [7.132675]   }
    > [7.132678]   ... key      at: [&lt;ffff800082943c20&gt;] __key.0+0x0/0x10
    > [7.132691]   ... acquired at:
    > [7.132695]    _raw_spin_lock+0x50/0x70
    > [7.132704]    regcache_maple_write+0x68/0xe0
    > [7.132714]    regcache_write+0x6c/0x90
    > [7.132724]    _regmap_read+0x19c/0x1d0
    > [7.132732]    _regmap_update_bits+0xc0/0x148
    > [7.132741]    regmap_field_update_bits_base+0x74/0xb8
    > [7.132751]    vop2_plane_atomic_update+0x480/0x14d8 [rockchipdrm]
    > [7.132820]    drm_atomic_helper_commit_planes+0x1a0/0x320 [drm_kms_helper]
    > [...]
    > [7.135112] -&gt; (rockchip_drm_vop2:3114:(&amp;vop2_regmap_config)-&gt;lock){-...}-{2:2} {
    > [7.135130]    IN-HARDIRQ-W at:
    > [7.135136]                     lock_acquire+0x200/0x330
    > [7.135147]                     _raw_spin_lock_irqsave+0x6c/0x98
    > [7.135157]                     regmap_lock_spinlock+0x20/0x40
    > [7.135166]                     regmap_read+0x44/0x90
    > [7.135175]                     vop2_isr+0x90/0x290 [rockchipdrm]
    > [7.135225]                     __handle_irq_event_percpu+0x124/0x2d0
    > In the example above, the validator seems to get the scope of
    > dependencies wrong, since the regmap instance used in rk8xx-spi driver
    > has nothing to do with the instance from vop2.
    > Improve validation by sharing the regmap&#x27;s lockdep class with the maple
    > tree&#x27;s internal lock, while also providing a subclass for the latter.
    > Signed-off-by: Cristian Ciocaltea &lt;cristian.ciocaltea@collabora.com&gt;
    > Link: https://patch.msgid.link/20241031-regmap-maple-lockdep-fix-v2-1-06a3710f3623@collabora.com
    > Signed-off-by: Mark Brown &lt;broonie@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ firmware: qcom: scm: Allow QSEECOM on Dell XPS 13 9345 (@Aleksandrs Vinarskis in [0104b5cac446530](https://github.com/sophgo/linux-riscv/commit/0104b5cac446530) at 2024-12-14 19:03:40)
    > [ Upstream commit 304c250ba121f5c505be3fc13dec984016f3c032 ]
    > Allow particular machine accessing eg. efivars.
    > Signed-off-by: Aleksandrs Vinarskis &lt;alex.vinarskis@gmail.com&gt;
    > Reviewed-by: Dmitry Baryshkov &lt;dmitry.baryshkov@linaro.org&gt;
    > Tested-by: Stefan Schmidt &lt;stefan.schmidt@linaro.org&gt;
    > Link: https://lore.kernel.org/r/20241003211139.9296-3-alex.vinarskis@gmail.com
    > Signed-off-by: Bjorn Andersson &lt;andersson@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ HID: add per device quirk to force bind to hid-generic (@Benjamin Tissoires in [ea74e9675b8ef13](https://github.com/sophgo/linux-riscv/commit/ea74e9675b8ef13) at 2024-12-14 19:03:39)
    > [ Upstream commit 645c224ac5f6e0013931c342ea707b398d24d410 ]
    > We already have the possibility to force not binding to hid-generic and
    > rely on a dedicated driver, but we couldn&#x27;t do the other way around.
    > This is useful for BPF programs where we are fixing the report descriptor
    > and the events, but want to avoid a specialized driver to come after BPF
    > which would unwind everything that is done there.
    > Reviewed-by: Peter Hutterer &lt;peter.hutterer@who-t.net&gt;
    > Link: https://patch.msgid.link/20241001-hid-bpf-hid-generic-v3-8-2ef1019468df@kernel.org
    > Signed-off-by: Benjamin Tissoires &lt;bentiss@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ soc: qcom: pd-mapper: Add QCM6490 PD maps (@Bjorn Andersson in [c617ac0358601cf](https://github.com/sophgo/linux-riscv/commit/c617ac0358601cf) at 2024-12-14 19:03:39)
    > [ Upstream commit 31a95fe0851afbbc697b6be96c8a81a01d65aa5f ]
    > The QCM6490 is a variant of SC7280, with the usual set of protection
    > domains, and hence the need for a PD-mapper. In particular USB Type-C
    > port management and battery management is pmic_glink based.
    > Add an entry to the kernel, to avoid the need for userspace to provide
    > this service.
    > Signed-off-by: Bjorn Andersson &lt;bjorn.andersson@oss.qualcomm.com&gt;
    > Reviewed-by: Dmitry Baryshkov &lt;dmitry.baryshkov@linaro.org&gt;
    > Link: https://lore.kernel.org/r/20241004-qcm6490-pd-mapper-v1-1-d6f4bc3bffa3@oss.qualcomm.com
    > Signed-off-by: Bjorn Andersson &lt;andersson@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ firmware: qcom: scm: Allow QSEECOM on Lenovo Yoga Slim 7x (@Maya Matuszczyk in [bb6a99db1d2e3a2](https://github.com/sophgo/linux-riscv/commit/bb6a99db1d2e3a2) at 2024-12-14 19:03:39)
    > [ Upstream commit c6fa2834afc6a6fe210415ec253a61e6eafdf651 ]
    > Allow QSEECOM on Lenovo Yoga Slim 7x, to enable accessing EFI variables.
    > Signed-off-by: Maya Matuszczyk &lt;maccraft123mc@gmail.com&gt;
    > Reviewed-by: Dmitry Baryshkov &lt;dmitry.baryshkov@linaro.org&gt;
    > Link: https://lore.kernel.org/r/20240919134421.112643-2-maccraft123mc@gmail.com
    > [bjorn: Rewrote commit message]
    > Signed-off-by: Bjorn Andersson &lt;andersson@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ media: uvcvideo: Force UVC version to 1.0a for 0408:4033 (@Ricardo Ribalda in [3cc5228d5b603cf](https://github.com/sophgo/linux-riscv/commit/3cc5228d5b603cf) at 2024-12-14 19:03:39)
    > [ Upstream commit c9df99302fff53b6007666136b9f43fbac7ee3d8 ]
    > The Quanta ACER HD User Facing camera reports a UVC 1.50 version, but
    > implements UVC 1.0a as shown by the UVC probe control being 26 bytes
    > long. Force the UVC version for that device.
    > Reported-by: Giuliano Lotta &lt;giuliano.lotta@gmail.com&gt;
    > Closes: https://lore.kernel.org/linux-media/fce4f906-d69b-417d-9f13-bf69fe5c81e3@koyu.space/
    > Signed-off-by: Ricardo Ribalda &lt;ribalda@chromium.org&gt;
    > Reviewed-by: Laurent Pinchart &lt;laurent.pinchart@ideasonboard.com&gt;
    > Link: https://lore.kernel.org/r/20240924-uvc-quanta-v1-1-2de023863767@chromium.org
    > Signed-off-by: Laurent Pinchart &lt;laurent.pinchart@ideasonboard.com&gt;
    > Signed-off-by: Hans Verkuil &lt;hverkuil-cisco@xs4all.nl&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ media: uvcvideo: RealSense D421 Depth module metadata (@Dmitry Perchanov in [17db6ed5a323ca1](https://github.com/sophgo/linux-riscv/commit/17db6ed5a323ca1) at 2024-12-14 19:03:39)
    > [ Upstream commit c6104297c965a5ee9d4b9d0d5d9cdd224d8fd59e ]
    > RealSense(R) D421 Depth module is low cost solution for 3D-stereo
    > vision. The module supports extended sensor metadata format D4XX.
    > Signed-off-by: Dmitry Perchanov &lt;dmitry.perchanov@intel.com&gt;
    > Reviewed-by: Laurent Pinchart &lt;laurent.pinchart@ideasonboard.com&gt;
    > Link: https://lore.kernel.org/r/d1fbfbbff5c8247a3130499985a53218c5b55c61.camel@intel.com
    > Signed-off-by: Laurent Pinchart &lt;laurent.pinchart@ideasonboard.com&gt;
    > Signed-off-by: Hans Verkuil &lt;hverkuil-cisco@xs4all.nl&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ media: uvcvideo: Add a quirk for the Kaiweets KTI-W02 infrared camera (@David Given in [0c20fadfd074d42](https://github.com/sophgo/linux-riscv/commit/0c20fadfd074d42) at 2024-12-14 19:03:39)
    > [ Upstream commit b2ec92bb5605452d539a7aa1e42345b95acd8583 ]
    > Adds a quirk to make the NXP Semiconductors 1fc9:009b chipset work.
    > lsusb for the device reports:
    > Bus 003 Device 011: ID 1fc9:009b NXP Semiconductors IR VIDEO
    > Device Descriptor:
    > bLength                18
    > bDescriptorType         1
    > bcdUSB               2.00
    > bDeviceClass          239 Miscellaneous Device
    > bDeviceSubClass         2 [unknown]
    > bDeviceProtocol         1 Interface Association
    > bMaxPacketSize0        64
    > idVendor           0x1fc9 NXP Semiconductors
    > idProduct          0x009b IR VIDEO
    > bcdDevice            1.01
    > iManufacturer           1 Guide sensmart
    > iProduct                2 IR VIDEO
    > iSerial                 0
    > bNumConfigurations      1
    > Configuration Descriptor:
    > bLength                 9
    > bDescriptorType         2
    > wTotalLength       0x00c2
    > bNumInterfaces          2
    > bConfigurationValue     1
    > iConfiguration          0
    > bmAttributes         0xc0
    > Self Powered
    > MaxPower              100mA
    > Interface Association:
    > bLength                 8
    > bDescriptorType        11
    > bFirstInterface         0
    > bInterfaceCount         2
    > bFunctionClass         14 Video
    > bFunctionSubClass       3 Video Interface Collection
    > bFunctionProtocol       0
    > iFunction               3 IR Camera
    > Interface Descriptor:
    > bLength                 9
    > bDescriptorType         4
    > bInterfaceNumber        0
    > bAlternateSetting       0
    > bNumEndpoints           1
    > bInterfaceClass        14 Video
    > bInterfaceSubClass      1 Video Control
    > bInterfaceProtocol      0
    > iInterface              0
    > VideoControl Interface Descriptor:
    > bLength                13
    > bDescriptorType        36
    > bDescriptorSubtype      1 (HEADER)
    > bcdUVC               1.00
    > wTotalLength       0x0033
    > dwClockFrequency        6.000000MHz
    > bInCollection           1
    > baInterfaceNr( 0)       1
    > VideoControl Interface Descriptor:
    > bLength                18
    > bDescriptorType        36
    > bDescriptorSubtype      2 (INPUT_TERMINAL)
    > bTerminalID             1
    > wTerminalType      0x0201 Camera Sensor
    > bAssocTerminal          0
    > iTerminal               0
    > wObjectiveFocalLengthMin      0
    > wObjectiveFocalLengthMax      0
    > wOcularFocalLength            0
    > bControlSize                  3
    > bmControls           0x00000000
    > VideoControl Interface Descriptor:
    > bLength                 9
    > bDescriptorType        36
    > bDescriptorSubtype      3 (OUTPUT_TERMINAL)
    > bTerminalID             2
    > wTerminalType      0x0101 USB Streaming
    > bAssocTerminal          0
    > bSourceID               1
    > iTerminal               0
    > VideoControl Interface Descriptor:
    > bLength                11
    > bDescriptorType        36
    > bDescriptorSubtype      5 (PROCESSING_UNIT)
    > Warning: Descriptor too short
    > bUnitID                 3
    > bSourceID               1
    > wMaxMultiplier          0
    > bControlSize            2
    > bmControls     0x00000000
    > iProcessing             0
    > bmVideoStandards     0x62
    > NTSC - 525/60
    > PAL - 525/60
    > Endpoint Descriptor:
    > bLength                 7
    > bDescriptorType         5
    > bEndpointAddress     0x81  EP 1 IN
    > bmAttributes            3
    > Transfer Type            Interrupt
    > Synch Type               None
    > Usage Type               Data
    > wMaxPacketSize     0x0008  1x 8 bytes
    > bInterval               1
    > Interface Descriptor:
    > bLength                 9
    > bDescriptorType         4
    > bInterfaceNumber        1
    > bAlternateSetting       0
    > bNumEndpoints           0
    > bInterfaceClass        14 Video
    > bInterfaceSubClass      2 Video Streaming
    > bInterfaceProtocol      0
    > iInterface              0
    > VideoStreaming Interface Descriptor:
    > bLength                            14
    > bDescriptorType                    36
    > bDescriptorSubtype                  1 (INPUT_HEADER)
    > bNumFormats                         1
    > wTotalLength                   0x0055
    > bEndpointAddress                 0x82  EP 2 IN
    > bmInfo                              0
    > bTerminalLink                       2
    > bStillCaptureMethod                 2
    > bTriggerSupport                     0
    > bTriggerUsage                       0
    > bControlSize                        1
    > bmaControls( 0)                     0
    > VideoStreaming Interface Descriptor:
    > bLength                            27
    > bDescriptorType                    36
    > bDescriptorSubtype                  4 (FORMAT_UNCOMPRESSED)
    > bFormatIndex                        1
    > bNumFrameDescriptors                1
    > guidFormat                            {e436eb7b-524f-11ce-9f53-0020af0ba770}
    > bBitsPerPixel                      16
    > bDefaultFrameIndex                  1
    > bAspectRatioX                       0
    > bAspectRatioY                       0
    > bmInterlaceFlags                 0x00
    > Interlaced stream or variable: No
    > Fields per frame: 2 fields
    > Field 1 first: No
    > Field pattern: Field 1 only
    > bCopyProtect                        0
    > VideoStreaming Interface Descriptor:
    > bLength                            34
    > bDescriptorType                    36
    > bDescriptorSubtype                  5 (FRAME_UNCOMPRESSED)
    > bFrameIndex                         1
    > bmCapabilities                   0x00
    > Still image unsupported
    > wWidth                            240
    > wHeight                           322
    > dwMinBitRate                 12364800
    > dwMaxBitRate                 30912000
    > dwMaxVideoFrameBufferSize      154560
    > dwDefaultFrameInterval         400000
    > bFrameIntervalType                  2
    > dwFrameInterval( 0)            400000
    > dwFrameInterval( 1)           1000000
    > VideoStreaming Interface Descriptor:
    > bLength                            10
    > bDescriptorType                    36
    > bDescriptorSubtype                  3 (STILL_IMAGE_FRAME)
    > bEndpointAddress                 0x00  EP 0 OUT
    > bNumImageSizePatterns               1
    > wWidth( 0)                        240
    > wHeight( 0)                       322
    > bNumCompressionPatterns             0
    > Interface Descriptor:
    > bLength                 9
    > bDescriptorType         4
    > bInterfaceNumber        1
    > bAlternateSetting       1
    > bNumEndpoints           1
    > bInterfaceClass        14 Video
    > bInterfaceSubClass      2 Video Streaming
    > bInterfaceProtocol      0
    > iInterface              0
    > Endpoint Descriptor:
    > bLength                 7
    > bDescriptorType         5
    > bEndpointAddress     0x82  EP 2 IN
    > bmAttributes            5
    > Transfer Type            Isochronous
    > Synch Type               Asynchronous
    > Usage Type               Data
    > wMaxPacketSize     0x0400  1x 1024 bytes
    > bInterval               1
    > Device Status:     0x0001
    > Self Powered
    > Signed-off-by: David Given &lt;dg@cowlark.com&gt;
    > Reviewed-by: Laurent Pinchart &lt;laurent.pinchart@ideasonboard.com&gt;
    > Reviewed-by: Ricardo Ribalda &lt;ribalda@chromium.org&gt;
    > Link: https://lore.kernel.org/r/20240918180540.10830-2-dg@cowlark.com
    > Signed-off-by: Laurent Pinchart &lt;laurent.pinchart@ideasonboard.com&gt;
    > Signed-off-by: Hans Verkuil &lt;hverkuil-cisco@xs4all.nl&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ cleanup: Adjust scoped_guard() macros to avoid potential warning (@Przemek Kitszel in [ff599ad2d2b809c](https://github.com/sophgo/linux-riscv/commit/ff599ad2d2b809c) at 2024-12-14 19:03:38)
    > [ Upstream commit fcc22ac5baf06dd17193de44b60dbceea6461983 ]
    > Change scoped_guard() and scoped_cond_guard() macros to make reasoning
    > about them easier for static analysis tools (smatch, compiler
    > diagnostics), especially to enable them to tell if the given usage of
    > scoped_guard() is with a conditional lock class (interruptible-locks,
    > try-locks) or not (like simple mutex_lock()).
    > Add compile-time error if scoped_cond_guard() is used for non-conditional
    > lock class.
    > Beyond easier tooling and a little shrink reported by bloat-o-meter
    > this patch enables developer to write code like:
    > int foo(struct my_drv *adapter)
    > {
    > scoped_guard(spinlock, &amp;adapter-&gt;some_spinlock)
    > return adapter-&gt;spinlock_protected_var;
    > }
    > Current scoped_guard() implementation does not support that,
    > due to compiler complaining:
    > error: control reaches end of non-void function [-Werror&#x3D;return-type]
    > Technical stuff about the change:
    > scoped_guard() macro uses common idiom of using &quot;for&quot; statement to declare
    > a scoped variable. Unfortunately, current logic is too hard for compiler
    > diagnostics to be sure that there is exactly one loop step; fix that.
    > To make any loop so trivial that there is no above warning, it must not
    > depend on any non-const variable to tell if there are more steps. There is
    > no obvious solution for that in C, but one could use the compound
    > statement expression with &quot;goto&quot; jumping past the &quot;loop&quot;, effectively
    > leaving only the subscope part of the loop semantics.
    > More impl details:
    > one more level of macro indirection is now needed to avoid duplicating
    > label names;
    > I didn&#x27;t spot any other place that is using the
    > &quot;for (...; goto label) if (0) label: break;&quot; idiom, so it&#x27;s not packed for
    > reuse beyond scoped_guard() family, what makes actual macros code cleaner.
    > There was also a need to introduce const true/false variable per lock
    > class, it is used to aid compiler diagnostics reasoning about &quot;exactly
    > 1 step&quot; loops (note that converting that to function would undo the whole
    > benefit).
    > Big thanks to Andy Shevchenko for help on this patch, both internal and
    > public, ranging from whitespace/formatting, through commit message
    > clarifications, general improvements, ending with presenting alternative
    > approaches - all despite not even liking the idea.
    > Big thanks to Dmitry Torokhov for the idea of compile-time check for
    > scoped_cond_guard() (to use it only with conditional locsk), and general
    > improvements for the patch.
    > Big thanks to David Lechner for idea to cover also scoped_cond_guard().
    > Signed-off-by: Przemek Kitszel &lt;przemyslaw.kitszel@intel.com&gt;
    > Signed-off-by: Peter Zijlstra (Intel) &lt;peterz@infradead.org&gt;
    > Reviewed-by: Dmitry Torokhov &lt;dmitry.torokhov@gmail.com&gt;
    > Link: https://lkml.kernel.org/r/20241018113823.171256-1-przemyslaw.kitszel@intel.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ timekeeping: Always check for negative motion (@Thomas Gleixner in [e26cbab9821a6e5](https://github.com/sophgo/linux-riscv/commit/e26cbab9821a6e5) at 2024-12-14 19:03:38)
    > [ Upstream commit c163e40af9b2331b2c629fd4ec8b703ed4d4ae39 ]
    > clocksource_delta() has two variants. One with a check for negative motion,
    > which is only selected by x86. This is a historic leftover as this function
    > was previously used in the time getter hot paths.
    > Since 135225a363ae timekeeping_cycles_to_ns() has unconditional protection
    > against this as a by-product of the protection against 64bit math overflow.
    > clocksource_delta() is only used in the clocksource watchdog and in
    > timekeeping_advance(). The extra conditional there is not hurting anyone.
    > Remove the config option and unconditionally prevent negative motion of the
    > readout.
    > Signed-off-by: Thomas Gleixner &lt;tglx@linutronix.de&gt;
    > Acked-by: John Stultz &lt;jstultz@google.com&gt;
    > Link: https://lore.kernel.org/all/20241031120328.599430157@linutronix.de
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ iio: magnetometer: fix if () scoped_guard() formatting (@Stephen Rothwell in [c7559dc2047e655](https://github.com/sophgo/linux-riscv/commit/c7559dc2047e655) at 2024-12-14 19:03:38)
    > commit 9a884bdb6e9560c6da44052d5248e89d78c983a6 upstream.
    > Add mising braces after an if condition that contains scoped_guard().
    > This style is both preferred and necessary here, to fix warning after
    > scoped_guard() change in commit fcc22ac5baf0 (&quot;cleanup: Adjust
    > scoped_guard() macros to avoid potential warning&quot;) to have if-else inside
    > of the macro. Current (no braces) use in af8133j_set_scale() yields
    > the following warnings:
    > af8133j.c:315:12: warning: suggest explicit braces to avoid ambiguous &#x27;else&#x27; [-Wdangling-else]
    > af8133j.c:316:3: warning: add explicit braces to avoid dangling else [-Wdangling-else]
    > Fixes: fcc22ac5baf0 (&quot;cleanup: Adjust scoped_guard() macros to avoid potential warning&quot;)
    > Closes: https://lore.kernel.org/oe-kbuild-all/202409270848.tTpyEAR7-lkp@intel.com/
    > Reported-by: kernel test robot &lt;lkp@intel.com&gt;
    > Signed-off-by: Stephen Rothwell &lt;sfr@canb.auug.org.au&gt;
    > Signed-off-by: Przemek Kitszel &lt;przemyslaw.kitszel@intel.com&gt;
    > Signed-off-by: Peter Zijlstra (Intel) &lt;peterz@infradead.org&gt;
    > Acked-by: Jonathan Cameron &lt;Jonathan.Cameron@huawei.com&gt;
    > Link: https://lore.kernel.org/r/20241108154258.21411-1-przemyslaw.kitszel@intel.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ spi: spi-fsl-lpspi: Adjust type of scldiv (@Stefan Wahren in [8455230b1ba0df1](https://github.com/sophgo/linux-riscv/commit/8455230b1ba0df1) at 2024-12-14 19:03:38)
    > [ Upstream commit fa8ecda9876ac1e7b29257aa82af1fd0695496e2 ]
    > The target value of scldiv is just a byte, but its calculation in
    > fsl_lpspi_set_bitrate could be negative. So use an adequate type to store
    > the result and avoid overflows. After that this needs range check
    > adjustments, but this should make the code less opaque.
    > Signed-off-by: Stefan Wahren &lt;wahrenst@gmx.net&gt;
    > Reviewed-by: Frank Li &lt;Frank.Li@nxp.com&gt;
    > Link: https://patch.msgid.link/20240930093056.93418-2-wahrenst@gmx.net
    > Signed-off-by: Mark Brown &lt;broonie@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ soc: qcom: llcc: Use designated initializers for LLC settings (@Konrad Dybcio in [46b99cadaef4a6e](https://github.com/sophgo/linux-riscv/commit/46b99cadaef4a6e) at 2024-12-14 19:03:38)
    > [ Upstream commit 20a0a05f40faf82f64f1c2ad3e9f5006b80ca0cb ]
    > The current way of storing the configuration is very much
    > unmaintainable. Convert the data to use designated initializers to make
    > it easier both to understand and add/update the slice configuration
    > data.
    > Signed-off-by: Konrad Dybcio &lt;quic_kdybcio@quicinc.com&gt;
    > Reviewed-by: Dmitry Baryshkov &lt;dmitry.baryshkov@linaro.org&gt;
    > Link: https://lore.kernel.org/r/20240910-topic-llcc_unwrap-v2-1-f0487c983373@quicinc.com
    > Signed-off-by: Bjorn Andersson &lt;andersson@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ gpio: free irqs that are still requested when the chip is being removed (@Bartosz Golaszewski in [3946e07552de0cd](https://github.com/sophgo/linux-riscv/commit/3946e07552de0cd) at 2024-12-14 19:03:38)
    > [ Upstream commit ec8b6f55b98146c41dcf15e8189eb43291e35e89 ]
    > If we remove a GPIO chip that is also an interrupt controller with users
    > not having freed some interrupts, we&#x27;ll end up leaking resources as
    > indicated by the following warning:
    > remove_proc_entry: removing non-empty directory &#x27;irq/30&#x27;, leaking at least &#x27;gpio&#x27;
    > As there&#x27;s no way of notifying interrupt users about the irqchip going
    > away and the interrupt subsystem is not plugged into the driver model and
    > so not all cases can be handled by devlinks, we need to make sure to free
    > all interrupts before the complete the removal of the provider.
    > Reviewed-by: Herve Codina &lt;herve.codina@bootlin.com&gt;
    > Tested-by: Herve Codina &lt;herve.codina@bootlin.com&gt;
    > Link: https://lore.kernel.org/r/20240919135104.3583-1-brgl@bgdev.pl
    > Signed-off-by: Bartosz Golaszewski &lt;bartosz.golaszewski@linaro.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ACPI: x86: Add adev NULL check to acpi_quirk_skip_serdev_enumeration() (@Hans de Goede in [e173bce05f7032a](https://github.com/sophgo/linux-riscv/commit/e173bce05f7032a) at 2024-12-14 19:03:37)
    > [ Upstream commit 4a49194f587a62d972b602e3e1a2c3cfe6567966 ]
    > acpi_dev_hid_match() does not check for adev &#x3D;&#x3D; NULL, dereferencing
    > it unconditional.
    > Add a check for adev being NULL before calling acpi_dev_hid_match().
    > At the moment acpi_quirk_skip_serdev_enumeration() is never called with
    > a controller_parent without an ACPI companion, but better safe than sorry.
    > Signed-off-by: Hans de Goede &lt;hdegoede@redhat.com&gt;
    > Link: https://patch.msgid.link/20241109220028.83047-1-hdegoede@redhat.com
    > Signed-off-by: Rafael J. Wysocki &lt;rafael.j.wysocki@intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ACPI: video: force native for Apple MacbookPro11,2 and Air7,2 (@Jonathan Denose in [94c6fd020081d48](https://github.com/sophgo/linux-riscv/commit/94c6fd020081d48) at 2024-12-14 19:03:37)
    > [ Upstream commit 295991836b23c12ddb447f7f583a17fd3616ad7d ]
    > There is a bug in the Macbook Pro 11,2 and Air 7,2 firmware similar to
    > what is described in:
    > commit 7dc918daaf29 (&quot;ACPI: video: force native for Apple MacbookPro9,2&quot;)
    > This bug causes their backlights not to come back after resume.
    > Add DMI quirks to select the working native Intel firmware interface
    > such that the backlght comes back on after resume.
    > Signed-off-by: Jonathan Denose &lt;jdenose@google.com&gt;
    > Link: https://patch.msgid.link/20241112222516.1.I7fa78e6acbbed56ed5677f5e2dacc098a269d955@changeid
    > [ rjw: Changelog edits ]
    > Signed-off-by: Rafael J. Wysocki &lt;rafael.j.wysocki@intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ kcsan: Turn report_filterlist_lock into a raw_spinlock (@Marco Elver in [889a0d3a35fdedb](https://github.com/sophgo/linux-riscv/commit/889a0d3a35fdedb) at 2024-12-14 19:03:37)
    > [ Upstream commit 59458fa4ddb47e7891c61b4a928d13d5f5b00aa0 ]
    > Ran Xiaokai reports that with a KCSAN-enabled PREEMPT_RT kernel, we can see
    > splats like:
    > | BUG: sleeping function called from invalid context at kernel/locking/spinlock_rt.c:48
    > | in_atomic(): 1, irqs_disabled(): 1, non_block: 0, pid: 0, name: swapper/1
    > | preempt_count: 10002, expected: 0
    > | RCU nest depth: 0, expected: 0
    > | no locks held by swapper/1/0.
    > | irq event stamp: 156674
    > | hardirqs last  enabled at (156673): [&lt;ffffffff81130bd9&gt;] do_idle+0x1f9/0x240
    > | hardirqs last disabled at (156674): [&lt;ffffffff82254f84&gt;] sysvec_apic_timer_interrupt+0x14/0xc0
    > | softirqs last  enabled at (0): [&lt;ffffffff81099f47&gt;] copy_process+0xfc7/0x4b60
    > | softirqs last disabled at (0): [&lt;0000000000000000&gt;] 0x0
    > | Preemption disabled at:
    > | [&lt;ffffffff814a3e2a&gt;] paint_ptr+0x2a/0x90
    > | CPU: 1 UID: 0 PID: 0 Comm: swapper/1 Not tainted 6.11.0+ #3
    > | Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS rel-1.12.0-0-ga698c8995f-prebuilt.qemu.org 04/01/2014
    > | Call Trace:
    > |  &lt;IRQ&gt;
    > |  dump_stack_lvl+0x7e/0xc0
    > |  dump_stack+0x1d/0x30
    > |  __might_resched+0x1a2/0x270
    > |  rt_spin_lock+0x68/0x170
    > |  kcsan_skip_report_debugfs+0x43/0xe0
    > |  print_report+0xb5/0x590
    > |  kcsan_report_known_origin+0x1b1/0x1d0
    > |  kcsan_setup_watchpoint+0x348/0x650
    > |  __tsan_unaligned_write1+0x16d/0x1d0
    > |  hrtimer_interrupt+0x3d6/0x430
    > |  __sysvec_apic_timer_interrupt+0xe8/0x3a0
    > |  sysvec_apic_timer_interrupt+0x97/0xc0
    > |  &lt;/IRQ&gt;
    > On a detected data race, KCSAN&#x27;s reporting logic checks if it should
    > filter the report. That list is protected by the report_filterlist_lock
    > non-raw* spinlock which may sleep on RT kernels.
    > Since KCSAN may report data races in any context, convert it to a
    > raw_spinlock.
    > This requires being careful about when to allocate memory for the filter
    > list itself which can be done via KCSAN&#x27;s debugfs interface. Concurrent
    > modification of the filter list via debugfs should be rare: the chosen
    > strategy is to optimistically pre-allocate memory before the critical
    > section and discard if unused.
    > Link: https://lore.kernel.org/all/20240925143154.2322926-1-ranxiaokai627@163.com/
    > Reported-by: Ran Xiaokai &lt;ran.xiaokai@zte.com.cn&gt;
    > Tested-by: Ran Xiaokai &lt;ran.xiaokai@zte.com.cn&gt;
    > Signed-off-by: Marco Elver &lt;elver@google.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ hwmon: (nct6775) Add 665-ACE/600M-CL to ASUS WMI monitoring list (@Sarah Maedel in [41b92874281e5c9](https://github.com/sophgo/linux-riscv/commit/41b92874281e5c9) at 2024-12-14 19:03:37)
    > [ Upstream commit ccae49e5cf6ebda1a7fa5d2ca99500987c7420c4 ]
    > Boards such as
    > Pro WS 665-ACE
    > Pro WS 600M-CL
    > have got a nct6775 chip, but by default there&#x27;s no use of it
    > because of resource conflict with WMI method.
    > Add affected boards to the WMI monitoring list.
    > Link: https://bugzilla.kernel.org/show_bug.cgi?id&#x3D;204807
    > Co-developed-by: Tommy Giesler &lt;tommy.giesler@hetzner.com&gt;
    > Signed-off-by: Tommy Giesler &lt;tommy.giesler@hetzner.com&gt;
    > Signed-off-by: Sarah Maedel &lt;sarah.maedel@hetzner-cloud.de&gt;
    > Message-ID: &lt;20241018074611.358619-1-sarah.maedel@hetzner-cloud.de&gt;
    > [groeck: Change commit message to imperative mood]
    > Signed-off-by: Guenter Roeck &lt;linux@roeck-us.net&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ACPI: x86: Make UART skip quirks work on PCI UARTs without an UID (@Hans de Goede in [342d91f67051f29](https://github.com/sophgo/linux-riscv/commit/342d91f67051f29) at 2024-12-14 19:03:37)
    > [ Upstream commit 7f261203d7c2e0c06e668b25dfaaee091a79ab25 ]
    > The Vexia EDU ATLA 10 tablet (9V version) which shipped with Android 4.2
    > as factory OS has the usual broken DSDT issues for x86 Android tablets.
    > On top of that this tablet is special because all its LPSS island
    > peripherals are enumerated as PCI devices rather then as ACPI devices as
    > they typically are.
    > For the x86-android-tablets kmod to be able to instantiate a serdev client
    > for the Bluetooth HCI on this tablet, an ACPI_QUIRK_UART1_SKIP quirk is
    > necessary.
    > Modify acpi_dmi_skip_serdev_enumeration() to work with PCI enumerated
    > UARTs without an UID, such as the UARTs on this tablet.
    > Also make acpi_dmi_skip_serdev_enumeration() exit early if there are no
    > quirks, since there is nothing to do then.
    > And add the necessary quirks for the Vexia EDU ATLA 10 tablet.
    > This should compile with CONFIG_PCI being unset without issues because
    > dev_is_pci() is defined as &quot;(false)&quot; then.
    > Signed-off-by: Hans de Goede &lt;hdegoede@redhat.com&gt;
    > Link: https://patch.msgid.link/20241109215936.83004-1-hdegoede@redhat.com
    > Signed-off-by: Rafael J. Wysocki &lt;rafael.j.wysocki@intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ perf/x86/amd: Warn only on new bits set (@Breno Leitao in [1e5b551f8198ffe](https://github.com/sophgo/linux-riscv/commit/1e5b551f8198ffe) at 2024-12-14 19:03:37)
    > [ Upstream commit de20037e1b3c2f2ca97b8c12b8c7bca8abd509a7 ]
    > Warning at every leaking bits can cause a flood of message, triggering
    > various stall-warning mechanisms to fire, including CSD locks, which
    > makes the machine to be unusable.
    > Track the bits that are being leaked, and only warn when a new bit is
    > set.
    > That said, this patch will help with the following issues:
    > 1) It will tell us which bits are being set, so, it is easy to
    > communicate it back to vendor, and to do a root-cause analyzes.
    > 2) It avoid the machine to be unusable, because, worst case
    > scenario, the user gets less than 60 WARNs (one per unhandled bit).
    > Suggested-by: Paul E. McKenney &lt;paulmck@kernel.org&gt;
    > Signed-off-by: Breno Leitao &lt;leitao@debian.org&gt;
    > Signed-off-by: Peter Zijlstra (Intel) &lt;peterz@infradead.org&gt;
    > Reviewed-by: Sandipan Das &lt;sandipan.das@amd.com&gt;
    > Reviewed-by: Paul E. McKenney &lt;paulmck@kernel.org&gt;
    > Link: https://lkml.kernel.org/r/20241001141020.2620361-1-leitao@debian.org
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ crypto: ecdsa - Avoid signed integer overflow on signature decoding (@Lukas Wunner in [c82bb825f9fce23](https://github.com/sophgo/linux-riscv/commit/c82bb825f9fce23) at 2024-12-14 19:03:36)
    > [ Upstream commit 3b0565c703503f832d6cd7ba805aafa3b330cb9d ]
    > When extracting a signature component r or s from an ASN.1-encoded
    > integer, ecdsa_get_signature_rs() subtracts the expected length
    > &quot;bufsize&quot; from the ASN.1 length &quot;vlen&quot; (both of unsigned type size_t)
    > and stores the result in &quot;diff&quot; (of signed type ssize_t).
    > This results in a signed integer overflow if vlen &gt; SSIZE_MAX + bufsize.
    > The kernel is compiled with -fno-strict-overflow, which implies -fwrapv,
    > meaning signed integer overflow is not undefined behavior.  And the
    > function does check for overflow:
    > if (-diff &gt;&#x3D; bufsize)
    > return -EINVAL;
    > So the code is fine in principle but not very obvious.  In the future it
    > might trigger a false-positive with CONFIG_UBSAN_SIGNED_WRAP&#x3D;y.
    > Avoid by comparing the two unsigned variables directly and erroring out
    > if &quot;vlen&quot; is too large.
    > Signed-off-by: Lukas Wunner &lt;lukas@wunner.de&gt;
    > Reviewed-by: Stefan Berger &lt;stefanb@linux.ibm.com&gt;
    > Reviewed-by: Jonathan Cameron &lt;Jonathan.Cameron@huawei.com&gt;
    > Signed-off-by: Herbert Xu &lt;herbert@gondor.apana.org.au&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ext4: partial zero eof block on unaligned inode size extension (@Brian Foster in [b6ce2dbe984bcd7](https://github.com/sophgo/linux-riscv/commit/b6ce2dbe984bcd7) at 2024-12-14 19:03:36)
    > [ Upstream commit c7fc0366c65628fd69bfc310affec4918199aae2 ]
    > Using mapped writes, it&#x27;s technically possible to expose stale
    > post-eof data on a truncate up operation. Consider the following
    > example:
    > $ xfs_io -fc &quot;pwrite 0 2k&quot; -c &quot;mmap 0 4k&quot; -c &quot;mwrite 2k 2k&quot; \
    > -c &quot;truncate 8k&quot; -c &quot;pread -v 2k 16&quot; &lt;file&gt;
    > ...
    > 00000800:  58 58 58 58 58 58 58 58 58 58 58 58 58 58 58 58  XXXXXXXXXXXXXXXX
    > ...
    > This shows that the post-eof data written via mwrite lands within
    > EOF after a truncate up. While this is deliberate of the test case,
    > behavior is somewhat unpredictable because writeback does post-eof
    > zeroing, and writeback can occur at any time in the background. For
    > example, an fsync inserted between the mwrite and truncate causes
    > the subsequent read to instead return zeroes. This basically means
    > that there is a race window in this situation between any subsequent
    > extending operation and writeback that dictates whether post-eof
    > data is exposed to the file or zeroed.
    > To prevent this problem, perform partial block zeroing as part of
    > the various inode size extending operations that are susceptible to
    > it. For truncate extension, zero around the original eof similar to
    > how truncate down does partial zeroing of the new eof. For extension
    > via writes and fallocate related operations, zero the newly exposed
    > range of the file to cover any partial zeroing that must occur at
    > the original and new eof blocks.
    > Signed-off-by: Brian Foster &lt;bfoster@redhat.com&gt;
    > Link: https://patch.msgid.link/20240919160741.208162-2-bfoster@redhat.com
    > Signed-off-by: Theodore Ts&#x27;o &lt;tytso@mit.edu&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ btrfs: don&#x27;t take dev_replace rwsem on task already holding it (@Johannes Thumshirn in [a2e99dcd7aafa9d](https://github.com/sophgo/linux-riscv/commit/a2e99dcd7aafa9d) at 2024-12-14 19:03:36)
    > [ Upstream commit 8cca35cb29f81eba3e96ec44dad8696c8a2f9138 ]
    > Running fstests btrfs/011 with MKFS_OPTIONS&#x3D;&quot;-O rst&quot; to force the usage of
    > the RAID stripe-tree, we get the following splat from lockdep:
    > BTRFS info (device sdd): dev_replace from /dev/sdd (devid 1) to /dev/sdb started
    > &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;
    > WARNING: possible recursive locking detected
    > 6.11.0-rc3-btrfs-for-next #599 Not tainted
    > --------------------------------------------
    > btrfs/2326 is trying to acquire lock:
    > ffff88810f215c98 (&amp;fs_info-&gt;dev_replace.rwsem){++++}-{3:3}, at: btrfs_map_block+0x39f/0x2250
    > but task is already holding lock:
    > ffff88810f215c98 (&amp;fs_info-&gt;dev_replace.rwsem){++++}-{3:3}, at: btrfs_map_block+0x39f/0x2250
    > other info that might help us debug this:
    > Possible unsafe locking scenario:
    > CPU0
    > ----
    > lock(&amp;fs_info-&gt;dev_replace.rwsem);
    > lock(&amp;fs_info-&gt;dev_replace.rwsem);
    > ** DEADLOCK ***
    > May be due to missing lock nesting notation
    > 1 lock held by btrfs/2326:
    > #0: ffff88810f215c98 (&amp;fs_info-&gt;dev_replace.rwsem){++++}-{3:3}, at: btrfs_map_block+0x39f/0x2250
    > stack backtrace:
    > CPU: 1 UID: 0 PID: 2326 Comm: btrfs Not tainted 6.11.0-rc3-btrfs-for-next #599
    > Hardware name: Bochs Bochs, BIOS Bochs 01/01/2011
    > Call Trace:
    > &lt;TASK&gt;
    > dump_stack_lvl+0x5b/0x80
    > __lock_acquire+0x2798/0x69d0
    > ? __pfx___lock_acquire+0x10/0x10
    > ? __pfx___lock_acquire+0x10/0x10
    > lock_acquire+0x19d/0x4a0
    > ? btrfs_map_block+0x39f/0x2250
    > ? __pfx_lock_acquire+0x10/0x10
    > ? find_held_lock+0x2d/0x110
    > ? lock_is_held_type+0x8f/0x100
    > down_read+0x8e/0x440
    > ? btrfs_map_block+0x39f/0x2250
    > ? __pfx_down_read+0x10/0x10
    > ? do_raw_read_unlock+0x44/0x70
    > ? _raw_read_unlock+0x23/0x40
    > btrfs_map_block+0x39f/0x2250
    > ? btrfs_dev_replace_by_ioctl+0xd69/0x1d00
    > ? btrfs_bio_counter_inc_blocked+0xd9/0x2e0
    > ? __kasan_slab_alloc+0x6e/0x70
    > ? __pfx_btrfs_map_block+0x10/0x10
    > ? __pfx_btrfs_bio_counter_inc_blocked+0x10/0x10
    > ? kmem_cache_alloc_noprof+0x1f2/0x300
    > ? mempool_alloc_noprof+0xed/0x2b0
    > btrfs_submit_chunk+0x28d/0x17e0
    > ? __pfx_btrfs_submit_chunk+0x10/0x10
    > ? bvec_alloc+0xd7/0x1b0
    > ? bio_add_folio+0x171/0x270
    > ? __pfx_bio_add_folio+0x10/0x10
    > ? __kasan_check_read+0x20/0x20
    > btrfs_submit_bio+0x37/0x80
    > read_extent_buffer_pages+0x3df/0x6c0
    > btrfs_read_extent_buffer+0x13e/0x5f0
    > read_tree_block+0x81/0xe0
    > read_block_for_search+0x4bd/0x7a0
    > ? __pfx_read_block_for_search+0x10/0x10
    > btrfs_search_slot+0x78d/0x2720
    > ? __pfx_btrfs_search_slot+0x10/0x10
    > ? lock_is_held_type+0x8f/0x100
    > ? kasan_save_track+0x14/0x30
    > ? __kasan_slab_alloc+0x6e/0x70
    > ? kmem_cache_alloc_noprof+0x1f2/0x300
    > btrfs_get_raid_extent_offset+0x181/0x820
    > ? __pfx_lock_acquire+0x10/0x10
    > ? __pfx_btrfs_get_raid_extent_offset+0x10/0x10
    > ? down_read+0x194/0x440
    > ? __pfx_down_read+0x10/0x10
    > ? do_raw_read_unlock+0x44/0x70
    > ? _raw_read_unlock+0x23/0x40
    > btrfs_map_block+0x5b5/0x2250
    > ? __pfx_btrfs_map_block+0x10/0x10
    > scrub_submit_initial_read+0x8fe/0x11b0
    > ? __pfx_scrub_submit_initial_read+0x10/0x10
    > submit_initial_group_read+0x161/0x3a0
    > ? lock_release+0x20e/0x710
    > ? __pfx_submit_initial_group_read+0x10/0x10
    > ? __pfx_lock_release+0x10/0x10
    > scrub_simple_mirror.isra.0+0x3eb/0x580
    > scrub_stripe+0xe4d/0x1440
    > ? lock_release+0x20e/0x710
    > ? __pfx_scrub_stripe+0x10/0x10
    > ? __pfx_lock_release+0x10/0x10
    > ? do_raw_read_unlock+0x44/0x70
    > ? _raw_read_unlock+0x23/0x40
    > scrub_chunk+0x257/0x4a0
    > scrub_enumerate_chunks+0x64c/0xf70
    > ? __mutex_unlock_slowpath+0x147/0x5f0
    > ? __pfx_scrub_enumerate_chunks+0x10/0x10
    > ? bit_wait_timeout+0xb0/0x170
    > ? __up_read+0x189/0x700
    > ? scrub_workers_get+0x231/0x300
    > ? up_write+0x490/0x4f0
    > btrfs_scrub_dev+0x52e/0xcd0
    > ? create_pending_snapshots+0x230/0x250
    > ? __pfx_btrfs_scrub_dev+0x10/0x10
    > btrfs_dev_replace_by_ioctl+0xd69/0x1d00
    > ? lock_acquire+0x19d/0x4a0
    > ? __pfx_btrfs_dev_replace_by_ioctl+0x10/0x10
    > ? lock_release+0x20e/0x710
    > ? btrfs_ioctl+0xa09/0x74f0
    > ? __pfx_lock_release+0x10/0x10
    > ? do_raw_spin_lock+0x11e/0x240
    > ? __pfx_do_raw_spin_lock+0x10/0x10
    > btrfs_ioctl+0xa14/0x74f0
    > ? lock_acquire+0x19d/0x4a0
    > ? find_held_lock+0x2d/0x110
    > ? __pfx_btrfs_ioctl+0x10/0x10
    > ? lock_release+0x20e/0x710
    > ? do_sigaction+0x3f0/0x860
    > ? __pfx_do_vfs_ioctl+0x10/0x10
    > ? do_raw_spin_lock+0x11e/0x240
    > ? lockdep_hardirqs_on_prepare+0x270/0x3e0
    > ? _raw_spin_unlock_irq+0x28/0x50
    > ? do_sigaction+0x3f0/0x860
    > ? __pfx_do_sigaction+0x10/0x10
    > ? __x64_sys_rt_sigaction+0x18e/0x1e0
    > ? __pfx___x64_sys_rt_sigaction+0x10/0x10
    > ? __x64_sys_close+0x7c/0xd0
    > __x64_sys_ioctl+0x137/0x190
    > do_syscall_64+0x71/0x140
    > entry_SYSCALL_64_after_hwframe+0x76/0x7e
    > RIP: 0033:0x7f0bd1114f9b
    > Code: Unable to access opcode bytes at 0x7f0bd1114f71.
    > RSP: 002b:00007ffc8a8c3130 EFLAGS: 00000246 ORIG_RAX: 0000000000000010
    > RAX: ffffffffffffffda RBX: 0000000000000003 RCX: 00007f0bd1114f9b
    > RDX: 00007ffc8a8c35e0 RSI: 00000000ca289435 RDI: 0000000000000003
    > RBP: 0000000000000000 R08: 0000000000000000 R09: 0000000000000007
    > R10: 0000000000000008 R11: 0000000000000246 R12: 00007ffc8a8c6c85
    > R13: 00000000398e72a0 R14: 0000000000004361 R15: 0000000000000004
    > &lt;/TASK&gt;
    > This happens because on RAID stripe-tree filesystems we recurse back into
    > btrfs_map_block() on scrub to perform the logical to device physical
    > mapping.
    > But as the device replace task is already holding the dev_replace::rwsem
    > we deadlock.
    > So don&#x27;t take the dev_replace::rwsem in case our task is the task performing
    > the device replace.
    > Suggested-by: Filipe Manana &lt;fdmanana@suse.com&gt;
    > Signed-off-by: Johannes Thumshirn &lt;johannes.thumshirn@wdc.com&gt;
    > Reviewed-by: Filipe Manana &lt;fdmanana@suse.com&gt;
    > Signed-off-by: David Sterba &lt;dsterba@suse.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ btrfs: avoid unnecessary device path update for the same device (@Qu Wenruo in [73978a9042ce5f9](https://github.com/sophgo/linux-riscv/commit/73978a9042ce5f9) at 2024-12-14 19:03:36)
    > [ Upstream commit 2e8b6bc0ab41ce41e6dfcc204b6cc01d5abbc952 ]
    > [PROBLEM]
    > It is very common for udev to trigger device scan, and every time a
    > mounted btrfs device got re-scan from different soft links, we will get
    > some of unnecessary device path updates, this is especially common
    > for LVM based storage:
    > # lvs
    > scratch1 test -wi-ao---- 10.00g
    > scratch2 test -wi-a----- 10.00g
    > scratch3 test -wi-a----- 10.00g
    > scratch4 test -wi-a----- 10.00g
    > scratch5 test -wi-a----- 10.00g
    > test     test -wi-a----- 10.00g
    > # mkfs.btrfs -f /dev/test/scratch1
    > # mount /dev/test/scratch1 /mnt/btrfs
    > # dmesg -c
    > [  205.705234] BTRFS: device fsid 7be2602f-9e35-4ecf-a6ff-9e91d2c182c9 devid 1 transid 6 /dev/mapper/test-scratch1 (253:4) scanned by mount (1154)
    > [  205.710864] BTRFS info (device dm-4): first mount of filesystem 7be2602f-9e35-4ecf-a6ff-9e91d2c182c9
    > [  205.711923] BTRFS info (device dm-4): using crc32c (crc32c-intel) checksum algorithm
    > [  205.713856] BTRFS info (device dm-4): using free-space-tree
    > [  205.722324] BTRFS info (device dm-4): checking UUID tree
    > So far so good, but even if we just touched any soft link of
    > &quot;dm-4&quot;, we will get quite some unnecessary device path updates.
    > # touch /dev/mapper/test-scratch1
    > # dmesg -c
    > [  469.295796] BTRFS info: devid 1 device path /dev/mapper/test-scratch1 changed to /dev/dm-4 scanned by (udev-worker) (1221)
    > [  469.300494] BTRFS info: devid 1 device path /dev/dm-4 changed to /dev/mapper/test-scratch1 scanned by (udev-worker) (1221)
    > Such device path rename is unnecessary and can lead to random path
    > change due to the udev race.
    > [CAUSE]
    > Inside device_list_add(), we are using a very primitive way checking if
    > the device has changed, strcmp().
    > Which can never handle links well, no matter if it&#x27;s hard or soft links.
    > So every different link of the same device will be treated as a different
    > device, causing the unnecessary device path update.
    > [FIX]
    > Introduce a helper, is_same_device(), and use path_equal() to properly
    > detect the same block device.
    > So that the different soft links won&#x27;t trigger the rename race.
    > Reviewed-by: Filipe Manana &lt;fdmanana@suse.com&gt;
    > Link: https://bugzilla.suse.com/show_bug.cgi?id&#x3D;1230641
    > Reported-by: Fabian Vogt &lt;fvogt@suse.com&gt;
    > Signed-off-by: Qu Wenruo &lt;wqu@suse.com&gt;
    > Signed-off-by: David Sterba &lt;dsterba@suse.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ btrfs: canonicalize the device path before adding it (@Qu Wenruo in [5d261f60b5c82ba](https://github.com/sophgo/linux-riscv/commit/5d261f60b5c82ba) at 2024-12-14 19:03:36)
    > [ Upstream commit 7e06de7c83a746e58d4701e013182af133395188 ]
    > [PROBLEM]
    > Currently btrfs accepts any file path for its device, resulting some
    > weird situation:
    > # ./mount_by_fd /dev/test/scratch1  /mnt/btrfs/
    > The program has the following source code:
    > #include &lt;fcntl.h&gt;
    > #include &lt;stdio.h&gt;
    > #include &lt;sys/mount.h&gt;
    > int main(int argc, char *argv[]) {
    > int fd &#x3D; open(argv[1], O_RDWR);
    > char path[256];
    > snprintf(path, sizeof(path), &quot;/proc/self/fd/%d&quot;, fd);
    > return mount(path, argv[2], &quot;btrfs&quot;, 0, NULL);
    > }
    > Then we can have the following weird device path:
    > BTRFS: device fsid 2378be81-fe12-46d2-a9e8-68cf08dd98d5 devid 1 transid 7 /proc/self/fd/3 (253:2) scanned by mount_by_fd (18440)
    > Normally it&#x27;s not a big deal, and later udev can trigger a device path
    > rename. But if udev didn&#x27;t trigger, the device path &quot;/proc/self/fd/3&quot;
    > will show up in mtab.
    > [CAUSE]
    > For filename &quot;/proc/self/fd/3&quot;, it means the opened file descriptor 3.
    > In above case, it&#x27;s exactly the device we want to open, aka points to
    > &quot;/dev/test/scratch1&quot; which is another symlink pointing to &quot;/dev/dm-2&quot;.
    > Inside kernel we solve the mount source using LOOKUP_FOLLOW, which
    > follows the symbolic link and grab the proper block device.
    > But inside btrfs we also save the filename into btrfs_device::name, and
    > utilize that member to report our mount source, which leads to the above
    > situation.
    > [FIX]
    > Instead of unconditionally trust the path, check if the original file
    > (not following the symbolic link) is inside &quot;/dev/&quot;, if not, then
    > manually lookup the path to its final destination, and use that as our
    > device path.
    > This allows us to still use symbolic links, like
    > &quot;/dev/mapper/test-scratch&quot; from LVM2, which is required for fstests runs
    > with LVM2 setup.
    > And for really weird names, like the above case, we solve it to
    > &quot;/dev/dm-2&quot; instead.
    > Reviewed-by: Filipe Manana &lt;fdmanana@suse.com&gt;
    > Link: https://bugzilla.suse.com/show_bug.cgi?id&#x3D;1230641
    > Reported-by: Fabian Vogt &lt;fvogt@suse.com&gt;
    > Signed-off-by: Qu Wenruo &lt;wqu@suse.com&gt;
    > Signed-off-by: David Sterba &lt;dsterba@suse.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ btrfs: do not clear read-only when adding sprout device (@Boris Burkov in [597d2e04659c3ed](https://github.com/sophgo/linux-riscv/commit/597d2e04659c3ed) at 2024-12-14 19:03:36)
    > [ Upstream commit 70958a949d852cbecc3d46127bf0b24786df0130 ]
    > If you follow the seed/sprout wiki, it suggests the following workflow:
    > btrfstune -S 1 seed_dev
    > mount seed_dev mnt
    > btrfs device add sprout_dev
    > mount -o remount,rw mnt
    > The first mount mounts the FS readonly, which results in not setting
    > BTRFS_FS_OPEN, and setting the readonly bit on the sb. The device add
    > somewhat surprisingly clears the readonly bit on the sb (though the
    > mount is still practically readonly, from the users perspective...).
    > Finally, the remount checks the readonly bit on the sb against the flag
    > and sees no change, so it does not run the code intended to run on
    > ro-&gt;rw transitions, leaving BTRFS_FS_OPEN unset.
    > As a result, when the cleaner_kthread runs, it sees no BTRFS_FS_OPEN and
    > does no work. This results in leaking deleted snapshots until we run out
    > of space.
    > I propose fixing it at the first departure from what feels reasonable:
    > when we clear the readonly bit on the sb during device add.
    > A new fstest I have written reproduces the bug and confirms the fix.
    > Reviewed-by: Qu Wenruo &lt;wqu@suse.com&gt;
    > Signed-off-by: Boris Burkov &lt;boris@bur.io&gt;
    > Signed-off-by: David Sterba &lt;dsterba@suse.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ kselftest/arm64: Don&#x27;t leak pipe fds in pac.exec_sign_all() (@Mark Brown in [2e996ea42ba24fb](https://github.com/sophgo/linux-riscv/commit/2e996ea42ba24fb) at 2024-12-14 19:03:36)
    > [ Upstream commit 27141b690547da5650a420f26ec369ba142a9ebb ]
    > The PAC exec_sign_all() test spawns some child processes, creating pipes
    > to be stdin and stdout for the child. It cleans up most of the file
    > descriptors that are created as part of this but neglects to clean up the
    > parent end of the child stdin and stdout. Add the missing close() calls.
    > Signed-off-by: Mark Brown &lt;broonie@kernel.org&gt;
    > Link: https://lore.kernel.org/r/20241111-arm64-pac-test-collisions-v1-1-171875f37e44@kernel.org
    > Signed-off-by: Catalin Marinas &lt;catalin.marinas@arm.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ s390/pci: Use topology ID for multi-function devices (@Niklas Schnelle in [fbb370c01ef499f](https://github.com/sophgo/linux-riscv/commit/fbb370c01ef499f) at 2024-12-14 19:03:35)
    > [ Upstream commit 126034faaac5f356822c4a9bebfa75664da11056 ]
    > The newly introduced topology ID (TID) field in the CLP Query PCI
    > Function explicitly identifies groups of PCI functions whose RIDs belong
    > to the same (sub-)topology. When available use the TID instead of the
    > PCHID to match zPCI busses/domains for multi-function devices. Note that
    > currently only a single PCI bus per TID is supported. This change is
    > required because in future machines the PCHID will not identify a PCI
    > card but a specific port in the case of some multi-port NICs while from
    > a PCI point of view the entire card is a subtopology.
    > Reviewed-by: Gerd Bayer &lt;gbayer@linux.ibm.com&gt;
    > Signed-off-by: Niklas Schnelle &lt;schnelle@linux.ibm.com&gt;
    > Signed-off-by: Heiko Carstens &lt;hca@linux.ibm.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ epoll: annotate racy check (@Christian Brauner in [d222934627b9a9f](https://github.com/sophgo/linux-riscv/commit/d222934627b9a9f) at 2024-12-14 19:03:35)
    > [ Upstream commit 6474353a5e3d0b2cf610153cea0c61f576a36d0a ]
    > Epoll relies on a racy fastpath check during __fput() in
    > eventpoll_release() to avoid the hit of pointlessly acquiring a
    > semaphore. Annotate that race by using WRITE_ONCE() and READ_ONCE().
    > Link: https://lore.kernel.org/r/66edfb3c.050a0220.3195df.001a.GAE@google.com
    > Link: https://lore.kernel.org/r/20240925-fungieren-anbauen-79b334b00542@brauner
    > Reviewed-by: Jan Kara &lt;jack@suse.cz&gt;
    > Reported-by: syzbot+3b6b32dc50537a49bb4a@syzkaller.appspotmail.com
    > Signed-off-by: Christian Brauner &lt;brauner@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ s390/cpum_sf: Handle CPU hotplug remove during sampling (@Thomas Richter in [be54e6e0f93a39a](https://github.com/sophgo/linux-riscv/commit/be54e6e0f93a39a) at 2024-12-14 19:03:35)
    > [ Upstream commit a0bd7dacbd51c632b8e2c0500b479af564afadf3 ]
    > CPU hotplug remove handling triggers the following function
    > call sequence:
    > CPUHP_AP_PERF_S390_SF_ONLINE  --&gt; s390_pmu_sf_offline_cpu()
    > ...
    > CPUHP_AP_PERF_ONLINE          --&gt; perf_event_exit_cpu()
    > The s390 CPUMF sampling CPU hotplug handler invokes:
    > s390_pmu_sf_offline_cpu()
    > +--&gt;  cpusf_pmu_setup()
    > +--&gt; setup_pmc_cpu()
    > +--&gt; deallocate_buffers()
    > This function de-allocates all sampling data buffers (SDBs) allocated
    > for that CPU at event initialization. It also clears the
    > PMU_F_RESERVED bit. The CPU is gone and can not be sampled.
    > With the event still being active on the removed CPU, the CPU event
    > hotplug support in kernel performance subsystem triggers the
    > following function calls on the removed CPU:
    > perf_event_exit_cpu()
    > +--&gt; perf_event_exit_cpu_context()
    > +--&gt; __perf_event_exit_context()
    > +--&gt; __perf_remove_from_context()
    > +--&gt; event_sched_out()
    > +--&gt; cpumsf_pmu_del()
    > +--&gt; cpumsf_pmu_stop()
    > +--&gt; hw_perf_event_update()
    > to stop and remove the event. During removal of the event, the
    > sampling device driver tries to read out the remaining samples from
    > the sample data buffers (SDBs). But they have already been freed
    > (and may have been re-assigned). This may lead to a use after free
    > situation in which case the samples are most likely invalid. In the
    > best case the memory has not been reassigned and still contains
    > valid data.
    > Remedy this situation and check if the CPU is still in reserved
    > state (bit PMU_F_RESERVED set). In this case the SDBs have not been
    > released an contain valid data. This is always the case when
    > the event is removed (and no CPU hotplug off occured).
    > If the PMU_F_RESERVED bit is not set, the SDB buffers are gone.
    > Signed-off-by: Thomas Richter &lt;tmricht@linux.ibm.com&gt;
    > Reviewed-by: Hendrik Brueckner &lt;brueckner@linux.ibm.com&gt;
    > Signed-off-by: Heiko Carstens &lt;hca@linux.ibm.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ block: RCU protect disk-&gt;conv_zones_bitmap (@Damien Le Moal in [493326c4f10cc71](https://github.com/sophgo/linux-riscv/commit/493326c4f10cc71) at 2024-12-14 19:03:35)
    > [ Upstream commit d7cb6d7414ea1b33536fa6d11805cb8dceec1f97 ]
    > Ensure that a disk revalidation changing the conventional zones bitmap
    > of a disk does not cause invalid memory references when using the
    > disk_zone_is_conv() helper by RCU protecting the disk-&gt;conv_zones_bitmap
    > pointer.
    > disk_zone_is_conv() is modified to operate under the RCU read lock and
    > the function disk_set_conv_zones_bitmap() is added to update a disk
    > conv_zones_bitmap pointer using rcu_replace_pointer() with the disk
    > zone_wplugs_lock spinlock held.
    > disk_free_zone_resources() is modified to call
    > disk_update_zone_resources() with a NULL bitmap pointer to free the disk
    > conv_zones_bitmap. disk_set_conv_zones_bitmap() is also used in
    > disk_update_zone_resources() to set the new (revalidated) bitmap and
    > free the old one.
    > Signed-off-by: Damien Le Moal &lt;dlemoal@kernel.org&gt;
    > Reviewed-by: Christoph Hellwig &lt;hch@lst.de&gt;
    > Reviewed-by: Johannes Thumshirn &lt;johannes.thumshirn@wdc.com&gt;
    > Link: https://lore.kernel.org/r/20241107064300.227731-2-dlemoal@kernel.org
    > Signed-off-by: Jens Axboe &lt;axboe@kernel.dk&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ s390/pci: Ignore RID for isolated VFs (@Niklas Schnelle in [23a63cf560a5b3c](https://github.com/sophgo/linux-riscv/commit/23a63cf560a5b3c) at 2024-12-14 19:03:35)
    > [ Upstream commit 25f39d3dcb48bbc824a77d16b3d977f0f3713cfe ]
    > Ensure that VFs used in isolation, that is with their parent PF not
    > visible to the configuration but with their RID exposed, are treated
    > compatibly with existing isolated VF use cases without exposed RID
    > including RoCE Express VFs. This allows creating configurations where
    > one LPAR manages PFs while their child VFs are used by other LPARs. This
    > gives the LPAR managing the PFs a role analogous to that of the
    > hypervisor in a typical use case of passing child VFs to guests.
    > Instead of creating a multifunction struct zpci_bus whenever a PCI
    > function with RID exposed is discovered only create such a bus for
    > configured physical functions and only consider multifunction busses
    > when searching for an existing bus. Additionally only set zdev-&gt;devfn to
    > the devfn part of the RID once the function is added to a multifunction
    > bus.
    > This also fixes probing of more than 7 such isolated VFs from the same
    > physical bus. This is because common PCI code in pci_scan_slot() only
    > looks for more functions when pdev-&gt;multifunction is set which somewhat
    > counter intutively is not the case for VFs.
    > Note that PFs are looked at before their child VFs is guaranteed because
    > we sort the zpci_list by RID ascending.
    > Reviewed-by: Gerd Bayer &lt;gbayer@linux.ibm.com&gt;
    > Signed-off-by: Niklas Schnelle &lt;schnelle@linux.ibm.com&gt;
    > Signed-off-by: Heiko Carstens &lt;hca@linux.ibm.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ kselftest/arm64: Log fp-stress child startup errors to stdout (@Mark Brown in [14cf8e7be1772f6](https://github.com/sophgo/linux-riscv/commit/14cf8e7be1772f6) at 2024-12-14 19:03:35)
    > [ Upstream commit dca93d29845dfed60910ba13dbfb6ae6a0e19f6d ]
    > Currently if we encounter an error between fork() and exec() of a child
    > process we log the error to stderr. This means that the errors don&#x27;t get
    > annotated with the child information which makes diagnostics harder and
    > means that if we miss the exit signal from the child we can deadlock
    > waiting for output from the child. Improve robustness and output quality
    > by logging to stdout instead.
    > Signed-off-by: Mark Brown &lt;broonie@kernel.org&gt;
    > Link: https://lore.kernel.org/r/20241023-arm64-fp-stress-exec-fail-v1-1-ee3c62932c15@kernel.org
    > Signed-off-by: Catalin Marinas &lt;catalin.marinas@arm.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ mm: respect mmap hint address when aligning for THP (@Kalesh Singh in [fe1a34e92a83fff](https://github.com/sophgo/linux-riscv/commit/fe1a34e92a83fff) at 2024-12-14 19:03:34)
    > commit 249608ee47132cab3b1adacd9e463548f57bd316 upstream.
    > Commit efa7df3e3bb5 (&quot;mm: align larger anonymous mappings on THP
    > boundaries&quot;) updated __get_unmapped_area() to align the start address for
    > the VMA to a PMD boundary if CONFIG_TRANSPARENT_HUGEPAGE&#x3D;y.
    > It does this by effectively looking up a region that is of size,
    > request_size + PMD_SIZE, and aligning up the start to a PMD boundary.
    > Commit 4ef9ad19e176 (&quot;mm: huge_memory: don&#x27;t force huge page alignment on
    > 32 bit&quot;) opted out of this for 32bit due to regressions in mmap base
    > randomization.
    > Commit d4148aeab412 (&quot;mm, mmap: limit THP alignment of anonymous mappings
    > to PMD-aligned sizes&quot;) restricted this to only mmap sizes that are
    > multiples of the PMD_SIZE due to reported regressions in some performance
    > benchmarks -- which seemed mostly due to the reduced spatial locality of
    > related mappings due to the forced PMD-alignment.
    > Another unintended side effect has emerged: When a user specifies an mmap
    > hint address, the THP alignment logic modifies the behavior, potentially
    > ignoring the hint even if a sufficiently large gap exists at the requested
    > hint location.
    > Example Scenario:
    > Consider the following simplified virtual address (VA) space:
    > ...
    > 0x200000-0x400000 --- VMA A
    > 0x400000-0x600000 --- Hole
    > 0x600000-0x800000 --- VMA B
    > ...
    > A call to mmap() with hint&#x3D;0x400000 and len&#x3D;0x200000 behaves differently:
    > - Before THP alignment: The requested region (size 0x200000) fits into
    > the gap at 0x400000, so the hint is respected.
    > - After alignment: The logic searches for a region of size
    > 0x400000 (len + PMD_SIZE) starting at 0x400000.
    > This search fails due to the mapping at 0x600000 (VMA B), and the hint
    > is ignored, falling back to arch_get_unmapped_area[_topdown]().
    > In general the hint is effectively ignored, if there is any existing
    > mapping in the below range:
    > [mmap_hint + mmap_size, mmap_hint + mmap_size + PMD_SIZE)
    > This changes the semantics of mmap hint; from &quot;&quot;Respect the hint if a
    > sufficiently large gap exists at the requested location&quot; to &quot;Respect the
    > hint only if an additional PMD-sized gap exists beyond the requested
    > size&quot;.
    > This has performance implications for allocators that allocate their heap
    > using mmap but try to keep it &quot;as contiguous as possible&quot; by using the end
    > of the exisiting heap as the address hint.  With the new behavior it&#x27;s
    > more likely to get a much less contiguous heap, adding extra fragmentation
    > and performance overhead.
    > To restore the expected behavior; don&#x27;t use
    > thp_get_unmapped_area_vmflags() when the user provided a hint address, for
    > anonymous mappings.
    > Note: As Yang Shi pointed out: the issue still remains for filesystems
    > which are using thp_get_unmapped_area() for their get_unmapped_area() op.
    > It is unclear what worklaods will regress for if we ignore THP alignment
    > when the hint address is provided for such file backed mappings -- so this
    > fix will be handled separately.
    > Link: https://lkml.kernel.org/r/20241118214650.3667577-1-kaleshsingh@google.com
    > Fixes: efa7df3e3bb5 (&quot;mm: align larger anonymous mappings on THP boundaries&quot;)
    > Signed-off-by: Kalesh Singh &lt;kaleshsingh@google.com&gt;
    > Reviewed-by: Rik van Riel &lt;riel@surriel.com&gt;
    > Reviewed-by: Vlastimil Babka &lt;vbabka@suse.cz&gt;
    > Reviewed-by: David Hildenbrand &lt;david@redhat.com&gt;
    > Cc: Kefeng Wang &lt;wangkefeng.wang@huawei.com&gt;
    > Cc: Vlastimil Babka &lt;vbabka@suse.cz&gt;
    > Cc: Yang Shi &lt;yang@os.amperecomputing.com&gt;
    > Cc: Rik van Riel &lt;riel@surriel.com&gt;
    > Cc: Ryan Roberts &lt;ryan.roberts@arm.com&gt;
    > Cc: Suren Baghdasaryan &lt;surenb@google.com&gt;
    > Cc: Minchan Kim &lt;minchan@kernel.org&gt;
    > Cc: Hans Boehm &lt;hboehm@google.com&gt;
    > Cc: Lokesh Gidra &lt;lokeshgidra@google.com&gt;
    > Cc: &lt;stable@vger.kernel.org&gt;
    > Signed-off-by: Andrew Morton &lt;akpm@linux-foundation.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ rust: enable arbitrary_self_types and remove &#x60;Receiver&#x60; (@Gary Guo in [e18d5b42489311b](https://github.com/sophgo/linux-riscv/commit/e18d5b42489311b) at 2024-12-14 19:03:34)
    > commit c95bbb59a9b22f9b838b15d28319185c1c884329 upstream.
    > The term &quot;receiver&quot; means that a type can be used as the type of &#x60;self&#x60;,
    > and thus enables method call syntax &#x60;foo.bar()&#x60; instead of
    > &#x60;Foo::bar(foo)&#x60;. Stable Rust as of today (1.81) enables a limited
    > selection of types (primitives and types in std, e.g. &#x60;Box&#x60; and &#x60;Arc&#x60;)
    > to be used as receivers, while custom types cannot.
    > We want the kernel &#x60;Arc&#x60; type to have the same functionality as the Rust
    > std &#x60;Arc&#x60;, so we use the &#x60;Receiver&#x60; trait (gated behind &#x60;receiver_trait&#x60;
    > unstable feature) to gain the functionality.
    > The &#x60;arbitrary_self_types&#x60; RFC [1] (tracking issue [2]) is accepted and
    > it will allow all types that implement a new &#x60;Receiver&#x60; trait (different
    > from today&#x27;s unstable trait) to be used as receivers. This trait will be
    > automatically implemented for all &#x60;Deref&#x60; types, which include our &#x60;Arc&#x60;
    > type, so we no longer have to opt-in to be used as receiver. To prepare
    > us for the change, remove the &#x60;Receiver&#x60; implementation and the
    > associated feature. To still allow &#x60;Arc&#x60; and others to be used as method
    > receivers, turn on &#x60;arbitrary_self_types&#x60; feature instead.
    > This feature gate is introduced in 1.23.0. It used to enable both
    > &#x60;Deref&#x60; types and raw pointer types to be used as receivers, but the
    > latter is now split into a different feature gate in Rust 1.83 nightly.
    > We do not need receivers on raw pointers so this change would not affect
    > us and usage of &#x60;arbitrary_self_types&#x60; feature would work for all Rust
    > versions that we support (&gt;&#x3D;1.78).
    > Cc: Adrian Taylor &lt;ade@hohum.me.uk&gt;
    > Link: https://github.com/rust-lang/rfcs/pull/3519 [1]
    > Link: https://github.com/rust-lang/rust/issues/44874 [2]
    > Signed-off-by: Gary Guo &lt;gary@garyguo.net&gt;
    > Reviewed-by: Benno Lossin &lt;benno.lossin@proton.me&gt;
    > Reviewed-by: Alice Ryhl &lt;aliceryhl@google.com&gt;
    > Link: https://lore.kernel.org/r/20240915132734.1653004-1-gary@garyguo.net
    > Signed-off-by: Miguel Ojeda &lt;ojeda@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ scsi: ufs: pltfrm: Drop PM runtime reference count after ufshcd_remove() (@Manivannan Sadhasivam in [5c63e24b1bb7ded](https://github.com/sophgo/linux-riscv/commit/5c63e24b1bb7ded) at 2024-12-14 19:03:34)
    > commit 1745dcdb7227102e16248a324c600b9121c8f6df upstream.
    > During the remove stage of glue drivers, some of them are incrementing the
    > reference count using pm_runtime_get_sync(), before removing the ufshcd
    > using ufshcd_remove(). But they are not dropping that reference count after
    > ufshcd_remove() to balance the refcount.
    > So drop the reference count by calling pm_runtime_put_noidle() after
    > ufshcd_remove(). Since the behavior is applicable to all glue drivers, move
    > the PM handling to ufshcd_pltfrm_remove().
    > Cc: stable@vger.kernel.org # 3.12
    > Fixes: 62694735ca95 (&quot;[SCSI] ufs: Add runtime PM support for UFS host controller driver&quot;)
    > Signed-off-by: Manivannan Sadhasivam &lt;manivannan.sadhasivam@linaro.org&gt;
    > Link: https://lore.kernel.org/r/20241111-ufs_bug_fix-v1-4-45ad8b62f02e@linaro.org
    > Reviewed-by: Peter Wang &lt;peter.wang@mediatek.com&gt;
    > Reviewed-by: Bean Huo &lt;beanhuo@micron.com&gt;
    > Reviewed-by: Bart Van Assche &lt;bvanassche@acm.org&gt;
    > Signed-off-by: Martin K. Petersen &lt;martin.petersen@oracle.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ mm: fix vrealloc()&#x27;s KASAN poisoning logic (@Andrii Nakryiko in [536ffb4014422a7](https://github.com/sophgo/linux-riscv/commit/536ffb4014422a7) at 2024-12-14 19:03:34)
    > commit d699440f58ce9bd71103cc7b692e3ab76a20bfcd upstream.
    > When vrealloc() reuses already allocated vmap_area, we need to re-annotate
    > poisoned and unpoisoned portions of underlying memory according to the new
    > size.
    > This results in a KASAN splat recorded at [1].  A KASAN mis-reporting
    > issue where there is none.
    > Note, hard-coding KASAN_VMALLOC_PROT_NORMAL might not be exactly correct,
    > but KASAN flag logic is pretty involved and spread out throughout
    > __vmalloc_node_range_noprof(), so I&#x27;m using the bare minimum flag here and
    > leaving the rest to mm people to refactor this logic and reuse it here.
    > Link: https://lkml.kernel.org/r/20241126005206.3457974-1-andrii@kernel.org
    > Link: https://lore.kernel.org/bpf/67450f9b.050a0220.21d33d.0004.GAE@google.com/ [1]
    > Fixes: 3ddc2fefe6f3 (&quot;mm: vmalloc: implement vrealloc()&quot;)
    > Signed-off-by: Andrii Nakryiko &lt;andrii@kernel.org&gt;
    > Cc: Alexei Starovoitov &lt;ast@kernel.org&gt;
    > Cc: Christoph Hellwig &lt;hch@infradead.org&gt;
    > Cc: Michal Hocko &lt;mhocko@suse.com&gt;
    > Cc: Uladzislau Rezki (Sony) &lt;urezki@gmail.com&gt;
    > Cc: Vlastimil Babka &lt;vbabka@suse.cz&gt;
    > Cc: &lt;stable@vger.kernel.org&gt;
    > Signed-off-by: Andrew Morton &lt;akpm@linux-foundation.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ memblock: allow zero threshold in validate_numa_converage() (@Mike Rapoport (Microsoft) in [2cec2d916a7dbf0](https://github.com/sophgo/linux-riscv/commit/2cec2d916a7dbf0) at 2024-12-14 19:03:34)
    > commit 9cdc6423acb49055efb444ecd895d853a70ef931 upstream.
    > Currently memblock validate_numa_converage() returns false negative when
    > threshold set to zero.
    > Make the check if the memory size with invalid node ID is greater than
    > the threshold exclusive to fix that.
    > Link: https://lore.kernel.org/all/Z0mIDBD4KLyxyOCm@kernel.org/
    > Signed-off-by: Mike Rapoport (Microsoft) &lt;rppt@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ s390/pci: Sort PCI functions prior to creating virtual busses (@Niklas Schnelle in [1f3b309108fd066](https://github.com/sophgo/linux-riscv/commit/1f3b309108fd066) at 2024-12-14 19:03:34)
    > [ Upstream commit 0467cdde8c4320bbfdb31a8cff1277b202f677fc ]
    > Instead of relying on the observed but not architected firmware behavior
    > that PCI functions from the same card are listed in ascending RID order
    > in clp_list_pci() ensure this by sorting. To allow for sorting separate
    > the initial clp_list_pci() and creation of the virtual PCI busses.
    > Note that fundamentally in our per-PCI function hotplug design non RID
    > order of discovery is still possible. For example when the two PFs of
    > a two port NIC are hotplugged after initial boot and in descending RID
    > order. In this case the virtual PCI bus would be created by the second
    > PF using that PF&#x27;s UID as domain number instead of that of the first PF.
    > Thus the domain number would then change from the UID of the second PF
    > to that of the first PF on reboot but there is really nothing we can do
    > about that since changing domain numbers at runtime seems even worse.
    > This only impacts the domain number as the RIDs are consistent and thus
    > even with just the second PF visible it will show up in the correct
    > position on the virtual bus.
    > Reviewed-by: Gerd Bayer &lt;gbayer@linux.ibm.com&gt;
    > Signed-off-by: Niklas Schnelle &lt;schnelle@linux.ibm.com&gt;
    > Signed-off-by: Heiko Carstens &lt;hca@linux.ibm.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ mm/damon: fix order of arguments in damos_before_apply tracepoint (@Akinobu Mita in [e4c59f343800507](https://github.com/sophgo/linux-riscv/commit/e4c59f343800507) at 2024-12-14 19:03:33)
    > commit 6535b8669c1a74078098517174e53fc907ce9d56 upstream.
    > Since the order of the scheme_idx and target_idx arguments in TP_ARGS is
    > reversed, they are stored in the trace record in reverse.
    > Link: https://lkml.kernel.org/r/20241115182023.43118-1-sj@kernel.org
    > Link: https://patch.msgid.link/20241112154828.40307-1-akinobu.mita@gmail.com
    > Fixes: c603c630b509 (&quot;mm/damon/core: add a tracepoint for damos apply target regions&quot;)
    > Signed-off-by: Akinobu Mita &lt;akinobu.mita@gmail.com&gt;
    > Signed-off-by: SeongJae Park &lt;sj@kernel.org&gt;
    > Cc: Masami Hiramatsu &lt;mhiramat@kernel.org&gt;
    > Cc: Mathieu Desnoyers &lt;mathieu.desnoyers@efficios.com&gt;
    > Cc: Steven Rostedt &lt;rostedt@goodmis.org&gt;
    > Cc: &lt;stable@vger.kernel.org&gt;
    > Signed-off-by: Andrew Morton &lt;akpm@linux-foundation.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ mm: open-code page_folio() in dump_page() (@Matthew Wilcox (Oracle) in [bd4d2333a3c5a30](https://github.com/sophgo/linux-riscv/commit/bd4d2333a3c5a30) at 2024-12-14 19:03:33)
    > commit 6a7de1bf218d75f27f68d6a3f5ae1eb7332b941e upstream.
    > page_folio() calls page_fixed_fake_head() which will misidentify this page
    > as being a fake head and load off the end of &#x27;precise&#x27;.  We may have a
    > pointer to a fake head, but that&#x27;s OK because it contains the right
    > information for dump_page().
    > gcc-15 is smart enough to catch this with -Warray-bounds:
    > In function &#x27;page_fixed_fake_head&#x27;,
    > inlined from &#x27;_compound_head&#x27; at ../include/linux/page-flags.h:251:24,
    > inlined from &#x27;__dump_page&#x27; at ../mm/debug.c:123:11:
    > ../include/asm-generic/rwonce.h:44:26: warning: array subscript 9 is outside
    > +array bounds of &#x27;struct page[1]&#x27; [-Warray-bounds&#x3D;]
    > Link: https://lkml.kernel.org/r/20241125201721.2963278-2-willy@infradead.org
    > Fixes: fae7d834c43c (&quot;mm: add __dump_folio()&quot;)
    > Signed-off-by: Matthew Wilcox (Oracle) &lt;willy@infradead.org&gt;
    > Reported-by: Kees Cook &lt;kees@kernel.org&gt;
    > Cc: &lt;stable@vger.kernel.org&gt;
    > Signed-off-by: Andrew Morton &lt;akpm@linux-foundation.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ mm: memcg: declare do_memsw_account inline (@John Sperbeck in [35e8f9125d3c7c8](https://github.com/sophgo/linux-riscv/commit/35e8f9125d3c7c8) at 2024-12-14 19:03:33)
    > commit 89dd878282881306c38f7e354e7614fca98cb9a6 upstream.
    > In commit 66d60c428b23 (&quot;mm: memcg: move legacy memcg event code into
    > memcontrol-v1.c&quot;), the static do_memsw_account() function was moved from a
    > .c file to a .h file.  Unfortunately, the traditional inline keyword
    > wasn&#x27;t added.  If a file (e.g., a unit test) includes the .h file, but
    > doesn&#x27;t refer to do_memsw_account(), it will get a warning like:
    > mm/memcontrol-v1.h:41:13: warning: unused function &#x27;do_memsw_account&#x27; [-Wunused-function]
    > 41 | static bool do_memsw_account(void)
    > |             ^~~~~~~~~~~~~~~~
    > Link: https://lkml.kernel.org/r/20241128203959.726527-1-jsperbeck@google.com
    > Fixes: 66d60c428b23 (&quot;mm: memcg: move legacy memcg event code into memcontrol-v1.c&quot;)
    > Signed-off-by: John Sperbeck &lt;jsperbeck@google.com&gt;
    > Acked-by: Roman Gushchin &lt;roman.gushchin@linux.dev&gt;
    > Cc: Johannes Weiner &lt;hannes@cmpxchg.org&gt;
    > Cc: Michal Hocko &lt;mhocko@kernel.org&gt;
    > Cc: Muchun Song &lt;muchun.song@linux.dev&gt;
    > Cc: Shakeel Butt &lt;shakeel.butt@linux.dev&gt;
    > Cc: &lt;stable@vger.kernel.org&gt;
    > Signed-off-by: Andrew Morton &lt;akpm@linux-foundation.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ x86/mm: Add _PAGE_NOPTISHADOW bit to avoid updating userspace page tables (@David Woodhouse in [34b7abe40fa978d](https://github.com/sophgo/linux-riscv/commit/34b7abe40fa978d) at 2024-12-14 19:03:33)
    > commit d0ceea662d459726487030237689835fcc0483e5 upstream.
    > The set_p4d() and set_pgd() functions (in 4-level or 5-level page table setups
    > respectively) assume that the root page table is actually a 8KiB allocation,
    > with the userspace root immediately after the kernel root page table (so that
    > the former can enforce NX on on all the subordinate page tables, which are
    > actually shared).
    > However, users of the kernel_ident_mapping_init() code do not give it an 8KiB
    > allocation for its PGD. Both swsusp_arch_resume() and acpi_mp_setup_reset()
    > allocate only a single 4KiB page. The kexec code on x86_64 currently gets
    > away with it purely by chance, because it allocates 8KiB for its &quot;control
    > code page&quot; and then actually uses the first half for the PGD, then copies the
    > actual trampoline code into the second half only after the identmap code has
    > finished scribbling over it.
    > Fix this by defining a _PAGE_NOPTISHADOW bit (which can use the same bit as
    > _PAGE_SAVED_DIRTY since one is only for the PGD/P4D root and the other is
    > exclusively for leaf PTEs.). This instructs __pti_set_user_pgtbl() not to
    > write to the userspace &#x27;shadow&#x27; PGD.
    > Strictly, the _PAGE_NOPTISHADOW bit doesn&#x27;t need to be written out to the
    > actual page tables; since __pti_set_user_pgtbl() returns the value to be
    > written to the kernel page table, it could be filtered out. But there seems
    > to be no benefit to actually doing so.
    > Suggested-by: Dave Hansen &lt;dave.hansen@intel.com&gt;
    > Signed-off-by: David Woodhouse &lt;dwmw@amazon.co.uk&gt;
    > Signed-off-by: Ingo Molnar &lt;mingo@kernel.org&gt;
    > Link: https://lore.kernel.org/r/412c90a4df7aef077141d9f68d19cbe5602d6c6d.camel@infradead.org
    > Cc: stable@kernel.org
    > Cc: Linus Torvalds &lt;torvalds@linux-foundation.org&gt;
    > Cc: Andy Lutomirski &lt;luto@kernel.org&gt;
    > Cc: Peter Zijlstra &lt;peterz@infradead.org&gt;
    > Cc: Rik van Riel &lt;riel@surriel.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ mm: open-code PageTail in folio_flags() and const_folio_flags() (@Matthew Wilcox (Oracle) in [1dde3fde62b7cdb](https://github.com/sophgo/linux-riscv/commit/1dde3fde62b7cdb) at 2024-12-14 19:03:33)
    > commit 4de22b2a6a7477d84d9a01eb6b62a9117309d722 upstream.
    > It is unsafe to call PageTail() in dump_page() as page_is_fake_head() will
    > almost certainly return true when called on a head page that is copied to
    > the stack.  That will cause the VM_BUG_ON_PGFLAGS() in const_folio_flags()
    > to trigger when it shouldn&#x27;t.  Fortunately, we don&#x27;t need to call
    > PageTail() here; it&#x27;s fine to have a pointer to a virtual alias of the
    > page&#x27;s flag word rather than the real page&#x27;s flag word.
    > Link: https://lkml.kernel.org/r/20241125201721.2963278-1-willy@infradead.org
    > Fixes: fae7d834c43c (&quot;mm: add __dump_folio()&quot;)
    > Signed-off-by: Matthew Wilcox (Oracle) &lt;willy@infradead.org&gt;
    > Cc: Kees Cook &lt;kees@kernel.org&gt;
    > Cc: &lt;stable@vger.kernel.org&gt;
    > Signed-off-by: Andrew Morton &lt;akpm@linux-foundation.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ x86/cpu/topology: Remove limit of CPUs due to disabled IO/APIC (@Fernando Fernandez Mancera in [0214a12832e8c87](https://github.com/sophgo/linux-riscv/commit/0214a12832e8c87) at 2024-12-14 19:03:33)
    > commit 73da582a476ea6e3512f89f8ed57dfed945829a2 upstream.
    > The rework of possible CPUs management erroneously disabled SMP when the
    > IO/APIC is disabled either by the &#x27;noapic&#x27; command line parameter or during
    > IO/APIC setup. SMP is possible without IO/APIC.
    > Remove the ioapic_is_disabled conditions from the relevant possible CPU
    > management code paths to restore the orgininal behaviour.
    > Fixes: 7c0edad3643f (&quot;x86/cpu/topology: Rework possible CPU management&quot;)
    > Signed-off-by: Fernando Fernandez Mancera &lt;ffmancera@riseup.net&gt;
    > Signed-off-by: Thomas Gleixner &lt;tglx@linutronix.de&gt;
    > Cc: stable@vger.kernel.org
    > Link: https://lore.kernel.org/all/20241202145905.1482-1-ffmancera@riseup.net
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ sched/numa: fix memory leak due to the overwritten vma-&gt;numab_state (@Adrian Huang in [a71ddd5b87cda68](https://github.com/sophgo/linux-riscv/commit/a71ddd5b87cda68) at 2024-12-14 19:03:32)
    > commit 5f1b64e9a9b7ee9cfd32c6b2fab796e29bfed075 upstream.
    > [Problem Description]
    > When running the hackbench program of LTP, the following memory leak is
    > reported by kmemleak.
    > # /opt/ltp/testcases/bin/hackbench 20 thread 1000
    > Running with 20*40 (&#x3D;&#x3D; 800) tasks.
    > # dmesg | grep kmemleak
    > ...
    > kmemleak: 480 new suspected memory leaks (see /sys/kernel/debug/kmemleak)
    > kmemleak: 665 new suspected memory leaks (see /sys/kernel/debug/kmemleak)
    > # cat /sys/kernel/debug/kmemleak
    > unreferenced object 0xffff888cd8ca2c40 (size 64):
    > comm &quot;hackbench&quot;, pid 17142, jiffies 4299780315
    > hex dump (first 32 bytes):
    > ac 74 49 00 01 00 00 00 4c 84 49 00 01 00 00 00  .tI.....L.I.....
    > 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
    > backtrace (crc bff18fd4):
    > [&lt;ffffffff81419a89&gt;] __kmalloc_cache_noprof+0x2f9/0x3f0
    > [&lt;ffffffff8113f715&gt;] task_numa_work+0x725/0xa00
    > [&lt;ffffffff8110f878&gt;] task_work_run+0x58/0x90
    > [&lt;ffffffff81ddd9f8&gt;] syscall_exit_to_user_mode+0x1c8/0x1e0
    > [&lt;ffffffff81dd78d5&gt;] do_syscall_64+0x85/0x150
    > [&lt;ffffffff81e0012b&gt;] entry_SYSCALL_64_after_hwframe+0x76/0x7e
    > ...
    > This issue can be consistently reproduced on three different servers:
    > a 448-core server
    > a 256-core server
    > a 192-core server
    > [Root Cause]
    > Since multiple threads are created by the hackbench program (along with
    > the command argument &#x27;thread&#x27;), a shared vma might be accessed by two or
    > more cores simultaneously. When two or more cores observe that
    > vma-&gt;numab_state is NULL at the same time, vma-&gt;numab_state will be
    > overwritten.
    > Although current code ensures that only one thread scans the VMAs in a
    > single &#x27;numa_scan_period&#x27;, there might be a chance for another thread
    > to enter in the next &#x27;numa_scan_period&#x27; while we have not gotten till
    > numab_state allocation [1].
    > Note that the command &#x60;/opt/ltp/testcases/bin/hackbench 50 process 1000&#x60;
    > cannot the reproduce the issue. It is verified with 200+ test runs.
    > [Solution]
    > Use the cmpxchg atomic operation to ensure that only one thread executes
    > the vma-&gt;numab_state assignment.
    > [1] https://lore.kernel.org/lkml/1794be3c-358c-4cdc-a43d-a1f841d91ef7@amd.com/
    > Link: https://lkml.kernel.org/r/20241113102146.2384-1-ahuang12@lenovo.com
    > Fixes: ef6a22b70f6d (&quot;sched/numa: apply the scan delay to every new vma&quot;)
    > Signed-off-by: Adrian Huang &lt;ahuang12@lenovo.com&gt;
    > Reported-by: Jiwei Sun &lt;sunjw10@lenovo.com&gt;
    > Reviewed-by: Raghavendra K T &lt;raghavendra.kt@amd.com&gt;
    > Reviewed-by: Vlastimil Babka &lt;vbabka@suse.cz&gt;
    > Cc: Ben Segall &lt;bsegall@google.com&gt;
    > Cc: Dietmar Eggemann &lt;dietmar.eggemann@arm.com&gt;
    > Cc: Ingo Molnar &lt;mingo@redhat.com&gt;
    > Cc: Juri Lelli &lt;juri.lelli@redhat.com&gt;
    > Cc: Mel Gorman &lt;mgorman@suse.de&gt;
    > Cc: Peter Zijlstra &lt;peterz@infradead.org&gt;
    > Cc: Steven Rostedt &lt;rostedt@goodmis.org&gt;
    > Cc: Valentin Schneider &lt;vschneid@redhat.com&gt;
    > Cc: Vincent Guittot &lt;vincent.guittot@linaro.org&gt;
    > Cc: &lt;stable@vger.kernel.org&gt;
    > Signed-off-by: Andrew Morton &lt;akpm@linux-foundation.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ lib: stackinit: hide never-taken branch from compiler (@Kees Cook in [9fcb73b960e853b](https://github.com/sophgo/linux-riscv/commit/9fcb73b960e853b) at 2024-12-14 19:03:32)
    > commit 5c3793604f91123bf49bc792ce697a0bef4c173c upstream.
    > The never-taken branch leads to an invalid bounds condition, which is by
    > design. To avoid the unwanted warning from the compiler, hide the
    > variable from the optimizer.
    > ../lib/stackinit_kunit.c: In function &#x27;do_nothing_u16_zero&#x27;:
    > ../lib/stackinit_kunit.c:51:49: error: array subscript 1 is outside array bounds of &#x27;u16[0]&#x27; {aka &#x27;short unsigned int[]&#x27;} [-Werror&#x3D;array-bounds&#x3D;]
    > 51 | #define DO_NOTHING_RETURN_SCALAR(ptr)           *(ptr)
    > |                                                 ^~~~~~
    > ../lib/stackinit_kunit.c:219:24: note: in expansion of macro &#x27;DO_NOTHING_RETURN_SCALAR&#x27;
    > 219 |                 return DO_NOTHING_RETURN_ ## which(ptr + 1);    \
    > |                        ^~~~~~~~~~~~~~~~~~
    > Link: https://lkml.kernel.org/r/20241117113813.work.735-kees@kernel.org
    > Signed-off-by: Kees Cook &lt;kees@kernel.org&gt;
    > Cc: &lt;stable@vger.kernel.org&gt;
    > Signed-off-by: Andrew Morton &lt;akpm@linux-foundation.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ stackdepot: fix stack_depot_save_flags() in NMI context (@Marco Elver in [9bfeeeff2c92b9d](https://github.com/sophgo/linux-riscv/commit/9bfeeeff2c92b9d) at 2024-12-14 19:03:32)
    > commit 031e04bdc834cda3b054ef6b698503b2b97e8186 upstream.
    > Per documentation, stack_depot_save_flags() was meant to be usable from
    > NMI context if STACK_DEPOT_FLAG_CAN_ALLOC is unset.  However, it still
    > would try to take the pool_lock in an attempt to save a stack trace in the
    > current pool (if space is available).
    > This could result in deadlock if an NMI is handled while pool_lock is
    > already held.  To avoid deadlock, only try to take the lock in NMI context
    > and give up if unsuccessful.
    > The documentation is fixed to clearly convey this.
    > Link: https://lkml.kernel.org/r/Z0CcyfbPqmxJ9uJH@elver.google.com
    > Link: https://lkml.kernel.org/r/20241122154051.3914732-1-elver@google.com
    > Fixes: 4434a56ec209 (&quot;stackdepot: make fast paths lock-less again&quot;)
    > Signed-off-by: Marco Elver &lt;elver@google.com&gt;
    > Reported-by: Sebastian Andrzej Siewior &lt;bigeasy@linutronix.de&gt;
    > Reviewed-by: Sebastian Andrzej Siewior &lt;bigeasy@linutronix.de&gt;
    > Cc: Alexander Potapenko &lt;glider@google.com&gt;
    > Cc: Andrey Konovalov &lt;andreyknvl@gmail.com&gt;
    > Cc: Dmitry Vyukov &lt;dvyukov@google.com&gt;
    > Cc: Oscar Salvador &lt;osalvador@suse.de&gt;
    > Cc: Vlastimil Babka &lt;vbabka@suse.cz&gt;
    > Cc: &lt;stable@vger.kernel.org&gt;
    > Signed-off-by: Andrew Morton &lt;akpm@linux-foundation.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ kasan: make report_lock a raw spinlock (@Jared Kangas in [835ca042dfcfc4b](https://github.com/sophgo/linux-riscv/commit/835ca042dfcfc4b) at 2024-12-14 19:03:32)
    > commit e30a0361b8515d424c73c67de1a43e45a13b8ba2 upstream.
    > If PREEMPT_RT is enabled, report_lock is a sleeping spinlock and must not
    > be locked when IRQs are disabled.  However, KASAN reports may be triggered
    > in such contexts.  For example:
    > char *s &#x3D; kzalloc(1, GFP_KERNEL);
    > kfree(s);
    > local_irq_disable();
    > char c &#x3D; *s;  /* KASAN report here leads to spin_lock() */
    > local_irq_enable();
    > Make report_spinlock a raw spinlock to prevent rescheduling when
    > PREEMPT_RT is enabled.
    > Link: https://lkml.kernel.org/r/20241119210234.1602529-1-jkangas@redhat.com
    > Fixes: 342a93247e08 (&quot;locking/spinlock: Provide RT variant header: &lt;linux/spinlock_rt.h&gt;&quot;)
    > Signed-off-by: Jared Kangas &lt;jkangas@redhat.com&gt;
    > Cc: Alexander Potapenko &lt;glider@google.com&gt;
    > Cc: Andrey Konovalov &lt;andreyknvl@gmail.com&gt;
    > Cc: Andrey Ryabinin &lt;ryabinin.a.a@gmail.com&gt;
    > Cc: Dmitry Vyukov &lt;dvyukov@google.com&gt;
    > Cc: Vincenzo Frascino &lt;vincenzo.frascino@arm.com&gt;
    > Cc: &lt;stable@vger.kernel.org&gt;
    > Signed-off-by: Andrew Morton &lt;akpm@linux-foundation.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ mm/gup: handle NULL pages in unpin_user_pages() (@John Hubbard in [69d319450d1c651](https://github.com/sophgo/linux-riscv/commit/69d319450d1c651) at 2024-12-14 19:03:32)
    > commit a1268be280d8e484ab3606d7476edd0f14bb9961 upstream.
    > The recent addition of &quot;pofs&quot; (pages or folios) handling to gup has a
    > flaw: it assumes that unpin_user_pages() handles NULL pages in the pages**
    > array.  That&#x27;s not the case, as I discovered when I ran on a new
    > configuration on my test machine.
    > Fix this by skipping NULL pages in unpin_user_pages(), just like
    > unpin_folios() already does.
    > Details: when booting on x86 with &quot;numa&#x3D;fake&#x3D;2 movablecore&#x3D;4G&quot; on Linux
    > 6.12, and running this:
    > tools/testing/selftests/mm/gup_longterm
    > ...I get the following crash:
    > BUG: kernel NULL pointer dereference, address: 0000000000000008
    > RIP: 0010:sanity_check_pinned_pages+0x3a/0x2d0
    > ...
    > Call Trace:
    > &lt;TASK&gt;
    > ? __die_body+0x66/0xb0
    > ? page_fault_oops+0x30c/0x3b0
    > ? do_user_addr_fault+0x6c3/0x720
    > ? irqentry_enter+0x34/0x60
    > ? exc_page_fault+0x68/0x100
    > ? asm_exc_page_fault+0x22/0x30
    > ? sanity_check_pinned_pages+0x3a/0x2d0
    > unpin_user_pages+0x24/0xe0
    > check_and_migrate_movable_pages_or_folios+0x455/0x4b0
    > __gup_longterm_locked+0x3bf/0x820
    > ? mmap_read_lock_killable+0x12/0x50
    > ? __pfx_mmap_read_lock_killable+0x10/0x10
    > pin_user_pages+0x66/0xa0
    > gup_test_ioctl+0x358/0xb20
    > __se_sys_ioctl+0x6b/0xc0
    > do_syscall_64+0x7b/0x150
    > entry_SYSCALL_64_after_hwframe+0x76/0x7e
    > Link: https://lkml.kernel.org/r/20241121034933.77502-1-jhubbard@nvidia.com
    > Fixes: 94efde1d1539 (&quot;mm/gup: avoid an unnecessary allocation call for FOLL_LONGTERM cases&quot;)
    > Signed-off-by: John Hubbard &lt;jhubbard@nvidia.com&gt;
    > Acked-by: David Hildenbrand &lt;david@redhat.com&gt;
    > Cc: Oscar Salvador &lt;osalvador@suse.de&gt;
    > Cc: Vivek Kasireddy &lt;vivek.kasireddy@intel.com&gt;
    > Cc: Dave Airlie &lt;airlied@redhat.com&gt;
    > Cc: Gerd Hoffmann &lt;kraxel@redhat.com&gt;
    > Cc: Matthew Wilcox &lt;willy@infradead.org&gt;
    > Cc: Christoph Hellwig &lt;hch@infradead.org&gt;
    > Cc: Jason Gunthorpe &lt;jgg@nvidia.com&gt;
    > Cc: Peter Xu &lt;peterx@redhat.com&gt;
    > Cc: Arnd Bergmann &lt;arnd@arndb.de&gt;
    > Cc: Daniel Vetter &lt;daniel.vetter@ffwll.ch&gt;
    > Cc: Dongwon Kim &lt;dongwon.kim@intel.com&gt;
    > Cc: Hugh Dickins &lt;hughd@google.com&gt;
    > Cc: Junxiao Chang &lt;junxiao.chang@intel.com&gt;
    > Cc: &lt;stable@vger.kernel.org&gt;
    > Signed-off-by: Andrew Morton &lt;akpm@linux-foundation.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ mm/mempolicy: fix migrate_to_node() assuming there is at least one VMA in a MM (@David Hildenbrand in [42d9fe2adf8613f](https://github.com/sophgo/linux-riscv/commit/42d9fe2adf8613f) at 2024-12-14 19:03:32)
    > commit 091c1dd2d4df6edd1beebe0e5863d4034ade9572 upstream.
    > We currently assume that there is at least one VMA in a MM, which isn&#x27;t
    > true.
    > So we might end up having find_vma() return NULL, to then de-reference
    > NULL.  So properly handle find_vma() returning NULL.
    > This fixes the report:
    > Oops: general protection fault, probably for non-canonical address 0xdffffc0000000000: 0000 [#1] PREEMPT SMP KASAN PTI
    > KASAN: null-ptr-deref in range [0x0000000000000000-0x0000000000000007]
    > CPU: 1 UID: 0 PID: 6021 Comm: syz-executor284 Not tainted 6.12.0-rc7-syzkaller-00187-gf868cd251776 #0
    > Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 10/30/2024
    > RIP: 0010:migrate_to_node mm/mempolicy.c:1090 [inline]
    > RIP: 0010:do_migrate_pages+0x403/0x6f0 mm/mempolicy.c:1194
    > Code: ...
    > RSP: 0018:ffffc9000375fd08 EFLAGS: 00010246
    > RAX: 0000000000000000 RBX: ffffc9000375fd78 RCX: 0000000000000000
    > RDX: ffff88807e171300 RSI: dffffc0000000000 RDI: ffff88803390c044
    > RBP: ffff88807e171428 R08: 0000000000000014 R09: fffffbfff2039ef1
    > R10: ffffffff901cf78f R11: 0000000000000000 R12: 0000000000000003
    > R13: ffffc9000375fe90 R14: ffffc9000375fe98 R15: ffffc9000375fdf8
    > FS:  00005555919e1380(0000) GS:ffff8880b8700000(0000) knlGS:0000000000000000
    > CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
    > CR2: 00005555919e1ca8 CR3: 000000007f12a000 CR4: 00000000003526f0
    > DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
    > DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
    > Call Trace:
    > &lt;TASK&gt;
    > kernel_migrate_pages+0x5b2/0x750 mm/mempolicy.c:1709
    > __do_sys_migrate_pages mm/mempolicy.c:1727 [inline]
    > __se_sys_migrate_pages mm/mempolicy.c:1723 [inline]
    > __x64_sys_migrate_pages+0x96/0x100 mm/mempolicy.c:1723
    > do_syscall_x64 arch/x86/entry/common.c:52 [inline]
    > do_syscall_64+0xcd/0x250 arch/x86/entry/common.c:83
    > entry_SYSCALL_64_after_hwframe+0x77/0x7f
    > [akpm@linux-foundation.org: add unlikely()]
    > Link: https://lkml.kernel.org/r/20241120201151.9518-1-david@redhat.com
    > Fixes: 39743889aaf7 (&quot;[PATCH] Swap Migration V5: sys_migrate_pages interface&quot;)
    > Signed-off-by: David Hildenbrand &lt;david@redhat.com&gt;
    > Reported-by: syzbot+3511625422f7aa637f0d@syzkaller.appspotmail.com
    > Closes: https://lore.kernel.org/lkml/673d2696.050a0220.3c9d61.012f.GAE@google.com/T/
    > Reviewed-by: Liam R. Howlett &lt;Liam.Howlett@Oracle.com&gt;
    > Reviewed-by: Christoph Lameter &lt;cl@linux.com&gt;
    > Cc: Liam R. Howlett &lt;Liam.Howlett@Oracle.com&gt;
    > Cc: &lt;stable@vger.kernel.org&gt;
    > Signed-off-by: Andrew Morton &lt;akpm@linux-foundation.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ ocfs2: update seq_file index in ocfs2_dlm_seq_next (@Wengang Wang in [eb58460ff77e7bb](https://github.com/sophgo/linux-riscv/commit/eb58460ff77e7bb) at 2024-12-14 19:03:31)
    > commit 914eec5e980171bc128e7e24f7a22aa1d803570e upstream.
    > The following INFO level message was seen:
    > seq_file: buggy .next function ocfs2_dlm_seq_next [ocfs2] did not
    > update position index
    > Fix:
    > Update *pos (so m-&gt;index) to make seq_read_iter happy though the index its
    > self makes no sense to ocfs2_dlm_seq_next.
    > Link: https://lkml.kernel.org/r/20241119174500.9198-1-wen.gang.wang@oracle.com
    > Signed-off-by: Wengang Wang &lt;wen.gang.wang@oracle.com&gt;
    > Reviewed-by: Joseph Qi &lt;joseph.qi@linux.alibaba.com&gt;
    > Cc: Mark Fasheh &lt;mark@fasheh.com&gt;
    > Cc: Joel Becker &lt;jlbec@evilplan.org&gt;
    > Cc: Junxiao Bi &lt;junxiao.bi@oracle.com&gt;
    > Cc: Changwei Ge &lt;gechangwei@live.cn&gt;
    > Cc: Jun Piao &lt;piaojun@huawei.com&gt;
    > Cc: &lt;stable@vger.kernel.org&gt;
    > Signed-off-by: Andrew Morton &lt;akpm@linux-foundation.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ mmc: core: Further prevent card detect during shutdown (@Ulf Hansson in [d562b457e1c362f](https://github.com/sophgo/linux-riscv/commit/d562b457e1c362f) at 2024-12-14 19:03:31)
    > commit 87a0d90fcd31c0f36da0332428c9e1a1e0f97432 upstream.
    > Disabling card detect from the host&#x27;s -&gt;shutdown_pre() callback turned out
    > to not be the complete solution. More precisely, beyond the point when the
    > mmc_bus-&gt;shutdown() has been called, to gracefully power off the card, we
    > need to prevent card detect. Otherwise the mmc_rescan work may poll for the
    > card with a CMD13, to see if it&#x27;s still alive, which then will fail and
    > hang as the card has already been powered off.
    > To fix this problem, let&#x27;s disable mmc_rescan prior to power off the card
    > during shutdown.
    > Reported-by: Anthony Pighin &lt;anthony.pighin@nokia.com&gt;
    > Fixes: 66c915d09b94 (&quot;mmc: core: Disable card detect during shutdown&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Ulf Hansson &lt;ulf.hansson@linaro.org&gt;
    > Reviewed-by: Adrian Hunter &lt;adrian.hunter@intel.com&gt;
    > Closes: https://lore.kernel.org/all/BN0PR08MB695133000AF116F04C3A9FFE83212@BN0PR08MB6951.namprd08.prod.outlook.com/
    > Tested-by: Anthony Pighin &lt;anthony.pighin@nokia.com&gt;
    > Message-ID: &lt;20241125122446.18684-1-ulf.hansson@linaro.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ xsk: fix OOB map writes when deleting elements (@Maciej Fijalkowski in [d486b5741d987d3](https://github.com/sophgo/linux-riscv/commit/d486b5741d987d3) at 2024-12-14 19:03:31)
    > commit 32cd3db7de97c0c7a018756ce66244342fd583f0 upstream.
    > Jordy says:
    > &quot;
    > In the xsk_map_delete_elem function an unsigned integer
    > (map-&gt;max_entries) is compared with a user-controlled signed integer
    > (k). Due to implicit type conversion, a large unsigned value for
    > map-&gt;max_entries can bypass the intended bounds check:
    > if (k &gt;&#x3D; map-&gt;max_entries)
    > return -EINVAL;
    > This allows k to hold a negative value (between -2147483648 and -2),
    > which is then used as an array index in m-&gt;xsk_map[k], which results
    > in an out-of-bounds access.
    > spin_lock_bh(&amp;m-&gt;lock);
    > map_entry &#x3D; &amp;m-&gt;xsk_map[k]; // Out-of-bounds map_entry
    > old_xs &#x3D; unrcu_pointer(xchg(map_entry, NULL));  // Oob write
    > if (old_xs)
    > xsk_map_sock_delete(old_xs, map_entry);
    > spin_unlock_bh(&amp;m-&gt;lock);
    > The xchg operation can then be used to cause an out-of-bounds write.
    > Moreover, the invalid map_entry passed to xsk_map_sock_delete can lead
    > to further memory corruption.
    > &quot;
    > It indeed results in following splat:
    > [76612.897343] BUG: unable to handle page fault for address: ffffc8fc2e461108
    > [76612.904330] #PF: supervisor write access in kernel mode
    > [76612.909639] #PF: error_code(0x0002) - not-present page
    > [76612.914855] PGD 0 P4D 0
    > [76612.917431] Oops: Oops: 0002 [#1] PREEMPT SMP
    > [76612.921859] CPU: 11 UID: 0 PID: 10318 Comm: a.out Not tainted 6.12.0-rc1+ #470
    > [76612.929189] Hardware name: Intel Corporation S2600WFT/S2600WFT, BIOS SE5C620.86B.02.01.0008.031920191559 03/19/2019
    > [76612.939781] RIP: 0010:xsk_map_delete_elem+0x2d/0x60
    > [76612.944738] Code: 00 00 41 54 55 53 48 63 2e 3b 6f 24 73 38 4c 8d a7 f8 00 00 00 48 89 fb 4c 89 e7 e8 2d bf 05 00 48 8d b4 eb 00 01 00 00 31 ff &lt;48&gt; 87 3e 48 85 ff 74 05 e8 16 ff ff ff 4c 89 e7 e8 3e bc 05 00 31
    > [76612.963774] RSP: 0018:ffffc9002e407df8 EFLAGS: 00010246
    > [76612.969079] RAX: 0000000000000000 RBX: ffffc9002e461000 RCX: 0000000000000000
    > [76612.976323] RDX: 0000000000000001 RSI: ffffc8fc2e461108 RDI: 0000000000000000
    > [76612.983569] RBP: ffffffff80000001 R08: 0000000000000000 R09: 0000000000000007
    > [76612.990812] R10: ffffc9002e407e18 R11: ffff888108a38858 R12: ffffc9002e4610f8
    > [76612.998060] R13: ffff888108a38858 R14: 00007ffd1ae0ac78 R15: ffffc9002e4610c0
    > [76613.005303] FS:  00007f80b6f59740(0000) GS:ffff8897e0ec0000(0000) knlGS:0000000000000000
    > [76613.013517] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
    > [76613.019349] CR2: ffffc8fc2e461108 CR3: 000000011e3ef001 CR4: 00000000007726f0
    > [76613.026595] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
    > [76613.033841] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
    > [76613.041086] PKRU: 55555554
    > [76613.043842] Call Trace:
    > [76613.046331]  &lt;TASK&gt;
    > [76613.048468]  ? __die+0x20/0x60
    > [76613.051581]  ? page_fault_oops+0x15a/0x450
    > [76613.055747]  ? search_extable+0x22/0x30
    > [76613.059649]  ? search_bpf_extables+0x5f/0x80
    > [76613.063988]  ? exc_page_fault+0xa9/0x140
    > [76613.067975]  ? asm_exc_page_fault+0x22/0x30
    > [76613.072229]  ? xsk_map_delete_elem+0x2d/0x60
    > [76613.076573]  ? xsk_map_delete_elem+0x23/0x60
    > [76613.080914]  __sys_bpf+0x19b7/0x23c0
    > [76613.084555]  __x64_sys_bpf+0x1a/0x20
    > [76613.088194]  do_syscall_64+0x37/0xb0
    > [76613.091832]  entry_SYSCALL_64_after_hwframe+0x4b/0x53
    > [76613.096962] RIP: 0033:0x7f80b6d1e88d
    > [76613.100592] Code: 5b 41 5c c3 66 0f 1f 84 00 00 00 00 00 f3 0f 1e fa 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 &lt;48&gt; 3d 01 f0 ff ff 73 01 c3 48 8b 0d 73 b5 0f 00 f7 d8 64 89 01 48
    > [76613.119631] RSP: 002b:00007ffd1ae0ac68 EFLAGS: 00000206 ORIG_RAX: 0000000000000141
    > [76613.131330] RAX: ffffffffffffffda RBX: 0000000000000000 RCX: 00007f80b6d1e88d
    > [76613.142632] RDX: 0000000000000098 RSI: 00007ffd1ae0ad20 RDI: 0000000000000003
    > [76613.153967] RBP: 00007ffd1ae0adc0 R08: 0000000000000000 R09: 0000000000000000
    > [76613.166030] R10: 00007f80b6f77040 R11: 0000000000000206 R12: 00007ffd1ae0aed8
    > [76613.177130] R13: 000055ddf42ce1e9 R14: 000055ddf42d0d98 R15: 00007f80b6fab040
    > [76613.188129]  &lt;/TASK&gt;
    > Fix this by simply changing key type from int to u32.
    > Fixes: fbfc504a24f5 (&quot;bpf: introduce new bpf AF_XDP map type BPF_MAP_TYPE_XSKMAP&quot;)
    > CC: stable@vger.kernel.org
    > Reported-by: Jordy Zomer &lt;jordyzomer@google.com&gt;
    > Suggested-by: Jordy Zomer &lt;jordyzomer@google.com&gt;
    > Reviewed-by: Toke Høiland-Jørgensen &lt;toke@redhat.com&gt;
    > Acked-by: John Fastabend &lt;john.fastabend@gmail.com&gt;
    > Signed-off-by: Maciej Fijalkowski &lt;maciej.fijalkowski@intel.com&gt;
    > Link: https://lore.kernel.org/r/20241122121030.716788-2-maciej.fijalkowski@intel.com
    > Signed-off-by: Alexei Starovoitov &lt;ast@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ arch_numa: Restore nid checks before registering a memblock with a node (@Marc Zyngier in [af2b48a07690b5b](https://github.com/sophgo/linux-riscv/commit/af2b48a07690b5b) at 2024-12-14 19:03:31)
    > commit 180bbad698641873120a48857bb3b9f3166bf684 upstream.
    > Commit 767507654c22 (&quot;arch_numa: switch over to numa_memblks&quot;)
    > significantly cleaned up the NUMA registration code, but also
    > dropped a significant check that was refusing to accept to
    > configure a memblock with an invalid nid.
    > On &quot;quality hardware&quot; such as my ThunderX machine, this results
    > in a kernel that dies immediately:
    > [    0.000000] Booting Linux on physical CPU 0x0000000000 [0x431f0a10]
    > [    0.000000] Linux version 6.12.0-00013-g8920d74cf8db (maz@valley-girl) (gcc (Debian 12.2.0-14) 12.2.0, GNU ld (GNU Binutils for Debian) 2.40) #3872 SMP PREEMPT Wed Nov 27 15:25:49 GMT 2024
    > [    0.000000] KASLR disabled due to lack of seed
    > [    0.000000] Machine model: Cavium ThunderX CN88XX board
    > [    0.000000] efi: EFI v2.4 by American Megatrends
    > [    0.000000] efi: ESRT&#x3D;0xffce0ff18 SMBIOS 3.0&#x3D;0xfffb0000 ACPI 2.0&#x3D;0xffec60000 MEMRESERVE&#x3D;0xffc905d98
    > [    0.000000] esrt: Reserving ESRT space from 0x0000000ffce0ff18 to 0x0000000ffce0ff50.
    > [    0.000000] earlycon: pl11 at MMIO 0x000087e024000000 (options &#x27;115200n8&#x27;)
    > [    0.000000] printk: legacy bootconsole [pl11] enabled
    > [    0.000000] NODE_DATA(0) allocated [mem 0xff6754580-0xff67566bf]
    > [    0.000000] Unable to handle kernel paging request at virtual address 0000000000001d40
    > [    0.000000] Mem abort info:
    > [    0.000000]   ESR &#x3D; 0x0000000096000004
    > [    0.000000]   EC &#x3D; 0x25: DABT (current EL), IL &#x3D; 32 bits
    > [    0.000000]   SET &#x3D; 0, FnV &#x3D; 0
    > [    0.000000]   EA &#x3D; 0, S1PTW &#x3D; 0
    > [    0.000000]   FSC &#x3D; 0x04: level 0 translation fault
    > [    0.000000] Data abort info:
    > [    0.000000]   ISV &#x3D; 0, ISS &#x3D; 0x00000004, ISS2 &#x3D; 0x00000000
    > [    0.000000]   CM &#x3D; 0, WnR &#x3D; 0, TnD &#x3D; 0, TagAccess &#x3D; 0
    > [    0.000000]   GCS &#x3D; 0, Overlay &#x3D; 0, DirtyBit &#x3D; 0, Xs &#x3D; 0
    > [    0.000000] [0000000000001d40] user address but active_mm is swapper
    > [    0.000000] Internal error: Oops: 0000000096000004 [#1] PREEMPT SMP
    > [    0.000000] Modules linked in:
    > [    0.000000] CPU: 0 UID: 0 PID: 0 Comm: swapper Not tainted 6.12.0-00013-g8920d74cf8db #3872
    > [    0.000000] Hardware name: Cavium ThunderX CN88XX board (DT)
    > [    0.000000] pstate: a00000c5 (NzCv daIF -PAN -UAO -TCO -DIT -SSBS BTYPE&#x3D;--)
    > [    0.000000] pc : sparse_init_nid+0x54/0x428
    > [    0.000000] lr : sparse_init+0x118/0x240
    > [    0.000000] sp : ffff800081da3cb0
    > [    0.000000] x29: ffff800081da3cb0 x28: 0000000fedbab10c x27: 0000000000000001
    > [    0.000000] x26: 0000000ffee250f8 x25: 0000000000000001 x24: ffff800082102cd0
    > [    0.000000] x23: 0000000000000001 x22: 0000000000000000 x21: 00000000001fffff
    > [    0.000000] x20: 0000000000000001 x19: 0000000000000000 x18: ffffffffffffffff
    > [    0.000000] x17: 0000000001b00000 x16: 0000000ffd130000 x15: 0000000000000000
    > [    0.000000] x14: 00000000003e0000 x13: 00000000000001c8 x12: 0000000000000014
    > [    0.000000] x11: ffff800081e82860 x10: ffff8000820fb2c8 x9 : ffff8000820fb490
    > [    0.000000] x8 : 0000000000ffed20 x7 : 0000000000000014 x6 : 00000000001fffff
    > [    0.000000] x5 : 00000000ffffffff x4 : 0000000000000000 x3 : 0000000000000000
    > [    0.000000] x2 : 0000000000000000 x1 : 0000000000000040 x0 : 0000000000000007
    > [    0.000000] Call trace:
    > [    0.000000]  sparse_init_nid+0x54/0x428
    > [    0.000000]  sparse_init+0x118/0x240
    > [    0.000000]  bootmem_init+0x70/0x1c8
    > [    0.000000]  setup_arch+0x184/0x270
    > [    0.000000]  start_kernel+0x74/0x670
    > [    0.000000]  __primary_switched+0x80/0x90
    > [    0.000000] Code: f865d804 d37df060 cb030000 d2800003 (b95d4084)
    > [    0.000000] ---[ end trace 0000000000000000 ]---
    > [    0.000000] Kernel panic - not syncing: Attempted to kill the idle task!
    > [    0.000000] ---[ end Kernel panic - not syncing: Attempted to kill the idle task! ]---
    > while previous kernel versions were able to recognise how brain-damaged
    > the machine is, and only build a fake node.
    > Use the memblock_validate_numa_coverage() helper to restore some sanity
    > and a &quot;working&quot; system.
    > Fixes: 767507654c22 (&quot;arch_numa: switch over to numa_memblks&quot;)
    > Suggested-by: Mike Rapoport &lt;rppt@kernel.org&gt;
    > Signed-off-by: Marc Zyngier &lt;maz@kernel.org&gt;
    > Cc: Catalin Marinas &lt;catalin.marinas@arm.com&gt;
    > Cc: Will Deacon &lt;will@kernel.org&gt;
    > Cc: Zi Yan &lt;ziy@nvidia.com&gt;
    > Cc: Dan Williams &lt;dan.j.williams@intel.com&gt;
    > Cc: David Hildenbrand &lt;david@redhat.com&gt;
    > Cc: Andrew Morton &lt;akpm@linux-foundation.org&gt;
    > Cc: stable@vger.kernel.org
    > Link: https://lore.kernel.org/r/20241201092702.3792845-1-maz@kernel.org
    > Signed-off-by: Mike Rapoport (Microsoft) &lt;rppt@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ x86/cpu: Add Lunar Lake to list of CPUs with a broken MONITOR implementation (@Len Brown in [9722010afd9c069](https://github.com/sophgo/linux-riscv/commit/9722010afd9c069) at 2024-12-14 19:03:31)
    > commit c9a4b55431e5220347881e148725bed69c84e037 upstream.
    > Under some conditions, MONITOR wakeups on Lunar Lake processors
    > can be lost, resulting in significant user-visible delays.
    > Add Lunar Lake to X86_BUG_MONITOR so that wake_up_idle_cpu()
    > always sends an IPI, avoiding this potential delay.
    > Reported originally here:
    > https://bugzilla.kernel.org/show_bug.cgi?id&#x3D;219364
    > [ dhansen: tweak subject ]
    > Signed-off-by: Len Brown &lt;len.brown@intel.com&gt;
    > Signed-off-by: Dave Hansen &lt;dave.hansen@linux.intel.com&gt;
    > Reviewed-by: Rafael J. Wysocki &lt;rafael.j.wysocki@intel.com&gt;
    > Cc:stable@vger.kernel.org
    > Link: https://lore.kernel.org/all/a4aa8842a3c3bfdb7fe9807710eef159cbf0e705.1731463305.git.len.brown%40intel.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ mmc: sdhci-pci: Add DMI quirk for missing CD GPIO on Vexia Edu Atla 10 tablet (@Hans de Goede in [637cf7d444b09c8](https://github.com/sophgo/linux-riscv/commit/637cf7d444b09c8) at 2024-12-14 19:03:31)
    > commit 7f0fa47ceebcff0e3591bb7e32a71a2cd7846149 upstream.
    > The Vexia Edu Atla 10 tablet distributed to schools in the Spanish
    > Andalucía region has no ACPI fwnode associated with the SDHCI controller
    > for its microsd-slot and thus has no ACPI GPIO resource info.
    > This causes the following error to be logged and the slot to not work:
    > [   10.572113] sdhci-pci 0000:00:12.0: failed to setup card detect gpio
    > Add a DMI quirk table for providing gpiod_lookup_tables with manually
    > provided CD GPIO info and use this DMI table to provide the CD GPIO info
    > on this tablet. This fixes the microsd-slot not working.
    > Signed-off-by: Hans de Goede &lt;hdegoede@redhat.com&gt;
    > Acked-by: Adrian Hunter &lt;adrian.hunter@intel.com&gt;
    > Cc: stable@vger.kernel.org
    > Message-ID: &lt;20241118210049.311079-1-hdegoede@redhat.com&gt;
    > Signed-off-by: Ulf Hansson &lt;ulf.hansson@linaro.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ regmap: detach regmap from dev on regmap_exit (@Cosmin Tanislav in [14258211d68436c](https://github.com/sophgo/linux-riscv/commit/14258211d68436c) at 2024-12-14 19:03:31)
    > commit 3061e170381af96d1e66799d34264e6414d428a7 upstream.
    > At the end of __regmap_init(), if dev is not NULL, regmap_attach_dev()
    > is called, which adds a devres reference to the regmap, to be able to
    > retrieve a dev&#x27;s regmap by name using dev_get_regmap().
    > When calling regmap_exit, the opposite does not happen, and the
    > reference is kept until the dev is detached.
    > Add a regmap_detach_dev() function and call it in regmap_exit() to make
    > sure that the devres reference is not kept.
    > Cc: stable@vger.kernel.org
    > Fixes: 72b39f6f2b5a (&quot;regmap: Implement dev_get_regmap()&quot;)
    > Signed-off-by: Cosmin Tanislav &lt;demonsingur@gmail.com&gt;
    > Rule: add
    > Link: https://lore.kernel.org/stable/20241128130554.362486-1-demonsingur%40gmail.com
    > Link: https://patch.msgid.link/20241128131625.363835-1-demonsingur@gmail.com
    > Signed-off-by: Mark Brown &lt;broonie@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ dma-fence: Fix reference leak on fence merge failure path (@Tvrtko Ursulin in [f3dbb097d653b81](https://github.com/sophgo/linux-riscv/commit/f3dbb097d653b81) at 2024-12-14 19:03:30)
    > commit 949291c5314009b4f6e252391edbb40fdd5d5414 upstream.
    > Release all fence references if the output dma-fence-array could not be
    > allocated.
    > Signed-off-by: Tvrtko Ursulin &lt;tvrtko.ursulin@igalia.com&gt;
    > Fixes: 245a4a7b531c (&quot;dma-buf: generalize dma_fence unwrap &amp; merging v3&quot;)
    > Cc: Christian König &lt;christian.koenig@amd.com&gt;
    > Cc: Daniel Vetter &lt;daniel.vetter@ffwll.ch&gt;
    > Cc: Sumit Semwal &lt;sumit.semwal@linaro.org&gt;
    > Cc: Gustavo Padovan &lt;gustavo@padovan.org&gt;
    > Cc: Friedrich Vock &lt;friedrich.vock@gmx.de&gt;
    > Cc: linux-media@vger.kernel.org
    > Cc: dri-devel@lists.freedesktop.org
    > Cc: linaro-mm-sig@lists.linaro.org
    > Cc: &lt;stable@vger.kernel.org&gt; # v6.0+
    > Reviewed-by: Christian König &lt;christian.koenig@amd.com&gt;
    > Signed-off-by: Christian König &lt;christian.koenig@amd.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20241115102153.1980-2-tursulin@igalia.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ modpost: Add .irqentry.text to OTHER_SECTIONS (@Thomas Gleixner in [bc031095d1a1ad7](https://github.com/sophgo/linux-riscv/commit/bc031095d1a1ad7) at 2024-12-14 19:03:30)
    > commit 7912405643a14b527cd4a4f33c1d4392da900888 upstream.
    > The compiler can fully inline the actual handler function of an interrupt
    > entry into the .irqentry.text entry point. If such a function contains an
    > access which has an exception table entry, modpost complains about a
    > section mismatch:
    > WARNING: vmlinux.o(__ex_table+0x447c): Section mismatch in reference ...
    > The relocation at __ex_table+0x447c references section &quot;.irqentry.text&quot;
    > which is not in the list of authorized sections.
    > Add .irqentry.text to OTHER_SECTIONS to cure the issue.
    > Reported-by: Sergey Senozhatsky &lt;senozhatsky@chromium.org&gt;
    > Signed-off-by: Thomas Gleixner &lt;tglx@linutronix.de&gt;
    > Cc: stable@vger.kernel.org # needed for linux-5.4-y
    > Link: https://lore.kernel.org/all/20241128111844.GE10431@google.com/
    > Signed-off-by: Masahiro Yamada &lt;masahiroy@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ dma-fence: Use kernel&#x27;s sort for merging fences (@Tvrtko Ursulin in [47155559646e188](https://github.com/sophgo/linux-riscv/commit/47155559646e188) at 2024-12-14 19:03:30)
    > commit fe52c649438b8489c9456681d93a9b3de3d38263 upstream.
    > One alternative to the fix Christian proposed in
    > https://lore.kernel.org/dri-devel/20241024124159.4519-3-christian.koenig@amd.com/
    > is to replace the rather complex open coded sorting loops with the kernel
    > standard sort followed by a context squashing pass.
    > Proposed advantage of this would be readability but one concern Christian
    > raised was that there could be many fences, that they are typically mostly
    > sorted, and so the kernel&#x27;s heap sort would be much worse by the proposed
    > algorithm.
    > I had a look running some games and vkcube to see what are the typical
    > number of input fences. Tested scenarios:
    > 1) Hogwarts Legacy under Gamescope
    > 450 calls per second to __dma_fence_unwrap_merge.
    > Percentages per number of fences buckets, before and after checking for
    > signalled status, sorting and flattening:
    > N       Before      After
    > 0       0.91%
    > 1      69.40%
    > 2-3     28.72%       9.4%  (90.6% resolved to one fence)
    > 4-5      0.93%
    > 6-9      0.03%
    > 10+
    > 2) Cyberpunk 2077 under Gamescope
    > 1050 calls per second, amounting to 0.01% CPU time according to perf top.
    > N       Before      After
    > 0       1.13%
    > 1      52.30%
    > 2-3     40.34%       55.57%
    > 4-5      1.46%        0.50%
    > 6-9      2.44%
    > 10+      2.34%
    > 3) vkcube under Plasma
    > 90 calls per second.
    > N       Before      After
    > 0
    > 1
    > 2-3      100%         0%   (Ie. all resolved to a single fence)
    > 4-5
    > 6-9
    > 10+
    > In the case of vkcube all invocations in the 2-3 bucket were actually
    > just two input fences.
    > From these numbers it looks like the heap sort should not be a
    > disadvantage, given how the dominant case is &lt;&#x3D; 2 input fences which heap
    > sort solves with just one compare and swap. (And for the case of one input
    > fence we have a fast path in the previous patch.)
    > A complementary possibility is to implement a different sorting algorithm
    > under the same API as the kernel&#x27;s sort() and so keep the simplicity,
    > potentially moving the new sort under lib/ if it would be found more
    > widely useful.
    > v2:
    > Hold on to fence references and reduce commentary. (Christian)
    > Record and use latest signaled timestamp in the 2nd loop too.
    > Consolidate zero or one fences fast paths.
    > v3:
    > Reverse the seqno sort order for a simpler squashing pass. (Christian)
    > Signed-off-by: Tvrtko Ursulin &lt;tvrtko.ursulin@igalia.com&gt;
    > Fixes: 245a4a7b531c (&quot;dma-buf: generalize dma_fence unwrap &amp; merging v3&quot;)
    > Closes: https://gitlab.freedesktop.org/drm/amd/-/issues/3617
    > Cc: Christian König &lt;christian.koenig@amd.com&gt;
    > Cc: Daniel Vetter &lt;daniel.vetter@ffwll.ch&gt;
    > Cc: Sumit Semwal &lt;sumit.semwal@linaro.org&gt;
    > Cc: Gustavo Padovan &lt;gustavo@padovan.org&gt;
    > Cc: Friedrich Vock &lt;friedrich.vock@gmx.de&gt;
    > Cc: linux-media@vger.kernel.org
    > Cc: dri-devel@lists.freedesktop.org
    > Cc: linaro-mm-sig@lists.linaro.org
    > Cc: &lt;stable@vger.kernel.org&gt; # v6.0+
    > Reviewed-by: Christian König &lt;christian.koenig@amd.com&gt;
    > Signed-off-by: Christian König &lt;christian.koenig@amd.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20241115102153.1980-3-tursulin@igalia.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ dma-buf: fix dma_fence_array_signaled v4 (@Christian König in [3dcc20418ea6e95](https://github.com/sophgo/linux-riscv/commit/3dcc20418ea6e95) at 2024-12-14 19:03:30)
    > commit 78ac1c3558810486d90aa533b0039aa70487a3da upstream.
    > The function silently assumed that signaling was already enabled for the
    > dma_fence_array. This meant that without enabling signaling first we would
    > never see forward progress.
    > Fix that by falling back to testing each individual fence when signaling
    > isn&#x27;t enabled yet.
    > v2: add the comment suggested by Boris why this is done this way
    > v3: fix the underflow pointed out by Tvrtko
    > v4: atomic_read_acquire() as suggested by Tvrtko
    > Signed-off-by: Christian König &lt;christian.koenig@amd.com&gt;
    > Reviewed-by: Boris Brezillon &lt;boris.brezillon@collabora.com&gt;
    > Tested-by: Chia-I Wu &lt;olvaffe@gmail.com&gt;
    > Reviewed-by: Tvrtko Ursulin &lt;tvrtko.ursulin@igalia.com&gt;
    > Closes: https://gitlab.freedesktop.org/mesa/mesa/-/issues/12094
    > Cc: &lt;stable@vger.kernel.org&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20241112121925.18464-1-christian.koenig@amd.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ x86/kexec: Restore GDT on return from ::preserve_context kexec (@David Woodhouse in [3702a27a67c7302](https://github.com/sophgo/linux-riscv/commit/3702a27a67c7302) at 2024-12-14 19:03:30)
    > commit 07fa619f2a40c221ea27747a3323cabc59ab25eb upstream.
    > The restore_processor_state() function explicitly states that &quot;the asm code
    > that gets us here will have restored a usable GDT&quot;. That wasn&#x27;t true in the
    > case of returning from a ::preserve_context kexec. Make it so.
    > Without this, the kernel was depending on the called function to reload a
    > GDT which is appropriate for the kernel before returning.
    > Test program:
    > #include &lt;unistd.h&gt;
    > #include &lt;errno.h&gt;
    > #include &lt;stdio.h&gt;
    > #include &lt;stdlib.h&gt;
    > #include &lt;linux/kexec.h&gt;
    > #include &lt;linux/reboot.h&gt;
    > #include &lt;sys/reboot.h&gt;
    > #include &lt;sys/syscall.h&gt;
    > int main (void)
    > {
    > struct kexec_segment segment &#x3D; {};
    > unsigned char purgatory[] &#x3D; {
    > 0x66, 0xba, 0xf8, 0x03,	// mov $0x3f8, %dx
    > 0xb0, 0x42,		// mov $0x42, %al
    > 0xee,			// outb %al, (%dx)
    > 0xc3,			// ret
    > };
    > int ret;
    > segment.buf &#x3D; &amp;purgatory;
    > segment.bufsz &#x3D; sizeof(purgatory);
    > segment.mem &#x3D; (void *)0x400000;
    > segment.memsz &#x3D; 0x1000;
    > ret &#x3D; syscall(__NR_kexec_load, 0x400000, 1, &amp;segment, KEXEC_PRESERVE_CONTEXT);
    > if (ret) {
    > perror(&quot;kexec_load&quot;);
    > exit(1);
    > }
    > ret &#x3D; syscall(__NR_reboot, LINUX_REBOOT_MAGIC1, LINUX_REBOOT_MAGIC2, LINUX_REBOOT_CMD_KEXEC);
    > if (ret) {
    > perror(&quot;kexec reboot&quot;);
    > exit(1);
    > }
    > printf(&quot;Success\n&quot;);
    > return 0;
    > }
    > Signed-off-by: David Woodhouse &lt;dwmw@amazon.co.uk&gt;
    > Signed-off-by: Ingo Molnar &lt;mingo@kernel.org&gt;
    > Cc: stable@vger.kernel.org
    > Link: https://lore.kernel.org/r/20241205153343.3275139-2-dwmw2@infradead.org
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ bpf: fix OOB devmap writes when deleting elements (@Maciej Fijalkowski in [178e31df1fb3d9e](https://github.com/sophgo/linux-riscv/commit/178e31df1fb3d9e) at 2024-12-14 19:03:30)
    > commit ab244dd7cf4c291f82faacdc50b45cc0f55b674d upstream.
    > Jordy reported issue against XSKMAP which also applies to DEVMAP - the
    > index used for accessing map entry, due to being a signed integer,
    > causes the OOB writes. Fix is simple as changing the type from int to
    > u32, however, when compared to XSKMAP case, one more thing needs to be
    > addressed.
    > When map is released from system via dev_map_free(), we iterate through
    > all of the entries and an iterator variable is also an int, which
    > implies OOB accesses. Again, change it to be u32.
    > Example splat below:
    > [  160.724676] BUG: unable to handle page fault for address: ffffc8fc2c001000
    > [  160.731662] #PF: supervisor read access in kernel mode
    > [  160.736876] #PF: error_code(0x0000) - not-present page
    > [  160.742095] PGD 0 P4D 0
    > [  160.744678] Oops: Oops: 0000 [#1] PREEMPT SMP
    > [  160.749106] CPU: 1 UID: 0 PID: 520 Comm: kworker/u145:12 Not tainted 6.12.0-rc1+ #487
    > [  160.757050] Hardware name: Intel Corporation S2600WFT/S2600WFT, BIOS SE5C620.86B.02.01.0008.031920191559 03/19/2019
    > [  160.767642] Workqueue: events_unbound bpf_map_free_deferred
    > [  160.773308] RIP: 0010:dev_map_free+0x77/0x170
    > [  160.777735] Code: 00 e8 fd 91 ed ff e8 b8 73 ed ff 41 83 7d 18 19 74 6e 41 8b 45 24 49 8b bd f8 00 00 00 31 db 85 c0 74 48 48 63 c3 48 8d 04 c7 &lt;48&gt; 8b 28 48 85 ed 74 30 48 8b 7d 18 48 85 ff 74 05 e8 b3 52 fa ff
    > [  160.796777] RSP: 0018:ffffc9000ee1fe38 EFLAGS: 00010202
    > [  160.802086] RAX: ffffc8fc2c001000 RBX: 0000000080000000 RCX: 0000000000000024
    > [  160.809331] RDX: 0000000000000000 RSI: 0000000000000024 RDI: ffffc9002c001000
    > [  160.816576] RBP: 0000000000000000 R08: 0000000000000023 R09: 0000000000000001
    > [  160.823823] R10: 0000000000000001 R11: 00000000000ee6b2 R12: dead000000000122
    > [  160.831066] R13: ffff88810c928e00 R14: ffff8881002df405 R15: 0000000000000000
    > [  160.838310] FS:  0000000000000000(0000) GS:ffff8897e0c40000(0000) knlGS:0000000000000000
    > [  160.846528] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
    > [  160.852357] CR2: ffffc8fc2c001000 CR3: 0000000005c32006 CR4: 00000000007726f0
    > [  160.859604] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
    > [  160.866847] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
    > [  160.874092] PKRU: 55555554
    > [  160.876847] Call Trace:
    > [  160.879338]  &lt;TASK&gt;
    > [  160.881477]  ? __die+0x20/0x60
    > [  160.884586]  ? page_fault_oops+0x15a/0x450
    > [  160.888746]  ? search_extable+0x22/0x30
    > [  160.892647]  ? search_bpf_extables+0x5f/0x80
    > [  160.896988]  ? exc_page_fault+0xa9/0x140
    > [  160.900973]  ? asm_exc_page_fault+0x22/0x30
    > [  160.905232]  ? dev_map_free+0x77/0x170
    > [  160.909043]  ? dev_map_free+0x58/0x170
    > [  160.912857]  bpf_map_free_deferred+0x51/0x90
    > [  160.917196]  process_one_work+0x142/0x370
    > [  160.921272]  worker_thread+0x29e/0x3b0
    > [  160.925082]  ? rescuer_thread+0x4b0/0x4b0
    > [  160.929157]  kthread+0xd4/0x110
    > [  160.932355]  ? kthread_park+0x80/0x80
    > [  160.936079]  ret_from_fork+0x2d/0x50
    > [  160.943396]  ? kthread_park+0x80/0x80
    > [  160.950803]  ret_from_fork_asm+0x11/0x20
    > [  160.958482]  &lt;/TASK&gt;
    > Fixes: 546ac1ffb70d (&quot;bpf: add devmap, a map for storing net device references&quot;)
    > CC: stable@vger.kernel.org
    > Reported-by: Jordy Zomer &lt;jordyzomer@google.com&gt;
    > Suggested-by: Jordy Zomer &lt;jordyzomer@google.com&gt;
    > Reviewed-by: Toke Høiland-Jørgensen &lt;toke@redhat.com&gt;
    > Acked-by: John Fastabend &lt;john.fastabend@gmail.com&gt;
    > Signed-off-by: Maciej Fijalkowski &lt;maciej.fijalkowski@intel.com&gt;
    > Link: https://lore.kernel.org/r/20241122121030.716788-3-maciej.fijalkowski@intel.com
    > Signed-off-by: Alexei Starovoitov &lt;ast@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ drm/amdgpu/hdp6.0: do a posting read when flushing HDP (@Alex Deucher in [e55d088edfcf4cb](https://github.com/sophgo/linux-riscv/commit/e55d088edfcf4cb) at 2024-12-14 19:03:29)
    > commit abe1cbaec6cfe9fde609a15cd6a12c812282ce77 upstream.
    > Need to read back to make sure the write goes through.
    > Cc: David Belanger &lt;david.belanger@amd.com&gt;
    > Reviewed-by: Frank Min &lt;frank.min@amd.com&gt;
    > Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ drm/amdgpu/hdp5.0: do a posting read when flushing HDP (@Alex Deucher in [c99261fa723ec9a](https://github.com/sophgo/linux-riscv/commit/c99261fa723ec9a) at 2024-12-14 19:03:29)
    > commit cf424020e040be35df05b682b546b255e74a420f upstream.
    > Need to read back to make sure the write goes through.
    > Cc: David Belanger &lt;david.belanger@amd.com&gt;
    > Reviewed-by: Frank Min &lt;frank.min@amd.com&gt;
    > Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ drm/amdgpu/hdp4.0: do a posting read when flushing HDP (@Alex Deucher in [8976f9cc99caff8](https://github.com/sophgo/linux-riscv/commit/8976f9cc99caff8) at 2024-12-14 19:03:29)
    > commit c9b8dcabb52afe88413ff135a0953e3cc4128483 upstream.
    > Need to read back to make sure the write goes through.
    > Cc: David Belanger &lt;david.belanger@amd.com&gt;
    > Reviewed-by: Frank Min &lt;frank.min@amd.com&gt;
    > Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ drm/amdgpu/hdp7.0: do a posting read when flushing HDP (@Alex Deucher in [8499665f2c2da53](https://github.com/sophgo/linux-riscv/commit/8499665f2c2da53) at 2024-12-14 19:03:29)
    > commit 689275140cb8e9f8ae59e545086fce51fb0b994a upstream.
    > Need to read back to make sure the write goes through.
    > Cc: David Belanger &lt;david.belanger@amd.com&gt;
    > Reviewed-by: Frank Min &lt;frank.min@amd.com&gt;
    > Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ drm/amdgpu/hdp5.2: do a posting read when flushing HDP (@Alex Deucher in [573e70eb7e76a8f](https://github.com/sophgo/linux-riscv/commit/573e70eb7e76a8f) at 2024-12-14 19:03:29)
    > commit f756dbac1ce1d5f9a2b35e3b55fa429cf6336437 upstream.
    > Need to read back to make sure the write goes through.
    > Cc: David Belanger &lt;david.belanger@amd.com&gt;
    > Reviewed-by: Frank Min &lt;frank.min@amd.com&gt;
    > Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ drm/amd/display: Add a left edge pixel if in YCbCr422 or YCbCr420 and odm (@Peterson Guo in [2e7bea50a9b78f6](https://github.com/sophgo/linux-riscv/commit/2e7bea50a9b78f6) at 2024-12-14 19:03:29)
    > commit 63e7ee677c74e981257cedfdd8543510d09096ba upstream.
    > [WHY]
    > On some cards when odm is used, the monitor will have 2 separate pipes
    > split vertically. When compression is used on the YCbCr colour space on
    > the second pipe to have correct colours, we need to read a pixel from the
    > end of first pipe to accurately display colours. Hardware was programmed
    > properly to account for this extra pixel but it was not calculated
    > properly in software causing a split screen on some monitors.
    > [HOW]
    > The fix adjusts the second pipe&#x27;s viewport and timings if the pixel
    > encoding is YCbCr422 or YCbCr420.
    > Cc: Mario Limonciello &lt;mario.limonciello@amd.com&gt;
    > Cc: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Cc: stable@vger.kernel.org
    > Reviewed-by: George Shen &lt;george.shen@amd.com&gt;
    > Signed-off-by: Peterson Guo &lt;peterson.guo@amd.com&gt;
    > Signed-off-by: Alex Hung &lt;alex.hung@amd.com&gt;
    > Tested-by: Daniel Wheeler &lt;daniel.wheeler@amd.com&gt;
    > Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ drm/dp_mst: Verify request type in the corresponding down message reply (@Imre Deak in [f4e1544ab82ca71](https://github.com/sophgo/linux-riscv/commit/f4e1544ab82ca71) at 2024-12-14 19:03:28)
    > commit 4d49e77a973d3b5d1881663c3f122906a0702940 upstream.
    > After receiving the response for an MST down request message, the
    > response should be accepted/parsed only if the response type matches
    > that of the request. Ensure this by checking if the request type code
    > stored both in the request and the reply match, dropping the reply in
    > case of a mismatch.
    > This fixes the topology detection for an MST hub, as described in the
    > Closes link below, where the hub sends an incorrect reply message after
    > a CLEAR_PAYLOAD_TABLE -&gt; LINK_ADDRESS down request message sequence.
    > Cc: Lyude Paul &lt;lyude@redhat.com&gt;
    > Cc: &lt;stable@vger.kernel.org&gt;
    > Closes: https://gitlab.freedesktop.org/drm/i915/kernel/-/issues/12804
    > Reviewed-by: Lyude Paul &lt;lyude@redhat.com&gt;
    > Signed-off-by: Imre Deak &lt;imre.deak@intel.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20241203160223.2926014-3-imre.deak@intel.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ drm/amd/display: Limit VTotal range to max hw cap minus fp (@Dillon Varone in [f443172fbf9fde2](https://github.com/sophgo/linux-riscv/commit/f443172fbf9fde2) at 2024-12-14 19:03:28)
    > commit a29997b7ac1f5c816b543e0c56aa2b5b56baac24 upstream.
    > [WHY &amp; HOW]
    > Hardware does not support the VTotal to be between fp2 lines of the
    > maximum possible VTotal, so add a capability flag to track it and apply
    > where necessary.
    > Cc: Mario Limonciello &lt;mario.limonciello@amd.com&gt;
    > Cc: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Cc: stable@vger.kernel.org
    > Reviewed-by: Jun Lei &lt;jun.lei@amd.com&gt;
    > Reviewed-by: Anthony Koo &lt;anthony.koo@amd.com&gt;
    > Signed-off-by: Dillon Varone &lt;dillon.varone@amd.com&gt;
    > Signed-off-by: Alex Hung &lt;alex.hung@amd.com&gt;
    > Tested-by: Daniel Wheeler &lt;daniel.wheeler@amd.com&gt;
    > Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ drm/dp_mst: Fix resetting msg rx state after topology removal (@Imre Deak in [be826b4451fd187](https://github.com/sophgo/linux-riscv/commit/be826b4451fd187) at 2024-12-14 19:03:28)
    > commit a6fa67d26de385c3c7a23c1e109a0e23bfda4ec7 upstream.
    > If the MST topology is removed during the reception of an MST down reply
    > or MST up request sideband message, the
    > drm_dp_mst_topology_mgr::up_req_recv/down_rep_recv states could be reset
    > from one thread via drm_dp_mst_topology_mgr_set_mst(false), racing with
    > the reading/parsing of the message from another thread via
    > drm_dp_mst_handle_down_rep() or drm_dp_mst_handle_up_req(). The race is
    > possible since the reader/parser doesn&#x27;t hold any lock while accessing
    > the reception state. This in turn can lead to a memory corruption in the
    > reader/parser as described by commit bd2fccac61b4 (&quot;drm/dp_mst: Fix MST
    > sideband message body length check&quot;).
    > Fix the above by resetting the message reception state if needed before
    > reading/parsing a message. Another solution would be to hold the
    > drm_dp_mst_topology_mgr::lock for the whole duration of the message
    > reception/parsing in drm_dp_mst_handle_down_rep() and
    > drm_dp_mst_handle_up_req(), however this would require a bigger change.
    > Since the fix is also needed for stable, opting for the simpler solution
    > in this patch.
    > Cc: Lyude Paul &lt;lyude@redhat.com&gt;
    > Cc: &lt;stable@vger.kernel.org&gt;
    > Fixes: 1d082618bbf3 (&quot;drm/display/dp_mst: Fix down/up message handling after sink disconnect&quot;)
    > Closes: https://gitlab.freedesktop.org/drm/i915/kernel/-/issues/13056
    > Reviewed-by: Lyude Paul &lt;lyude@redhat.com&gt;
    > Signed-off-by: Imre Deak &lt;imre.deak@intel.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20241203160223.2926014-2-imre.deak@intel.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ drm/amd/display: Correct prefetch calculation (@Lo-an Chen in [a249735619a8050](https://github.com/sophgo/linux-riscv/commit/a249735619a8050) at 2024-12-14 19:03:28)
    > commit 24d3749c11d949972d8c22e75567dc90ff5482e7 upstream.
    > [WHY]
    > The minimum value of the dst_y_prefetch_equ was not correct
    > in prefetch calculation whice causes OPTC underflow.
    > [HOW]
    > Add the min operation of dst_y_prefetch_equ in prefetch calculation.
    > Cc: Mario Limonciello &lt;mario.limonciello@amd.com&gt;
    > Cc: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Cc: stable@vger.kernel.org
    > Reviewed-by: Nicholas Kazlauskas &lt;nicholas.kazlauskas@amd.com&gt;
    > Signed-off-by: Lo-an Chen &lt;lo-an.chen@amd.com&gt;
    > Signed-off-by: Alex Hung &lt;alex.hung@amd.com&gt;
    > Tested-by: Daniel Wheeler &lt;daniel.wheeler@amd.com&gt;
    > Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ drm/amdkfd: add MEC version that supports no PCIe atomics for GFX12 (@Sreekant Somasekharan in [0a2d502a0aec87b](https://github.com/sophgo/linux-riscv/commit/0a2d502a0aec87b) at 2024-12-14 19:03:28)
    > commit 33114f1057ea5cf40e604021711a9711a060fcb6 upstream.
    > Add MEC version from which alternate support for no PCIe atomics
    > is provided so that device is not skipped during KFD device init in
    > GFX1200/GFX1201.
    > Signed-off-by: Sreekant Somasekharan &lt;sreekant.somasekharan@amd.com&gt;
    > Reviewed-by: Harish Kasiviswanathan &lt;Harish.Kasiviswanathan@amd.com&gt;
    > Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Cc: stable@vger.kernel.org # 6.11.x
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ drm/amd/pm: fix and simplify workload handling (@Alex Deucher in [0a203ff705fd98e](https://github.com/sophgo/linux-riscv/commit/0a203ff705fd98e) at 2024-12-14 19:03:28)
    > commit 1443dd3c67f6d1a8bd1f810e598e2f0c6f19205c upstream.
    > smu-&gt;workload_mask is IP specific and should not be messed with in
    > the common code. The mask bits vary across SMU versions.
    > Move all handling of smu-&gt;workload_mask in to the backends and
    > simplify the code.  Store the user&#x27;s preference in smu-&gt;power_profile_mode
    > which will be reflected in sysfs.  For internal driver profile
    > switches for KFD or VCN, just update the workload mask so that the
    > user&#x27;s preference is retained.  Remove all of the extra now unused
    > workload related elements in the smu structure.
    > v2: use refcounts for workload profiles
    > v3: rework based on feedback from Lijo
    > v4: fix the refcount on failure, drop backend mask
    > v5: rework custom handling
    > v6: handle failure cleanup with custom profile
    > v7: Update documentation
    > Reviewed-by: Lijo Lazar &lt;lijo.lazar@amd.com&gt;
    > Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Cc: Kenneth Feng &lt;kenneth.feng@amd.com&gt;
    > Cc: Lijo Lazar &lt;lijo.lazar@amd.com&gt;
    > Cc: stable@vger.kernel.org # 6.11.x
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ selftest: hugetlb_dio: fix test naming (@Mark Brown in [ed9132d03854c37](https://github.com/sophgo/linux-riscv/commit/ed9132d03854c37) at 2024-12-14 19:03:27)
    > commit 4ae132c693896b0713db572676c90ffd855a4246 upstream.
    > The string logged when a test passes or fails is used by the selftest
    > framework to identify which test is being reported.  The hugetlb_dio test
    > not only uses the same strings for every test that is run but it also uses
    > different strings for test passes and failures which means that test
    > automation is unable to follow what the test is doing at all.
    > Pull the existing duplicated logging of the number of free huge pages
    > before and after the test out of the conditional and replace that and the
    > logging of the result with a single ksft_print_result() which incorporates
    > the parameters passed into the test into the output.
    > Link: https://lkml.kernel.org/r/20241127-kselftest-mm-hugetlb-dio-names-v1-1-22aab01bf550@kernel.org
    > Fixes: fae1980347bf (&quot;selftests: hugetlb_dio: fixup check for initial conditions to skip in the start&quot;)
    > Signed-off-by: Mark Brown &lt;broonie@kernel.org&gt;
    > Reviewed-by: Muhammad Usama Anjum &lt;usama.anjum@collabora.com&gt;
    > Cc: Donet Tom &lt;donettom@linux.ibm.com&gt;
    > Cc: Ritesh Harjani (IBM) &lt;ritesh.list@gmail.com&gt;
    > Cc: Shuah Khan &lt;shuah@kernel.org&gt;
    > Cc: &lt;stable@vger.kernel.org&gt;
    > Signed-off-by: Andrew Morton &lt;akpm@linux-foundation.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ drm/amdkfd: hard-code cacheline for gc943,gc944 (@David Yat Sin in [c206d13552de2f8](https://github.com/sophgo/linux-riscv/commit/c206d13552de2f8) at 2024-12-14 19:03:27)
    > commit 55ed120dcfdde2478c3ebfa1c0ac4ed1e430053b upstream.
    > Cacheline size is not available in IP discovery for gc943,gc944.
    > Signed-off-by: David Yat Sin &lt;David.YatSin@amd.com&gt;
    > Reviewed-by: Harish Kasiviswanathan &lt;Harish.Kasiviswanathan@amd.com&gt;
    > Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ selftests/damon: add _damon_sysfs.py to TEST_FILES (@Maximilian Heyne in [a32ea1d9ee710af](https://github.com/sophgo/linux-riscv/commit/a32ea1d9ee710af) at 2024-12-14 19:03:27)
    > commit 4a475c0a7eeb3368eca40fe7cb02d157eeddc77a upstream.
    > When running selftests I encountered the following error message with
    > some damon tests:
    > # Traceback (most recent call last):
    > #   File &quot;[...]/damon/./damos_quota.py&quot;, line 7, in &lt;module&gt;
    > #     import _damon_sysfs
    > # ModuleNotFoundError: No module named &#x27;_damon_sysfs&#x27;
    > Fix this by adding the _damon_sysfs.py file to TEST_FILES so that it
    > will be available when running the respective damon selftests.
    > Link: https://lkml.kernel.org/r/20241127-picks-visitor-7416685b-mheyne@amazon.de
    > Fixes: 306abb63a8ca (&quot;selftests/damon: implement a python module for test-purpose DAMON sysfs controls&quot;)
    > Signed-off-by: Maximilian Heyne &lt;mheyne@amazon.de&gt;
    > Reviewed-by: SeongJae Park &lt;sj@kernel.org&gt;
    > Cc: Shuah Khan &lt;shuah@kernel.org&gt;
    > Cc: &lt;stable@vger.kernel.org&gt;
    > Signed-off-by: Andrew Morton &lt;akpm@linux-foundation.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ cacheinfo: Allocate memory during CPU hotplug if not done from the primary CPU (@Ricardo Neri in [95e197354e0de07](https://github.com/sophgo/linux-riscv/commit/95e197354e0de07) at 2024-12-14 19:03:27)
    > commit b3fce429a1e030b50c1c91351d69b8667eef627b upstream.
    > Commit
    > 5944ce092b97 (&quot;arch_topology: Build cacheinfo from primary CPU&quot;)
    > adds functionality that architectures can use to optionally allocate and
    > build cacheinfo early during boot. Commit
    > 6539cffa9495 (&quot;cacheinfo: Add arch specific early level initializer&quot;)
    > lets secondary CPUs correct (and reallocate memory) cacheinfo data if
    > needed.
    > If the early build functionality is not used and cacheinfo does not need
    > correction, memory for cacheinfo is never allocated. x86 does not use
    > the early build functionality. Consequently, during the cacheinfo CPU
    > hotplug callback, last_level_cache_is_valid() attempts to dereference
    > a NULL pointer:
    > BUG: kernel NULL pointer dereference, address: 0000000000000100
    > #PF: supervisor read access in kernel mode
    > #PF: error_code(0x0000) - not present page
    > PGD 0 P4D 0
    > Oops: 0000 [#1] PREEPMT SMP NOPTI
    > CPU: 0 PID 19 Comm: cpuhp/0 Not tainted 6.4.0-rc2 #1
    > RIP: 0010: last_level_cache_is_valid+0x95/0xe0a
    > Allocate memory for cacheinfo during the cacheinfo CPU hotplug callback
    > if not done earlier.
    > Moreover, before determining the validity of the last-level cache info,
    > ensure that it has been allocated. Simply checking for non-zero
    > cache_leaves() is not sufficient, as some architectures (e.g., Intel
    > processors) have non-zero cache_leaves() before allocation.
    > Dereferencing NULL cacheinfo can occur in update_per_cpu_data_slice_size().
    > This function iterates over all online CPUs. However, a CPU may have come
    > online recently, but its cacheinfo may not have been allocated yet.
    > While here, remove an unnecessary indentation in allocate_cache_info().
    > [ bp: Massage. ]
    > Fixes: 6539cffa9495 (&quot;cacheinfo: Add arch specific early level initializer&quot;)
    > Signed-off-by: Ricardo Neri &lt;ricardo.neri-calderon@linux.intel.com&gt;
    > Signed-off-by: Borislav Petkov (AMD) &lt;bp@alien8.de&gt;
    > Reviewed-by: Radu Rendec &lt;rrendec@redhat.com&gt;
    > Reviewed-by: Nikolay Borisov &lt;nik.borisov@suse.com&gt;
    > Reviewed-by: Andreas Herrmann &lt;aherrmann@suse.de&gt;
    > Reviewed-by: Sudeep Holla &lt;sudeep.holla@arm.com&gt;
    > Cc: stable@vger.kernel.org # 6.3+
    > Link: https://lore.kernel.org/r/20241128002247.26726-2-ricardo.neri-calderon@linux.intel.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ x86/cacheinfo: Delete global num_cache_leaves (@Ricardo Neri in [76ce78cab7055bd](https://github.com/sophgo/linux-riscv/commit/76ce78cab7055bd) at 2024-12-14 19:03:27)
    > commit 9677be09e5e4fbe48aeccb06ae3063c5eba331c3 upstream.
    > Linux remembers cpu_cachinfo::num_leaves per CPU, but x86 initializes all
    > CPUs from the same global &quot;num_cache_leaves&quot;.
    > This is erroneous on systems such as Meteor Lake, where each CPU has a
    > distinct num_leaves value. Delete the global &quot;num_cache_leaves&quot; and
    > initialize num_leaves on each CPU.
    > init_cache_level() no longer needs to set num_leaves. Also, it never had to
    > set num_levels as it is unnecessary in x86. Keep checking for zero cache
    > leaves. Such condition indicates a bug.
    > [ bp: Cleanup. ]
    > Signed-off-by: Ricardo Neri &lt;ricardo.neri-calderon@linux.intel.com&gt;
    > Signed-off-by: Borislav Petkov (AMD) &lt;bp@alien8.de&gt;
    > Cc: stable@vger.kernel.org # 6.3+
    > Link: https://lore.kernel.org/r/20241128002247.26726-3-ricardo.neri-calderon@linux.intel.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ drm/dp_mst: Fix MST sideband message body length check (@Imre Deak in [1fc1f32c4a3421b](https://github.com/sophgo/linux-riscv/commit/1fc1f32c4a3421b) at 2024-12-14 19:03:27)
    > commit bd2fccac61b40eaf08d9546acc9fef958bfe4763 upstream.
    > Fix the MST sideband message body length check, which must be at least 1
    > byte accounting for the message body CRC (aka message data CRC) at the
    > end of the message.
    > This fixes a case where an MST branch device returns a header with a
    > correct header CRC (indicating a correctly received body length), with
    > the body length being incorrectly set to 0. This will later lead to a
    > memory corruption in drm_dp_sideband_append_payload() and the following
    > errors in dmesg:
    > UBSAN: array-index-out-of-bounds in drivers/gpu/drm/display/drm_dp_mst_topology.c:786:25
    > index -1 is out of range for type &#x27;u8 [48]&#x27;
    > Call Trace:
    > drm_dp_sideband_append_payload+0x33d/0x350 [drm_display_helper]
    > drm_dp_get_one_sb_msg+0x3ce/0x5f0 [drm_display_helper]
    > drm_dp_mst_hpd_irq_handle_event+0xc8/0x1580 [drm_display_helper]
    > memcpy: detected field-spanning write (size 18446744073709551615) of single field &quot;&amp;msg-&gt;msg[msg-&gt;curlen]&quot; at drivers/gpu/drm/display/drm_dp_mst_topology.c:791 (size 256)
    > Call Trace:
    > drm_dp_sideband_append_payload+0x324/0x350 [drm_display_helper]
    > drm_dp_get_one_sb_msg+0x3ce/0x5f0 [drm_display_helper]
    > drm_dp_mst_hpd_irq_handle_event+0xc8/0x1580 [drm_display_helper]
    > Cc: &lt;stable@vger.kernel.org&gt;
    > Cc: Lyude Paul &lt;lyude@redhat.com&gt;
    > Reviewed-by: Lyude Paul &lt;lyude@redhat.com&gt;
    > Signed-off-by: Imre Deak &lt;imre.deak@intel.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20241125205314.1725887-1-imre.deak@intel.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ fs/smb/client: Implement new SMB3 POSIX type (@Ralph Boehme in [aeb255487559f13](https://github.com/sophgo/linux-riscv/commit/aeb255487559f13) at 2024-12-14 19:03:26)
    > commit 6a832bc8bbb22350f7ffe6ecb2d36f261bb96023 upstream.
    > Fixes special files against current Samba.
    > On the Samba server:
    > insgesamt 20
    > 131958 brw-r--r--  1 root  root  0, 0 15. Nov 12:04 blockdev
    > 131965 crw-r--r--  1 root  root  1, 1 15. Nov 12:04 chardev
    > 131966 prw-r--r--  1 samba samba    0 15. Nov 12:05 fifo
    > 131953 -rw-rwxrw-+ 2 samba samba    4 18. Nov 11:37 file
    > 131953 -rw-rwxrw-+ 2 samba samba    4 18. Nov 11:37 hardlink
    > 131957 lrwxrwxrwx  1 samba samba    4 15. Nov 12:03 symlink -&gt; file
    > 131954 -rwxrwxr-x+ 1 samba samba    0 18. Nov 15:28 symlinkoversmb
    > Before:
    > ls: cannot access &#x27;/mnt/smb3unix/posix/blockdev&#x27;: No data available
    > ls: cannot access &#x27;/mnt/smb3unix/posix/chardev&#x27;: No data available
    > ls: cannot access &#x27;/mnt/smb3unix/posix/symlinkoversmb&#x27;: No data available
    > ls: cannot access &#x27;/mnt/smb3unix/posix/fifo&#x27;: No data available
    > ls: cannot access &#x27;/mnt/smb3unix/posix/symlink&#x27;: No data available
    > total 16
    > ? -????????? ? ?    ?     ?            ? blockdev
    > ? -????????? ? ?    ?     ?            ? chardev
    > ? -????????? ? ?    ?     ?            ? fifo
    > 131953 -rw-rwxrw- 2 root samba 4 Nov 18 11:37 file
    > 131953 -rw-rwxrw- 2 root samba 4 Nov 18 11:37 hardlink
    > ? -????????? ? ?    ?     ?            ? symlink
    > ? -????????? ? ?    ?     ?            ? symlinkoversmb
    > After:
    > insgesamt 21
    > 131958 brw-r--r-- 1 root root  0, 0 15. Nov 12:04 blockdev
    > 131965 crw-r--r-- 1 root root  1, 1 15. Nov 12:04 chardev
    > 131966 prw-r--r-- 1 root samba    0 15. Nov 12:05 fifo
    > 131953 -rw-rwxrw- 2 root samba    4 18. Nov 11:37 file
    > 131953 -rw-rwxrw- 2 root samba    4 18. Nov 11:37 hardlink
    > 131957 lrwxrwxrwx 1 root samba    4 15. Nov 12:03 symlink -&gt; file
    > 131954 lrwxrwxr-x 1 root samba   23 18. Nov 15:28 symlinkoversmb -&gt; mnt/smb3unix/posix/file
    > Cc: stable@vger.kernel.org
    > Acked-by: Paulo Alcantara (Red Hat) &lt;pc@manguebit.com&gt;
    > Signed-off-by: Ralph Boehme &lt;slow@samba.org&gt;
    > Signed-off-by: Steve French &lt;stfrench@microsoft.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ pmdomain: imx: gpcv2: Adjust delay after power up handshake (@Shengjiu Wang in [a63907c8c712414](https://github.com/sophgo/linux-riscv/commit/a63907c8c712414) at 2024-12-14 19:03:26)
    > commit 2379fb937de5333991c567eefd7d11b98977d059 upstream.
    > The udelay(5) is not enough, sometimes below kernel panic
    > still be triggered:
    > [    4.012973] Kernel panic - not syncing: Asynchronous SError Interrupt
    > [    4.012976] CPU: 2 UID: 0 PID: 186 Comm: (udev-worker) Not tainted 6.12.0-rc2-0.0.0-devel-00004-g8b1b79e88956 #1
    > [    4.012982] Hardware name: Toradex Verdin iMX8M Plus WB on Dahlia Board (DT)
    > [    4.012985] Call trace:
    > [...]
    > [    4.013029]  arm64_serror_panic+0x64/0x70
    > [    4.013034]  do_serror+0x3c/0x70
    > [    4.013039]  el1h_64_error_handler+0x30/0x54
    > [    4.013046]  el1h_64_error+0x64/0x68
    > [    4.013050]  clk_imx8mp_audiomix_runtime_resume+0x38/0x48
    > [    4.013059]  __genpd_runtime_resume+0x30/0x80
    > [    4.013066]  genpd_runtime_resume+0x114/0x29c
    > [    4.013073]  __rpm_callback+0x48/0x1e0
    > [    4.013079]  rpm_callback+0x68/0x80
    > [    4.013084]  rpm_resume+0x3bc/0x6a0
    > [    4.013089]  __pm_runtime_resume+0x50/0x9c
    > [    4.013095]  pm_runtime_get_suppliers+0x60/0x8c
    > [    4.013101]  __driver_probe_device+0x4c/0x14c
    > [    4.013108]  driver_probe_device+0x3c/0x120
    > [    4.013114]  __driver_attach+0xc4/0x200
    > [    4.013119]  bus_for_each_dev+0x7c/0xe0
    > [    4.013125]  driver_attach+0x24/0x30
    > [    4.013130]  bus_add_driver+0x110/0x240
    > [    4.013135]  driver_register+0x68/0x124
    > [    4.013142]  __platform_driver_register+0x24/0x30
    > [    4.013149]  sdma_driver_init+0x20/0x1000 [imx_sdma]
    > [    4.013163]  do_one_initcall+0x60/0x1e0
    > [    4.013168]  do_init_module+0x5c/0x21c
    > [    4.013175]  load_module+0x1a98/0x205c
    > [    4.013181]  init_module_from_file+0x88/0xd4
    > [    4.013187]  __arm64_sys_finit_module+0x258/0x350
    > [    4.013194]  invoke_syscall.constprop.0+0x50/0xe0
    > [    4.013202]  do_el0_svc+0xa8/0xe0
    > [    4.013208]  el0_svc+0x3c/0x140
    > [    4.013215]  el0t_64_sync_handler+0x120/0x12c
    > [    4.013222]  el0t_64_sync+0x190/0x194
    > [    4.013228] SMP: stopping secondary CPUs
    > The correct way is to wait handshake, but it needs BUS clock of
    > BLK-CTL be enabled, which is in separate driver. So delay is the
    > only option here. The udelay(10) is a data got by experiment.
    > Fixes: e8dc41afca16 (&quot;pmdomain: imx: gpcv2: Add delay after power up handshake&quot;)
    > Reported-by: Francesco Dolcini &lt;francesco@dolcini.it&gt;
    > Closes: https://lore.kernel.org/lkml/20241007132555.GA53279@francesco-nb/
    > Signed-off-by: Shengjiu Wang &lt;shengjiu.wang@nxp.com&gt;
    > Cc: stable@vger.kernel.org
    > Message-ID: &lt;20241121075231.3910922-1-shengjiu.wang@nxp.com&gt;
    > Signed-off-by: Ulf Hansson &lt;ulf.hansson@linaro.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ Revert &quot;readahead: properly shorten readahead when falling back to do_page_cache_ra()&quot; (@Jan Kara in [85351e4941a253e](https://github.com/sophgo/linux-riscv/commit/85351e4941a253e) at 2024-12-14 19:03:26)
    > commit a220d6b95b1ae12c7626283d7609f0a1438e6437 upstream.
    > This reverts commit 7c877586da3178974a8a94577b6045a48377ff25.
    > Anders and Philippe have reported that recent kernels occasionally hang
    > when used with NFS in readahead code.  The problem has been bisected to
    > 7c877586da3 (&quot;readahead: properly shorten readahead when falling back to
    > do_page_cache_ra()&quot;).  The cause of the problem is that ra-&gt;size can be
    > shrunk by read_pages() call and subsequently we end up calling
    > do_page_cache_ra() with negative (read huge positive) number of pages.
    > Let&#x27;s revert 7c877586da3 for now until we can find a proper way how the
    > logic in read_pages() and page_cache_ra_order() can coexist.  This can
    > lead to reduced readahead throughput due to readahead window confusion but
    > that&#x27;s better than outright hangs.
    > Link: https://lkml.kernel.org/r/20241126145208.985-1-jack@suse.cz
    > Fixes: 7c877586da31 (&quot;readahead: properly shorten readahead when falling back to do_page_cache_ra()&quot;)
    > Reported-by: Anders Blomdell &lt;anders.blomdell@gmail.com&gt;
    > Reported-by: Philippe Troin &lt;phil@fifi.org&gt;
    > Signed-off-by: Jan Kara &lt;jack@suse.cz&gt;
    > Tested-by: Philippe Troin &lt;phil@fifi.org&gt;
    > Cc: Matthew Wilcox &lt;willy@infradead.org&gt;
    > Cc: &lt;stable@vger.kernel.org&gt;
    > Signed-off-by: Andrew Morton &lt;akpm@linux-foundation.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ io_uring: Change res2 parameter type in io_uring_cmd_done (@Bernd Schubert in [793e560a6b7ca99](https://github.com/sophgo/linux-riscv/commit/793e560a6b7ca99) at 2024-12-14 19:03:26)
    > commit a07d2d7930c75e6bf88683b376d09ab1f3fed2aa upstream.
    > Change the type of the res2 parameter in io_uring_cmd_done from ssize_t
    > to u64. This aligns the parameter type with io_req_set_cqe32_extra,
    > which expects u64 arguments.
    > The change eliminates potential issues on 32-bit architectures where
    > ssize_t might be 32-bit.
    > Only user of passing res2 is drivers/nvme/host/ioctl.c and it actually
    > passes u64.
    > Fixes: ee692a21e9bf (&quot;fs,io_uring: add infrastructure for uring-cmd&quot;)
    > Cc: stable@vger.kernel.org
    > Reviewed-by: Kanchan Joshi &lt;joshi.k@samsung.com&gt;
    > Tested-by: Li Zetao &lt;lizetao1@huawei.com&gt;
    > Reviewed-by: Li Zetao &lt;lizetao1@huawei.com&gt;
    > Signed-off-by: Bernd Schubert &lt;bschubert@ddn.com&gt;
    > Link: https://lore.kernel.org/r/20241203-io_uring_cmd_done-res2-as-u64-v2-1-5e59ae617151@ddn.com
    > Signed-off-by: Jens Axboe &lt;axboe@kernel.dk&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ smb3.1.1: fix posix mounts to older servers (@Steve French in [74aaafabd3c1cfd](https://github.com/sophgo/linux-riscv/commit/74aaafabd3c1cfd) at 2024-12-14 19:03:26)
    > commit ddca5023091588eb303e3c0097d95c325992d05f upstream.
    > Some servers which implement the SMB3.1.1 POSIX extensions did not
    > set the file type in the mode in the infolevel 100 response.
    > With the recent changes for checking the file type via the mode field,
    > this can cause the root directory to be reported incorrectly and
    > mounts (e.g. to ksmbd) to fail.
    > Fixes: 6a832bc8bbb2 (&quot;fs/smb/client: Implement new SMB3 POSIX type&quot;)
    > Cc: stable@vger.kernel.org
    > Acked-by: Paulo Alcantara (Red Hat) &lt;pc@manguebit.com&gt;
    > Cc: Ralph Boehme &lt;slow@samba.org&gt;
    > Signed-off-by: Steve French &lt;stfrench@microsoft.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ fs/smb/client: cifs_prime_dcache() for SMB3 POSIX reparse points (@Ralph Boehme in [6e4672301e71951](https://github.com/sophgo/linux-riscv/commit/6e4672301e71951) at 2024-12-14 19:03:26)
    > commit 8cb0bc5436351de8a11eef13b7367d64cc0d6c68 upstream.
    > Spares an extra revalidation request
    > Cc: stable@vger.kernel.org
    > Acked-by: Paulo Alcantara (Red Hat) &lt;pc@manguebit.com&gt;
    > Signed-off-by: Ralph Boehme &lt;slow@samba.org&gt;
    > Signed-off-by: Steve French &lt;stfrench@microsoft.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ bcache: revert replacing IS_ERR_OR_NULL with IS_ERR again (@Liequan Che in [5e0e913624bcd24](https://github.com/sophgo/linux-riscv/commit/5e0e913624bcd24) at 2024-12-14 19:03:26)
    > commit b2e382ae12a63560fca35050498e19e760adf8c0 upstream.
    > Commit 028ddcac477b (&quot;bcache: Remove unnecessary NULL point check in
    > node allocations&quot;) leads a NULL pointer deference in cache_set_flush().
    > 1721         if (!IS_ERR_OR_NULL(c-&gt;root))
    > 1722                 list_add(&amp;c-&gt;root-&gt;list, &amp;c-&gt;btree_cache);
    > &gt;From the above code in cache_set_flush(), if previous registration code
    > fails before allocating c-&gt;root, it is possible c-&gt;root is NULL as what
    > it is initialized. __bch_btree_node_alloc() never returns NULL but
    > c-&gt;root is possible to be NULL at above line 1721.
    > This patch replaces IS_ERR() by IS_ERR_OR_NULL() to fix this.
    > Fixes: 028ddcac477b (&quot;bcache: Remove unnecessary NULL point check in node allocations&quot;)
    > Signed-off-by: Liequan Che &lt;cheliequan@inspur.com&gt;
    > Cc: stable@vger.kernel.org
    > Cc: Zheng Wang &lt;zyytlz.wz@163.com&gt;
    > Reviewed-by: Mingzhe Zou &lt;mingzhe.zou@easystack.cn&gt;
    > Signed-off-by: Coly Li &lt;colyli@suse.de&gt;
    > Link: https://lore.kernel.org/r/20241202115638.28957-1-colyli@suse.de
    > Signed-off-by: Jens Axboe &lt;axboe@kernel.dk&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ scsi: ufs: qcom: Only free platform MSIs when ESI is enabled (@Manivannan Sadhasivam in [f99cb5f6344ef93](https://github.com/sophgo/linux-riscv/commit/f99cb5f6344ef93) at 2024-12-14 19:03:25)
    > commit 64506b3d23a337e98a74b18dcb10c8619365f2bd upstream.
    > Otherwise, it will result in a NULL pointer dereference as below:
    > Unable to handle kernel NULL pointer dereference at virtual address 0000000000000008
    > Call trace:
    > mutex_lock+0xc/0x54
    > platform_device_msi_free_irqs_all+0x14/0x20
    > ufs_qcom_remove+0x34/0x48 [ufs_qcom]
    > platform_remove+0x28/0x44
    > device_remove+0x4c/0x80
    > device_release_driver_internal+0xd8/0x178
    > driver_detach+0x50/0x9c
    > bus_remove_driver+0x6c/0xbc
    > driver_unregister+0x30/0x60
    > platform_driver_unregister+0x14/0x20
    > ufs_qcom_pltform_exit+0x18/0xb94 [ufs_qcom]
    > __arm64_sys_delete_module+0x180/0x260
    > invoke_syscall+0x44/0x100
    > el0_svc_common.constprop.0+0xc0/0xe0
    > do_el0_svc+0x1c/0x28
    > el0_svc+0x34/0xdc
    > el0t_64_sync_handler+0xc0/0xc4
    > el0t_64_sync+0x190/0x194
    > Cc: stable@vger.kernel.org # 6.3
    > Fixes: 519b6274a777 (&quot;scsi: ufs: qcom: Add MCQ ESI config vendor specific ops&quot;)
    > Signed-off-by: Manivannan Sadhasivam &lt;manivannan.sadhasivam@linaro.org&gt;
    > Link: https://lore.kernel.org/r/20241111-ufs_bug_fix-v1-2-45ad8b62f02e@linaro.org
    > Reviewed-by: Bean Huo &lt;beanhuo@micron.com&gt;
    > Reviewed-by: Bart Van Assche &lt;bvanassche@acm.org&gt;
    > Signed-off-by: Martin K. Petersen &lt;martin.petersen@oracle.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ scsi: ufs: pltfrm: Disable runtime PM during removal of glue drivers (@Manivannan Sadhasivam in [8c9425768c38ae2](https://github.com/sophgo/linux-riscv/commit/8c9425768c38ae2) at 2024-12-14 19:03:25)
    > commit d3326e6a3f9bf1e075be2201fb704c2fdf19e2b7 upstream.
    > When the UFSHCD platform glue drivers are removed, runtime PM should be
    > disabled using pm_runtime_disable() to balance the enablement done in
    > ufshcd_pltfrm_init(). This is also reported by PM core when the glue driver
    > is removed and inserted again:
    > ufshcd-qcom 1d84000.ufshc: Unbalanced pm_runtime_enable!
    > So disable runtime PM using a new helper API ufshcd_pltfrm_remove(), that
    > also takes care of removing ufshcd. This helper should be called during the
    > remove() stage of glue drivers.
    > Cc: stable@vger.kernel.org # 3.12
    > Fixes: 62694735ca95 (&quot;[SCSI] ufs: Add runtime PM support for UFS host controller driver&quot;)
    > Signed-off-by: Manivannan Sadhasivam &lt;manivannan.sadhasivam@linaro.org&gt;
    > Link: https://lore.kernel.org/r/20241111-ufs_bug_fix-v1-3-45ad8b62f02e@linaro.org
    > Reviewed-by: Peter Wang &lt;peter.wang@mediatek.com&gt;
    > Reviewed-by: Bean Huo &lt;beanhuo@micron.com&gt;
    > Reviewed-by: Bart Van Assche &lt;bvanassche@acm.org&gt;
    > Signed-off-by: Martin K. Petersen &lt;martin.petersen@oracle.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ scsi: ufs: core: Add missing post notify for power mode change (@Peter Wang in [5a717f43c2ead19](https://github.com/sophgo/linux-riscv/commit/5a717f43c2ead19) at 2024-12-14 19:03:25)
    > commit 7f45ed5f0cd5ccbbec79adc6c48a67d6a85fba56 upstream.
    > When the power mode change is successful but the power mode hasn&#x27;t
    > actually changed, the post notification was missed.  Similar to the
    > approach with hibernate/clock scale/hce enable, having pre/post
    > notifications in the same function will make it easier to maintain.
    > Additionally, supplement the description of power parameters for the
    > pwr_change_notify callback.
    > Fixes: 7eb584db73be (&quot;ufs: refactor configuring power mode&quot;)
    > Cc: stable@vger.kernel.org #6.11.x
    > Signed-off-by: Peter Wang &lt;peter.wang@mediatek.com&gt;
    > Link: https://lore.kernel.org/r/20241122024943.30589-1-peter.wang@mediatek.com
    > Reviewed-by: Bart Van Assche &lt;bvanassche@acm.org&gt;
    > Signed-off-by: Martin K. Petersen &lt;martin.petersen@oracle.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ fs/smb/client: avoid querying SMB2_OP_QUERY_WSL_EA for SMB3 POSIX (@Ralph Boehme in [469e955d757e12c](https://github.com/sophgo/linux-riscv/commit/469e955d757e12c) at 2024-12-14 19:03:25)
    > commit ca4b2c4607433033e9c4f4659f809af4261d8992 upstream.
    > Avoid extra roundtrip
    > Cc: stable@vger.kernel.org
    > Acked-by: Paulo Alcantara (Red Hat) &lt;pc@manguebit.com&gt;
    > Signed-off-by: Ralph Boehme &lt;slow@samba.org&gt;
    > Signed-off-by: Steve French &lt;stfrench@microsoft.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ nilfs2: fix potential out-of-bounds memory access in nilfs_find_entry() (@Ryusuke Konishi in [31f7b57a77d4c82](https://github.com/sophgo/linux-riscv/commit/31f7b57a77d4c82) at 2024-12-14 19:03:25)
    > commit 985ebec4ab0a28bb5910c3b1481a40fbf7f9e61d upstream.
    > Syzbot reported that when searching for records in a directory where the
    > inode&#x27;s i_size is corrupted and has a large value, memory access outside
    > the folio/page range may occur, or a use-after-free bug may be detected if
    > KASAN is enabled.
    > This is because nilfs_last_byte(), which is called by nilfs_find_entry()
    > and others to calculate the number of valid bytes of directory data in a
    > page from i_size and the page index, loses the upper 32 bits of the 64-bit
    > size information due to an inappropriate type of local variable to which
    > the i_size value is assigned.
    > This caused a large byte offset value due to underflow in the end address
    > calculation in the calling nilfs_find_entry(), resulting in memory access
    > that exceeds the folio/page size.
    > Fix this issue by changing the type of the local variable causing the bit
    > loss from &quot;unsigned int&quot; to &quot;u64&quot;.  The return value of nilfs_last_byte()
    > is also of type &quot;unsigned int&quot;, but it is truncated so as not to exceed
    > PAGE_SIZE and no bit loss occurs, so no change is required.
    > Link: https://lkml.kernel.org/r/20241119172403.9292-1-konishi.ryusuke@gmail.com
    > Fixes: 2ba466d74ed7 (&quot;nilfs2: directory entry operations&quot;)
    > Signed-off-by: Ryusuke Konishi &lt;konishi.ryusuke@gmail.com&gt;
    > Reported-by: syzbot+96d5d14c47d97015c624@syzkaller.appspotmail.com
    > Closes: https://syzkaller.appspot.com/bug?extid&#x3D;96d5d14c47d97015c624
    > Tested-by: syzbot+96d5d14c47d97015c624@syzkaller.appspotmail.com
    > Cc: &lt;stable@vger.kernel.org&gt;
    > Signed-off-by: Andrew Morton &lt;akpm@linux-foundation.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ scsi: ufs: core: Cancel RTC work during ufshcd_remove() (@Manivannan Sadhasivam in [2e7a3bb0331efb2](https://github.com/sophgo/linux-riscv/commit/2e7a3bb0331efb2) at 2024-12-14 19:03:25)
    > commit 1695c4361d35b7bdadd7b34f99c9c07741e181e5 upstream.
    > Currently, RTC work is only cancelled during __ufshcd_wl_suspend(). When
    > ufshcd is removed in ufshcd_remove(), RTC work is not cancelled. Due to
    > this, any further trigger of the RTC work after ufshcd_remove() would
    > result in a NULL pointer dereference as below:
    > Unable to handle kernel NULL pointer dereference at virtual address 00000000000002a4
    > Workqueue: events ufshcd_rtc_work
    > Call trace:
    > _raw_spin_lock_irqsave+0x34/0x8c
    > pm_runtime_get_if_active+0x24/0xb4
    > ufshcd_rtc_work+0x124/0x19c
    > process_scheduled_works+0x18c/0x2d8
    > worker_thread+0x144/0x280
    > kthread+0x11c/0x128
    > ret_from_fork+0x10/0x20
    > Since RTC work accesses the ufshcd internal structures, it should be cancelled
    > when ufshcd is removed. So do that in ufshcd_remove(), as per the order in
    > ufshcd_init().
    > Cc: stable@vger.kernel.org # 6.8
    > Fixes: 6bf999e0eb41 (&quot;scsi: ufs: core: Add UFS RTC support&quot;)
    > Signed-off-by: Manivannan Sadhasivam &lt;manivannan.sadhasivam@linaro.org&gt;
    > Link: https://lore.kernel.org/r/20241111-ufs_bug_fix-v1-1-45ad8b62f02e@linaro.org
    > Reviewed-by: Peter Wang &lt;peter.wang@mediatek.com&gt;
    > Reviewed-by: Bean Huo &lt;beanhuo@micron.com&gt;
    > Reviewed-by: Bart Van Assche &lt;bvanassche@acm.org&gt;
    > Signed-off-by: Martin K. Petersen &lt;martin.petersen@oracle.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ scsi: qla2xxx: Fix abort in bsg timeout (@Quinn Tran in [b89012158525c6b](https://github.com/sophgo/linux-riscv/commit/b89012158525c6b) at 2024-12-14 19:03:24)
    > commit c423263082ee8ccfad59ab33e3d5da5dc004c21e upstream.
    > Current abort of bsg on timeout prematurely clears the
    > outstanding_cmds[]. Abort does not allow FW to return the IOCB/SRB. In
    > addition, bsg_job_done() is not called to return the BSG (i.e. leak).
    > Abort the outstanding bsg/SRB and wait for the completion. The
    > completion IOCB will wake up the bsg_timeout thread. If abort is not
    > successful, then driver will forcibly call bsg_job_done() and free the
    > srb.
    > Err Inject:
    > - qaucli -z
    > - assign CT Passthru IOCB&#x27;s NportHandle with another initiator
    > nport handle to trigger timeout.  Remote port will drop CT request.
    > - bsg_job_done is properly called as part of cleanup
    > kernel: qla2xxx [0000:21:00.1]-7012:7: qla2x00_process_ct : 286 : Error Inject.
    > kernel: qla2xxx [0000:21:00.1]-7016:7: bsg rqst type: FC_BSG_HST_CT else type: 101 - loop-id&#x3D;1 portid&#x3D;fffffa.
    > kernel: qla2xxx [0000:21:00.1]-70bb:7: qla24xx_bsg_timeout CMD timeout. bsg ptr ffff9971a42f0838 msgcode 80000004 vendor cmd fa010000
    > kernel: qla2xxx [0000:21:00.1]-507c:7: Abort command issued - hdl&#x3D;4b, type&#x3D;5
    > kernel: qla2xxx [0000:21:00.1]-5040:7: ELS-CT pass-through-ct pass-through error hdl&#x3D;4b comp_status-status&#x3D;0x5 error subcode 1&#x3D;0x0 error subcode 2&#x3D;0xaf882e80.
    > kernel: qla2xxx [0000:21:00.1]-7009:7: qla2x00_bsg_job_done: sp hdl 4b, result&#x3D;70000 bsg ptr ffff9971a42f0838
    > kernel: qla2xxx [0000:21:00.1]-802c:7: Aborting bsg ffff9971a42f0838 sp&#x3D;ffff99760b87ba80 handle&#x3D;4b rval&#x3D;0
    > kernel: qla2xxx [0000:21:00.1]-708a:7: bsg abort success. bsg ffff9971a42f0838 sp&#x3D;ffff99760b87ba80 handle&#x3D;0x4b
    > kernel: qla2xxx [0000:21:00.1]-7012:7: qla2x00_process_ct : 286 : Error Inject.
    > kernel: qla2xxx [0000:21:00.1]-7016:7: bsg rqst type: FC_BSG_HST_CT else type: 101 - loop-id&#x3D;1 portid&#x3D;fffffa.
    > kernel: qla2xxx [0000:21:00.1]-70bb:7: qla24xx_bsg_timeout CMD timeout. bsg ptr ffff9971a42f43b8 msgcode 80000004 vendor cmd fa010000
    > kernel: qla2xxx [0000:21:00.1]-7012:7: qla_bsg_found : 2206 : Error Inject 2.
    > kernel: qla2xxx [0000:21:00.1]-802c:7: Aborting bsg ffff9971a42f43b8 sp&#x3D;ffff99762c304440 handle&#x3D;5e rval&#x3D;5
    > kernel: qla2xxx [0000:21:00.1]-704f:7: bsg abort fail.  bsg&#x3D;ffff9971a42f43b8 sp&#x3D;ffff99762c304440 rval&#x3D;5.
    > kernel: qla2xxx [0000:21:00.1]-7051:7: qla_bsg_found bsg_job_done : bsg ffff9971a42f43b8 result 0xfffffffa sp ffff99762c304440.
    > Cc: stable@vger.kernel.org
    > Fixes: c449b4198701 (&quot;scsi: qla2xxx: Use QP lock to search for bsg&quot;)
    > Signed-off-by: Quinn Tran &lt;qutran@marvell.com&gt;
    > Signed-off-by: Nilesh Javali &lt;njavali@marvell.com&gt;
    > Link: https://lore.kernel.org/r/20241115130313.46826-2-njavali@marvell.com
    > Reviewed-by: Himanshu Madhani &lt;himanshu.madhani@oracle.com&gt;
    > Signed-off-by: Martin K. Petersen &lt;martin.petersen@oracle.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ scsi: ufs: core: sysfs: Prevent div by zero (@Gwendal Grignou in [9c191055c7abea4](https://github.com/sophgo/linux-riscv/commit/9c191055c7abea4) at 2024-12-14 19:03:24)
    > commit eb48e9fc0028bed94a40a9352d065909f19e333c upstream.
    > Prevent a division by 0 when monitoring is not enabled.
    > Fixes: 1d8613a23f3c (&quot;scsi: ufs: core: Introduce HBA performance monitor sysfs nodes&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Gwendal Grignou &lt;gwendal@chromium.org&gt;
    > Link: https://lore.kernel.org/r/20241120062522.917157-1-gwendal@chromium.org
    > Reviewed-by: Can Guo &lt;quic_cang@quicinc.com&gt;
    > Signed-off-by: Martin K. Petersen &lt;martin.petersen@oracle.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ scsi: qla2xxx: Fix use after free on unload (@Quinn Tran in [6abf16d3c915b2f](https://github.com/sophgo/linux-riscv/commit/6abf16d3c915b2f) at 2024-12-14 19:03:24)
    > commit 07c903db0a2ff84b68efa1a74a4de353ea591eb0 upstream.
    > System crash is observed with stack trace warning of use after
    > free. There are 2 signals to tell dpc_thread to terminate (UNLOADING
    > flag and kthread_stop).
    > On setting the UNLOADING flag when dpc_thread happens to run at the time
    > and sees the flag, this causes dpc_thread to exit and clean up
    > itself. When kthread_stop is called for final cleanup, this causes use
    > after free.
    > Remove UNLOADING signal to terminate dpc_thread.  Use the kthread_stop
    > as the main signal to exit dpc_thread.
    > [596663.812935] kernel BUG at mm/slub.c:294!
    > [596663.812950] invalid opcode: 0000 [#1] SMP PTI
    > [596663.812957] CPU: 13 PID: 1475935 Comm: rmmod Kdump: loaded Tainted: G          IOE    --------- -  - 4.18.0-240.el8.x86_64 #1
    > [596663.812960] Hardware name: HP ProLiant DL380p Gen8, BIOS P70 08/20/2012
    > [596663.812974] RIP: 0010:__slab_free+0x17d/0x360
    > ...
    > [596663.813008] Call Trace:
    > [596663.813022]  ? __dentry_kill+0x121/0x170
    > [596663.813030]  ? _cond_resched+0x15/0x30
    > [596663.813034]  ? _cond_resched+0x15/0x30
    > [596663.813039]  ? wait_for_completion+0x35/0x190
    > [596663.813048]  ? try_to_wake_up+0x63/0x540
    > [596663.813055]  free_task+0x5a/0x60
    > [596663.813061]  kthread_stop+0xf3/0x100
    > [596663.813103]  qla2x00_remove_one+0x284/0x440 [qla2xxx]
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Quinn Tran &lt;qutran@marvell.com&gt;
    > Signed-off-by: Nilesh Javali &lt;njavali@marvell.com&gt;
    > Link: https://lore.kernel.org/r/20241115130313.46826-3-njavali@marvell.com
    > Reviewed-by: Himanshu Madhani &lt;himanshu.madhani@oracle.com&gt;
    > Signed-off-by: Martin K. Petersen &lt;martin.petersen@oracle.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ scsi: qla2xxx: Fix NVMe and NPIV connect issue (@Quinn Tran in [5d1f2b471cde03b](https://github.com/sophgo/linux-riscv/commit/5d1f2b471cde03b) at 2024-12-14 19:03:24)
    > commit 4812b7796c144f63a1094f79a5eb8fbdad8d7ebc upstream.
    > NVMe controller fails to send connect command due to failure to locate
    > hw context buffer for NVMe queue 0 (blk_mq_hw_ctx, hctx_idx&#x3D;0). The
    > cause of the issue is NPIV host did not initialize the vha-&gt;irq_offset
    > field.  This field is given to blk-mq (blk_mq_pci_map_queues) to help
    > locate the beginning of IO Queues which in turn help locate NVMe queue
    > 0.
    > Initialize this field to allow NVMe to work properly with NPIV host.
    > kernel: nvme nvme5: Connect command failed, errno: -18
    > kernel: nvme nvme5: qid 0: secure concatenation is not supported
    > kernel: nvme nvme5: NVME-FC{5}: create_assoc failed, assoc_id 2e9100 ret 401
    > kernel: nvme nvme5: NVME-FC{5}: reset: Reconnect attempt failed (401)
    > kernel: nvme nvme5: NVME-FC{5}: Reconnect attempt in 2 seconds
    > Cc: stable@vger.kernel.org
    > Fixes: f0783d43dde4 (&quot;scsi: qla2xxx: Use correct number of vectors for online CPUs&quot;)
    > Signed-off-by: Quinn Tran &lt;qutran@marvell.com&gt;
    > Signed-off-by: Nilesh Javali &lt;njavali@marvell.com&gt;
    > Link: https://lore.kernel.org/r/20241115130313.46826-6-njavali@marvell.com
    > Reviewed-by: Himanshu Madhani &lt;himanshu.madhani@oracle.com&gt;
    > Signed-off-by: Martin K. Petersen &lt;martin.petersen@oracle.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ scsi: qla2xxx: Remove check req_sg_cnt should be equal to rsp_sg_cnt (@Saurav Kashyap in [31d3ed440fa671b](https://github.com/sophgo/linux-riscv/commit/31d3ed440fa671b) at 2024-12-14 19:03:24)
    > commit 833c70e212fc40d3e98da941796f4c7bcaecdf58 upstream.
    > Firmware supports multiple sg_cnt for request and response for CT
    > commands, so remove the redundant check. A check is there where sg_cnt
    > for request and response should be same. This is not required as driver
    > and FW have code to handle multiple and different sg_cnt on request and
    > response.
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Saurav Kashyap &lt;skashyap@marvell.com&gt;
    > Signed-off-by: Nilesh Javali &lt;njavali@marvell.com&gt;
    > Link: https://lore.kernel.org/r/20241115130313.46826-5-njavali@marvell.com
    > Reviewed-by: Himanshu Madhani &lt;himanshu.madhani@oracle.com&gt;
    > Signed-off-by: Martin K. Petersen &lt;martin.petersen@oracle.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ scsi: qla2xxx: Supported speed displayed incorrectly for VPorts (@Anil Gurumurthy in [2922ccf00bea2ee](https://github.com/sophgo/linux-riscv/commit/2922ccf00bea2ee) at 2024-12-14 19:03:24)
    > commit e4e268f898c8a08f0a1188677e15eadbc06e98f6 upstream.
    > The fc_function_template for vports was missing the
    > .show_host_supported_speeds. The base port had the same.
    > Add .show_host_supported_speeds to the vport template as well.
    > Cc: stable@vger.kernel.org
    > Fixes: 2c3dfe3f6ad8 (&quot;[SCSI] qla2xxx: add support for NPIV&quot;)
    > Signed-off-by: Anil Gurumurthy &lt;agurumurthy@marvell.com&gt;
    > Signed-off-by: Nilesh Javali &lt;njavali@marvell.com&gt;
    > Link: https://lore.kernel.org/r/20241115130313.46826-7-njavali@marvell.com
    > Reviewed-by: Himanshu Madhani &lt;himanshu.madhani@oracle.com&gt;
    > Signed-off-by: Martin K. Petersen &lt;martin.petersen@oracle.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ ALSA: hda/realtek: Enable mute and micmute LED on HP ProBook 430 G8 (@Nazar Bilinskyi in [f9e25ff6ddfbf57](https://github.com/sophgo/linux-riscv/commit/f9e25ff6ddfbf57) at 2024-12-14 19:03:23)
    > commit 3a83f7baf1346aca885cb83cb888e835fef7c472 upstream.
    > HP ProBook 430 G8 has a mute and micmute LEDs that can be made to work
    > using quirk ALC236_FIXUP_HP_GPIO_LED. Enable already existing quirk.
    > Signed-off-by: Nazar Bilinskyi &lt;nbilinskyi@gmail.com&gt;
    > Cc: &lt;stable@vger.kernel.org&gt;
    > Link: https://patch.msgid.link/20241130231631.8929-1-nbilinskyi@gmail.com
    > Signed-off-by: Takashi Iwai &lt;tiwai@suse.de&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ ALSA: usb-audio: add mixer mapping for Corsair HS80 (@Marie Ramlow in [c74de4e57685d04](https://github.com/sophgo/linux-riscv/commit/c74de4e57685d04) at 2024-12-14 19:03:23)
    > commit a7de2b873f3dbcda02d504536f1ec6dc50e3f6c4 upstream.
    > The Corsair HS80 RGB Wireless is a USB headset with a mic and a sidetone
    > feature. It has the same quirk as the Virtuoso series.
    > This labels the mixers appropriately, so applications don&#x27;t
    > move the sidetone volume when they actually intend to move the main
    > headset volume.
    > Signed-off-by: Marie Ramlow &lt;me@nycode.dev&gt;
    > cc: &lt;stable@vger.kernel.org&gt;
    > Link: https://patch.msgid.link/20241130165240.17838-1-me@nycode.dev
    > Signed-off-by: Takashi Iwai &lt;tiwai@suse.de&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ ALSA: usb-audio: Fix a DMA to stack memory bug (@Dan Carpenter in [7f1292f8d4d664d](https://github.com/sophgo/linux-riscv/commit/7f1292f8d4d664d) at 2024-12-14 19:03:23)
    > commit f7d306b47a24367302bd4fe846854e07752ffcd9 upstream.
    > The usb_get_descriptor() function does DMA so we&#x27;re not allowed
    > to use a stack buffer for that.  Doing DMA to the stack is not portable
    > all architectures.  Move the &quot;new_device_descriptor&quot; from being stored
    > on the stack and allocate it with kmalloc() instead.
    > Fixes: b909df18ce2a (&quot;ALSA: usb-audio: Fix potential out-of-bound accesses for Extigy and Mbox devices&quot;)
    > Cc: stable@kernel.org
    > Signed-off-by: Dan Carpenter &lt;dan.carpenter@linaro.org&gt;
    > Link: https://patch.msgid.link/60e3aa09-039d-46d2-934c-6f123026c2eb@stanley.mountain
    > Signed-off-by: Takashi Iwai &lt;tiwai@suse.de&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ ALSA: hda/realtek: Add support for Samsung Galaxy Book3 360 (NP730QFG) (@Sahas Leelodharry in [763d6c294d9eac4](https://github.com/sophgo/linux-riscv/commit/763d6c294d9eac4) at 2024-12-14 19:03:23)
    > commit e2974a220594c06f536e65dfd7b2447e0e83a1cb upstream.
    > Fixes the 3.5mm headphone jack on the Samsung Galaxy Book 3 360
    > NP730QFG laptop.
    > Unlike the other Galaxy Book3 series devices, this device only needs
    > the ALC298_FIXUP_SAMSUNG_HEADPHONE_VERY_QUIET quirk.
    > Verified changes on the device and compared with codec state in Windows.
    > [ white-space fixes by tiwai ]
    > Signed-off-by: Sahas Leelodharry &lt;sahas.leelodharry@mail.mcgill.ca&gt;
    > Cc: &lt;stable@vger.kernel.org&gt;
    > Link: https://patch.msgid.link/QB1PR01MB40047D4CC1282DB7F1333124CC352@QB1PR01MB4004.CANPRD01.PROD.OUTLOOK.COM
    > Signed-off-by: Takashi Iwai &lt;tiwai@suse.de&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ ALSA: usb-audio: Add extra PID for RME Digiface USB (@Asahi Lina in [39c5d89b567a094](https://github.com/sophgo/linux-riscv/commit/39c5d89b567a094) at 2024-12-14 19:03:23)
    > commit f09f0397db641f99f6c3e109283d82e3584bfb50 upstream.
    > It seems there is an alternate version of the hardware with a different
    > PID. User testing reveals this still works with the same interface as far
    > as the kernel is concerned, so just add the extra PID. Thanks to Heiko
    > Engemann for testing with this version.
    > Due to the way quirks-table.h is structured, that means we have to turn
    > the entire quirk struct into a macro to avoid duplicating it...
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Asahi Lina &lt;lina@asahilina.net&gt;
    > Link: https://patch.msgid.link/20241202-rme-digiface-usb-id-v1-1-50f730d7a46e@asahilina.net
    > Signed-off-by: Takashi Iwai &lt;tiwai@suse.de&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ ALSA: hda/realtek: fix micmute LEDs don&#x27;t work on HP Laptops (@Chris Chiu in [0614341226104ca](https://github.com/sophgo/linux-riscv/commit/0614341226104ca) at 2024-12-14 19:03:23)
    > commit 0d08f0eec961acdb0424a3e2cfb37cfb89154833 upstream.
    > These HP laptops use Realtek HDA codec ALC3315 combined CS35L56
    > Amplifiers. They need the quirk ALC285_FIXUP_HP_GPIO_LED to get
    > the micmute LED working.
    > Signed-off-by: Chris Chiu &lt;chris.chiu@canonical.com&gt;
    > Reviewed-by: Simon Trimmer &lt;simont@opensource.cirrus.com&gt;
    > Cc: &lt;stable@vger.kernel.org&gt;
    > Link: https://patch.msgid.link/20241202144659.1553504-1-chris.chiu@canonical.com
    > Signed-off-by: Takashi Iwai &lt;tiwai@suse.de&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ arm64: mm: Fix zone_dma_limit calculation (@Yang Shi in [ec643064abcfb76](https://github.com/sophgo/linux-riscv/commit/ec643064abcfb76) at 2024-12-14 19:03:22)
    > commit 56a708742a8bf127eb66798bfc9c9516c61f9930 upstream.
    > Commit ba0fb44aed47 (&quot;dma-mapping: replace zone_dma_bits by
    > zone_dma_limit&quot;) and subsequent patches changed how zone_dma_limit is
    > calculated to allow a reduced ZONE_DMA even when RAM starts above 4GB.
    > Commit 122c234ef4e1 (&quot;arm64: mm: keep low RAM dma zone&quot;) further fixed
    > this to ensure ZONE_DMA remains below U32_MAX if RAM starts below 4GB,
    > especially on platforms that do not have IORT or DT description of the
    > device DMA ranges. While zone boundaries calculation was fixed by the
    > latter commit, zone_dma_limit, used to determine the GFP_DMA flag in the
    > core code, was not updated. This results in excessive use of GFP_DMA and
    > unnecessary ZONE_DMA allocations on some platforms.
    > Update zone_dma_limit to match the actual upper bound of ZONE_DMA.
    > Fixes: ba0fb44aed47 (&quot;dma-mapping: replace zone_dma_bits by zone_dma_limit&quot;)
    > Cc: &lt;stable@vger.kernel.org&gt; # 6.12.x
    > Reported-by: Yutang Jiang &lt;jiangyutang@os.amperecomputing.com&gt;
    > Tested-by: Yutang Jiang &lt;jiangyutang@os.amperecomputing.com&gt;
    > Signed-off-by: Yang Shi &lt;yang@os.amperecomputing.com&gt;
    > Link: https://lore.kernel.org/r/20241125171650.77424-1-yang@os.amperecomputing.com
    > [catalin.marinas@arm.com: some tweaking of the commit log]
    > Signed-off-by: Catalin Marinas &lt;catalin.marinas@arm.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ arm64: ptrace: fix partial SETREGSET for NT_ARM_TAGGED_ADDR_CTRL (@Mark Rutland in [abd614bbfcee732](https://github.com/sophgo/linux-riscv/commit/abd614bbfcee732) at 2024-12-14 19:03:22)
    > commit ca62d90085f4af36de745883faab9f8a7cbb45d3 upstream.
    > Currently tagged_addr_ctrl_set() doesn&#x27;t initialize the temporary &#x27;ctrl&#x27;
    > variable, and a SETREGSET call with a length of zero will leave this
    > uninitialized. Consequently tagged_addr_ctrl_set() will consume an
    > arbitrary value, potentially leaking up to 64 bits of memory from the
    > kernel stack. The read is limited to a specific slot on the stack, and
    > the issue does not provide a write mechanism.
    > As set_tagged_addr_ctrl() only accepts values where bits [63:4] zero and
    > rejects other values, a partial SETREGSET attempt will randomly succeed
    > or fail depending on the value of the uninitialized value, and the
    > exposure is significantly limited.
    > Fix this by initializing the temporary value before copying the regset
    > from userspace, as for other regsets (e.g. NT_PRSTATUS, NT_PRFPREG,
    > NT_ARM_SYSTEM_CALL). In the case of a zero-length write, the existing
    > value of the tagged address ctrl will be retained.
    > The NT_ARM_TAGGED_ADDR_CTRL regset is only visible in the
    > user_aarch64_view used by a native AArch64 task to manipulate another
    > native AArch64 task. As get_tagged_addr_ctrl() only returns an error
    > value when called for a compat task, tagged_addr_ctrl_get() and
    > tagged_addr_ctrl_set() should never observe an error value from
    > get_tagged_addr_ctrl(). Add a WARN_ON_ONCE() to both to indicate that
    > such an error would be unexpected, and error handlnig is not missing in
    > either case.
    > Fixes: 2200aa7154cb (&quot;arm64: mte: ptrace: Add NT_ARM_TAGGED_ADDR_CTRL regset&quot;)
    > Cc: &lt;stable@vger.kernel.org&gt; # 5.10.x
    > Signed-off-by: Mark Rutland &lt;mark.rutland@arm.com&gt;
    > Cc: Will Deacon &lt;will@kernel.org&gt;
    > Reviewed-by: Mark Brown &lt;broonie@kernel.org&gt;
    > Link: https://lore.kernel.org/r/20241205121655.1824269-2-mark.rutland@arm.com
    > Signed-off-by: Catalin Marinas &lt;catalin.marinas@arm.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ arm64: ptrace: fix partial SETREGSET for NT_ARM_FPMR (@Mark Rutland in [8ab73c34e3c5b58](https://github.com/sophgo/linux-riscv/commit/8ab73c34e3c5b58) at 2024-12-14 19:03:22)
    > commit f5d71291841aecfe5d8435da2dfa7f58ccd18bc8 upstream.
    > Currently fpmr_set() doesn&#x27;t initialize the temporary &#x27;fpmr&#x27; variable,
    > and a SETREGSET call with a length of zero will leave this
    > uninitialized. Consequently an arbitrary value will be written back to
    > target-&gt;thread.uw.fpmr, potentially leaking up to 64 bits of memory from
    > the kernel stack. The read is limited to a specific slot on the stack,
    > and the issue does not provide a write mechanism.
    > Fix this by initializing the temporary value before copying the regset
    > from userspace, as for other regsets (e.g. NT_PRSTATUS, NT_PRFPREG,
    > NT_ARM_SYSTEM_CALL). In the case of a zero-length write, the existing
    > contents of FPMR will be retained.
    > Before this patch:
    > | # ./fpmr-test
    > | Attempting to write NT_ARM_FPMR::fpmr &#x3D; 0x900d900d900d900d
    > | SETREGSET(nt&#x3D;0x40e, len&#x3D;8) wrote 8 bytes
    > |
    > | Attempting to read NT_ARM_FPMR::fpmr
    > | GETREGSET(nt&#x3D;0x40e, len&#x3D;8) read 8 bytes
    > | Read NT_ARM_FPMR::fpmr &#x3D; 0x900d900d900d900d
    > |
    > | Attempting to write NT_ARM_FPMR (zero length)
    > | SETREGSET(nt&#x3D;0x40e, len&#x3D;0) wrote 0 bytes
    > |
    > | Attempting to read NT_ARM_FPMR::fpmr
    > | GETREGSET(nt&#x3D;0x40e, len&#x3D;8) read 8 bytes
    > | Read NT_ARM_FPMR::fpmr &#x3D; 0xffff800083963d50
    > After this patch:
    > | # ./fpmr-test
    > | Attempting to write NT_ARM_FPMR::fpmr &#x3D; 0x900d900d900d900d
    > | SETREGSET(nt&#x3D;0x40e, len&#x3D;8) wrote 8 bytes
    > |
    > | Attempting to read NT_ARM_FPMR::fpmr
    > | GETREGSET(nt&#x3D;0x40e, len&#x3D;8) read 8 bytes
    > | Read NT_ARM_FPMR::fpmr &#x3D; 0x900d900d900d900d
    > |
    > | Attempting to write NT_ARM_FPMR (zero length)
    > | SETREGSET(nt&#x3D;0x40e, len&#x3D;0) wrote 0 bytes
    > |
    > | Attempting to read NT_ARM_FPMR::fpmr
    > | GETREGSET(nt&#x3D;0x40e, len&#x3D;8) read 8 bytes
    > | Read NT_ARM_FPMR::fpmr &#x3D; 0x900d900d900d900d
    > Fixes: 4035c22ef7d4 (&quot;arm64/ptrace: Expose FPMR via ptrace&quot;)
    > Cc: &lt;stable@vger.kernel.org&gt; # 6.9.x
    > Signed-off-by: Mark Rutland &lt;mark.rutland@arm.com&gt;
    > Cc: Mark Brown &lt;broonie@kernel.org&gt;
    > Cc: Will Deacon &lt;will@kernel.org&gt;
    > Reviewed-by: Mark Brown &lt;broonie@kernel.org&gt;
    > Link: https://lore.kernel.org/r/20241205121655.1824269-3-mark.rutland@arm.com
    > Signed-off-by: Catalin Marinas &lt;catalin.marinas@arm.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ arm64: ptrace: fix partial SETREGSET for NT_ARM_POE (@Mark Rutland in [4105dd76bc8ad65](https://github.com/sophgo/linux-riscv/commit/4105dd76bc8ad65) at 2024-12-14 19:03:22)
    > commit 594bfc4947c4fcabba1318d8384c61a29a6b89fb upstream.
    > Currently poe_set() doesn&#x27;t initialize the temporary &#x27;ctrl&#x27; variable,
    > and a SETREGSET call with a length of zero will leave this
    > uninitialized. Consequently an arbitrary value will be written back to
    > target-&gt;thread.por_el0, potentially leaking up to 64 bits of memory from
    > the kernel stack. The read is limited to a specific slot on the stack,
    > and the issue does not provide a write mechanism.
    > Fix this by initializing the temporary value before copying the regset
    > from userspace, as for other regsets (e.g. NT_PRSTATUS, NT_PRFPREG,
    > NT_ARM_SYSTEM_CALL). In the case of a zero-length write, the existing
    > contents of POR_EL1 will be retained.
    > Before this patch:
    > | # ./poe-test
    > | Attempting to write NT_ARM_POE::por_el0 &#x3D; 0x900d900d900d900d
    > | SETREGSET(nt&#x3D;0x40f, len&#x3D;8) wrote 8 bytes
    > |
    > | Attempting to read NT_ARM_POE::por_el0
    > | GETREGSET(nt&#x3D;0x40f, len&#x3D;8) read 8 bytes
    > | Read NT_ARM_POE::por_el0 &#x3D; 0x900d900d900d900d
    > |
    > | Attempting to write NT_ARM_POE (zero length)
    > | SETREGSET(nt&#x3D;0x40f, len&#x3D;0) wrote 0 bytes
    > |
    > | Attempting to read NT_ARM_POE::por_el0
    > | GETREGSET(nt&#x3D;0x40f, len&#x3D;8) read 8 bytes
    > | Read NT_ARM_POE::por_el0 &#x3D; 0xffff8000839c3d50
    > After this patch:
    > | # ./poe-test
    > | Attempting to write NT_ARM_POE::por_el0 &#x3D; 0x900d900d900d900d
    > | SETREGSET(nt&#x3D;0x40f, len&#x3D;8) wrote 8 bytes
    > |
    > | Attempting to read NT_ARM_POE::por_el0
    > | GETREGSET(nt&#x3D;0x40f, len&#x3D;8) read 8 bytes
    > | Read NT_ARM_POE::por_el0 &#x3D; 0x900d900d900d900d
    > |
    > | Attempting to write NT_ARM_POE (zero length)
    > | SETREGSET(nt&#x3D;0x40f, len&#x3D;0) wrote 0 bytes
    > |
    > | Attempting to read NT_ARM_POE::por_el0
    > | GETREGSET(nt&#x3D;0x40f, len&#x3D;8) read 8 bytes
    > | Read NT_ARM_POE::por_el0 &#x3D; 0x900d900d900d900d
    > Fixes: 175198199262 (&quot;arm64/ptrace: add support for FEAT_POE&quot;)
    > Cc: &lt;stable@vger.kernel.org&gt; # 6.12.x
    > Signed-off-by: Mark Rutland &lt;mark.rutland@arm.com&gt;
    > Cc: Joey Gouly &lt;joey.gouly@arm.com&gt;
    > Cc: Will Deacon &lt;will@kernel.org&gt;
    > Reviewed-by: Mark Brown &lt;broonie@kernel.org&gt;
    > Link: https://lore.kernel.org/r/20241205121655.1824269-4-mark.rutland@arm.com
    > Signed-off-by: Catalin Marinas &lt;catalin.marinas@arm.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ arm64: Ensure bits ASID[15:8] are masked out when the kernel uses 8-bit ASIDs (@Catalin Marinas in [34b61978676a0fd](https://github.com/sophgo/linux-riscv/commit/34b61978676a0fd) at 2024-12-14 19:03:22)
    > commit c0900d15d31c2597dd9f634c8be2b71762199890 upstream.
    > Linux currently sets the TCR_EL1.AS bit unconditionally during CPU
    > bring-up. On an 8-bit ASID CPU, this is RES0 and ignored, otherwise
    > 16-bit ASIDs are enabled. However, if running in a VM and the hypervisor
    > reports 8-bit ASIDs (ID_AA64MMFR0_EL1.ASIDBits &#x3D;&#x3D; 0) on a 16-bit ASIDs
    > CPU, Linux uses bits 8 to 63 as a generation number for tracking old
    > process ASIDs. The bottom 8 bits of this generation end up being written
    > to TTBR1_EL1 and also used for the ASID-based TLBI operations as the
    > upper 8 bits of the ASID. Following an ASID roll-over event we can have
    > threads of the same application with the same 8-bit ASID but different
    > generation numbers running on separate CPUs. Both TLB caching and the
    > TLBI operations will end up using different actual 16-bit ASIDs for the
    > same process.
    > A similar scenario can happen in a big.LITTLE configuration if the boot
    > CPU only uses 8-bit ASIDs while secondary CPUs have 16-bit ASIDs.
    > Ensure that the ASID generation is only tracked by bits 16 and up,
    > leaving bits 15:8 as 0 if the kernel uses 8-bit ASIDs. Note that
    > clearing TCR_EL1.AS is not sufficient since the architecture requires
    > that the top 8 bits of the ASID passed to TLBI instructions are 0 rather
    > than ignored in such configuration.
    > Cc: stable@vger.kernel.org
    > Cc: Will Deacon &lt;will@kernel.org&gt;
    > Cc: Mark Rutland &lt;mark.rutland@arm.com&gt;
    > Cc: Marc Zyngier &lt;maz@kernel.org&gt;
    > Cc: James Morse &lt;james.morse@arm.com&gt;
    > Acked-by: Mark Rutland &lt;mark.rutland@arm.com&gt;
    > Acked-by: Marc Zyngier &lt;maz@kernel.org&gt;
    > Link: https://lore.kernel.org/r/20241203151941.353796-1-catalin.marinas@arm.com
    > Signed-off-by: Catalin Marinas &lt;catalin.marinas@arm.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ iommufd: Fix out_fput in iommufd_fault_alloc() (@Nicolin Chen in [2b3f30c8edbf9a1](https://github.com/sophgo/linux-riscv/commit/2b3f30c8edbf9a1) at 2024-12-14 19:03:22)
    > commit af7f4780514f850322b2959032ecaa96e4b26472 upstream.
    > As fput() calls the file-&gt;f_op-&gt;release op, where fault obj and ictx are
    > getting released, there is no need to release these two after fput() one
    > more time, which would result in imbalanced refcounts:
    > refcount_t: decrement hit 0; leaking memory.
    > WARNING: CPU: 48 PID: 2369 at lib/refcount.c:31 refcount_warn_saturate+0x60/0x230
    > Call trace:
    > refcount_warn_saturate+0x60/0x230 (P)
    > refcount_warn_saturate+0x60/0x230 (L)
    > iommufd_fault_fops_release+0x9c/0xe0 [iommufd]
    > ...
    > VFS: Close: file count is 0 (f_op&#x3D;iommufd_fops [iommufd])
    > WARNING: CPU: 48 PID: 2369 at fs/open.c:1507 filp_flush+0x3c/0xf0
    > Call trace:
    > filp_flush+0x3c/0xf0 (P)
    > filp_flush+0x3c/0xf0 (L)
    > __arm64_sys_close+0x34/0x98
    > ...
    > imbalanced put on file reference count
    > WARNING: CPU: 48 PID: 2369 at fs/file.c:74 __file_ref_put+0x100/0x138
    > Call trace:
    > __file_ref_put+0x100/0x138 (P)
    > __file_ref_put+0x100/0x138 (L)
    > __fput_sync+0x4c/0xd0
    > Drop those two lines to fix the warnings above.
    > Cc: stable@vger.kernel.org
    > Fixes: 07838f7fd529 (&quot;iommufd: Add iommufd fault object&quot;)
    > Link: https://patch.msgid.link/r/b5651beb3a6b1adeef26fffac24607353bf67ba1.1733212723.git.nicolinc@nvidia.com
    > Signed-off-by: Nicolin Chen &lt;nicolinc@nvidia.com&gt;
    > Reviewed-by: Yi Liu &lt;yi.l.liu@intel.com&gt;
    > Signed-off-by: Jason Gunthorpe &lt;jgg@nvidia.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ watchdog: rti: of: honor timeout-sec property (@Alexander Sverdlin in [f505fb7e25582e1](https://github.com/sophgo/linux-riscv/commit/f505fb7e25582e1) at 2024-12-14 19:03:21)
    > commit 4962ee045d8f06638714d801ab0fb72f89c16690 upstream.
    > Currently &quot;timeout-sec&quot; Device Tree property is being silently ignored:
    > even though watchdog_init_timeout() is being used, the driver always passes
    > &quot;heartbeat&quot; &#x3D;&#x3D; DEFAULT_HEARTBEAT &#x3D;&#x3D; 60 as argument.
    > Fix this by setting struct watchdog_device::timeout to DEFAULT_HEARTBEAT
    > and passing real module parameter value to watchdog_init_timeout() (which
    > may now be 0 if not specified).
    > Cc: stable@vger.kernel.org
    > Fixes: 2d63908bdbfb (&quot;watchdog: Add K3 RTI watchdog support&quot;)
    > Signed-off-by: Alexander Sverdlin &lt;alexander.sverdlin@siemens.com&gt;
    > Reviewed-by: Vignesh Raghavendra &lt;vigneshr@ti.com&gt;
    > Reviewed-by: Guenter Roeck &lt;linux@roeck-us.net&gt;
    > Link: https://lore.kernel.org/r/20241107203830.1068456-1-alexander.sverdlin@siemens.com
    > Signed-off-by: Guenter Roeck &lt;linux@roeck-us.net&gt;
    > Signed-off-by: Wim Van Sebroeck &lt;wim@linux-watchdog.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ ksmbd: fix Out-of-Bounds Write in ksmbd_vfs_stream_write (@Jordy Zomer in [c5797f195c67132](https://github.com/sophgo/linux-riscv/commit/c5797f195c67132) at 2024-12-14 19:03:21)
    > commit 313dab082289e460391c82d855430ec8a28ddf81 upstream.
    > An offset from client could be a negative value, It could allows
    > to write data outside the bounds of the allocated buffer.
    > Note that this issue is coming when setting
    > &#x27;vfs objects &#x3D; streams_xattr parameter&#x27; in ksmbd.conf.
    > Cc: stable@vger.kernel.org # v5.15+
    > Reported-by: Jordy Zomer &lt;jordyzomer@google.com&gt;
    > Signed-off-by: Jordy Zomer &lt;jordyzomer@google.com&gt;
    > Signed-off-by: Namjae Jeon &lt;linkinjeon@kernel.org&gt;
    > Signed-off-by: Steve French &lt;stfrench@microsoft.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ tracing: Fix cmp_entries_dup() to respect sort() comparison rules (@Kuan-Wei Chiu in [ba0ee489cddea1d](https://github.com/sophgo/linux-riscv/commit/ba0ee489cddea1d) at 2024-12-14 19:03:21)
    > commit e63fbd5f6810ed756bbb8a1549c7d4132968baa9 upstream.
    > The cmp_entries_dup() function used as the comparator for sort()
    > violated the symmetry and transitivity properties required by the
    > sorting algorithm. Specifically, it returned 1 whenever memcmp() was
    > non-zero, which broke the following expectations:
    > Symmetry: If x &lt; y, then y &gt; x.
    > Transitivity: If x &lt; y and y &lt; z, then x &lt; z.
    > These violations could lead to incorrect sorting and failure to
    > correctly identify duplicate elements.
    > Fix the issue by directly returning the result of memcmp(), which
    > adheres to the required comparison properties.
    > Cc: stable@vger.kernel.org
    > Fixes: 08d43a5fa063 (&quot;tracing: Add lock-free tracing_map&quot;)
    > Link: https://lore.kernel.org/20241203202228.1274403-1-visitorckw@gmail.com
    > Signed-off-by: Kuan-Wei Chiu &lt;visitorckw@gmail.com&gt;
    > Signed-off-by: Steven Rostedt (Google) &lt;rostedt@goodmis.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ net :mana :Request a V2 response version for MANA_QUERY_GF_STAT (@Shradha Gupta in [aec9ed5663d2c4b](https://github.com/sophgo/linux-riscv/commit/aec9ed5663d2c4b) at 2024-12-14 19:03:21)
    > commit 31f1b55d5d7e531cd827419e5d71c19f24de161c upstream.
    > The current requested response version(V1) for MANA_QUERY_GF_STAT query
    > results in STATISTICS_FLAGS_TX_ERRORS_GDMA_ERROR value being set to
    > 0 always.
    > In order to get the correct value for this counter we request the response
    > version to be V2.
    > Cc: stable@vger.kernel.org
    > Fixes: e1df5202e879 (&quot;net :mana :Add remaining GDMA stats for MANA to ethtool&quot;)
    > Signed-off-by: Shradha Gupta &lt;shradhagupta@linux.microsoft.com&gt;
    > Reviewed-by: Haiyang Zhang &lt;haiyangz@microsoft.com&gt;
    > Link: https://patch.msgid.link/1733291300-12593-1-git-send-email-shradhagupta@linux.microsoft.com
    > Signed-off-by: Paolo Abeni &lt;pabeni@redhat.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ can: dev: can_set_termination(): allow sleeping GPIOs (@Marc Kleine-Budde in [3b0c5bb437d31a9](https://github.com/sophgo/linux-riscv/commit/3b0c5bb437d31a9) at 2024-12-14 19:03:21)
    > commit ee1dfbdd8b4b6de85e96ae2059dc9c1bdb6b49b5 upstream.
    > In commit 6e86a1543c37 (&quot;can: dev: provide optional GPIO based
    > termination support&quot;) GPIO based termination support was added.
    > For no particular reason that patch uses gpiod_set_value() to set the
    > GPIO. This leads to the following warning, if the systems uses a
    > sleeping GPIO, i.e. behind an I2C port expander:
    > | WARNING: CPU: 0 PID: 379 at /drivers/gpio/gpiolib.c:3496 gpiod_set_value+0x50/0x6c
    > | CPU: 0 UID: 0 PID: 379 Comm: ip Not tainted 6.11.0-20241016-1 #1 823affae360cc91126e4d316d7a614a8bf86236c
    > Replace gpiod_set_value() by gpiod_set_value_cansleep() to allow the
    > use of sleeping GPIOs.
    > Cc: Nicolai Buchwitz &lt;nb@tipi-net.de&gt;
    > Cc: Lino Sanfilippo &lt;l.sanfilippo@kunbus.com&gt;
    > Cc: stable@vger.kernel.org
    > Reported-by: Leonard Göhrs &lt;l.goehrs@pengutronix.de&gt;
    > Tested-by: Leonard Göhrs &lt;l.goehrs@pengutronix.de&gt;
    > Fixes: 6e86a1543c37 (&quot;can: dev: provide optional GPIO based termination support&quot;)
    > Link: https://patch.msgid.link/20241121-dev-fix-can_set_termination-v1-1-41fa6e29216d@pengutronix.de
    > Signed-off-by: Marc Kleine-Budde &lt;mkl@pengutronix.de&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ can: mcp251xfd: mcp251xfd_get_tef_len(): work around erratum DS80000789E 6. (@Marc Kleine-Budde in [2f4320f9f888264](https://github.com/sophgo/linux-riscv/commit/2f4320f9f888264) at 2024-12-14 19:03:21)
    > commit 30447a1bc0e066e492552b3e5ffeb63c1605dfe2 upstream.
    > Commit b8e0ddd36ce9 (&quot;can: mcp251xfd: tef: prepare to workaround
    > broken TEF FIFO tail index erratum&quot;) introduced
    > mcp251xfd_get_tef_len() to get the number of unhandled transmit events
    > from the Transmit Event FIFO (TEF).
    > As the TEF has no head index, the driver uses the TX-FIFO&#x27;s tail index
    > instead, assuming that send frames are completed.
    > When calculating the number of unhandled TEF events, that commit
    > didn&#x27;t take mcp2518fd erratum DS80000789E 6. into account. According
    > to that erratum, the FIFOCI bits of a FIFOSTA register, here the
    > TX-FIFO tail index might be corrupted.
    > However here it seems the bit indicating that the TX-FIFO is
    > empty (MCP251XFD_REG_FIFOSTA_TFERFFIF) is not correct while the
    > TX-FIFO tail index is.
    > Assume that the TX-FIFO is indeed empty if:
    > - Chip&#x27;s head and tail index are equal (len &#x3D;&#x3D; 0).
    > - The TX-FIFO is less than half full.
    > (The TX-FIFO empty case has already been checked at the
    > beginning of this function.)
    > - No free buffers in the TX ring.
    > If the TX-FIFO is assumed to be empty, assume that the TEF is full and
    > return the number of elements in the TX-FIFO (which equals the number
    > of TEF elements).
    > If these assumptions are false, the driver might read to many objects
    > from the TEF. mcp251xfd_handle_tefif_one() checks the sequence numbers
    > and will refuse to process old events.
    > Reported-by: Renjaya Raga Zenta &lt;renjaya.zenta@formulatrix.com&gt;
    > Closes: https://patch.msgid.link/CAJ7t6HgaeQ3a_OtfszezU&#x3D;zB-FqiZXqrnATJ3UujNoQJJf7GgA@mail.gmail.com
    > Fixes: b8e0ddd36ce9 (&quot;can: mcp251xfd: tef: prepare to workaround broken TEF FIFO tail index erratum&quot;)
    > Tested-by: Renjaya Raga Zenta &lt;renjaya.zenta@formulatrix.com&gt;
    > Cc: stable@vger.kernel.org
    > Link: https://patch.msgid.link/20241126-mcp251xfd-fix-length-calculation-v2-1-c2ed516ed6ba@pengutronix.de
    > Signed-off-by: Marc Kleine-Budde &lt;mkl@pengutronix.de&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ HID: wacom: fix when get product name maybe null pointer (@WangYuli in [e689bc6697a7fce](https://github.com/sophgo/linux-riscv/commit/e689bc6697a7fce) at 2024-12-14 19:03:20)
    > commit 59548215b76be98cf3422eea9a67d6ea578aca3d upstream.
    > Due to incorrect dev-&gt;product reporting by certain devices, null
    > pointer dereferences occur when dev-&gt;product is empty, leading to
    > potential system crashes.
    > This issue was found on EXCELSIOR DL37-D05 device with
    > Loongson-LS3A6000-7A2000-DL37 motherboard.
    > Kernel logs:
    > [   56.470885] usb 4-3: new full-speed USB device number 4 using ohci-pci
    > [   56.671638] usb 4-3: string descriptor 0 read error: -22
    > [   56.671644] usb 4-3: New USB device found, idVendor&#x3D;056a, idProduct&#x3D;0374, bcdDevice&#x3D; 1.07
    > [   56.671647] usb 4-3: New USB device strings: Mfr&#x3D;1, Product&#x3D;2, SerialNumber&#x3D;3
    > [   56.678839] hid-generic 0003:056A:0374.0004: hiddev0,hidraw3: USB HID v1.10 Device [HID 056a:0374] on usb-0000:00:05.0-3/input0
    > [   56.697719] CPU 2 Unable to handle kernel paging request at virtual address 0000000000000000, era &#x3D;&#x3D; 90000000066e35c8, ra &#x3D;&#x3D; ffff800004f98a80
    > [   56.697732] Oops[#1]:
    > [   56.697734] CPU: 2 PID: 2742 Comm: (udev-worker) Tainted: G           OE      6.6.0-loong64-desktop #25.00.2000.015
    > [   56.697737] Hardware name: Inspur CE520L2/C09901N000000000, BIOS 2.09.00 10/11/2024
    > [   56.697739] pc 90000000066e35c8 ra ffff800004f98a80 tp 9000000125478000 sp 900000012547b8a0
    > [   56.697741] a0 0000000000000000 a1 ffff800004818b28 a2 0000000000000000 a3 0000000000000000
    > [   56.697743] a4 900000012547b8f0 a5 0000000000000000 a6 0000000000000000 a7 0000000000000000
    > [   56.697745] t0 ffff800004818b2d t1 0000000000000000 t2 0000000000000003 t3 0000000000000005
    > [   56.697747] t4 0000000000000000 t5 0000000000000000 t6 0000000000000000 t7 0000000000000000
    > [   56.697748] t8 0000000000000000 u0 0000000000000000 s9 0000000000000000 s0 900000011aa48028
    > [   56.697750] s1 0000000000000000 s2 0000000000000000 s3 ffff800004818e80 s4 ffff800004810000
    > [   56.697751] s5 90000001000b98d0 s6 ffff800004811f88 s7 ffff800005470440 s8 0000000000000000
    > [   56.697753]    ra: ffff800004f98a80 wacom_update_name+0xe0/0x300 [wacom]
    > [   56.697802]   ERA: 90000000066e35c8 strstr+0x28/0x120
    > [   56.697806]  CRMD: 000000b0 (PLV0 -IE -DA +PG DACF&#x3D;CC DACM&#x3D;CC -WE)
    > [   56.697816]  PRMD: 0000000c (PPLV0 +PIE +PWE)
    > [   56.697821]  EUEN: 00000000 (-FPE -SXE -ASXE -BTE)
    > [   56.697827]  ECFG: 00071c1d (LIE&#x3D;0,2-4,10-12 VS&#x3D;7)
    > [   56.697831] ESTAT: 00010000 [PIL] (IS&#x3D; ECode&#x3D;1 EsubCode&#x3D;0)
    > [   56.697835]  BADV: 0000000000000000
    > [   56.697836]  PRID: 0014d000 (Loongson-64bit, Loongson-3A6000)
    > [   56.697838] Modules linked in: wacom(+) bnep bluetooth rfkill qrtr nls_iso8859_1 nls_cp437 snd_hda_codec_conexant snd_hda_codec_generic ledtrig_audio snd_hda_codec_hdmi snd_hda_intel snd_intel_dspcfg snd_hda_codec snd_hda_core snd_hwdep snd_pcm snd_timer snd soundcore input_leds mousedev led_class joydev deepin_netmonitor(OE) fuse nfnetlink dmi_sysfs ip_tables x_tables overlay amdgpu amdxcp drm_exec gpu_sched drm_buddy radeon drm_suballoc_helper i2c_algo_bit drm_ttm_helper r8169 ttm drm_display_helper spi_loongson_pci xhci_pci cec xhci_pci_renesas spi_loongson_core hid_generic realtek gpio_loongson_64bit
    > [   56.697887] Process (udev-worker) (pid: 2742, threadinfo&#x3D;00000000aee0d8b4, task&#x3D;00000000a9eff1f3)
    > [   56.697890] Stack : 0000000000000000 ffff800004817e00 0000000000000000 0000251c00000000
    > [   56.697896]         0000000000000000 00000011fffffffd 0000000000000000 0000000000000000
    > [   56.697901]         0000000000000000 1b67a968695184b9 0000000000000000 90000001000b98d0
    > [   56.697906]         90000001000bb8d0 900000011aa48028 0000000000000000 ffff800004f9d74c
    > [   56.697911]         90000001000ba000 ffff800004f9ce58 0000000000000000 ffff800005470440
    > [   56.697916]         ffff800004811f88 90000001000b98d0 9000000100da2aa8 90000001000bb8d0
    > [   56.697921]         0000000000000000 90000001000ba000 900000011aa48028 ffff800004f9d74c
    > [   56.697926]         ffff8000054704e8 90000001000bb8b8 90000001000ba000 0000000000000000
    > [   56.697931]         90000001000bb8d0 9000000006307564 9000000005e666e0 90000001752359b8
    > [   56.697936]         9000000008cbe400 900000000804d000 9000000005e666e0 0000000000000000
    > [   56.697941]         ...
    > [   56.697944] Call Trace:
    > [   56.697945] [&lt;90000000066e35c8&gt;] strstr+0x28/0x120
    > [   56.697950] [&lt;ffff800004f98a80&gt;] wacom_update_name+0xe0/0x300 [wacom]
    > [   56.698000] [&lt;ffff800004f9ce58&gt;] wacom_parse_and_register+0x338/0x900 [wacom]
    > [   56.698050] [&lt;ffff800004f9d74c&gt;] wacom_probe+0x32c/0x420 [wacom]
    > [   56.698099] [&lt;9000000006307564&gt;] hid_device_probe+0x144/0x260
    > [   56.698103] [&lt;9000000005e65d68&gt;] really_probe+0x208/0x540
    > [   56.698109] [&lt;9000000005e661dc&gt;] __driver_probe_device+0x13c/0x1e0
    > [   56.698112] [&lt;9000000005e66620&gt;] driver_probe_device+0x40/0x100
    > [   56.698116] [&lt;9000000005e6680c&gt;] __device_attach_driver+0x12c/0x180
    > [   56.698119] [&lt;9000000005e62bc8&gt;] bus_for_each_drv+0x88/0x160
    > [   56.698123] [&lt;9000000005e66468&gt;] __device_attach+0x108/0x260
    > [   56.698126] [&lt;9000000005e63918&gt;] device_reprobe+0x78/0x100
    > [   56.698129] [&lt;9000000005e62a68&gt;] bus_for_each_dev+0x88/0x160
    > [   56.698132] [&lt;9000000006304e54&gt;] __hid_bus_driver_added+0x34/0x80
    > [   56.698134] [&lt;9000000005e62bc8&gt;] bus_for_each_drv+0x88/0x160
    > [   56.698137] [&lt;9000000006304df0&gt;] __hid_register_driver+0x70/0xa0
    > [   56.698142] [&lt;9000000004e10fe4&gt;] do_one_initcall+0x104/0x320
    > [   56.698146] [&lt;9000000004f38150&gt;] do_init_module+0x90/0x2c0
    > [   56.698151] [&lt;9000000004f3a3d8&gt;] init_module_from_file+0xb8/0x120
    > [   56.698155] [&lt;9000000004f3a590&gt;] idempotent_init_module+0x150/0x3a0
    > [   56.698159] [&lt;9000000004f3a890&gt;] sys_finit_module+0xb0/0x140
    > [   56.698163] [&lt;900000000671e4e8&gt;] do_syscall+0x88/0xc0
    > [   56.698166] [&lt;9000000004e12404&gt;] handle_syscall+0xc4/0x160
    > [   56.698171] Code: 0011958f  00150224  5800cd85 &lt;2a00022c&gt; 00150004  4000c180  0015022c  03400000  03400000
    > [   56.698192] ---[ end trace 0000000000000000 ]---
    > Fixes: 09dc28acaec7 (&quot;HID: wacom: Improve generic name generation&quot;)
    > Reported-by: Zhenxing Chen &lt;chenzhenxing@uniontech.com&gt;
    > Co-developed-by: Xu Rao &lt;raoxu@uniontech.com&gt;
    > Signed-off-by: Xu Rao &lt;raoxu@uniontech.com&gt;
    > Signed-off-by: WangYuli &lt;wangyuli@uniontech.com&gt;
    > Link: https://patch.msgid.link/B31757FE8E1544CF+20241125052616.18261-1-wangyuli@uniontech.com
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Benjamin Tissoires &lt;bentiss@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ rust: allow &#x60;clippy::needless_lifetimes&#x60; (@Miguel Ojeda in [a7e0e292dca4eda](https://github.com/sophgo/linux-riscv/commit/a7e0e292dca4eda) at 2024-12-14 19:03:20)
    > commit 60fc1e6750133620e404d40b93df5afe32e3e6c6 upstream.
    > In beta Clippy (i.e. Rust 1.83.0), the &#x60;needless_lifetimes&#x60; lint has
    > been extended [1] to suggest eliding &#x60;impl&#x60; lifetimes, e.g.
    > error: the following explicit lifetimes could be elided: &#x27;a
    > --&gt; rust/kernel/list.rs:647:6
    > |
    > 647 | impl&lt;&#x27;a, T: ?Sized + ListItem&lt;ID&gt;, const ID: u64&gt; FusedIterator for Iter&lt;&#x27;a, T, ID&gt; {}
    > |      ^^                                                                  ^^
    > |
    > &#x3D; help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#needless_lifetimes
    > &#x3D; note: &#x60;-D clippy::needless-lifetimes&#x60; implied by &#x60;-D warnings&#x60;
    > &#x3D; help: to override &#x60;-D warnings&#x60; add &#x60;#[allow(clippy::needless_lifetimes)]&#x60;
    > help: elide the lifetimes
    > |
    > 647 - impl&lt;&#x27;a, T: ?Sized + ListItem&lt;ID&gt;, const ID: u64&gt; FusedIterator for Iter&lt;&#x27;a, T, ID&gt; {}
    > 647 + impl&lt;T: ?Sized + ListItem&lt;ID&gt;, const ID: u64&gt; FusedIterator for Iter&lt;&#x27;_, T, ID&gt; {}
    > A possibility would have been to clean them -- the RFC patch [2] did
    > this, while asking if we wanted these cleanups. There is an open issue
    > [3] in Clippy about being able to differentiate some of the new cases,
    > e.g. those that do not involve introducing &#x60;&#x27;_&#x60;. Thus it seems others
    > feel similarly.
    > Thus, for the time being, we decided to &#x60;allow&#x60; the lint.
    > Link: https://github.com/rust-lang/rust-clippy/pull/13286 [1]
    > Link: https://lore.kernel.org/rust-for-linux/20241012231300.397010-1-ojeda@kernel.org/ [2]
    > Link: https://github.com/rust-lang/rust-clippy/issues/13514 [3]
    > Reviewed-by: Alice Ryhl &lt;aliceryhl@google.com&gt;
    > Reviewed-by: Andreas Hindborg &lt;a.hindborg@kernel.org&gt;
    > Link: https://lore.kernel.org/r/20241116181538.369355-1-ojeda@kernel.org
    > Signed-off-by: Miguel Ojeda &lt;ojeda@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ LoongArch: Add architecture specific huge_pte_clear() (@Bibo Mao in [9b602190cf2d8ac](https://github.com/sophgo/linux-riscv/commit/9b602190cf2d8ac) at 2024-12-14 19:03:20)
    > commit 7cd1f5f77925ae905a57296932f0f9ef0dc364f8 upstream.
    > When executing mm selftests run_vmtests.sh, there is such an error:
    > BUG: Bad page state in process uffd-unit-tests  pfn:00000
    > page: refcount:0 mapcount:0 mapping:0000000000000000 index:0x0 pfn:0x0
    > flags: 0xffff0000002000(reserved|node&#x3D;0|zone&#x3D;0|lastcpupid&#x3D;0xffff)
    > raw: 00ffff0000002000 ffffbf0000000008 ffffbf0000000008 0000000000000000
    > raw: 0000000000000000 0000000000000000 00000000ffffffff 0000000000000000
    > page dumped because: PAGE_FLAGS_CHECK_AT_FREE flag(s) set
    > Modules linked in: snd_seq_dummy snd_seq snd_seq_device rfkill vfat fat
    > virtio_balloon efi_pstore virtio_net pstore net_failover failover fuse
    > nfnetlink virtio_scsi virtio_gpu virtio_dma_buf dm_multipath efivarfs
    > CPU: 2 UID: 0 PID: 1913 Comm: uffd-unit-tests Not tainted 6.12.0 #184
    > Hardware name: QEMU QEMU Virtual Machine, BIOS unknown 2/2/2022
    > Stack : 900000047c8ac000 0000000000000000 9000000000223a7c 900000047c8ac000
    > 900000047c8af690 900000047c8af698 0000000000000000 900000047c8af7d8
    > 900000047c8af7d0 900000047c8af7d0 900000047c8af5b0 0000000000000001
    > 0000000000000001 900000047c8af698 10b3c7d53da40d26 0000010000000000
    > 0000000000000022 0000000fffffffff fffffffffe000000 ffff800000000000
    > 000000000000002f 0000800000000000 000000017a6d4000 90000000028f8940
    > 0000000000000000 0000000000000000 90000000025aa5e0 9000000002905000
    > 0000000000000000 90000000028f8940 ffff800000000000 0000000000000000
    > 0000000000000000 0000000000000000 9000000000223a94 000000012001839c
    > 00000000000000b0 0000000000000004 0000000000000000 0000000000071c1d
    > ...
    > Call Trace:
    > [&lt;9000000000223a94&gt;] show_stack+0x5c/0x180
    > [&lt;9000000001c3fd64&gt;] dump_stack_lvl+0x6c/0xa0
    > [&lt;900000000056aa08&gt;] bad_page+0x1a0/0x1f0
    > [&lt;9000000000574978&gt;] free_unref_folios+0xbf0/0xd20
    > [&lt;90000000004e65cc&gt;] folios_put_refs+0x1a4/0x2b8
    > [&lt;9000000000599a0c&gt;] free_pages_and_swap_cache+0x164/0x260
    > [&lt;9000000000547698&gt;] tlb_batch_pages_flush+0xa8/0x1c0
    > [&lt;9000000000547f30&gt;] tlb_finish_mmu+0xa8/0x218
    > [&lt;9000000000543cb8&gt;] exit_mmap+0x1a0/0x360
    > [&lt;9000000000247658&gt;] __mmput+0x78/0x200
    > [&lt;900000000025583c&gt;] do_exit+0x43c/0xde8
    > [&lt;9000000000256490&gt;] do_group_exit+0x68/0x110
    > [&lt;9000000000256554&gt;] sys_exit_group+0x1c/0x20
    > [&lt;9000000001c413b4&gt;] do_syscall+0x94/0x130
    > [&lt;90000000002216d8&gt;] handle_syscall+0xb8/0x158
    > Disabling lock debugging due to kernel taint
    > BUG: non-zero pgtables_bytes on freeing mm: -16384
    > On LoongArch system, invalid huge pte entry should be invalid_pte_table
    > or a single _PAGE_HUGE bit rather than a zero value. And it should be
    > the same with invalid pmd entry, since pmd_none() is called by function
    > free_pgd_range() and pmd_none() return 0 by huge_pte_clear(). So single
    > _PAGE_HUGE bit is also treated as a valid pte table and free_pte_range()
    > will be called in free_pmd_range().
    > free_pmd_range()
    > pmd &#x3D; pmd_offset(pud, addr);
    > do {
    > next &#x3D; pmd_addr_end(addr, end);
    > if (pmd_none_or_clear_bad(pmd))
    > continue;
    > free_pte_range(tlb, pmd, addr);
    > } while (pmd++, addr &#x3D; next, addr !&#x3D; end);
    > Here invalid_pte_table is used for both invalid huge pte entry and
    > pmd entry.
    > Cc: stable@vger.kernel.org
    > Fixes: 09cfefb7fa70 (&quot;LoongArch: Add memory management&quot;)
    > Signed-off-by: Bibo Mao &lt;maobibo@loongson.cn&gt;
    > Signed-off-by: Huacai Chen &lt;chenhuacai@loongson.cn&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ ksmbd: fix Out-of-Bounds Read in ksmbd_vfs_stream_read (@Jordy Zomer in [81eed631935f2c5](https://github.com/sophgo/linux-riscv/commit/81eed631935f2c5) at 2024-12-14 19:03:20)
    > commit fc342cf86e2dc4d2edb0fc2ff5e28b6c7845adb9 upstream.
    > An offset from client could be a negative value, It could lead
    > to an out-of-bounds read from the stream_buf.
    > Note that this issue is coming when setting
    > &#x27;vfs objects &#x3D; streams_xattr parameter&#x27; in ksmbd.conf.
    > Cc: stable@vger.kernel.org # v5.15+
    > Reported-by: Jordy Zomer &lt;jordyzomer@google.com&gt;
    > Signed-off-by: Jordy Zomer &lt;jordyzomer@google.com&gt;
    > Signed-off-by: Namjae Jeon &lt;linkinjeon@kernel.org&gt;
    > Signed-off-by: Steve French &lt;stfrench@microsoft.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ x86/CPU/AMD: WARN when setting EFER.AUTOIBRS if and only if the WRMSR fails (@Sean Christopherson in [73bb82a4259ad9b](https://github.com/sophgo/linux-riscv/commit/73bb82a4259ad9b) at 2024-12-14 19:03:20)
    > [ Upstream commit 492077668fb453b8b16c842fcf3fafc2ebc190e9 ]
    > When ensuring EFER.AUTOIBRS is set, WARN only on a negative return code
    > from msr_set_bit(), as &#x27;1&#x27; is used to indicate the WRMSR was successful
    > (&#x27;0&#x27; indicates the MSR bit was already set).
    > Fixes: 8cc68c9c9e92 (&quot;x86/CPU/AMD: Make sure EFER[AIBRSE] is set&quot;)
    > Reported-by: Nathan Chancellor &lt;nathan@kernel.org&gt;
    > Signed-off-by: Sean Christopherson &lt;seanjc@google.com&gt;
    > Signed-off-by: Ingo Molnar &lt;mingo@kernel.org&gt;
    > Link: https://lore.kernel.org/r/Z1MkNofJjt7Oq0G6@google.com
    > Closes: https://lore.kernel.org/all/20241205220604.GA2054199@thelio-3990X
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ LoongArch: KVM: Protect kvm_check_requests() with SRCU (@Huacai Chen in [1aece9662013c4e](https://github.com/sophgo/linux-riscv/commit/1aece9662013c4e) at 2024-12-14 19:03:20)
    > commit 589e6cc7597655bed7b8543b8286925f631f597c upstream.
    > When we enable lockdep we get such a warning:
    > &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;
    > WARNING: suspicious RCU usage
    > 6.12.0-rc7+ #1891 Tainted: G        W
    > -----------------------------
    > include/linux/kvm_host.h:1043 suspicious rcu_dereference_check() usage!
    > other info that might help us debug this:
    > rcu_scheduler_active &#x3D; 2, debug_locks &#x3D; 1
    > 1 lock held by qemu-system-loo/948:
    > #0: 90000001184a00a8 (&amp;vcpu-&gt;mutex){+.+.}-{4:4}, at: kvm_vcpu_ioctl+0xf4/0xe20 [kvm]
    > stack backtrace:
    > CPU: 0 UID: 0 PID: 948 Comm: qemu-system-loo Tainted: G        W          6.12.0-rc7+ #1891
    > Tainted: [W]&#x3D;WARN
    > Hardware name: Loongson Loongson-3A5000-7A1000-1w-CRB/Loongson-LS3A5000-7A1000-1w-CRB, BIOS vUDK2018-LoongArch-V2.0.0-prebeta9 10/21/2022
    > Stack : 0000000000000089 9000000005a0db9c 90000000071519c8 900000012c578000
    > 900000012c57b920 0000000000000000 900000012c57b928 9000000007e53788
    > 900000000815bcc8 900000000815bcc0 900000012c57b790 0000000000000001
    > 0000000000000001 4b031894b9d6b725 0000000004dec000 90000001003299c0
    > 0000000000000414 0000000000000001 000000000000002d 0000000000000003
    > 0000000000000030 00000000000003b4 0000000004dec000 90000001184a0000
    > 900000000806d000 9000000007e53788 00000000000000b4 0000000000000004
    > 0000000000000004 0000000000000000 0000000000000000 9000000107baf600
    > 9000000008916000 9000000007e53788 9000000005924778 0000000010000044
    > 00000000000000b0 0000000000000004 0000000000000000 0000000000071c1d
    > ...
    > Call Trace:
    > [&lt;9000000005924778&gt;] show_stack+0x38/0x180
    > [&lt;90000000071519c4&gt;] dump_stack_lvl+0x94/0xe4
    > [&lt;90000000059eb754&gt;] lockdep_rcu_suspicious+0x194/0x240
    > [&lt;ffff8000022143bc&gt;] kvm_gfn_to_hva_cache_init+0xfc/0x120 [kvm]
    > [&lt;ffff80000222ade4&gt;] kvm_pre_enter_guest+0x3a4/0x520 [kvm]
    > [&lt;ffff80000222b3dc&gt;] kvm_handle_exit+0x23c/0x480 [kvm]
    > Fix it by protecting kvm_check_requests() with SRCU.
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Huacai Chen &lt;chenhuacai@loongson.cn&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ HID: i2c-hid: Revert to using power commands to wake on resume (@Kenny Levinsen in [0c08f4a6016d981](https://github.com/sophgo/linux-riscv/commit/0c08f4a6016d981) at 2024-12-14 19:03:20)
    > commit 34851431ceca1bf457d85895bd38a4e7967e2055 upstream.
    > commit 7d6f065de37c (&quot;HID: i2c-hid: Use address probe to wake on resume&quot;)
    > replaced the retry of power commands with the dummy read &quot;bus probe&quot; we
    > use on boot which accounts for a necessary delay before retry.
    > This made at least one Weida device (2575:0910 in an ASUS Vivobook S14)
    > very unhappy, as the bus probe despite being successful somehow lead to
    > the following power command failing so hard that the device never lets
    > go of the bus. This means that even retries of the power command would
    > fail on a timeout as the bus remains busy.
    > Remove the bus probe on resume and instead reintroduce retry of the
    > power command for wake-up purposes while respecting the newly
    > established wake-up retry timings.
    > Fixes: 7d6f065de37c (&quot;HID: i2c-hid: Use address probe to wake on resume&quot;)
    > Cc: stable@vger.kernel.org
    > Reported-by: Michael &lt;auslands-kv@gmx.de&gt;
    > Closes: https://bugzilla.kernel.org/show_bug.cgi?id&#x3D;219440
    > Link: https://lore.kernel.org/r/d5acb485-7377-4139-826d-4df04d21b5ed@leemhuis.info/
    > Signed-off-by: Kenny Levinsen &lt;kl@kl.wtf&gt;
    > Link: https://patch.msgid.link/20241119235615.23902-1-kl@kl.wtf
    > Signed-off-by: Benjamin Tissoires &lt;bentiss@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ bpf: Handle BPF_EXIST and BPF_NOEXIST for LPM trie (@Hou Tao in [81ec3c6ceb7c9e6](https://github.com/sophgo/linux-riscv/commit/81ec3c6ceb7c9e6) at 2024-12-14 19:03:19)
    > [ Upstream commit eae6a075e9537dd69891cf77ca5a88fa8a28b4a1 ]
    > Add the currently missing handling for the BPF_EXIST and BPF_NOEXIST
    > flags. These flags can be specified by users and are relevant since LPM
    > trie supports exact matches during update.
    > Fixes: b95a5c4db09b (&quot;bpf: add a longest prefix match trie map implementation&quot;)
    > Reviewed-by: Toke Høiland-Jørgensen &lt;toke@redhat.com&gt;
    > Acked-by: Daniel Borkmann &lt;daniel@iogearbox.net&gt;
    > Signed-off-by: Hou Tao &lt;houtao1@huawei.com&gt;
    > Link: https://lore.kernel.org/r/20241206110622.1161752-4-houtao@huaweicloud.com
    > Signed-off-by: Alexei Starovoitov &lt;ast@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ bpf: Handle in-place update for full LPM trie correctly (@Hou Tao in [7218e441ad9d8f7](https://github.com/sophgo/linux-riscv/commit/7218e441ad9d8f7) at 2024-12-14 19:03:19)
    > [ Upstream commit 532d6b36b2bfac5514426a97a4df8d103d700d43 ]
    > When a LPM trie is full, in-place updates of existing elements
    > incorrectly return -ENOSPC.
    > Fix this by deferring the check of trie-&gt;n_entries. For new insertions,
    > n_entries must not exceed max_entries. However, in-place updates are
    > allowed even when the trie is full.
    > Fixes: b95a5c4db09b (&quot;bpf: add a longest prefix match trie map implementation&quot;)
    > Reviewed-by: Toke Høiland-Jørgensen &lt;toke@redhat.com&gt;
    > Signed-off-by: Hou Tao &lt;houtao1@huawei.com&gt;
    > Link: https://lore.kernel.org/r/20241206110622.1161752-5-houtao@huaweicloud.com
    > Signed-off-by: Alexei Starovoitov &lt;ast@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ bpf: Remove unnecessary kfree(im_node) in lpm_trie_update_elem (@Hou Tao in [6dc076a257a5343](https://github.com/sophgo/linux-riscv/commit/6dc076a257a5343) at 2024-12-14 19:03:19)
    > [ Upstream commit 3d5611b4d7efbefb85a74fcdbc35c603847cc022 ]
    > There is no need to call kfree(im_node) when updating element fails,
    > because im_node must be NULL. Remove the unnecessary kfree() for
    > im_node.
    > Reviewed-by: Toke Høiland-Jørgensen &lt;toke@redhat.com&gt;
    > Acked-by: Daniel Borkmann &lt;daniel@iogearbox.net&gt;
    > Signed-off-by: Hou Tao &lt;houtao1@huawei.com&gt;
    > Link: https://lore.kernel.org/r/20241206110622.1161752-3-houtao@huaweicloud.com
    > Signed-off-by: Alexei Starovoitov &lt;ast@kernel.org&gt;
    > Stable-dep-of: 532d6b36b2bf (&quot;bpf: Handle in-place update for full LPM trie correctly&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ bpf: Fix exact match conditions in trie_get_next_key() (@Hou Tao in [412bf01fd5dbda4](https://github.com/sophgo/linux-riscv/commit/412bf01fd5dbda4) at 2024-12-14 19:03:19)
    > [ Upstream commit 27abc7b3fa2e09bbe41e2924d328121546865eda ]
    > trie_get_next_key() uses node-&gt;prefixlen &#x3D;&#x3D; key-&gt;prefixlen to identify
    > an exact match, However, it is incorrect because when the target key
    > doesn&#x27;t fully match the found node (e.g., node-&gt;prefixlen !&#x3D; matchlen),
    > these two nodes may also have the same prefixlen. It will return
    > expected result when the passed key exist in the trie. However when a
    > recently-deleted key or nonexistent key is passed to
    > trie_get_next_key(), it may skip keys and return incorrect result.
    > Fix it by using node-&gt;prefixlen &#x3D;&#x3D; matchlen to identify exact matches.
    > When the condition is true after the search, it also implies
    > node-&gt;prefixlen equals key-&gt;prefixlen, otherwise, the search would
    > return NULL instead.
    > Fixes: b471f2f1de8b (&quot;bpf: implement MAP_GET_NEXT_KEY command for LPM_TRIE map&quot;)
    > Reviewed-by: Toke Høiland-Jørgensen &lt;toke@redhat.com&gt;
    > Signed-off-by: Hou Tao &lt;houtao1@huawei.com&gt;
    > Link: https://lore.kernel.org/r/20241206110622.1161752-6-houtao@huaweicloud.com
    > Signed-off-by: Alexei Starovoitov &lt;ast@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ iio: magnetometer: yas530: use signed integer type for clamp limits (@Jakob Hauser in [0e421cb8085cc50](https://github.com/sophgo/linux-riscv/commit/0e421cb8085cc50) at 2024-12-14 19:03:19)
    > [ Upstream commit f1ee5483e40881d8ad5a63aa148b753b5c6a839b ]
    > In the function yas537_measure() there is a clamp_val() with limits of
    > -BIT(13) and BIT(13) - 1.  The input clamp value h[] is of type s32.  The
    > BIT() is of type unsigned long integer due to its define in
    > include/vdso/bits.h.  The lower limit -BIT(13) is recognized as -8192 but
    > expressed as an unsigned long integer.  The size of an unsigned long
    > integer differs between 32-bit and 64-bit architectures.  Converting this
    > to type s32 may lead to undesired behavior.
    > Additionally, in the calculation lines h[0], h[1] and h[2] the unsigned
    > long integer divisor BIT(13) causes an unsigned division, shifting the
    > left-hand side of the equation back and forth, possibly ending up in large
    > positive values instead of negative values on 32-bit architectures.
    > To solve those two issues, declare a signed integer with a value of
    > BIT(13).
    > There is another omission in the clamp line: clamp_val() returns a value
    > and it&#x27;s going nowhere here.  Self-assign it to h[i] to make use of the
    > clamp macro.
    > Finally, replace clamp_val() macro by clamp() because after changing the
    > limits from type unsigned long integer to signed integer it&#x27;s fine that
    > way.
    > Link: https://lkml.kernel.org/r/11609b2243c295d65ab4d47e78c239d61ad6be75.1732914810.git.jahau@rocketmail.com
    > Fixes: 65f79b501030 (&quot;iio: magnetometer: yas530: Add YAS537 variant&quot;)
    > Signed-off-by: Jakob Hauser &lt;jahau@rocketmail.com&gt;
    > Reported-by: kernel test robot &lt;lkp@intel.com&gt;
    > Closes: https://lore.kernel.org/oe-kbuild-all/202411230458.dhZwh3TT-lkp@intel.com/
    > Closes: https://lore.kernel.org/oe-kbuild-all/202411282222.oF0B4110-lkp@intel.com/
    > Reviewed-by: David Laight &lt;david.laight@aculab.com&gt;
    > Acked-by: Jonathan Cameron &lt;Jonathan.Cameron@huawei.com&gt;
    > Cc: Lars-Peter Clausen &lt;lars@metafoo.de&gt;
    > Cc: Linus Walleij &lt;linus.walleij@linaro.org&gt;
    > Signed-off-by: Andrew Morton &lt;akpm@linux-foundation.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ smb: client: fix potential race in cifs_put_tcon() (@Paulo Alcantara in [0d8658c0cb599a5](https://github.com/sophgo/linux-riscv/commit/0d8658c0cb599a5) at 2024-12-14 19:03:19)
    > [ Upstream commit c32b624fa4f7ca5a2ff217a0b1b2f1352bb4ec11 ]
    > dfs_cache_refresh() delayed worker could race with cifs_put_tcon(), so
    > make sure to call list_replace_init() on @tcon-&gt;dfs_ses_list after
    > kworker is cancelled or finished.
    > Fixes: 4f42a8b54b5c (&quot;smb: client: fix DFS interlink failover&quot;)
    > Signed-off-by: Paulo Alcantara (Red Hat) &lt;pc@manguebit.com&gt;
    > Signed-off-by: Steve French &lt;stfrench@microsoft.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ scatterlist: fix incorrect func name in kernel-doc (@Randy Dunlap in [c2277e285923b62](https://github.com/sophgo/linux-riscv/commit/c2277e285923b62) at 2024-12-14 19:03:18)
    > [ Upstream commit d89c8ec0546184267cb211b579514ebaf8916100 ]
    > Fix a kernel-doc warning by making the kernel-doc function description
    > match the function name:
    > include/linux/scatterlist.h:323: warning: expecting prototype for sg_unmark_bus_address(). Prototype was for sg_dma_unmark_bus_address() instead
    > Link: https://lkml.kernel.org/r/20241130022406.537973-1-rdunlap@infradead.org
    > Fixes: 42399301203e (&quot;lib/scatterlist: add flag for indicating P2PDMA segments in an SGL&quot;)
    > Signed-off-by: Randy Dunlap &lt;rdunlap@infradead.org&gt;
    > Cc: Logan Gunthorpe &lt;logang@deltatee.com&gt;
    > Cc: Christoph Hellwig &lt;hch@lst.de&gt;
    > Signed-off-by: Andrew Morton &lt;akpm@linux-foundation.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/v3d: Enable Performance Counters before clearing them (@Maíra Canal in [b94c2f7a1a238c7](https://github.com/sophgo/linux-riscv/commit/b94c2f7a1a238c7) at 2024-12-14 19:03:18)
    > [ Upstream commit c98b10496b2f3c4f576af3482c71aadcfcbf765e ]
    > On the Raspberry Pi 5, performance counters are not being cleared
    > when &#x60;v3d_perfmon_start()&#x60; is called, even though we write to the
    > CLR register. As a result, their values accumulate until they
    > overflow.
    > The expected behavior is for performance counters to reset to zero
    > at the start of a job. When the job finishes and the perfmon is
    > stopped, the counters should accurately reflect the values for that
    > specific job.
    > To ensure this behavior, the performance counters are now enabled
    > before being cleared. This allows the CLR register to function as
    > intended, zeroing the counter values when the job begins.
    > Fixes: 26a4dc29b74a (&quot;drm/v3d: Expose performance counters to userspace&quot;)
    > Signed-off-by: Maíra Canal &lt;mcanal@igalia.com&gt;
    > Reviewed-by: Iago Toral Quiroga &lt;itoral@igalia.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20241204122831.17015-1-mcanal@igalia.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ASoC: mediatek: mt8188-mt6359: Remove hardcoded dmic codec (@Nícolas F. R. A. Prado in [687e10f3a3c55e9](https://github.com/sophgo/linux-riscv/commit/687e10f3a3c55e9) at 2024-12-14 19:03:18)
    > [ Upstream commit ec16a3cdf37e507013062f9c4a2067eacdd12b62 ]
    > Remove hardcoded dmic codec from the UL_SRC dai link to avoid requiring
    > a dmic codec to be present for the driver to probe, as not every
    > MT8188-based platform might need a dmic codec. The codec can be assigned
    > to the dai link through the dai-link property in Devicetree on the
    > platforms where it is needed.
    > No Devicetree currently relies on it so it is safe to remove without
    > worrying about backward compatibility.
    > Fixes: 9f08dcbddeb3 (&quot;ASoC: mediatek: mt8188-mt6359: support new board with nau88255&quot;)
    > Signed-off-by: Nícolas F. R. A. Prado &lt;nfraprado@collabora.com&gt;
    > Reviewed-by: AngeloGioacchino Del Regno &lt;angelogioacchino.delregno@collabora.com&gt;
    > Link: https://patch.msgid.link/20241203-mt8188-6359-unhardcode-dmic-v1-1-346e3e5cbe6d@collabora.com
    > Signed-off-by: Mark Brown &lt;broonie@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ scsi: sg: Fix slab-use-after-free read in sg_release() (@Suraj Sonawane in [1f5e2f1ca587572](https://github.com/sophgo/linux-riscv/commit/1f5e2f1ca587572) at 2024-12-14 19:03:18)
    > [ Upstream commit f10593ad9bc36921f623361c9e3dd96bd52d85ee ]
    > Fix a use-after-free bug in sg_release(), detected by syzbot with KASAN:
    > BUG: KASAN: slab-use-after-free in lock_release+0x151/0xa30
    > kernel/locking/lockdep.c:5838
    > __mutex_unlock_slowpath+0xe2/0x750 kernel/locking/mutex.c:912
    > sg_release+0x1f4/0x2e0 drivers/scsi/sg.c:407
    > In sg_release(), the function kref_put(&amp;sfp-&gt;f_ref, sg_remove_sfp) is
    > called before releasing the open_rel_lock mutex. The kref_put() call may
    > decrement the reference count of sfp to zero, triggering its cleanup
    > through sg_remove_sfp(). This cleanup includes scheduling deferred work
    > via sg_remove_sfp_usercontext(), which ultimately frees sfp.
    > After kref_put(), sg_release() continues to unlock open_rel_lock and may
    > reference sfp or sdp. If sfp has already been freed, this results in a
    > slab-use-after-free error.
    > Move the kref_put(&amp;sfp-&gt;f_ref, sg_remove_sfp) call after unlocking the
    > open_rel_lock mutex. This ensures:
    > - No references to sfp or sdp occur after the reference count is
    > decremented.
    > - Cleanup functions such as sg_remove_sfp() and
    > sg_remove_sfp_usercontext() can safely execute without impacting the
    > mutex handling in sg_release().
    > The fix has been tested and validated by syzbot. This patch closes the
    > bug reported at the following syzkaller link and ensures proper
    > sequencing of resource cleanup and mutex operations, eliminating the
    > risk of use-after-free errors in sg_release().
    > Reported-by: syzbot+7efb5850a17ba6ce098b@syzkaller.appspotmail.com
    > Closes: https://syzkaller.appspot.com/bug?extid&#x3D;7efb5850a17ba6ce098b
    > Tested-by: syzbot+7efb5850a17ba6ce098b@syzkaller.appspotmail.com
    > Fixes: cc833acbee9d (&quot;sg: O_EXCL and other lock handling&quot;)
    > Signed-off-by: Suraj Sonawane &lt;surajsonawane0215@gmail.com&gt;
    > Link: https://lore.kernel.org/r/20241120125944.88095-1-surajsonawane0215@gmail.com
    > Reviewed-by: Bart Van Assche &lt;bvanassche@acm.org&gt;
    > Signed-off-by: Martin K. Petersen &lt;martin.petersen@oracle.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ scsi: scsi_debug: Fix hrtimer support for ndelay (@John Garry in [1e1083db623dd13](https://github.com/sophgo/linux-riscv/commit/1e1083db623dd13) at 2024-12-14 19:03:18)
    > [ Upstream commit 6918141d815acef056a0d10e966a027d869a922d ]
    > Since commit 771f712ba5b0 (&quot;scsi: scsi_debug: Fix cmd duration
    > calculation&quot;), ns_from_boot value is only evaluated in schedule_resp()
    > for polled requests.
    > However, ns_from_boot is also required for hrtimer support for when
    > ndelay is less than INCLUSIVE_TIMING_MAX_NS, so fix up the logic to
    > decide when to evaluate ns_from_boot.
    > Fixes: 771f712ba5b0 (&quot;scsi: scsi_debug: Fix cmd duration calculation&quot;)
    > Signed-off-by: John Garry &lt;john.g.garry@oracle.com&gt;
    > Link: https://lore.kernel.org/r/20241202130045.2335194-1-john.g.garry@oracle.com
    > Signed-off-by: Martin K. Petersen &lt;martin.petersen@oracle.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ocfs2: free inode when ocfs2_get_init_inode() fails (@Tetsuo Handa in [03db61c43c8e272](https://github.com/sophgo/linux-riscv/commit/03db61c43c8e272) at 2024-12-14 19:03:18)
    > [ Upstream commit 965b5dd1894f4525f38c1b5f99b0106a07dbb5db ]
    > syzbot is reporting busy inodes after unmount, for commit 9c89fe0af826
    > (&quot;ocfs2: Handle error from dquot_initialize()&quot;) forgot to call iput() when
    > new_inode() succeeded and dquot_initialize() failed.
    > Link: https://lkml.kernel.org/r/e68c0224-b7c6-4784-b4fa-a9fc8c675525@I-love.SAKURA.ne.jp
    > Fixes: 9c89fe0af826 (&quot;ocfs2: Handle error from dquot_initialize()&quot;)
    > Signed-off-by: Tetsuo Handa &lt;penguin-kernel@I-love.SAKURA.ne.jp&gt;
    > Reported-by: syzbot+0af00f6a2cba2058b5db@syzkaller.appspotmail.com
    > Closes: https://syzkaller.appspot.com/bug?extid&#x3D;0af00f6a2cba2058b5db
    > Tested-by: syzbot+0af00f6a2cba2058b5db@syzkaller.appspotmail.com
    > Reviewed-by: Joseph Qi &lt;joseph.qi@linux.alibaba.com&gt;
    > Cc: Mark Fasheh &lt;mark@fasheh.com&gt;
    > Cc: Joel Becker &lt;jlbec@evilplan.org&gt;
    > Cc: Junxiao Bi &lt;junxiao.bi@oracle.com&gt;
    > Cc: Changwei Ge &lt;gechangwei@live.cn&gt;
    > Cc: Jun Piao &lt;piaojun@huawei.com&gt;
    > Signed-off-by: Andrew Morton &lt;akpm@linux-foundation.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ bpf: Fix narrow scalar spill onto 64-bit spilled scalar slots (@Tao Lyu in [f9f2a2739eb3ed6](https://github.com/sophgo/linux-riscv/commit/f9f2a2739eb3ed6) at 2024-12-14 19:03:17)
    > [ Upstream commit b0e66977dc072906bb76555fb1a64261d7f63d0f ]
    > When CAP_PERFMON and CAP_SYS_ADMIN (allow_ptr_leaks) are disabled, the
    > verifier aims to reject partial overwrite on an 8-byte stack slot that
    > contains a spilled pointer.
    > However, in such a scenario, it rejects all partial stack overwrites as
    > long as the targeted stack slot is a spilled register, because it does
    > not check if the stack slot is a spilled pointer.
    > Incomplete checks will result in the rejection of valid programs, which
    > spill narrower scalar values onto scalar slots, as shown below.
    > 0: R1&#x3D;ctx() R10&#x3D;fp0
    > ; asm volatile ( @ repro.bpf.c:679
    > 0: (7a) *(u64 *)(r10 -8) &#x3D; 1          ; R10&#x3D;fp0 fp-8_w&#x3D;1
    > 1: (62) *(u32 *)(r10 -8) &#x3D; 1
    > attempt to corrupt spilled pointer on stack
    > processed 2 insns (limit 1000000) max_states_per_insn 0 total_states 0 peak_states 0 mark_read 0.
    > Fix this by expanding the check to not consider spilled scalar registers
    > when rejecting the write into the stack.
    > Previous discussion on this patch is at link [0].
    > [0]: https://lore.kernel.org/bpf/20240403202409.2615469-1-tao.lyu@epfl.ch
    > Fixes: ab125ed3ec1c (&quot;bpf: fix check for attempt to corrupt spilled pointer&quot;)
    > Acked-by: Eduard Zingerman &lt;eddyz87@gmail.com&gt;
    > Acked-by: Andrii Nakryiko &lt;andrii@kernel.org&gt;
    > Signed-off-by: Tao Lyu &lt;tao.lyu@epfl.ch&gt;
    > Signed-off-by: Kumar Kartikeya Dwivedi &lt;memxor@gmail.com&gt;
    > Link: https://lore.kernel.org/r/20241204044757.1483141-3-memxor@gmail.com
    > Signed-off-by: Alexei Starovoitov &lt;ast@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ nvme-tcp: fix the memleak while create new ctrl failed (@Chunguang.xu in [ceff9ac13a2478a](https://github.com/sophgo/linux-riscv/commit/ceff9ac13a2478a) at 2024-12-14 19:03:17)
    > [ Upstream commit fec55c29e54d3ca6fe9d7d7d9266098b4514fd34 ]
    > Now while we create new ctrl failed, we have not free the
    > tagset occupied by admin_q, here try to fix it.
    > Fixes: fd1418de10b9 (&quot;nvme-tcp: avoid open-coding nvme_tcp_teardown_admin_queue()&quot;)
    > Signed-off-by: Chunguang.xu &lt;chunguang.xu@shopee.com&gt;
    > Reviewed-by: Christoph Hellwig &lt;hch@lst.de&gt;
    > Reviewed-by: Hannes Reinecke &lt;hare@suse.de&gt;
    > Signed-off-by: Keith Busch &lt;kbusch@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ nvme-fabrics: handle zero MAXCMD without closing the connection (@Maurizio Lombardi in [845cc4ee8e64a4d](https://github.com/sophgo/linux-riscv/commit/845cc4ee8e64a4d) at 2024-12-14 19:03:17)
    > [ Upstream commit 88c23a32b851e36adc4ab36f796d9b711f47e2bb ]
    > The NVMe specification states that MAXCMD is mandatory
    > for NVMe-over-Fabrics implementations. However, some NVMe/TCP
    > and NVMe/FC arrays from major vendors have buggy firmware
    > that reports MAXCMD as zero in the Identify Controller data structure.
    > Currently, the implementation closes the connection in such cases,
    > completely preventing the host from connecting to the target.
    > Fix the issue by printing a clear error message about the firmware bug
    > and allowing the connection to proceed. It assumes that the
    > target supports a MAXCMD value of SQSIZE + 1. If any issues arise,
    > the user can manually adjust SQSIZE to mitigate them.
    > Fixes: 4999568184e5 (&quot;nvme-fabrics: check max outstanding commands&quot;)
    > Signed-off-by: Maurizio Lombardi &lt;mlombard@redhat.com&gt;
    > Reviewed-by: Laurence Oberman &lt;loberman@redhat.com&gt;
    > Reviewed-by: Christoph Hellwig &lt;hch@lst.de&gt;
    > Signed-off-by: Keith Busch &lt;kbusch@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drivers/virt: pkvm: Don&#x27;t fail ioremap() call if MMIO_GUARD fails (@Will Deacon in [2459a0b14967370](https://github.com/sophgo/linux-riscv/commit/2459a0b14967370) at 2024-12-14 19:03:17)
    > [ Upstream commit d44679fb954ffea961036ed1aeb7d65035f78489 ]
    > Calling the MMIO_GUARD hypercall from guests which have not been
    > enrolled (e.g. because they are running without pvmfw) results in
    > -EINVAL being returned. In this case, MMIO_GUARD is not active
    > and so we can simply proceed with the normal ioremap() routine.
    > Don&#x27;t fail ioremap() if MMIO_GUARD fails; instead WARN_ON_ONCE()
    > to highlight that the pvm environment is slightly wonky.
    > Fixes: 0f1269495800 (&quot;drivers/virt: pkvm: Intercept ioremap using pKVM MMIO_GUARD hypercall&quot;)
    > Signed-off-by: Will Deacon &lt;will@kernel.org&gt;
    > Link: https://lore.kernel.org/r/20241202145731.6422-2-will@kernel.org
    > Signed-off-by: Catalin Marinas &lt;catalin.marinas@arm.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ bpf: Don&#x27;t mark STACK_INVALID as STACK_MISC in mark_stack_slot_misc (@Kumar Kartikeya Dwivedi in [0da7d4b7caf0a2d](https://github.com/sophgo/linux-riscv/commit/0da7d4b7caf0a2d) at 2024-12-14 19:03:17)
    > [ Upstream commit 69772f509e084ec6bca12dbcdeeeff41b0103774 ]
    > Inside mark_stack_slot_misc, we should not upgrade STACK_INVALID to
    > STACK_MISC when allow_ptr_leaks is false, since invalid contents
    > shouldn&#x27;t be read unless the program has the relevant capabilities.
    > The relaxation only makes sense when env-&gt;allow_ptr_leaks is true.
    > However, such conversion in privileged mode becomes unnecessary, as
    > invalid slots can be read without being upgraded to STACK_MISC.
    > Currently, the condition is inverted (i.e. checking for true instead of
    > false), simply remove it to restore correct behavior.
    > Fixes: eaf18febd6eb (&quot;bpf: preserve STACK_ZERO slots on partial reg spills&quot;)
    > Acked-by: Andrii Nakryiko &lt;andrii@kernel.org&gt;
    > Reported-by: Tao Lyu &lt;tao.lyu@epfl.ch&gt;
    > Signed-off-by: Kumar Kartikeya Dwivedi &lt;memxor@gmail.com&gt;
    > Link: https://lore.kernel.org/r/20241204044757.1483141-2-memxor@gmail.com
    > Signed-off-by: Alexei Starovoitov &lt;ast@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ nvme-rdma: unquiesce admin_q before destroy it (@Chunguang.xu in [05b436f3cf65c95](https://github.com/sophgo/linux-riscv/commit/05b436f3cf65c95) at 2024-12-14 19:03:17)
    > [ Upstream commit 5858b687559809f05393af745cbadf06dee61295 ]
    > Kernel will hang on destroy admin_q while we create ctrl failed, such
    > as following calltrace:
    > PID: 23644    TASK: ff2d52b40f439fc0  CPU: 2    COMMAND: &quot;nvme&quot;
    > #0 [ff61d23de260fb78] __schedule at ffffffff8323bc15
    > #1 [ff61d23de260fc08] schedule at ffffffff8323c014
    > #2 [ff61d23de260fc28] blk_mq_freeze_queue_wait at ffffffff82a3dba1
    > #3 [ff61d23de260fc78] blk_freeze_queue at ffffffff82a4113a
    > #4 [ff61d23de260fc90] blk_cleanup_queue at ffffffff82a33006
    > #5 [ff61d23de260fcb0] nvme_rdma_destroy_admin_queue at ffffffffc12686ce
    > #6 [ff61d23de260fcc8] nvme_rdma_setup_ctrl at ffffffffc1268ced
    > #7 [ff61d23de260fd28] nvme_rdma_create_ctrl at ffffffffc126919b
    > #8 [ff61d23de260fd68] nvmf_dev_write at ffffffffc024f362
    > #9 [ff61d23de260fe38] vfs_write at ffffffff827d5f25
    > RIP: 00007fda7891d574  RSP: 00007ffe2ef06958  RFLAGS: 00000202
    > RAX: ffffffffffffffda  RBX: 000055e8122a4d90  RCX: 00007fda7891d574
    > RDX: 000000000000012b  RSI: 000055e8122a4d90  RDI: 0000000000000004
    > RBP: 00007ffe2ef079c0   R8: 000000000000012b   R9: 000055e8122a4d90
    > R10: 0000000000000000  R11: 0000000000000202  R12: 0000000000000004
    > R13: 000055e8122923c0  R14: 000000000000012b  R15: 00007fda78a54500
    > ORIG_RAX: 0000000000000001  CS: 0033  SS: 002b
    > This due to we have quiesced admi_q before cancel requests, but forgot
    > to unquiesce before destroy it, as a result we fail to drain the
    > pending requests, and hang on blk_mq_freeze_queue_wait() forever. Here
    > try to reuse nvme_rdma_teardown_admin_queue() to fix this issue and
    > simplify the code.
    > Fixes: 958dc1d32c80 (&quot;nvme-rdma: add clean action for failed reconnection&quot;)
    > Reported-by: Yingfu.zhou &lt;yingfu.zhou@shopee.com&gt;
    > Signed-off-by: Chunguang.xu &lt;chunguang.xu@shopee.com&gt;
    > Signed-off-by: Yue.zhao &lt;yue.zhao@shopee.com&gt;
    > Reviewed-by: Christoph Hellwig &lt;hch@lst.de&gt;
    > Reviewed-by: Hannes Reinecke &lt;hare@suse.de&gt;
    > Signed-off-by: Keith Busch &lt;kbusch@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ x86/pkeys: Ensure updated PKRU value is XRSTOR&#x27;d (@Aruna Ramakrishna in [dd9478d54c738e8](https://github.com/sophgo/linux-riscv/commit/dd9478d54c738e8) at 2024-12-14 19:03:16)
    > [ Upstream commit ae6012d72fa60c9ff92de5bac7a8021a47458e5b ]
    > When XSTATE_BV[i] is 0, and XRSTOR attempts to restore state component
    > &#x27;i&#x27; it ignores any value in the XSAVE buffer and instead restores the
    > state component&#x27;s init value.
    > This means that if XSAVE writes XSTATE_BV[PKRU]&#x3D;0 then XRSTOR will
    > ignore the value that update_pkru_in_sigframe() writes to the XSAVE buffer.
    > XSTATE_BV[PKRU] only gets written as 0 if PKRU is in its init state. On
    > Intel CPUs, basically never happens because the kernel usually
    > overwrites the init value (aside: this is why we didn&#x27;t notice this bug
    > until now). But on AMD, the init tracker is more aggressive and will
    > track PKRU as being in its init state upon any wrpkru(0x0).
    > Unfortunately, sig_prepare_pkru() does just that: wrpkru(0x0).
    > This writes XSTATE_BV[PKRU]&#x3D;0 which makes XRSTOR ignore the PKRU value
    > in the sigframe.
    > To fix this, always overwrite the sigframe XSTATE_BV with a value that
    > has XSTATE_BV[PKRU]&#x3D;&#x3D;1.  This ensures that XRSTOR will not ignore what
    > update_pkru_in_sigframe() wrote.
    > The problematic sequence of events is something like this:
    > Userspace does:
    > wrpkru(0xffff0000) (or whatever)
    > Hardware sets: XINUSE[PKRU]&#x3D;1
    > Signal happens, kernel is entered:
    > sig_prepare_pkru() &#x3D;&gt; wrpkru(0x00000000)
    > Hardware sets: XINUSE[PKRU]&#x3D;0 (aggressive AMD init tracker)
    > XSAVE writes most of XSAVE buffer, including
    > XSTATE_BV[PKRU]&#x3D;XINUSE[PKRU]&#x3D;0
    > update_pkru_in_sigframe() overwrites PKRU in XSAVE buffer
    > ... signal handling
    > XRSTOR sees XSTATE_BV[PKRU]&#x3D;&#x3D;0, ignores just-written value
    > from update_pkru_in_sigframe()
    > Fixes: 70044df250d0 (&quot;x86/pkeys: Update PKRU to enable all pkeys before XSAVE&quot;)
    > Suggested-by: Rudi Horn &lt;rudi.horn@oracle.com&gt;
    > Signed-off-by: Aruna Ramakrishna &lt;aruna.ramakrishna@oracle.com&gt;
    > Signed-off-by: Dave Hansen &lt;dave.hansen@linux.intel.com&gt;
    > Acked-by: Dave Hansen &lt;dave.hansen@linux.intel.com&gt;
    > Link: https://lore.kernel.org/all/20241119174520.3987538-3-aruna.ramakrishna%40oracle.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ bpf: Ensure reg is PTR_TO_STACK in process_iter_arg (@Tao Lyu in [bdbf87486dca2c9](https://github.com/sophgo/linux-riscv/commit/bdbf87486dca2c9) at 2024-12-14 19:03:16)
    > [ Upstream commit 12659d28615d606b36e382f4de2dd05550d202af ]
    > Currently, KF_ARG_PTR_TO_ITER handling missed checking the reg-&gt;type and
    > ensuring it is PTR_TO_STACK. Instead of enforcing this in the caller of
    > process_iter_arg, move the check into it instead so that all callers
    > will gain the check by default. This is similar to process_dynptr_func.
    > An existing selftest in verifier_bits_iter.c fails due to this change,
    > but it&#x27;s because it was passing a NULL pointer into iter_next helper and
    > getting an error further down the checks, but probably meant to pass an
    > uninitialized iterator on the stack (as is done in the subsequent test
    > below it). We will gain coverage for non-PTR_TO_STACK arguments in later
    > patches hence just change the declaration to zero-ed stack object.
    > Fixes: 06accc8779c1 (&quot;bpf: add support for open-coded iterator loops&quot;)
    > Suggested-by: Andrii Nakryiko &lt;andrii@kernel.org&gt;
    > Signed-off-by: Tao Lyu &lt;tao.lyu@epfl.ch&gt;
    > [ Kartikeya: move check into process_iter_arg, rewrite commit log ]
    > Signed-off-by: Kumar Kartikeya Dwivedi &lt;memxor@gmail.com&gt;
    > Link: https://lore.kernel.org/r/20241203000238.3602922-2-memxor@gmail.com
    > Signed-off-by: Alexei Starovoitov &lt;ast@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ pmdomain: core: Fix error path in pm_genpd_init() when ida alloc fails (@Ulf Hansson in [913a3f1c06a4568](https://github.com/sophgo/linux-riscv/commit/913a3f1c06a4568) at 2024-12-14 19:03:16)
    > [ Upstream commit 3e3b71d35a02cee4b2cc3d4255668a6609165518 ]
    > When the ida allocation fails we need to free up the previously allocated
    > memory before returning the error code. Let&#x27;s fix this and while at it,
    > let&#x27;s also move the ida allocation to genpd_alloc_data() and the freeing to
    > genpd_free_data(), as it better belongs there.
    > Fixes: 899f44531fe6 (&quot;pmdomain: core: Add GENPD_FLAG_DEV_NAME_FW flag&quot;)
    > Signed-off-by: Ulf Hansson &lt;ulf.hansson@linaro.org&gt;
    > Message-ID: &lt;20241122134207.157283-3-ulf.hansson@linaro.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ irqchip/stm32mp-exti: CONFIG_STM32MP_EXTI should not default to y when compile-testing (@Geert Uytterhoeven in [7cddf3b4a052902](https://github.com/sophgo/linux-riscv/commit/7cddf3b4a052902) at 2024-12-14 19:03:16)
    > [ Upstream commit 9151299ee5101e03eeed544c1280b0e14b89a8a4 ]
    > Merely enabling compile-testing should not enable additional functionality.
    > Fixes: 0be58e0553812fcb (&quot;irqchip/stm32mp-exti: Allow building as module&quot;)
    > Signed-off-by: Geert Uytterhoeven &lt;geert+renesas@glider.be&gt;
    > Signed-off-by: Thomas Gleixner &lt;tglx@linutronix.de&gt;
    > Link: https://lore.kernel.org/all/ef5ec063b23522058f92087e072419ea233acfe9.1733243115.git.geert+renesas@glider.be
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ nvme: don&#x27;t apply NVME_QUIRK_DEALLOCATE_ZEROES when DSM is not supported (@Christoph Hellwig in [554888798756e86](https://github.com/sophgo/linux-riscv/commit/554888798756e86) at 2024-12-14 19:03:16)
    > [ Upstream commit 58a0c875ce028678c9594c7bdf3fe33462392808 ]
    > Commit 63dfa1004322 (&quot;nvme: move NVME_QUIRK_DEALLOCATE_ZEROES out of
    > nvme_config_discard&quot;) started applying the NVME_QUIRK_DEALLOCATE_ZEROES
    > quirk even then the Dataset Management is not supported.  It turns out
    > that there versions of these old Intel SSDs that have DSM support
    > disabled in the firmware, which will now lead to errors everytime
    > a Write Zeroes command is issued.  Fix this by checking for DSM support
    > before applying the quirk.
    > Reported-by: Saeed Mirzamohammadi &lt;saeed.mirzamohammadi@oracle.com&gt;
    > Fixes: 63dfa1004322 (&quot;nvme: move NVME_QUIRK_DEALLOCATE_ZEROES out of nvme_config_discard&quot;)
    > Tested-by: Saeed Mirzamohammadi &lt;saeed.mirzamohammadi@oracle.com&gt;
    > Signed-off-by: Christoph Hellwig &lt;hch@lst.de&gt;
    > Reviewed-by: Nitesh Shetty &lt;nj.shetty@samsung.com&gt;
    > Reviewed-by: Chaitanya Kulkarni &lt;kch@nvidia.com&gt;
    > Signed-off-by: Keith Busch &lt;kbusch@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ x86/pkeys: Change caller of update_pkru_in_sigframe() (@Aruna Ramakrishna in [00dee8e1d7a9398](https://github.com/sophgo/linux-riscv/commit/00dee8e1d7a9398) at 2024-12-14 19:03:16)
    > [ Upstream commit 6a1853bdf17874392476b552398df261f75503e0 ]
    > update_pkru_in_sigframe() will shortly need some information which
    > is only available inside xsave_to_user_sigframe(). Move
    > update_pkru_in_sigframe() inside the other function to make it
    > easier to provide it that information.
    > No functional changes.
    > Signed-off-by: Aruna Ramakrishna &lt;aruna.ramakrishna@oracle.com&gt;
    > Signed-off-by: Dave Hansen &lt;dave.hansen@linux.intel.com&gt;
    > Link: https://lore.kernel.org/all/20241119174520.3987538-2-aruna.ramakrishna%40oracle.com
    > Stable-dep-of: ae6012d72fa6 (&quot;x86/pkeys: Ensure updated PKRU value is XRSTOR&#x27;d&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ASoC: SOF: ipc3-topology: Convert the topology pin index to ALH dai index (@Bard Liao in [eee02810cea3cf0](https://github.com/sophgo/linux-riscv/commit/eee02810cea3cf0) at 2024-12-14 19:03:15)
    > [ Upstream commit e9db1b551774037ebe39dde4a658d89ba95e260b ]
    > Intel SoundWire machine driver always uses Pin number 2 and above.
    > Currently, the pin number is used as the FW DAI index directly. As a
    > result, FW DAI 0 and 1 are never used. That worked fine because we use
    > up to 2 DAIs in a SDW link. Convert the topology pin index to ALH dai
    > index, the mapping is using 2-off indexing, iow, pin #2 is ALH dai #0.
    > The issue exists since beginning. And the Fixes tag is the first commit
    > that this commit can be applied.
    > Fixes: b66bfc3a9810 (&quot;ASoC: SOF: sof-audio: Fix broken early bclk feature for SSP&quot;)
    > Signed-off-by: Bard Liao &lt;yung-chuan.liao@linux.intel.com&gt;
    > Reviewed-by: Péter Ujfalusi &lt;peter.ujfalusi@linux.intel.com&gt;
    > Reviewed-by: Liam Girdwood &lt;liam.r.girdwood@intel.com&gt;
    > Reviewed-by: Kai Vehmanen &lt;kai.vehmanen@linux.intel.com&gt;
    > Reviewed-by: Ranjani Sridharan &lt;ranjani.sridharan@linux.intel.com&gt;
    > Link: https://patch.msgid.link/20241127092955.20026-1-yung-chuan.liao@linux.intel.com
    > Signed-off-by: Mark Brown &lt;broonie@kernel.org&gt;
    > Stable-dep-of: 6d544ea21d36 (&quot;ASoC: SOF: ipc3-topology: fix resource leaks in sof_ipc3_widget_setup_comp_dai()&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ tools: Override makefile ARCH variable if defined, but empty (@Björn Töpel in [cd3018c9b2ad6ff](https://github.com/sophgo/linux-riscv/commit/cd3018c9b2ad6ff) at 2024-12-14 19:03:15)
    > [ Upstream commit 537a2525eaf76ea9b0dca62b994500d8670b39d5 ]
    > There are a number of tools (bpftool, selftests), that require a
    > &quot;bootstrap&quot; build. Here, a bootstrap build is a build host variant of
    > a target. E.g., assume that you&#x27;re performing a bpftool cross-build on
    > x86 to riscv, a bootstrap build would then be an x86 variant of
    > bpftool. The typical way to perform the host build variant, is to pass
    > &quot;ARCH&#x3D;&quot; in a sub-make. However, if a variable has been set with a
    > command argument, then ordinary assignments in the makefile are
    > ignored.
    > This side-effect results in that ARCH, and variables depending on ARCH
    > are not set. Workaround by overriding ARCH to the host arch, if ARCH
    > is empty.
    > Fixes: 8859b0da5aac (&quot;tools/bpftool: Fix cross-build&quot;)
    > Signed-off-by: Björn Töpel &lt;bjorn@rivosinc.com&gt;
    > Signed-off-by: Daniel Borkmann &lt;daniel@iogearbox.net&gt;
    > Tested-by: Alexandre Ghiti &lt;alexghiti@rivosinc.com&gt;
    > Reviewed-by: Jean-Philippe Brucker &lt;jean-philippe@linaro.org&gt;
    > Reviewed-by: Namhyung Kim &lt;namhyung@kernel.org&gt;
    > Reviewed-by: Toke Høiland-Jørgensen &lt;toke@redhat.com&gt;
    > Acked-by: Quentin Monnet &lt;qmo@kernel.org&gt;
    > Acked-by: Jiri Olsa &lt;jolsa@kernel.org&gt;
    > Cc: Arnaldo Carvalho de Melo &lt;acme@redhat.com&gt;
    > Link: https://lore.kernel.org/bpf/20241127101748.165693-1-bjorn@kernel.org
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ pmdomain: core: Add missing put_device() (@Ulf Hansson in [a78af1180623f85](https://github.com/sophgo/linux-riscv/commit/a78af1180623f85) at 2024-12-14 19:03:15)
    > [ Upstream commit b8f7bbd1f4ecff6d6277b8c454f62bb0a1c6dbe4 ]
    > When removing a genpd we don&#x27;t clean up the genpd-&gt;dev correctly. Let&#x27;s add
    > the missing put_device() in genpd_free_data() to fix this.
    > Fixes: 401ea1572de9 (&quot;PM / Domain: Add struct device to genpd&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Ulf Hansson &lt;ulf.hansson@linaro.org&gt;
    > Message-ID: &lt;20241122134207.157283-2-ulf.hansson@linaro.org&gt;
    > Stable-dep-of: 3e3b71d35a02 (&quot;pmdomain: core: Fix error path in pm_genpd_init() when ida alloc fails&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ spi: mpc52xx: Add cancel_work_sync before module remove (@Pei Xiao in [90b72189de2cdda](https://github.com/sophgo/linux-riscv/commit/90b72189de2cdda) at 2024-12-14 19:03:15)
    > [ Upstream commit 984836621aad98802d92c4a3047114cf518074c8 ]
    > If we remove the module which will call mpc52xx_spi_remove
    > it will free &#x27;ms&#x27; through spi_unregister_controller.
    > while the work ms-&gt;work will be used. The sequence of operations
    > that may lead to a UAF bug.
    > Fix it by ensuring that the work is canceled before proceeding with
    > the cleanup in mpc52xx_spi_remove.
    > Fixes: ca632f556697 (&quot;spi: reorganize drivers&quot;)
    > Signed-off-by: Pei Xiao &lt;xiaopei01@kylinos.cn&gt;
    > Link: https://patch.msgid.link/1f16f8ae0e50ca9adb1dc849bf2ac65a40c9ceb9.1732783000.git.xiaopei01@kylinos.cn
    > Signed-off-by: Mark Brown &lt;broonie@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ALSA: usb-audio: Notify xrun for low-latency mode (@Takashi Iwai in [7bc37dd9ea96321](https://github.com/sophgo/linux-riscv/commit/7bc37dd9ea96321) at 2024-12-14 19:03:15)
    > [ Upstream commit 4f9d674377d090e38d93360bd4df21b67534d622 ]
    > The low-latency mode of USB-audio driver uses a similar approach like
    > the implicit feedback mode but it has an explicit queuing at the
    > trigger start time.  The difference is, however, that no packet will
    > be handled any longer after all queued packets are handled but no
    > enough data is fed.  In the case of implicit feedback mode, the
    > capture-side packet handling triggers the re-queuing, and this checks
    > the XRUN.  OTOH, in the low-latency mode, it just stops without XRUN
    > notification unless any new action is taken from user-space via ack
    > callback.  For example, when you stop the stream in aplay, no XRUN is
    > reported.
    > This patch adds the XRUN check at the packet complete callback in the
    > case all pending URBs are exhausted.  Strictly speaking, this state
    > doesn&#x27;t match really with XRUN; in theory the application may queue
    > immediately after this happens.  But such behavior is only for
    > 1-period configuration, which the USB-audio driver doesn&#x27;t support.
    > So we may conclude that this situation leads certainly to XRUN.
    > A caveat is that the XRUN should be triggered only for the PCM RUNNING
    > state, and not during DRAINING.  This additional state check is put in
    > notify_xrun(), too.
    > Fixes: d5f871f89e21 (&quot;ALSA: usb-audio: Improved lowlatency playback support&quot;)
    > Reported-by: Leonard Crestez &lt;cdleonard@gmail.com&gt;
    > Link: https://lore.kernel.org/25d5b0d8-4efd-4630-9d33-7a9e3fa9dc2b@gmail.com
    > Link: https://patch.msgid.link/20241128080446.1181-1-tiwai@suse.de
    > Signed-off-by: Takashi Iwai &lt;tiwai@suse.de&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ASoC: SOF: ipc3-topology: fix resource leaks in sof_ipc3_widget_setup_comp_dai() (@Dan Carpenter in [036d4d0d11a3ab6](https://github.com/sophgo/linux-riscv/commit/036d4d0d11a3ab6) at 2024-12-14 19:03:15)
    > [ Upstream commit 6d544ea21d367cbd9746ae882e67a839391a6594 ]
    > These error paths should free comp_dai before returning.
    > Fixes: 909dadf21aae (&quot;ASoC: SOF: topology: Make DAI widget parsing IPC agnostic&quot;)
    > Signed-off-by: Dan Carpenter &lt;dan.carpenter@linaro.org&gt;
    > Link: https://patch.msgid.link/67d185cf-d139-4f8c-970a-dbf0542246a8@stanley.mountain
    > Signed-off-by: Mark Brown &lt;broonie@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ xsk: always clear DMA mapping information when unmapping the pool (@Larysa Zaremba in [dabaf268460f885](https://github.com/sophgo/linux-riscv/commit/dabaf268460f885) at 2024-12-14 19:03:14)
    > [ Upstream commit ac9a48a6f1610b094072b815e884e1668aea4401 ]
    > When the umem is shared, the DMA mapping is also shared between the xsk
    > pools, therefore it should stay valid as long as at least 1 user remains.
    > However, the pool also keeps the copies of DMA-related information that are
    > initialized in the same way in xp_init_dma_info(), but cleared by
    > xp_dma_unmap() only for the last remaining pool, this causes the problems
    > below.
    > The first one is that the commit adbf5a42341f (&quot;ice: remove af_xdp_zc_qps
    > bitmap&quot;) relies on pool-&gt;dev to determine the presence of a ZC pool on a
    > given queue, avoiding internal bookkeeping. This works perfectly fine if
    > the UMEM is not shared, but reliably fails otherwise as stated in the
    > linked report.
    > The second one is pool-&gt;dma_pages which is dynamically allocated and
    > only freed in xp_dma_unmap(), this leads to a small memory leak. kmemleak
    > does not catch it, but by printing the allocation results after terminating
    > the userspace program it is possible to see that all addresses except the
    > one belonging to the last detached pool are still accessible through the
    > kmemleak dump functionality.
    > Always clear the DMA mapping information from the pool and free
    > pool-&gt;dma_pages when unmapping the pool, so that the only difference
    > between results of the last remaining user&#x27;s call and the ones before would
    > be the destruction of the DMA mapping.
    > Fixes: adbf5a42341f (&quot;ice: remove af_xdp_zc_qps bitmap&quot;)
    > Fixes: 921b68692abb (&quot;xsk: Enable sharing of dma mappings&quot;)
    > Reported-by: Alasdair McWilliam &lt;alasdair.mcwilliam@outlook.com&gt;
    > Closes: https://lore.kernel.org/PA4P194MB10056F208AF221D043F57A3D86512@PA4P194MB1005.EURP194.PROD.OUTLOOK.COM
    > Acked-by: Maciej Fijalkowski &lt;maciej.fijalkowski@intel.com&gt;
    > Signed-off-by: Larysa Zaremba &lt;larysa.zaremba@intel.com&gt;
    > Link: https://lore.kernel.org/r/20241122112912.89881-1-larysa.zaremba@intel.com
    > Signed-off-by: Alexei Starovoitov &lt;ast@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ bpf, vsock: Invoke proto::close on close() (@Michal Luczaj in [a222e48feaf119d](https://github.com/sophgo/linux-riscv/commit/a222e48feaf119d) at 2024-12-14 19:03:14)
    > [ Upstream commit 135ffc7becc82cfb84936ae133da7969220b43b2 ]
    > vsock defines a BPF callback to be invoked when close() is called. However,
    > this callback is never actually executed. As a result, a closed vsock
    > socket is not automatically removed from the sockmap/sockhash.
    > Introduce a dummy vsock_close() and make vsock_release() call proto::close.
    > Note: changes in __vsock_release() look messy, but it&#x27;s only due to indent
    > level reduction and variables xmas tree reorder.
    > Fixes: 634f1a7110b4 (&quot;vsock: support sockmap&quot;)
    > Signed-off-by: Michal Luczaj &lt;mhal@rbox.co&gt;
    > Reviewed-by: Stefano Garzarella &lt;sgarzare@redhat.com&gt;
    > Reviewed-by: Luigi Leonardi &lt;leonardi@redhat.com&gt;
    > Link: https://lore.kernel.org/r/20241118-vsock-bpf-poll-close-v1-3-f1b9669cacdc@rbox.co
    > Signed-off-by: Alexei Starovoitov &lt;ast@kernel.org&gt;
    > Acked-by: John Fastabend &lt;john.fastabend@gmail.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/sti: Add __iomem for mixer_dbg_mxn&#x27;s parameter (@Pei Xiao in [8bc28b537d578b2](https://github.com/sophgo/linux-riscv/commit/8bc28b537d578b2) at 2024-12-14 19:03:14)
    > [ Upstream commit 86e8f94789dd6f3e705bfa821e1e416f97a2f863 ]
    > Sparse complains about incorrect type in argument 1.
    > expected void const volatile  __iomem *ptr but got void *.
    > so modify mixer_dbg_mxn&#x27;s addr parameter.
    > Reported-by: kernel test robot &lt;lkp@intel.com&gt;
    > Closes: https://lore.kernel.org/oe-kbuild-all/202411191809.6V3c826r-lkp@intel.com/
    > Fixes: a5f81078a56c (&quot;drm/sti: add debugfs entries for MIXER crtc&quot;)
    > Signed-off-by: Pei Xiao &lt;xiaopei01@kylinos.cn&gt;
    > Acked-by: Raphael Gallais-Pou &lt;rgallaispou@gmail.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/c28f0dcb6a4526721d83ba1f659bba30564d3d54.1732087094.git.xiaopei01@kylinos.cn
    > Signed-off-by: Raphael Gallais-Pou &lt;raphael.gallais-pou@foss.st.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ tcp_bpf: Fix the sk_mem_uncharge logic in tcp_bpf_sendmsg (@Zijian Zhang in [5c9e3bb43a354a2](https://github.com/sophgo/linux-riscv/commit/5c9e3bb43a354a2) at 2024-12-14 19:03:14)
    > [ Upstream commit ca70b8baf2bd125b2a4d96e76db79375c07d7ff2 ]
    > The current sk memory accounting logic in __SK_REDIRECT is pre-uncharging
    > tosend bytes, which is either msg-&gt;sg.size or a smaller value apply_bytes.
    > Potential problems with this strategy are as follows:
    > - If the actual sent bytes are smaller than tosend, we need to charge some
    > bytes back, as in line 487, which is okay but seems not clean.
    > - When tosend is set to apply_bytes, as in line 417, and (ret &lt; 0), we may
    > miss uncharging (msg-&gt;sg.size - apply_bytes) bytes.
    > [...]
    > 415 tosend &#x3D; msg-&gt;sg.size;
    > 416 if (psock-&gt;apply_bytes &amp;&amp; psock-&gt;apply_bytes &lt; tosend)
    > 417   tosend &#x3D; psock-&gt;apply_bytes;
    > [...]
    > 443 sk_msg_return(sk, msg, tosend);
    > 444 release_sock(sk);
    > 446 origsize &#x3D; msg-&gt;sg.size;
    > 447 ret &#x3D; tcp_bpf_sendmsg_redir(sk_redir, redir_ingress,
    > 448                             msg, tosend, flags);
    > 449 sent &#x3D; origsize - msg-&gt;sg.size;
    > [...]
    > 454 lock_sock(sk);
    > 455 if (unlikely(ret &lt; 0)) {
    > 456   int free &#x3D; sk_msg_free_nocharge(sk, msg);
    > 458   if (!cork)
    > 459     *copied -&#x3D; free;
    > 460 }
    > [...]
    > 487 if (eval &#x3D;&#x3D; __SK_REDIRECT)
    > 488   sk_mem_charge(sk, tosend - sent);
    > [...]
    > When running the selftest test_txmsg_redir_wait_sndmem with txmsg_apply,
    > the following warning will be reported:
    > ------------[ cut here ]------------
    > WARNING: CPU: 6 PID: 57 at net/ipv4/af_inet.c:156 inet_sock_destruct+0x190/0x1a0
    > Modules linked in:
    > CPU: 6 UID: 0 PID: 57 Comm: kworker/6:0 Not tainted 6.12.0-rc1.bm.1-amd64+ #43
    > Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.12.0-1 04/01/2014
    > Workqueue: events sk_psock_destroy
    > RIP: 0010:inet_sock_destruct+0x190/0x1a0
    > RSP: 0018:ffffad0a8021fe08 EFLAGS: 00010206
    > RAX: 0000000000000011 RBX: ffff9aab4475b900 RCX: ffff9aab481a0800
    > RDX: 0000000000000303 RSI: 0000000000000011 RDI: ffff9aab4475b900
    > RBP: ffff9aab4475b990 R08: 0000000000000000 R09: ffff9aab40050ec0
    > R10: 0000000000000000 R11: ffff9aae6fdb1d01 R12: ffff9aab49c60400
    > R13: ffff9aab49c60598 R14: ffff9aab49c60598 R15: dead000000000100
    > FS:  0000000000000000(0000) GS:ffff9aae6fd80000(0000) knlGS:0000000000000000
    > CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
    > CR2: 00007ffec7e47bd8 CR3: 00000001a1a1c004 CR4: 0000000000770ef0
    > DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
    > DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
    > PKRU: 55555554
    > Call Trace:
    > &lt;TASK&gt;
    > ? __warn+0x89/0x130
    > ? inet_sock_destruct+0x190/0x1a0
    > ? report_bug+0xfc/0x1e0
    > ? handle_bug+0x5c/0xa0
    > ? exc_invalid_op+0x17/0x70
    > ? asm_exc_invalid_op+0x1a/0x20
    > ? inet_sock_destruct+0x190/0x1a0
    > __sk_destruct+0x25/0x220
    > sk_psock_destroy+0x2b2/0x310
    > process_scheduled_works+0xa3/0x3e0
    > worker_thread+0x117/0x240
    > ? __pfx_worker_thread+0x10/0x10
    > kthread+0xcf/0x100
    > ? __pfx_kthread+0x10/0x10
    > ret_from_fork+0x31/0x40
    > ? __pfx_kthread+0x10/0x10
    > ret_from_fork_asm+0x1a/0x30
    > &lt;/TASK&gt;
    > ---[ end trace 0000000000000000 ]---
    > In __SK_REDIRECT, a more concise way is delaying the uncharging after sent
    > bytes are finalized, and uncharge this value. When (ret &lt; 0), we shall
    > invoke sk_msg_free.
    > Same thing happens in case __SK_DROP, when tosend is set to apply_bytes,
    > we may miss uncharging (msg-&gt;sg.size - apply_bytes) bytes. The same
    > warning will be reported in selftest.
    > [...]
    > 468 case __SK_DROP:
    > 469 default:
    > 470 sk_msg_free_partial(sk, msg, tosend);
    > 471 sk_msg_apply_bytes(psock, tosend);
    > 472 *copied -&#x3D; (tosend + delta);
    > 473 return -EACCES;
    > [...]
    > So instead of sk_msg_free_partial we can do sk_msg_free here.
    > Fixes: 604326b41a6f (&quot;bpf, sockmap: convert to generic sk_msg interface&quot;)
    > Fixes: 8ec95b94716a (&quot;bpf, sockmap: Fix the sk-&gt;sk_forward_alloc warning of sk_stream_kill_queues&quot;)
    > Signed-off-by: Zijian Zhang &lt;zijianzhang@bytedance.com&gt;
    > Signed-off-by: Daniel Borkmann &lt;daniel@iogearbox.net&gt;
    > Acked-by: John Fastabend &lt;john.fastabend@gmail.com&gt;
    > Link: https://lore.kernel.org/bpf/20241016234838.3167769-3-zijianzhang@bytedance.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ bpftool: fix potential NULL pointer dereferencing in prog_dump() (@Amir Mohammadi in [1b6341c9d20b8bc](https://github.com/sophgo/linux-riscv/commit/1b6341c9d20b8bc) at 2024-12-14 19:03:14)
    > [ Upstream commit ef3ba8c258ee368a5343fa9329df85b4bcb9e8b5 ]
    > A NULL pointer dereference could occur if ksyms
    > is not properly checked before usage in the prog_dump() function.
    > Fixes: b053b439b72a (&quot;bpf: libbpf: bpftool: Print bpf_line_info during prog dump&quot;)
    > Signed-off-by: Amir Mohammadi &lt;amiremohamadi@yahoo.com&gt;
    > Reviewed-by: Quentin Monnet &lt;qmo@kernel.org&gt;
    > Acked-by: John Fastabend &lt;john.fastabend@gmail.com&gt;
    > Link: https://lore.kernel.org/r/20241121083413.7214-1-amiremohamadi@yahoo.com
    > Signed-off-by: Alexei Starovoitov &lt;ast@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ALSA: seq: ump: Fix seq port updates per FB info notify (@Takashi Iwai in [01c3525718e8518](https://github.com/sophgo/linux-riscv/commit/01c3525718e8518) at 2024-12-14 19:03:14)
    > [ Upstream commit aaa55faa2495320e44bc643a917c701f2cc89ee7 ]
    > update_port_infos() is called when a UMP FB Info update notification
    > is received, and this function is supposed to update the attributes of
    > the corresponding sequencer port.  However, the function had a few
    > issues and it brought to the incorrect states.  Namely:
    > - It tried to get a wrong sequencer info for the update without
    > correcting the port number with the group-offset 1
    > - The loop exited immediately when a sequencer port isn&#x27;t present;
    > this ended up with the truncation if a sequencer port in the middle
    > goes away
    > This patch addresses those bugs.
    > Fixes: 4a16a3af0571 (&quot;ALSA: seq: ump: Handle FB info update&quot;)
    > Link: https://patch.msgid.link/20241128170423.23351-1-tiwai@suse.de
    > Signed-off-by: Takashi Iwai &lt;tiwai@suse.de&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ scsi: ufs: core: Always initialize the UIC done completion (@Bart Van Assche in [7d4e5e33ea4ef4a](https://github.com/sophgo/linux-riscv/commit/7d4e5e33ea4ef4a) at 2024-12-14 19:03:13)
    > [ Upstream commit b1e8c53749adb795bfb0bf4e2f7836e26684bb90 ]
    > Simplify __ufshcd_send_uic_cmd() by always initializing the
    > uic_cmd::done completion. This is fine since the time required to
    > initialize a completion is small compared to the time required to
    > process an UIC command.
    > Reviewed-by: Peter Wang &lt;peter.wang@mediatek.com&gt;
    > Signed-off-by: Bart Van Assche &lt;bvanassche@acm.org&gt;
    > Link: https://lore.kernel.org/r/20240912223019.3510966-5-bvanassche@acm.org
    > Signed-off-by: Martin K. Petersen &lt;martin.petersen@oracle.com&gt;
    > Stable-dep-of: 60b4dd1460f6 (&quot;scsi: ufs: core: Add ufshcd_send_bsg_uic_cmd() for UFS BSG&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/amd/display: calculate final viewport before TAP optimization (@Yihan Zhu in [7c4fd0072ad1be4](https://github.com/sophgo/linux-riscv/commit/7c4fd0072ad1be4) at 2024-12-14 19:03:13)
    > [ Upstream commit e982310c9ce074e428abc260dc3cba1b1ea62b78 ]
    > Viewport size excess surface size observed sometime with some timings or
    > resizing the MPO video window to cause MPO unsupported. Calculate final
    > viewport size first with a 100x100 dummy viewport to get the max TAP
    > support and then re-run final viewport calculation if TAP value changed.
    > Removed obsolete preliminary viewport calculation for TAP validation.
    > Reviewed-by: Dmytro Laktyushkin &lt;dmytro.laktyushkin@amd.com&gt;
    > Signed-off-by: Yihan Zhu &lt;Yihan.Zhu@amd.com&gt;
    > Signed-off-by: Rodrigo Siqueira &lt;rodrigo.siqueira@amd.com&gt;
    > Tested-by: Daniel Wheeler &lt;daniel.wheeler@amd.com&gt;
    > Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Stable-dep-of: c33a93201ca0 (&quot;drm/amd/display: Ignore scalar validation failure if pipe is phantom&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/amd/display: Ignore scalar validation failure if pipe is phantom (@Chris Park in [66edf59bc444e67](https://github.com/sophgo/linux-riscv/commit/66edf59bc444e67) at 2024-12-14 19:03:13)
    > [ Upstream commit c33a93201ca07119de90e8c952fbdf65920ab55d ]
    > [Why]
    > There are some pipe scaler validation failure when the pipe is phantom
    > and causes crash in DML validation. Since, scalar parameters are not
    > as important in phantom pipe and we require this plane to do successful
    > MCLK switches, the failure condition can be ignored.
    > [How]
    > Ignore scalar validation failure if the pipe validation is marked as
    > phantom pipe.
    > Cc: stable@vger.kernel.org # 6.11+
    > Reviewed-by: Dillon Varone &lt;dillon.varone@amd.com&gt;
    > Signed-off-by: Chris Park &lt;chris.park@amd.com&gt;
    > Signed-off-by: Hamza Mahfooz &lt;hamza.mahfooz@amd.com&gt;
    > Tested-by: Daniel Wheeler &lt;daniel.wheeler@amd.com&gt;
    > Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ bpf, vsock: Fix poll() missing a queue (@Michal Luczaj in [47f4ad956be07ab](https://github.com/sophgo/linux-riscv/commit/47f4ad956be07ab) at 2024-12-14 19:03:13)
    > [ Upstream commit 9f0fc98145218ff8f50d8cfa3b393785056c53e1 ]
    > When a verdict program simply passes a packet without redirection, sk_msg
    > is enqueued on sk_psock::ingress_msg. Add a missing check to poll().
    > Fixes: 634f1a7110b4 (&quot;vsock: support sockmap&quot;)
    > Signed-off-by: Michal Luczaj &lt;mhal@rbox.co&gt;
    > Reviewed-by: Stefano Garzarella &lt;sgarzare@redhat.com&gt;
    > Reviewed-by: Luigi Leonardi &lt;leonardi@redhat.com&gt;
    > Link: https://lore.kernel.org/r/20241118-vsock-bpf-poll-close-v1-1-f1b9669cacdc@rbox.co
    > Signed-off-by: Alexei Starovoitov &lt;ast@kernel.org&gt;
    > Acked-by: John Fastabend &lt;john.fastabend@gmail.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ scsi: ufs: core: Add ufshcd_send_bsg_uic_cmd() for UFS BSG (@Ziqi Chen in [3ad69f2f0899931](https://github.com/sophgo/linux-riscv/commit/3ad69f2f0899931) at 2024-12-14 19:03:13)
    > [ Upstream commit 60b4dd1460f6d65739acb0f28d12bd9abaeb34b4 ]
    > User layer applications can send UIC GET/SET commands via the BSG
    > framework, and if the user layer application sends a UIC SET command to the
    > PA_PWRMODE attribute, a power mode change shall be initiated in UniPro and
    > two interrupts shall be triggered if the power mode is successfully
    > changed, i.e., UIC Command Completion interrupt and UIC Power Mode
    > interrupt.
    > The current UFS BSG code calls ufshcd_send_uic_cmd() directly, with which
    > the second interrupt, i.e., UIC Power Mode interrupt, shall be treated as
    > unhandled interrupt. In addition, after the UIC command is completed, user
    > layer application has to poll UniPro and/or M-PHY state machine to confirm
    > the power mode change is finished.
    > Add a new wrapper function ufshcd_send_bsg_uic_cmd() and call it from
    > ufs_bsg_request() so that if a UIC SET command is targeting the PA_PWRMODE
    > attribute it can be redirected to ufshcd_uic_pwr_ctrl().
    > Fixes: e77044c5a842 (&quot;scsi: ufs-bsg: Add support for uic commands in ufs_bsg_request()&quot;)
    > Co-developed-by: Can Guo &lt;quic_cang@quicinc.com&gt;
    > Signed-off-by: Can Guo &lt;quic_cang@quicinc.com&gt;
    > Signed-off-by: Ziqi Chen &lt;quic_ziqichen@quicinc.com&gt;
    > Link: https://lore.kernel.org/r/20241119095613.121385-1-quic_ziqichen@quicinc.com
    > Reviewed-by: Bean Huo &lt;beanhuo@micron.com&gt;
    > Reviewed-by: Avri Altman &lt;avri.altman@wdc.com&gt;
    > Reviewed-by: Peter Wang &lt;peter.wang@mediatek.com&gt;
    > Signed-off-by: Martin K. Petersen &lt;martin.petersen@oracle.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ i3c: master: Fix dynamic address leak when &#x27;assigned-address&#x27; is present (@Frank Li in [1117462773627ea](https://github.com/sophgo/linux-riscv/commit/1117462773627ea) at 2024-12-14 19:03:13)
    > [ Upstream commit 851bd21cdb55e727ab29280bc9f6b678164f802a ]
    > If the DTS contains &#x27;assigned-address&#x27;, a dynamic address leak occurs
    > during hotjoin events.
    > Assume a device have assigned-address 0xb.
    > - Device issue Hotjoin
    > - Call i3c_master_do_daa()
    > - Call driver xxx_do_daa()
    > - Call i3c_master_get_free_addr() to get dynamic address 0x9
    > - i3c_master_add_i3c_dev_locked(0x9)
    > -     expected_dyn_addr  &#x3D; newdev-&gt;boardinfo-&gt;init_dyn_addr (0xb);
    > -     i3c_master_reattach_i3c_dev(newdev(0xb), old_dyn_addr(0x9));
    > -         if (dev-&gt;info.dyn_addr !&#x3D; old_dyn_addr &amp;&amp;
    > ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ 0xb !&#x3D; 0x9 -&gt; TRUE
    > (!dev-&gt;boardinfo ||
    > ^^^^^^^^^^^^^^^ -&gt;  FALSE
    > dev-&gt;info.dyn_addr !&#x3D; dev-&gt;boardinfo-&gt;init_dyn_addr)) {
    > ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    > 0xb !&#x3D; 0xb      -&gt;  FALSE
    > ...
    > i3c_bus_set_addr_slot_status(&amp;master-&gt;bus, old_dyn_addr,
    > I3C_ADDR_SLOT_FREE);
    > ^^^
    > This will be skipped. So old_dyn_addr never free
    > }
    > - i3c_master_get_free_addr() will return increased sequence number.
    > Remove dev-&gt;info.dyn_addr !&#x3D; dev-&gt;boardinfo-&gt;init_dyn_addr condition check.
    > dev-&gt;info.dyn_addr should be checked before calling this function because
    > i3c_master_setnewda_locked() has already been called and the target device
    > has already accepted dyn_addr. It is too late to check if dyn_addr is free
    > in i3c_master_reattach_i3c_dev().
    > Add check to ensure expected_dyn_addr is free before
    > i3c_master_setnewda_locked().
    > Fixes: cc3a392d69b6 (&quot;i3c: master: fix for SETDASA and DAA process&quot;)
    > Cc: stable@kernel.org
    > Reviewed-by: Miquel Raynal &lt;miquel.raynal@bootlin.com&gt;
    > Signed-off-by: Frank Li &lt;Frank.Li@nxp.com&gt;
    > Link: https://lore.kernel.org/r/20241021-i3c_dts_assign-v8-3-4098b8bde01e@nxp.com
    > Signed-off-by: Alexandre Belloni &lt;alexandre.belloni@bootlin.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ f2fs: fix to adjust appropriate length for fiemap (@Zhiguo Niu in [e6a91ed4b9e5baf](https://github.com/sophgo/linux-riscv/commit/e6a91ed4b9e5baf) at 2024-12-14 19:03:12)
    > [ Upstream commit 77569f785c8624fa4189795fb52e635a973672e5 ]
    > If user give a file size as &quot;length&quot; parameter for fiemap
    > operations, but if this size is non-block size aligned,
    > it will show 2 segments fiemap results even this whole file
    > is contiguous on disk, such as the following results:
    > ./f2fs_io fiemap 0 19034 ylog/analyzer.py
    > Fiemap: offset &#x3D; 0 len &#x3D; 19034
    > logical addr.    physical addr.   length           flags
    > 0       0000000000000000 0000000020baa000 0000000000004000 00001000
    > 1       0000000000004000 0000000020bae000 0000000000001000 00001001
    > after this patch:
    > ./f2fs_io fiemap 0 19034 ylog/analyzer.py
    > Fiemap: offset &#x3D; 0 len &#x3D; 19034
    > logical addr.    physical addr.   length           flags
    > 0    0000000000000000 00000000315f3000 0000000000005000 00001001
    > Signed-off-by: Zhiguo Niu &lt;zhiguo.niu@unisoc.com&gt;
    > Signed-off-by: Jaegeuk Kim &lt;jaegeuk@kernel.org&gt;
    > Stable-dep-of: 6787a8224585 (&quot;f2fs: fix to requery extent which cross boundary of inquiry&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ i3c: master: Extend address status bit to 4 and add I3C_ADDR_SLOT_EXT_DESIRED (@Frank Li in [c3806cf64739ac1](https://github.com/sophgo/linux-riscv/commit/c3806cf64739ac1) at 2024-12-14 19:03:12)
    > [ Upstream commit 2f552fa280590e61bd3dbe66a7b54b99caa642a4 ]
    > Extend the address status bit to 4 and introduce the
    > I3C_ADDR_SLOT_EXT_DESIRED macro to indicate that a device prefers a
    > specific address. This is generally set by the &#x27;assigned-address&#x27; in the
    > device tree source (dts) file.
    > ┌────┬─────────────┬───┬─────────┬───┐
    > │S/Sr│ 7&#x27;h7E RnW&#x3D;0 │ACK│ ENTDAA  │ T ├────┐
    > └────┴─────────────┴───┴─────────┴───┘    │
    > ┌─────────────────────────────────────────┘
    > │  ┌──┬─────────────┬───┬─────────────────┬────────────────┬───┬─────────┐
    > └─►│Sr│7&#x27;h7E RnW&#x3D;1  │ACK│48bit UID BCR DCR│Assign 7bit Addr│PAR│ ACK/NACK│
    > └──┴─────────────┴───┴─────────────────┴────────────────┴───┴─────────┘
    > Some master controllers (such as HCI) need to prepare the entire above
    > transaction before sending it out to the I3C bus. This means that a 7-bit
    > dynamic address needs to be allocated before knowing the target device&#x27;s
    > UID information.
    > However, some I3C targets may request specific addresses (called as
    > &quot;init_dyn_addr&quot;), which is typically specified by the DT-&#x27;s
    > assigned-address property. Lower addresses having higher IBI priority. If
    > it is available, i3c_bus_get_free_addr() preferably return a free address
    > that is not in the list of desired addresses (called as &quot;init_dyn_addr&quot;).
    > This allows the device with the &quot;init_dyn_addr&quot; to switch to its
    > &quot;init_dyn_addr&quot; when it hot-joins the I3C bus. Otherwise, if the
    > &quot;init_dyn_addr&quot; is already in use by another I3C device, the target device
    > will not be able to switch to its desired address.
    > If the previous step fails, fallback returning one of the remaining
    > unassigned address, regardless of its state in the desired list.
    > Reviewed-by: Miquel Raynal &lt;miquel.raynal@bootlin.com&gt;
    > Signed-off-by: Frank Li &lt;Frank.Li@nxp.com&gt;
    > Link: https://lore.kernel.org/r/20241021-i3c_dts_assign-v8-2-4098b8bde01e@nxp.com
    > Signed-off-by: Alexandre Belloni &lt;alexandre.belloni@bootlin.com&gt;
    > Stable-dep-of: 851bd21cdb55 (&quot;i3c: master: Fix dynamic address leak when &#x27;assigned-address&#x27; is present&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ f2fs: fix to requery extent which cross boundary of inquiry (@Chao Yu in [8e9fec7f79ad62b](https://github.com/sophgo/linux-riscv/commit/8e9fec7f79ad62b) at 2024-12-14 19:03:12)
    > [ Upstream commit 6787a82245857271133b63ae7f72f1dc9f29e985 ]
    > dd if&#x3D;/dev/zero of&#x3D;file bs&#x3D;4k count&#x3D;5
    > xfs_io file -c &quot;fiemap -v 2 16384&quot;
    > file:
    > EXT: FILE-OFFSET      BLOCK-RANGE      TOTAL FLAGS
    > 0: [0..31]:         139272..139303      32 0x1000
    > 1: [32..39]:        139304..139311       8 0x1001
    > xfs_io file -c &quot;fiemap -v 0 16384&quot;
    > file:
    > EXT: FILE-OFFSET      BLOCK-RANGE      TOTAL FLAGS
    > 0: [0..31]:         139272..139303      32 0x1000
    > xfs_io file -c &quot;fiemap -v 0 16385&quot;
    > file:
    > EXT: FILE-OFFSET      BLOCK-RANGE      TOTAL FLAGS
    > 0: [0..39]:         139272..139311      40 0x1001
    > There are two problems:
    > - continuous extent is split to two
    > - FIEMAP_EXTENT_LAST is missing in last extent
    > The root cause is: if upper boundary of inquiry crosses extent,
    > f2fs_map_blocks() will truncate length of returned extent to
    > F2FS_BYTES_TO_BLK(len), and also, it will stop to query latter
    > extent or hole to make sure current extent is last or not.
    > In order to fix this issue, once we found an extent locates
    > in the end of inquiry range by f2fs_map_blocks(), we need to
    > expand inquiry range to requiry.
    > Cc: stable@vger.kernel.org
    > Fixes: 7f63eb77af7b (&quot;f2fs: report unwritten area in f2fs_fiemap&quot;)
    > Reported-by: Zhiguo Niu &lt;zhiguo.niu@unisoc.com&gt;
    > Signed-off-by: Chao Yu &lt;chao@kernel.org&gt;
    > Signed-off-by: Jaegeuk Kim &lt;jaegeuk@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ i3c: master: Replace hard code 2 with macro I3C_ADDR_SLOT_STATUS_BITS (@Frank Li in [815d8f0e524f73e](https://github.com/sophgo/linux-riscv/commit/815d8f0e524f73e) at 2024-12-14 19:03:12)
    > [ Upstream commit 16aed0a6520ba01b7d22c32e193fc1ec674f92d4 ]
    > Replace the hardcoded value 2, which indicates 2 bits for I3C address
    > status, with the predefined macro I3C_ADDR_SLOT_STATUS_BITS.
    > Improve maintainability and extensibility of the code.
    > Reviewed-by: Miquel Raynal &lt;miquel.raynal@bootlin.com&gt;
    > Signed-off-by: Frank Li &lt;Frank.Li@nxp.com&gt;
    > Link: https://lore.kernel.org/r/20241021-i3c_dts_assign-v8-1-4098b8bde01e@nxp.com
    > Signed-off-by: Alexandre Belloni &lt;alexandre.belloni@bootlin.com&gt;
    > Stable-dep-of: 851bd21cdb55 (&quot;i3c: master: Fix dynamic address leak when &#x27;assigned-address&#x27; is present&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ f2fs: clean up w/ F2FS_{BLK_TO_BYTES,BTYES_TO_BLK} (@Chao Yu in [6358df316dd8f1f](https://github.com/sophgo/linux-riscv/commit/6358df316dd8f1f) at 2024-12-14 19:03:12)
    > [ Upstream commit 7461f37094180200cb2f98e60ef99a0cea97beec ]
    > f2fs doesn&#x27;t support different blksize in one instance, so
    > bytes_to_blks() and blks_to_bytes() are equal to F2FS_BYTES_TO_BLK
    > and F2FS_BLK_TO_BYTES, let&#x27;s use F2FS_BYTES_TO_BLK/F2FS_BLK_TO_BYTES
    > instead for cleanup.
    > Reviewed-by: Zhiguo Niu &lt;zhiguo.niu@unisoc.com&gt;
    > Signed-off-by: Chao Yu &lt;chao@kernel.org&gt;
    > Signed-off-by: Jaegeuk Kim &lt;jaegeuk@kernel.org&gt;
    > Stable-dep-of: 6787a8224585 (&quot;f2fs: fix to requery extent which cross boundary of inquiry&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ntp: Remove invalid cast in time offset math (@Marcelo Dalmas in [405b6d5f90dfb36](https://github.com/sophgo/linux-riscv/commit/405b6d5f90dfb36) at 2024-12-14 19:03:12)
    > commit f5807b0606da7ac7c1b74a386b22134ec7702d05 upstream.
    > Due to an unsigned cast, adjtimex() returns the wrong offest when using
    > ADJ_MICRO and the offset is negative. In this case a small negative offset
    > returns approximately 4.29 seconds (~ 2^32/1000 milliseconds) due to the
    > unsigned cast of the negative offset.
    > This cast was added when the kernel internal struct timex was changed to
    > use type long long for the time offset value to address the problem of a
    > 64bit/32bit division on 32bit systems.
    > The correct cast would have been (s32), which is correct as time_offset can
    > only be in the range of [INT_MIN..INT_MAX] because the shift constant used
    > for calculating it is 32. But that&#x27;s non-obvious.
    > Remove the cast and use div_s64() to cure the issue.
    > [ tglx: Fix white space damage, use div_s64() and amend the change log ]
    > Fixes: ead25417f82e (&quot;timex: use __kernel_timex internally&quot;)
    > Signed-off-by: Marcelo Dalmas &lt;marcelo.dalmas@ge.com&gt;
    > Signed-off-by: Thomas Gleixner &lt;tglx@linutronix.de&gt;
    > Cc: stable@vger.kernel.org
    > Link: https://lore.kernel.org/all/SJ0P101MB03687BF7D5A10FD3C49C51E5F42E2@SJ0P101MB0368.NAMP101.PROD.OUTLOOK.COM
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ mmc: mtk-sd: Fix MMC_CAP2_CRYPTO flag setting (@Andy-ld Lu in [f42e0656d483d74](https://github.com/sophgo/linux-riscv/commit/f42e0656d483d74) at 2024-12-14 19:03:11)
    > [ Upstream commit 2508925fb346661bad9f50b497d7ac7d0b6085d0 ]
    > Currently, the MMC_CAP2_CRYPTO flag is set by default for eMMC hosts.
    > However, this flag should not be set for hosts that do not support inline
    > encryption.
    > The &#x27;crypto&#x27; clock, as described in the documentation, is used for data
    > encryption and decryption. Therefore, only hosts that are configured with
    > this &#x27;crypto&#x27; clock should have the MMC_CAP2_CRYPTO flag set.
    > Fixes: 7b438d0377fb (&quot;mmc: mtk-sd: add Inline Crypto Engine clock control&quot;)
    > Fixes: ed299eda8fbb (&quot;mmc: mtk-sd: fix devm_clk_get_optional usage&quot;)
    > Signed-off-by: Andy-ld Lu &lt;andy-ld.lu@mediatek.com&gt;
    > Cc: stable@vger.kernel.org
    > Message-ID: &lt;20241111085039.26527-1-andy-ld.lu@mediatek.com&gt;
    > Signed-off-by: Ulf Hansson &lt;ulf.hansson@linaro.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ mmc: sd: SDUC Support Recognition (@Avri Altman in [c00372e41bf658d](https://github.com/sophgo/linux-riscv/commit/c00372e41bf658d) at 2024-12-14 19:03:11)
    > [ Upstream commit fce2ce78af1e14dc1316aaddb5b3308be05cf452 ]
    > Ultra Capacity SD cards (SDUC) was already introduced in SD7.0.  Those
    > cards support capacity larger than 2TB and up to including 128TB.
    > ACMD41 was extended to support the host-card handshake during
    > initialization.  The card expects that the HCS &amp; HO2T bits to be set in
    > the command argument, and sets the applicable bits in the R3 returned
    > response.  On the contrary, if a SDUC card is inserted to a
    > non-supporting host, it will never respond to this ACMD41 until
    > eventually, the host will timed out and give up.
    > Also, add SD CSD version 3.0 - designated for SDUC, and properly parse
    > the csd register as the c_size field got expanded to 28 bits.
    > Do not enable SDUC for now - leave it to the last patch in the series.
    > Tested-by: Ricky WU &lt;ricky_wu@realtek.com&gt;
    > Reviewed-by: Adrian Hunter &lt;adrian.hunter@intel.com&gt;
    > Signed-off-by: Avri Altman &lt;avri.altman@wdc.com&gt;
    > Link: https://lore.kernel.org/r/20241006051148.160278-2-avri.altman@wdc.com
    > Signed-off-by: Ulf Hansson &lt;ulf.hansson@linaro.org&gt;
    > Stable-dep-of: 869d37475788 (&quot;mmc: core: Use GFP_NOIO in ACMD22&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ zram: do not mark idle slots that cannot be idle (@Sergey Senozhatsky in [4e51552bc5d8e97](https://github.com/sophgo/linux-riscv/commit/4e51552bc5d8e97) at 2024-12-14 19:03:11)
    > [ Upstream commit b967fa1ba72b5da2b6d9bf95f0b13420a59e0701 ]
    > ZRAM_SAME slots cannot be post-processed (writeback or recompress) so do
    > not mark them ZRAM_IDLE.  Same with ZRAM_WB slots, they cannot be
    > ZRAM_IDLE because they are not in zsmalloc pool anymore.
    > Link: https://lkml.kernel.org/r/20240917021020.883356-6-senozhatsky@chromium.org
    > Signed-off-by: Sergey Senozhatsky &lt;senozhatsky@chromium.org&gt;
    > Cc: Minchan Kim &lt;minchan@kernel.org&gt;
    > Signed-off-by: Andrew Morton &lt;akpm@linux-foundation.org&gt;
    > Stable-dep-of: d37da422edb0 (&quot;zram: clear IDLE flag in mark_idle()&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ mmc: core: Use GFP_NOIO in ACMD22 (@Avri Altman in [42311846d3580f4](https://github.com/sophgo/linux-riscv/commit/42311846d3580f4) at 2024-12-14 19:03:11)
    > [ Upstream commit 869d37475788b0044bec1a33335e24abaf5e8884 ]
    > While reviewing the SDUC series, Adrian made a comment concerning the
    > memory allocation code in mmc_sd_num_wr_blocks() - see [1].
    > Prevent memory allocations from triggering I/O operations while ACMD22
    > is in progress.
    > [1] https://lore.kernel.org/linux-mmc/3016fd71-885b-4ef9-97ed-46b4b0cb0e35@intel.com/
    > Suggested-by: Adrian Hunter &lt;adrian.hunter@intel.com&gt;
    > Reviewed-by: Adrian Hunter &lt;adrian.hunter@intel.com&gt;
    > Fixes: 051913dada04 (&quot;mmc_block: do not DMA to stack&quot;)
    > Signed-off-by: Avri Altman &lt;avri.altman@wdc.com&gt;
    > Cc: stable@vger.kernel.org
    > Message-ID: &lt;20241021153227.493970-1-avri.altman@wdc.com&gt;
    > Signed-off-by: Ulf Hansson &lt;ulf.hansson@linaro.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ mmc: core: Adjust ACMD22 to SDUC (@Avri Altman in [19e22f1e68c76ad](https://github.com/sophgo/linux-riscv/commit/19e22f1e68c76ad) at 2024-12-14 19:03:11)
    > [ Upstream commit 449f34a34088d02457fa0f3216747e8a35bc03ae ]
    > ACMD22 is used to verify the previously write operation.  Normally, it
    > returns the number of written sectors as u32.  SDUC, however, returns it
    > as u64.  This is not a superfluous requirement, because SDUC writes may
    > exceeds 2TB.  For Linux mmc however, the previously write operation
    > could not be more than the block layer limits, thus we make room for a
    > u64 and cast the returning value to u32.
    > Reviewed-by: Adrian Hunter &lt;adrian.hunter@intel.com&gt;
    > Signed-off-by: Avri Altman &lt;avri.altman@wdc.com&gt;
    > Link: https://lore.kernel.org/r/20241006051148.160278-8-avri.altman@wdc.com
    > Signed-off-by: Ulf Hansson &lt;ulf.hansson@linaro.org&gt;
    > [Stephen Rothwell: Fix build error when moving to new rc from Linus&#x27;s tree]
    > Signed-off-by: Stephen Rothwell &lt;sfr@canb.auug.org.au&gt;
    > Stable-dep-of: 869d37475788 (&quot;mmc: core: Use GFP_NOIO in ACMD22&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ zram: clear IDLE flag in mark_idle() (@Sergey Senozhatsky in [0ab037634ba53f3](https://github.com/sophgo/linux-riscv/commit/0ab037634ba53f3) at 2024-12-14 19:03:11)
    > [ Upstream commit d37da422edb0664a2037e6d7d42fe6d339aae78a ]
    > If entry does not fulfill current mark_idle() parameters, e.g.  cutoff
    > time, then we should clear its ZRAM_IDLE from previous mark_idle()
    > invocations.
    > Consider the following case:
    > - mark_idle() cutoff time 8h
    > - mark_idle() cutoff time 4h
    > - writeback() idle - will writeback entries with cutoff time 8h,
    > while it should only pick entries with cutoff time 4h
    > The bug was reported by Shin Kawamura.
    > Link: https://lkml.kernel.org/r/20241028153629.1479791-3-senozhatsky@chromium.org
    > Fixes: 755804d16965 (&quot;zram: introduce an aged idle interface&quot;)
    > Signed-off-by: Sergey Senozhatsky &lt;senozhatsky@chromium.org&gt;
    > Reported-by: Shin Kawamura &lt;kawasin@google.com&gt;
    > Acked-by: Brian Geffon &lt;bgeffon@google.com&gt;
    > Cc: Minchan Kim &lt;minchan@kernel.org&gt;
    > Signed-off-by: Andrew Morton &lt;akpm@linux-foundation.org&gt;
    > Cc: &lt;stable@vger.kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ mmc: mtk-sd: fix devm_clk_get_optional usage (@Rosen Penev in [eac322ed9378f6b](https://github.com/sophgo/linux-riscv/commit/eac322ed9378f6b) at 2024-12-14 19:03:10)
    > [ Upstream commit ed299eda8fbb37cb0e05c7001ab6a6b2627ec087 ]
    > This already returns NULL when not found. However, it can return
    > EPROBE_DEFER and should thus return here.
    > Signed-off-by: Rosen Penev &lt;rosenp@gmail.com&gt;
    > Link: https://lore.kernel.org/r/20240930224919.355359-4-rosenp@gmail.com
    > Signed-off-by: Ulf Hansson &lt;ulf.hansson@linaro.org&gt;
    > Stable-dep-of: 2508925fb346 (&quot;mmc: mtk-sd: Fix MMC_CAP2_CRYPTO flag setting&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ gpio: grgpio: Add NULL check in grgpio_probe (@Charles Han in [db2fc255fcf41f5](https://github.com/sophgo/linux-riscv/commit/db2fc255fcf41f5) at 2024-12-14 19:03:10)
    > [ Upstream commit 050b23d081da0f29474de043e9538c1f7a351b3b ]
    > devm_kasprintf() can return a NULL pointer on failure,but this
    > returned value in grgpio_probe is not checked.
    > Add NULL check in grgpio_probe, to handle kernel NULL
    > pointer dereference error.
    > Cc: stable@vger.kernel.org
    > Fixes: 7eb6ce2f2723 (&quot;gpio: Convert to using %pOF instead of full_name&quot;)
    > Signed-off-by: Charles Han &lt;hanchunchao@inspur.com&gt;
    > Link: https://lore.kernel.org/r/20241114091822.78199-1-hanchunchao@inspur.com
    > Signed-off-by: Bartosz Golaszewski &lt;bartosz.golaszewski@linaro.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ mmc: mtk-sd: use devm_mmc_alloc_host (@Rosen Penev in [acb8edf2ec34b84](https://github.com/sophgo/linux-riscv/commit/acb8edf2ec34b84) at 2024-12-14 19:03:10)
    > [ Upstream commit 7a2fa8eed936b33b22e49b1d2349cd7d02f22710 ]
    > Allows removing several gotos.
    > Also fixed some wrong ones.
    > Added dev_err_probe where EPROBE_DEFER is possible.
    > Signed-off-by: Rosen Penev &lt;rosenp@gmail.com&gt;
    > Link: https://lore.kernel.org/r/20240930224919.355359-2-rosenp@gmail.com
    > Signed-off-by: Ulf Hansson &lt;ulf.hansson@linaro.org&gt;
    > Stable-dep-of: 291220451c77 (&quot;mmc: mtk-sd: Fix error handle of probe function&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ mmc: mtk-sd: Fix error handle of probe function (@Andy-ld Lu in [95b6c851fb9945f](https://github.com/sophgo/linux-riscv/commit/95b6c851fb9945f) at 2024-12-14 19:03:10)
    > [ Upstream commit 291220451c775a054cedc4fab4578a1419eb6256 ]
    > In the probe function, it goes to &#x27;release_mem&#x27; label and returns after
    > some procedure failure. But if the clocks (partial or all) have been
    > enabled previously, they would not be disabled in msdc_runtime_suspend,
    > since runtime PM is not yet enabled for this case.
    > That cause mmc related clocks always on during system suspend and block
    > suspend flow. Below log is from a SDCard issue of MT8196 chromebook, it
    > returns -ETIMEOUT while polling clock stable in the msdc_ungate_clock()
    > and probe failed, but the enabled clocks could not be disabled anyway.
    > [  129.059253] clk_chk_dev_pm_suspend()
    > [  129.350119] suspend warning: msdcpll is on
    > [  129.354494] [ck_msdc30_1_sel : enabled, 1, 1, 191999939,   ck_msdcpll_d2]
    > [  129.362787] [ck_msdcpll_d2   : enabled, 1, 1, 191999939,         msdcpll]
    > [  129.371041] [ck_msdc30_1_ck  : enabled, 1, 1, 191999939, ck_msdc30_1_sel]
    > [  129.379295] [msdcpll         : enabled, 1, 1, 383999878,          clk26m]
    > Add a new &#x27;release_clk&#x27; label and reorder the error handle functions to
    > make sure the clocks be disabled after probe failure.
    > Fixes: ffaea6ebfe9c (&quot;mmc: mtk-sd: Use readl_poll_timeout instead of open-coded polling&quot;)
    > Fixes: 7a2fa8eed936 (&quot;mmc: mtk-sd: use devm_mmc_alloc_host&quot;)
    > Signed-off-by: Andy-ld Lu &lt;andy-ld.lu@mediatek.com&gt;
    > Reviewed-by: AngeloGioacchino Del Regno &lt;angelogioacchino.delregno@collabora.com&gt;
    > Cc: stable@vger.kernel.org
    > Message-ID: &lt;20241107121215.5201-1-andy-ld.lu@mediatek.com&gt;
    > Signed-off-by: Ulf Hansson &lt;ulf.hansson@linaro.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ gpio: grgpio: use a helper variable to store the address of ofdev-&gt;dev (@Bartosz Golaszewski in [8b287418b52951a](https://github.com/sophgo/linux-riscv/commit/8b287418b52951a) at 2024-12-14 19:03:10)
    > [ Upstream commit d036ae41cebdfae92666024163c109b8fef516fa ]
    > Instead of dereferencing the platform device pointer repeatedly, just
    > store its address in a helper variable.
    > Link: https://lore.kernel.org/r/20241015131832.44678-3-brgl@bgdev.pl
    > Signed-off-by: Bartosz Golaszewski &lt;bartosz.golaszewski@linaro.org&gt;
    > Stable-dep-of: 050b23d081da (&quot;gpio: grgpio: Add NULL check in grgpio_probe&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ net: avoid potential UAF in default_operstate() (@Eric Dumazet in [316183d58319f19](https://github.com/sophgo/linux-riscv/commit/316183d58319f19) at 2024-12-14 19:03:10)
    > [ Upstream commit 750e51603395e755537da08f745864c93e3ce741 ]
    > syzbot reported an UAF in default_operstate() [1]
    > Issue is a race between device and netns dismantles.
    > After calling __rtnl_unlock() from netdev_run_todo(),
    > we can not assume the netns of each device is still alive.
    > Make sure the device is not in NETREG_UNREGISTERED state,
    > and add an ASSERT_RTNL() before the call to
    > __dev_get_by_index().
    > We might move this ASSERT_RTNL() in __dev_get_by_index()
    > in the future.
    > [1]
    > BUG: KASAN: slab-use-after-free in __dev_get_by_index+0x5d/0x110 net/core/dev.c:852
    > Read of size 8 at addr ffff888043eba1b0 by task syz.0.0/5339
    > CPU: 0 UID: 0 PID: 5339 Comm: syz.0.0 Not tainted 6.12.0-syzkaller-10296-gaaf20f870da0 #0
    > Hardware name: QEMU Standard PC (Q35 + ICH9, 2009), BIOS 1.16.3-debian-1.16.3-2~bpo12+1 04/01/2014
    > Call Trace:
    > &lt;TASK&gt;
    > __dump_stack lib/dump_stack.c:94 [inline]
    > dump_stack_lvl+0x241/0x360 lib/dump_stack.c:120
    > print_address_description mm/kasan/report.c:378 [inline]
    > print_report+0x169/0x550 mm/kasan/report.c:489
    > kasan_report+0x143/0x180 mm/kasan/report.c:602
    > __dev_get_by_index+0x5d/0x110 net/core/dev.c:852
    > default_operstate net/core/link_watch.c:51 [inline]
    > rfc2863_policy+0x224/0x300 net/core/link_watch.c:67
    > linkwatch_do_dev+0x3e/0x170 net/core/link_watch.c:170
    > netdev_run_todo+0x461/0x1000 net/core/dev.c:10894
    > rtnl_unlock net/core/rtnetlink.c:152 [inline]
    > rtnl_net_unlock include/linux/rtnetlink.h:133 [inline]
    > rtnl_dellink+0x760/0x8d0 net/core/rtnetlink.c:3520
    > rtnetlink_rcv_msg+0x791/0xcf0 net/core/rtnetlink.c:6911
    > netlink_rcv_skb+0x1e3/0x430 net/netlink/af_netlink.c:2541
    > netlink_unicast_kernel net/netlink/af_netlink.c:1321 [inline]
    > netlink_unicast+0x7f6/0x990 net/netlink/af_netlink.c:1347
    > netlink_sendmsg+0x8e4/0xcb0 net/netlink/af_netlink.c:1891
    > sock_sendmsg_nosec net/socket.c:711 [inline]
    > __sock_sendmsg+0x221/0x270 net/socket.c:726
    > ____sys_sendmsg+0x52a/0x7e0 net/socket.c:2583
    > ___sys_sendmsg net/socket.c:2637 [inline]
    > __sys_sendmsg+0x269/0x350 net/socket.c:2669
    > do_syscall_x64 arch/x86/entry/common.c:52 [inline]
    > do_syscall_64+0xf3/0x230 arch/x86/entry/common.c:83
    > entry_SYSCALL_64_after_hwframe+0x77/0x7f
    > RIP: 0033:0x7f2a3cb80809
    > Code: ff ff c3 66 2e 0f 1f 84 00 00 00 00 00 0f 1f 40 00 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 &lt;48&gt; 3d 01 f0 ff ff 73 01 c3 48 c7 c1 a8 ff ff ff f7 d8 64 89 01 48
    > RSP: 002b:00007f2a3d9cd058 EFLAGS: 00000246 ORIG_RAX: 000000000000002e
    > RAX: ffffffffffffffda RBX: 00007f2a3cd45fa0 RCX: 00007f2a3cb80809
    > RDX: 0000000000000000 RSI: 0000000020000000 RDI: 0000000000000008
    > RBP: 00007f2a3cbf393e R08: 0000000000000000 R09: 0000000000000000
    > R10: 0000000000000000 R11: 0000000000000246 R12: 0000000000000000
    > R13: 0000000000000000 R14: 00007f2a3cd45fa0 R15: 00007ffd03bc65c8
    > &lt;/TASK&gt;
    > Allocated by task 5339:
    > kasan_save_stack mm/kasan/common.c:47 [inline]
    > kasan_save_track+0x3f/0x80 mm/kasan/common.c:68
    > poison_kmalloc_redzone mm/kasan/common.c:377 [inline]
    > __kasan_kmalloc+0x98/0xb0 mm/kasan/common.c:394
    > kasan_kmalloc include/linux/kasan.h:260 [inline]
    > __kmalloc_cache_noprof+0x243/0x390 mm/slub.c:4314
    > kmalloc_noprof include/linux/slab.h:901 [inline]
    > kmalloc_array_noprof include/linux/slab.h:945 [inline]
    > netdev_create_hash net/core/dev.c:11870 [inline]
    > netdev_init+0x10c/0x250 net/core/dev.c:11890
    > ops_init+0x31e/0x590 net/core/net_namespace.c:138
    > setup_net+0x287/0x9e0 net/core/net_namespace.c:362
    > copy_net_ns+0x33f/0x570 net/core/net_namespace.c:500
    > create_new_namespaces+0x425/0x7b0 kernel/nsproxy.c:110
    > unshare_nsproxy_namespaces+0x124/0x180 kernel/nsproxy.c:228
    > ksys_unshare+0x57d/0xa70 kernel/fork.c:3314
    > __do_sys_unshare kernel/fork.c:3385 [inline]
    > __se_sys_unshare kernel/fork.c:3383 [inline]
    > __x64_sys_unshare+0x38/0x40 kernel/fork.c:3383
    > do_syscall_x64 arch/x86/entry/common.c:52 [inline]
    > do_syscall_64+0xf3/0x230 arch/x86/entry/common.c:83
    > entry_SYSCALL_64_after_hwframe+0x77/0x7f
    > Freed by task 12:
    > kasan_save_stack mm/kasan/common.c:47 [inline]
    > kasan_save_track+0x3f/0x80 mm/kasan/common.c:68
    > kasan_save_free_info+0x40/0x50 mm/kasan/generic.c:582
    > poison_slab_object mm/kasan/common.c:247 [inline]
    > __kasan_slab_free+0x59/0x70 mm/kasan/common.c:264
    > kasan_slab_free include/linux/kasan.h:233 [inline]
    > slab_free_hook mm/slub.c:2338 [inline]
    > slab_free mm/slub.c:4598 [inline]
    > kfree+0x196/0x420 mm/slub.c:4746
    > netdev_exit+0x65/0xd0 net/core/dev.c:11992
    > ops_exit_list net/core/net_namespace.c:172 [inline]
    > cleanup_net+0x802/0xcc0 net/core/net_namespace.c:632
    > process_one_work kernel/workqueue.c:3229 [inline]
    > process_scheduled_works+0xa63/0x1850 kernel/workqueue.c:3310
    > worker_thread+0x870/0xd30 kernel/workqueue.c:3391
    > kthread+0x2f0/0x390 kernel/kthread.c:389
    > ret_from_fork+0x4b/0x80 arch/x86/kernel/process.c:147
    > ret_from_fork_asm+0x1a/0x30 arch/x86/entry/entry_64.S:244
    > The buggy address belongs to the object at ffff888043eba000
    > which belongs to the cache kmalloc-2k of size 2048
    > The buggy address is located 432 bytes inside of
    > freed 2048-byte region [ffff888043eba000, ffff888043eba800)
    > The buggy address belongs to the physical page:
    > page: refcount:1 mapcount:0 mapping:0000000000000000 index:0x0 pfn:0x43eb8
    > head: order:3 mapcount:0 entire_mapcount:0 nr_pages_mapped:0 pincount:0
    > flags: 0x4fff00000000040(head|node&#x3D;1|zone&#x3D;1|lastcpupid&#x3D;0x7ff)
    > page_type: f5(slab)
    > raw: 04fff00000000040 ffff88801ac42000 dead000000000122 0000000000000000
    > raw: 0000000000000000 0000000000080008 00000001f5000000 0000000000000000
    > head: 04fff00000000040 ffff88801ac42000 dead000000000122 0000000000000000
    > head: 0000000000000000 0000000000080008 00000001f5000000 0000000000000000
    > head: 04fff00000000003 ffffea00010fae01 ffffffffffffffff 0000000000000000
    > head: 0000000000000008 0000000000000000 00000000ffffffff 0000000000000000
    > page dumped because: kasan: bad access detected
    > page_owner tracks the page as allocated
    > page last allocated via order 3, migratetype Unmovable, gfp_mask 0xd20c0(__GFP_IO|__GFP_FS|__GFP_NOWARN|__GFP_NORETRY|__GFP_COMP|__GFP_NOMEMALLOC), pid 5339, tgid 5338 (syz.0.0), ts 69674195892, free_ts 69663220888
    > set_page_owner include/linux/page_owner.h:32 [inline]
    > post_alloc_hook+0x1f3/0x230 mm/page_alloc.c:1556
    > prep_new_page mm/page_alloc.c:1564 [inline]
    > get_page_from_freelist+0x3649/0x3790 mm/page_alloc.c:3474
    > __alloc_pages_noprof+0x292/0x710 mm/page_alloc.c:4751
    > alloc_pages_mpol_noprof+0x3e8/0x680 mm/mempolicy.c:2265
    > alloc_slab_page+0x6a/0x140 mm/slub.c:2408
    > allocate_slab+0x5a/0x2f0 mm/slub.c:2574
    > new_slab mm/slub.c:2627 [inline]
    > ___slab_alloc+0xcd1/0x14b0 mm/slub.c:3815
    > __slab_alloc+0x58/0xa0 mm/slub.c:3905
    > __slab_alloc_node mm/slub.c:3980 [inline]
    > slab_alloc_node mm/slub.c:4141 [inline]
    > __do_kmalloc_node mm/slub.c:4282 [inline]
    > __kmalloc_noprof+0x2e6/0x4c0 mm/slub.c:4295
    > kmalloc_noprof include/linux/slab.h:905 [inline]
    > sk_prot_alloc+0xe0/0x210 net/core/sock.c:2165
    > sk_alloc+0x38/0x370 net/core/sock.c:2218
    > __netlink_create+0x65/0x260 net/netlink/af_netlink.c:629
    > __netlink_kernel_create+0x174/0x6f0 net/netlink/af_netlink.c:2015
    > netlink_kernel_create include/linux/netlink.h:62 [inline]
    > uevent_net_init+0xed/0x2d0 lib/kobject_uevent.c:783
    > ops_init+0x31e/0x590 net/core/net_namespace.c:138
    > setup_net+0x287/0x9e0 net/core/net_namespace.c:362
    > page last free pid 1032 tgid 1032 stack trace:
    > reset_page_owner include/linux/page_owner.h:25 [inline]
    > free_pages_prepare mm/page_alloc.c:1127 [inline]
    > free_unref_page+0xdf9/0x1140 mm/page_alloc.c:2657
    > __slab_free+0x31b/0x3d0 mm/slub.c:4509
    > qlink_free mm/kasan/quarantine.c:163 [inline]
    > qlist_free_all+0x9a/0x140 mm/kasan/quarantine.c:179
    > kasan_quarantine_reduce+0x14f/0x170 mm/kasan/quarantine.c:286
    > __kasan_slab_alloc+0x23/0x80 mm/kasan/common.c:329
    > kasan_slab_alloc include/linux/kasan.h:250 [inline]
    > slab_post_alloc_hook mm/slub.c:4104 [inline]
    > slab_alloc_node mm/slub.c:4153 [inline]
    > kmem_cache_alloc_node_noprof+0x1d9/0x380 mm/slub.c:4205
    > __alloc_skb+0x1c3/0x440 net/core/skbuff.c:668
    > alloc_skb include/linux/skbuff.h:1323 [inline]
    > alloc_skb_with_frags+0xc3/0x820 net/core/skbuff.c:6612
    > sock_alloc_send_pskb+0x91a/0xa60 net/core/sock.c:2881
    > sock_alloc_send_skb include/net/sock.h:1797 [inline]
    > mld_newpack+0x1c3/0xaf0 net/ipv6/mcast.c:1747
    > add_grhead net/ipv6/mcast.c:1850 [inline]
    > add_grec+0x1492/0x19a0 net/ipv6/mcast.c:1988
    > mld_send_initial_cr+0x228/0x4b0 net/ipv6/mcast.c:2234
    > ipv6_mc_dad_complete+0x88/0x490 net/ipv6/mcast.c:2245
    > addrconf_dad_completed+0x712/0xcd0 net/ipv6/addrconf.c:4342
    > addrconf_dad_work+0xdc2/0x16f0
    > process_one_work kernel/workqueue.c:3229 [inline]
    > process_scheduled_works+0xa63/0x1850 kernel/workqueue.c:3310
    > Memory state around the buggy address:
    > ffff888043eba080: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
    > ffff888043eba100: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
    > &gt;ffff888043eba180: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
    > ^
    > ffff888043eba200: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
    > ffff888043eba280: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
    > Fixes: 8c55facecd7a (&quot;net: linkwatch: only report IF_OPER_LOWERLAYERDOWN if iflink is actually down&quot;)
    > Reported-by: syzbot+1939f24bdb783e9e43d9@syzkaller.appspotmail.com
    > Closes: https://lore.kernel.org/netdev/674f3a18.050a0220.48a03.0041.GAE@google.com/T/#u
    > Signed-off-by: Eric Dumazet &lt;edumazet@google.com&gt;
    > Reviewed-by: Vladimir Oltean &lt;vladimir.oltean@nxp.com&gt;
    > Link: https://patch.msgid.link/20241203170933.2449307-1-edumazet@google.com
    > Signed-off-by: Paolo Abeni &lt;pabeni@redhat.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ vsock/test: fix failures due to wrong SO_RCVLOWAT parameter (@Konstantin Shkolnyy in [b24737a85e182ea](https://github.com/sophgo/linux-riscv/commit/b24737a85e182ea) at 2024-12-14 19:03:09)
    > [ Upstream commit 7ce1c0921a806ee7d4bb24f74a3b30c89fc5fb39 ]
    > This happens on 64-bit big-endian machines.
    > SO_RCVLOWAT requires an int parameter. However, instead of int, the test
    > uses unsigned long in one place and size_t in another. Both are 8 bytes
    > long on 64-bit machines. The kernel, having received the 8 bytes, doesn&#x27;t
    > test for the exact size of the parameter, it only cares that it&#x27;s &gt;&#x3D;
    > sizeof(int), and casts the 4 lower-addressed bytes to an int, which, on
    > a big-endian machine, contains 0. 0 doesn&#x27;t trigger an error, SO_RCVLOWAT
    > returns with success and the socket stays with the default SO_RCVLOWAT &#x3D; 1,
    > which results in vsock_test failures, while vsock_perf doesn&#x27;t even notice
    > that it&#x27;s failed to change it.
    > Fixes: b1346338fbae (&quot;vsock_test: POLLIN + SO_RCVLOWAT test&quot;)
    > Fixes: 542e893fbadc (&quot;vsock/test: two tests to check credit update logic&quot;)
    > Fixes: 8abbffd27ced (&quot;test/vsock: vsock_perf utility&quot;)
    > Signed-off-by: Konstantin Shkolnyy &lt;kshk@linux.ibm.com&gt;
    > Reviewed-by: Stefano Garzarella &lt;sgarzare@redhat.com&gt;
    > Signed-off-by: Paolo Abeni &lt;pabeni@redhat.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ net/mlx5: HWS: Properly set bwc queue locks lock classes (@Cosmin Ratiu in [9ede83d29267462](https://github.com/sophgo/linux-riscv/commit/9ede83d29267462) at 2024-12-14 19:03:09)
    > [ Upstream commit 10e0f0c018d5ce5ba4f349875c67f99c3253b5c3 ]
    > The mentioned &quot;Fixes&quot; patch forgot to do that.
    > Fixes: 9addffa34359 (&quot;net/mlx5: HWS, use lock classes for bwc locks&quot;)
    > Signed-off-by: Cosmin Ratiu &lt;cratiu@nvidia.com&gt;
    > Reviewed-by: Yevgeny Kliteynik &lt;kliteyn@nvidia.com&gt;
    > Signed-off-by: Tariq Toukan &lt;tariqt@nvidia.com&gt;
    > Link: https://patch.msgid.link/20241203204920.232744-3-tariqt@nvidia.com
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ vsock/test: fix parameter types in SO_VM_SOCKETS_* calls (@Konstantin Shkolnyy in [876113e99ae15ae](https://github.com/sophgo/linux-riscv/commit/876113e99ae15ae) at 2024-12-14 19:03:09)
    > [ Upstream commit 3f36ee29e732b68044d531f47d31f22d265954c6 ]
    > Change parameters of SO_VM_SOCKETS_* to unsigned long long as documented
    > in the vm_sockets.h, because the corresponding kernel code requires them
    > to be at least 64-bit, no matter what architecture. Otherwise they are
    > too small on 32-bit machines.
    > Fixes: 5c338112e48a (&quot;test/vsock: rework message bounds test&quot;)
    > Fixes: 685a21c314a8 (&quot;test/vsock: add big message test&quot;)
    > Fixes: 542e893fbadc (&quot;vsock/test: two tests to check credit update logic&quot;)
    > Fixes: 8abbffd27ced (&quot;test/vsock: vsock_perf utility&quot;)
    > Signed-off-by: Konstantin Shkolnyy &lt;kshk@linux.ibm.com&gt;
    > Reviewed-by: Stefano Garzarella &lt;sgarzare@redhat.com&gt;
    > Signed-off-by: Paolo Abeni &lt;pabeni@redhat.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ net/mlx5e: SD, Use correct mdev to build channel param (@Tariq Toukan in [83ca241410e2d54](https://github.com/sophgo/linux-riscv/commit/83ca241410e2d54) at 2024-12-14 19:03:09)
    > [ Upstream commit 31f114c3d158dacbeda33f2afb0ca41f4ec6c9f9 ]
    > In a multi-PF netdev, each traffic channel creates its own resources
    > against a specific PF.
    > In the cited commit, where this support was added, the channel_param
    > logic was mistakenly kept unchanged, so it always used the primary PF
    > which is found at priv-&gt;mdev.
    > In this patch we fix this by moving the logic to be per-channel, and
    > passing the correct mdev instance.
    > This bug happened to be usually harmless, as the resulting cparam
    > structures would be the same for all channels, due to identical FW logic
    > and decisions.
    > However, in some use cases, like fwreset, this gets broken.
    > This could lead to different symptoms. Example:
    > Error cqe on cqn 0x428, ci 0x0, qn 0x10a9, opcode 0xe, syndrome 0x4,
    > vendor syndrome 0x32
    > Fixes: e4f9686bdee7 (&quot;net/mlx5e: Let channels be SD-aware&quot;)
    > Signed-off-by: Tariq Toukan &lt;tariqt@nvidia.com&gt;
    > Reviewed-by: Lama Kayal &lt;lkayal@nvidia.com&gt;
    > Reviewed-by: Gal Pressman &lt;gal@nvidia.com&gt;
    > Link: https://patch.msgid.link/20241203204920.232744-6-tariqt@nvidia.com
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ net/mlx5e: Remove workaround to avoid syndrome for internal port (@Jianbo Liu in [3591bc9067185c7](https://github.com/sophgo/linux-riscv/commit/3591bc9067185c7) at 2024-12-14 19:03:09)
    > [ Upstream commit 5085f861b414e4a51ce28a891dfa32a10a54b64e ]
    > Previously a workaround was added to avoid syndrome 0xcdb051. It is
    > triggered when offload a rule with tunnel encapsulation, and
    > forwarding to another table, but not matching on the internal port in
    > firmware steering mode. The original workaround skips internal tunnel
    > port logic, which is not correct as not all cases are considered. As
    > an example, if vlan is configured on the uplink port, traffic can&#x27;t
    > pass because vlan header is not added with this workaround. Besides,
    > there is no such issue for software steering. So, this patch removes
    > that, and returns error directly if trying to offload such rule for
    > firmware steering.
    > Fixes: 06b4eac9c4be (&quot;net/mlx5e: Don&#x27;t offload internal port if filter device is out device&quot;)
    > Signed-off-by: Jianbo Liu &lt;jianbol@nvidia.com&gt;
    > Tested-by: Frode Nordahl &lt;frode.nordahl@canonical.com&gt;
    > Reviewed-by: Chris Mi &lt;cmi@nvidia.com&gt;
    > Reviewed-by: Ariel Levkovich &lt;lariel@nvidia.com&gt;
    > Signed-off-by: Tariq Toukan &lt;tariqt@nvidia.com&gt;
    > Link: https://patch.msgid.link/20241203204920.232744-7-tariqt@nvidia.com
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ net/mlx5: HWS: Fix memory leak in mlx5hws_definer_calc_layout (@Cosmin Ratiu in [1af1342724bdeda](https://github.com/sophgo/linux-riscv/commit/1af1342724bdeda) at 2024-12-14 19:03:09)
    > [ Upstream commit 530b69a26952c95ffc9e6dcd1cff6f249032780a ]
    > It allocates a match template, which creates a compressed definer fc
    > struct, but that is not deallocated.
    > This commit fixes that.
    > Fixes: 74a778b4a63f (&quot;net/mlx5: HWS, added definers handling&quot;)
    > Signed-off-by: Cosmin Ratiu &lt;cratiu@nvidia.com&gt;
    > Reviewed-by: Yevgeny Kliteynik &lt;kliteyn@nvidia.com&gt;
    > Signed-off-by: Tariq Toukan &lt;tariqt@nvidia.com&gt;
    > Link: https://patch.msgid.link/20241203204920.232744-2-tariqt@nvidia.com
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ mlxsw: spectrum_acl_flex_keys: Constify struct mlxsw_afk_element_inst (@Christophe JAILLET in [cfa0f932774b27f](https://github.com/sophgo/linux-riscv/commit/cfa0f932774b27f) at 2024-12-14 19:03:08)
    > [ Upstream commit bec2a32145d5cc066df29182fa0e5b0d4329b1a1 ]
    > &#x27;struct mlxsw_afk_element_inst&#x27; are not modified in these drivers.
    > Constifying these structures moves some data to a read-only section, so
    > increases overall security.
    > Update a few functions and struct mlxsw_afk_block accordingly.
    > On a x86_64, with allmodconfig, as an example:
    > Before:
    > &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;
    > text	   data	    bss	    dec	    hex	filename
    > 4278	   4032	      0	   8310	   2076	drivers/net/ethernet/mellanox/mlxsw/spectrum_acl_flex_keys.o
    > After:
    > &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;
    > text	   data	    bss	    dec	    hex	filename
    > 7934	    352	      0	   8286	   205e	drivers/net/ethernet/mellanox/mlxsw/spectrum_acl_flex_keys.o
    > Signed-off-by: Christophe JAILLET &lt;christophe.jaillet@wanadoo.fr&gt;
    > Reviewed-by: Simon Horman &lt;horms@kernel.org&gt;
    > Reviewed-by: Ido Schimmel &lt;idosch@nvidia.com&gt;
    > Link: https://patch.msgid.link/8ccfc7bfb2365dcee5b03c81ebe061a927d6da2e.1727541677.git.christophe.jaillet@wanadoo.fr
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Stable-dep-of: 217bbf156f93 (&quot;mlxsw: spectrum_acl_flex_keys: Use correct key block on Spectrum-4&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ netfilter: nft_set_hash: skip duplicated elements pending gc run (@Pablo Neira Ayuso in [be4d0ac67d92e6a](https://github.com/sophgo/linux-riscv/commit/be4d0ac67d92e6a) at 2024-12-14 19:03:08)
    > [ Upstream commit 7ffc7481153bbabf3332c6a19b289730c7e1edf5 ]
    > rhashtable does not provide stable walk, duplicated elements are
    > possible in case of resizing. I considered that checking for errors when
    > calling rhashtable_walk_next() was sufficient to detect the resizing.
    > However, rhashtable_walk_next() returns -EAGAIN only at the end of the
    > iteration, which is too late, because a gc work containing duplicated
    > elements could have been already scheduled for removal to the worker.
    > Add a u32 gc worker sequence number per set, bump it on every workqueue
    > run. Annotate gc worker sequence number on the expired element. Use it
    > to skip those already seen in this gc workqueue run.
    > Note that this new field is never reset in case gc transaction fails, so
    > next gc worker run on the expired element overrides it. Wraparound of gc
    > worker sequence number should not be an issue with stale gc worker
    > sequence number in the element, that would just postpone the element
    > removal in one gc run.
    > Note that it is not possible to use flags to annotate that element is
    > pending gc run to detect duplicates, given that gc transaction can be
    > invalidated in case of update from the control plane, therefore, not
    > allowing to clear such flag.
    > On x86_64, pahole reports no changes in the size of nft_rhash_elem.
    > Fixes: f6c383b8c31a (&quot;netfilter: nf_tables: adapt set backend to use GC transaction API&quot;)
    > Reported-by: Laurent Fasnacht &lt;laurent.fasnacht@proton.ch&gt;
    > Tested-by: Laurent Fasnacht &lt;laurent.fasnacht@proton.ch&gt;
    > Signed-off-by: Pablo Neira Ayuso &lt;pablo@netfilter.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ netfilter: ipset: Hold module reference while requesting a module (@Phil Sutter in [ba5e070f36682d0](https://github.com/sophgo/linux-riscv/commit/ba5e070f36682d0) at 2024-12-14 19:03:08)
    > [ Upstream commit 456f010bfaefde84d3390c755eedb1b0a5857c3c ]
    > User space may unload ip_set.ko while it is itself requesting a set type
    > backend module, leading to a kernel crash. The race condition may be
    > provoked by inserting an mdelay() right after the nfnl_unlock() call.
    > Fixes: a7b4f989a629 (&quot;netfilter: ipset: IP set core support&quot;)
    > Signed-off-by: Phil Sutter &lt;phil@nwl.cc&gt;
    > Acked-by: Jozsef Kadlecsik &lt;kadlec@netfilter.org&gt;
    > Signed-off-by: Pablo Neira Ayuso &lt;pablo@netfilter.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ mlxsw: spectrum_acl_flex_keys: Use correct key block on Spectrum-4 (@Ido Schimmel in [68292db0d06944b](https://github.com/sophgo/linux-riscv/commit/68292db0d06944b) at 2024-12-14 19:03:08)
    > [ Upstream commit 217bbf156f93ada86b91617489e7ba8a0904233c ]
    > The driver is currently using an ACL key block that is not supported by
    > Spectrum-4. This works because the driver is only using a single field
    > from this key block which is located in the same offset in the
    > equivalent Spectrum-4 key block.
    > The issue was discovered when the firmware started rejecting the use of
    > the unsupported key block. The change has been reverted to avoid
    > breaking users that only update their firmware.
    > Nonetheless, fix the issue by using the correct key block.
    > Fixes: 07ff135958dd (&quot;mlxsw: Introduce flex key elements for Spectrum-4&quot;)
    > Signed-off-by: Ido Schimmel &lt;idosch@nvidia.com&gt;
    > Reviewed-by: Petr Machata &lt;petrm@nvidia.com&gt;
    > Signed-off-by: Petr Machata &lt;petrm@nvidia.com&gt;
    > Link: https://patch.msgid.link/35e72c97bdd3bc414fb8e4d747e5fb5d26c29658.1733237440.git.petrm@nvidia.com
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ethtool: Fix wrong mod state in case of verbose and no_mask bitset (@Kory Maincent in [22074dc1d4d3ea1](https://github.com/sophgo/linux-riscv/commit/22074dc1d4d3ea1) at 2024-12-14 19:03:08)
    > [ Upstream commit 910c4788d6155b2202ec88273376cd7ecdc24f0a ]
    > A bitset without mask in a _SET request means we want exactly the bits in
    > the bitset to be set. This works correctly for compact format but when
    > verbose format is parsed, ethnl_update_bitset32_verbose() only sets the
    > bits present in the request bitset but does not clear the rest. The commit
    > 6699170376ab (&quot;ethtool: fix application of verbose no_mask bitset&quot;) fixes
    > this issue by clearing the whole target bitmap before we start iterating.
    > The solution proposed brought an issue with the behavior of the mod
    > variable. As the bitset is always cleared the old value will always
    > differ to the new value.
    > Fix it by adding a new function to compare bitmaps and a temporary variable
    > which save the state of the old bitmap.
    > Fixes: 6699170376ab (&quot;ethtool: fix application of verbose no_mask bitset&quot;)
    > Signed-off-by: Kory Maincent &lt;kory.maincent@bootlin.com&gt;
    > Link: https://patch.msgid.link/20241202153358.1142095-1-kory.maincent@bootlin.com
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ geneve: do not assume mac header is set in geneve_xmit_skb() (@Eric Dumazet in [177b72ed7c77b11](https://github.com/sophgo/linux-riscv/commit/177b72ed7c77b11) at 2024-12-14 19:03:08)
    > [ Upstream commit 8588c99c7d47448fcae39e3227d6e2bb97aad86d ]
    > We should not assume mac header is set in output path.
    > Use skb_eth_hdr() instead of eth_hdr() to fix the issue.
    > sysbot reported the following :
    > WARNING: CPU: 0 PID: 11635 at include/linux/skbuff.h:3052 skb_mac_header include/linux/skbuff.h:3052 [inline]
    > WARNING: CPU: 0 PID: 11635 at include/linux/skbuff.h:3052 eth_hdr include/linux/if_ether.h:24 [inline]
    > WARNING: CPU: 0 PID: 11635 at include/linux/skbuff.h:3052 geneve_xmit_skb drivers/net/geneve.c:898 [inline]
    > WARNING: CPU: 0 PID: 11635 at include/linux/skbuff.h:3052 geneve_xmit+0x4c38/0x5730 drivers/net/geneve.c:1039
    > Modules linked in:
    > CPU: 0 UID: 0 PID: 11635 Comm: syz.4.1423 Not tainted 6.12.0-syzkaller-10296-gaaf20f870da0 #0
    > Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 09/13/2024
    > RIP: 0010:skb_mac_header include/linux/skbuff.h:3052 [inline]
    > RIP: 0010:eth_hdr include/linux/if_ether.h:24 [inline]
    > RIP: 0010:geneve_xmit_skb drivers/net/geneve.c:898 [inline]
    > RIP: 0010:geneve_xmit+0x4c38/0x5730 drivers/net/geneve.c:1039
    > Code: 21 c6 02 e9 35 d4 ff ff e8 a5 48 4c fb 90 0f 0b 90 e9 fd f5 ff ff e8 97 48 4c fb 90 0f 0b 90 e9 d8 f5 ff ff e8 89 48 4c fb 90 &lt;0f&gt; 0b 90 e9 41 e4 ff ff e8 7b 48 4c fb 90 0f 0b 90 e9 cd e7 ff ff
    > RSP: 0018:ffffc90003b2f870 EFLAGS: 00010283
    > RAX: 000000000000037a RBX: 000000000000ffff RCX: ffffc9000dc3d000
    > RDX: 0000000000080000 RSI: ffffffff86428417 RDI: 0000000000000003
    > RBP: ffffc90003b2f9f0 R08: 0000000000000003 R09: 000000000000ffff
    > R10: 000000000000ffff R11: 0000000000000002 R12: ffff88806603c000
    > R13: 0000000000000000 R14: ffff8880685b2780 R15: 0000000000000e23
    > FS:  00007fdc2deed6c0(0000) GS:ffff8880b8600000(0000) knlGS:0000000000000000
    > CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
    > CR2: 0000001b30a1dff8 CR3: 0000000056b8c000 CR4: 00000000003526f0
    > DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
    > DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
    > Call Trace:
    > &lt;TASK&gt;
    > __netdev_start_xmit include/linux/netdevice.h:5002 [inline]
    > netdev_start_xmit include/linux/netdevice.h:5011 [inline]
    > __dev_direct_xmit+0x58a/0x720 net/core/dev.c:4490
    > dev_direct_xmit include/linux/netdevice.h:3181 [inline]
    > packet_xmit+0x1e4/0x360 net/packet/af_packet.c:285
    > packet_snd net/packet/af_packet.c:3146 [inline]
    > packet_sendmsg+0x2700/0x5660 net/packet/af_packet.c:3178
    > sock_sendmsg_nosec net/socket.c:711 [inline]
    > __sock_sendmsg net/socket.c:726 [inline]
    > __sys_sendto+0x488/0x4f0 net/socket.c:2197
    > __do_sys_sendto net/socket.c:2204 [inline]
    > __se_sys_sendto net/socket.c:2200 [inline]
    > __x64_sys_sendto+0xe0/0x1c0 net/socket.c:2200
    > do_syscall_x64 arch/x86/entry/common.c:52 [inline]
    > do_syscall_64+0xcd/0x250 arch/x86/entry/common.c:83
    > entry_SYSCALL_64_after_hwframe+0x77/0x7f
    > Fixes: a025fb5f49ad (&quot;geneve: Allow configuration of DF behaviour&quot;)
    > Reported-by: syzbot+3ec5271486d7cb2d242a@syzkaller.appspotmail.com
    > Closes: https://lore.kernel.org/netdev/674f4b72.050a0220.17bd51.004a.GAE@google.com/T/#u
    > Signed-off-by: Eric Dumazet &lt;edumazet@google.com&gt;
    > Reviewed-by: Stefano Brivio &lt;sbrivio@redhat.com&gt;
    > Link: https://patch.msgid.link/20241203182122.2725517-1-edumazet@google.com
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ixgbe: Correct BASE-BX10 compliance code (@Tore Amundsen in [f017f37387f7772](https://github.com/sophgo/linux-riscv/commit/f017f37387f7772) at 2024-12-14 19:03:07)
    > [ Upstream commit f72ce14b231f7bf06088e4e50f1875f1e35f79d7 ]
    > SFF-8472 (section 5.4 Transceiver Compliance Codes) defines bit 6 as
    > BASE-BX10. Bit 6 means a value of 0x40 (decimal 64).
    > The current value in the source code is 0x64, which appears to be a
    > mix-up of hex and decimal values. A value of 0x64 (binary 01100100)
    > incorrectly sets bit 2 (1000BASE-CX) and bit 5 (100BASE-FX) as well.
    > Fixes: 1b43e0d20f2d (&quot;ixgbe: Add 1000BASE-BX support&quot;)
    > Signed-off-by: Tore Amundsen &lt;tore@amundsen.org&gt;
    > Reviewed-by: Paul Menzel &lt;pmenzel@molgen.mpg.de&gt;
    > Acked-by: Ernesto Castellotti &lt;ernesto@castellotti.net&gt;
    > Tested-by: Pucha Himasekhar Reddy &lt;himasekharx.reddy.pucha@intel.com&gt; (A Contingent worker at Intel)
    > Signed-off-by: Tony Nguyen &lt;anthony.l.nguyen@intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ netfilter: nft_inner: incorrect percpu area handling under softirq (@Pablo Neira Ayuso in [da5cc778e7bf78f](https://github.com/sophgo/linux-riscv/commit/da5cc778e7bf78f) at 2024-12-14 19:03:07)
    > [ Upstream commit 7b1d83da254be3bf054965c8f3b1ad976f460ae5 ]
    > Softirq can interrupt ongoing packet from process context that is
    > walking over the percpu area that contains inner header offsets.
    > Disable bh and perform three checks before restoring the percpu inner
    > header offsets to validate that the percpu area is valid for this
    > skbuff:
    > 1) If the NFT_PKTINFO_INNER_FULL flag is set on, then this skbuff
    > has already been parsed before for inner header fetching to
    > register.
    > 2) Validate that the percpu area refers to this skbuff using the
    > skbuff pointer as a cookie. If there is a cookie mismatch, then
    > this skbuff needs to be parsed again.
    > 3) Finally, validate if the percpu area refers to this tunnel type.
    > Only after these three checks the percpu area is restored to a on-stack
    > copy and bh is enabled again.
    > After inner header fetching, the on-stack copy is stored back to the
    > percpu area.
    > Fixes: 3a07327d10a0 (&quot;netfilter: nft_inner: support for inner tunnel header matching&quot;)
    > Reported-by: syzbot+84d0441b9860f0d63285@syzkaller.appspotmail.com
    > Signed-off-by: Pablo Neira Ayuso &lt;pablo@netfilter.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ Revert &quot;udp: avoid calling sock_def_readable() if possible&quot; (@Fernando Fernandez Mancera in [a36a6d7037fc11f](https://github.com/sophgo/linux-riscv/commit/a36a6d7037fc11f) at 2024-12-14 19:03:07)
    > [ Upstream commit 3d501f562f63b290351169e3e9931ffe3d57b2ae ]
    > This reverts commit 612b1c0dec5bc7367f90fc508448b8d0d7c05414. On a
    > scenario with multiple threads blocking on a recvfrom(), we need to call
    > sock_def_readable() on every __udp_enqueue_schedule_skb() otherwise the
    > threads won&#x27;t be woken up as __skb_wait_for_more_packets() is using
    > prepare_to_wait_exclusive().
    > Link: https://bugzilla.redhat.com/2308477
    > Fixes: 612b1c0dec5b (&quot;udp: avoid calling sock_def_readable() if possible&quot;)
    > Signed-off-by: Fernando Fernandez Mancera &lt;ffmancera@riseup.net&gt;
    > Reviewed-by: Eric Dumazet &lt;edumazet@google.com&gt;
    > Link: https://patch.msgid.link/20241202155620.1719-1-ffmancera@riseup.net
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ igb: Fix potential invalid memory access in igb_init_module() (@Yuan Can in [992fd34122de377](https://github.com/sophgo/linux-riscv/commit/992fd34122de377) at 2024-12-14 19:03:07)
    > [ Upstream commit 0566f83d206c7a864abcd741fe39d6e0ae5eef29 ]
    > The pci_register_driver() can fail and when this happened, the dca_notifier
    > needs to be unregistered, otherwise the dca_notifier can be called when
    > igb fails to install, resulting to invalid memory access.
    > Fixes: bbd98fe48a43 (&quot;igb: Fix DCA errors and do not use context index for 82576&quot;)
    > Signed-off-by: Yuan Can &lt;yuancan@huawei.com&gt;
    > Tested-by: Pucha Himasekhar Reddy &lt;himasekharx.reddy.pucha@intel.com&gt; (A Contingent worker at Intel)
    > Signed-off-by: Tony Nguyen &lt;anthony.l.nguyen@intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ixgbe: downgrade logging of unsupported VF API version to debug (@Jacob Keller in [25d6979ef303f07](https://github.com/sophgo/linux-riscv/commit/25d6979ef303f07) at 2024-12-14 19:03:07)
    > [ Upstream commit 15915b43a7fb938934bb7fc4290127218859d795 ]
    > The ixgbe PF driver logs an info message when a VF attempts to negotiate an
    > API version which it does not support:
    > VF 0 requested invalid api version 6
    > The ixgbevf driver attempts to load with mailbox API v1.5, which is
    > required for best compatibility with other hosts such as the ESX VMWare PF.
    > The Linux PF only supports API v1.4, and does not currently have support
    > for the v1.5 API.
    > The logged message can confuse users, as the v1.5 API is valid, but just
    > happens to not currently be supported by the Linux PF.
    > Downgrade the info message to a debug message, and fix the language to
    > use &#x27;unsupported&#x27; instead of &#x27;invalid&#x27; to improve message clarity.
    > Long term, we should investigate whether the improvements in the v1.5 API
    > make sense for the Linux PF, and if so implement them properly. This may
    > require yet another API version to resolve issues with negotiating IPSEC
    > offload support.
    > Fixes: 339f28964147 (&quot;ixgbevf: Add support for new mailbox communication between PF and VF&quot;)
    > Reported-by: Yifei Liu &lt;yifei.l.liu@oracle.com&gt;
    > Link: https://lore.kernel.org/intel-wired-lan/20240301235837.3741422-1-yifei.l.liu@oracle.com/
    > Signed-off-by: Jacob Keller &lt;jacob.e.keller@intel.com&gt;
    > Reviewed-by: Przemek Kitszel &lt;przemyslaw.kitszel@intel.com&gt;
    > Tested-by: Rafal Romanowski &lt;rafal.romanowski@intel.com&gt;
    > Signed-off-by: Tony Nguyen &lt;anthony.l.nguyen@intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ net: sched: fix erspan_opt settings in cls_flower (@Xin Long in [152a8c179f2e812](https://github.com/sophgo/linux-riscv/commit/152a8c179f2e812) at 2024-12-14 19:03:07)
    > [ Upstream commit 292207809486d99c78068d3f459cbbbffde88415 ]
    > When matching erspan_opt in cls_flower, only the (version, dir, hwid)
    > fields are relevant. However, in fl_set_erspan_opt() it initializes
    > all bits of erspan_opt and its mask to 1. This inadvertently requires
    > packets to match not only the (version, dir, hwid) fields but also the
    > other fields that are unexpectedly set to 1.
    > This patch resolves the issue by ensuring that only the (version, dir,
    > hwid) fields are configured in fl_set_erspan_opt(), leaving the other
    > fields to 0 in erspan_opt.
    > Fixes: 79b1011cb33d (&quot;net: sched: allow flower to match erspan options&quot;)
    > Reported-by: Shuang Li &lt;shuali@redhat.com&gt;
    > Signed-off-by: Xin Long &lt;lucien.xin@gmail.com&gt;
    > Reviewed-by: Cong Wang &lt;cong.wang@bytedance.com&gt;
    > Signed-off-by: David S. Miller &lt;davem@davemloft.net&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ixgbevf: stop attempting IPSEC offload on Mailbox API 1.5 (@Jacob Keller in [bf4c4782e532dc4](https://github.com/sophgo/linux-riscv/commit/bf4c4782e532dc4) at 2024-12-14 19:03:06)
    > [ Upstream commit d0725312adf5a803de8f621bd1b12ba7a6464a29 ]
    > Commit 339f28964147 (&quot;ixgbevf: Add support for new mailbox communication
    > between PF and VF&quot;) added support for v1.5 of the PF to VF mailbox
    > communication API. This commit mistakenly enabled IPSEC offload for API
    > v1.5.
    > No implementation of the v1.5 API has support for IPSEC offload. This
    > offload is only supported by the Linux PF as mailbox API v1.4. In fact, the
    > v1.5 API is not implemented in any Linux PF.
    > Attempting to enable IPSEC offload on a PF which supports v1.5 API will not
    > work. Only the Linux upstream ixgbe and ixgbevf support IPSEC offload, and
    > only as part of the v1.4 API.
    > Fix the ixgbevf Linux driver to stop attempting IPSEC offload when
    > the mailbox API does not support it.
    > The existing API design choice makes it difficult to support future API
    > versions, as other non-Linux hosts do not implement IPSEC offload. If we
    > add support for v1.5 to the Linux PF, then we lose support for IPSEC
    > offload.
    > A full solution likely requires a new mailbox API with a proper negotiation
    > to check that IPSEC is actually supported by the host.
    > Fixes: 339f28964147 (&quot;ixgbevf: Add support for new mailbox communication between PF and VF&quot;)
    > Signed-off-by: Jacob Keller &lt;jacob.e.keller@intel.com&gt;
    > Reviewed-by: Przemek Kitszel &lt;przemyslaw.kitszel@intel.com&gt;
    > Tested-by: Rafal Romanowski &lt;rafal.romanowski@intel.com&gt;
    > Signed-off-by: Tony Nguyen &lt;anthony.l.nguyen@intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ idpf: set completion tag for &quot;empty&quot; bufs associated with a packet (@Joshua Hay in [befb42b7ce5567a](https://github.com/sophgo/linux-riscv/commit/befb42b7ce5567a) at 2024-12-14 19:03:06)
    > [ Upstream commit 4c69c77aafe74cf755af55070584b643e5c4e4d8 ]
    > Commit d9028db618a6 (&quot;idpf: convert to libeth Tx buffer completion&quot;)
    > inadvertently removed code that was necessary for the tx buffer cleaning
    > routine to iterate over all buffers associated with a packet.
    > When a frag is too large for a single data descriptor, it will be split
    > across multiple data descriptors. This means the frag will span multiple
    > buffers in the buffer ring in order to keep the descriptor and buffer
    > ring indexes aligned. The buffer entries in the ring are technically
    > empty and no cleaning actions need to be performed. These empty buffers
    > can precede other frags associated with the same packet. I.e. a single
    > packet on the buffer ring can look like:
    > buf[0]&#x3D;skb0.frag0
    > buf[1]&#x3D;skb0.frag1
    > buf[2]&#x3D;empty
    > buf[3]&#x3D;skb0.frag2
    > The cleaning routine iterates through these buffers based on a matching
    > completion tag. If the completion tag is not set for buf2, the loop will
    > end prematurely. Frag2 will be left uncleaned and next_to_clean will be
    > left pointing to the end of packet, which will break the cleaning logic
    > for subsequent cleans. This consequently leads to tx timeouts.
    > Assign the empty bufs the same completion tag for the packet to ensure
    > the cleaning routine iterates over all of the buffers associated with
    > the packet.
    > Fixes: d9028db618a6 (&quot;idpf: convert to libeth Tx buffer completion&quot;)
    > Signed-off-by: Joshua Hay &lt;joshua.a.hay@intel.com&gt;
    > Acked-by: Alexander Lobakin &lt;aleksander.lobakin@intel.com&gt;
    > Reviewed-by: Madhu chittim &lt;madhu.chittim@intel.com&gt;
    > Reviewed-by: Simon Horman &lt;horms@kernel.org&gt;
    > Tested-by: Krishneil Singh &lt;krishneil.k.singh@intel.com&gt;
    > Signed-off-by: Tony Nguyen &lt;anthony.l.nguyen@intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ice: Fix VLAN pruning in switchdev mode (@Marcin Szycik in [7ee237851dcf82c](https://github.com/sophgo/linux-riscv/commit/7ee237851dcf82c) at 2024-12-14 19:03:06)
    > [ Upstream commit 761e0be2888a931465e0d7bbeecce797f9c311a3 ]
    > In switchdev mode the uplink VSI should receive all unmatched packets,
    > including VLANs. Therefore, VLAN pruning should be disabled if uplink is
    > in switchdev mode. It is already being done in ice_eswitch_setup_env(),
    > however the addition of ice_up() in commit 44ba608db509 (&quot;ice: do
    > switchdev slow-path Rx using PF VSI&quot;) caused VLAN pruning to be
    > re-enabled after disabling it.
    > Add a check to ice_set_vlan_filtering_features() to ensure VLAN
    > filtering will not be enabled if uplink is in switchdev mode. Note that
    > ice_is_eswitch_mode_switchdev() is being used instead of
    > ice_is_switchdev_running(), as the latter would only return true after
    > the whole switchdev setup completes.
    > Fixes: 44ba608db509 (&quot;ice: do switchdev slow-path Rx using PF VSI&quot;)
    > Reviewed-by: Michal Swiatkowski &lt;michal.swiatkowski@linux.intel.com&gt;
    > Signed-off-by: Marcin Szycik &lt;marcin.szycik@linux.intel.com&gt;
    > Tested-by: Priya Singh &lt;priyax.singh@intel.com&gt;
    > Signed-off-by: Tony Nguyen &lt;anthony.l.nguyen@intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ net: hsr: must allocate more bytes for RedBox support (@Eric Dumazet in [688842f47ee9fb3](https://github.com/sophgo/linux-riscv/commit/688842f47ee9fb3) at 2024-12-14 19:03:06)
    > [ Upstream commit af8edaeddbc52e53207d859c912b017fd9a77629 ]
    > Blamed commit forgot to change hsr_init_skb() to allocate
    > larger skb for RedBox case.
    > Indeed, send_hsr_supervision_frame() will add
    > two additional components (struct hsr_sup_tlv
    > and struct hsr_sup_payload)
    > syzbot reported the following crash:
    > skbuff: skb_over_panic: text:ffffffff8afd4b0a len:34 put:6 head:ffff88802ad29e00 data:ffff88802ad29f22 tail:0x144 end:0x140 dev:gretap0
    > ------------[ cut here ]------------
    > kernel BUG at net/core/skbuff.c:206 !
    > Oops: invalid opcode: 0000 [#1] PREEMPT SMP KASAN NOPTI
    > CPU: 2 UID: 0 PID: 7611 Comm: syz-executor Not tainted 6.12.0-syzkaller #0
    > Hardware name: QEMU Standard PC (Q35 + ICH9, 2009), BIOS 1.16.3-debian-1.16.3-2~bpo12+1 04/01/2014
    > RIP: 0010:skb_panic+0x157/0x1d0 net/core/skbuff.c:206
    > Code: b6 04 01 84 c0 74 04 3c 03 7e 21 8b 4b 70 41 56 45 89 e8 48 c7 c7 a0 7d 9b 8c 41 57 56 48 89 ee 52 4c 89 e2 e8 9a 76 79 f8 90 &lt;0f&gt; 0b 4c 89 4c 24 10 48 89 54 24 08 48 89 34 24 e8 94 76 fb f8 4c
    > RSP: 0018:ffffc90000858ab8 EFLAGS: 00010282
    > RAX: 0000000000000087 RBX: ffff8880598c08c0 RCX: ffffffff816d3e69
    > RDX: 0000000000000000 RSI: ffffffff816de786 RDI: 0000000000000005
    > RBP: ffffffff8c9b91c0 R08: 0000000000000005 R09: 0000000000000000
    > R10: 0000000000000302 R11: ffffffff961cc1d0 R12: ffffffff8afd4b0a
    > R13: 0000000000000006 R14: ffff88804b938130 R15: 0000000000000140
    > FS:  000055558a3d6500(0000) GS:ffff88806a800000(0000) knlGS:0000000000000000
    > CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
    > CR2: 00007f1295974ff8 CR3: 000000002ab6e000 CR4: 0000000000352ef0
    > DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
    > DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
    > Call Trace:
    > &lt;IRQ&gt;
    > skb_over_panic net/core/skbuff.c:211 [inline]
    > skb_put+0x174/0x1b0 net/core/skbuff.c:2617
    > send_hsr_supervision_frame+0x6fa/0x9e0 net/hsr/hsr_device.c:342
    > hsr_proxy_announce+0x1a3/0x4a0 net/hsr/hsr_device.c:436
    > call_timer_fn+0x1a0/0x610 kernel/time/timer.c:1794
    > expire_timers kernel/time/timer.c:1845 [inline]
    > __run_timers+0x6e8/0x930 kernel/time/timer.c:2419
    > __run_timer_base kernel/time/timer.c:2430 [inline]
    > __run_timer_base kernel/time/timer.c:2423 [inline]
    > run_timer_base+0x111/0x190 kernel/time/timer.c:2439
    > run_timer_softirq+0x1a/0x40 kernel/time/timer.c:2449
    > handle_softirqs+0x213/0x8f0 kernel/softirq.c:554
    > __do_softirq kernel/softirq.c:588 [inline]
    > invoke_softirq kernel/softirq.c:428 [inline]
    > __irq_exit_rcu kernel/softirq.c:637 [inline]
    > irq_exit_rcu+0xbb/0x120 kernel/softirq.c:649
    > instr_sysvec_apic_timer_interrupt arch/x86/kernel/apic/apic.c:1049 [inline]
    > sysvec_apic_timer_interrupt+0xa4/0xc0 arch/x86/kernel/apic/apic.c:1049
    > &lt;/IRQ&gt;
    > Fixes: 5055cccfc2d1 (&quot;net: hsr: Provide RedBox support (HSR-SAN)&quot;)
    > Reported-by: syzbot+7f4643b267cc680bfa1c@syzkaller.appspotmail.com
    > Signed-off-by: Eric Dumazet &lt;edumazet@google.com&gt;
    > Cc: Lukasz Majewski &lt;lukma@denx.de&gt;
    > Link: https://patch.msgid.link/20241202100558.507765-1-edumazet@google.com
    > Signed-off-by: Paolo Abeni &lt;pabeni@redhat.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ice: fix PHY Clock Recovery availability check (@Arkadiusz Kubalewski in [2fbcd12de22e670](https://github.com/sophgo/linux-riscv/commit/2fbcd12de22e670) at 2024-12-14 19:03:06)
    > [ Upstream commit 01fd68e54794fb1e1fe95be38facf9bbafee9ca3 ]
    > To check if PHY Clock Recovery mechanic is available for a device, there
    > is a need to verify if given PHY is available within the netlist, but the
    > netlist node type used for the search is wrong, also the search context
    > shall be specified.
    > Modify the search function to allow specifying the context in the
    > search.
    > Use the PHY node type instead of CLOCK CONTROLLER type, also use proper
    > search context which for PHY search is PORT, as defined in E810
    > Datasheet [1] (&#x27;3.3.8.2.4 Node Part Number and Node Options (0x0003)&#x27; and
    > &#x27;Table 3-105. Program Topology Device NVM Admin Command&#x27;).
    > [1] https://cdrdv2.intel.com/v1/dl/getContent/613875?explicitVersion&#x3D;true
    > Fixes: 91e43ca0090b (&quot;ice: fix linking when CONFIG_PTP_1588_CLOCK&#x3D;n&quot;)
    > Reviewed-by: Aleksandr Loktionov &lt;aleksandr.loktionov@intel.com&gt;
    > Signed-off-by: Arkadiusz Kubalewski &lt;arkadiusz.kubalewski@intel.com&gt;
    > Tested-by: Pucha Himasekhar Reddy &lt;himasekharx.reddy.pucha@intel.com&gt; (A Contingent worker at Intel)
    > Signed-off-by: Tony Nguyen &lt;anthony.l.nguyen@intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ice: fix PHY timestamp extraction for ETH56G (@Przemyslaw Korba in [25a702f2528a3a9](https://github.com/sophgo/linux-riscv/commit/25a702f2528a3a9) at 2024-12-14 19:03:06)
    > [ Upstream commit 3214fae85e8336fe13e20cf78fc9b6a668bdedff ]
    > Fix incorrect PHY timestamp extraction for ETH56G.
    > It&#x27;s better to use FIELD_PREP() than manual shift.
    > Fixes: 7cab44f1c35f (&quot;ice: Introduce ETH56G PHY model for E825C products&quot;)
    > Reviewed-by: Przemek Kitszel &lt;przemyslaw.kitszel@intel.com&gt;
    > Reviewed-by: Simon Horman &lt;horms@kernel.org&gt;
    > Signed-off-by: Przemyslaw Korba &lt;przemyslaw.korba@intel.com&gt;
    > Tested-by: Pucha Himasekhar Reddy &lt;himasekharx.reddy.pucha@intel.com&gt; (A Contingent worker at Intel)
    > Signed-off-by: Tony Nguyen &lt;anthony.l.nguyen@intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ tipc: Fix use-after-free of kernel socket in cleanup_bearer(). (@Kuniyuki Iwashima in [e48b211c4c59062](https://github.com/sophgo/linux-riscv/commit/e48b211c4c59062) at 2024-12-14 19:03:05)
    > [ Upstream commit 6a2fa13312e51a621f652d522d7e2df7066330b6 ]
    > syzkaller reported a use-after-free of UDP kernel socket
    > in cleanup_bearer() without repro. [0][1]
    > When bearer_disable() calls tipc_udp_disable(), cleanup
    > of the UDP kernel socket is deferred by work calling
    > cleanup_bearer().
    > tipc_net_stop() waits for such works to finish by checking
    > tipc_net(net)-&gt;wq_count.  However, the work decrements the
    > count too early before releasing the kernel socket,
    > unblocking cleanup_net() and resulting in use-after-free.
    > Let&#x27;s move the decrement after releasing the socket in
    > cleanup_bearer().
    > [0]:
    > ref_tracker: net notrefcnt@000000009b3d1faf has 1/1 users at
    > sk_alloc+0x438/0x608
    > inet_create+0x4c8/0xcb0
    > __sock_create+0x350/0x6b8
    > sock_create_kern+0x58/0x78
    > udp_sock_create4+0x68/0x398
    > udp_sock_create+0x88/0xc8
    > tipc_udp_enable+0x5e8/0x848
    > __tipc_nl_bearer_enable+0x84c/0xed8
    > tipc_nl_bearer_enable+0x38/0x60
    > genl_family_rcv_msg_doit+0x170/0x248
    > genl_rcv_msg+0x400/0x5b0
    > netlink_rcv_skb+0x1dc/0x398
    > genl_rcv+0x44/0x68
    > netlink_unicast+0x678/0x8b0
    > netlink_sendmsg+0x5e4/0x898
    > ____sys_sendmsg+0x500/0x830
    > [1]:
    > BUG: KMSAN: use-after-free in udp_hashslot include/net/udp.h:85 [inline]
    > BUG: KMSAN: use-after-free in udp_lib_unhash+0x3b8/0x930 net/ipv4/udp.c:1979
    > udp_hashslot include/net/udp.h:85 [inline]
    > udp_lib_unhash+0x3b8/0x930 net/ipv4/udp.c:1979
    > sk_common_release+0xaf/0x3f0 net/core/sock.c:3820
    > inet_release+0x1e0/0x260 net/ipv4/af_inet.c:437
    > inet6_release+0x6f/0xd0 net/ipv6/af_inet6.c:489
    > __sock_release net/socket.c:658 [inline]
    > sock_release+0xa0/0x210 net/socket.c:686
    > cleanup_bearer+0x42d/0x4c0 net/tipc/udp_media.c:819
    > process_one_work kernel/workqueue.c:3229 [inline]
    > process_scheduled_works+0xcaf/0x1c90 kernel/workqueue.c:3310
    > worker_thread+0xf6c/0x1510 kernel/workqueue.c:3391
    > kthread+0x531/0x6b0 kernel/kthread.c:389
    > ret_from_fork+0x60/0x80 arch/x86/kernel/process.c:147
    > ret_from_fork_asm+0x11/0x20 arch/x86/entry/entry_64.S:244
    > Uninit was created at:
    > slab_free_hook mm/slub.c:2269 [inline]
    > slab_free mm/slub.c:4580 [inline]
    > kmem_cache_free+0x207/0xc40 mm/slub.c:4682
    > net_free net/core/net_namespace.c:454 [inline]
    > cleanup_net+0x16f2/0x19d0 net/core/net_namespace.c:647
    > process_one_work kernel/workqueue.c:3229 [inline]
    > process_scheduled_works+0xcaf/0x1c90 kernel/workqueue.c:3310
    > worker_thread+0xf6c/0x1510 kernel/workqueue.c:3391
    > kthread+0x531/0x6b0 kernel/kthread.c:389
    > ret_from_fork+0x60/0x80 arch/x86/kernel/process.c:147
    > ret_from_fork_asm+0x11/0x20 arch/x86/entry/entry_64.S:244
    > CPU: 0 UID: 0 PID: 54 Comm: kworker/0:2 Not tainted 6.12.0-rc1-00131-gf66ebf37d69c #7 91723d6f74857f70725e1583cba3cf4adc716cfa
    > Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS rel-1.16.3-0-ga6ed6b701f0a-prebuilt.qemu.org 04/01/2014
    > Workqueue: events cleanup_bearer
    > Fixes: 26abe14379f8 (&quot;net: Modify sk_alloc to not reference count the netns of kernel sockets.&quot;)
    > Reported-by: syzkaller &lt;syzkaller@googlegroups.com&gt;
    > Signed-off-by: Kuniyuki Iwashima &lt;kuniyu@amazon.com&gt;
    > Link: https://patch.msgid.link/20241127050512.28438-1-kuniyu@amazon.com
    > Signed-off-by: Paolo Abeni &lt;pabeni@redhat.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ dccp: Fix memory leak in dccp_feat_change_recv (@Ivan Solodovnikov in [9ee68b0f23706a7](https://github.com/sophgo/linux-riscv/commit/9ee68b0f23706a7) at 2024-12-14 19:03:05)
    > [ Upstream commit 22be4727a8f898442066bcac34f8a1ad0bc72e14 ]
    > If dccp_feat_push_confirm() fails after new value for SP feature was accepted
    > without reconciliation (&#x27;entry &#x3D;&#x3D; NULL&#x27; branch), memory allocated for that value
    > with dccp_feat_clone_sp_val() is never freed.
    > Here is the kmemleak stack for this:
    > unreferenced object 0xffff88801d4ab488 (size 8):
    > comm &quot;syz-executor310&quot;, pid 1127, jiffies 4295085598 (age 41.666s)
    > hex dump (first 8 bytes):
    > 01 b4 4a 1d 80 88 ff ff                          ..J.....
    > backtrace:
    > [&lt;00000000db7cabfe&gt;] kmemdup+0x23/0x50 mm/util.c:128
    > [&lt;0000000019b38405&gt;] kmemdup include/linux/string.h:465 [inline]
    > [&lt;0000000019b38405&gt;] dccp_feat_clone_sp_val net/dccp/feat.c:371 [inline]
    > [&lt;0000000019b38405&gt;] dccp_feat_clone_sp_val net/dccp/feat.c:367 [inline]
    > [&lt;0000000019b38405&gt;] dccp_feat_change_recv net/dccp/feat.c:1145 [inline]
    > [&lt;0000000019b38405&gt;] dccp_feat_parse_options+0x1196/0x2180 net/dccp/feat.c:1416
    > [&lt;00000000b1f6d94a&gt;] dccp_parse_options+0xa2a/0x1260 net/dccp/options.c:125
    > [&lt;0000000030d7b621&gt;] dccp_rcv_state_process+0x197/0x13d0 net/dccp/input.c:650
    > [&lt;000000001f74c72e&gt;] dccp_v4_do_rcv+0xf9/0x1a0 net/dccp/ipv4.c:688
    > [&lt;00000000a6c24128&gt;] sk_backlog_rcv include/net/sock.h:1041 [inline]
    > [&lt;00000000a6c24128&gt;] __release_sock+0x139/0x3b0 net/core/sock.c:2570
    > [&lt;00000000cf1f3a53&gt;] release_sock+0x54/0x1b0 net/core/sock.c:3111
    > [&lt;000000008422fa23&gt;] inet_wait_for_connect net/ipv4/af_inet.c:603 [inline]
    > [&lt;000000008422fa23&gt;] __inet_stream_connect+0x5d0/0xf70 net/ipv4/af_inet.c:696
    > [&lt;0000000015b6f64d&gt;] inet_stream_connect+0x53/0xa0 net/ipv4/af_inet.c:735
    > [&lt;0000000010122488&gt;] __sys_connect_file+0x15c/0x1a0 net/socket.c:1865
    > [&lt;00000000b4b70023&gt;] __sys_connect+0x165/0x1a0 net/socket.c:1882
    > [&lt;00000000f4cb3815&gt;] __do_sys_connect net/socket.c:1892 [inline]
    > [&lt;00000000f4cb3815&gt;] __se_sys_connect net/socket.c:1889 [inline]
    > [&lt;00000000f4cb3815&gt;] __x64_sys_connect+0x6e/0xb0 net/socket.c:1889
    > [&lt;00000000e7b1e839&gt;] do_syscall_64+0x33/0x40 arch/x86/entry/common.c:46
    > [&lt;0000000055e91434&gt;] entry_SYSCALL_64_after_hwframe+0x67/0xd1
    > Clean up the allocated memory in case of dccp_feat_push_confirm() failure
    > and bail out with an error reset code.
    > Found by Linux Verification Center (linuxtesting.org) with Syzkaller.
    > Fixes: e77b8363b2ea (&quot;dccp: Process incoming Change feature-negotiation options&quot;)
    > Signed-off-by: Ivan Solodovnikov &lt;solodovnikov.ia@phystech.edu&gt;
    > Link: https://patch.msgid.link/20241126143902.190853-1-solodovnikov.ia@phystech.edu
    > Signed-off-by: Paolo Abeni &lt;pabeni@redhat.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ net/ipv6: release expired exception dst cached in socket (@Jiri Wiesner in [8b591bd522b71c4](https://github.com/sophgo/linux-riscv/commit/8b591bd522b71c4) at 2024-12-14 19:03:05)
    > [ Upstream commit 3301ab7d5aeb0fe270f73a3d4810c9d1b6a9f045 ]
    > Dst objects get leaked in ip6_negative_advice() when this function is
    > executed for an expired IPv6 route located in the exception table. There
    > are several conditions that must be fulfilled for the leak to occur:
    > an ICMPv6 packet indicating a change of the MTU for the path is received,
    > resulting in an exception dst being created
    > a TCP connection that uses the exception dst for routing packets must
    > start timing out so that TCP begins retransmissions
    > after the exception dst expires, the FIB6 garbage collector must not run
    > before TCP executes ip6_negative_advice() for the expired exception dst
    > When TCP executes ip6_negative_advice() for an exception dst that has
    > expired and if no other socket holds a reference to the exception dst, the
    > refcount of the exception dst is 2, which corresponds to the increment
    > made by dst_init() and the increment made by the TCP socket for which the
    > connection is timing out. The refcount made by the socket is never
    > released. The refcount of the dst is decremented in sk_dst_reset() but
    > that decrement is counteracted by a dst_hold() intentionally placed just
    > before the sk_dst_reset() in ip6_negative_advice(). After
    > ip6_negative_advice() has finished, there is no other object tied to the
    > dst. The socket lost its reference stored in sk_dst_cache and the dst is
    > no longer in the exception table. The exception dst becomes a leaked
    > object.
    > As a result of this dst leak, an unbalanced refcount is reported for the
    > loopback device of a net namespace being destroyed under kernels that do
    > not contain e5f80fcf869a (&quot;ipv6: give an IPv6 dev to blackhole_netdev&quot;):
    > unregister_netdevice: waiting for lo to become free. Usage count &#x3D; 2
    > Fix the dst leak by removing the dst_hold() in ip6_negative_advice(). The
    > patch that introduced the dst_hold() in ip6_negative_advice() was
    > 92f1655aa2b22 (&quot;net: fix __dst_negative_advice() race&quot;). But 92f1655aa2b22
    > merely refactored the code with regards to the dst refcount so the issue
    > was present even before 92f1655aa2b22. The bug was introduced in
    > 54c1a859efd9f (&quot;ipv6: Don&#x27;t drop cache route entry unless timer actually
    > expired.&quot;) where the expired cached route is deleted and the sk_dst_cache
    > member of the socket is set to NULL by calling dst_negative_advice() but
    > the refcount belonging to the socket is left unbalanced.
    > The IPv4 version - ipv4_negative_advice() - is not affected by this bug.
    > When the TCP connection times out ipv4_negative_advice() merely resets the
    > sk_dst_cache of the socket while decrementing the refcount of the
    > exception dst.
    > Fixes: 92f1655aa2b22 (&quot;net: fix __dst_negative_advice() race&quot;)
    > Fixes: 54c1a859efd9f (&quot;ipv6: Don&#x27;t drop cache route entry unless timer actually expired.&quot;)
    > Link: https://lore.kernel.org/netdev/20241113105611.GA6723@incl/T/#u
    > Signed-off-by: Jiri Wiesner &lt;jwiesner@suse.de&gt;
    > Reviewed-by: Eric Dumazet &lt;edumazet@google.com&gt;
    > Link: https://patch.msgid.link/20241128085950.GA4505@incl
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ net/smc: fix LGR and link use-after-free issue (@Wen Gu in [6f0ae06a234a78a](https://github.com/sophgo/linux-riscv/commit/6f0ae06a234a78a) at 2024-12-14 19:03:05)
    > [ Upstream commit 2c7f14ed9c19ec0f149479d1c2842ec1f9bf76d7 ]
    > We encountered a LGR/link use-after-free issue, which manifested as
    > the LGR/link refcnt reaching 0 early and entering the clear process,
    > making resource access unsafe.
    > refcount_t: addition on 0; use-after-free.
    > WARNING: CPU: 14 PID: 107447 at lib/refcount.c:25 refcount_warn_saturate+0x9c/0x140
    > Workqueue: events smc_lgr_terminate_work [smc]
    > Call trace:
    > refcount_warn_saturate+0x9c/0x140
    > __smc_lgr_terminate.part.45+0x2a8/0x370 [smc]
    > smc_lgr_terminate_work+0x28/0x30 [smc]
    > process_one_work+0x1b8/0x420
    > worker_thread+0x158/0x510
    > kthread+0x114/0x118
    > or
    > refcount_t: underflow; use-after-free.
    > WARNING: CPU: 6 PID: 93140 at lib/refcount.c:28 refcount_warn_saturate+0xf0/0x140
    > Workqueue: smc_hs_wq smc_listen_work [smc]
    > Call trace:
    > refcount_warn_saturate+0xf0/0x140
    > smcr_link_put+0x1cc/0x1d8 [smc]
    > smc_conn_free+0x110/0x1b0 [smc]
    > smc_conn_abort+0x50/0x60 [smc]
    > smc_listen_find_device+0x75c/0x790 [smc]
    > smc_listen_work+0x368/0x8a0 [smc]
    > process_one_work+0x1b8/0x420
    > worker_thread+0x158/0x510
    > kthread+0x114/0x118
    > It is caused by repeated release of LGR/link refcnt. One suspect is that
    > smc_conn_free() is called repeatedly because some smc_conn_free() from
    > server listening path are not protected by sock lock.
    > e.g.
    > Calls under socklock        | smc_listen_work
    > -------------------------------------------------------
    > lock_sock(sk)               | smc_conn_abort
    > smc_conn_free               | \- smc_conn_free
    > \- smcr_link_put            |    \- smcr_link_put (duplicated)
    > release_sock(sk)
    > So here add sock lock protection in smc_listen_work() path, making it
    > exclusive with other connection operations.
    > Fixes: 3b2dec2603d5 (&quot;net/smc: restructure client and server code in af_smc&quot;)
    > Co-developed-by: Guangguan Wang &lt;guangguan.wang@linux.alibaba.com&gt;
    > Signed-off-by: Guangguan Wang &lt;guangguan.wang@linux.alibaba.com&gt;
    > Co-developed-by: Kai &lt;KaiShen@linux.alibaba.com&gt;
    > Signed-off-by: Kai &lt;KaiShen@linux.alibaba.com&gt;
    > Signed-off-by: Wen Gu &lt;guwen@linux.alibaba.com&gt;
    > Reviewed-by: Wenjia Zhang &lt;wenjia@linux.ibm.com&gt;
    > Signed-off-by: Paolo Abeni &lt;pabeni@redhat.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ net/smc: initialize close_work early to avoid warning (@Wen Gu in [6638e52dcfafaf1](https://github.com/sophgo/linux-riscv/commit/6638e52dcfafaf1) at 2024-12-14 19:03:05)
    > [ Upstream commit 0541db8ee32c09463a72d0987382b3a3336b0043 ]
    > We encountered a warning that close_work was canceled before
    > initialization.
    > WARNING: CPU: 7 PID: 111103 at kernel/workqueue.c:3047 __flush_work+0x19e/0x1b0
    > Workqueue: events smc_lgr_terminate_work [smc]
    > RIP: 0010:__flush_work+0x19e/0x1b0
    > Call Trace:
    > ? __wake_up_common+0x7a/0x190
    > ? work_busy+0x80/0x80
    > __cancel_work_timer+0xe3/0x160
    > smc_close_cancel_work+0x1a/0x70 [smc]
    > smc_close_active_abort+0x207/0x360 [smc]
    > __smc_lgr_terminate.part.38+0xc8/0x180 [smc]
    > process_one_work+0x19e/0x340
    > worker_thread+0x30/0x370
    > ? process_one_work+0x340/0x340
    > kthread+0x117/0x130
    > ? __kthread_cancel_work+0x50/0x50
    > ret_from_fork+0x22/0x30
    > This is because when smc_close_cancel_work is triggered, e.g. the RDMA
    > driver is rmmod and the LGR is terminated, the conn-&gt;close_work is
    > flushed before initialization, resulting in WARN_ON(!work-&gt;func).
    > __smc_lgr_terminate             | smc_connect_{rdma|ism}
    > -------------------------------------------------------------
    > | smc_conn_create
    > | \- smc_lgr_register_conn
    > for conn in lgr-&gt;conns_all      |
    > \- smc_conn_kill                |
    > \- smc_close_active_abort    |
    > \- smc_close_cancel_work  |
    > \- cancel_work_sync    |
    > \- __flush_work     |
    > (close_work)   |
    > | smc_close_init
    > | \- INIT_WORK(&amp;close_work)
    > So fix this by initializing close_work before establishing the
    > connection.
    > Fixes: 46c28dbd4c23 (&quot;net/smc: no socket state changes in tasklet context&quot;)
    > Fixes: 413498440e30 (&quot;net/smc: add SMC-D support in af_smc&quot;)
    > Signed-off-by: Wen Gu &lt;guwen@linux.alibaba.com&gt;
    > Reviewed-by: Wenjia Zhang &lt;wenjia@linux.ibm.com&gt;
    > Reviewed-by: Alexandra Winter &lt;wintera@linux.ibm.com&gt;
    > Signed-off-by: Paolo Abeni &lt;pabeni@redhat.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ net/qed: allow old cards not supporting &quot;num_images&quot; to work (@Louis Leseur in [5e1c91f4e6f7b92](https://github.com/sophgo/linux-riscv/commit/5e1c91f4e6f7b92) at 2024-12-14 19:03:05)
    > [ Upstream commit 7a0ea70da56ee8c2716d0b79e9959d3c47efab62 ]
    > Commit 43645ce03e00 (&quot;qed: Populate nvm image attribute shadow.&quot;)
    > added support for populating flash image attributes, notably
    > &quot;num_images&quot;. However, some cards were not able to return this
    > information. In such cases, the driver would return EINVAL, causing the
    > driver to exit.
    > Add check to return EOPNOTSUPP instead of EINVAL when the card is not
    > able to return these information. The caller function already handles
    > EOPNOTSUPP without error.
    > Fixes: 43645ce03e00 (&quot;qed: Populate nvm image attribute shadow.&quot;)
    > Co-developed-by: Florian Forestier &lt;florian@forestier.re&gt;
    > Signed-off-by: Florian Forestier &lt;florian@forestier.re&gt;
    > Signed-off-by: Louis Leseur &lt;louis.leseur@gmail.com&gt;
    > Link: https://patch.msgid.link/20241128083633.26431-1-louis.leseur@gmail.com
    > Signed-off-by: Paolo Abeni &lt;pabeni@redhat.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ net: phy: microchip: Reset LAN88xx PHY to ensure clean link state on LAN7800/7850 (@Oleksij Rempel in [3027a9fe02eda2e](https://github.com/sophgo/linux-riscv/commit/3027a9fe02eda2e) at 2024-12-14 19:03:05)
    > [ Upstream commit ccb989e4d1efe0dd81b28c437443532d80d9ecee ]
    > Fix outdated MII_LPA data in the LAN88xx PHY, which is used in LAN7800
    > and LAN7850 USB Ethernet controllers. Due to a hardware limitation, the
    > PHY cannot reliably update link status after parallel detection when the
    > link partner does not support auto-negotiation. To mitigate this, add a
    > PHY reset in &#x60;lan88xx_link_change_notify()&#x60; when &#x60;phydev-&gt;state&#x60; is
    > &#x60;PHY_NOLINK&#x60;, ensuring the PHY starts in a clean state and reports
    > accurate fixed link parallel detection results.
    > Fixes: 792aec47d59d9 (&quot;add microchip LAN88xx phy driver&quot;)
    > Signed-off-by: Oleksij Rempel &lt;o.rempel@pengutronix.de&gt;
    > Link: https://patch.msgid.link/20241125084050.414352-1-o.rempel@pengutronix.de
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ platform/x86: asus-wmi: Ignore return value when writing thermal policy (@Armin Wolf in [ddc6402e2934bdd](https://github.com/sophgo/linux-riscv/commit/ddc6402e2934bdd) at 2024-12-14 19:03:04)
    > [ Upstream commit 25fb5f47f34d90aceda2c47a4230315536e97fa8 ]
    > On some machines like the ASUS Vivobook S14 writing the thermal policy
    > returns the currently writen thermal policy instead of an error code.
    > Ignore the return code to avoid falsely returning an error when the
    > thermal policy was written successfully.
    > Reported-by: auslands-kv@gmx.de
    > Closes: https://bugzilla.kernel.org/show_bug.cgi?id&#x3D;219517
    > Fixes: 2daa86e78c49 (&quot;platform/x86: asus_wmi: Support throttle thermal policy&quot;)
    > Signed-off-by: Armin Wolf &lt;W_Armin@gmx.de&gt;
    > Reviewed-by: Hans de Goede &lt;hdegoede@redhat.com&gt;
    > Link: https://lore.kernel.org/r/20241124171941.29789-1-W_Armin@gmx.de
    > Reviewed-by: Ilpo Järvinen &lt;ilpo.jarvinen@linux.intel.com&gt;
    > Signed-off-by: Ilpo Järvinen &lt;ilpo.jarvinen@linux.intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ bnxt_en: ethtool: Supply ntuple rss context action (@Daniel Xu in [9a97fb4fdb81fda](https://github.com/sophgo/linux-riscv/commit/9a97fb4fdb81fda) at 2024-12-14 19:03:04)
    > [ Upstream commit be75cda92a65a13db242117d674cd5584477a168 ]
    > Commit 2f4f9fe5bf5f (&quot;bnxt_en: Support adding ntuple rules on RSS
    > contexts&quot;) added support for redirecting to an RSS context as an ntuple
    > rule action. However, it forgot to update the ETHTOOL_GRXCLSRULE
    > codepath. This caused &#x60;ethtool -n&#x60; to always report the action as
    > &quot;Action: Direct to queue 0&quot; which is wrong.
    > Fix by teaching bnxt driver to report the RSS context when applicable.
    > Fixes: 2f4f9fe5bf5f (&quot;bnxt_en: Support adding ntuple rules on RSS contexts&quot;)
    > Reviewed-by: Michael Chan &lt;michael.chan@broadcom.com&gt;
    > Signed-off-by: Daniel Xu &lt;dxu@dxuuu.xyz&gt;
    > Link: https://patch.msgid.link/2e884ae39e08dc5123be7c170a6089cefe6a78f7.1732748253.git.dxu@dxuuu.xyz
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ net: Fix icmp host relookup triggering ip_rt_bug (@Dong Chenchen in [9545011e7b2a8fc](https://github.com/sophgo/linux-riscv/commit/9545011e7b2a8fc) at 2024-12-14 19:03:04)
    > [ Upstream commit c44daa7e3c73229f7ac74985acb8c7fb909c4e0a ]
    > arp link failure may trigger ip_rt_bug while xfrm enabled, call trace is:
    > WARNING: CPU: 0 PID: 0 at net/ipv4/route.c:1241 ip_rt_bug+0x14/0x20
    > Modules linked in:
    > CPU: 0 UID: 0 PID: 0 Comm: swapper/0 Not tainted 6.12.0-rc6-00077-g2e1b3cc9d7f7
    > Hardware name: QEMU Standard PC (i440FX + PIIX, 1996),
    > BIOS rel-1.13.0-0-gf21b5a4aeb02-prebuilt.qemu.org 04/01/2014
    > RIP: 0010:ip_rt_bug+0x14/0x20
    > Call Trace:
    > &lt;IRQ&gt;
    > ip_send_skb+0x14/0x40
    > __icmp_send+0x42d/0x6a0
    > ipv4_link_failure+0xe2/0x1d0
    > arp_error_report+0x3c/0x50
    > neigh_invalidate+0x8d/0x100
    > neigh_timer_handler+0x2e1/0x330
    > call_timer_fn+0x21/0x120
    > __run_timer_base.part.0+0x1c9/0x270
    > run_timer_softirq+0x4c/0x80
    > handle_softirqs+0xac/0x280
    > irq_exit_rcu+0x62/0x80
    > sysvec_apic_timer_interrupt+0x77/0x90
    > The script below reproduces this scenario:
    > ip xfrm policy add src 0.0.0.0/0 dst 0.0.0.0/0 \
    > dir out priority 0 ptype main flag localok icmp
    > ip l a veth1 type veth
    > ip a a 192.168.141.111/24 dev veth0
    > ip l s veth0 up
    > ping 192.168.141.155 -c 1
    > icmp_route_lookup() create input routes for locally generated packets
    > while xfrm relookup ICMP traffic.Then it will set input route
    > (dst-&gt;out &#x3D; ip_rt_bug) to skb for DESTUNREACH.
    > For ICMP err triggered by locally generated packets, dst-&gt;dev of output
    > route is loopback. Generally, xfrm relookup verification is not required
    > on loopback interfaces (net.ipv4.conf.lo.disable_xfrm &#x3D; 1).
    > Skip icmp relookup for locally generated packets to fix it.
    > Fixes: 8b7817f3a959 (&quot;[IPSEC]: Add ICMP host relookup support&quot;)
    > Signed-off-by: Dong Chenchen &lt;dongchenchen2@huawei.com&gt;
    > Reviewed-by: David Ahern &lt;dsahern@kernel.org&gt;
    > Reviewed-by: Eric Dumazet &lt;edumazet@google.com&gt;
    > Link: https://patch.msgid.link/20241127040850.1513135-1-dongchenchen2@huawei.com
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ can: j1939: j1939_session_new(): fix skb reference counting (@Dmitry Antipov in [68fceb143b635cd](https://github.com/sophgo/linux-riscv/commit/68fceb143b635cd) at 2024-12-14 19:03:04)
    > [ Upstream commit a8c695005bfe6569acd73d777ca298ddddd66105 ]
    > Since j1939_session_skb_queue() does an extra skb_get() for each new
    > skb, do the same for the initial one in j1939_session_new() to avoid
    > refcount underflow.
    > Reported-by: syzbot+d4e8dc385d9258220c31@syzkaller.appspotmail.com
    > Closes: https://syzkaller.appspot.com/bug?extid&#x3D;d4e8dc385d9258220c31
    > Fixes: 9d71dd0c7009 (&quot;can: add support of SAE J1939 protocol&quot;)
    > Signed-off-by: Dmitry Antipov &lt;dmantipov@yandex.ru&gt;
    > Tested-by: Oleksij Rempel &lt;o.rempel@pengutronix.de&gt;
    > Acked-by: Oleksij Rempel &lt;o.rempel@pengutronix.de&gt;
    > Link: https://patch.msgid.link/20241105094823.2403806-1-dmantipov@yandex.ru
    > [mkl: clean up commit message]
    > Signed-off-by: Marc Kleine-Budde &lt;mkl@pengutronix.de&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ipv6: avoid possible NULL deref in modify_prefix_route() (@Eric Dumazet in [01f95357e47219a](https://github.com/sophgo/linux-riscv/commit/01f95357e47219a) at 2024-12-14 19:03:04)
    > [ Upstream commit a747e02430dfb3657141f99aa6b09331283fa493 ]
    > syzbot found a NULL deref [1] in modify_prefix_route(), caused by one
    > fib6_info without a fib6_table pointer set.
    > This can happen for net-&gt;ipv6.fib6_null_entry
    > [1]
    > Oops: general protection fault, probably for non-canonical address 0xdffffc0000000006: 0000 [#1] PREEMPT SMP KASAN NOPTI
    > KASAN: null-ptr-deref in range [0x0000000000000030-0x0000000000000037]
    > CPU: 1 UID: 0 PID: 5837 Comm: syz-executor888 Not tainted 6.12.0-syzkaller-09567-g7eef7e306d3c #0
    > Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 09/13/2024
    > RIP: 0010:__lock_acquire+0xe4/0x3c40 kernel/locking/lockdep.c:5089
    > Code: 08 84 d2 0f 85 15 14 00 00 44 8b 0d ca 98 f5 0e 45 85 c9 0f 84 b4 0e 00 00 48 b8 00 00 00 00 00 fc ff df 4c 89 e2 48 c1 ea 03 &lt;80&gt; 3c 02 00 0f 85 96 2c 00 00 49 8b 04 24 48 3d a0 07 7f 93 0f 84
    > RSP: 0018:ffffc900035d7268 EFLAGS: 00010006
    > RAX: dffffc0000000000 RBX: 0000000000000000 RCX: 0000000000000000
    > RDX: 0000000000000006 RSI: 1ffff920006bae5f RDI: 0000000000000030
    > RBP: 0000000000000000 R08: 0000000000000001 R09: 0000000000000001
    > R10: ffffffff90608e17 R11: 0000000000000001 R12: 0000000000000030
    > R13: ffff888036334880 R14: 0000000000000000 R15: 0000000000000000
    > FS:  0000555579e90380(0000) GS:ffff8880b8700000(0000) knlGS:0000000000000000
    > CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
    > CR2: 00007ffc59cc4278 CR3: 0000000072b54000 CR4: 00000000003526f0
    > DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
    > DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
    > Call Trace:
    > &lt;TASK&gt;
    > lock_acquire.part.0+0x11b/0x380 kernel/locking/lockdep.c:5849
    > __raw_spin_lock_bh include/linux/spinlock_api_smp.h:126 [inline]
    > _raw_spin_lock_bh+0x33/0x40 kernel/locking/spinlock.c:178
    > spin_lock_bh include/linux/spinlock.h:356 [inline]
    > modify_prefix_route+0x30b/0x8b0 net/ipv6/addrconf.c:4831
    > inet6_addr_modify net/ipv6/addrconf.c:4923 [inline]
    > inet6_rtm_newaddr+0x12c7/0x1ab0 net/ipv6/addrconf.c:5055
    > rtnetlink_rcv_msg+0x3c7/0xea0 net/core/rtnetlink.c:6920
    > netlink_rcv_skb+0x16b/0x440 net/netlink/af_netlink.c:2541
    > netlink_unicast_kernel net/netlink/af_netlink.c:1321 [inline]
    > netlink_unicast+0x53c/0x7f0 net/netlink/af_netlink.c:1347
    > netlink_sendmsg+0x8b8/0xd70 net/netlink/af_netlink.c:1891
    > sock_sendmsg_nosec net/socket.c:711 [inline]
    > __sock_sendmsg net/socket.c:726 [inline]
    > ____sys_sendmsg+0xaaf/0xc90 net/socket.c:2583
    > ___sys_sendmsg+0x135/0x1e0 net/socket.c:2637
    > __sys_sendmsg+0x16e/0x220 net/socket.c:2669
    > do_syscall_x64 arch/x86/entry/common.c:52 [inline]
    > do_syscall_64+0xcd/0x250 arch/x86/entry/common.c:83
    > entry_SYSCALL_64_after_hwframe+0x77/0x7f
    > RIP: 0033:0x7fd1dcef8b79
    > Code: 28 00 00 00 75 05 48 83 c4 28 c3 e8 c1 17 00 00 90 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 &lt;48&gt; 3d 01 f0 ff ff 73 01 c3 48 c7 c1 b8 ff ff ff f7 d8 64 89 01 48
    > RSP: 002b:00007ffc59cc4378 EFLAGS: 00000246 ORIG_RAX: 000000000000002e
    > RAX: ffffffffffffffda RBX: 0000000000000000 RCX: 00007fd1dcef8b79
    > RDX: 0000000000040040 RSI: 0000000020000140 RDI: 0000000000000004
    > RBP: 00000000000113fd R08: 0000000000000006 R09: 0000000000000006
    > R10: 0000000000000006 R11: 0000000000000246 R12: 00007ffc59cc438c
    > R13: 431bde82d7b634db R14: 0000000000000001 R15: 0000000000000001
    > &lt;/TASK&gt;
    > Fixes: 5eb902b8e719 (&quot;net/ipv6: Remove expired routes with a separated list of routes.&quot;)
    > Reported-by: syzbot+1de74b0794c40c8eb300@syzkaller.appspotmail.com
    > Closes: https://lore.kernel.org/netdev/67461f7f.050a0220.1286eb.0021.GAE@google.com/T/#u
    > Signed-off-by: Eric Dumazet &lt;edumazet@google.com&gt;
    > CC: Kui-Feng Lee &lt;thinker.li@gmail.com&gt;
    > Cc: David Ahern &lt;dsahern@kernel.org&gt;
    > Reviewed-by: David Ahern &lt;dsahern@kernel.org&gt;
    > Signed-off-by: David S. Miller &lt;davem@davemloft.net&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ netfilter: nft_socket: remove WARN_ON_ONCE on maximum cgroup level (@Pablo Neira Ayuso in [e227c042580ab06](https://github.com/sophgo/linux-riscv/commit/e227c042580ab06) at 2024-12-14 19:03:03)
    > [ Upstream commit b7529880cb961d515642ce63f9d7570869bbbdc3 ]
    > cgroup maximum depth is INT_MAX by default, there is a cgroup toggle to
    > restrict this maximum depth to a more reasonable value not to harm
    > performance. Remove unnecessary WARN_ON_ONCE which is reachable from
    > userspace.
    > Fixes: 7f3287db6543 (&quot;netfilter: nft_socket: make cgroupsv2 matching work with namespaces&quot;)
    > Reported-by: syzbot+57bac0866ddd99fe47c0@syzkaller.appspotmail.com
    > Signed-off-by: Pablo Neira Ayuso &lt;pablo@netfilter.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ptp: Add error handling for adjfine callback in ptp_clock_adjtime (@Ajay Kaher in [e0964a577864abf](https://github.com/sophgo/linux-riscv/commit/e0964a577864abf) at 2024-12-14 19:03:03)
    > [ Upstream commit 98337d7c87577ded71114f6976edb70a163e27bc ]
    > ptp_clock_adjtime sets ptp-&gt;dialed_frequency even when adjfine
    > callback returns an error. This causes subsequent reads to return
    > an incorrect value.
    > Fix this by adding error check before ptp-&gt;dialed_frequency is set.
    > Fixes: 39a8cbd9ca05 (&quot;ptp: remember the adjusted frequency&quot;)
    > Signed-off-by: Ajay Kaher &lt;ajay.kaher@broadcom.com&gt;
    > Acked-by: Richard Cochran &lt;richardcochran@gmail.com&gt;
    > Link: https://patch.msgid.link/20241125105954.1509971-1-ajay.kaher@broadcom.com
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ netfilter: x_tables: fix LED ID check in led_tg_check() (@Dmitry Antipov in [c40c96d98e536fc](https://github.com/sophgo/linux-riscv/commit/c40c96d98e536fc) at 2024-12-14 19:03:03)
    > [ Upstream commit 04317f4eb2aad312ad85c1a17ad81fe75f1f9bc7 ]
    > Syzbot has reported the following BUG detected by KASAN:
    > BUG: KASAN: slab-out-of-bounds in strlen+0x58/0x70
    > Read of size 1 at addr ffff8881022da0c8 by task repro/5879
    > ...
    > Call Trace:
    > &lt;TASK&gt;
    > dump_stack_lvl+0x241/0x360
    > ? __pfx_dump_stack_lvl+0x10/0x10
    > ? __pfx__printk+0x10/0x10
    > ? _printk+0xd5/0x120
    > ? __virt_addr_valid+0x183/0x530
    > ? __virt_addr_valid+0x183/0x530
    > print_report+0x169/0x550
    > ? __virt_addr_valid+0x183/0x530
    > ? __virt_addr_valid+0x183/0x530
    > ? __virt_addr_valid+0x45f/0x530
    > ? __phys_addr+0xba/0x170
    > ? strlen+0x58/0x70
    > kasan_report+0x143/0x180
    > ? strlen+0x58/0x70
    > strlen+0x58/0x70
    > kstrdup+0x20/0x80
    > led_tg_check+0x18b/0x3c0
    > xt_check_target+0x3bb/0xa40
    > ? __pfx_xt_check_target+0x10/0x10
    > ? stack_depot_save_flags+0x6e4/0x830
    > ? nft_target_init+0x174/0xc30
    > nft_target_init+0x82d/0xc30
    > ? __pfx_nft_target_init+0x10/0x10
    > ? nf_tables_newrule+0x1609/0x2980
    > ? nf_tables_newrule+0x1609/0x2980
    > ? rcu_is_watching+0x15/0xb0
    > ? nf_tables_newrule+0x1609/0x2980
    > ? nf_tables_newrule+0x1609/0x2980
    > ? __kmalloc_noprof+0x21a/0x400
    > nf_tables_newrule+0x1860/0x2980
    > ? __pfx_nf_tables_newrule+0x10/0x10
    > ? __nla_parse+0x40/0x60
    > nfnetlink_rcv+0x14e5/0x2ab0
    > ? __pfx_validate_chain+0x10/0x10
    > ? __pfx_nfnetlink_rcv+0x10/0x10
    > ? __lock_acquire+0x1384/0x2050
    > ? netlink_deliver_tap+0x2e/0x1b0
    > ? __pfx_lock_release+0x10/0x10
    > ? netlink_deliver_tap+0x2e/0x1b0
    > netlink_unicast+0x7f8/0x990
    > ? __pfx_netlink_unicast+0x10/0x10
    > ? __virt_addr_valid+0x183/0x530
    > ? __check_object_size+0x48e/0x900
    > netlink_sendmsg+0x8e4/0xcb0
    > ? __pfx_netlink_sendmsg+0x10/0x10
    > ? aa_sock_msg_perm+0x91/0x160
    > ? __pfx_netlink_sendmsg+0x10/0x10
    > __sock_sendmsg+0x223/0x270
    > ____sys_sendmsg+0x52a/0x7e0
    > ? __pfx_____sys_sendmsg+0x10/0x10
    > __sys_sendmsg+0x292/0x380
    > ? __pfx___sys_sendmsg+0x10/0x10
    > ? lockdep_hardirqs_on_prepare+0x43d/0x780
    > ? __pfx_lockdep_hardirqs_on_prepare+0x10/0x10
    > ? exc_page_fault+0x590/0x8c0
    > ? do_syscall_64+0xb6/0x230
    > do_syscall_64+0xf3/0x230
    > entry_SYSCALL_64_after_hwframe+0x77/0x7f
    > ...
    > &lt;/TASK&gt;
    > Since an invalid (without &#x27;\0&#x27; byte at all) byte sequence may be passed
    > from userspace, add an extra check to ensure that such a sequence is
    > rejected as possible ID and so never passed to &#x27;kstrdup()&#x27; and further.
    > Reported-by: syzbot+6c8215822f35fdb35667@syzkaller.appspotmail.com
    > Closes: https://syzkaller.appspot.com/bug?extid&#x3D;6c8215822f35fdb35667
    > Fixes: 268cb38e1802 (&quot;netfilter: x_tables: add LED trigger target&quot;)
    > Signed-off-by: Dmitry Antipov &lt;dmantipov@yandex.ru&gt;
    > Signed-off-by: Pablo Neira Ayuso &lt;pablo@netfilter.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ net: enetc: Do not configure preemptible TCs if SIs do not support (@Wei Fang in [b718b68a9964181](https://github.com/sophgo/linux-riscv/commit/b718b68a9964181) at 2024-12-14 19:03:03)
    > [ Upstream commit b2420b8c81ec674552d00c55d46245e5c184b260 ]
    > Both ENETC PF and VF drivers share enetc_setup_tc_mqprio() to configure
    > MQPRIO. And enetc_setup_tc_mqprio() calls enetc_change_preemptible_tcs()
    > to configure preemptible TCs. However, only PF is able to configure
    > preemptible TCs. Because only PF has related registers, while VF does not
    > have these registers. So for VF, its hw-&gt;port pointer is NULL. Therefore,
    > VF will access an invalid pointer when accessing a non-existent register,
    > which will cause a crash issue. The simplified log is as follows.
    > root@ls1028ardb:~# tc qdisc add dev eno0vf0 parent root handle 100: \
    > mqprio num_tc 4 map 0 0 1 1 2 2 3 3 queues 1@0 1@1 1@2 1@3 hw 1
    > [  187.290775] Unable to handle kernel paging request at virtual address 0000000000001f00
    > [  187.424831] pc : enetc_mm_commit_preemptible_tcs+0x1c4/0x400
    > [  187.430518] lr : enetc_mm_commit_preemptible_tcs+0x30c/0x400
    > [  187.511140] Call trace:
    > [  187.513588]  enetc_mm_commit_preemptible_tcs+0x1c4/0x400
    > [  187.518918]  enetc_setup_tc_mqprio+0x180/0x214
    > [  187.523374]  enetc_vf_setup_tc+0x1c/0x30
    > [  187.527306]  mqprio_enable_offload+0x144/0x178
    > [  187.531766]  mqprio_init+0x3ec/0x668
    > [  187.535351]  qdisc_create+0x15c/0x488
    > [  187.539023]  tc_modify_qdisc+0x398/0x73c
    > [  187.542958]  rtnetlink_rcv_msg+0x128/0x378
    > [  187.547064]  netlink_rcv_skb+0x60/0x130
    > [  187.550910]  rtnetlink_rcv+0x18/0x24
    > [  187.554492]  netlink_unicast+0x300/0x36c
    > [  187.558425]  netlink_sendmsg+0x1a8/0x420
    > [  187.606759] ---[ end trace 0000000000000000 ]---
    > In addition, some PFs also do not support configuring preemptible TCs,
    > such as eno1 and eno3 on LS1028A. It won&#x27;t crash like it does for VFs,
    > but we should prevent these PFs from accessing these unimplemented
    > registers.
    > Fixes: 827145392a4a (&quot;net: enetc: only commit preemptible TCs to hardware when MM TX is active&quot;)
    > Signed-off-by: Wei Fang &lt;wei.fang@nxp.com&gt;
    > Suggested-by: Vladimir Oltean &lt;vladimir.oltean@nxp.com&gt;
    > Reviewed-by: Frank Li &lt;Frank.Li@nxp.com&gt;
    > Signed-off-by: David S. Miller &lt;davem@davemloft.net&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ net/sched: tbf: correct backlog statistic for GSO packets (@Martin Ottens in [a007f8895f7c4d5](https://github.com/sophgo/linux-riscv/commit/a007f8895f7c4d5) at 2024-12-14 19:03:03)
    > [ Upstream commit 1596a135e3180c92e42dd1fbcad321f4fb3e3b17 ]
    > When the length of a GSO packet in the tbf qdisc is larger than the burst
    > size configured the packet will be segmented by the tbf_segment function.
    > Whenever this function is used to enqueue SKBs, the backlog statistic of
    > the tbf is not increased correctly. This can lead to underflows of the
    > &#x27;backlog&#x27; byte-statistic value when these packets are dequeued from tbf.
    > Reproduce the bug:
    > Ensure that the sender machine has GSO enabled. Configured the tbf on
    > the outgoing interface of the machine as follows (burstsize &#x3D; 1 MTU):
    > $ tc qdisc add dev &lt;oif&gt; root handle 1: tbf rate 50Mbit burst 1514 latency 50ms
    > Send bulk TCP traffic out via this interface, e.g., by running an iPerf3
    > client on this machine. Check the qdisc statistics:
    > $ tc -s qdisc show dev &lt;oif&gt;
    > The &#x27;backlog&#x27; byte-statistic has incorrect values while traffic is
    > transferred, e.g., high values due to u32 underflows. When the transfer
    > is stopped, the value is !&#x3D; 0, which should never happen.
    > This patch fixes this bug by updating the statistics correctly, even if
    > single SKBs of a GSO SKB cannot be enqueued.
    > Fixes: e43ac79a4bc6 (&quot;sch_tbf: segment too big GSO packets&quot;)
    > Signed-off-by: Martin Ottens &lt;martin.ottens@fau.de&gt;
    > Reviewed-by: Eric Dumazet &lt;edumazet@google.com&gt;
    > Link: https://patch.msgid.link/20241125174608.1484356-1-martin.ottens@fau.de
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ net: hsr: avoid potential out-of-bound access in fill_frame_info() (@Eric Dumazet in [7ea527fbd7b94d0](https://github.com/sophgo/linux-riscv/commit/7ea527fbd7b94d0) at 2024-12-14 19:03:03)
    > [ Upstream commit b9653d19e556c6afd035602927a93d100a0d7644 ]
    > syzbot is able to feed a packet with 14 bytes, pretending
    > it is a vlan one.
    > Since fill_frame_info() is relying on skb-&gt;mac_len already,
    > extend the check to cover this case.
    > BUG: KMSAN: uninit-value in fill_frame_info net/hsr/hsr_forward.c:709 [inline]
    > BUG: KMSAN: uninit-value in hsr_forward_skb+0x9ee/0x3b10 net/hsr/hsr_forward.c:724
    > fill_frame_info net/hsr/hsr_forward.c:709 [inline]
    > hsr_forward_skb+0x9ee/0x3b10 net/hsr/hsr_forward.c:724
    > hsr_dev_xmit+0x2f0/0x350 net/hsr/hsr_device.c:235
    > __netdev_start_xmit include/linux/netdevice.h:5002 [inline]
    > netdev_start_xmit include/linux/netdevice.h:5011 [inline]
    > xmit_one net/core/dev.c:3590 [inline]
    > dev_hard_start_xmit+0x247/0xa20 net/core/dev.c:3606
    > __dev_queue_xmit+0x366a/0x57d0 net/core/dev.c:4434
    > dev_queue_xmit include/linux/netdevice.h:3168 [inline]
    > packet_xmit+0x9c/0x6c0 net/packet/af_packet.c:276
    > packet_snd net/packet/af_packet.c:3146 [inline]
    > packet_sendmsg+0x91ae/0xa6f0 net/packet/af_packet.c:3178
    > sock_sendmsg_nosec net/socket.c:711 [inline]
    > __sock_sendmsg+0x30f/0x380 net/socket.c:726
    > __sys_sendto+0x594/0x750 net/socket.c:2197
    > __do_sys_sendto net/socket.c:2204 [inline]
    > __se_sys_sendto net/socket.c:2200 [inline]
    > __x64_sys_sendto+0x125/0x1d0 net/socket.c:2200
    > x64_sys_call+0x346a/0x3c30 arch/x86/include/generated/asm/syscalls_64.h:45
    > do_syscall_x64 arch/x86/entry/common.c:52 [inline]
    > do_syscall_64+0xcd/0x1e0 arch/x86/entry/common.c:83
    > entry_SYSCALL_64_after_hwframe+0x77/0x7f
    > Uninit was created at:
    > slab_post_alloc_hook mm/slub.c:4091 [inline]
    > slab_alloc_node mm/slub.c:4134 [inline]
    > kmem_cache_alloc_node_noprof+0x6bf/0xb80 mm/slub.c:4186
    > kmalloc_reserve+0x13d/0x4a0 net/core/skbuff.c:587
    > __alloc_skb+0x363/0x7b0 net/core/skbuff.c:678
    > alloc_skb include/linux/skbuff.h:1323 [inline]
    > alloc_skb_with_frags+0xc8/0xd00 net/core/skbuff.c:6612
    > sock_alloc_send_pskb+0xa81/0xbf0 net/core/sock.c:2881
    > packet_alloc_skb net/packet/af_packet.c:2995 [inline]
    > packet_snd net/packet/af_packet.c:3089 [inline]
    > packet_sendmsg+0x74c6/0xa6f0 net/packet/af_packet.c:3178
    > sock_sendmsg_nosec net/socket.c:711 [inline]
    > __sock_sendmsg+0x30f/0x380 net/socket.c:726
    > __sys_sendto+0x594/0x750 net/socket.c:2197
    > __do_sys_sendto net/socket.c:2204 [inline]
    > __se_sys_sendto net/socket.c:2200 [inline]
    > __x64_sys_sendto+0x125/0x1d0 net/socket.c:2200
    > x64_sys_call+0x346a/0x3c30 arch/x86/include/generated/asm/syscalls_64.h:45
    > do_syscall_x64 arch/x86/entry/common.c:52 [inline]
    > do_syscall_64+0xcd/0x1e0 arch/x86/entry/common.c:83
    > entry_SYSCALL_64_after_hwframe+0x77/0x7f
    > Fixes: 48b491a5cc74 (&quot;net: hsr: fix mac_len checks&quot;)
    > Reported-by: syzbot+671e2853f9851d039551@syzkaller.appspotmail.com
    > Closes: https://lore.kernel.org/netdev/6745dc7f.050a0220.21d33d.0018.GAE@google.com/T/#u
    > Signed-off-by: Eric Dumazet &lt;edumazet@google.com&gt;
    > Cc: WingMan Kwok &lt;w-kwok2@ti.com&gt;
    > Cc: Murali Karicheri &lt;m-karicheri2@ti.com&gt;
    > Cc: MD Danish Anwar &lt;danishanwar@ti.com&gt;
    > Cc: Jiri Pirko &lt;jiri@nvidia.com&gt;
    > Cc: George McCollister &lt;george.mccollister@gmail.com&gt;
    > Link: https://patch.msgid.link/20241126144344.4177332-1-edumazet@google.com
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ selftests: hid: fix typo and exit code (@Maximilian Heyne in [5bf92a924f1fd17](https://github.com/sophgo/linux-riscv/commit/5bf92a924f1fd17) at 2024-12-14 19:03:03)
    > [ Upstream commit e8f34747bddedaf3895e5d5066e0f71713fff811 ]
    > The correct exit code to mark a test as skipped is 4.
    > Fixes: ffb85d5c9e80 (&quot;selftests: hid: import hid-tools hid-core tests&quot;)
    > Signed-off-by: Maximilian Heyne &lt;mheyne@amazon.de&gt;
    > Link: https://patch.msgid.link/20241126135850.76493-1-mheyne@amazon.de
    > Signed-off-by: Benjamin Tissoires &lt;bentiss@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ can: sja1000: sja1000_err(): fix {rx,tx}_errors statistics (@Dario Binacchi in [bc18651a81752a4](https://github.com/sophgo/linux-riscv/commit/bc18651a81752a4) at 2024-12-14 19:03:02)
    > [ Upstream commit 2c4ef3af4b028a0eaaf378df511d3b425b1df61f ]
    > The sja1000_err() function only incremented the receive error counter
    > and never the transmit error counter, even if the ECC_DIR flag reported
    > that an error had occurred during transmission.
    > Increment the receive/transmit error counter based on the value of the
    > ECC_DIR flag.
    > Fixes: 429da1cc841b (&quot;can: Driver for the SJA1000 CAN controller&quot;)
    > Signed-off-by: Dario Binacchi &lt;dario.binacchi@amarulasolutions.com&gt;
    > Link: https://patch.msgid.link/20241122221650.633981-10-dario.binacchi@amarulasolutions.com
    > Signed-off-by: Marc Kleine-Budde &lt;mkl@pengutronix.de&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ can: ems_usb: ems_usb_rx_err(): fix {rx,tx}_errors statistics (@Dario Binacchi in [51251ed96e8209d](https://github.com/sophgo/linux-riscv/commit/51251ed96e8209d) at 2024-12-14 19:03:02)
    > [ Upstream commit 72a7e2e74b3075959f05e622bae09b115957dffe ]
    > The ems_usb_rx_err() function only incremented the receive error counter
    > and never the transmit error counter, even if the ECC_DIR flag reported
    > that an error had occurred during transmission.
    > Increment the receive/transmit error counter based on the value of the
    > ECC_DIR flag.
    > Fixes: 702171adeed3 (&quot;ems_usb: Added support for EMS CPC-USB/ARM7 CAN/USB interface&quot;)
    > Signed-off-by: Dario Binacchi &lt;dario.binacchi@amarulasolutions.com&gt;
    > Link: https://patch.msgid.link/20241122221650.633981-12-dario.binacchi@amarulasolutions.com
    > Signed-off-by: Marc Kleine-Budde &lt;mkl@pengutronix.de&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ can: hi311x: hi3110_can_ist(): fix {rx,tx}_errors statistics (@Dario Binacchi in [4bf39aee3b702e4](https://github.com/sophgo/linux-riscv/commit/4bf39aee3b702e4) at 2024-12-14 19:03:02)
    > [ Upstream commit 3e4645931655776e757f9fb5ae29371cd7cb21a2 ]
    > The hi3110_can_ist() function was incorrectly incrementing only the
    > receive error counter, even in cases of bit or acknowledgment errors that
    > occur during transmission.
    > The fix the issue by incrementing the appropriate counter based on the
    > type of error.
    > Fixes: 57e83fb9b746 (&quot;can: hi311x: Add Holt HI-311x CAN driver&quot;)
    > Signed-off-by: Dario Binacchi &lt;dario.binacchi@amarulasolutions.com&gt;
    > Link: https://patch.msgid.link/20241122221650.633981-9-dario.binacchi@amarulasolutions.com
    > Signed-off-by: Marc Kleine-Budde &lt;mkl@pengutronix.de&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ipvs: fix UB due to uninitialized stack access in ip_vs_protocol_init() (@Jinghao Jia in [48130002e64fd19](https://github.com/sophgo/linux-riscv/commit/48130002e64fd19) at 2024-12-14 19:03:02)
    > [ Upstream commit 146b6f1112eb30a19776d6c323c994e9d67790db ]
    > Under certain kernel configurations when building with Clang/LLVM, the
    > compiler does not generate a return or jump as the terminator
    > instruction for ip_vs_protocol_init(), triggering the following objtool
    > warning during build time:
    > vmlinux.o: warning: objtool: ip_vs_protocol_init() falls through to next function __initstub__kmod_ip_vs_rr__935_123_ip_vs_rr_init6()
    > At runtime, this either causes an oops when trying to load the ipvs
    > module or a boot-time panic if ipvs is built-in. This same issue has
    > been reported by the Intel kernel test robot previously.
    > Digging deeper into both LLVM and the kernel code reveals this to be a
    > undefined behavior problem. ip_vs_protocol_init() uses a on-stack buffer
    > of 64 chars to store the registered protocol names and leaves it
    > uninitialized after definition. The function calls strnlen() when
    > concatenating protocol names into the buffer. With CONFIG_FORTIFY_SOURCE
    > strnlen() performs an extra step to check whether the last byte of the
    > input char buffer is a null character (commit 3009f891bb9f (&quot;fortify:
    > Allow strlen() and strnlen() to pass compile-time known lengths&quot;)).
    > This, together with possibly other configurations, cause the following
    > IR to be generated:
    > define hidden i32 @ip_vs_protocol_init() local_unnamed_addr #5 section &quot;.init.text&quot; align 16 !kcfi_type !29 {
    > %1 &#x3D; alloca [64 x i8], align 16
    > ...
    > 14:                                               ; preds &#x3D; %11
    > %15 &#x3D; getelementptr inbounds i8, ptr %1, i64 63
    > %16 &#x3D; load i8, ptr %15, align 1
    > %17 &#x3D; tail call i1 @llvm.is.constant.i8(i8 %16)
    > %18 &#x3D; icmp eq i8 %16, 0
    > %19 &#x3D; select i1 %17, i1 %18, i1 false
    > br i1 %19, label %20, label %23
    > 20:                                               ; preds &#x3D; %14
    > %21 &#x3D; call i64 @strlen(ptr noundef nonnull dereferenceable(1) %1) #23
    > ...
    > 23:                                               ; preds &#x3D; %14, %11, %20
    > %24 &#x3D; call i64 @strnlen(ptr noundef nonnull dereferenceable(1) %1, i64 noundef 64) #24
    > ...
    > }
    > The above code calculates the address of the last char in the buffer
    > (value %15) and then loads from it (value %16). Because the buffer is
    > never initialized, the LLVM GVN pass marks value %16 as undefined:
    > %13 &#x3D; getelementptr inbounds i8, ptr %1, i64 63
    > br i1 undef, label %14, label %17
    > This gives later passes (SCCP, in particular) more DCE opportunities by
    > propagating the undef value further, and eventually removes everything
    > after the load on the uninitialized stack location:
    > define hidden i32 @ip_vs_protocol_init() local_unnamed_addr #0 section &quot;.init.text&quot; align 16 !kcfi_type !11 {
    > %1 &#x3D; alloca [64 x i8], align 16
    > ...
    > 12:                                               ; preds &#x3D; %11
    > %13 &#x3D; getelementptr inbounds i8, ptr %1, i64 63
    > unreachable
    > }
    > In this way, the generated native code will just fall through to the
    > next function, as LLVM does not generate any code for the unreachable IR
    > instruction and leaves the function without a terminator.
    > Zero the on-stack buffer to avoid this possible UB.
    > Fixes: 1da177e4c3f4 (&quot;Linux-2.6.12-rc2&quot;)
    > Reported-by: kernel test robot &lt;lkp@intel.com&gt;
    > Closes: https://lore.kernel.org/oe-kbuild-all/202402100205.PWXIz1ZK-lkp@intel.com/
    > Co-developed-by: Ruowen Qin &lt;ruqin@redhat.com&gt;
    > Signed-off-by: Ruowen Qin &lt;ruqin@redhat.com&gt;
    > Signed-off-by: Jinghao Jia &lt;jinghao7@illinois.edu&gt;
    > Acked-by: Julian Anastasov &lt;ja@ssi.bg&gt;
    > Signed-off-by: Pablo Neira Ayuso &lt;pablo@netfilter.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ can: sun4i_can: sun4i_can_err(): fix {rx,tx}_errors statistics (@Dario Binacchi in [0d515fff98b5ae7](https://github.com/sophgo/linux-riscv/commit/0d515fff98b5ae7) at 2024-12-14 19:03:02)
    > [ Upstream commit 595a81988a6fe06eb5849e972c8b9cb21c4e0d54 ]
    > The sun4i_can_err() function only incremented the receive error counter
    > and never the transmit error counter, even if the STA_ERR_DIR flag
    > reported that an error had occurred during transmission.
    > Increment the receive/transmit error counter based on the value of the
    > STA_ERR_DIR flag.
    > Fixes: 0738eff14d81 (&quot;can: Allwinner A10/A20 CAN Controller support - Kernel module&quot;)
    > Signed-off-by: Dario Binacchi &lt;dario.binacchi@amarulasolutions.com&gt;
    > Link: https://patch.msgid.link/20241122221650.633981-11-dario.binacchi@amarulasolutions.com
    > Signed-off-by: Marc Kleine-Budde &lt;mkl@pengutronix.de&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ can: f81604: f81604_handle_can_bus_errors(): fix {rx,tx}_errors statistics (@Dario Binacchi in [02b10fd22d3a040](https://github.com/sophgo/linux-riscv/commit/02b10fd22d3a040) at 2024-12-14 19:03:02)
    > [ Upstream commit d7b916540c2ba3d2a88c27b2a6287b39d8eac052 ]
    > The f81604_handle_can_bus_errors() function only incremented the receive
    > error counter and never the transmit error counter, even if the ECC_DIR
    > flag reported that an error had occurred during transmission.
    > Increment the receive/transmit error counter based on the value of the
    > ECC_DIR flag.
    > Fixes: 88da17436973 (&quot;can: usb: f81604: add Fintek F81604 support&quot;)
    > Signed-off-by: Dario Binacchi &lt;dario.binacchi@amarulasolutions.com&gt;
    > Link: https://patch.msgid.link/20241122221650.633981-13-dario.binacchi@amarulasolutions.com
    > Signed-off-by: Marc Kleine-Budde &lt;mkl@pengutronix.de&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ can: gs_usb: add usb endpoint address detection at driver probe step (@Alexander Kozhinov in [fc2aeda8c9f75c1](https://github.com/sophgo/linux-riscv/commit/fc2aeda8c9f75c1) at 2024-12-14 19:03:01)
    > [ Upstream commit 889b2ae9139a87b3390f7003cb1bb3d65bf90a26 ]
    > There is an approach made to implement gs_usb firmware/driver based on
    > Zephyr RTOS. It was found that USB stack of Zephyr RTOS overwrites USB
    > EP addresses, if they have different last 4 bytes in absence of other
    > endpoints.
    > For example in case of gs_usb candlelight firmware EP-IN is 0x81 and
    > EP-OUT 0x02. If there are no additional USB endpoints, Zephyr RTOS will
    > overwrite EP-OUT to 0x01. More information can be found in the
    > discussion with Zephyr RTOS USB stack maintainer here:
    > https://github.com/zephyrproject-rtos/zephyr/issues/67812
    > There are already two different gs_usb FW driver implementations based
    > on Zephyr RTOS:
    > 1. https://github.com/CANnectivity/cannectivity
    > (by: https://github.com/henrikbrixandersen)
    > 2. https://github.com/zephyrproject-rtos/zephyr/compare/main...KozhinovAlexander:zephyr:gs_usb
    > (by: https://github.com/KozhinovAlexander)
    > At the moment both Zephyr RTOS implementations use dummy USB endpoint,
    > to overcome described USB stack behavior from Zephyr itself. Since
    > Zephyr RTOS is intended to be used on microcontrollers with very
    > constrained amount of resources (ROM, RAM) and additional endpoint
    > requires memory, it is more convenient to update the gs_usb driver in
    > the Linux kernel.
    > To fix this problem, update the gs_usb driver from using hard coded
    > endpoint numbers to evaluate the endpoint descriptors and use the
    > endpoints provided there.
    > Fixes: d08e973a77d1 (&quot;can: gs_usb: Added support for the GS_USB CAN devices&quot;)
    > Reviewed-by: Vincent Mailhol &lt;mailhol.vincent@wanadoo.fr&gt;
    > Signed-off-by: Alexander Kozhinov &lt;ak.alexander.kozhinov@gmail.com&gt;
    > Link: https://patch.msgid.link/20241018212450.31746-1-ak.alexander.kozhinov@gmail.com
    > Signed-off-by: Marc Kleine-Budde &lt;mkl@pengutronix.de&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ can: c_can: c_can_handle_bus_err(): update statistics if skb allocation fails (@Dario Binacchi in [cdf85e7c979c628](https://github.com/sophgo/linux-riscv/commit/cdf85e7c979c628) at 2024-12-14 19:03:01)
    > [ Upstream commit 9e66242504f49e17481d8e197730faba7d99c934 ]
    > Ensure that the statistics are always updated, even if the skb
    > allocation fails.
    > Fixes: 4d6d26537940 (&quot;can: c_can: fix {rx,tx}_errors statistics&quot;)
    > Signed-off-by: Dario Binacchi &lt;dario.binacchi@amarulasolutions.com&gt;
    > Link: https://patch.msgid.link/20241122221650.633981-2-dario.binacchi@amarulasolutions.com
    > Signed-off-by: Marc Kleine-Budde &lt;mkl@pengutronix.de&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ can: hi311x: hi3110_can_ist(): fix potential use-after-free (@Dario Binacchi in [bc30b2fe8c54694](https://github.com/sophgo/linux-riscv/commit/bc30b2fe8c54694) at 2024-12-14 19:03:01)
    > [ Upstream commit 9ad86d377ef4a19c75a9c639964879a5b25a433b ]
    > The commit a22bd630cfff (&quot;can: hi311x: do not report txerr and rxerr
    > during bus-off&quot;) removed the reporting of rxerr and txerr even in case
    > of correct operation (i. e. not bus-off).
    > The error count information added to the CAN frame after netif_rx() is
    > a potential use after free, since there is no guarantee that the skb
    > is in the same state. It might be freed or reused.
    > Fix the issue by postponing the netif_rx() call in case of txerr and
    > rxerr reporting.
    > Fixes: a22bd630cfff (&quot;can: hi311x: do not report txerr and rxerr during bus-off&quot;)
    > Signed-off-by: Dario Binacchi &lt;dario.binacchi@amarulasolutions.com&gt;
    > Link: https://patch.msgid.link/20241122221650.633981-5-dario.binacchi@amarulasolutions.com
    > Signed-off-by: Marc Kleine-Budde &lt;mkl@pengutronix.de&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ can: m_can: m_can_handle_lec_err(): fix {rx,tx}_errors statistics (@Dario Binacchi in [42e3dccf96821bf](https://github.com/sophgo/linux-riscv/commit/42e3dccf96821bf) at 2024-12-14 19:03:01)
    > [ Upstream commit 988d4222bf9039a875a3d48f2fe35c317831ff68 ]
    > The m_can_handle_lec_err() function was incorrectly incrementing only the
    > receive error counter, even in cases of bit or acknowledgment errors that
    > occur during transmission.
    > Fix the issue by incrementing the appropriate counter based on the
    > type of error.
    > Fixes: e0d1f4816f2a (&quot;can: m_can: add Bosch M_CAN controller support&quot;)
    > Signed-off-by: Dario Binacchi &lt;dario.binacchi@amarulasolutions.com&gt;
    > Link: https://patch.msgid.link/20241122221650.633981-7-dario.binacchi@amarulasolutions.com
    > Signed-off-by: Marc Kleine-Budde &lt;mkl@pengutronix.de&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ can: sun4i_can: sun4i_can_err(): call can_change_state() even if cf is NULL (@Dario Binacchi in [412a8927e1db27e](https://github.com/sophgo/linux-riscv/commit/412a8927e1db27e) at 2024-12-14 19:03:01)
    > [ Upstream commit ee6bf3677ae03569d833795064e17f605c2163c7 ]
    > Call the function can_change_state() if the allocation of the skb
    > fails, as it handles the cf parameter when it is null.
    > Additionally, this ensures that the statistics related to state error
    > counters (i. e. warning, passive, and bus-off) are updated.
    > Fixes: 0738eff14d81 (&quot;can: Allwinner A10/A20 CAN Controller support - Kernel module&quot;)
    > Signed-off-by: Dario Binacchi &lt;dario.binacchi@amarulasolutions.com&gt;
    > Link: https://patch.msgid.link/20241122221650.633981-3-dario.binacchi@amarulasolutions.com
    > Signed-off-by: Marc Kleine-Budde &lt;mkl@pengutronix.de&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ can: ifi_canfd: ifi_canfd_handle_lec_err(): fix {rx,tx}_errors statistics (@Dario Binacchi in [377647078baf039](https://github.com/sophgo/linux-riscv/commit/377647078baf039) at 2024-12-14 19:03:01)
    > [ Upstream commit bb03d568bb21b4afe7935d1943bcf68ddea3ea45 ]
    > The ifi_canfd_handle_lec_err() function was incorrectly incrementing only
    > the receive error counter, even in cases of bit or acknowledgment errors
    > that occur during transmission.
    > Fix the issue by incrementing the appropriate counter based on the
    > type of error.
    > Fixes: 5bbd655a8bd0 (&quot;can: ifi: Add more detailed error reporting&quot;)
    > Signed-off-by: Dario Binacchi &lt;dario.binacchi@amarulasolutions.com&gt;
    > Reviewed-by: Marek Vasut &lt;marex@denx.de&gt;
    > Link: https://patch.msgid.link/20241122221650.633981-8-dario.binacchi@amarulasolutions.com
    > Signed-off-by: Marc Kleine-Budde &lt;mkl@pengutronix.de&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ iTCO_wdt: mask NMI_NOW bit for update_no_reboot_bit() call (@Oleksandr Ocheretnyi in [a282aff221bfe1c](https://github.com/sophgo/linux-riscv/commit/a282aff221bfe1c) at 2024-12-14 19:03:00)
    > [ Upstream commit daa814d784ac034c62ab3fb0ef83daeafef527e2 ]
    > Commit da23b6faa8bf (&quot;watchdog: iTCO: Add support for Cannon Lake
    > PCH iTCO&quot;) does not mask NMI_NOW bit during TCO1_CNT register&#x27;s
    > value comparison for update_no_reboot_bit() call causing following
    > failure:
    > ...
    > iTCO_vendor_support: vendor-support&#x3D;0
    > iTCO_wdt iTCO_wdt: unable to reset NO_REBOOT flag, device
    > disabled by hardware/BIOS
    > ...
    > and this can lead to unexpected NMIs later during regular
    > crashkernel&#x27;s workflow because of watchdog probe call failures.
    > This change masks NMI_NOW bit for TCO1_CNT register values to
    > avoid unexpected NMI_NOW bit inversions.
    > Fixes: da23b6faa8bf (&quot;watchdog: iTCO: Add support for Cannon Lake PCH iTCO&quot;)
    > Signed-off-by: Oleksandr Ocheretnyi &lt;oocheret@cisco.com&gt;
    > Reviewed-by: Guenter Roeck &lt;linux@roeck-us.net&gt;
    > Reviewed-by: Mika Westerberg &lt;mika.westerberg@linux.intel.com&gt;
    > Link: https://lore.kernel.org/r/20240913191403.2560805-1-oocheret@cisco.com
    > Signed-off-by: Guenter Roeck &lt;linux@roeck-us.net&gt;
    > Signed-off-by: Wim Van Sebroeck &lt;wim@linux-watchdog.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ watchdog: xilinx_wwdt: Calculate max_hw_heartbeat_ms using clock frequency (@Harini T in [337dbfeea335559](https://github.com/sophgo/linux-riscv/commit/337dbfeea335559) at 2024-12-14 19:03:00)
    > [ Upstream commit 006778844c2c132c28cfa90e3570560351e01b9a ]
    > In the current implementation, the value of max_hw_heartbeat_ms is set
    > to the timeout period expressed in milliseconds and fails to verify if
    > the close window percentage exceeds the maximum value that the hardware
    > supports.
    > 1. Calculate max_hw_heartbeat_ms based on input clock frequency.
    > 2. Update frequency check to require a minimum frequency of 1Mhz.
    > 3. Limit the close and open window percent to hardware supported value
    > to avoid truncation.
    > 4. If the user input timeout exceeds the maximum timeout supported, use
    > only open window and the framework supports the higher timeouts.
    > Fixes: 12984cea1b8c (&quot;watchdog: xilinx_wwdt: Add Versal window watchdog support&quot;)
    > Signed-off-by: Harini T &lt;harini.t@amd.com&gt;
    > Reviewed-by: Guenter Roeck &lt;linux@roeck-us.net&gt;
    > Link: https://lore.kernel.org/r/20240913113230.1939373-1-harini.t@amd.com
    > Signed-off-by: Guenter Roeck &lt;linux@roeck-us.net&gt;
    > Signed-off-by: Wim Van Sebroeck &lt;wim@linux-watchdog.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ watchdog: mediatek: Make sure system reset gets asserted in mtk_wdt_restart() (@Yassine Oudjana in [316b301a2f932d6](https://github.com/sophgo/linux-riscv/commit/316b301a2f932d6) at 2024-12-14 19:03:00)
    > [ Upstream commit a1495a21e0b8aad92132dfcf9c6fffc1bde9d5b2 ]
    > Clear the IRQ enable bit of WDT_MODE before asserting software reset
    > in order to make TOPRGU issue a system reset signal instead of an IRQ.
    > Fixes: a44a45536f7b (&quot;watchdog: Add driver for Mediatek watchdog&quot;)
    > Signed-off-by: Yassine Oudjana &lt;y.oudjana@protonmail.com&gt;
    > Reviewed-by: AngeloGioacchino Del Regno &lt;angelogioacchino.delregno@collabora.com&gt;
    > Reviewed-by: Guenter Roeck &lt;linux@roeck-us.net&gt;
    > Link: https://lore.kernel.org/r/20241106104738.195968-2-y.oudjana@protonmail.com
    > Signed-off-by: Guenter Roeck &lt;linux@roeck-us.net&gt;
    > Signed-off-by: Wim Van Sebroeck &lt;wim@linux-watchdog.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ watchdog: apple: Actually flush writes after requesting watchdog restart (@Nick Chan in [17cab7b4ff4b226](https://github.com/sophgo/linux-riscv/commit/17cab7b4ff4b226) at 2024-12-14 19:03:00)
    > [ Upstream commit 51dfe714c03c066aabc815a2bb2adcc998dfcb30 ]
    > Although there is an existing code comment about flushing the writes,
    > writes were not actually being flushed.
    > Actually flush the writes by changing readl_relaxed() to readl().
    > Fixes: 4ed224aeaf661 (&quot;watchdog: Add Apple SoC watchdog driver&quot;)
    > Suggested-by: Arnd Bergmann &lt;arnd@arndb.de&gt;
    > Signed-off-by: Nick Chan &lt;towinchenmi@gmail.com&gt;
    > Reviewed-by: Guenter Roeck  &lt;linux@roeck-us.net&gt;
    > Link: https://lore.kernel.org/r/20241001170018.20139-2-towinchenmi@gmail.com
    > Signed-off-by: Guenter Roeck &lt;linux@roeck-us.net&gt;
    > Signed-off-by: Wim Van Sebroeck &lt;wim@linux-watchdog.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/amd/display: update pipe selection policy to check head pipe (@Yihan Zhu in [ca99829773255d8](https://github.com/sophgo/linux-riscv/commit/ca99829773255d8) at 2024-12-09 09:41:16)
    > commit 8fef253c94a5312b9150b2ff8e633b331bac7e88 upstream.
    > [Why]
    > No check on head pipe during the dml to dc hw mapping will allow illegal
    > pipe usage. This will result in a wrong pipe topology to cause mpcc tree
    > totally mess up then cause a display hang.
    > [How]
    > Avoid to use the pipe is head in all check and avoid ODM slice during
    > preferred pipe check.
    > Cc: stable@vger.kernel.org
    > Reviewed-by: Nicholas Kazlauskas &lt;nicholas.kazlauskas@amd.com&gt;
    > Signed-off-by: Yihan Zhu &lt;Yihan.Zhu@amd.com&gt;
    > Signed-off-by: Hamza Mahfooz &lt;hamza.mahfooz@amd.com&gt;
    > Tested-by: Daniel Wheeler &lt;daniel.wheeler@amd.com&gt;
    > Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ drm/amd/display: Remove PIPE_DTO_SRC_SEL programming from set_dtbclk_dto (@Ovidiu Bunea in [bf078ed5daa3c85](https://github.com/sophgo/linux-riscv/commit/bf078ed5daa3c85) at 2024-12-09 09:41:16)
    > commit a3e6079bd93d5c66a43bf6a5f90e5b98465dc7b3 upstream.
    > There are cases where an OTG is remapped from driving a regular HDMI
    > display to a DP/eDP display. There are also cases where DTBCLK needs to
    > be enabled for HPO, but DTBCLK DTO programming may be done while OTG is
    > still enabled which is dangerous as the PIPE_DTO_SRC_SEL programming may
    > change the pixel clock generator source for a mapped and running OTG and
    > cause it to hang.
    > Remove the PIPE_DTO_SRC_SEL programming from this sequence since it is
    > already done in program_pixel_clk(). Additionally, make sure that
    > program_pixel_clk sets DTBCLK DTO as source for special HDMI cases.
    > Cc: stable@vger.kernel.org # 6.11+
    > Reviewed-by: Nicholas Kazlauskas &lt;nicholas.kazlauskas@amd.com&gt;
    > Signed-off-by: Ovidiu Bunea &lt;Ovidiu.Bunea@amd.com&gt;
    > Signed-off-by: Hamza Mahfooz &lt;hamza.mahfooz@amd.com&gt;
    > Tested-by: Daniel Wheeler &lt;daniel.wheeler@amd.com&gt;
    > Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ posix-timers: Target group sigqueue to current task only if not exiting (@Frederic Weisbecker in [aa2895911816c4e](https://github.com/sophgo/linux-riscv/commit/aa2895911816c4e) at 2024-12-09 09:41:16)
    > commit 63dffecfba3eddcf67a8f76d80e0c141f93d44a5 upstream.
    > A sigqueue belonging to a posix timer, which target is not a specific
    > thread but a whole thread group, is preferrably targeted to the current
    > task if it is part of that thread group.
    > However nothing prevents a posix timer event from queueing such a
    > sigqueue from a reaped yet running task. The interruptible code space
    > between exit_notify() and the final call to schedule() is enough for
    > posix_timer_fn() hrtimer to fire.
    > If that happens while the current task is part of the thread group
    > target, it is proposed to handle it but since its sighand pointer may
    > have been cleared already, the sigqueue is dropped even if there are
    > other tasks running within the group that could handle it.
    > As a result posix timers with thread group wide target may miss signals
    > when some of their threads are exiting.
    > Fix this with verifying that the current task hasn&#x27;t been through
    > exit_notify() before proposing it as a preferred target so as to ensure
    > that its sighand is still here and stable.
    > complete_signal() might still reconsider the choice and find a better
    > target within the group if current has passed retarget_shared_pending()
    > already.
    > Fixes: bcb7ee79029d (&quot;posix-timers: Prefer delivery of signals to the current thread&quot;)
    > Reported-by: Anthony Mallet &lt;anthony.mallet@laas.fr&gt;
    > Suggested-by: Oleg Nesterov &lt;oleg@redhat.com&gt;
    > Signed-off-by: Frederic Weisbecker &lt;frederic@kernel.org&gt;
    > Signed-off-by: Thomas Gleixner &lt;tglx@linutronix.de&gt;
    > Acked-by: Oleg Nesterov &lt;oleg@redhat.com&gt;
    > Cc: stable@vger.kernel.org
    > Link: https://lore.kernel.org/all/20241122234811.60455-1-frederic@kernel.org
    > Closes: https://lore.kernel.org/all/26411.57288.238690.681680@gargle.gargle.HOWL
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ Linux 6.12.4 (@Greg Kroah-Hartman in [61baee2dc5341c9](https://github.com/sophgo/linux-riscv/commit/61baee2dc5341c9) at 2024-12-09 09:41:16)
    > Link: https://lore.kernel.org/r/20241206143527.654980698@linuxfoundation.org
    > Tested-by: Ronald Warsow &lt;rwarsow@gmx.de&gt;
    > Tested-by: Luna Jernberg &lt;droidbittin@gmail.com&gt;
    > Tested-by: Mark Brown &lt;broonie@kernel.org&gt;
    > Tested-by: Salvatore Bonaccorso &lt;carnil@debian.org&gt;
    > Tested-by: Florian Fainelli &lt;florian.fainelli@broadcom.com&gt;
    > Tested-by: Peter Schneider &lt;pschneider1968@googlemail.com&gt;
    > Tested-by: Takeshi Ogasawara &lt;takeshi.ogasawara@futuring-girl.com&gt;
    > Tested-by: Ron Economos &lt;re@w6rz.net&gt;
    > Tested-by: kernelci.org bot &lt;bot@kernelci.org&gt;
    > Tested-by: Linux Kernel Functional Testing &lt;lkft@linaro.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ Revert &quot;drm/xe/xe_guc_ads: save/restore OA registers and allowlist regs&quot; (@Ashutosh Dixit in [372504eb9c1079e](https://github.com/sophgo/linux-riscv/commit/372504eb9c1079e) at 2024-12-09 09:41:16)
    > commit 0191fddf53748cf2b473d78faeabe6dcb47689d2 upstream.
    > This reverts commit 55858fa7eb2f163f7aa34339fd3399ba4ff564c6.
    > &#x27;55858fa7eb2f (&quot;drm/xe/xe_guc_ads: save/restore OA registers and allowlist
    > regs&quot;)&#x27; was not properly reviewed and also causes dmesg asserts in
    > CI. Revert it.
    > Closes: https://gitlab.freedesktop.org/drm/xe/kernel/-/issues/3295
    > Fixes: 55858fa7eb2f (&quot;drm/xe/xe_guc_ads: save/restore OA registers and allowlist regs&quot;)
    > Signed-off-by: Ashutosh Dixit &lt;ashutosh.dixit@intel.com&gt;
    > Reviewed-by: Jonathan Cavitt &lt;jonathan.cavitt@intel.com&gt;
    > Signed-off-by: Matt Roper &lt;matthew.d.roper@intel.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20241029200147.1476513-1-ashutosh.dixit@intel.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ drm/amd/pm: skip setting the power source on smu v14.0.2/3 (@Kenneth Feng in [e5483137d16f615](https://github.com/sophgo/linux-riscv/commit/e5483137d16f615) at 2024-12-09 09:41:15)
    > commit 76c7f08094767b5df3b60e18d1bdecddd4a5c844 upstream.
    > skip setting power source on smu v14.0.2/3
    > Signed-off-by: Kenneth Feng &lt;kenneth.feng@amd.com&gt;
    > Reviewed-by: Lijo Lazar &lt;lijo.lazar@amd.com&gt;
    > Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Cc: stable@vger.kernel.org # 6.11.x
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ drm/amd/pm: update current_socclk and current_uclk in gpu_metrics on smu v13.0.7 (@Umio Yasuno in [c8a6a98b813cbb3](https://github.com/sophgo/linux-riscv/commit/c8a6a98b813cbb3) at 2024-12-09 09:41:15)
    > commit 2abf2f7032df4c4e7f6cf7906da59d0e614897d6 upstream.
    > These were missed before.
    > Closes: https://gitlab.freedesktop.org/drm/amd/-/issues/3751
    > Signed-off-by: Umio Yasuno &lt;coelacanth_dream@protonmail.com&gt;
    > Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ drm/amd/pm: disable pcie speed switching on Intel platform for smu v14.0.2/3 (@Kenneth Feng in [8f5b79a452bdd61](https://github.com/sophgo/linux-riscv/commit/8f5b79a452bdd61) at 2024-12-09 09:41:15)
    > commit b0df0e777874549c128b43f7bf4989a2ed24b37a upstream.
    > disable pcie speed switching on Intel platform for smu v14.0.2/3
    > based on Intel&#x27;s requirement.
    > v2: align the setting with smu v13.
    > Signed-off-by: Kenneth Feng &lt;kenneth.feng@amd.com&gt;
    > Reviewed-by: Lijo Lazar &lt;lijo.lazar@amd.com&gt;
    > Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Cc: stable@vger.kernel.org # 6.11.x
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ drm/amd/display: Fix handling of plane refcount (@Joshua Aberback in [8cb2f6793845f13](https://github.com/sophgo/linux-riscv/commit/8cb2f6793845f13) at 2024-12-09 09:41:15)
    > commit 27227a234c1487cb7a684615f0749c455218833a upstream.
    > [Why]
    > The mechanism to backup and restore plane states doesn&#x27;t maintain
    > refcount, which can cause issues if the refcount of the plane changes
    > in between backup and restore operations, such as memory leaks if the
    > refcount was supposed to go down, or double frees / invalid memory
    > accesses if the refcount was supposed to go up.
    > [How]
    > Cache and re-apply current refcount when restoring plane states.
    > Cc: stable@vger.kernel.org
    > Reviewed-by: Josip Pavic &lt;josip.pavic@amd.com&gt;
    > Signed-off-by: Joshua Aberback &lt;joshua.aberback@amd.com&gt;
    > Signed-off-by: Hamza Mahfooz &lt;hamza.mahfooz@amd.com&gt;
    > Tested-by: Daniel Wheeler &lt;daniel.wheeler@amd.com&gt;
    > Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ drm/amdgpu: fix usage slab after free (@Vitaly Prosyak in [6383199ada42d30](https://github.com/sophgo/linux-riscv/commit/6383199ada42d30) at 2024-12-09 09:41:15)
    > commit b61badd20b443eabe132314669bb51a263982e5c upstream.
    > [  +0.000021] BUG: KASAN: slab-use-after-free in drm_sched_entity_flush+0x6cb/0x7a0 [gpu_sched]
    > [  +0.000027] Read of size 8 at addr ffff8881b8605f88 by task amd_pci_unplug/2147
    > [  +0.000023] CPU: 6 PID: 2147 Comm: amd_pci_unplug Not tainted 6.10.0+ #1
    > [  +0.000016] Hardware name: ASUS System Product Name/ROG STRIX B550-F GAMING (WI-FI), BIOS 1401 12/03/2020
    > [  +0.000016] Call Trace:
    > [  +0.000008]  &lt;TASK&gt;
    > [  +0.000009]  dump_stack_lvl+0x76/0xa0
    > [  +0.000017]  print_report+0xce/0x5f0
    > [  +0.000017]  ? drm_sched_entity_flush+0x6cb/0x7a0 [gpu_sched]
    > [  +0.000019]  ? srso_return_thunk+0x5/0x5f
    > [  +0.000015]  ? kasan_complete_mode_report_info+0x72/0x200
    > [  +0.000016]  ? drm_sched_entity_flush+0x6cb/0x7a0 [gpu_sched]
    > [  +0.000019]  kasan_report+0xbe/0x110
    > [  +0.000015]  ? drm_sched_entity_flush+0x6cb/0x7a0 [gpu_sched]
    > [  +0.000023]  __asan_report_load8_noabort+0x14/0x30
    > [  +0.000014]  drm_sched_entity_flush+0x6cb/0x7a0 [gpu_sched]
    > [  +0.000020]  ? srso_return_thunk+0x5/0x5f
    > [  +0.000013]  ? __kasan_check_write+0x14/0x30
    > [  +0.000016]  ? __pfx_drm_sched_entity_flush+0x10/0x10 [gpu_sched]
    > [  +0.000020]  ? srso_return_thunk+0x5/0x5f
    > [  +0.000013]  ? __kasan_check_write+0x14/0x30
    > [  +0.000013]  ? srso_return_thunk+0x5/0x5f
    > [  +0.000013]  ? enable_work+0x124/0x220
    > [  +0.000015]  ? __pfx_enable_work+0x10/0x10
    > [  +0.000013]  ? srso_return_thunk+0x5/0x5f
    > [  +0.000014]  ? free_large_kmalloc+0x85/0xf0
    > [  +0.000016]  drm_sched_entity_destroy+0x18/0x30 [gpu_sched]
    > [  +0.000020]  amdgpu_vce_sw_fini+0x55/0x170 [amdgpu]
    > [  +0.000735]  ? __kasan_check_read+0x11/0x20
    > [  +0.000016]  vce_v4_0_sw_fini+0x80/0x110 [amdgpu]
    > [  +0.000726]  amdgpu_device_fini_sw+0x331/0xfc0 [amdgpu]
    > [  +0.000679]  ? mutex_unlock+0x80/0xe0
    > [  +0.000017]  ? __pfx_amdgpu_device_fini_sw+0x10/0x10 [amdgpu]
    > [  +0.000662]  ? srso_return_thunk+0x5/0x5f
    > [  +0.000014]  ? __kasan_check_write+0x14/0x30
    > [  +0.000013]  ? srso_return_thunk+0x5/0x5f
    > [  +0.000013]  ? mutex_unlock+0x80/0xe0
    > [  +0.000016]  amdgpu_driver_release_kms+0x16/0x80 [amdgpu]
    > [  +0.000663]  drm_minor_release+0xc9/0x140 [drm]
    > [  +0.000081]  drm_release+0x1fd/0x390 [drm]
    > [  +0.000082]  __fput+0x36c/0xad0
    > [  +0.000018]  __fput_sync+0x3c/0x50
    > [  +0.000014]  __x64_sys_close+0x7d/0xe0
    > [  +0.000014]  x64_sys_call+0x1bc6/0x2680
    > [  +0.000014]  do_syscall_64+0x70/0x130
    > [  +0.000014]  ? srso_return_thunk+0x5/0x5f
    > [  +0.000014]  ? irqentry_exit_to_user_mode+0x60/0x190
    > [  +0.000015]  ? srso_return_thunk+0x5/0x5f
    > [  +0.000014]  ? irqentry_exit+0x43/0x50
    > [  +0.000012]  ? srso_return_thunk+0x5/0x5f
    > [  +0.000013]  ? exc_page_fault+0x7c/0x110
    > [  +0.000015]  entry_SYSCALL_64_after_hwframe+0x76/0x7e
    > [  +0.000014] RIP: 0033:0x7ffff7b14f67
    > [  +0.000013] Code: ff e8 0d 16 02 00 66 2e 0f 1f 84 00 00 00 00 00 0f 1f 00 f3 0f 1e fa 64 8b 04 25 18 00 00 00 85 c0 75 10 b8 03 00 00 00 0f 05 &lt;48&gt; 3d 00 f0 ff ff 77 41 c3 48 83 ec 18 89 7c 24 0c e8 73 ba f7 ff
    > [  +0.000026] RSP: 002b:00007fffffffe378 EFLAGS: 00000246 ORIG_RAX: 0000000000000003
    > [  +0.000019] RAX: ffffffffffffffda RBX: 0000000000000000 RCX: 00007ffff7b14f67
    > [  +0.000014] RDX: 0000000000000000 RSI: 00007ffff7f6f47a RDI: 0000000000000003
    > [  +0.000014] RBP: 00007fffffffe3a0 R08: 0000555555569890 R09: 0000000000000000
    > [  +0.000014] R10: 0000000000000000 R11: 0000000000000246 R12: 00007fffffffe5c8
    > [  +0.000013] R13: 00005555555552a9 R14: 0000555555557d48 R15: 00007ffff7ffd040
    > [  +0.000020]  &lt;/TASK&gt;
    > [  +0.000016] Allocated by task 383 on cpu 7 at 26.880319s:
    > [  +0.000014]  kasan_save_stack+0x28/0x60
    > [  +0.000008]  kasan_save_track+0x18/0x70
    > [  +0.000007]  kasan_save_alloc_info+0x38/0x60
    > [  +0.000007]  __kasan_kmalloc+0xc1/0xd0
    > [  +0.000007]  kmalloc_trace_noprof+0x180/0x380
    > [  +0.000007]  drm_sched_init+0x411/0xec0 [gpu_sched]
    > [  +0.000012]  amdgpu_device_init+0x695f/0xa610 [amdgpu]
    > [  +0.000658]  amdgpu_driver_load_kms+0x1a/0x120 [amdgpu]
    > [  +0.000662]  amdgpu_pci_probe+0x361/0xf30 [amdgpu]
    > [  +0.000651]  local_pci_probe+0xe7/0x1b0
    > [  +0.000009]  pci_device_probe+0x248/0x890
    > [  +0.000008]  really_probe+0x1fd/0x950
    > [  +0.000008]  __driver_probe_device+0x307/0x410
    > [  +0.000007]  driver_probe_device+0x4e/0x150
    > [  +0.000007]  __driver_attach+0x223/0x510
    > [  +0.000006]  bus_for_each_dev+0x102/0x1a0
    > [  +0.000007]  driver_attach+0x3d/0x60
    > [  +0.000006]  bus_add_driver+0x2ac/0x5f0
    > [  +0.000006]  driver_register+0x13d/0x490
    > [  +0.000008]  __pci_register_driver+0x1ee/0x2b0
    > [  +0.000007]  llc_sap_close+0xb0/0x160 [llc]
    > [  +0.000009]  do_one_initcall+0x9c/0x3e0
    > [  +0.000008]  do_init_module+0x241/0x760
    > [  +0.000008]  load_module+0x51ac/0x6c30
    > [  +0.000006]  __do_sys_init_module+0x234/0x270
    > [  +0.000007]  __x64_sys_init_module+0x73/0xc0
    > [  +0.000006]  x64_sys_call+0xe3/0x2680
    > [  +0.000006]  do_syscall_64+0x70/0x130
    > [  +0.000007]  entry_SYSCALL_64_after_hwframe+0x76/0x7e
    > [  +0.000015] Freed by task 2147 on cpu 6 at 160.507651s:
    > [  +0.000013]  kasan_save_stack+0x28/0x60
    > [  +0.000007]  kasan_save_track+0x18/0x70
    > [  +0.000007]  kasan_save_free_info+0x3b/0x60
    > [  +0.000007]  poison_slab_object+0x115/0x1c0
    > [  +0.000007]  __kasan_slab_free+0x34/0x60
    > [  +0.000007]  kfree+0xfa/0x2f0
    > [  +0.000007]  drm_sched_fini+0x19d/0x410 [gpu_sched]
    > [  +0.000012]  amdgpu_fence_driver_sw_fini+0xc4/0x2f0 [amdgpu]
    > [  +0.000662]  amdgpu_device_fini_sw+0x77/0xfc0 [amdgpu]
    > [  +0.000653]  amdgpu_driver_release_kms+0x16/0x80 [amdgpu]
    > [  +0.000655]  drm_minor_release+0xc9/0x140 [drm]
    > [  +0.000071]  drm_release+0x1fd/0x390 [drm]
    > [  +0.000071]  __fput+0x36c/0xad0
    > [  +0.000008]  __fput_sync+0x3c/0x50
    > [  +0.000007]  __x64_sys_close+0x7d/0xe0
    > [  +0.000007]  x64_sys_call+0x1bc6/0x2680
    > [  +0.000007]  do_syscall_64+0x70/0x130
    > [  +0.000007]  entry_SYSCALL_64_after_hwframe+0x76/0x7e
    > [  +0.000014] The buggy address belongs to the object at ffff8881b8605f80
    > which belongs to the cache kmalloc-64 of size 64
    > [  +0.000020] The buggy address is located 8 bytes inside of
    > freed 64-byte region [ffff8881b8605f80, ffff8881b8605fc0)
    > [  +0.000028] The buggy address belongs to the physical page:
    > [  +0.000011] page: refcount:1 mapcount:0 mapping:0000000000000000 index:0x0 pfn:0x1b8605
    > [  +0.000008] anon flags: 0x17ffffc0000000(node&#x3D;0|zone&#x3D;2|lastcpupid&#x3D;0x1fffff)
    > [  +0.000007] page_type: 0xffffefff(slab)
    > [  +0.000009] raw: 0017ffffc0000000 ffff8881000428c0 0000000000000000 dead000000000001
    > [  +0.000006] raw: 0000000000000000 0000000000200020 00000001ffffefff 0000000000000000
    > [  +0.000006] page dumped because: kasan: bad access detected
    > [  +0.000012] Memory state around the buggy address:
    > [  +0.000011]  ffff8881b8605e80: fa fb fb fb fb fb fb fb fc fc fc fc fc fc fc fc
    > [  +0.000015]  ffff8881b8605f00: 00 00 00 00 00 00 00 00 fc fc fc fc fc fc fc fc
    > [  +0.000015] &gt;ffff8881b8605f80: fa fb fb fb fb fb fb fb fc fc fc fc fc fc fc fc
    > [  +0.000013]                       ^
    > [  +0.000011]  ffff8881b8606000: fa fb fb fb fb fb fb fb fb fb fb fb fb fb fb fc
    > [  +0.000014]  ffff8881b8606080: fc fc fc fc fc fc fc fa fb fb fb fb fb fb fb fb
    > [  +0.000013] &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;
    > The issue reproduced on VG20 during the IGT pci_unplug test.
    > The root cause of the issue is that the function drm_sched_fini is called before drm_sched_entity_kill.
    > In drm_sched_fini, the drm_sched_rq structure is freed, but this structure is later accessed by
    > each entity within the run queue, leading to invalid memory access.
    > To resolve this, the order of cleanup calls is updated:
    > Before:
    > amdgpu_fence_driver_sw_fini
    > amdgpu_device_ip_fini
    > After:
    > amdgpu_device_ip_fini
    > amdgpu_fence_driver_sw_fini
    > This updated order ensures that all entities in the IPs are cleaned up first, followed by proper
    > cleanup of the schedulers.
    > Additional Investigation:
    > During debugging, another issue was identified in the amdgpu_vce_sw_fini function. The vce.vcpu_bo
    > buffer must be freed only as the final step in the cleanup process to prevent any premature
    > access during earlier cleanup stages.
    > v2: Using Christian suggestion call drm_sched_entity_destroy before drm_sched_fini.
    > Cc: Christian König &lt;christian.koenig@amd.com&gt;
    > Cc: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Signed-off-by: Vitaly Prosyak &lt;vitaly.prosyak@amd.com&gt;
    > Reviewed-by: Christian König &lt;christian.koenig@amd.com&gt;
    > Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ drm/amd: Fix initialization mistake for NBIO 7.11 devices (@Mario Limonciello in [6209e4178aeaea4](https://github.com/sophgo/linux-riscv/commit/6209e4178aeaea4) at 2024-12-09 09:41:15)
    > commit 349af06a3abd0bb3787ee2daf3ac508412fe8dcc upstream.
    > There is a strapping issue on NBIO 7.11.x that can lead to spurious PME
    > events while in the D0 state.
    > Cc: stable@vger.kernel.org
    > Reviewed-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Link: https://lore.kernel.org/r/20241118174611.10700-2-mario.limonciello@amd.com
    > Signed-off-by: Mario Limonciello &lt;mario.limonciello@amd.com&gt;
    > Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ drm/amd/pm: Remove arcturus min power limit (@Lijo Lazar in [08e5f8e1a24fb1f](https://github.com/sophgo/linux-riscv/commit/08e5f8e1a24fb1f) at 2024-12-09 09:41:15)
    > commit da868898cf4c5ddbd1f7406e356edce5d7211eb5 upstream.
    > As per power team, there is no need to impose a lower bound on arcturus
    > power limit. Any unreasonable limit set will result in frequent
    > throttling.
    > Signed-off-by: Lijo Lazar &lt;lijo.lazar@amd.com&gt;
    > Reviewed-by: Kenneth Feng &lt;kenneth.feng@amd.com&gt;
    > Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ drm/amdkfd: Use the correct wptr size (@Lijo Lazar in [ff34c909ed3fb97](https://github.com/sophgo/linux-riscv/commit/ff34c909ed3fb97) at 2024-12-09 09:41:14)
    > commit cdc6705f98ea3f854a60ba8c9b19228e197ae384 upstream.
    > Write pointer could be 32-bit or 64-bit. Use the correct size during
    > initialization.
    > Signed-off-by: Lijo Lazar &lt;lijo.lazar@amd.com&gt;
    > Acked-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ Revert &quot;drm/radeon: Delay Connector detecting when HPD singals is unstable&quot; (@Alex Deucher in [f6f6bcb4e228188](https://github.com/sophgo/linux-riscv/commit/f6f6bcb4e228188) at 2024-12-09 09:41:14)
    > commit 979bfe291b5b30a9132c2fd433247e677b24c6aa upstream.
    > This reverts commit 949658cb9b69ab9d22a42a662b2fdc7085689ed8.
    > This causes a blank screen on boot.
    > Closes: https://gitlab.freedesktop.org/drm/amd/-/issues/3696
    > Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Cc: Shixiong Ou &lt;oushixiong@kylinos.cn&gt;
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ drm/amd: Add some missing straps from NBIO 7.11.0 (@Mario Limonciello in [be51376b1f500f4](https://github.com/sophgo/linux-riscv/commit/be51376b1f500f4) at 2024-12-09 09:41:14)
    > commit 902fbbf429b8213232b18de0ddfd5c0f3851cb8f upstream.
    > Earlier ASICs have strap information exported, and this is missing
    > for NBIO 7.11.0.
    > Cc: stable@vger.kernel.org
    > Reviewed-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Fixes: ca8c68142ad8 (&quot;drm/amdgpu: add nbio 7.11 registers&quot;)
    > Link: https://lore.kernel.org/r/20241118174611.10700-1-mario.limonciello@amd.com
    > Signed-off-by: Mario Limonciello &lt;mario.limonciello@amd.com&gt;
    > Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ drm/amdgpu/pm: add gen5 display to the user on smu v14.0.2/3 (@Kenneth Feng in [a4f2599ef70fe8a](https://github.com/sophgo/linux-riscv/commit/a4f2599ef70fe8a) at 2024-12-09 09:41:14)
    > commit 6719ab8234ce4b0c0e9aa93aaa94961e5b2bc852 upstream.
    > add gen5 display to the user on smu v14.0.2/3
    > Signed-off-by: Kenneth Feng &lt;kenneth.feng@amd.com&gt;
    > Reviewed-by: Yang Wang &lt;kevinyang.wang@amd.com&gt;
    > Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Cc: stable@vger.kernel.org # 6.11.x
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ drm/xe/guc_submit: fix race around suspend_pending (@Matthew Auld in [5ddcb50b700221f](https://github.com/sophgo/linux-riscv/commit/5ddcb50b700221f) at 2024-12-09 09:41:14)
    > commit 87651f31ae4e6e6e7e6c7270b9b469405e747407 upstream.
    > Currently in some testcases we can trigger:
    > xe 0000:03:00.0: [drm] Assertion &#x60;exec_queue_destroyed(q)&#x60; failed!
    > ....
    > WARNING: CPU: 18 PID: 2640 at drivers/gpu/drm/xe/xe_guc_submit.c:1826 xe_guc_sched_done_handler+0xa54/0xef0 [xe]
    > xe 0000:03:00.0: [drm] *ERROR* GT1: DEREGISTER_DONE: Unexpected engine state 0x00a1, guc_id&#x3D;57
    > Looking at a snippet of corresponding ftrace for this GuC id we can see:
    > 162.673311: xe_sched_msg_add:     dev&#x3D;0000:03:00.0, gt&#x3D;1 guc_id&#x3D;57, opcode&#x3D;3
    > 162.673317: xe_sched_msg_recv:    dev&#x3D;0000:03:00.0, gt&#x3D;1 guc_id&#x3D;57, opcode&#x3D;3
    > 162.673319: xe_exec_queue_scheduling_disable: dev&#x3D;0000:03:00.0, 1:0x2, gt&#x3D;1, width&#x3D;1, guc_id&#x3D;57, guc_state&#x3D;0x29, flags&#x3D;0x0
    > 162.674089: xe_exec_queue_kill:   dev&#x3D;0000:03:00.0, 1:0x2, gt&#x3D;1, width&#x3D;1, guc_id&#x3D;57, guc_state&#x3D;0x29, flags&#x3D;0x0
    > 162.674108: xe_exec_queue_close:  dev&#x3D;0000:03:00.0, 1:0x2, gt&#x3D;1, width&#x3D;1, guc_id&#x3D;57, guc_state&#x3D;0xa9, flags&#x3D;0x0
    > 162.674488: xe_exec_queue_scheduling_done: dev&#x3D;0000:03:00.0, 1:0x2, gt&#x3D;1, width&#x3D;1, guc_id&#x3D;57, guc_state&#x3D;0xa9, flags&#x3D;0x0
    > 162.678452: xe_exec_queue_deregister: dev&#x3D;0000:03:00.0, 1:0x2, gt&#x3D;1, width&#x3D;1, guc_id&#x3D;57, guc_state&#x3D;0xa1, flags&#x3D;0x0
    > It looks like we try to suspend the queue (opcode&#x3D;3), setting
    > suspend_pending and triggering a disable_scheduling. The user then
    > closes the queue. However the close will also forcefully signal the
    > suspend fence after killing the queue, later when the G2H response for
    > disable_scheduling comes back we have now cleared suspend_pending when
    > signalling the suspend fence, so the disable_scheduling now incorrectly
    > tries to also deregister the queue. This leads to warnings since the queue
    > has yet to even be marked for destruction. We also seem to trigger
    > errors later with trying to double unregister the same queue.
    > To fix this tweak the ordering when handling the response to ensure we
    > don&#x27;t race with a disable_scheduling that didn&#x27;t actually intend to
    > perform an unregister.  The destruction path should now also correctly
    > wait for any pending_disable before marking as destroyed.
    > Fixes: dd08ebf6c352 (&quot;drm/xe: Introduce a new DRM driver for Intel GPUs&quot;)
    > Closes: https://gitlab.freedesktop.org/drm/xe/kernel/-/issues/3371
    > Signed-off-by: Matthew Auld &lt;matthew.auld@intel.com&gt;
    > Cc: Matthew Brost &lt;matthew.brost@intel.com&gt;
    > Cc: &lt;stable@vger.kernel.org&gt; # v6.8+
    > Reviewed-by: Matthew Brost &lt;matthew.brost@intel.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20241122161914.321263-6-matthew.auld@intel.com
    > (cherry picked from commit f161809b362f027b6d72bd998e47f8f0bad60a2e)
    > Signed-off-by: Thomas Hellström &lt;thomas.hellstrom@linux.intel.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ drm/xe/migrate: use XE_BO_FLAG_PAGETABLE (@Matthew Auld in [1c052c66461f0bf](https://github.com/sophgo/linux-riscv/commit/1c052c66461f0bf) at 2024-12-09 09:41:14)
    > commit c78f4399188369a55eed69cbf19a8aad2a65ac75 upstream.
    > On some HW we want to avoid the host caching PTEs, since access from GPU
    > side can be incoherent. However here the special migrate object is
    > mapping PTEs which are written from the host and potentially cached. Use
    > XE_BO_FLAG_PAGETABLE to ensure that non-cached mapping is used, on
    > platforms where this matters.
    > Fixes: 7a060d786cc1 (&quot;drm/xe/mtl: Map PPGTT as CPU:WC&quot;)
    > Signed-off-by: Matthew Auld &lt;matthew.auld@intel.com&gt;
    > Cc: Matthew Brost &lt;matthew.brost@intel.com&gt;
    > Cc: Nirmoy Das &lt;nirmoy.das@intel.com&gt;
    > Cc: &lt;stable@vger.kernel.org&gt; # v6.8+
    > Reviewed-by: Nirmoy Das &lt;nirmoy.das@intel.com&gt;
    > Reviewed-by: Matthew Brost &lt;matthew.brost@intel.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20241126181259.159713-4-matthew.auld@intel.com
    > (cherry picked from commit febc689b27d28973cd02f667548a5dca383d859a)
    > Signed-off-by: Thomas Hellström &lt;thomas.hellstrom@linux.intel.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ drm/bridge: it6505: Fix inverted reset polarity (@Chen-Yu Tsai in [e1f0df8ba6f511a](https://github.com/sophgo/linux-riscv/commit/e1f0df8ba6f511a) at 2024-12-09 09:41:13)
    > commit c5f3f21728b069412e8072b8b1d0a3d9d3ab0265 upstream.
    > The IT6505 bridge chip has a active low reset line. Since it is a
    > &quot;reset&quot; and not an &quot;enable&quot; line, the GPIO should be asserted to
    > put it in reset and deasserted to bring it out of reset during
    > the power on sequence.
    > The polarity was inverted when the driver was first introduced, likely
    > because the device family that was targeted had an inverting level
    > shifter on the reset line.
    > The MT8186 Corsola devices already have the IT6505 in their device tree,
    > but the whole display pipeline is actually disabled and won&#x27;t be enabled
    > until some remaining issues are sorted out. The other known user is
    > the MT8183 Kukui / Jacuzzi family; their device trees currently do not
    > have the IT6505 included.
    > Fix the polarity in the driver while there are no actual users.
    > Fixes: b5c84a9edcd4 (&quot;drm/bridge: add it6505 driver&quot;)
    > Cc: stable@vger.kernel.org
    > Reviewed-by: Dmitry Baryshkov &lt;dmitry.baryshkov@linaro.org&gt;
    > Reviewed-by: Neil Armstrong &lt;neil.armstrong@linaro.org&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20241029095411.657616-1-wenst@chromium.org
    > Signed-off-by: Chen-Yu Tsai &lt;wenst@chromium.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ drm/xe/xe_guc_ads: save/restore OA registers and allowlist regs (@Jonathan Cavitt in [cb56ef805f44b18](https://github.com/sophgo/linux-riscv/commit/cb56ef805f44b18) at 2024-12-09 09:41:13)
    > commit 55858fa7eb2f163f7aa34339fd3399ba4ff564c6 upstream.
    > Several OA registers and allowlist registers were missing from the
    > save/restore list for GuC and could be lost during an engine reset.  Add
    > them to the list.
    > v2:
    > - Fix commit message (Umesh)
    > - Add missing closes (Ashutosh)
    > v3:
    > - Add missing fixes (Ashutosh)
    > Closes: https://gitlab.freedesktop.org/drm/xe/kernel/-/issues/2249
    > Fixes: dd08ebf6c352 (&quot;drm/xe: Introduce a new DRM driver for Intel GPUs&quot;)
    > Suggested-by: Umesh Nerlige Ramappa &lt;umesh.nerlige.ramappa@intel.com&gt;
    > Suggested-by: John Harrison &lt;john.c.harrison@intel.com&gt;
    > Signed-off-by: Jonathan Cavitt &lt;jonathan.cavitt@intel.com&gt;
    > CC: stable@vger.kernel.org # v6.11+
    > Reviewed-by: Umesh Nerlige Ramappa &lt;umesh.nerlige.ramappa@intel.com&gt;
    > Reviewed-by: Ashutosh Dixit &lt;ashutosh.dixit@intel.com&gt;
    > Signed-off-by: Ashutosh Dixit &lt;ashutosh.dixit@intel.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20241023200716.82624-1-jonathan.cavitt@intel.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ drm/xe/migrate: fix pat index usage (@Matthew Auld in [b940b6516bc2122](https://github.com/sophgo/linux-riscv/commit/b940b6516bc2122) at 2024-12-09 09:41:13)
    > commit 23346f85163de83aca6dc30dde3944131cf54706 upstream.
    > XE_CACHE_WB must be converted into the per-platform pat index for that
    > particular caching mode, otherwise we are just encoding whatever happens
    > to be the value of that enum.
    > Fixes: e8babb280b5e (&quot;drm/xe: Convert multiple bind ops into single job&quot;)
    > Signed-off-by: Matthew Auld &lt;matthew.auld@intel.com&gt;
    > Cc: Matthew Brost &lt;matthew.brost@intel.com&gt;
    > Cc: Nirmoy Das &lt;nirmoy.das@intel.com&gt;
    > Cc: &lt;stable@vger.kernel.org&gt; # v6.12+
    > Reviewed-by: Nirmoy Das &lt;nirmoy.das@intel.com&gt;
    > Reviewed-by: Matthew Brost &lt;matthew.brost@intel.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20241126181259.159713-3-matthew.auld@intel.com
    > (cherry picked from commit f3dc9246f9c3cd5a7d8fd70cfd805bfc52214e2e)
    > Signed-off-by: Thomas Hellström &lt;thomas.hellstrom@linux.intel.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ drm/etnaviv: flush shader L1 cache after user commandstream (@Lucas Stach in [96c308559eedcea](https://github.com/sophgo/linux-riscv/commit/96c308559eedcea) at 2024-12-09 09:41:13)
    > commit 4f8dbadef085ab447a01a8d4806a3f629fea05ed upstream.
    > The shader L1 cache is a writeback cache for shader loads/stores
    > and thus must be flushed before any BOs backing the shader buffers
    > are potentially freed.
    > Cc: stable@vger.kernel.org
    > Reviewed-by: Christian Gmeiner &lt;cgmeiner@igalia.com&gt;
    > Signed-off-by: Lucas Stach &lt;l.stach@pengutronix.de&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ drm/mediatek: Fix child node refcount handling in early exit (@Javier Carrasco in [576fe9345d0a630](https://github.com/sophgo/linux-riscv/commit/576fe9345d0a630) at 2024-12-09 09:41:13)
    > commit f708e8b4cfd16e5c8cd8d7fcfcb2fb2c6ed93af3 upstream.
    > Early exits (goto, break, return) from for_each_child_of_node() required
    > an explicit call to of_node_put(), which was not introduced with the
    > break if cnt &#x3D;&#x3D; MAX_CRTC.
    > Add the missing of_node_put() before the break.
    > Cc: stable@vger.kernel.org
    > Fixes: d761b9450e31 (&quot;drm/mediatek: Add cnt checking for coverity issue&quot;)
    > Signed-off-by: Javier Carrasco &lt;javier.carrasco.cruz@gmail.com&gt;
    > Reviewed-by: CK Hu &lt;ck.hu@mediatek.com&gt;
    > Reviewed-by: Chen-Yu Tsai &lt;wenst@chromium.org&gt;
    > Reviewed-by: AngeloGioacchino Del Regno &lt;angelogioacchino.delregno@collabora.com&gt;
    > Link: https://patchwork.kernel.org/project/dri-devel/patch/20241011-mtk_drm_drv_memleak-v1-1-2b40c74c8d75@gmail.com/
    > Signed-off-by: Chun-Kuang Hu &lt;chunkuang.hu@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ drm: xlnx: zynqmp_dpsub: fix hotplug detection (@Steffen Dirkwinkel in [2719fe94d28c62b](https://github.com/sophgo/linux-riscv/commit/2719fe94d28c62b) at 2024-12-09 09:41:13)
    > commit 71ba1c9b1c717831920c3d432404ee5a707e04b4 upstream.
    > drm_kms_helper_poll_init needs to be called after zynqmp_dpsub_kms_init.
    > zynqmp_dpsub_kms_init creates the connector and without it we don&#x27;t
    > enable hotplug detection.
    > Fixes: eb2d64bfcc17 (&quot;drm: xlnx: zynqmp_dpsub: Report HPD through the bridge&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Steffen Dirkwinkel &lt;s.dirkwinkel@beckhoff.com&gt;
    > Signed-off-by: Tomi Valkeinen &lt;tomi.valkeinen@ideasonboard.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20241028134218.54727-1-lists@steffen.cc
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ drm: panel: jd9365da-h3: Remove unused num_init_cmds structure member (@Hugo Villeneuve in [faf6c1caf58086f](https://github.com/sophgo/linux-riscv/commit/faf6c1caf58086f) at 2024-12-09 09:41:12)
    > commit 66ae275365be4f118abe2254a0ced1d913af93f2 upstream.
    > Now that the driver has been converted to use wrapped MIPI DCS functions,
    > the num_init_cmds structure member is no longer needed, so remove it.
    > Fixes: 35583e129995 (&quot;drm/panel: panel-jadard-jd9365da-h3: use wrapped MIPI DCS functions&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Hugo Villeneuve &lt;hvilleneuve@dimonoff.com&gt;
    > Reviewed-by: Neil Armstrong &lt;neil.armstrong@linaro.org&gt;
    > Reviewed-by: Jessica Zhang &lt;quic_jesszhan@quicinc.com&gt;
    > Link: https://lore.kernel.org/r/20240930170503.1324560-1-hugo@hugovil.com
    > Signed-off-by: Neil Armstrong &lt;neil.armstrong@linaro.org&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20240930170503.1324560-1-hugo@hugovil.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ drm/sti: avoid potential dereference of error pointers (@Ma Ke in [f67786293193cf0](https://github.com/sophgo/linux-riscv/commit/f67786293193cf0) at 2024-12-09 09:41:12)
    > commit 831214f77037de02afc287eae93ce97f218d8c04 upstream.
    > The return value of drm_atomic_get_crtc_state() needs to be
    > checked. To avoid use of error pointer &#x27;crtc_state&#x27; in case
    > of the failure.
    > Cc: stable@vger.kernel.org
    > Fixes: dd86dc2f9ae1 (&quot;drm/sti: implement atomic_check for the planes&quot;)
    > Signed-off-by: Ma Ke &lt;make24@iscas.ac.cn&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20240913090412.2022848-1-make24@iscas.ac.cn
    > Signed-off-by: Alain Volmat &lt;alain.volmat@foss.st.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ drm/sti: avoid potential dereference of error pointers in sti_hqvdp_atomic_check (@Ma Ke in [837eb99ad3340c7](https://github.com/sophgo/linux-riscv/commit/837eb99ad3340c7) at 2024-12-09 09:41:12)
    > commit c1ab40a1fdfee732c7e6ff2fb8253760293e47e8 upstream.
    > The return value of drm_atomic_get_crtc_state() needs to be
    > checked. To avoid use of error pointer &#x27;crtc_state&#x27; in case
    > of the failure.
    > Cc: stable@vger.kernel.org
    > Fixes: dd86dc2f9ae1 (&quot;drm/sti: implement atomic_check for the planes&quot;)
    > Signed-off-by: Ma Ke &lt;make24@iscas.ac.cn&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20240913090926.2023716-1-make24@iscas.ac.cn
    > Signed-off-by: Alain Volmat &lt;alain.volmat@foss.st.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ net: fec: make PPS channel configurable (@Francesco Dolcini in [742ae9253ca8f81](https://github.com/sophgo/linux-riscv/commit/742ae9253ca8f81) at 2024-12-09 09:41:12)
    > commit 566c2d83887f0570056833102adc5b88e681b0c7 upstream.
    > Depending on the SoC where the FEC is integrated into the PPS channel
    > might be routed to different timer instances. Make this configurable
    > from the devicetree.
    > When the related DT property is not present fallback to the previous
    > default and use channel 0.
    > Reviewed-by: Frank Li &lt;Frank.Li@nxp.com&gt;
    > Tested-by: Rafael Beims &lt;rafael.beims@toradex.com&gt;
    > Signed-off-by: Francesco Dolcini &lt;francesco.dolcini@toradex.com&gt;
    > Reviewed-by: Csókás, Bence &lt;csokas.bence@prolan.hu&gt;
    > Signed-off-by: Paolo Abeni &lt;pabeni@redhat.com&gt;
    > Signed-off-by: Csókás, Bence &lt;csokas.bence@prolan.hu&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ drm/panic: Fix uninitialized spinlock acquisition with CONFIG_DRM_PANIC&#x3D;n (@Lyude Paul in [73292e8e61874d1](https://github.com/sophgo/linux-riscv/commit/73292e8e61874d1) at 2024-12-09 09:41:12)
    > commit 319e53f155907cf2c6dabc16ec9dce0179bc04d1 upstream.
    > It turns out that if you happen to have a kernel config where
    > CONFIG_DRM_PANIC is disabled and spinlock debugging is enabled, along with
    > KMS being enabled - we&#x27;ll end up trying to acquire an uninitialized
    > spin_lock with drm_panic_lock() when we try to do a commit:
    > rvkms rvkms.0: [drm:drm_atomic_commit] committing 0000000068d2ade1
    > INFO: trying to register non-static key.
    > The code is fine but needs lockdep annotation, or maybe
    > you didn&#x27;t initialize this object before use?
    > turning off the locking correctness validator.
    > CPU: 4 PID: 1347 Comm: modprobe Not tainted 6.10.0-rc1Lyude-Test+ #272
    > Hardware name: QEMU Standard PC (Q35 + ICH9, 2009), BIOS edk2-20240524-3.fc40 05/24/2024
    > Call Trace:
    > &lt;TASK&gt;
    > dump_stack_lvl+0x77/0xa0
    > assign_lock_key+0x114/0x120
    > register_lock_class+0xa8/0x2c0
    > __lock_acquire+0x7d/0x2bd0
    > ? __vmap_pages_range_noflush+0x3a8/0x550
    > ? drm_atomic_helper_swap_state+0x2ad/0x3a0
    > lock_acquire+0xec/0x290
    > ? drm_atomic_helper_swap_state+0x2ad/0x3a0
    > ? lock_release+0xee/0x310
    > _raw_spin_lock_irqsave+0x4e/0x70
    > ? drm_atomic_helper_swap_state+0x2ad/0x3a0
    > drm_atomic_helper_swap_state+0x2ad/0x3a0
    > drm_atomic_helper_commit+0xb1/0x270
    > drm_atomic_commit+0xaf/0xe0
    > ? __pfx___drm_printfn_info+0x10/0x10
    > drm_client_modeset_commit_atomic+0x1a1/0x250
    > drm_client_modeset_commit_locked+0x4b/0x180
    > drm_client_modeset_commit+0x27/0x50
    > __drm_fb_helper_restore_fbdev_mode_unlocked+0x76/0x90
    > drm_fb_helper_set_par+0x38/0x40
    > fbcon_init+0x3c4/0x690
    > visual_init+0xc0/0x120
    > do_bind_con_driver+0x409/0x4c0
    > do_take_over_console+0x233/0x280
    > do_fb_registered+0x11f/0x210
    > fbcon_fb_registered+0x2c/0x60
    > register_framebuffer+0x248/0x2a0
    > __drm_fb_helper_initial_config_and_unlock+0x58a/0x720
    > drm_fbdev_generic_client_hotplug+0x6e/0xb0
    > drm_client_register+0x76/0xc0
    > _RNvXs_CsHeezP08sTT_5rvkmsNtB4_5RvkmsNtNtCs1cdwasc6FUb_6kernel8platform6Driver5probe+0xed2/0x1060 [rvkms]
    > ? _RNvMs_NtCs1cdwasc6FUb_6kernel8platformINtB4_7AdapterNtCsHeezP08sTT_5rvkms5RvkmsE14probe_callbackBQ_+0x2b/0x70 [rvkms]
    > ? acpi_dev_pm_attach+0x25/0x110
    > ? platform_probe+0x6a/0xa0
    > ? really_probe+0x10b/0x400
    > ? __driver_probe_device+0x7c/0x140
    > ? driver_probe_device+0x22/0x1b0
    > ? __device_attach_driver+0x13a/0x1c0
    > ? __pfx___device_attach_driver+0x10/0x10
    > ? bus_for_each_drv+0x114/0x170
    > ? __device_attach+0xd6/0x1b0
    > ? bus_probe_device+0x9e/0x120
    > ? device_add+0x288/0x4b0
    > ? platform_device_add+0x75/0x230
    > ? platform_device_register_full+0x141/0x180
    > ? rust_helper_platform_device_register_simple+0x85/0xb0
    > ? _RNvMs2_NtCs1cdwasc6FUb_6kernel8platformNtB5_6Device13create_simple+0x1d/0x60
    > ? _RNvXs0_CsHeezP08sTT_5rvkmsNtB5_5RvkmsNtCs1cdwasc6FUb_6kernel6Module4init+0x11e/0x160 [rvkms]
    > ? 0xffffffffc083f000
    > ? init_module+0x20/0x1000 [rvkms]
    > ? kernfs_xattr_get+0x3e/0x80
    > ? do_one_initcall+0x148/0x3f0
    > ? __lock_acquire+0x5ef/0x2bd0
    > ? __lock_acquire+0x5ef/0x2bd0
    > ? __lock_acquire+0x5ef/0x2bd0
    > ? put_cpu_partial+0x51/0x1d0
    > ? lock_acquire+0xec/0x290
    > ? put_cpu_partial+0x51/0x1d0
    > ? lock_release+0xee/0x310
    > ? put_cpu_partial+0x51/0x1d0
    > ? fs_reclaim_acquire+0x69/0xf0
    > ? lock_acquire+0xec/0x290
    > ? fs_reclaim_acquire+0x69/0xf0
    > ? kfree+0x22f/0x340
    > ? lock_release+0xee/0x310
    > ? kmalloc_trace_noprof+0x48/0x340
    > ? do_init_module+0x22/0x240
    > ? kmalloc_trace_noprof+0x155/0x340
    > ? do_init_module+0x60/0x240
    > ? __se_sys_finit_module+0x2e0/0x3f0
    > ? do_syscall_64+0xa4/0x180
    > ? syscall_exit_to_user_mode+0x108/0x140
    > ? do_syscall_64+0xb0/0x180
    > ? vma_end_read+0xd0/0xe0
    > ? do_user_addr_fault+0x309/0x640
    > ? clear_bhb_loop+0x45/0xa0
    > ? clear_bhb_loop+0x45/0xa0
    > ? clear_bhb_loop+0x45/0xa0
    > ? entry_SYSCALL_64_after_hwframe+0x76/0x7e
    > &lt;/TASK&gt;
    > Fix this by stubbing these macros out when this config option isn&#x27;t
    > enabled, along with fixing the unused variable warning that introduces.
    > Signed-off-by: Lyude Paul &lt;lyude@redhat.com&gt;
    > Reviewed-by: Daniel Vetter &lt;daniel.vetter@ffwll.ch&gt;
    > Fixes: e2a1cda3e0c7 (&quot;drm/panic: Add drm panic locking&quot;)
    > Cc: &lt;stable@vger.kernel.org&gt; # v6.10+
    > Link: https://patchwork.freedesktop.org/patch/msgid/20240916230103.611490-1-lyude@redhat.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ drm/sti: avoid potential dereference of error pointers in sti_gdp_atomic_check (@Ma Ke in [3cf2e7c448e246f](https://github.com/sophgo/linux-riscv/commit/3cf2e7c448e246f) at 2024-12-09 09:41:12)
    > commit e965e771b069421c233d674c3c8cd8c7f7245f42 upstream.
    > The return value of drm_atomic_get_crtc_state() needs to be
    > checked. To avoid use of error pointer &#x27;crtc_state&#x27; in case
    > of the failure.
    > Cc: stable@vger.kernel.org
    > Fixes: dd86dc2f9ae1 (&quot;drm/sti: implement atomic_check for the planes&quot;)
    > Signed-off-by: Ma Ke &lt;make24@iscas.ac.cn&gt;
    > Acked-by: Alain Volmat &lt;alain.volmat@foss.st.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20240909063359.1197065-1-make24@iscas.ac.cn
    > Signed-off-by: Alain Volmat &lt;alain.volmat@foss.st.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ drm/fbdev-dma: Select FB_DEFERRED_IO (@Thomas Zimmermann in [22fd2377b9ceeda](https://github.com/sophgo/linux-riscv/commit/22fd2377b9ceeda) at 2024-12-09 09:41:12)
    > commit 67c40c9b2ec5f375bf78274d4e9ef0e3b8315bea upstream.
    > Commit 808a40b69468 (&quot;drm/fbdev-dma: Implement damage handling and
    > deferred I/O&quot;) added deferred I/O for fbdev-dma. Also select the
    > Kconfig symbol FB_DEFERRED_IO (via FB_DMAMEM_HELPERS_DEFERRED). Fixes
    > build errors about missing fbdefio, such as
    > drivers/gpu/drm/drm_fbdev_dma.c:218:26: error: &#x27;struct drm_fb_helper&#x27; has no member named &#x27;fbdefio&#x27;
    > 218 |                 fb_helper-&gt;fbdefio.delay &#x3D; HZ / 20;
    > |                          ^~
    > drivers/gpu/drm/drm_fbdev_dma.c:219:26: error: &#x27;struct drm_fb_helper&#x27; has no member named &#x27;fbdefio&#x27;
    > 219 |                 fb_helper-&gt;fbdefio.deferred_io &#x3D; drm_fb_helper_deferred_io;
    > |                          ^~
    > drivers/gpu/drm/drm_fbdev_dma.c:221:21: error: &#x27;struct fb_info&#x27; has no member named &#x27;fbdefio&#x27;
    > 221 |                 info-&gt;fbdefio &#x3D; &amp;fb_helper-&gt;fbdefio;
    > |                     ^~
    > drivers/gpu/drm/drm_fbdev_dma.c:221:43: error: &#x27;struct drm_fb_helper&#x27; has no member named &#x27;fbdefio&#x27;
    > 221 |                 info-&gt;fbdefio &#x3D; &amp;fb_helper-&gt;fbdefio;
    > |                                           ^~
    > Signed-off-by: Thomas Zimmermann &lt;tzimmermann@suse.de&gt;
    > Reported-by: kernel test robot &lt;lkp@intel.com&gt;
    > Closes: https://lore.kernel.org/oe-kbuild-all/202410050241.Mox9QRjP-lkp@intel.com/
    > Fixes: 808a40b69468 (&quot;drm/fbdev-dma: Implement damage handling and deferred I/O&quot;)
    > Cc: Thomas Zimmermann &lt;tzimmermann@suse.de&gt;
    > Cc: Javier Martinez Canillas &lt;javierm@redhat.com&gt;
    > Cc: Maarten Lankhorst &lt;maarten.lankhorst@linux.intel.com&gt;
    > Cc: Maxime Ripard &lt;mripard@kernel.org&gt;
    > Cc: &lt;stable@vger.kernel.org&gt; # v6.11+
    > Reviewed-by: Jonathan Cavitt &lt;jonathan.cavitt@intel.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20241014085740.582287-4-tzimmermann@suse.de
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ binder: allow freeze notification for dead nodes (@Carlos Llamas in [f3cf682d3a97815](https://github.com/sophgo/linux-riscv/commit/f3cf682d3a97815) at 2024-12-09 09:41:11)
    > commit ca63c66935b978441055e3d87d30225267f99329 upstream.
    > Alice points out that binder_request_freeze_notification() should not
    > return EINVAL when the relevant node is dead [1]. The node can die at
    > any point even if the user input is valid. Instead, allow the request
    > to be allocated but skip the initial notification for dead nodes. This
    > avoids propagating unnecessary errors back to userspace.
    > Fixes: d579b04a52a1 (&quot;binder: frozen notification&quot;)
    > Cc: stable@vger.kernel.org
    > Suggested-by: Alice Ryhl &lt;aliceryhl@google.com&gt;
    > Link: https://lore.kernel.org/all/CAH5fLghapZJ4PbbkC8V5A6Zay-_sgTzwVpwqk6RWWUNKKyJC_Q@mail.gmail.com/ [1]
    > Signed-off-by: Carlos Llamas &lt;cmllamas@google.com&gt;
    > Acked-by: Todd Kjos &lt;tkjos@google.com&gt;
    > Link: https://lore.kernel.org/r/20240926233632.821189-7-cmllamas@google.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ dt-bindings: net: fec: add pps channel property (@Francesco Dolcini in [e8139c66df98e9e](https://github.com/sophgo/linux-riscv/commit/e8139c66df98e9e) at 2024-12-09 09:41:11)
    > commit 1aa772be0444a2bd06957f6d31865e80e6ae4244 upstream.
    > Add fsl,pps-channel property to select where to connect the PPS signal.
    > This depends on the internal SoC routing and on the board, for example
    > on the i.MX8 SoC it can be connected to an external pin (using channel 1)
    > or to internal eDMA as DMA request (channel 0).
    > Signed-off-by: Francesco Dolcini &lt;francesco.dolcini@toradex.com&gt;
    > Acked-by: Conor Dooley &lt;conor.dooley@microchip.com&gt;
    > Signed-off-by: Paolo Abeni &lt;pabeni@redhat.com&gt;
    > Signed-off-by: Csókás, Bence &lt;csokas.bence@prolan.hu&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ binder: fix memleak of proc-&gt;delivered_freeze (@Carlos Llamas in [b8b77712142fb14](https://github.com/sophgo/linux-riscv/commit/b8b77712142fb14) at 2024-12-09 09:41:11)
    > commit 1db76ec2b4b206ff943e292a0b55e68ff3443598 upstream.
    > If a freeze notification is cleared with BC_CLEAR_FREEZE_NOTIFICATION
    > before calling binder_freeze_notification_done(), then it is detached
    > from its reference (e.g. ref-&gt;freeze) but the work remains queued in
    > proc-&gt;delivered_freeze. This leads to a memory leak when the process
    > exits as any pending entries in proc-&gt;delivered_freeze are not freed:
    > unreferenced object 0xffff38e8cfa36180 (size 64):
    > comm &quot;binder-util&quot;, pid 655, jiffies 4294936641
    > hex dump (first 32 bytes):
    > b8 e9 9e c8 e8 38 ff ff b8 e9 9e c8 e8 38 ff ff  .....8.......8..
    > 0b 00 00 00 00 00 00 00 3c 1f 4b 00 00 00 00 00  ........&lt;.K.....
    > backtrace (crc 95983b32):
    > [&lt;000000000d0582cf&gt;] kmemleak_alloc+0x34/0x40
    > [&lt;000000009c99a513&gt;] __kmalloc_cache_noprof+0x208/0x280
    > [&lt;00000000313b1704&gt;] binder_thread_write+0xdec/0x439c
    > [&lt;000000000cbd33bb&gt;] binder_ioctl+0x1b68/0x22cc
    > [&lt;000000002bbedeeb&gt;] __arm64_sys_ioctl+0x124/0x190
    > [&lt;00000000b439adee&gt;] invoke_syscall+0x6c/0x254
    > [&lt;00000000173558fc&gt;] el0_svc_common.constprop.0+0xac/0x230
    > [&lt;0000000084f72311&gt;] do_el0_svc+0x40/0x58
    > [&lt;000000008b872457&gt;] el0_svc+0x38/0x78
    > [&lt;00000000ee778653&gt;] el0t_64_sync_handler+0x120/0x12c
    > [&lt;00000000a8ec61bf&gt;] el0t_64_sync+0x190/0x194
    > This patch fixes the leak by ensuring that any pending entries in
    > proc-&gt;delivered_freeze are freed during binder_deferred_release().
    > Fixes: d579b04a52a1 (&quot;binder: frozen notification&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Carlos Llamas &lt;cmllamas@google.com&gt;
    > Reviewed-by: Alice Ryhl &lt;aliceryhl@google.com&gt;
    > Acked-by: Todd Kjos &lt;tkjos@google.com&gt;
    > Link: https://lore.kernel.org/r/20240926233632.821189-8-cmllamas@google.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ binder: fix BINDER_WORK_FROZEN_BINDER debug logs (@Carlos Llamas in [af8a8044b09a6f4](https://github.com/sophgo/linux-riscv/commit/af8a8044b09a6f4) at 2024-12-09 09:41:11)
    > commit 830d7db744b42c693bf1db7e94db86d7efd91f0e upstream.
    > The BINDER_WORK_FROZEN_BINDER type is not handled in the binder_logs
    > entries and it shows up as &quot;unknown work&quot; when logged:
    > proc 649
    > context binder-test
    > thread 649: l 00 need_return 0 tr 0
    > ref 13: desc 1 node 8 s 1 w 0 d 0000000053c4c0c3
    > unknown work: type 10
    > This patch add the freeze work type and is now logged as such:
    > proc 637
    > context binder-test
    > thread 637: l 00 need_return 0 tr 0
    > ref 8: desc 1 node 3 s 1 w 0 d 00000000dc39e9c6
    > has frozen binder
    > Fixes: d579b04a52a1 (&quot;binder: frozen notification&quot;)
    > Cc: stable@vger.kernel.org
    > Acked-by: Todd Kjos &lt;tkjos@google.com&gt;
    > Signed-off-by: Carlos Llamas &lt;cmllamas@google.com&gt;
    > Reviewed-by: Alice Ryhl &lt;aliceryhl@google.com&gt;
    > Link: https://lore.kernel.org/r/20240926233632.821189-5-cmllamas@google.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ net: fec: refactor PPS channel configuration (@Francesco Dolcini in [75d06a0404eebee](https://github.com/sophgo/linux-riscv/commit/75d06a0404eebee) at 2024-12-09 09:41:11)
    > commit bf8ca67e21671e7a56e31da45360480b28f185f1 upstream.
    > Preparation patch to allow for PPS channel configuration, no functional
    > change intended.
    > Signed-off-by: Francesco Dolcini &lt;francesco.dolcini@toradex.com&gt;
    > Reviewed-by: Frank Li &lt;Frank.Li@nxp.com&gt;
    > Reviewed-by: Csókás, Bence &lt;csokas.bence@prolan.hu&gt;
    > Signed-off-by: Paolo Abeni &lt;pabeni@redhat.com&gt;
    > Signed-off-by: Csókás, Bence &lt;csokas.bence@prolan.hu&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ binder: fix BINDER_WORK_CLEAR_FREEZE_NOTIFICATION debug logs (@Carlos Llamas in [648c92b1a898858](https://github.com/sophgo/linux-riscv/commit/648c92b1a898858) at 2024-12-09 09:41:11)
    > commit 595ea72efff9fa65bc52b6406e0822f90841f266 upstream.
    > proc 699
    > context binder-test
    > thread 699: l 00 need_return 0 tr 0
    > ref 25: desc 1 node 20 s 1 w 0 d 00000000c03e09a3
    > unknown work: type 11
    > proc 640
    > context binder-test
    > thread 640: l 00 need_return 0 tr 0
    > ref 8: desc 1 node 3 s 1 w 0 d 000000002bb493e1
    > has cleared freeze notification
    > Fixes: d579b04a52a1 (&quot;binder: frozen notification&quot;)
    > Cc: stable@vger.kernel.org
    > Suggested-by: Alice Ryhl &lt;aliceryhl@google.com&gt;
    > Signed-off-by: Carlos Llamas &lt;cmllamas@google.com&gt;
    > Reviewed-by: Alice Ryhl &lt;aliceryhl@google.com&gt;
    > Acked-by: Todd Kjos &lt;tkjos@google.com&gt;
    > Link: https://lore.kernel.org/r/20240926233632.821189-6-cmllamas@google.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ binder: add delivered_freeze to debugfs output (@Carlos Llamas in [0207180b59cda7d](https://github.com/sophgo/linux-riscv/commit/0207180b59cda7d) at 2024-12-09 09:41:11)
    > commit cb2aeb2ec25884133110ffe5a67ff3cf7dee5ceb upstream.
    > Add the pending proc-&gt;delivered_freeze work to the debugfs output. This
    > information was omitted in the original implementation of the freeze
    > notification and can be valuable for debugging issues.
    > Fixes: d579b04a52a1 (&quot;binder: frozen notification&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Carlos Llamas &lt;cmllamas@google.com&gt;
    > Acked-by: Todd Kjos &lt;tkjos@google.com&gt;
    > Reviewed-by: Alice Ryhl &lt;aliceryhl@google.com&gt;
    > Link: https://lore.kernel.org/r/20240926233632.821189-9-cmllamas@google.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ binder: fix freeze UAF in binder_release_work() (@Carlos Llamas in [fe39e0ea2d0ba7f](https://github.com/sophgo/linux-riscv/commit/fe39e0ea2d0ba7f) at 2024-12-09 09:41:10)
    > commit 7e20434cbca814cb91a0a261ca0106815ef48e5f upstream.
    > When a binder reference is cleaned up, any freeze work queued in the
    > associated process should also be removed. Otherwise, the reference is
    > freed while its ref-&gt;freeze.work is still queued in proc-&gt;work leading
    > to a use-after-free issue as shown by the following KASAN report:
    > &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;
    > BUG: KASAN: slab-use-after-free in binder_release_work+0x398/0x3d0
    > Read of size 8 at addr ffff31600ee91488 by task kworker/5:1/211
    > CPU: 5 UID: 0 PID: 211 Comm: kworker/5:1 Not tainted 6.11.0-rc7-00382-gfc6c92196396 #22
    > Hardware name: linux,dummy-virt (DT)
    > Workqueue: events binder_deferred_func
    > Call trace:
    > binder_release_work+0x398/0x3d0
    > binder_deferred_func+0xb60/0x109c
    > process_one_work+0x51c/0xbd4
    > worker_thread+0x608/0xee8
    > Allocated by task 703:
    > __kmalloc_cache_noprof+0x130/0x280
    > binder_thread_write+0xdb4/0x42a0
    > binder_ioctl+0x18f0/0x25ac
    > __arm64_sys_ioctl+0x124/0x190
    > invoke_syscall+0x6c/0x254
    > Freed by task 211:
    > kfree+0xc4/0x230
    > binder_deferred_func+0xae8/0x109c
    > process_one_work+0x51c/0xbd4
    > worker_thread+0x608/0xee8
    > &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;
    > This commit fixes the issue by ensuring any queued freeze work is removed
    > when cleaning up a binder reference.
    > Fixes: d579b04a52a1 (&quot;binder: frozen notification&quot;)
    > Cc: stable@vger.kernel.org
    > Acked-by: Todd Kjos &lt;tkjos@android.com&gt;
    > Reviewed-by: Alice Ryhl &lt;aliceryhl@google.com&gt;
    > Signed-off-by: Carlos Llamas &lt;cmllamas@google.com&gt;
    > Link: https://lore.kernel.org/r/20240926233632.821189-4-cmllamas@google.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ powerpc: Fix stack protector Kconfig test for clang (@Nathan Chancellor in [fab0610d646a4a3](https://github.com/sophgo/linux-riscv/commit/fab0610d646a4a3) at 2024-12-09 09:41:10)
    > commit 46e1879deea22eed31e9425d58635895fc0e8040 upstream.
    > Clang&#x27;s in-progress per-task stack protector support [1] does not work
    > with the current Kconfig checks because &#x27;-mstack-protector-guard-offset&#x27;
    > is not provided, unlike all other architecture Kconfig checks.
    > $ fd Kconfig -x rg -l mstack-protector-guard-offset
    > ./arch/arm/Kconfig
    > ./arch/riscv/Kconfig
    > ./arch/arm64/Kconfig
    > This produces an error from clang, which is interpreted as the flags not
    > being supported at all when they really are.
    > $ clang --target&#x3D;powerpc64-linux-gnu \
    > -mstack-protector-guard&#x3D;tls \
    > -mstack-protector-guard-reg&#x3D;r13 \
    > -c -o /dev/null -x c /dev/null
    > clang: error: &#x27;-mstack-protector-guard&#x3D;tls&#x27; is used without &#x27;-mstack-protector-guard-offset&#x27;, and there is no default
    > This argument will always be provided by the build system, so mirror
    > other architectures and use &#x27;-mstack-protector-guard-offset&#x3D;0&#x27; for
    > testing support, which fixes the issue for clang and does not regress
    > support with GCC.
    > Even with the first problem addressed, the 32-bit test continues to fail
    > because Kbuild uses the powerpc64le-linux-gnu target for clang and
    > nothing flips the target to 32-bit, resulting in an error about an
    > invalid register valid:
    > $ clang --target&#x3D;powerpc64le-linux-gnu \
    > -mstack-protector-guard&#x3D;tls
    > -mstack-protector-guard-reg&#x3D;r2 \
    > -mstack-protector-guard-offset&#x3D;0 \
    > -x c -c -o /dev/null /dev/null
    > clang: error: invalid value &#x27;r2&#x27; in &#x27;mstack-protector-guard-reg&#x3D;&#x27;, expected one of: r13
    > While GCC allows arbitrary registers, the implementation of
    > &#x27;-mstack-protector-guard&#x3D;tls&#x27; in LLVM shares the same code path as the
    > user space thread local storage implementation, which uses a fixed
    > register (2 for 32-bit and 13 for 62-bit), so the command line parsing
    > enforces this limitation.
    > Use the Kconfig macro &#x27;$(m32-flag)&#x27;, which expands to &#x27;-m32&#x27; when
    > supported, in the stack protector support cc-option call to properly
    > switch the target to a 32-bit one, which matches what happens in Kbuild.
    > While the 64-bit macro does not strictly need it, add the equivalent
    > 64-bit option for symmetry.
    > Cc: stable@vger.kernel.org # 6.1+
    > Link: https://github.com/llvm/llvm-project/pull/110928 [1]
    > Reviewed-by: Keith Packard &lt;keithp@keithp.com&gt;
    > Tested-by: Keith Packard &lt;keithp@keithp.com&gt;
    > Signed-off-by: Nathan Chancellor &lt;nathan@kernel.org&gt;
    > Signed-off-by: Michael Ellerman &lt;mpe@ellerman.id.au&gt;
    > Link: https://patch.msgid.link/20241009-powerpc-fix-stackprotector-test-clang-v2-1-12fb86b31857@kernel.org
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ iio: gts: fix infinite loop for gain_to_scaletables() (@Zicheng Qu in [edd18cc7ba048e4](https://github.com/sophgo/linux-riscv/commit/edd18cc7ba048e4) at 2024-12-09 09:41:10)
    > commit 7452f8a0814bb73f739ee0dab60f099f3361b151 upstream.
    > In iio_gts_build_avail_time_table(), it is checked that gts-&gt;num_itime is
    > non-zero, but gts-&gt;num_itime is not checked in gain_to_scaletables(). The
    > variable time_idx is initialized as gts-&gt;num_itime - 1. This implies that
    > time_idx might initially be set to -1 (0 - 1 &#x3D; -1). Consequently, using
    > while (time_idx--) could lead to an infinite loop.
    > Cc: stable@vger.kernel.org # v6.6+
    > Fixes: 38416c28e168 (&quot;iio: light: Add gain-time-scale helpers&quot;)
    > Signed-off-by: Zicheng Qu &lt;quzicheng@huawei.com&gt;
    > Reviewed-by: Matti Vaittinen &lt;mazziesaccount@gmail.com&gt;
    > Link: https://patch.msgid.link/20241031014626.2313077-1-quzicheng@huawei.com
    > Signed-off-by: Jonathan Cameron &lt;Jonathan.Cameron@huawei.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ powerpc: Adjust adding stack protector flags to KBUILD_CLAGS for clang (@Nathan Chancellor in [ac04ef405da998a](https://github.com/sophgo/linux-riscv/commit/ac04ef405da998a) at 2024-12-09 09:41:10)
    > commit bee08a9e6ab03caf14481d97b35a258400ffab8f upstream.
    > After fixing the HAVE_STACKPROTECTER checks for clang&#x27;s in-progress
    > per-task stack protector support [1], the build fails during prepare0
    > because &#x27;-mstack-protector-guard-offset&#x27; has not been added to
    > KBUILD_CFLAGS yet but the other &#x27;-mstack-protector-guard&#x27; flags have.
    > clang: error: &#x27;-mstack-protector-guard&#x3D;tls&#x27; is used without &#x27;-mstack-protector-guard-offset&#x27;, and there is no default
    > clang: error: &#x27;-mstack-protector-guard&#x3D;tls&#x27; is used without &#x27;-mstack-protector-guard-offset&#x27;, and there is no default
    > make[4]: *** [scripts/Makefile.build:229: scripts/mod/empty.o] Error 1
    > make[4]: *** [scripts/Makefile.build:102: scripts/mod/devicetable-offsets.s] Error 1
    > Mirror other architectures and add all &#x27;-mstack-protector-guard&#x27; flags
    > to KBUILD_CFLAGS atomically during stack_protector_prepare, which
    > resolves the issue and allows clang&#x27;s implementation to fully work with
    > the kernel.
    > Cc: stable@vger.kernel.org # 6.1+
    > Link: https://github.com/llvm/llvm-project/pull/110928 [1]
    > Reviewed-by: Keith Packard &lt;keithp@keithp.com&gt;
    > Tested-by: Keith Packard &lt;keithp@keithp.com&gt;
    > Signed-off-by: Nathan Chancellor &lt;nathan@kernel.org&gt;
    > Signed-off-by: Michael Ellerman &lt;mpe@ellerman.id.au&gt;
    > Link: https://patch.msgid.link/20241009-powerpc-fix-stackprotector-test-clang-v2-2-12fb86b31857@kernel.org
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ binder: fix OOB in binder_add_freeze_work() (@Carlos Llamas in [6b1be1da1f8279c](https://github.com/sophgo/linux-riscv/commit/6b1be1da1f8279c) at 2024-12-09 09:41:10)
    > commit 011e69a1b23011c0db3af4b8293fdd4522cc97b0 upstream.
    > In binder_add_freeze_work() we iterate over the proc-&gt;nodes with the
    > proc-&gt;inner_lock held. However, this lock is temporarily dropped to
    > acquire the node-&gt;lock first (lock nesting order). This can race with
    > binder_deferred_release() which removes the nodes from the proc-&gt;nodes
    > rbtree and adds them into binder_dead_nodes list. This leads to a broken
    > iteration in binder_add_freeze_work() as rb_next() will use data from
    > binder_dead_nodes, triggering an out-of-bounds access:
    > &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;
    > BUG: KASAN: global-out-of-bounds in rb_next+0xfc/0x124
    > Read of size 8 at addr ffffcb84285f7170 by task freeze/660
    > CPU: 8 UID: 0 PID: 660 Comm: freeze Not tainted 6.11.0-07343-ga727812a8d45 #18
    > Hardware name: linux,dummy-virt (DT)
    > Call trace:
    > rb_next+0xfc/0x124
    > binder_add_freeze_work+0x344/0x534
    > binder_ioctl+0x1e70/0x25ac
    > __arm64_sys_ioctl+0x124/0x190
    > The buggy address belongs to the variable:
    > binder_dead_nodes+0x10/0x40
    > [...]
    > &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;
    > This is possible because proc-&gt;nodes (rbtree) and binder_dead_nodes
    > (list) share entries in binder_node through a union:
    > struct binder_node {
    > [...]
    > union {
    > struct rb_node rb_node;
    > struct hlist_node dead_node;
    > };
    > Fix the race by checking that the proc is still alive. If not, simply
    > break out of the iteration.
    > Fixes: d579b04a52a1 (&quot;binder: frozen notification&quot;)
    > Cc: stable@vger.kernel.org
    > Reviewed-by: Alice Ryhl &lt;aliceryhl@google.com&gt;
    > Acked-by: Todd Kjos &lt;tkjos@google.com&gt;
    > Signed-off-by: Carlos Llamas &lt;cmllamas@google.com&gt;
    > Link: https://lore.kernel.org/r/20240926233632.821189-3-cmllamas@google.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ binder: fix node UAF in binder_add_freeze_work() (@Carlos Llamas in [38fbefeb2c140b5](https://github.com/sophgo/linux-riscv/commit/38fbefeb2c140b5) at 2024-12-09 09:41:10)
    > commit dc8aea47b928cc153b591b3558829ce42f685074 upstream.
    > In binder_add_freeze_work() we iterate over the proc-&gt;nodes with the
    > proc-&gt;inner_lock held. However, this lock is temporarily dropped in
    > order to acquire the node-&gt;lock first (lock nesting order). This can
    > race with binder_node_release() and trigger a use-after-free:
    > &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;
    > BUG: KASAN: slab-use-after-free in _raw_spin_lock+0xe4/0x19c
    > Write of size 4 at addr ffff53c04c29dd04 by task freeze/640
    > CPU: 5 UID: 0 PID: 640 Comm: freeze Not tainted 6.11.0-07343-ga727812a8d45 #17
    > Hardware name: linux,dummy-virt (DT)
    > Call trace:
    > _raw_spin_lock+0xe4/0x19c
    > binder_add_freeze_work+0x148/0x478
    > binder_ioctl+0x1e70/0x25ac
    > __arm64_sys_ioctl+0x124/0x190
    > Allocated by task 637:
    > __kmalloc_cache_noprof+0x12c/0x27c
    > binder_new_node+0x50/0x700
    > binder_transaction+0x35ac/0x6f74
    > binder_thread_write+0xfb8/0x42a0
    > binder_ioctl+0x18f0/0x25ac
    > __arm64_sys_ioctl+0x124/0x190
    > Freed by task 637:
    > kfree+0xf0/0x330
    > binder_thread_read+0x1e88/0x3a68
    > binder_ioctl+0x16d8/0x25ac
    > __arm64_sys_ioctl+0x124/0x190
    > &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;
    > Fix the race by taking a temporary reference on the node before
    > releasing the proc-&gt;inner lock. This ensures the node remains alive
    > while in use.
    > Fixes: d579b04a52a1 (&quot;binder: frozen notification&quot;)
    > Cc: stable@vger.kernel.org
    > Reviewed-by: Alice Ryhl &lt;aliceryhl@google.com&gt;
    > Acked-by: Todd Kjos &lt;tkjos@google.com&gt;
    > Signed-off-by: Carlos Llamas &lt;cmllamas@google.com&gt;
    > Link: https://lore.kernel.org/r/20240926233632.821189-2-cmllamas@google.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ iio: adc: ad7923: Fix buffer overflow for tx_buf and ring_xfer (@Nuno Sa in [218ecc359491291](https://github.com/sophgo/linux-riscv/commit/218ecc359491291) at 2024-12-09 09:41:10)
    > commit 3a4187ec454e19903fd15f6e1825a4b84e59a4cd upstream.
    > The AD7923 was updated to support devices with 8 channels, but the size
    > of tx_buf and ring_xfer was not increased accordingly, leading to a
    > potential buffer overflow in ad7923_update_scan_mode().
    > Fixes: 851644a60d20 (&quot;iio: adc: ad7923: Add support for the ad7908/ad7918/ad7928&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Nuno Sa &lt;nuno.sa@analog.com&gt;
    > Signed-off-by: Zicheng Qu &lt;quzicheng@huawei.com&gt;
    > Link: https://patch.msgid.link/20241029134637.2261336-1-quzicheng@huawei.com
    > Signed-off-by: Jonathan Cameron &lt;Jonathan.Cameron@huawei.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ PCI: of_property: Assign PCI instead of CPU bus address to dynamic PCI nodes (@Andrea della Porta in [f8553091240f2c8](https://github.com/sophgo/linux-riscv/commit/f8553091240f2c8) at 2024-12-09 09:41:09)
    > commit 5e316d34b53039346e252d0019e2f4167af2c0ef upstream.
    > When populating &quot;ranges&quot; property for a PCI bridge or endpoint,
    > of_pci_prop_ranges() incorrectly uses the CPU address of the resource.  In
    > such PCI nodes, the window should instead be in PCI address space. Call
    > pci_bus_address() on the resource in order to obtain the PCI bus address.
    > [Previous discussion at:
    > https://lore.kernel.org/all/8b4fa91380fc4754ea80f47330c613e4f6b6592c.1724159867.git.andrea.porta@suse.com/]
    > Link: https://lore.kernel.org/r/20241108094256.28933-1-andrea.porta@suse.com
    > Fixes: 407d1a51921e (&quot;PCI: Create device tree node for bridge&quot;)
    > Tested-by: Herve Codina &lt;herve.codina@bootlin.com&gt;
    > Signed-off-by: Andrea della Porta &lt;andrea.porta@suse.com&gt;
    > Signed-off-by: Bjorn Helgaas &lt;bhelgaas@google.com&gt;
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ iio: Fix fwnode_handle in __fwnode_iio_channel_get_by_name() (@Zicheng Qu in [ee7a0a9daa8e918](https://github.com/sophgo/linux-riscv/commit/ee7a0a9daa8e918) at 2024-12-09 09:41:09)
    > commit 3993ca4add248f0f853f54f9273a7de850639f33 upstream.
    > In the fwnode_iio_channel_get_by_name(), iterating over parent nodes to
    > acquire IIO channels via fwnode_for_each_parent_node(). The variable
    > chan was mistakenly attempted on the original node instead of the
    > current parent node. This patch corrects the logic to ensure that
    > __fwnode_iio_channel_get_by_name() is called with the correct parent
    > node.
    > Cc: stable@vger.kernel.org # v6.6+
    > Fixes: 1e64b9c5f9a0 (&quot;iio: inkern: move to fwnode properties&quot;)
    > Signed-off-by: Zicheng Qu &lt;quzicheng@huawei.com&gt;
    > Link: https://patch.msgid.link/20241102092525.2389952-1-quzicheng@huawei.com
    > Signed-off-by: Jonathan Cameron &lt;Jonathan.Cameron@huawei.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ PCI: rockchip-ep: Fix address translation unit programming (@Damien Le Moal in [d093cc19f709b06](https://github.com/sophgo/linux-riscv/commit/d093cc19f709b06) at 2024-12-09 09:41:09)
    > commit 64f093c4d99d797b68b407a9d8767aadc3e3ea7a upstream.
    > The Rockchip PCIe endpoint controller handles PCIe transfers addresses
    > by masking the lower bits of the programmed PCI address and using the
    > same number of lower bits masked from the CPU address space used for the
    > mapping. For a PCI mapping of &lt;size&gt; bytes starting from &lt;pci_addr&gt;,
    > the number of bits masked is the number of address bits changing in the
    > address range [pci_addr..pci_addr + size - 1].
    > However, rockchip_pcie_prog_ep_ob_atu() calculates num_pass_bits only
    > using the size of the mapping, resulting in an incorrect number of mask
    > bits depending on the value of the PCI address to map.
    > Fix this by introducing the helper function
    > rockchip_pcie_ep_ob_atu_num_bits() to correctly calculate the number of
    > mask bits to use to program the address translation unit. The number of
    > mask bits is calculated depending on both the PCI address and size of
    > the mapping, and clamped between 8 and 20 using the macros
    > ROCKCHIP_PCIE_AT_MIN_NUM_BITS and ROCKCHIP_PCIE_AT_MAX_NUM_BITS. As
    > defined in the Rockchip RK3399 TRM V1.3 Part2, Sections 17.5.5.1.1 and
    > 17.6.8.2.1, this clamping is necessary because:
    > 1) The lower 8 bits of the PCI address to be mapped by the outbound
    > region are ignored. So a minimum of 8 address bits are needed and
    > imply that the PCI address must be aligned to 256.
    > 2) The outbound memory regions are 1MB in size. So while we can specify
    > up to 63-bits for the PCI address (num_bits filed uses bits 0 to 5 of
    > the outbound address region 0 register), we must limit the number of
    > valid address bits to 20 to match the memory window maximum size (1
    > &lt;&lt; 20 &#x3D; 1MB).
    > Fixes: cf590b078391 (&quot;PCI: rockchip: Add EP driver for Rockchip PCIe controller&quot;)
    > Link: https://lore.kernel.org/r/20241017015849.190271-2-dlemoal@kernel.org
    > Signed-off-by: Damien Le Moal &lt;dlemoal@kernel.org&gt;
    > Signed-off-by: Krzysztof Wilczyński &lt;kwilczynski@kernel.org&gt;
    > Signed-off-by: Bjorn Helgaas &lt;bhelgaas@google.com&gt;
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ iio: invensense: fix multiple odr switch when FIFO is off (@Jean-Baptiste Maneyrol in [c11a06753211c18](https://github.com/sophgo/linux-riscv/commit/c11a06753211c18) at 2024-12-09 09:41:09)
    > commit ef5f5e7b6f73f79538892a8be3a3bee2342acc9f upstream.
    > When multiple ODR switch happens during FIFO off, the change could
    > not be taken into account if you get back to previous FIFO on value.
    > For example, if you run sensor buffer at 50Hz, stop, change to
    > 200Hz, then back to 50Hz and restart buffer, data will be timestamped
    > at 200Hz. This due to testing against mult and not new_mult.
    > To prevent this, let&#x27;s just run apply_odr automatically when FIFO is
    > off. It will also simplify driver code.
    > Update inv_mpu6050 and inv_icm42600 to delete now useless apply_odr.
    > Fixes: 95444b9eeb8c (&quot;iio: invensense: fix odr switching to same value&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Jean-Baptiste Maneyrol &lt;jean-baptiste.maneyrol@tdk.com&gt;
    > Link: https://patch.msgid.link/20241021-invn-inv-sensors-timestamp-fix-switch-fifo-off-v2-1-39ffd43edcc4@tdk.com
    > Signed-off-by: Jonathan Cameron &lt;Jonathan.Cameron@huawei.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ nfsd: make sure exp active before svc_export_show (@Yang Erkun in [7365d1f8de63cff](https://github.com/sophgo/linux-riscv/commit/7365d1f8de63cff) at 2024-12-09 09:41:09)
    > commit be8f982c369c965faffa198b46060f8853e0f1f0 upstream.
    > The function &#x60;e_show&#x60; was called with protection from RCU. This only
    > ensures that &#x60;exp&#x60; will not be freed. Therefore, the reference count for
    > &#x60;exp&#x60; can drop to zero, which will trigger a refcount use-after-free
    > warning when &#x60;exp_get&#x60; is called. To resolve this issue, use
    > &#x60;cache_get_rcu&#x60; to ensure that &#x60;exp&#x60; remains active.
    > ------------[ cut here ]------------
    > refcount_t: addition on 0; use-after-free.
    > WARNING: CPU: 3 PID: 819 at lib/refcount.c:25
    > refcount_warn_saturate+0xb1/0x120
    > CPU: 3 UID: 0 PID: 819 Comm: cat Not tainted 6.12.0-rc3+ #1
    > Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS
    > 1.16.1-2.fc37 04/01/2014
    > RIP: 0010:refcount_warn_saturate+0xb1/0x120
    > ...
    > Call Trace:
    > &lt;TASK&gt;
    > e_show+0x20b/0x230 [nfsd]
    > seq_read_iter+0x589/0x770
    > seq_read+0x1e5/0x270
    > vfs_read+0x125/0x530
    > ksys_read+0xc1/0x160
    > do_syscall_64+0x5f/0x170
    > entry_SYSCALL_64_after_hwframe+0x76/0x7e
    > Fixes: bf18f163e89c (&quot;NFSD: Using exp_get for export getting&quot;)
    > Cc: stable@vger.kernel.org # 4.20+
    > Signed-off-by: Yang Erkun &lt;yangerkun@huawei.com&gt;
    > Reviewed-by: Jeff Layton &lt;jlayton@kernel.org&gt;
    > Signed-off-by: Chuck Lever &lt;chuck.lever@oracle.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ nfsd: fix nfs4_openowner leak when concurrent nfsd4_open occur (@Yang Erkun in [6f73f920b7ad008](https://github.com/sophgo/linux-riscv/commit/6f73f920b7ad008) at 2024-12-09 09:41:09)
    > commit 98100e88dd8865999dc6379a3356cd799795fe7b upstream.
    > The action force umount(umount -f) will attempt to kill all rpc_task even
    > umount operation may ultimately fail if some files remain open.
    > Consequently, if an action attempts to open a file, it can potentially
    > send two rpc_task to nfs server.
    > NFS CLIENT
    > thread1                             thread2
    > open(&quot;file&quot;)
    > ...
    > nfs4_do_open
    > _nfs4_do_open
    > _nfs4_open_and_get_state
    > _nfs4_proc_open
    > nfs4_run_open_task
    > /* rpc_task1 */
    > rpc_run_task
    > rpc_wait_for_completion_task
    > umount -f
    > nfs_umount_begin
    > rpc_killall_tasks
    > rpc_signal_task
    > rpc_task1 been wakeup
    > and return -512
    > _nfs4_do_open // while loop
    > ...
    > nfs4_run_open_task
    > /* rpc_task2 */
    > rpc_run_task
    > rpc_wait_for_completion_task
    > While processing an open request, nfsd will first attempt to find or
    > allocate an nfs4_openowner. If it finds an nfs4_openowner that is not
    > marked as NFS4_OO_CONFIRMED, this nfs4_openowner will released. Since
    > two rpc_task can attempt to open the same file simultaneously from the
    > client to server, and because two instances of nfsd can run
    > concurrently, this situation can lead to lots of memory leak.
    > Additionally, when we echo 0 to /proc/fs/nfsd/threads, warning will be
    > triggered.
    > NFS SERVER
    > nfsd1                  nfsd2       echo 0 &gt; /proc/fs/nfsd/threads
    > nfsd4_open
    > nfsd4_process_open1
    > find_or_alloc_open_stateowner
    > // alloc oo1, stateid1
    > nfsd4_open
    > nfsd4_process_open1
    > find_or_alloc_open_stateowner
    > // find oo1, without NFS4_OO_CONFIRMED
    > release_openowner
    > unhash_openowner_locked
    > list_del_init(&amp;oo-&gt;oo_perclient)
    > // cannot find this oo
    > // from client, LEAK!!!
    > alloc_stateowner // alloc oo2
    > nfsd4_process_open2
    > init_open_stateid
    > // associate oo1
    > // with stateid1, stateid1 LEAK!!!
    > nfs4_get_vfs_file
    > // alloc nfsd_file1 and nfsd_file_mark1
    > // all LEAK!!!
    > nfsd4_process_open2
    > ...
    > write_threads
    > ...
    > nfsd_destroy_serv
    > nfsd_shutdown_net
    > nfs4_state_shutdown_net
    > nfs4_state_destroy_net
    > destroy_client
    > __destroy_client
    > // won&#x27;t find oo1!!!
    > nfsd_shutdown_generic
    > nfsd_file_cache_shutdown
    > kmem_cache_destroy
    > for nfsd_file_slab
    > and nfsd_file_mark_slab
    > // bark since nfsd_file1
    > // and nfsd_file_mark1
    > // still alive
    > &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;
    > BUG nfsd_file (Not tainted): Objects remaining in nfsd_file on
    > __kmem_cache_shutdown()
    > -----------------------------------------------------------------------
    > Slab 0xffd4000004438a80 objects&#x3D;34 used&#x3D;1 fp&#x3D;0xff11000110e2ad28
    > flags&#x3D;0x17ffffc0000240(workingset|head|node&#x3D;0|zone&#x3D;2|lastcpupid&#x3D;0x1fffff)
    > CPU: 4 UID: 0 PID: 757 Comm: sh Not tainted 6.12.0-rc6+ #19
    > Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS
    > 1.16.1-2.fc37 04/01/2014
    > Call Trace:
    > &lt;TASK&gt;
    > dump_stack_lvl+0x53/0x70
    > slab_err+0xb0/0xf0
    > __kmem_cache_shutdown+0x15c/0x310
    > kmem_cache_destroy+0x66/0x160
    > nfsd_file_cache_shutdown+0xac/0x210 [nfsd]
    > nfsd_destroy_serv+0x251/0x2a0 [nfsd]
    > nfsd_svc+0x125/0x1e0 [nfsd]
    > write_threads+0x16a/0x2a0 [nfsd]
    > nfsctl_transaction_write+0x74/0xa0 [nfsd]
    > vfs_write+0x1ae/0x6d0
    > ksys_write+0xc1/0x160
    > do_syscall_64+0x5f/0x170
    > entry_SYSCALL_64_after_hwframe+0x76/0x7e
    > Disabling lock debugging due to kernel taint
    > Object 0xff11000110e2ac38 @offset&#x3D;3128
    > Allocated in nfsd_file_do_acquire+0x20f/0xa30 [nfsd] age&#x3D;1635 cpu&#x3D;3
    > pid&#x3D;800
    > nfsd_file_do_acquire+0x20f/0xa30 [nfsd]
    > nfsd_file_acquire_opened+0x5f/0x90 [nfsd]
    > nfs4_get_vfs_file+0x4c9/0x570 [nfsd]
    > nfsd4_process_open2+0x713/0x1070 [nfsd]
    > nfsd4_open+0x74b/0x8b0 [nfsd]
    > nfsd4_proc_compound+0x70b/0xc20 [nfsd]
    > nfsd_dispatch+0x1b4/0x3a0 [nfsd]
    > svc_process_common+0x5b8/0xc50 [sunrpc]
    > svc_process+0x2ab/0x3b0 [sunrpc]
    > svc_handle_xprt+0x681/0xa20 [sunrpc]
    > nfsd+0x183/0x220 [nfsd]
    > kthread+0x199/0x1e0
    > ret_from_fork+0x31/0x60
    > ret_from_fork_asm+0x1a/0x30
    > Add nfs4_openowner_unhashed to help found unhashed nfs4_openowner, and
    > break nfsd4_open process to fix this problem.
    > Cc: stable@vger.kernel.org # v5.4+
    > Reviewed-by: Jeff Layton &lt;jlayton@kernel.org&gt;
    > Signed-off-by: Yang Erkun &lt;yangerkun@huawei.com&gt;
    > Signed-off-by: Chuck Lever &lt;chuck.lever@oracle.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ iio: accel: kx022a: Fix raw read format (@Matti Vaittinen in [1344ff89fe4d6fb](https://github.com/sophgo/linux-riscv/commit/1344ff89fe4d6fb) at 2024-12-09 09:41:09)
    > commit b7d2bc99b3bdc03fff9b416dd830632346d83530 upstream.
    > The KX022A provides the accelerometer data in two subsequent registers.
    > The registers are laid out so that the value obtained via bulk-read of
    > these registers can be interpreted as signed 16-bit little endian value.
    > The read value is converted to cpu_endianes and stored into 32bit integer.
    > The le16_to_cpu() casts value to unsigned 16-bit value, and when this is
    > assigned to 32-bit integer the resulting value will always be positive.
    > This has not been a problem to users (at least not all users) of the sysfs
    > interface, who know the data format based on the scan info and who have
    > converted the read value back to 16-bit signed value. This isn&#x27;t
    > compliant with the ABI however.
    > This, however, will be a problem for those who use the in-kernel
    > interfaces, especially the iio_read_channel_processed_scale().
    > The iio_read_channel_processed_scale() performs multiplications to the
    > returned (always positive) raw value, which will cause strange results
    > when the data from the sensor has been negative.
    > Fix the read_raw format by casting the result of the le_to_cpu() to
    > signed 16-bit value before assigning it to the integer. This will make
    > the negative readings to be correctly reported as negative.
    > This fix will be visible to users by changing values returned via sysfs
    > to appear in correct (negative) format.
    > Reported-by: Kalle Niemi &lt;kaleposti@gmail.com&gt;
    > Fixes: 7c1d1677b322 (&quot;iio: accel: Support Kionix/ROHM KX022A accelerometer&quot;)
    > Signed-off-by: Matti Vaittinen &lt;mazziesaccount@gmail.com&gt;
    > Tested-by: Kalle Niemi &lt;kaleposti@gmail.com&gt;
    > Cc: &lt;Stable@vger.kernel.org&gt;
    > Link: https://patch.msgid.link/ZyIxm_zamZfIGrnB@mva-rohm
    > Signed-off-by: Jonathan Cameron &lt;Jonathan.Cameron@huawei.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ mm/vmalloc: combine all TLB flush operations of KASAN shadow virtual address into one operation (@Adrian Huang in [f9a18889aad9b4c](https://github.com/sophgo/linux-riscv/commit/f9a18889aad9b4c) at 2024-12-09 09:41:08)
    > commit 9e9e085effe9b7e342138fde3cf8577d22509932 upstream.
    > When compiling kernel source &#x27;make -j $(nproc)&#x27; with the up-and-running
    > KASAN-enabled kernel on a 256-core machine, the following soft lockup is
    > shown:
    > watchdog: BUG: soft lockup - CPU#28 stuck for 22s! [kworker/28:1:1760]
    > CPU: 28 PID: 1760 Comm: kworker/28:1 Kdump: loaded Not tainted 6.10.0-rc5 #95
    > Workqueue: events drain_vmap_area_work
    > RIP: 0010:smp_call_function_many_cond+0x1d8/0xbb0
    > Code: 38 c8 7c 08 84 c9 0f 85 49 08 00 00 8b 45 08 a8 01 74 2e 48 89 f1 49 89 f7 48 c1 e9 03 41 83 e7 07 4c 01 e9 41 83 c7 03 f3 90 &lt;0f&gt; b6 01 41 38 c7 7c 08 84 c0 0f 85 d4 06 00 00 8b 45 08 a8 01 75
    > RSP: 0018:ffffc9000cb3fb60 EFLAGS: 00000202
    > RAX: 0000000000000011 RBX: ffff8883bc4469c0 RCX: ffffed10776e9949
    > RDX: 0000000000000002 RSI: ffff8883bb74ca48 RDI: ffffffff8434dc50
    > RBP: ffff8883bb74ca40 R08: ffff888103585dc0 R09: ffff8884533a1800
    > R10: 0000000000000004 R11: ffffffffffffffff R12: ffffed1077888d39
    > R13: dffffc0000000000 R14: ffffed1077888d38 R15: 0000000000000003
    > FS:  0000000000000000(0000) GS:ffff8883bc400000(0000) knlGS:0000000000000000
    > CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
    > CR2: 00005577b5c8d158 CR3: 0000000004850000 CR4: 0000000000350ef0
    > Call Trace:
    > &lt;IRQ&gt;
    > ? watchdog_timer_fn+0x2cd/0x390
    > ? __pfx_watchdog_timer_fn+0x10/0x10
    > ? __hrtimer_run_queues+0x300/0x6d0
    > ? sched_clock_cpu+0x69/0x4e0
    > ? __pfx___hrtimer_run_queues+0x10/0x10
    > ? srso_return_thunk+0x5/0x5f
    > ? ktime_get_update_offsets_now+0x7f/0x2a0
    > ? srso_return_thunk+0x5/0x5f
    > ? srso_return_thunk+0x5/0x5f
    > ? hrtimer_interrupt+0x2ca/0x760
    > ? __sysvec_apic_timer_interrupt+0x8c/0x2b0
    > ? sysvec_apic_timer_interrupt+0x6a/0x90
    > &lt;/IRQ&gt;
    > &lt;TASK&gt;
    > ? asm_sysvec_apic_timer_interrupt+0x16/0x20
    > ? smp_call_function_many_cond+0x1d8/0xbb0
    > ? __pfx_do_kernel_range_flush+0x10/0x10
    > on_each_cpu_cond_mask+0x20/0x40
    > flush_tlb_kernel_range+0x19b/0x250
    > ? srso_return_thunk+0x5/0x5f
    > ? kasan_release_vmalloc+0xa7/0xc0
    > purge_vmap_node+0x357/0x820
    > ? __pfx_purge_vmap_node+0x10/0x10
    > __purge_vmap_area_lazy+0x5b8/0xa10
    > drain_vmap_area_work+0x21/0x30
    > process_one_work+0x661/0x10b0
    > worker_thread+0x844/0x10e0
    > ? srso_return_thunk+0x5/0x5f
    > ? __kthread_parkme+0x82/0x140
    > ? __pfx_worker_thread+0x10/0x10
    > kthread+0x2a5/0x370
    > ? __pfx_kthread+0x10/0x10
    > ret_from_fork+0x30/0x70
    > ? __pfx_kthread+0x10/0x10
    > ret_from_fork_asm+0x1a/0x30
    > &lt;/TASK&gt;
    > Debugging Analysis:
    > 1. The following ftrace log shows that the lockup CPU spends too much
    > time iterating vmap_nodes and flushing TLB when purging vm_area
    > structures. (Some info is trimmed).
    > kworker: funcgraph_entry:              |  drain_vmap_area_work() {
    > kworker: funcgraph_entry:              |   mutex_lock() {
    > kworker: funcgraph_entry:  1.092 us    |     __cond_resched();
    > kworker: funcgraph_exit:   3.306 us    |   }
    > ...                                        ...
    > kworker: funcgraph_entry:              |    flush_tlb_kernel_range() {
    > ...                                          ...
    > kworker: funcgraph_exit: # 7533.649 us |    }
    > ...                                         ...
    > kworker: funcgraph_entry:  2.344 us    |   mutex_unlock();
    > kworker: funcgraph_exit: $ 23871554 us | }
    > The drain_vmap_area_work() spends over 23 seconds.
    > There are 2805 flush_tlb_kernel_range() calls in the ftrace log.
    > One is called in __purge_vmap_area_lazy().
    > Others are called by purge_vmap_node-&gt;kasan_release_vmalloc.
    > purge_vmap_node() iteratively releases kasan vmalloc
    > allocations and flushes TLB for each vmap_area.
    > - [Rough calculation] Each flush_tlb_kernel_range() runs
    > about 7.5ms.
    > -- 2804 * 7.5ms &#x3D; 21.03 seconds.
    > -- That&#x27;s why a soft lock is triggered.
    > 2. Extending the soft lockup time can work around the issue (For example,
    > # echo 60 &gt; /proc/sys/kernel/watchdog_thresh). This confirms the
    > above-mentioned speculation: drain_vmap_area_work() spends too much
    > time.
    > If we combine all TLB flush operations of the KASAN shadow virtual
    > address into one operation in the call path
    > &#x27;purge_vmap_node()-&gt;kasan_release_vmalloc()&#x27;, the running time of
    > drain_vmap_area_work() can be saved greatly. The idea is from the
    > flush_tlb_kernel_range() call in __purge_vmap_area_lazy(). And, the
    > soft lockup won&#x27;t be triggered.
    > Here is the test result based on 6.10:
    > [6.10 wo/ the patch]
    > 1. ftrace latency profiling (record a trace if the latency &gt; 20s).
    > echo 20000000 &gt; /sys/kernel/debug/tracing/tracing_thresh
    > echo drain_vmap_area_work &gt; /sys/kernel/debug/tracing/set_graph_function
    > echo function_graph &gt; /sys/kernel/debug/tracing/current_tracer
    > echo 1 &gt; /sys/kernel/debug/tracing/tracing_on
    > 2. Run &#x60;make -j $(nproc)&#x60; to compile the kernel source
    > 3. Once the soft lockup is reproduced, check the ftrace log:
    > cat /sys/kernel/debug/tracing/trace
    > # tracer: function_graph
    > #
    > # CPU  DURATION                  FUNCTION CALLS
    > # |     |   |                     |   |   |   |
    > 76) $ 50412985 us |    } /* __purge_vmap_area_lazy */
    > 76) $ 50412997 us |  } /* drain_vmap_area_work */
    > 76) $ 29165911 us |    } /* __purge_vmap_area_lazy */
    > 76) $ 29165926 us |  } /* drain_vmap_area_work */
    > 91) $ 53629423 us |    } /* __purge_vmap_area_lazy */
    > 91) $ 53629434 us |  } /* drain_vmap_area_work */
    > 91) $ 28121014 us |    } /* __purge_vmap_area_lazy */
    > 91) $ 28121026 us |  } /* drain_vmap_area_work */
    > [6.10 w/ the patch]
    > 1. Repeat step 1-2 in &quot;[6.10 wo/ the patch]&quot;
    > 2. The soft lockup is not triggered and ftrace log is empty.
    > cat /sys/kernel/debug/tracing/trace
    > # tracer: function_graph
    > #
    > # CPU  DURATION                  FUNCTION CALLS
    > # |     |   |                     |   |   |   |
    > 3. Setting &#x27;tracing_thresh&#x27; to 10/5 seconds does not get any ftrace
    > log.
    > 4. Setting &#x27;tracing_thresh&#x27; to 1 second gets ftrace log.
    > cat /sys/kernel/debug/tracing/trace
    > # tracer: function_graph
    > #
    > # CPU  DURATION                  FUNCTION CALLS
    > # |     |   |                     |   |   |   |
    > 23) $ 1074942 us  |    } /* __purge_vmap_area_lazy */
    > 23) $ 1074950 us  |  } /* drain_vmap_area_work */
    > The worst execution time of drain_vmap_area_work() is about 1 second.
    > Link: https://lore.kernel.org/lkml/ZqFlawuVnOMY2k3E@pc638.lan/
    > Link: https://lkml.kernel.org/r/20240726165246.31326-1-ahuang12@lenovo.com
    > Fixes: 282631cb2447 (&quot;mm: vmalloc: remove global purge_vmap_area_root rb-tree&quot;)
    > Signed-off-by: Adrian Huang &lt;ahuang12@lenovo.com&gt;
    > Co-developed-by: Uladzislau Rezki (Sony) &lt;urezki@gmail.com&gt;
    > Signed-off-by: Uladzislau Rezki (Sony) &lt;urezki@gmail.com&gt;
    > Tested-by: Jiwei Sun &lt;sunjw10@lenovo.com&gt;
    > Reviewed-by: Baoquan He &lt;bhe@redhat.com&gt;
    > Cc: Alexander Potapenko &lt;glider@google.com&gt;
    > Cc: Andrey Konovalov &lt;andreyknvl@gmail.com&gt;
    > Cc: Andrey Ryabinin &lt;ryabinin.a.a@gmail.com&gt;
    > Cc: Christoph Hellwig &lt;hch@infradead.org&gt;
    > Cc: Dmitry Vyukov &lt;dvyukov@google.com&gt;
    > Cc: Vincenzo Frascino &lt;vincenzo.frascino@arm.com&gt;
    > Cc: &lt;stable@vger.kernel.org&gt;
    > Signed-off-by: Andrew Morton &lt;akpm@linux-foundation.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ PCI: dwc: ep: Fix advertised resizable BAR size regression (@Niklas Cassel in [e9a75f2de97d370](https://github.com/sophgo/linux-riscv/commit/e9a75f2de97d370) at 2024-12-09 09:41:08)
    > commit 118397c9baaac0b7ec81896f8d755d09aa82c485 upstream.
    > The advertised resizable BAR size was fixed in commit 72e34b8593e0 (&quot;PCI:
    > dwc: endpoint: Fix advertised resizable BAR size&quot;).
    > Commit 867ab111b242 (&quot;PCI: dwc: ep: Add a generic dw_pcie_ep_linkdown()
    > API to handle Link Down event&quot;) was included shortly after this, and
    > moved the code to another function. When the code was moved, this fix
    > was mistakenly lost.
    > According to the spec, it is illegal to not have a bit set in
    > PCI_REBAR_CAP, and 1 MB is the smallest size allowed.
    > So, set bit 4 in PCI_REBAR_CAP, so that we actually advertise support
    > for a 1 MB BAR size.
    > Fixes: 867ab111b242 (&quot;PCI: dwc: ep: Add a generic dw_pcie_ep_linkdown() API to handle Link Down event&quot;)
    > Link: https://lore.kernel.org/r/20241116005950.2480427-2-cassel@kernel.org
    > Link: https://lore.kernel.org/r/20240606-pci-deinit-v1-3-4395534520dc@linaro.org
    > Link: https://lore.kernel.org/r/20240307111520.3303774-1-cassel@kernel.org
    > Signed-off-by: Niklas Cassel &lt;cassel@kernel.org&gt;
    > Signed-off-by: Krzysztof Wilczyński &lt;kwilczynski@kernel.org&gt;
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ leds: flash: mt6360: Fix device_for_each_child_node() refcounting in error paths (@Javier Carrasco in [e78d04d36481a2b](https://github.com/sophgo/linux-riscv/commit/e78d04d36481a2b) at 2024-12-09 09:41:08)
    > commit 73b03b27736e440e3009fe1319cbc82d2cd1290c upstream.
    > The device_for_each_child_node() macro requires explicit calls to
    > fwnode_handle_put() upon early exits to avoid memory leaks, and in
    > this case the error paths are handled after jumping to
    > &#x27;out_flash_realease&#x27;, which misses that required call to
    > to decrement the refcount of the child node.
    > A more elegant and robust solution is using the scoped variant of the
    > loop, which automatically handles such early exits.
    > Fix the child node refcounting in the error paths by using
    > device_for_each_child_node_scoped().
    > Cc: stable@vger.kernel.org
    > Fixes: 679f8652064b (&quot;leds: Add mt6360 driver&quot;)
    > Signed-off-by: Javier Carrasco &lt;javier.carrasco.cruz@gmail.com&gt;
    > Link: https://lore.kernel.org/r/20240927-leds_device_for_each_child_node_scoped-v1-1-95c0614b38c8@gmail.com
    > Signed-off-by: Lee Jones &lt;lee@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ dm thin: Add missing destroy_work_on_stack() (@Yuan Can in [a4ee8ff0763694c](https://github.com/sophgo/linux-riscv/commit/a4ee8ff0763694c) at 2024-12-09 09:41:08)
    > commit e74fa2447bf9ed03d085b6d91f0256cc1b53f1a8 upstream.
    > This commit add missed destroy_work_on_stack() operations for pw-&gt;worker in
    > pool_work_wait().
    > Fixes: e7a3e871d895 (&quot;dm thin: cleanup noflush_work to use a proper completion&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Yuan Can &lt;yuancan@huawei.com&gt;
    > Signed-off-by: Mikulas Patocka &lt;mpatocka@redhat.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ dm: Fix typo in error message (@Ssuhung Yeh in [3cad6b5a12782b3](https://github.com/sophgo/linux-riscv/commit/3cad6b5a12782b3) at 2024-12-09 09:41:08)
    > commit 2deb70d3e66d538404d9e71bff236e6d260da66e upstream.
    > Remove the redundant &quot;i&quot; at the beginning of the error message. This &quot;i&quot;
    > came from commit 1c1318866928 (&quot;dm: prefer
    > &#x27;&quot;%s...&quot;, __func__&#x27;&quot;), the &quot;i&quot; is accidentally left.
    > Signed-off-by: Ssuhung Yeh &lt;ssuhung@gmail.com&gt;
    > Signed-off-by: Mikulas Patocka &lt;mpatocka@redhat.com&gt;
    > Fixes: 1c1318866928 (&quot;dm: prefer &#x27;&quot;%s...&quot;, __func__&#x27;&quot;)
    > Cc: stable@vger.kernel.org	# v6.3+
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ thermal: int3400: Fix reading of current_uuid for active policy (@Srinivas Pandruvada in [3a3f789ee15b13c](https://github.com/sophgo/linux-riscv/commit/3a3f789ee15b13c) at 2024-12-09 09:41:08)
    > commit 7082503622986537f57bdb5ef23e69e70cfad881 upstream.
    > When the current_uuid attribute is set to the active policy UUID,
    > reading back the same attribute is returning &quot;INVALID&quot; instead of
    > the active policy UUID on some platforms before Ice Lake.
    > In platforms before Ice Lake, firmware provides a list of supported
    > thermal policies. In this case, user space can select any of the
    > supported thermal policies via a write to attribute &quot;current_uuid&quot;.
    > In commit c7ff29763989 (&quot;thermal: int340x: Update OS policy capability
    > handshake&quot;)&#x27;, the OS policy handshake was updated to support Ice Lake
    > and later platforms and it treated priv-&gt;current_uuid_index&#x3D;0 as
    > invalid. However, priv-&gt;current_uuid_index&#x3D;0 is for the active policy,
    > only priv-&gt;current_uuid_index&#x3D;-1 is invalid.
    > Fix this issue by updating the priv-&gt;current_uuid_index check.
    > Fixes: c7ff29763989 (&quot;thermal: int340x: Update OS policy capability handshake&quot;)
    > Signed-off-by: Srinivas Pandruvada &lt;srinivas.pandruvada@linux.intel.com&gt;
    > Cc: 5.18+ &lt;stable@vger.kernel.org&gt; # 5.18+
    > Link: https://patch.msgid.link/20241114200213.422303-1-srinivas.pandruvada@linux.intel.com
    > [ rjw: Subject and changelog edits ]
    > Signed-off-by: Rafael J. Wysocki &lt;rafael.j.wysocki@intel.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ ovl: properly handle large files in ovl_security_fileattr (@Oleksandr Tymoshenko in [1ba771763d1b754](https://github.com/sophgo/linux-riscv/commit/1ba771763d1b754) at 2024-12-09 09:41:08)
    > commit 3b6b99ef15ea37635604992ede9ebcccef38a239 upstream.
    > dentry_open in ovl_security_fileattr fails for any file
    > larger than 2GB if open method of the underlying filesystem
    > calls generic_file_open (e.g. fusefs).
    > The issue can be reproduce using the following script:
    > (passthrough_ll is an example app from libfuse).
    > $ D&#x3D;/opt/test/mnt
    > $ mkdir -p ${D}/{source,base,top/uppr,top/work,ovlfs}
    > $ dd if&#x3D;/dev/zero of&#x3D;${D}/source/zero.bin bs&#x3D;1G count&#x3D;2
    > $ passthrough_ll -o source&#x3D;${D}/source ${D}/base
    > $ mount -t overlay overlay \
    > -olowerdir&#x3D;${D}/base,upperdir&#x3D;${D}/top/uppr,workdir&#x3D;${D}/top/work \
    > ${D}/ovlfs
    > $ chmod 0777 ${D}/mnt/ovlfs/zero.bin
    > Running this script results in &quot;Value too large for defined data type&quot;
    > error message from chmod.
    > Signed-off-by: Oleksandr Tymoshenko &lt;ovt@google.com&gt;
    > Fixes: 72db82115d2b (&quot;ovl: copy up sync/noatime fileattr flags&quot;)
    > Cc: stable@vger.kernel.org # v5.15+
    > Signed-off-by: Amir Goldstein &lt;amir73il@gmail.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ PCI: keystone: Set mode as Root Complex for &quot;ti,keystone-pcie&quot; compatible (@Kishon Vijay Abraham I in [c8a1d7b85d9e108](https://github.com/sophgo/linux-riscv/commit/c8a1d7b85d9e108) at 2024-12-09 09:41:07)
    > commit 5a938ed9481b0c06cb97aec45e722a80568256fd upstream.
    > commit 23284ad677a9 (&quot;PCI: keystone: Add support for PCIe EP in AM654x
    > Platforms&quot;) introduced configuring &quot;enum dw_pcie_device_mode&quot; as part of
    > device data (&quot;struct ks_pcie_of_data&quot;). However it failed to set the
    > mode for &quot;ti,keystone-pcie&quot; compatible.
    > Since the mode defaults to &quot;DW_PCIE_UNKNOWN_TYPE&quot;, the following error
    > message is displayed for the v3.65a controller:
    > &quot;INVALID device type 0&quot;
    > Despite the driver probing successfully, the controller may not be
    > functional in the Root Complex mode of operation.
    > So, set the mode as Root Complex for &quot;ti,keystone-pcie&quot; compatible to
    > fix this.
    > Fixes: 23284ad677a9 (&quot;PCI: keystone: Add support for PCIe EP in AM654x Platforms&quot;)
    > Link: https://lore.kernel.org/r/20240524105714.191642-2-s-vadapalli@ti.com
    > Signed-off-by: Kishon Vijay Abraham I &lt;kishon@ti.com&gt;
    > Signed-off-by: Siddharth Vadapalli &lt;s-vadapalli@ti.com&gt;
    > [kwilczynski: commit log, added tag for stable releases]
    > Signed-off-by: Krzysztof Wilczyński &lt;kwilczynski@kernel.org&gt;
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ PCI: endpoint: Fix PCI domain ID release in pci_epc_destroy() (@Zijun Hu in [c74a1df6c2a2df7](https://github.com/sophgo/linux-riscv/commit/c74a1df6c2a2df7) at 2024-12-09 09:41:07)
    > commit 4acc902ed3743edd4ac2d3846604a99d17104359 upstream.
    > pci_epc_destroy() invokes pci_bus_release_domain_nr() to release the PCI
    > domain ID, but there are two issues:
    > - &#x27;epc-&gt;dev&#x27; is passed to pci_bus_release_domain_nr() which was already
    > freed by device_unregister(), leading to a use-after-free issue.
    > - Domain ID corresponds to the EPC device parent, so passing &#x27;epc-&gt;dev&#x27;
    > is also wrong.
    > Fix these issues by passing &#x27;epc-&gt;dev.parent&#x27; to
    > pci_bus_release_domain_nr() and also do it before device_unregister().
    > Fixes: 0328947c5032 (&quot;PCI: endpoint: Assign PCI domain number for endpoint controllers&quot;)
    > Signed-off-by: Zijun Hu &lt;quic_zijuhu@quicinc.com&gt;
    > Reviewed-by: Manivannan Sadhasivam &lt;manivannan.sadhasivam@linaro.org&gt;
    > Link: https://lore.kernel.org/r/20241107-epc_rfc-v2-1-da5b6a99a66f@quicinc.com
    > [mani: reworded subject and description]
    > Signed-off-by: Manivannan Sadhasivam &lt;manivannan.sadhasivam@linaro.org&gt;
    > Signed-off-by: Bjorn Helgaas &lt;bhelgaas@google.com&gt;
    > Signed-off-by: Krzysztof Wilczyński &lt;kwilczynski@kernel.org&gt;
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ PCI: endpoint: Clear secondary (not primary) EPC in pci_epc_remove_epf() (@Zijun Hu in [a143b50de2b819c](https://github.com/sophgo/linux-riscv/commit/a143b50de2b819c) at 2024-12-09 09:41:07)
    > commit 688d2eb4c6fcfdcdaed0592f9df9196573ff5ce2 upstream.
    > In addition to a primary endpoint controller, an endpoint function may be
    > associated with a secondary endpoint controller, epf-&gt;sec_epc, to provide
    > NTB (non-transparent bridge) functionality.
    > Previously, pci_epc_remove_epf() incorrectly cleared epf-&gt;epc instead of
    > epf-&gt;sec_epc when removing from the secondary endpoint controller.
    > Extend the epc-&gt;list_lock coverage and clear either epf-&gt;epc or
    > epf-&gt;sec_epc as indicated.
    > Link: https://lore.kernel.org/r/20241107-epc_rfc-v2-2-da5b6a99a66f@quicinc.com
    > Fixes: 63840ff53223 (&quot;PCI: endpoint: Add support to associate secondary EPC with EPF&quot;)
    > Signed-off-by: Zijun Hu &lt;quic_zijuhu@quicinc.com&gt;
    > Reviewed-by: Manivannan Sadhasivam &lt;manivannan.sadhasivam@linaro.org&gt;
    > [mani: reworded subject and description]
    > Signed-off-by: Manivannan Sadhasivam &lt;manivannan.sadhasivam@linaro.org&gt;
    > [bhelgaas: commit log]
    > Signed-off-by: Bjorn Helgaas &lt;bhelgaas@google.com&gt;
    > Signed-off-by: Krzysztof Wilczyński &lt;kwilczynski@kernel.org&gt;
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ fs/proc/kcore.c: Clear ret value in read_kcore_iter after successful iov_iter_zero (@Jiri Olsa in [987999769e69738](https://github.com/sophgo/linux-riscv/commit/987999769e69738) at 2024-12-09 09:41:07)
    > commit 088f294609d8f8816dc316681aef2eb61982e0da upstream.
    > If iov_iter_zero succeeds after failed copy_from_kernel_nofault,
    > we need to reset the ret value to zero otherwise it will be returned
    > as final return value of read_kcore_iter.
    > This fixes objdump -d dump over /proc/kcore for me.
    > Cc: stable@vger.kernel.org
    > Cc: Alexander Gordeev &lt;agordeev@linux.ibm.com&gt;
    > Fixes: 3d5854d75e31 (&quot;fs/proc/kcore.c: allow translation of physical memory addresses&quot;)
    > Signed-off-by: Jiri Olsa &lt;jolsa@kernel.org&gt;
    > Link: https://lore.kernel.org/r/20241121231118.3212000-1-jolsa@kernel.org
    > Acked-by: Alexander Gordeev &lt;agordeev@linux.ibm.com&gt;
    > Signed-off-by: Christian Brauner &lt;brauner@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ slab: Fix too strict alignment check in create_cache() (@Geert Uytterhoeven in [8b5aea5e5186733](https://github.com/sophgo/linux-riscv/commit/8b5aea5e5186733) at 2024-12-09 09:41:07)
    > commit 9008fe8fad8255edfdbecea32d7eb0485d939d0d upstream.
    > On m68k, where the minimum alignment of unsigned long is 2 bytes:
    > Kernel panic - not syncing: __kmem_cache_create_args: Failed to create slab &#x27;io_kiocb&#x27;. Error -22
    > CPU: 0 UID: 0 PID: 1 Comm: swapper Not tainted 6.12.0-atari-03776-g7eaa1f99261a #1783
    > Stack from 0102fe5c:
    > 0102fe5c 00514a2b 00514a2b ffffff00 00000001 0051f5ed 00425e78 00514a2b
    > 0041eb74 ffffffea 00000310 0051f5ed ffffffea ffffffea 00601f60 00000044
    > 0102ff20 000e7a68 0051ab8e 004383b8 0051f5ed ffffffea 000000b8 00000007
    > 01020c00 00000000 000e77f0 0041e5f0 005f67c0 0051f5ed 000000b6 0102fef4
    > 00000310 0102fef4 00000000 00000016 005f676c 0060a34c 00000010 00000004
    > 00000038 0000009a 01000000 000000b8 005f668e 0102e000 00001372 0102ff88
    > Call Trace: [&lt;00425e78&gt;] dump_stack+0xc/0x10
    > [&lt;0041eb74&gt;] panic+0xd8/0x26c
    > [&lt;000e7a68&gt;] __kmem_cache_create_args+0x278/0x2e8
    > [&lt;000e77f0&gt;] __kmem_cache_create_args+0x0/0x2e8
    > [&lt;0041e5f0&gt;] memset+0x0/0x8c
    > [&lt;005f67c0&gt;] io_uring_init+0x54/0xd2
    > The minimal alignment of an integral type may differ from its size,
    > hence is not safe to assume that an arbitrary freeptr_t (which is
    > basically an unsigned long) is always aligned to 4 or 8 bytes.
    > As nothing seems to require the additional alignment, it is safe to fix
    > this by relaxing the check to the actual minimum alignment of freeptr_t.
    > Fixes: aaa736b186239b7d (&quot;io_uring: specify freeptr usage for SLAB_TYPESAFE_BY_RCU io_kiocb cache&quot;)
    > Fixes: d345bd2e9834e2da (&quot;mm: add kmem_cache_create_rcu()&quot;)
    > Reported-by: Guenter Roeck &lt;linux@roeck-us.net&gt;
    > Closes: https://lore.kernel.org/37c588d4-2c32-4aad-a19e-642961f200d7@roeck-us.net
    > Cc: &lt;stable@vger.kernel.org&gt;
    > Signed-off-by: Geert Uytterhoeven &lt;geert@linux-m68k.org&gt;
    > Tested-by: Guenter Roeck &lt;linux@roeck-us.net&gt;
    > Reviewed-by: Jens Axboe &lt;axboe@kernel.dk&gt;
    > Signed-off-by: Vlastimil Babka &lt;vbabka@suse.cz&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ i3c: master: svc: Modify enabled_events bit 7:0 to act as IBI enable counter (@Frank Li in [768673a15bad3e9](https://github.com/sophgo/linux-riscv/commit/768673a15bad3e9) at 2024-12-09 09:41:07)
    > commit 25bc99be5fe53853053ceeaa328068c49dc1e799 upstream.
    > Fix issue where disabling IBI on one device disables the entire IBI
    > interrupt. Modify bit 7:0 of enabled_events to serve as an IBI enable
    > counter, ensuring that the system IBI interrupt is disabled only when all
    > I3C devices have IBI disabled.
    > Cc: stable@kernel.org
    > Fixes: 7ff730ca458e (&quot;i3c: master: svc: enable the interrupt in the enable ibi function&quot;)
    > Reviewed-by: Miquel Raynal &lt;miquel.raynal@bootlin.com&gt;
    > Signed-off-by: Frank Li &lt;Frank.Li@nxp.com&gt;
    > Link: https://lore.kernel.org/r/20241101165002.2479794-1-Frank.Li@nxp.com
    > Signed-off-by: Alexandre Belloni &lt;alexandre.belloni@bootlin.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ PCI: keystone: Add link up check to ks_pcie_other_map_bus() (@Kishon Vijay Abraham I in [5946dc018befa13](https://github.com/sophgo/linux-riscv/commit/5946dc018befa13) at 2024-12-09 09:41:07)
    > commit 9e9ec8d8692a6f64d81ef67d4fb6255af6be684b upstream.
    > K2G forwards the error triggered by a link-down state (e.g., no connected
    > endpoint device) on the system bus for PCI configuration transactions;
    > these errors are reported as an SError at system level, which is fatal and
    > hangs the system.
    > So, apply fix similar to how it was done in the DesignWare Core driver
    > commit 15b23906347c (&quot;PCI: dwc: Add link up check in dw_child_pcie_ops.map_bus()&quot;).
    > Fixes: 10a797c6e54a (&quot;PCI: dwc: keystone: Use pci_ops for config space accessors&quot;)
    > Link: https://lore.kernel.org/r/20240524105714.191642-3-s-vadapalli@ti.com
    > Signed-off-by: Kishon Vijay Abraham I &lt;kishon@ti.com&gt;
    > Signed-off-by: Siddharth Vadapalli &lt;s-vadapalli@ti.com&gt;
    > [kwilczynski: commit log, added tag for stable releases]
    > Signed-off-by: Krzysztof Wilczyński &lt;kwilczynski@kernel.org&gt;
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ i3c: master: svc: Fix pm_runtime_set_suspended() with runtime pm enabled (@Jinjie Ruan in [b2529be317f8879](https://github.com/sophgo/linux-riscv/commit/b2529be317f8879) at 2024-12-09 09:41:06)
    > commit 18599e93e4e814ce146186026c6abf83c14d5798 upstream.
    > It is not valid to call pm_runtime_set_suspended() for devices
    > with runtime PM enabled because it returns -EAGAIN if it is enabled
    > already and working. So, call pm_runtime_disable() before to fix it.
    > Cc: stable@vger.kernel.org # v5.17
    > Fixes: 05be23ef78f7 (&quot;i3c: master: svc: add runtime pm support&quot;)
    > Reviewed-by: Frank Li &lt;Frank.Li@nxp.com&gt;
    > Reviewed-by: Miquel Raynal &lt;miquel.raynal@bootlin.com&gt;
    > Signed-off-by: Jinjie Ruan &lt;ruanjinjie@huawei.com&gt;
    > Link: https://lore.kernel.org/r/20240930091913.2545510-1-ruanjinjie@huawei.com
    > Signed-off-by: Alexandre Belloni &lt;alexandre.belloni@bootlin.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ scsi: ufs: exynos: Fix hibern8 notify callbacks (@Peter Griffin in [7491d6255659bb1](https://github.com/sophgo/linux-riscv/commit/7491d6255659bb1) at 2024-12-09 09:41:06)
    > commit ceef938bbf8b93ba3a218b4adc244cde94b582aa upstream.
    > v1 of the patch which introduced the ufshcd_vops_hibern8_notify()
    > callback used a bool instead of an enum. In v2 this was updated to an
    > enum based on the review feedback in [1].
    > ufs-exynos hibernate calls have always been broken upstream as it
    > follows the v1 bool implementation.
    > Link: https://patchwork.kernel.org/project/linux-scsi/patch/001f01d23994$719997c0$54ccc740$@samsung.com/ [1]
    > Fixes: 55f4b1f73631 (&quot;scsi: ufs: ufs-exynos: Add UFS host support for Exynos SoCs&quot;)
    > Signed-off-by: Peter Griffin &lt;peter.griffin@linaro.org&gt;
    > Link: https://lore.kernel.org/r/20241031150033.3440894-13-peter.griffin@linaro.org
    > Cc: stable@vger.kernel.org
    > Reviewed-by: Tudor Ambarus &lt;tudor.ambarus@linaro.org&gt;
    > Signed-off-by: Martin K. Petersen &lt;martin.petersen@oracle.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ util_macros.h: fix/rework find_closest() macros (@Alexandru Ardelean in [3e5fbcbc388aa22](https://github.com/sophgo/linux-riscv/commit/3e5fbcbc388aa22) at 2024-12-09 09:41:06)
    > commit bc73b4186736341ab5cd2c199da82db6e1134e13 upstream.
    > A bug was found in the find_closest() (find_closest_descending() is also
    > affected after some testing), where for certain values with small
    > progressions, the rounding (done by averaging 2 values) causes an
    > incorrect index to be returned.  The rounding issues occur for
    > progressions of 1, 2 and 3.  It goes away when the progression/interval
    > between two values is 4 or larger.
    > It&#x27;s particularly bad for progressions of 1.  For example if there&#x27;s an
    > array of &#x27;a &#x3D; { 1, 2, 3 }&#x27;, using &#x27;find_closest(2, a ...)&#x27; would return 0
    > (the index of &#x27;1&#x27;), rather than returning 1 (the index of &#x27;2&#x27;).  This
    > means that for exact values (with a progression of 1), find_closest() will
    > misbehave and return the index of the value smaller than the one we&#x27;re
    > searching for.
    > For progressions of 2 and 3, the exact values are obtained correctly; but
    > values aren&#x27;t approximated correctly (as one would expect).  Starting with
    > progressions of 4, all seems to be good (one gets what one would expect).
    > While one could argue that &#x27;find_closest()&#x27; should not be used for arrays
    > with progressions of 1 (i.e. &#x27;{1, 2, 3, ...}&#x27;, the macro should still
    > behave correctly.
    > The bug was found while testing the &#x27;drivers/iio/adc/ad7606.c&#x27;,
    > specifically the oversampling feature.
    > For reference, the oversampling values are listed as:
    > static const unsigned int ad7606_oversampling_avail[7] &#x3D; {
    > 1, 2, 4, 8, 16, 32, 64,
    > };
    > When doing:
    > 1. $ echo 1 &gt; /sys/bus/iio/devices/iio\:device0/oversampling_ratio
    > $ cat /sys/bus/iio/devices/iio\:device0/oversampling_ratio
    > 1  # this is fine
    > 2. $ echo 2 &gt; /sys/bus/iio/devices/iio\:device0/oversampling_ratio
    > $ cat /sys/bus/iio/devices/iio\:device0/oversampling_ratio
    > 1  # this is wrong; 2 should be returned here
    > 3. $ echo 3 &gt; /sys/bus/iio/devices/iio\:device0/oversampling_ratio
    > $ cat /sys/bus/iio/devices/iio\:device0/oversampling_ratio
    > 2  # this is fine
    > 4. $ echo 4 &gt; /sys/bus/iio/devices/iio\:device0/oversampling_ratio
    > $ cat /sys/bus/iio/devices/iio\:device0/oversampling_ratio
    > 4  # this is fine
    > And from here-on, the values are as correct (one gets what one would
    > expect.)
    > While writing a kunit test for this bug, a peculiar issue was found for the
    > array in the &#x27;drivers/hwmon/ina2xx.c&#x27; &amp; &#x27;drivers/iio/adc/ina2xx-adc.c&#x27;
    > drivers. While running the kunit test (for &#x27;ina226_avg_tab&#x27; from these
    > drivers):
    > idx &#x3D; find_closest([-1 to 2], ina226_avg_tab, ARRAY_SIZE(ina226_avg_tab));
    > This returns idx &#x3D;&#x3D; 0, so value.
    > idx &#x3D; find_closest(3, ina226_avg_tab, ARRAY_SIZE(ina226_avg_tab));
    > This returns idx &#x3D;&#x3D; 0, value 1; and now one could argue whether 3 is
    > closer to 4 or to 1. This quirk only appears for value &#x27;3&#x27; in this
    > array, but it seems to be a another rounding issue.
    > And from 4 onwards the &#x27;find_closest&#x27;() works fine (one gets what one
    > would expect).
    > This change reworks the find_closest() macros to also check the difference
    > between the left and right elements when &#x27;x&#x27;. If the distance to the right
    > is smaller (than the distance to the left), the index is incremented by 1.
    > This also makes redundant the need for using the DIV_ROUND_CLOSEST() macro.
    > In order to accommodate for any mix of negative + positive values, the
    > internal variables &#x27;__fc_x&#x27;, &#x27;__fc_mid_x&#x27;, &#x27;__fc_left&#x27; &amp; &#x27;__fc_right&#x27; are
    > forced to &#x27;long&#x27; type. This also addresses any potential bugs/issues with
    > &#x27;x&#x27; being of an unsigned type. In those situations any comparison between
    > signed &amp; unsigned would be promoted to a comparison between 2 unsigned
    > numbers; this is especially annoying when &#x27;__fc_left&#x27; &amp; &#x27;__fc_right&#x27;
    > underflow.
    > The find_closest_descending() macro was also reworked and duplicated from
    > the find_closest(), and it is being iterated in reverse. The main reason
    > for this is to get the same indices as &#x27;find_closest()&#x27; (but in reverse).
    > The comparison for &#x27;__fc_right &lt; __fc_left&#x27; favors going the array in
    > ascending order.
    > For example for array &#x27;{ 1024, 512, 256, 128, 64, 16, 4, 1 }&#x27; and x &#x3D; 3, we
    > get:
    > __fc_mid_x &#x3D; 2
    > __fc_left &#x3D; -1
    > __fc_right &#x3D; -2
    > Then &#x27;__fc_right &lt; __fc_left&#x27; evaluates to true and &#x27;__fc_i++&#x27; becomes 7
    > which is not quite incorrect, but 3 is closer to 4 than to 1.
    > This change has been validated with the kunit from the next patch.
    > Link: https://lkml.kernel.org/r/20241105145406.554365-1-aardelean@baylibre.com
    > Fixes: 95d119528b0b (&quot;util_macros.h: add find_closest() macro&quot;)
    > Signed-off-by: Alexandru Ardelean &lt;aardelean@baylibre.com&gt;
    > Cc: Bartosz Golaszewski &lt;bartosz.golaszewski@linaro.org&gt;
    > Cc: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;
    > Cc: &lt;stable@vger.kernel.org&gt;
    > Signed-off-by: Andrew Morton &lt;akpm@linux-foundation.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ i3c: master: svc: fix possible assignment of the same address to two devices (@Frank Li in [34a55b54845d01f](https://github.com/sophgo/linux-riscv/commit/34a55b54845d01f) at 2024-12-09 09:41:06)
    > commit 3b2ac810d86eb96e882db80a3320a3848b133208 upstream.
    > svc_i3c_master_do_daa() {
    > ...
    > for (i &#x3D; 0; i &lt; dev_nb; i++) {
    > ret &#x3D; i3c_master_add_i3c_dev_locked(m, addrs[i]);
    > if (ret)
    > goto rpm_out;
    > }
    > }
    > If two devices (A and B) are detected in DAA and address 0xa is assigned to
    > device A and 0xb to device B, a failure in i3c_master_add_i3c_dev_locked()
    > for device A (addr: 0xa) could prevent device B (addr: 0xb) from being
    > registered on the bus. The I3C stack might still consider 0xb a free
    > address. If a subsequent Hotjoin occurs, 0xb might be assigned to Device A,
    > causing both devices A and B to use the same address 0xb, violating the I3C
    > specification.
    > The return value for i3c_master_add_i3c_dev_locked() should not be checked
    > because subsequent steps will scan the entire I3C bus, independent of
    > whether i3c_master_add_i3c_dev_locked() returns success.
    > If device A registration fails, there is still a chance to register device
    > B. i3c_master_add_i3c_dev_locked() can reset DAA if a failure occurs while
    > retrieving device information.
    > Cc: stable@kernel.org
    > Fixes: 317bacf960a4 (&quot;i3c: master: add enable(disable) hot join in sys entry&quot;)
    > Reviewed-by: Miquel Raynal &lt;miquel.raynal@bootlin.com&gt;
    > Signed-off-by: Frank Li &lt;Frank.Li@nxp.com&gt;
    > Link: https://lore.kernel.org/r/20241002-svc-i3c-hj-v6-6-7e6e1d3569ae@nxp.com
    > Signed-off-by: Alexandre Belloni &lt;alexandre.belloni@bootlin.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ s390/stacktrace: Use break instead of return statement (@Heiko Carstens in [20c26357826457d](https://github.com/sophgo/linux-riscv/commit/20c26357826457d) at 2024-12-09 09:41:06)
    > commit 588a9836a4ef7ec3bfcffda526dfa399637e6cfc upstream.
    > arch_stack_walk_user_common() contains a return statement instead of a
    > break statement in case store_ip() fails while trying to store a callchain
    > entry of a user space process.
    > This may lead to a missing pagefault_enable() call.
    > If this happens any subsequent page fault of the process won&#x27;t be resolved
    > by the page fault handler and this in turn will lead to the process being
    > killed.
    > Use a break instead of a return statement to fix this.
    > Fixes: ebd912ff9919 (&quot;s390/stacktrace: Merge perf_callchain_user() and arch_stack_walk_user()&quot;)
    > Cc: stable@vger.kernel.org
    > Reviewed-by: Jens Remus &lt;jremus@linux.ibm.com&gt;
    > Signed-off-by: Heiko Carstens &lt;hca@linux.ibm.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ i3c: master: Fix miss free init_dyn_addr at i3c_master_put_i3c_addrs() (@Frank Li in [0e8ab955c6d06f9](https://github.com/sophgo/linux-riscv/commit/0e8ab955c6d06f9) at 2024-12-09 09:41:06)
    > commit 3082990592f7c6d7510a9133afa46e31bbe26533 upstream.
    > if (dev-&gt;boardinfo &amp;&amp; dev-&gt;boardinfo-&gt;init_dyn_addr)
    > ^^^ here check &quot;init_dyn_addr&quot;
    > i3c_bus_set_addr_slot_status(&amp;master-&gt;bus, dev-&gt;info.dyn_addr, ...)
    > ^^^^
    > free &quot;dyn_addr&quot;
    > Fix copy/paste error &quot;dyn_addr&quot; by replacing it with &quot;init_dyn_addr&quot;.
    > Cc: stable@kernel.org
    > Fixes: 3a379bbcea0a (&quot;i3c: Add core I3C infrastructure&quot;)
    > Reviewed-by: Miquel Raynal &lt;miquel.raynal@bootlin.com&gt;
    > Signed-off-by: Frank Li &lt;Frank.Li@nxp.com&gt;
    > Link: https://lore.kernel.org/r/20241001162608.224039-1-Frank.Li@nxp.com
    > Signed-off-by: Alexandre Belloni &lt;alexandre.belloni@bootlin.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ scsi: ufs: exynos: Add check inside exynos_ufs_config_smu() (@Peter Griffin in [0581ec70b351f52](https://github.com/sophgo/linux-riscv/commit/0581ec70b351f52) at 2024-12-09 09:41:06)
    > commit c662cedea14efdcf373d8d886ec18019d50e0772 upstream.
    > Move the EXYNOS_UFS_OPT_UFSPR_SECURE check inside
    > exynos_ufs_config_smu().
    > This way all call sites will benefit from the check. This fixes a bug
    > currently in the exynos_ufs_resume() path on gs101 as it calls
    > exynos_ufs_config_smu() and we end up accessing registers that can only
    > be accessed from secure world which results in a serror.
    > Fixes: d11e0a318df8 (&quot;scsi: ufs: exynos: Add support for Tensor gs101 SoC&quot;)
    > Signed-off-by: Peter Griffin &lt;peter.griffin@linaro.org&gt;
    > Link: https://lore.kernel.org/r/20241031150033.3440894-5-peter.griffin@linaro.org
    > Cc: stable@vger.kernel.org
    > Reviewed-by: Tudor Ambarus &lt;tudor.ambarus@linaro.org&gt;
    > Signed-off-by: Martin K. Petersen &lt;martin.petersen@oracle.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ ceph: pass cred pointer to ceph_mds_auth_match() (@Max Kellermann in [ffa6ba7bdb7f07f](https://github.com/sophgo/linux-riscv/commit/ffa6ba7bdb7f07f) at 2024-12-09 09:41:05)
    > commit 23426309a4064b25a961e1c72961d8bfc7c8c990 upstream.
    > This eliminates a redundant get_current_cred() call, because
    > ceph_mds_check_access() has already obtained this pointer.
    > As a side effect, this also fixes a reference leak in
    > ceph_mds_auth_match(): by omitting the get_current_cred() call, no
    > additional cred reference is taken.
    > Cc: stable@vger.kernel.org
    > Fixes: 596afb0b8933 (&quot;ceph: add ceph_mds_check_access() helper&quot;)
    > Signed-off-by: Max Kellermann &lt;max.kellermann@ionos.com&gt;
    > Reviewed-by: Xiubo Li &lt;xiubli@redhat.com&gt;
    > Signed-off-by: Ilya Dryomov &lt;idryomov@gmail.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ ceph: fix cred leak in ceph_mds_check_access() (@Max Kellermann in [e3d1c9e2b811f13](https://github.com/sophgo/linux-riscv/commit/e3d1c9e2b811f13) at 2024-12-09 09:41:05)
    > commit c5cf420303256dcd6ff175643e9e9558543c2047 upstream.
    > get_current_cred() increments the reference counter, but the
    > put_cred() call was missing.
    > Cc: stable@vger.kernel.org
    > Fixes: 596afb0b8933 (&quot;ceph: add ceph_mds_check_access() helper&quot;)
    > Signed-off-by: Max Kellermann &lt;max.kellermann@ionos.com&gt;
    > Reviewed-by: Xiubo Li &lt;xiubli@redhat.com&gt;
    > Signed-off-by: Ilya Dryomov &lt;idryomov@gmail.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ mtd: spinand: winbond: Fix 512GW and 02JW OOB layout (@Miquel Raynal in [5e127c439298f8b](https://github.com/sophgo/linux-riscv/commit/5e127c439298f8b) at 2024-12-09 09:41:05)
    > commit c1247de51cab53fc357a73804c11fb4fba55b2d9 upstream.
    > Both W25N512GW and W25N02JW chips have 64 bytes of OOB and thus cannot
    > use the layout for 128 bytes OOB. Reference the correct layout instead.
    > Fixes: 6a804fb72de5 (&quot;mtd: spinand: winbond: add support for serial NAND flash&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Miquel Raynal &lt;miquel.raynal@bootlin.com&gt;
    > Reviewed-by: Frieder Schrempf &lt;frieder.schrempf@kontron.de&gt;
    > Link: https://lore.kernel.org/linux-mtd/20241009125002.191109-2-miquel.raynal@bootlin.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ ceph: extract entity name from device id (@Patrick Donnelly in [2431ce949f7f212](https://github.com/sophgo/linux-riscv/commit/2431ce949f7f212) at 2024-12-09 09:41:05)
    > commit 955710afcb3bb63e21e186451ed5eba85fa14d0b upstream.
    > Previously, the &quot;name&quot; in the new device syntax &quot;&lt;name&gt;@&lt;fsid&gt;.&lt;fsname&gt;&quot;
    > was ignored because (presumably) tests were done using mount.ceph which
    > also passed the entity name using &quot;-o name&#x3D;foo&quot;. If mounting is done
    > without the mount.ceph helper, the new device id syntax fails to set
    > the name properly.
    > Cc: stable@vger.kernel.org
    > Link: https://tracker.ceph.com/issues/68516
    > Signed-off-by: Patrick Donnelly &lt;pdonnell@redhat.com&gt;
    > Reviewed-by: Ilya Dryomov &lt;idryomov@gmail.com&gt;
    > Signed-off-by: Ilya Dryomov &lt;idryomov@gmail.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ mtd: spinand: winbond: Fix 512GW, 01GW, 01JW and 02JW ECC information (@Miquel Raynal in [234d5f75c3ae911](https://github.com/sophgo/linux-riscv/commit/234d5f75c3ae911) at 2024-12-09 09:41:05)
    > commit fee9b240916df82a8b07aef0fdfe96785417a164 upstream.
    > These four chips:
    > W25N512GW
    > W25N01GW
    > W25N01JW
    > W25N02JW
    > all require a single bit of ECC strength and thus feature an on-die
    > Hamming-like ECC engine. There is no point in filling a -&gt;get_status()
    > callback for them because the main ECC status bytes are located in
    > standard places, and retrieving the number of bitflips in case of
    > corrected chunk is both useless and unsupported (if there are bitflips,
    > then there is 1 at most, so no need to query the chip for that).
    > Without this change, a kernel warning triggers every time a bit flips.
    > Fixes: 6a804fb72de5 (&quot;mtd: spinand: winbond: add support for serial NAND flash&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Miquel Raynal &lt;miquel.raynal@bootlin.com&gt;
    > Reviewed-by: Frieder Schrempf &lt;frieder.schrempf@kontron.de&gt;
    > Link: https://lore.kernel.org/linux-mtd/20241009125002.191109-3-miquel.raynal@bootlin.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ f2fs: fix to drop all discards after creating snapshot on lvm device (@Chao Yu in [15136c3861a3341](https://github.com/sophgo/linux-riscv/commit/15136c3861a3341) at 2024-12-09 09:41:05)
    > commit bc8aeb04fd80cb8cfae3058445c84410fd0beb5e upstream.
    > Piergiorgio reported a bug in bugzilla as below:
    > ------------[ cut here ]------------
    > WARNING: CPU: 2 PID: 969 at fs/f2fs/segment.c:1330
    > RIP: 0010:__submit_discard_cmd+0x27d/0x400 [f2fs]
    > Call Trace:
    > __issue_discard_cmd+0x1ca/0x350 [f2fs]
    > issue_discard_thread+0x191/0x480 [f2fs]
    > kthread+0xcf/0x100
    > ret_from_fork+0x31/0x50
    > ret_from_fork_asm+0x1a/0x30
    > w/ below testcase, it can reproduce this bug quickly:
    > - pvcreate /dev/vdb
    > - vgcreate myvg1 /dev/vdb
    > - lvcreate -L 1024m -n mylv1 myvg1
    > - mount /dev/myvg1/mylv1 /mnt/f2fs
    > - dd if&#x3D;/dev/zero of&#x3D;/mnt/f2fs/file bs&#x3D;1M count&#x3D;20
    > - sync
    > - rm /mnt/f2fs/file
    > - sync
    > - lvcreate -L 1024m -s -n mylv1-snapshot /dev/myvg1/mylv1
    > - umount /mnt/f2fs
    > The root cause is: it will update discard_max_bytes of mounted lvm
    > device to zero after creating snapshot on this lvm device, then,
    > __submit_discard_cmd() will pass parameter @nr_sects w/ zero value
    > to __blkdev_issue_discard(), it returns a NULL bio pointer, result
    > in panic.
    > This patch changes as below for fixing:
    > 1. Let&#x27;s drop all remained discards in f2fs_unfreeze() if snapshot
    > of lvm device is created.
    > 2. Checking discard_max_bytes before submitting discard during
    > __submit_discard_cmd().
    > Cc: stable@vger.kernel.org
    > Fixes: 35ec7d574884 (&quot;f2fs: split discard command in prior to block layer&quot;)
    > Reported-by: Piergiorgio Sartor &lt;piergiorgio.sartor@nexgo.de&gt;
    > Closes: https://bugzilla.kernel.org/show_bug.cgi?id&#x3D;219484
    > Signed-off-by: Chao Yu &lt;chao@kernel.org&gt;
    > Signed-off-by: Jaegeuk Kim &lt;jaegeuk@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ PCI: imx6: Fix suspend/resume support on i.MX6QDL (@Stefan Eichenberger in [ac43ea3d27a8f9b](https://github.com/sophgo/linux-riscv/commit/ac43ea3d27a8f9b) at 2024-12-09 09:41:04)
    > commit 0a726f542d7c8cc0f9c5ed7df5a4bd4b59ac21b3 upstream.
    > The suspend/resume functionality is currently broken on the i.MX6QDL
    > platform, as documented in the NXP errata (ERR005723):
    > https://www.nxp.com/docs/en/errata/IMX6DQCE.pdf
    > This patch addresses the issue by sharing most of the suspend/resume
    > sequences used by other i.MX devices, while avoiding modifications to
    > critical registers that disrupt the PCIe functionality. It targets the
    > same problem as the following downstream commit:
    > https://github.com/nxp-imx/linux-imx/commit/4e92355e1f79d225ea842511fcfd42b343b32995
    > Unlike the downstream commit, this patch also resets the connected PCIe
    > device if possible. Without this reset, certain drivers, such as ath10k
    > or iwlwifi, will crash on resume. The device reset is also done by the
    > driver on other i.MX platforms, making this patch consistent with
    > existing practices.
    > Upon resuming, the kernel will hang and display an error. Here&#x27;s an
    > example of the error encountered with the ath10k driver:
    > ath10k_pci 0000:01:00.0: Unable to change power state from D3hot to D0, device inaccessible
    > Unhandled fault: imprecise external abort (0x1406) at 0x0106f944
    > Without this patch, suspend/resume will fail on i.MX6QDL devices if a
    > PCIe device is connected.
    > Link: https://lore.kernel.org/r/20241030103250.83640-1-eichest@gmail.com
    > Signed-off-by: Stefan Eichenberger &lt;stefan.eichenberger@toradex.com&gt;
    > [kwilczynski: commit log, added tag for stable releases]
    > Signed-off-by: Krzysztof Wilczyński &lt;kwilczynski@kernel.org&gt;
    > Reviewed-by: Manivannan Sadhasivam &lt;manivannan.sadhasivam@linaro.org&gt;
    > Acked-by: Richard Zhu &lt;hongxing.zhu@nxp.com&gt;
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ mm/slub: Avoid list corruption when removing a slab from the full list (@yuan.gao in [943c0f601cd28c1](https://github.com/sophgo/linux-riscv/commit/943c0f601cd28c1) at 2024-12-09 09:41:04)
    > commit dbc16915279a548a204154368da23d402c141c81 upstream.
    > Boot with slub_debug&#x3D;UFPZ.
    > If allocated object failed in alloc_consistency_checks, all objects of
    > the slab will be marked as used, and then the slab will be removed from
    > the partial list.
    > When an object belonging to the slab got freed later, the remove_full()
    > function is called. Because the slab is neither on the partial list nor
    > on the full list, it eventually lead to a list corruption (actually a
    > list poison being detected).
    > So we need to mark and isolate the slab page with metadata corruption,
    > do not put it back in circulation.
    > Because the debug caches avoid all the fastpaths, reusing the frozen bit
    > to mark slab page with metadata corruption seems to be fine.
    > [ 4277.385669] list_del corruption, ffffea00044b3e50-&gt;next is LIST_POISON1 (dead000000000100)
    > [ 4277.387023] ------------[ cut here ]------------
    > [ 4277.387880] kernel BUG at lib/list_debug.c:56!
    > [ 4277.388680] invalid opcode: 0000 [#1] PREEMPT SMP PTI
    > [ 4277.389562] CPU: 5 PID: 90 Comm: kworker/5:1 Kdump: loaded Tainted: G           OE      6.6.1-1 #1
    > [ 4277.392113] Workqueue: xfs-inodegc/vda1 xfs_inodegc_worker [xfs]
    > [ 4277.393551] RIP: 0010:__list_del_entry_valid_or_report+0x7b/0xc0
    > [ 4277.394518] Code: 48 91 82 e8 37 f9 9a ff 0f 0b 48 89 fe 48 c7 c7 28 49 91 82 e8 26 f9 9a ff 0f 0b 48 89 fe 48 c7 c7 58 49 91
    > [ 4277.397292] RSP: 0018:ffffc90000333b38 EFLAGS: 00010082
    > [ 4277.398202] RAX: 000000000000004e RBX: ffffea00044b3e50 RCX: 0000000000000000
    > [ 4277.399340] RDX: 0000000000000002 RSI: ffffffff828f8715 RDI: 00000000ffffffff
    > [ 4277.400545] RBP: ffffea00044b3e40 R08: 0000000000000000 R09: ffffc900003339f0
    > [ 4277.401710] R10: 0000000000000003 R11: ffffffff82d44088 R12: ffff888112cf9910
    > [ 4277.402887] R13: 0000000000000001 R14: 0000000000000001 R15: ffff8881000424c0
    > [ 4277.404049] FS:  0000000000000000(0000) GS:ffff88842fd40000(0000) knlGS:0000000000000000
    > [ 4277.405357] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
    > [ 4277.406389] CR2: 00007f2ad0b24000 CR3: 0000000102a3a006 CR4: 00000000007706e0
    > [ 4277.407589] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
    > [ 4277.408780] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
    > [ 4277.410000] PKRU: 55555554
    > [ 4277.410645] Call Trace:
    > [ 4277.411234]  &lt;TASK&gt;
    > [ 4277.411777]  ? die+0x32/0x80
    > [ 4277.412439]  ? do_trap+0xd6/0x100
    > [ 4277.413150]  ? __list_del_entry_valid_or_report+0x7b/0xc0
    > [ 4277.414158]  ? do_error_trap+0x6a/0x90
    > [ 4277.414948]  ? __list_del_entry_valid_or_report+0x7b/0xc0
    > [ 4277.415915]  ? exc_invalid_op+0x4c/0x60
    > [ 4277.416710]  ? __list_del_entry_valid_or_report+0x7b/0xc0
    > [ 4277.417675]  ? asm_exc_invalid_op+0x16/0x20
    > [ 4277.418482]  ? __list_del_entry_valid_or_report+0x7b/0xc0
    > [ 4277.419466]  ? __list_del_entry_valid_or_report+0x7b/0xc0
    > [ 4277.420410]  free_to_partial_list+0x515/0x5e0
    > [ 4277.421242]  ? xfs_iext_remove+0x41a/0xa10 [xfs]
    > [ 4277.422298]  xfs_iext_remove+0x41a/0xa10 [xfs]
    > [ 4277.423316]  ? xfs_inodegc_worker+0xb4/0x1a0 [xfs]
    > [ 4277.424383]  xfs_bmap_del_extent_delay+0x4fe/0x7d0 [xfs]
    > [ 4277.425490]  __xfs_bunmapi+0x50d/0x840 [xfs]
    > [ 4277.426445]  xfs_itruncate_extents_flags+0x13a/0x490 [xfs]
    > [ 4277.427553]  xfs_inactive_truncate+0xa3/0x120 [xfs]
    > [ 4277.428567]  xfs_inactive+0x22d/0x290 [xfs]
    > [ 4277.429500]  xfs_inodegc_worker+0xb4/0x1a0 [xfs]
    > [ 4277.430479]  process_one_work+0x171/0x340
    > [ 4277.431227]  worker_thread+0x277/0x390
    > [ 4277.431962]  ? __pfx_worker_thread+0x10/0x10
    > [ 4277.432752]  kthread+0xf0/0x120
    > [ 4277.433382]  ? __pfx_kthread+0x10/0x10
    > [ 4277.434134]  ret_from_fork+0x2d/0x50
    > [ 4277.434837]  ? __pfx_kthread+0x10/0x10
    > [ 4277.435566]  ret_from_fork_asm+0x1b/0x30
    > [ 4277.436280]  &lt;/TASK&gt;
    > Fixes: 643b113849d8 (&quot;slub: enable tracking of full slabs&quot;)
    > Suggested-by: Hyeonggon Yoo &lt;42.hyeyoo@gmail.com&gt;
    > Suggested-by: Vlastimil Babka &lt;vbabka@suse.cz&gt;
    > Cc: &lt;stable@vger.kernel.org&gt;
    > Signed-off-by: yuan.gao &lt;yuan.gao@ucloud.cn&gt;
    > Reviewed-by: Hyeonggon Yoo &lt;42.hyeyoo@gmail.com&gt;
    > Acked-by: Christoph Lameter &lt;cl@linux.com&gt;
    > Signed-off-by: Vlastimil Babka &lt;vbabka@suse.cz&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ PCI: qcom: Disable ASPM L0s for X1E80100 (@Qiang Yu in [8cc7aba7b6d9a80](https://github.com/sophgo/linux-riscv/commit/8cc7aba7b6d9a80) at 2024-12-09 09:41:04)
    > commit fba6045161d686adc102b6ef71b2fd1e5f90a616 upstream.
    > Currently, the cfg_1_9_0 which is being used for X1E80100 doesn&#x27;t disable
    > ASPM L0s. However, hardware team recommends to disable L0s as the PHY init
    > sequence is not tuned support L0s. Hence reuse cfg_sc8280xp for X1E80100.
    > Note that the config_sid() callback is not present in cfg_sc8280xp, don&#x27;t
    > concern about this because config_sid() callback is originally a no-op
    > for X1E80100.
    > Fixes: 6d0c39324c5f (&quot;PCI: qcom: Add X1E80100 PCIe support&quot;)
    > Link: https://lore.kernel.org/r/20241101030902.579789-5-quic_qianyu@quicinc.com
    > Signed-off-by: Qiang Yu &lt;quic_qianyu@quicinc.com&gt;
    > Signed-off-by: Krzysztof Wilczyński &lt;kwilczynski@kernel.org&gt;
    > Reviewed-by: Dmitry Baryshkov &lt;dmitry.baryshkov@linaro.org&gt;
    > Reviewed-by: Johan Hovold &lt;johan+linaro@kernel.org&gt;
    > Reviewed-by: Manivannan Sadhasivam &lt;manivannan.sadhasivam@linaro.org&gt;
    > Cc: &lt;stable@vger.kernel.org&gt; # 6.9
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ remoteproc: qcom_q6v5_pas: disable auto boot for wpss (@Balaji Pothunoori in [7eba7f8c65fc011](https://github.com/sophgo/linux-riscv/commit/7eba7f8c65fc011) at 2024-12-09 09:41:04)
    > commit 8a47704d64c9afda80e7f399ba2cf898cfcc45b2 upstream.
    > Currently, the rproc &quot;atomic_t power&quot; variable is incremented during:
    > a. WPSS rproc auto boot.
    > b. AHB power on for ath11k.
    > During AHB power off (rmmod ath11k_ahb.ko), rproc_shutdown fails
    > to unload the WPSS firmware because the rproc-&gt;power value is &#x27;2&#x27;,
    > causing the atomic_dec_and_test(&amp;rproc-&gt;power) condition to fail.
    > Consequently, during AHB power on (insmod ath11k_ahb.ko),
    > QMI_WLANFW_HOST_CAP_REQ_V01 fails due to the host and firmware QMI
    > states being out of sync.
    > Fixes: 300ed425dfa9 (&quot;remoteproc: qcom_q6v5_pas: Add SC7280 ADSP, CDSP &amp; WPSS&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Balaji Pothunoori &lt;quic_bpothuno@quicinc.com&gt;
    > Reviewed-by: Dmitry Baryshkov &lt;dmitry.baryshkov@linaro.org&gt;
    > Link: https://lore.kernel.org/r/20241018105911.165415-1-quic_bpothuno@quicinc.com
    > Signed-off-by: Bjorn Andersson &lt;andersson@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ perf jevents: fix breakage when do perf stat on system metric (@Xu Yang in [5fe7c08e758d0ee](https://github.com/sophgo/linux-riscv/commit/5fe7c08e758d0ee) at 2024-12-09 09:41:04)
    > commit 4a159e6049f319bef6f9e6d2ccdd322f57d24830 upstream.
    > When do perf stat on sys metric, perf tool output nothing now:
    > $ perf stat -a -M imx95_ddr_read.all -I 1000
    > $
    > This command runs on an arm64 machine and the Soc has one DDR hw pmu
    > except one armv8_cortex_a55 pmu. Their maps show as follows:
    > const struct pmu_events_map pmu_events_map[] &#x3D; {
    > {
    > .arch &#x3D; &quot;arm64&quot;,
    > .cpuid &#x3D; &quot;0x00000000410fd050&quot;,
    > .event_table &#x3D; {
    > .pmus &#x3D; pmu_events__arm_cortex_a55,
    > .num_pmus &#x3D; ARRAY_SIZE(pmu_events__arm_cortex_a55)
    > },
    > .metric_table &#x3D; {
    > .pmus &#x3D; NULL,
    > .num_pmus &#x3D; 0
    > }
    > },
    > static const struct pmu_sys_events pmu_sys_event_tables[] &#x3D; {
    > {
    > .event_table &#x3D; {
    > .pmus &#x3D; pmu_events__freescale_imx95_sys,
    > .num_pmus &#x3D; ARRAY_SIZE(pmu_events__freescale_imx95_sys)
    > },
    > .metric_table &#x3D; {
    > .pmus &#x3D; pmu_metrics__freescale_imx95_sys,
    > .num_pmus &#x3D; ARRAY_SIZE(pmu_metrics__freescale_imx95_sys)
    > },
    > .name &#x3D; &quot;pmu_events__freescale_imx95_sys&quot;,
    > },
    > Currently, pmu_metrics_table__find() will return NULL when only do perf
    > stat on sys metric. Then parse_groups() will never be called to parse
    > sys metric_name, finally perf tool will exit directly. This should be a
    > common problem.
    > To fix the issue, this will keep the logic before commit f20c15d13f01
    > (&quot;perf pmu-events: Remember the perf_events_map for a PMU&quot;) to return a
    > empty metric table rather than a NULL pointer.
    > This should be fine since the removed part just check if the table match
    > provided metric_name.  Without these code, the code in parse_groups()
    > will also check the validity of metrci_name too.
    > Fixes: f20c15d13f017d4b (&quot;perf pmu-events: Remember the perf_events_map for a PMU&quot;)
    > Reviewed-by: James Clark &lt;james.clark@linaro.org&gt;
    > Signed-off-by: Xu Yang &lt;xu.yang_2@nxp.com&gt;
    > Tested-by: Xu Yang &lt;xu.yang_2@nxp.com&gt;
    > Acked-by: Ian Rogers &lt;irogers@google.com&gt;
    > Cc: Adrian Hunter &lt;adrian.hunter@intel.com&gt;
    > Cc: Albert Ou &lt;aou@eecs.berkeley.edu&gt;
    > Cc: Alexander Shishkin &lt;alexander.shishkin@linux.intel.com&gt;
    > Cc: Alexandre Ghiti &lt;alexghiti@rivosinc.com&gt;
    > Cc: Athira Rajeev &lt;atrajeev@linux.vnet.ibm.com&gt;
    > Cc: Benjamin Gray &lt;bgray@linux.ibm.com&gt;
    > Cc: Ben Zong-You Xie &lt;ben717@andestech.com&gt;
    > Cc: Bibo Mao &lt;maobibo@loongson.cn&gt;
    > Cc: Clément Le Goffic &lt;clement.legoffic@foss.st.com&gt;
    > Cc: Dima Kogan &lt;dima@secretsauce.net&gt;
    > Cc: Dr. David Alan Gilbert &lt;linux@treblig.org&gt;
    > Cc: Huacai Chen &lt;chenhuacai@kernel.org&gt;
    > Cc: Ingo Molnar &lt;mingo@redhat.com&gt;
    > Cc: Jiri Olsa &lt;jolsa@kernel.org&gt;
    > Cc: John Garry &lt;john.g.garry@oracle.com&gt;
    > Cc: Kan Liang &lt;kan.liang@linux.intel.com&gt;
    > Cc: Leo Yan &lt;leo.yan@linux.dev&gt;
    > Cc: Mark Rutland &lt;mark.rutland@arm.com&gt;
    > Cc: Masami Hiramatsu &lt;mhiramat@kernel.org&gt;
    > Cc: Mike Leach &lt;mike.leach@linaro.org&gt;
    > Cc: Namhyung Kim &lt;namhyung@kernel.org&gt;
    > Cc: Palmer Dabbelt &lt;palmer@dabbelt.com&gt;
    > Cc: Paul Walmsley &lt;paul.walmsley@sifive.com&gt;
    > Cc: Peter Zijlstra &lt;peterz@infradead.org&gt;
    > Cc: Ravi Bangoria &lt;ravi.bangoria@amd.com&gt;
    > Cc: Sandipan Das &lt;sandipan.das@amd.com&gt;
    > Cc: Will Deacon &lt;will@kernel.org&gt;
    > Cc: Yicong Yang &lt;yangyicong@hisilicon.com&gt;
    > Cc: linux-arm-kernel@lists.infradead.org
    > Cc: linux-riscv@lists.infradead.org
    > Cc: stable@vger.kernel.org
    > Link: https://lore.kernel.org/r/20241107162035.52206-2-irogers@google.com
    > Signed-off-by: Ian Rogers &lt;irogers@google.com&gt;
    > Signed-off-by: Arnaldo Carvalho de Melo &lt;acme@redhat.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ net: stmmac: set initial EEE policy configuration (@Choong Yong Liang in [33544a590df2cec](https://github.com/sophgo/linux-riscv/commit/33544a590df2cec) at 2024-12-09 09:41:04)
    > commit 59c5e1411a0a13ebb930f4ebba495cc4eb14f8f2 upstream.
    > Set the initial eee_cfg values to have &#x27;ethtool --show-eee &#x27; display
    > the initial EEE configuration.
    > Fixes: 49168d1980e2 (&quot;net: phy: Add phy_support_eee() indicating MAC support EEE&quot;)
    > Cc: &lt;stable@vger.kernel.org&gt;
    > Signed-off-by: Choong Yong Liang &lt;yong.liang.choong@linux.intel.com&gt;
    > Reviewed-by: Jacob Keller &lt;jacob.e.keller@intel.com&gt;
    > Link: https://patch.msgid.link/20241120083818.1079456-1-yong.liang.choong@linux.intel.com
    > Signed-off-by: Paolo Abeni &lt;pabeni@redhat.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ vfio/qat: fix overflow check in qat_vf_resume_write() (@Giovanni Cabiddu in [15bfacdb85394b6](https://github.com/sophgo/linux-riscv/commit/15bfacdb85394b6) at 2024-12-09 09:41:04)
    > commit 9283b7392570421c22a6c8058614f5b76a46b81c upstream.
    > The unsigned variable &#x60;size_t len&#x60; is cast to the signed type &#x60;loff_t&#x60;
    > when passed to the function check_add_overflow(). This function considers
    > the type of the destination, which is of type loff_t (signed),
    > potentially leading to an overflow. This issue is similar to the one
    > described in the link below.
    > Remove the cast.
    > Note that even if check_add_overflow() is bypassed, by setting &#x60;len&#x60; to
    > a value that is greater than LONG_MAX (which is considered as a negative
    > value after the cast), the function copy_from_user(), invoked a few lines
    > later, will not perform any copy and return &#x60;len&#x60; as (len &gt; INT_MAX)
    > causing qat_vf_resume_write() to fail with -EFAULT.
    > Fixes: bb208810b1ab (&quot;vfio/qat: Add vfio_pci driver for Intel QAT SR-IOV VF devices&quot;)
    > CC: stable@vger.kernel.org # 6.10+
    > Link: https://lore.kernel.org/all/138bd2e2-ede8-4bcc-aa7b-f3d9de167a37@moroto.mountain
    > Reported-by: Zijie Zhao &lt;zzjas98@gmail.com&gt;
    > Signed-off-by: Giovanni Cabiddu &lt;giovanni.cabiddu@intel.com&gt;
    > Reviewed-by: Xin Zeng &lt;xin.zeng@intel.com&gt;
    > Link: https://lore.kernel.org/r/20241021123843.42979-1-giovanni.cabiddu@intel.com
    > Signed-off-by: Alex Williamson &lt;alex.williamson@redhat.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ nvmem: core: Check read_only flag for force_ro in bin_attr_nvmem_write() (@Marek Vasut in [d60e418834b931f](https://github.com/sophgo/linux-riscv/commit/d60e418834b931f) at 2024-12-09 09:41:03)
    > commit da9596955c05966768364ab1cad2f43fcddc6f06 upstream.
    > The bin_attr_nvmem_write() must check the read_only flag and block
    > writes on read-only devices, now that a nvmem device can be switched
    > between read-write and read-only mode at runtime using the force_ro
    > attribute. Add the missing check.
    > Fixes: 9d7eb234ac7a (&quot;nvmem: core: Implement force_ro sysfs attribute&quot;)
    > Cc: Stable@vger.kernel.org
    > Signed-off-by: Marek Vasut &lt;marex@denx.de&gt;
    > Signed-off-by: Srinivas Kandagatla &lt;srinivas.kandagatla@linaro.org&gt;
    > Link: https://lore.kernel.org/r/20241030140253.40445-2-srinivas.kandagatla@linaro.org
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ driver core: fw_devlink: Stop trying to optimize cycle detection logic (@Saravana Kannan in [d34bf994bb973db](https://github.com/sophgo/linux-riscv/commit/d34bf994bb973db) at 2024-12-09 09:41:03)
    > commit bac3b10b78e54b7da3cede397258f75a2180609b upstream.
    > In attempting to optimize fw_devlink runtime, I introduced numerous cycle
    > detection bugs by foregoing cycle detection logic under specific
    > conditions. Each fix has further narrowed the conditions for optimization.
    > It&#x27;s time to give up on these optimization attempts and just run the cycle
    > detection logic every time fw_devlink tries to create a device link.
    > The specific bug report that triggered this fix involved a supplier fwnode
    > that never gets a device created for it. Instead, the supplier fwnode is
    > represented by the device that corresponds to an ancestor fwnode.
    > In this case, fw_devlink didn&#x27;t do any cycle detection because the cycle
    > detection logic is only run when a device link is created between the
    > devices that correspond to the actual consumer and supplier fwnodes.
    > With this change, fw_devlink will run cycle detection logic even when
    > creating SYNC_STATE_ONLY proxy device links from a device that is an
    > ancestor of a consumer fwnode.
    > Reported-by: Tomi Valkeinen &lt;tomi.valkeinen@ideasonboard.com&gt;
    > Closes: https://lore.kernel.org/all/1a1ab663-d068-40fb-8c94-f0715403d276@ideasonboard.com/
    > Fixes: 6442d79d880c (&quot;driver core: fw_devlink: Improve detection of overlapping cycles&quot;)
    > Cc: stable &lt;stable@kernel.org&gt;
    > Tested-by: Tomi Valkeinen &lt;tomi.valkeinen@ideasonboard.com&gt;
    > Signed-off-by: Saravana Kannan &lt;saravanak@google.com&gt;
    > Link: https://lore.kernel.org/r/20241030171009.1853340-1-saravanak@google.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ ARM: 9430/1: entry: Do a dummy read from VMAP shadow (@Linus Walleij in [c86d26b4b089ca2](https://github.com/sophgo/linux-riscv/commit/c86d26b4b089ca2) at 2024-12-09 09:41:03)
    > commit 44e9a3bb76e5f2eecd374c8176b2c5163c8bb2e2 upstream.
    > When switching task, in addition to a dummy read from the new
    > VMAP stack, also do a dummy read from the VMAP stack&#x27;s
    > corresponding KASAN shadow memory to sync things up in
    > the new MM context.
    > Cc: stable@vger.kernel.org
    > Fixes: a1c510d0adc6 (&quot;ARM: implement support for vmap&#x27;ed stacks&quot;)
    > Link: https://lore.kernel.org/linux-arm-kernel/a1a1d062-f3a2-4d05-9836-3b098de9db6d@foss.st.com/
    > Reported-by: Clement LE GOFFIC &lt;clement.legoffic@foss.st.com&gt;
    > Suggested-by: Ard Biesheuvel &lt;ardb@kernel.org&gt;
    > Signed-off-by: Linus Walleij &lt;linus.walleij@linaro.org&gt;
    > Signed-off-by: Russell King (Oracle) &lt;rmk+kernel@armlinux.org.uk&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ ARM: 9429/1: ioremap: Sync PGDs for VMALLOC shadow (@Linus Walleij in [ad6750c17fb4d44](https://github.com/sophgo/linux-riscv/commit/ad6750c17fb4d44) at 2024-12-09 09:41:03)
    > commit d6e6a74d4cea853b5321eeabb69c611148eedefe upstream.
    > When sync:ing the VMALLOC area to other CPUs, make sure to also
    > sync the KASAN shadow memory for the VMALLOC area, so that we
    > don&#x27;t get stale entries for the shadow memory in the top level PGD.
    > Since we are now copying PGDs in two instances, create a helper
    > function named memcpy_pgd() to do the actual copying, and
    > create a helper to map the addresses of VMALLOC_START and
    > VMALLOC_END into the corresponding shadow memory.
    > Co-developed-by: Melon Liu &lt;melon1335@163.com&gt;
    > Cc: stable@vger.kernel.org
    > Fixes: 565cbaad83d8 (&quot;ARM: 9202/1: kasan: support CONFIG_KASAN_VMALLOC&quot;)
    > Link: https://lore.kernel.org/linux-arm-kernel/a1a1d062-f3a2-4d05-9836-3b098de9db6d@foss.st.com/
    > Reported-by: Clement LE GOFFIC &lt;clement.legoffic@foss.st.com&gt;
    > Suggested-by: Mark Rutland &lt;mark.rutland@arm.com&gt;
    > Suggested-by: Russell King (Oracle) &lt;rmk+kernel@armlinux.org.uk&gt;
    > Acked-by: Mark Rutland &lt;mark.rutland@arm.com&gt;
    > Signed-off-by: Linus Walleij &lt;linus.walleij@linaro.org&gt;
    > Signed-off-by: Russell King (Oracle) &lt;rmk+kernel@armlinux.org.uk&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ s390/entry: Mark IRQ entries to fix stack depot warnings (@Vasily Gorbik in [473ffae3030188f](https://github.com/sophgo/linux-riscv/commit/473ffae3030188f) at 2024-12-09 09:41:03)
    > commit 45c9f2b856a075a34873d00788d2e8a250c1effd upstream.
    > The stack depot filters out everything outside of the top interrupt
    > context as an uninteresting or irrelevant part of the stack traces. This
    > helps with stack trace de-duplication, avoiding an explosion of saved
    > stack traces that share the same IRQ context code path but originate
    > from different randomly interrupted points, eventually exhausting the
    > stack depot.
    > Filtering uses in_irqentry_text() to identify functions within the
    > .irqentry.text and .softirqentry.text sections, which then become the
    > last stack trace entries being saved.
    > While __do_softirq() is placed into the .softirqentry.text section by
    > common code, populating .irqentry.text is architecture-specific.
    > Currently, the .irqentry.text section on s390 is empty, which prevents
    > stack depot filtering and de-duplication and could result in warnings
    > like:
    > Stack depot reached limit capacity
    > WARNING: CPU: 0 PID: 286113 at lib/stackdepot.c:252 depot_alloc_stack+0x39a/0x3c8
    > with PREEMPT and KASAN enabled.
    > Fix this by moving the IO/EXT interrupt handlers from .kprobes.text into
    > the .irqentry.text section and updating the kprobes blacklist to include
    > the .irqentry.text section.
    > This is done only for asynchronous interrupts and explicitly not for
    > program checks, which are synchronous and where the context beyond the
    > program check is important to preserve. Despite machine checks being
    > somewhat in between, they are extremely rare, and preserving context
    > when possible is also of value.
    > SVCs and Restart Interrupts are not relevant, one being always at the
    > boundary to user space and the other being a one-time thing.
    > IRQ entries filtering is also optionally used in ftrace function graph,
    > where the same logic applies.
    > Cc: stable@vger.kernel.org # 5.15+
    > Reviewed-by: Heiko Carstens &lt;hca@linux.ibm.com&gt;
    > Signed-off-by: Vasily Gorbik &lt;gor@linux.ibm.com&gt;
    > Signed-off-by: Heiko Carstens &lt;hca@linux.ibm.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ spmi: pmic-arb: fix return path in for_each_available_child_of_node() (@Javier Carrasco in [43cc7939f5e62b3](https://github.com/sophgo/linux-riscv/commit/43cc7939f5e62b3) at 2024-12-09 09:41:03)
    > commit 77adf4b1f3e1fdb319f7ee515e5924bb77df3916 upstream.
    > This loop requires explicit calls to of_node_put() upon early exits
    > (break, goto, return) to decrement the child refcounter and avoid memory
    > leaks if the child is not required out of the loop.
    > A more robust solution is using the scoped variant of the macro, which
    > automatically calls of_node_put() when the child goes out of scope.
    > Cc: stable@vger.kernel.org
    > Fixes: 979987371739 (&quot;spmi: pmic-arb: Add multi bus support&quot;)
    > Signed-off-by: Javier Carrasco &lt;javier.carrasco.cruz@gmail.com&gt;
    > Link: https://lore.kernel.org/r/20241001-spmi-pmic-arb-scoped-v1-1-5872bab34ed6@gmail.com
    > Reviewed-by: Neil Armstrong &lt;neil.armstrong@linaro.org&gt;
    > Signed-off-by: Stephen Boyd &lt;sboyd@kernel.org&gt;
    > Link: https://lore.kernel.org/r/20241109002829.160973-2-sboyd@kernel.org
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ ARM: 9431/1: mm: Pair atomic_set_release() with _read_acquire() (@Linus Walleij in [0cfd6929fa780a3](https://github.com/sophgo/linux-riscv/commit/0cfd6929fa780a3) at 2024-12-09 09:41:03)
    > commit 93ee385254d53849c01dd8ab9bc9d02790ee7f0e upstream.
    > The code for syncing vmalloc memory PGD pointers is using
    > atomic_read() in pair with atomic_set_release() but the
    > proper pairing is atomic_read_acquire() paired with
    > atomic_set_release().
    > This is done to clearly instruct the compiler to not
    > reorder the memcpy() or similar calls inside the section
    > so that we do not observe changes to init_mm. memcpy()
    > calls should be identified by the compiler as having
    > unpredictable side effects, but let&#x27;s try to be on the
    > safe side.
    > Cc: stable@vger.kernel.org
    > Fixes: d31e23aff011 (&quot;ARM: mm: make vmalloc_seq handling SMP safe&quot;)
    > Suggested-by: Mark Rutland &lt;mark.rutland@arm.com&gt;
    > Signed-off-by: Linus Walleij &lt;linus.walleij@linaro.org&gt;
    > Signed-off-by: Russell King (Oracle) &lt;rmk+kernel@armlinux.org.uk&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ ad7780: fix division by zero in ad7780_write_raw() (@Zicheng Qu in [f25a9f1df1f6738](https://github.com/sophgo/linux-riscv/commit/f25a9f1df1f6738) at 2024-12-09 09:41:02)
    > commit c174b53e95adf2eece2afc56cd9798374919f99a upstream.
    > In the ad7780_write_raw() , val2 can be zero, which might lead to a
    > division by zero error in DIV_ROUND_CLOSEST(). The ad7780_write_raw()
    > is based on iio_info&#x27;s write_raw. While val is explicitly declared that
    > can be zero (in read mode), val2 is not specified to be non-zero.
    > Fixes: 9085daa4abcc (&quot;staging: iio: ad7780: add gain &amp; filter gpio support&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Zicheng Qu &lt;quzicheng@huawei.com&gt;
    > Link: https://patch.msgid.link/20241028142027.1032332-1-quzicheng@huawei.com
    > Signed-off-by: Jonathan Cameron &lt;Jonathan.Cameron@huawei.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ powerpc/vdso: Drop -mstack-protector-guard flags in 32-bit files with clang (@Nathan Chancellor in [d63516b1e0d34e1](https://github.com/sophgo/linux-riscv/commit/d63516b1e0d34e1) at 2024-12-09 09:41:02)
    > commit d677ce521334d8f1f327cafc8b1b7854b0833158 upstream.
    > Under certain conditions, the 64-bit &#x27;-mstack-protector-guard&#x27; flags may
    > end up in the 32-bit vDSO flags, resulting in build failures due to the
    > structure of clang&#x27;s argument parsing of the stack protector options,
    > which validates the arguments of the stack protector guard flags
    > unconditionally in the frontend, choking on the 64-bit values when
    > targeting 32-bit:
    > clang: error: invalid value &#x27;r13&#x27; in &#x27;mstack-protector-guard-reg&#x3D;&#x27;, expected one of: r2
    > clang: error: invalid value &#x27;r13&#x27; in &#x27;mstack-protector-guard-reg&#x3D;&#x27;, expected one of: r2
    > make[3]: *** [arch/powerpc/kernel/vdso/Makefile:85: arch/powerpc/kernel/vdso/vgettimeofday-32.o] Error 1
    > make[3]: *** [arch/powerpc/kernel/vdso/Makefile:87: arch/powerpc/kernel/vdso/vgetrandom-32.o] Error 1
    > Remove these flags by adding them to the CC32FLAGSREMOVE variable, which
    > already handles situations similar to this. Additionally, reformat and
    > align a comment better for the expanding CONFIG_CC_IS_CLANG block.
    > Cc: stable@vger.kernel.org # v6.1+
    > Signed-off-by: Nathan Chancellor &lt;nathan@kernel.org&gt;
    > Signed-off-by: Michael Ellerman &lt;mpe@ellerman.id.au&gt;
    > Link: https://patch.msgid.link/20241030-powerpc-vdso-drop-stackp-flags-clang-v1-1-d95e7376d29c@kernel.org
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ clk: qcom: gcc-qcs404: fix initial rate of GPLL3 (@Gabor Juhos in [6d79acba7ad3c9d](https://github.com/sophgo/linux-riscv/commit/6d79acba7ad3c9d) at 2024-12-09 09:41:02)
    > commit 36d202241d234fa4ac50743510d098ad52bd193a upstream.
    > The comment before the config of the GPLL3 PLL says that the
    > PLL should run at 930 MHz. In contrary to this, calculating
    > the frequency from the current configuration values by using
    > 19.2 MHz as input frequency defined in &#x27;qcs404.dtsi&#x27;, it gives
    > 921.6 MHz:
    > $ xo&#x3D;19200000; l&#x3D;48; alpha&#x3D;0x0; alpha_hi&#x3D;0x0
    > $ echo &quot;$xo * ($((l)) + $(((alpha_hi &lt;&lt; 32 | alpha) &gt;&gt; 8)) / 2^32)&quot; | bc -l
    > 921600000.00000000000000000000
    > Set &#x27;alpha_hi&#x27; in the configuration to a value used in downstream
    > kernels [1][2] in order to get the correct output rate:
    > $ xo&#x3D;19200000; l&#x3D;48; alpha&#x3D;0x0; alpha_hi&#x3D;0x70
    > $ echo &quot;$xo * ($((l)) + $(((alpha_hi &lt;&lt; 32 | alpha) &gt;&gt; 8)) / 2^32)&quot; | bc -l
    > 930000000.00000000000000000000
    > The change is based on static code analysis, compile tested only.
    > [1] https://git.codelinaro.org/clo/la/kernel/msm-5.4/-/blob/kernel.lnx.5.4.r56-rel/drivers/clk/qcom/gcc-qcs404.c?ref_type&#x3D;heads#L335
    > [2} https://git.codelinaro.org/clo/la/kernel/msm-5.15/-/blob/kernel.lnx.5.15.r49-rel/drivers/clk/qcom/gcc-qcs404.c?ref_type&#x3D;heads#L127
    > Cc: stable@vger.kernel.org
    > Fixes: 652f1813c113 (&quot;clk: qcom: gcc: Add global clock controller driver for QCS404&quot;)
    > Signed-off-by: Gabor Juhos &lt;j4g8y7@gmail.com&gt;
    > Link: https://lore.kernel.org/r/20241022-fix-gcc-qcs404-gpll3-v1-1-c4d30d634d19@gmail.com
    > Signed-off-by: Bjorn Andersson &lt;andersson@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ iommu/arm-smmu: Defer probe of clients after smmu device bound (@Pratyush Brahma in [5018696b19bc6c0](https://github.com/sophgo/linux-riscv/commit/5018696b19bc6c0) at 2024-12-09 09:41:02)
    > commit 229e6ee43d2a160a1592b83aad620d6027084aad upstream.
    > Null pointer dereference occurs due to a race between smmu
    > driver probe and client driver probe, when of_dma_configure()
    > for client is called after the iommu_device_register() for smmu driver
    > probe has executed but before the driver_bound() for smmu driver
    > has been called.
    > Following is how the race occurs:
    > T1:Smmu device probe		T2: Client device probe
    > really_probe()
    > arm_smmu_device_probe()
    > iommu_device_register()
    > really_probe()
    > platform_dma_configure()
    > of_dma_configure()
    > of_dma_configure_id()
    > of_iommu_configure()
    > iommu_probe_device()
    > iommu_init_device()
    > arm_smmu_probe_device()
    > arm_smmu_get_by_fwnode()
    > driver_find_device_by_fwnode()
    > driver_find_device()
    > next_device()
    > klist_next()
    > /* null ptr
    > assigned to smmu */
    > /* null ptr dereference
    > while smmu-&gt;streamid_mask */
    > driver_bound()
    > klist_add_tail()
    > When this null smmu pointer is dereferenced later in
    > arm_smmu_probe_device, the device crashes.
    > Fix this by deferring the probe of the client device
    > until the smmu device has bound to the arm smmu driver.
    > Fixes: 021bb8420d44 (&quot;iommu/arm-smmu: Wire up generic configuration support&quot;)
    > Cc: stable@vger.kernel.org
    > Co-developed-by: Prakash Gupta &lt;quic_guptap@quicinc.com&gt;
    > Signed-off-by: Prakash Gupta &lt;quic_guptap@quicinc.com&gt;
    > Signed-off-by: Pratyush Brahma &lt;quic_pbrahma@quicinc.com&gt;
    > Link: https://lore.kernel.org/r/20241004090428.2035-1-quic_pbrahma@quicinc.com
    > [will: Add comment]
    > Signed-off-by: Will Deacon &lt;will@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ cpufreq: scmi: Fix cleanup path when boost enablement fails (@Sibi Sankar in [322b2054f3c11e1](https://github.com/sophgo/linux-riscv/commit/322b2054f3c11e1) at 2024-12-09 09:41:02)
    > commit 8c776a54d9ef3e945db2fe407ad6ad4525422943 upstream.
    > Include free_cpufreq_table in the cleanup path when boost enablement fails.
    > cc: stable@vger.kernel.org
    > Fixes: a8e949d41c72 (&quot;cpufreq: scmi: Enable boost support&quot;)
    > Signed-off-by: Sibi Sankar &lt;quic_sibis@quicinc.com&gt;
    > Signed-off-by: Viresh Kumar &lt;viresh.kumar@linaro.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ leds: lp55xx: Remove redundant test for invalid channel number (@Michal Vokáč in [2a93e095867f490](https://github.com/sophgo/linux-riscv/commit/2a93e095867f490) at 2024-12-09 09:41:02)
    > commit 09b1ef9813a0742674f7efe26104403ca94a1b4a upstream.
    > Since commit 92a81562e695 (&quot;leds: lp55xx: Add multicolor framework
    > support to lp55xx&quot;) there are two subsequent tests if the chan_nr
    > (reg property) is in valid range. One in the lp55xx_init_led()
    > function and one in the lp55xx_parse_common_child() function that
    > was added with the mentioned commit.
    > There are two issues with that.
    > First is in the lp55xx_parse_common_child() function where the reg
    > property is tested right after it is read from the device tree.
    > Test for the upper range is not correct though. Valid reg values are
    > 0 to (max_channel - 1) so it should be &gt;&#x3D;.
    > Second issue is that in case the parsed value is out of the range
    > the probe just fails and no error message is shown as the code never
    > reaches the second test that prints and error message.
    > Remove the test form lp55xx_parse_common_child() function completely
    > and keep the one in lp55xx_init_led() function to deal with it.
    > Fixes: 92a81562e695 (&quot;leds: lp55xx: Add multicolor framework support to lp55xx&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Michal Vokáč &lt;michal.vokac@ysoft.com&gt;
    > Link: https://lore.kernel.org/r/20241017150812.3563629-1-michal.vokac@ysoft.com
    > Signed-off-by: Lee Jones &lt;lee@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ mm/damon/vaddr: fix issue in damon_va_evenly_split_region() (@Zheng Yejian in [100120f64f5bc92](https://github.com/sophgo/linux-riscv/commit/100120f64f5bc92) at 2024-12-09 09:41:02)
    > commit f3c7a1ede435e2e45177d7a490a85fb0a0ec96d1 upstream.
    > Patch series &quot;mm/damon/vaddr: Fix issue in
    > damon_va_evenly_split_region()&quot;.  v2.
    > According to the logic of damon_va_evenly_split_region(), currently
    > following split case would not meet the expectation:
    > Suppose DAMON_MIN_REGION&#x3D;0x1000,
    > Case: Split [0x0, 0x3000) into 2 pieces, then the result would be
    > acutually 3 regions:
    > [0x0, 0x1000), [0x1000, 0x2000), [0x2000, 0x3000)
    > but NOT the expected 2 regions:
    > [0x0, 0x1000), [0x1000, 0x3000) !!!
    > The root cause is that when calculating size of each split piece in
    > damon_va_evenly_split_region():
    > &#x60;sz_piece &#x3D; ALIGN_DOWN(sz_orig / nr_pieces, DAMON_MIN_REGION);&#x60;
    > both the dividing and the ALIGN_DOWN may cause loss of precision, then
    > each time split one piece of size &#x27;sz_piece&#x27; from origin &#x27;start&#x27; to &#x27;end&#x27;
    > would cause more pieces are split out than expected!!!
    > To fix it, count for each piece split and make sure no more than
    > &#x27;nr_pieces&#x27;.  In addition, add above case into damon_test_split_evenly().
    > And add &#x27;nr_piece &#x3D;&#x3D; 1&#x27; check in damon_va_evenly_split_region() for better
    > code readability and add a corresponding kunit testcase.
    > This patch (of 2):
    > According to the logic of damon_va_evenly_split_region(), currently
    > following split case would not meet the expectation:
    > Suppose DAMON_MIN_REGION&#x3D;0x1000,
    > Case: Split [0x0, 0x3000) into 2 pieces, then the result would be
    > acutually 3 regions:
    > [0x0, 0x1000), [0x1000, 0x2000), [0x2000, 0x3000)
    > but NOT the expected 2 regions:
    > [0x0, 0x1000), [0x1000, 0x3000) !!!
    > The root cause is that when calculating size of each split piece in
    > damon_va_evenly_split_region():
    > &#x60;sz_piece &#x3D; ALIGN_DOWN(sz_orig / nr_pieces, DAMON_MIN_REGION);&#x60;
    > both the dividing and the ALIGN_DOWN may cause loss of precision,
    > then each time split one piece of size &#x27;sz_piece&#x27; from origin &#x27;start&#x27; to
    > &#x27;end&#x27; would cause more pieces are split out than expected!!!
    > To fix it, count for each piece split and make sure no more than
    > &#x27;nr_pieces&#x27;. In addition, add above case into damon_test_split_evenly().
    > After this patch, damon-operations test passed:
    > # ./tools/testing/kunit/kunit.py run damon-operations
    > [...]
    > &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; damon-operations (6 subtests) &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;
    > [PASSED] damon_test_three_regions_in_vmas
    > [PASSED] damon_test_apply_three_regions1
    > [PASSED] damon_test_apply_three_regions2
    > [PASSED] damon_test_apply_three_regions3
    > [PASSED] damon_test_apply_three_regions4
    > [PASSED] damon_test_split_evenly
    > &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; [PASSED] damon-operations &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;
    > Link: https://lkml.kernel.org/r/20241022083927.3592237-1-zhengyejian@huaweicloud.com
    > Link: https://lkml.kernel.org/r/20241022083927.3592237-2-zhengyejian@huaweicloud.com
    > Fixes: 3f49584b262c (&quot;mm/damon: implement primitives for the virtual memory address spaces&quot;)
    > Signed-off-by: Zheng Yejian &lt;zhengyejian@huaweicloud.com&gt;
    > Reviewed-by: SeongJae Park &lt;sj@kernel.org&gt;
    > Cc: Fernand Sieber &lt;sieberf@amazon.com&gt;
    > Cc: Leonard Foerster &lt;foersleo@amazon.de&gt;
    > Cc: Shakeel Butt &lt;shakeel.butt@linux.dev&gt;
    > Cc: Ye Weihua &lt;yeweihua4@huawei.com&gt;
    > Cc: &lt;stable@vger.kernel.org&gt;
    > Signed-off-by: Andrew Morton &lt;akpm@linux-foundation.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ iommu/io-pgtable-arm: Fix stage-2 map/unmap for concatenated tables (@Mostafa Saleh in [aa3c291fd254800](https://github.com/sophgo/linux-riscv/commit/aa3c291fd254800) at 2024-12-09 09:41:01)
    > commit d71fa842d33c48ac2809ae11d2379b5a788792cb upstream.
    > ARM_LPAE_LVL_IDX() takes into account concatenated PGDs and can return
    > an index spanning multiple page-table pages given a sufficiently large
    > input address. However, when the resulting index is used to calculate
    > the number of remaining entries in the page, the possibility of
    > concatenation is ignored and we end up computing a negative upper bound:
    > max_entries &#x3D; ARM_LPAE_PTES_PER_TABLE(data) - map_idx_start;
    > On the map path, this results in a negative &#x27;mapped&#x27; value being
    > returned but on the unmap path we can leak child tables if they are
    > skipped in __arm_lpae_free_pgtable().
    > Introduce an arm_lpae_max_entries() helper to convert a table index into
    > the remaining number of entries within a single page-table page.
    > Cc: &lt;stable@vger.kernel.org&gt;
    > Signed-off-by: Mostafa Saleh &lt;smostafa@google.com&gt;
    > Link: https://lore.kernel.org/r/20241024162516.2005652-2-smostafa@google.com
    > [will: Tweaked comment and commit message]
    > Signed-off-by: Will Deacon &lt;will@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ ovl: Filter invalid inodes with missing lookup function (@Vasiliy Kovalev in [72014e7745cc825](https://github.com/sophgo/linux-riscv/commit/72014e7745cc825) at 2024-12-09 09:41:01)
    > commit c8b359dddb418c60df1a69beea01d1b3322bfe83 upstream.
    > Add a check to the ovl_dentry_weird() function to prevent the
    > processing of directory inodes that lack the lookup function.
    > This is important because such inodes can cause errors in overlayfs
    > when passed to the lowerstack.
    > Reported-by: syzbot+a8c9d476508bd14a90e5@syzkaller.appspotmail.com
    > Link: https://syzkaller.appspot.com/bug?extid&#x3D;a8c9d476508bd14a90e5
    > Suggested-by: Miklos Szeredi &lt;miklos@szeredi.hu&gt;
    > Link: https://lore.kernel.org/linux-unionfs/CAJfpegvx-oS9XGuwpJx&#x3D;Xe28_jzWx5eRo1y900_ZzWY+&#x3D;gGzUg@mail.gmail.com/
    > Signed-off-by: Vasiliy Kovalev &lt;kovalev@altlinux.org&gt;
    > Cc: &lt;stable@vger.kernel.org&gt;
    > Signed-off-by: Amir Goldstein &lt;amir73il@gmail.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ zram: clear IDLE flag after recompression (@Sergey Senozhatsky in [641404289fdd94b](https://github.com/sophgo/linux-riscv/commit/641404289fdd94b) at 2024-12-09 09:41:01)
    > commit f85219096648b251a81e9fe24a1974590cfc417d upstream.
    > Patch series &quot;zram: IDLE flag handling fixes&quot;, v2.
    > zram can wrongly preserve ZRAM_IDLE flag on its entries which can result
    > in premature post-processing (writeback and recompression) of such
    > entries.
    > This patch (of 2)
    > Recompression should clear ZRAM_IDLE flag on the entries it has accessed,
    > because otherwise some entries, specifically those for which recompression
    > has failed, become immediate candidate entries for another post-processing
    > (e.g.  writeback).
    > Consider the following case:
    > - recompression marks entries IDLE every 4 hours and attempts
    > to recompress them
    > - some entries are incompressible, so we keep them intact and
    > hence preserve IDLE flag
    > - writeback marks entries IDLE every 8 hours and writebacks
    > IDLE entries, however we have IDLE entries left from
    > recompression, so writeback prematurely writebacks those
    > entries.
    > The bug was reported by Shin Kawamura.
    > Link: https://lkml.kernel.org/r/20241028153629.1479791-1-senozhatsky@chromium.org
    > Link: https://lkml.kernel.org/r/20241028153629.1479791-2-senozhatsky@chromium.org
    > Fixes: 84b33bf78889 (&quot;zram: introduce recompress sysfs knob&quot;)
    > Signed-off-by: Sergey Senozhatsky &lt;senozhatsky@chromium.org&gt;
    > Reported-by: Shin Kawamura &lt;kawasin@google.com&gt;
    > Acked-by: Brian Geffon &lt;bgeffon@google.com&gt;
    > Cc: Minchan Kim &lt;minchan@kernel.org&gt;
    > Signed-off-by: Andrew Morton &lt;akpm@linux-foundation.org&gt;
    > Cc: &lt;stable@vger.kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ kunit: string-stream: Fix a UAF bug in kunit_init_suite() (@Jinjie Ruan in [3213b92754b94de](https://github.com/sophgo/linux-riscv/commit/3213b92754b94de) at 2024-12-09 09:41:01)
    > commit 39e21403c978862846fa68b7f6d06f9cca235194 upstream.
    > In kunit_debugfs_create_suite(), if alloc_string_stream() fails in the
    > kunit_suite_for_each_test_case() loop, the &quot;suite-&gt;log &#x3D; stream&quot;
    > has assigned before, and the error path only free the suite-&gt;log&#x27;s stream
    > memory but not set it to NULL, so the later string_stream_clear() of
    > suite-&gt;log in kunit_init_suite() will cause below UAF bug.
    > Set stream pointer to NULL after free to fix it.
    > Unable to handle kernel paging request at virtual address 006440150000030d
    > Mem abort info:
    > ESR &#x3D; 0x0000000096000004
    > EC &#x3D; 0x25: DABT (current EL), IL &#x3D; 32 bits
    > SET &#x3D; 0, FnV &#x3D; 0
    > EA &#x3D; 0, S1PTW &#x3D; 0
    > FSC &#x3D; 0x04: level 0 translation fault
    > Data abort info:
    > ISV &#x3D; 0, ISS &#x3D; 0x00000004, ISS2 &#x3D; 0x00000000
    > CM &#x3D; 0, WnR &#x3D; 0, TnD &#x3D; 0, TagAccess &#x3D; 0
    > GCS &#x3D; 0, Overlay &#x3D; 0, DirtyBit &#x3D; 0, Xs &#x3D; 0
    > [006440150000030d] address between user and kernel address ranges
    > Internal error: Oops: 0000000096000004 [#1] PREEMPT SMP
    > Dumping ftrace buffer:
    > (ftrace buffer empty)
    > Modules linked in: iio_test_gts industrialio_gts_helper cfg80211 rfkill ipv6 [last unloaded: iio_test_gts]
    > CPU: 5 UID: 0 PID: 6253 Comm: modprobe Tainted: G    B   W        N 6.12.0-rc4+ #458
    > Tainted: [B]&#x3D;BAD_PAGE, [W]&#x3D;WARN, [N]&#x3D;TEST
    > Hardware name: linux,dummy-virt (DT)
    > pstate: 40000005 (nZcv daif -PAN -UAO -TCO -DIT -SSBS BTYPE&#x3D;--)
    > pc : string_stream_clear+0x54/0x1ac
    > lr : string_stream_clear+0x1a8/0x1ac
    > sp : ffffffc080b47410
    > x29: ffffffc080b47410 x28: 006440550000030d x27: ffffff80c96b5e98
    > x26: ffffff80c96b5e80 x25: ffffffe461b3f6c0 x24: 0000000000000003
    > x23: ffffff80c96b5e88 x22: 1ffffff019cdf4fc x21: dfffffc000000000
    > x20: ffffff80ce6fa7e0 x19: 032202a80000186d x18: 0000000000001840
    > x17: 0000000000000000 x16: 0000000000000000 x15: ffffffe45c355cb4
    > x14: ffffffe45c35589c x13: ffffffe45c03da78 x12: ffffffb810168e75
    > x11: 1ffffff810168e74 x10: ffffffb810168e74 x9 : dfffffc000000000
    > x8 : 0000000000000004 x7 : 0000000000000003 x6 : 0000000000000001
    > x5 : ffffffc080b473a0 x4 : 0000000000000000 x3 : 0000000000000000
    > x2 : 0000000000000001 x1 : ffffffe462fbf620 x0 : dfffffc000000000
    > Call trace:
    > string_stream_clear+0x54/0x1ac
    > __kunit_test_suites_init+0x108/0x1d8
    > kunit_exec_run_tests+0xb8/0x100
    > kunit_module_notify+0x400/0x55c
    > notifier_call_chain+0xfc/0x3b4
    > blocking_notifier_call_chain+0x68/0x9c
    > do_init_module+0x24c/0x5c8
    > load_module+0x4acc/0x4e90
    > init_module_from_file+0xd4/0x128
    > idempotent_init_module+0x2d4/0x57c
    > __arm64_sys_finit_module+0xac/0x100
    > invoke_syscall+0x6c/0x258
    > el0_svc_common.constprop.0+0x160/0x22c
    > do_el0_svc+0x44/0x5c
    > el0_svc+0x48/0xb8
    > el0t_64_sync_handler+0x13c/0x158
    > el0t_64_sync+0x190/0x194
    > Code: f9400753 d2dff800 f2fbffe0 d343fe7c (38e06b80)
    > ---[ end trace 0000000000000000 ]---
    > Kernel panic - not syncing: Oops: Fatal exception
    > Link: https://lore.kernel.org/r/20241112080314.407966-1-ruanjinjie@huawei.com
    > Cc: stable@vger.kernel.org
    > Fixes: a3fdf784780c (&quot;kunit: string-stream: Decouple string_stream from kunit&quot;)
    > Suggested-by: Kuan-Wei Chiu &lt;visitorckw@gmail.com&gt;
    > Signed-off-by: Jinjie Ruan &lt;ruanjinjie@huawei.com&gt;
    > Reviewed-by: Kuan-Wei Chiu &lt;visitorckw@gmail.com&gt;
    > Reviewed-by: David Gow &lt;davidgow@google.com&gt;
    > Signed-off-by: Shuah Khan &lt;skhan@linuxfoundation.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ maple_tree: refine mas_store_root() on storing NULL (@Wei Yang in [29aa92f514bf521](https://github.com/sophgo/linux-riscv/commit/29aa92f514bf521) at 2024-12-09 09:41:01)
    > commit 0ea120b278ad7f7cfeeb606e150ad04b192df60b upstream.
    > Currently, when storing NULL on mas_store_root(), the behavior could be
    > improved.
    > Storing NULLs over the entire tree may result in a node being used to
    > store a single range.  Further stores of NULL may cause the node and
    > tree to be corrupt and cause incorrect behaviour.  Fixing the store to
    > the root null fixes the issue by ensuring that a range of 0 - ULONG_MAX
    > results in an empty tree.
    > Users of the tree may experience incorrect values returned if the tree
    > was expanded to store values, then overwritten by all NULLS, then
    > continued to store NULLs over the empty area.
    > For example possible cases are:
    > store NULL at any range result a new node
    > store NULL at range [m, n] where m &gt; 0 to a single entry tree result
    > a new node with range [m, n] set to NULL
    > store NULL at range [m, n] where m &gt; 0 to an empty tree result
    > consecutive NULL slot
    > it allows for multiple NULL entries by expanding root
    > to store NULLs to an empty tree
    > This patch tries to improve in:
    > memory efficient by setting to empty tree instead of using a node
    > remove the possibility of consecutive NULL slot which will prohibit
    > extended null in later operation
    > Link: https://lkml.kernel.org/r/20241031231627.14316-5-richard.weiyang@gmail.com
    > Fixes: 54a611b60590 (&quot;Maple Tree: add new data structure&quot;)
    > Signed-off-by: Wei Yang &lt;richard.weiyang@gmail.com&gt;
    > Reviewed-by: Liam R. Howlett &lt;Liam.Howlett@Oracle.com&gt;
    > Cc: Liam R. Howlett &lt;Liam.Howlett@Oracle.com&gt;
    > Cc: Sidhartha Kumar &lt;sidhartha.kumar@oracle.com&gt;
    > Cc: Lorenzo Stoakes &lt;lorenzo.stoakes@oracle.com&gt;
    > Cc: &lt;stable@vger.kernel.org&gt;
    > Signed-off-by: Andrew Morton &lt;akpm@linux-foundation.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ ftrace: Fix regression with module command in stack_trace_filter (@guoweikang in [19cacabdd5a8487](https://github.com/sophgo/linux-riscv/commit/19cacabdd5a8487) at 2024-12-09 09:41:01)
    > commit 45af52e7d3b8560f21d139b3759735eead8b1653 upstream.
    > When executing the following command:
    > # echo &quot;write*:mod:ext3&quot; &gt; /sys/kernel/tracing/stack_trace_filter
    > The current mod command causes a null pointer dereference. While commit
    > 0f17976568b3f (&quot;ftrace: Fix regression with module command in stack_trace_filter&quot;)
    > has addressed part of the issue, it left a corner case unhandled, which still
    > results in a kernel crash.
    > Cc: stable@vger.kernel.org
    > Cc: Masami Hiramatsu &lt;mhiramat@kernel.org&gt;
    > Cc: Mark Rutland &lt;mark.rutland@arm.com&gt;
    > Cc: Mathieu Desnoyers &lt;mathieu.desnoyers@efficios.com&gt;
    > Link: https://lore.kernel.org/20241120052750.275463-1-guoweikang.kernel@gmail.com
    > Fixes: 04ec7bb642b77 (&quot;tracing: Have the trace_array hold the list of registered func probes&quot;);
    > Signed-off-by: guoweikang &lt;guoweikang.kernel@gmail.com&gt;
    > Signed-off-by: Steven Rostedt (Google) &lt;rostedt@goodmis.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ vmstat: call fold_vm_zone_numa_events() before show per zone NUMA event (@MengEn Sun in [034582624a1d35e](https://github.com/sophgo/linux-riscv/commit/034582624a1d35e) at 2024-12-09 09:41:01)
    > commit 2ea80b039b9af0b71c00378523b71c254fb99c23 upstream.
    > Since 5.14-rc1, NUMA events will only be folded from per-CPU statistics to
    > per zone and global statistics when the user actually needs it.
    > Currently, the kernel has performs the fold operation when reading
    > /proc/vmstat, but does not perform the fold operation in /proc/zoneinfo.
    > This can lead to inaccuracies in the following statistics in zoneinfo:
    > - numa_hit
    > - numa_miss
    > - numa_foreign
    > - numa_interleave
    > - numa_local
    > - numa_other
    > Therefore, before printing per-zone vm_numa_event when reading
    > /proc/zoneinfo, we should also perform the fold operation.
    > Link: https://lkml.kernel.org/r/1730433998-10461-1-git-send-email-mengensun@tencent.com
    > Fixes: f19298b9516c (&quot;mm/vmstat: convert NUMA statistics to basic NUMA counters&quot;)
    > Signed-off-by: MengEn Sun &lt;mengensun@tencent.com&gt;
    > Reviewed-by: JinLiang Zheng &lt;alexjlzheng@tencent.com&gt;
    > Cc: &lt;stable@vger.kernel.org&gt;
    > Signed-off-by: Andrew Morton &lt;akpm@linux-foundation.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ media: gspca: ov534-ov772x: Fix off-by-one error in set_frame_rate() (@Jinjie Ruan in [e3bd4ab165846d4](https://github.com/sophgo/linux-riscv/commit/e3bd4ab165846d4) at 2024-12-09 09:41:00)
    > commit d2842dec577900031826dc44e9bf0c66416d7173 upstream.
    > In set_frame_rate(), select a rate in rate_0 or rate_1 by checking
    > sd-&gt;frame_rate &gt;&#x3D; r-&gt;fps in a loop, but the loop condition terminates when
    > the index reaches zero, which fails to check the last elememt in rate_0 or
    > rate_1.
    > Check for &gt;&#x3D; 0 so that the last one in rate_0 or rate_1 is also checked.
    > Fixes: 189d92af707e (&quot;V4L/DVB (13422): gspca - ov534: ov772x changes from Richard Kaswy.&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Jinjie Ruan &lt;ruanjinjie@huawei.com&gt;
    > Signed-off-by: Sakari Ailus &lt;sakari.ailus@linux.intel.com&gt;
    > Signed-off-by: Hans Verkuil &lt;hverkuil@xs4all.nl&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ tracing: Fix function timing profiler to initialize hashtable (@Masami Hiramatsu (Google) in [b544be374458009](https://github.com/sophgo/linux-riscv/commit/b544be374458009) at 2024-12-09 09:41:00)
    > commit c54a1a06daa78613519b4d24495b0d175b8af63f upstream.
    > Since the new fgraph requires to initialize fgraph_ops.ops.func_hash before
    > calling register_ftrace_graph(), initialize it with default (tracing all
    > functions) parameter.
    > Cc: stable@vger.kernel.org
    > Fixes: 5fccc7552ccb (&quot;ftrace: Add subops logic to allow one ops to manage many&quot;)
    > Signed-off-by: Masami Hiramatsu (Google) &lt;mhiramat@kernel.org&gt;
    > Signed-off-by: Steven Rostedt (Google) &lt;rostedt@goodmis.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ media: platform: allegro-dvt: Fix possible memory leak in allocate_buffers_internal() (@Gaosheng Cui in [891b5790bee8fc6](https://github.com/sophgo/linux-riscv/commit/891b5790bee8fc6) at 2024-12-09 09:41:00)
    > commit 0f514068fbc5d4d189c817adc7c4e32cffdc2e47 upstream.
    > The buffer in the loop should be released under the exception path,
    > otherwise there may be a memory leak here.
    > To mitigate this, free the buffer when allegro_alloc_buffer fails.
    > Fixes: f20387dfd065 (&quot;media: allegro: add Allegro DVT video IP core driver&quot;)
    > Cc: &lt;stable@vger.kernel.org&gt;
    > Signed-off-by: Gaosheng Cui &lt;cuigaosheng1@huawei.com&gt;
    > Signed-off-by: Hans Verkuil &lt;hverkuil-cisco@xs4all.nl&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ media: uvcvideo: Stop stream during unregister (@Ricardo Ribalda in [7ccadc3217bc6fd](https://github.com/sophgo/linux-riscv/commit/7ccadc3217bc6fd) at 2024-12-09 09:41:00)
    > commit c9ec6f1736363b2b2bb4e266997389740f628441 upstream.
    > uvc_unregister_video() can be called asynchronously from
    > uvc_disconnect(). If the device is still streaming when that happens, a
    > plethora of race conditions can occur.
    > Make sure that the device has stopped streaming before exiting this
    > function.
    > If the user still holds handles to the driver&#x27;s file descriptors, any
    > ioctl will return -ENODEV from the v4l2 core.
    > This change makes uvc more consistent with the rest of the v4l2 drivers
    > using the vb2_fop_* and vb2_ioctl_* helpers.
    > This driver (and many other usb drivers) always had this problem, but it
    > wasn&#x27;t possible to easily fix this until the vb2_video_unregister_device()
    > helper was added. So the Fixes tag points to the creation of that helper.
    > Reviewed-by: Hans Verkuil &lt;hverkuil@xs4all.nl&gt;
    > Suggested-by: Hans Verkuil &lt;hverkuil@xs4all.nl&gt;
    > Signed-off-by: Ricardo Ribalda &lt;ribalda@chromium.org&gt;
    > Reviewed-by: Mauro Carvalho Chehab &lt;mchehab+huawei@kernel.org&gt;
    > Fixes: f729ef5796d8 (&quot;media: videobuf2-v4l2.c: add vb2_video_unregister_device helper function&quot;)
    > Cc: stable@vger.kernel.org # 5.10.x
    > [hverkuil: add note regarding Fixes version]
    > Signed-off-by: Hans Verkuil &lt;hverkuil@xs4all.nl&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ media: ov08x40: Fix burst write sequence (@Bryan O&#x27;Donoghue in [6f238d62018157e](https://github.com/sophgo/linux-riscv/commit/6f238d62018157e) at 2024-12-09 09:41:00)
    > commit d0fef6de4f1b957e35a05a5ba4aab2a2576d6686 upstream.
    > It is necessary to account for I2C quirks in the burst mode path of this
    > driver. Not all I2C controllers can accept arbitrarily long writes and this
    > is represented in the quirks field of the adapter structure.
    > Prior to this patch the following error message is seen on a Qualcomm
    > X1E80100 CRD.
    > [   38.773524] i2c i2c-2: adapter quirk: msg too long (addr 0x0036, size 290, write)
    > [   38.781454] ov08x40 2-0036: Failed regs transferred: -95
    > [   38.787076] ov08x40 2-0036: ov08x40_start_streaming failed to set regs
    > Fix the error by breaking up the write sequence into the advertised maximum
    > write size of the quirks field if the quirks field is populated.
    > Fixes: 8f667d202384 (&quot;media: ov08x40: Reduce start streaming time&quot;)
    > Cc: stable@vger.kernel.org # v6.9+
    > Tested-by: Bryan O&#x27;Donoghue &lt;bryan.odonoghue@linaro.org&gt; # x1e80100-crd
    > Signed-off-by: Bryan O&#x27;Donoghue &lt;bryan.odonoghue@linaro.org&gt;
    > Signed-off-by: Sakari Ailus &lt;sakari.ailus@linux.intel.com&gt;
    > Signed-off-by: Hans Verkuil &lt;hverkuil@xs4all.nl&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ kunit: Fix potential null dereference in kunit_device_driver_test() (@Zichen Xie in [5d28fac59369b5d](https://github.com/sophgo/linux-riscv/commit/5d28fac59369b5d) at 2024-12-09 09:41:00)
    > commit 435c20eed572a95709b1536ff78832836b2f91b1 upstream.
    > kunit_kzalloc() may return a NULL pointer, dereferencing it without
    > NULL check may lead to NULL dereference.
    > Add a NULL check for test_state.
    > Link: https://lore.kernel.org/r/20241115054335.21673-1-zichenxie0106@gmail.com
    > Fixes: d03c720e03bd (&quot;kunit: Add APIs for managing devices&quot;)
    > Signed-off-by: Zichen Xie &lt;zichenxie0106@gmail.com&gt;
    > Cc: stable@vger.kernel.org
    > Reviewed-by: David Gow &lt;davidgow@google.com&gt;
    > Signed-off-by: Shuah Khan &lt;skhan@linuxfoundation.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ media: uvcvideo: Require entities to have a non-zero unique ID (@Thadeu Lima de Souza Cascardo in [4f74bd307f078c0](https://github.com/sophgo/linux-riscv/commit/4f74bd307f078c0) at 2024-12-09 09:41:00)
    > commit 3dd075fe8ebbc6fcbf998f81a75b8c4b159a6195 upstream.
    > Per UVC 1.1+ specification 3.7.2, units and terminals must have a non-zero
    > unique ID.
    > &#x60;&#x60;&#x60;
    > Each Unit and Terminal within the video function is assigned a unique
    > identification number, the Unit ID (UID) or Terminal ID (TID), contained in
    > the bUnitID or bTerminalID field of the descriptor. The value 0x00 is
    > reserved for undefined ID,
    > &#x60;&#x60;&#x60;
    > So, deny allocating an entity with ID 0 or an ID that belongs to a unit
    > that is already added to the list of entities.
    > This also prevents some syzkaller reproducers from triggering warnings due
    > to a chain of entities referring to themselves. In one particular case, an
    > Output Unit is connected to an Input Unit, both with the same ID of 1. But
    > when looking up for the source ID of the Output Unit, that same entity is
    > found instead of the input entity, which leads to such warnings.
    > In another case, a backward chain was considered finished as the source ID
    > was 0. Later on, that entity was found, but its pads were not valid.
    > Here is a sample stack trace for one of those cases.
    > [   20.650953] usb 1-1: new high-speed USB device number 2 using dummy_hcd
    > [   20.830206] usb 1-1: Using ep0 maxpacket: 8
    > [   20.833501] usb 1-1: config 0 descriptor??
    > [   21.038518] usb 1-1: string descriptor 0 read error: -71
    > [   21.038893] usb 1-1: Found UVC 0.00 device &lt;unnamed&gt; (2833:0201)
    > [   21.039299] uvcvideo 1-1:0.0: Entity type for entity Output 1 was not initialized!
    > [   21.041583] uvcvideo 1-1:0.0: Entity type for entity Input 1 was not initialized!
    > [   21.042218] ------------[ cut here ]------------
    > [   21.042536] WARNING: CPU: 0 PID: 9 at drivers/media/mc/mc-entity.c:1147 media_create_pad_link+0x2c4/0x2e0
    > [   21.043195] Modules linked in:
    > [   21.043535] CPU: 0 UID: 0 PID: 9 Comm: kworker/0:1 Not tainted 6.11.0-rc7-00030-g3480e43aeccf #444
    > [   21.044101] Hardware name: QEMU Standard PC (Q35 + ICH9, 2009), BIOS 1.15.0-1 04/01/2014
    > [   21.044639] Workqueue: usb_hub_wq hub_event
    > [   21.045100] RIP: 0010:media_create_pad_link+0x2c4/0x2e0
    > [   21.045508] Code: fe e8 20 01 00 00 b8 f4 ff ff ff 48 83 c4 30 5b 41 5c 41 5d 41 5e 41 5f 5d c3 cc cc cc cc 0f 0b eb e9 0f 0b eb 0a 0f 0b eb 06 &lt;0f&gt; 0b eb 02 0f 0b b8 ea ff ff ff eb d4 66 2e 0f 1f 84 00 00 00 00
    > [   21.046801] RSP: 0018:ffffc9000004b318 EFLAGS: 00010246
    > [   21.047227] RAX: ffff888004e5d458 RBX: 0000000000000000 RCX: ffffffff818fccf1
    > [   21.047719] RDX: 000000000000007b RSI: 0000000000000000 RDI: ffff888004313290
    > [   21.048241] RBP: ffff888004313290 R08: 0001ffffffffffff R09: 0000000000000000
    > [   21.048701] R10: 0000000000000013 R11: 0001888004313290 R12: 0000000000000003
    > [   21.049138] R13: ffff888004313080 R14: ffff888004313080 R15: 0000000000000000
    > [   21.049648] FS:  0000000000000000(0000) GS:ffff88803ec00000(0000) knlGS:0000000000000000
    > [   21.050271] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
    > [   21.050688] CR2: 0000592cc27635b0 CR3: 000000000431c000 CR4: 0000000000750ef0
    > [   21.051136] PKRU: 55555554
    > [   21.051331] Call Trace:
    > [   21.051480]  &lt;TASK&gt;
    > [   21.051611]  ? __warn+0xc4/0x210
    > [   21.051861]  ? media_create_pad_link+0x2c4/0x2e0
    > [   21.052252]  ? report_bug+0x11b/0x1a0
    > [   21.052540]  ? trace_hardirqs_on+0x31/0x40
    > [   21.052901]  ? handle_bug+0x3d/0x70
    > [   21.053197]  ? exc_invalid_op+0x1a/0x50
    > [   21.053511]  ? asm_exc_invalid_op+0x1a/0x20
    > [   21.053924]  ? media_create_pad_link+0x91/0x2e0
    > [   21.054364]  ? media_create_pad_link+0x2c4/0x2e0
    > [   21.054834]  ? media_create_pad_link+0x91/0x2e0
    > [   21.055131]  ? _raw_spin_unlock+0x1e/0x40
    > [   21.055441]  ? __v4l2_device_register_subdev+0x202/0x210
    > [   21.055837]  uvc_mc_register_entities+0x358/0x400
    > [   21.056144]  uvc_register_chains+0x1fd/0x290
    > [   21.056413]  uvc_probe+0x380e/0x3dc0
    > [   21.056676]  ? __lock_acquire+0x5aa/0x26e0
    > [   21.056946]  ? find_held_lock+0x33/0xa0
    > [   21.057196]  ? kernfs_activate+0x70/0x80
    > [   21.057533]  ? usb_match_dynamic_id+0x1b/0x70
    > [   21.057811]  ? find_held_lock+0x33/0xa0
    > [   21.058047]  ? usb_match_dynamic_id+0x55/0x70
    > [   21.058330]  ? lock_release+0x124/0x260
    > [   21.058657]  ? usb_match_one_id_intf+0xa2/0x100
    > [   21.058997]  usb_probe_interface+0x1ba/0x330
    > [   21.059399]  really_probe+0x1ba/0x4c0
    > [   21.059662]  __driver_probe_device+0xb2/0x180
    > [   21.059944]  driver_probe_device+0x5a/0x100
    > [   21.060170]  __device_attach_driver+0xe9/0x160
    > [   21.060427]  ? __pfx___device_attach_driver+0x10/0x10
    > [   21.060872]  bus_for_each_drv+0xa9/0x100
    > [   21.061312]  __device_attach+0xed/0x190
    > [   21.061812]  device_initial_probe+0xe/0x20
    > [   21.062229]  bus_probe_device+0x4d/0xd0
    > [   21.062590]  device_add+0x308/0x590
    > [   21.062912]  usb_set_configuration+0x7b6/0xaf0
    > [   21.063403]  usb_generic_driver_probe+0x36/0x80
    > [   21.063714]  usb_probe_device+0x7b/0x130
    > [   21.063936]  really_probe+0x1ba/0x4c0
    > [   21.064111]  __driver_probe_device+0xb2/0x180
    > [   21.064577]  driver_probe_device+0x5a/0x100
    > [   21.065019]  __device_attach_driver+0xe9/0x160
    > [   21.065403]  ? __pfx___device_attach_driver+0x10/0x10
    > [   21.065820]  bus_for_each_drv+0xa9/0x100
    > [   21.066094]  __device_attach+0xed/0x190
    > [   21.066535]  device_initial_probe+0xe/0x20
    > [   21.066992]  bus_probe_device+0x4d/0xd0
    > [   21.067250]  device_add+0x308/0x590
    > [   21.067501]  usb_new_device+0x347/0x610
    > [   21.067817]  hub_event+0x156b/0x1e30
    > [   21.068060]  ? process_scheduled_works+0x48b/0xaf0
    > [   21.068337]  process_scheduled_works+0x5a3/0xaf0
    > [   21.068668]  worker_thread+0x3cf/0x560
    > [   21.068932]  ? kthread+0x109/0x1b0
    > [   21.069133]  kthread+0x197/0x1b0
    > [   21.069343]  ? __pfx_worker_thread+0x10/0x10
    > [   21.069598]  ? __pfx_kthread+0x10/0x10
    > [   21.069908]  ret_from_fork+0x32/0x40
    > [   21.070169]  ? __pfx_kthread+0x10/0x10
    > [   21.070424]  ret_from_fork_asm+0x1a/0x30
    > [   21.070737]  &lt;/TASK&gt;
    > Cc: stable@vger.kernel.org
    > Reported-by: syzbot+0584f746fde3d52b4675@syzkaller.appspotmail.com
    > Closes: https://syzkaller.appspot.com/bug?extid&#x3D;0584f746fde3d52b4675
    > Reported-by: syzbot+dd320d114deb3f5bb79b@syzkaller.appspotmail.com
    > Closes: https://syzkaller.appspot.com/bug?extid&#x3D;dd320d114deb3f5bb79b
    > Fixes: a3fbc2e6bb05 (&quot;media: mc-entity.c: use WARN_ON, validate link pads&quot;)
    > Signed-off-by: Thadeu Lima de Souza Cascardo &lt;cascardo@igalia.com&gt;
    > Reviewed-by: Ricardo Ribalda &lt;ribalda@chromium.org&gt;
    > Reviewed-by: Laurent Pinchart &lt;laurent.pinchart@ideasonboard.com&gt;
    > Link: https://lore.kernel.org/r/20240913180601.1400596-2-cascardo@igalia.com
    > Signed-off-by: Laurent Pinchart &lt;laurent.pinchart@ideasonboard.com&gt;
    > Signed-off-by: Hans Verkuil &lt;hverkuil-cisco@xs4all.nl&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ media: verisilicon: av1: Fix reference video buffer pointer assignment (@Benjamin Gaignard in [ff1c45c865e1e44](https://github.com/sophgo/linux-riscv/commit/ff1c45c865e1e44) at 2024-12-09 09:40:59)
    > commit 672f24ed6ebcd986688c6674a6d994a265fefc25 upstream.
    > Always get new destination buffer for reference frame because nothing
    > garantees the one set previously is still valid or unused.
    > Fixes this chromium test suite:
    > https://chromium.googlesource.com/chromium/src/media/+/refs/heads/main/test/data/test-25fps.av1.ivf
    > Fixes: 727a400686a2 (&quot;media: verisilicon: Add Rockchip AV1 decoder&quot;)
    > Cc: &lt;stable@vger.kernel.org&gt;
    > Signed-off-by: Benjamin Gaignard &lt;benjamin.gaignard@collabora.com&gt;
    > Reviewed-by: Nicolas Dufresne &lt;nicolas.dufresne@collabora.com&gt;
    > Signed-off-by: Hans Verkuil &lt;hverkuil-cisco@xs4all.nl&gt;
    > [hverkuil: fix typo and add link to chromium test suite]
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ efi/libstub: Free correct pointer on failure (@Ard Biesheuvel in [eaafbcf0a5782ae](https://github.com/sophgo/linux-riscv/commit/eaafbcf0a5782ae) at 2024-12-09 09:40:59)
    > commit 06d39d79cbd5a91a33707951ebf2512d0e759847 upstream.
    > cmdline_ptr is an out parameter, which is not allocated by the function
    > itself, and likely points into the caller&#x27;s stack.
    > cmdline refers to the pool allocation that should be freed when cleaning
    > up after a failure, so pass this instead to free_pool().
    > Fixes: 42c8ea3dca09 (&quot;efi: libstub: Factor out EFI stub entrypoint ...&quot;)
    > Cc: &lt;stable@vger.kernel.org&gt;
    > Signed-off-by: Ard Biesheuvel &lt;ardb@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ media: venus: Fix pm_runtime_set_suspended() with runtime pm enabled (@Jinjie Ruan in [b954af359f5dab5](https://github.com/sophgo/linux-riscv/commit/b954af359f5dab5) at 2024-12-09 09:40:59)
    > commit 2a20869f7d798aa2b69e45b863eaf1b1ecf98278 upstream.
    > It is not valid to call pm_runtime_set_suspended() for devices
    > with runtime PM enabled because it returns -EAGAIN if it is enabled
    > already and working. So, call pm_runtime_disable() before to fix it.
    > Cc: stable@vger.kernel.org
    > Fixes: af2c3834c8ca (&quot;[media] media: venus: adding core part and helper functions&quot;)
    > Signed-off-by: Jinjie Ruan &lt;ruanjinjie@huawei.com&gt;
    > Reviewed-by: Bryan O&#x27;Donoghue &lt;bryan.odonoghue@linaro.org&gt;
    > Acked-by: Stanimir Varbanov &lt;stanimir.k.varbanov@gmail.com&gt;
    > Signed-off-by: Sakari Ailus &lt;sakari.ailus@linux.intel.com&gt;
    > Signed-off-by: Hans Verkuil &lt;hverkuil@xs4all.nl&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ media: amphion: Fix pm_runtime_set_suspended() with runtime pm enabled (@Jinjie Ruan in [92b1d2a7a110a46](https://github.com/sophgo/linux-riscv/commit/92b1d2a7a110a46) at 2024-12-09 09:40:59)
    > commit 316e74500d1c6589cba28cebe2864a0bceeb2396 upstream.
    > It is not valid to call pm_runtime_set_suspended() for devices
    > with runtime PM enabled because it returns -EAGAIN if it is enabled
    > already and working. So, call pm_runtime_disable() before to fix it.
    > Cc: stable@vger.kernel.org
    > Fixes: b50a64fc54af (&quot;media: amphion: add amphion vpu device driver&quot;)
    > Signed-off-by: Jinjie Ruan &lt;ruanjinjie@huawei.com&gt;
    > Reviewed-by: Bryan O&#x27;Donoghue &lt;bryan.odonoghue@linaro.org&gt;
    > Signed-off-by: Sakari Ailus &lt;sakari.ailus@linux.intel.com&gt;
    > Signed-off-by: Hans Verkuil &lt;hverkuil@xs4all.nl&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ media: ts2020: fix null-ptr-deref in ts2020_probe() (@Li Zetao in [901070571bc191d](https://github.com/sophgo/linux-riscv/commit/901070571bc191d) at 2024-12-09 09:40:59)
    > commit 4a058b34b52ed3feb1f3ff6fd26aefeeeed20cba upstream.
    > KASAN reported a null-ptr-deref issue when executing the following
    > command:
    > # echo ts2020 0x20 &gt; /sys/bus/i2c/devices/i2c-0/new_device
    > KASAN: null-ptr-deref in range [0x0000000000000010-0x0000000000000017]
    > CPU: 53 UID: 0 PID: 970 Comm: systemd-udevd Not tainted 6.12.0-rc2+ #24
    > Hardware name: QEMU Standard PC (Q35 + ICH9, 2009)
    > RIP: 0010:ts2020_probe+0xad/0xe10 [ts2020]
    > RSP: 0018:ffffc9000abbf598 EFLAGS: 00010202
    > RAX: dffffc0000000000 RBX: 0000000000000000 RCX: ffffffffc0714809
    > RDX: 0000000000000002 RSI: ffff88811550be00 RDI: 0000000000000010
    > RBP: ffff888109868800 R08: 0000000000000001 R09: fffff52001577eb6
    > R10: 0000000000000000 R11: ffffc9000abbff50 R12: ffffffffc0714790
    > R13: 1ffff92001577eb8 R14: ffffffffc07190d0 R15: 0000000000000001
    > FS:  00007f95f13b98c0(0000) GS:ffff888149280000(0000) knlGS:0000000000000000
    > CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
    > CR2: 0000555d2634b000 CR3: 0000000152236000 CR4: 00000000000006f0
    > DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
    > DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
    > Call Trace:
    > &lt;TASK&gt;
    > ts2020_probe+0xad/0xe10 [ts2020]
    > i2c_device_probe+0x421/0xb40
    > really_probe+0x266/0x850
    > ...
    > The cause of the problem is that when using sysfs to dynamically register
    > an i2c device, there is no platform data, but the probe process of ts2020
    > needs to use platform data, resulting in a null pointer being accessed.
    > Solve this problem by adding checks to platform data.
    > Fixes: dc245a5f9b51 (&quot;[media] ts2020: implement I2C client bindings&quot;)
    > Cc: &lt;stable@vger.kernel.org&gt;
    > Signed-off-by: Li Zetao &lt;lizetao1@huawei.com&gt;
    > Signed-off-by: Hans Verkuil &lt;hverkuil-cisco@xs4all.nl&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ net: phy: dp83869: fix status reporting for 1000base-x autonegotiation (@Romain Gantois in [6b29c887a63a30c](https://github.com/sophgo/linux-riscv/commit/6b29c887a63a30c) at 2024-12-09 09:40:59)
    > commit 378e8feea9a70d37a5dc1678b7ec27df21099fa5 upstream.
    > The DP83869 PHY transceiver supports converting from RGMII to 1000base-x.
    > In this operation mode, autonegotiation can be performed, as described in
    > IEEE802.3.
    > The DP83869 has a set of fiber-specific registers located at offset 0xc00.
    > When the transceiver is configured in RGMII-to-1000base-x mode, these
    > registers are mapped onto offset 0, which should make reading the
    > autonegotiation status transparent.
    > However, the fiber registers at offset 0xc04 and 0xc05 follow the bit
    > layout specified in Clause 37, and genphy_read_status() assumes a Clause 22
    > layout. Thus, genphy_read_status() doesn&#x27;t properly read the capabilities
    > advertised by the link partner, resulting in incorrect link parameters.
    > Similarly, genphy_config_aneg() doesn&#x27;t properly write advertised
    > capabilities.
    > Fix the 1000base-x autonegotiation procedure by replacing
    > genphy_read_status() and genphy_config_aneg() with their Clause 37
    > equivalents.
    > Fixes: a29de52ba2a1 (&quot;net: dp83869: Add ability to advertise Fiber connection&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Romain Gantois &lt;romain.gantois@bootlin.com&gt;
    > Link: https://patch.msgid.link/20241112-dp83869-1000base-x-v3-1-36005f4ab0d9@bootlin.com
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ media: platform: exynos4-is: Fix an OF node reference leak in fimc_md_is_isp_available (@Joe Hattori in [36a4bfb5fc676f8](https://github.com/sophgo/linux-riscv/commit/36a4bfb5fc676f8) at 2024-12-09 09:40:59)
    > commit 8964eb23408243ae0016d1f8473c76f64ff25d20 upstream.
    > In fimc_md_is_isp_available(), of_get_child_by_name() is called to check
    > if FIMC-IS is available. Current code does not decrement the refcount of
    > the returned device node, which causes an OF node reference leak. Fix it
    > by calling of_node_put() at the end of the variable scope.
    > Signed-off-by: Joe Hattori &lt;joe@pf.is.s.u-tokyo.ac.jp&gt;
    > Fixes: e781bbe3fecf (&quot;[media] exynos4-is: Add fimc-is subdevs registration&quot;)
    > Cc: stable@vger.kernel.org
    > Reviewed-by: Krzysztof Kozlowski &lt;krzysztof.kozlowski@linaro.org&gt;
    > Signed-off-by: Hans Verkuil &lt;hverkuil@xs4all.nl&gt;
    > [hverkuil: added CC to stable]
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ media: mtk-jpeg: Fix null-ptr-deref during unload module (@Guoqing Jiang in [bc3889a39baf783](https://github.com/sophgo/linux-riscv/commit/bc3889a39baf783) at 2024-12-09 09:40:58)
    > commit 17af2b39daf12870cac61ffc360e62bc35798afb upstream.
    > The workqueue should be destroyed in mtk_jpeg_core.c since commit
    > 09aea13ecf6f (&quot;media: mtk-jpeg: refactor some variables&quot;), otherwise
    > the below calltrace can be easily triggered.
    > [  677.862514] Unable to handle kernel paging request at virtual address dfff800000000023
    > [  677.863633] KASAN: null-ptr-deref in range [0x0000000000000118-0x000000000000011f]
    > ...
    > [  677.879654] CPU: 6 PID: 1071 Comm: modprobe Tainted: G           O       6.8.12-mtk+gfa1a78e5d24b+ #17
    > ...
    > [  677.882838] pc : destroy_workqueue+0x3c/0x770
    > [  677.883413] lr : mtk_jpegdec_destroy_workqueue+0x70/0x88 [mtk_jpeg_dec_hw]
    > [  677.884314] sp : ffff80008ad974f0
    > [  677.884744] x29: ffff80008ad974f0 x28: ffff0000d7115580 x27: ffff0000dd691070
    > [  677.885669] x26: ffff0000dd691408 x25: ffff8000844af3e0 x24: ffff80008ad97690
    > [  677.886592] x23: ffff0000e051d400 x22: ffff0000dd691010 x21: dfff800000000000
    > [  677.887515] x20: 0000000000000000 x19: 0000000000000000 x18: ffff800085397ac0
    > [  677.888438] x17: 0000000000000000 x16: ffff8000801b87c8 x15: 1ffff000115b2e10
    > [  677.889361] x14: 00000000f1f1f1f1 x13: 0000000000000000 x12: ffff7000115b2e4d
    > [  677.890285] x11: 1ffff000115b2e4c x10: ffff7000115b2e4c x9 : ffff80000aa43e90
    > [  677.891208] x8 : 00008fffeea4d1b4 x7 : ffff80008ad97267 x6 : 0000000000000001
    > [  677.892131] x5 : ffff80008ad97260 x4 : ffff7000115b2e4d x3 : 0000000000000000
    > [  677.893054] x2 : 0000000000000023 x1 : dfff800000000000 x0 : 0000000000000118
    > [  677.893977] Call trace:
    > [  677.894297]  destroy_workqueue+0x3c/0x770
    > [  677.894826]  mtk_jpegdec_destroy_workqueue+0x70/0x88 [mtk_jpeg_dec_hw]
    > [  677.895677]  devm_action_release+0x50/0x90
    > [  677.896211]  release_nodes+0xe8/0x170
    > [  677.896688]  devres_release_all+0xf8/0x178
    > [  677.897219]  device_unbind_cleanup+0x24/0x170
    > [  677.897785]  device_release_driver_internal+0x35c/0x480
    > [  677.898461]  device_release_driver+0x20/0x38
    > ...
    > [  677.912665] ---[ end trace 0000000000000000 ]---
    > Fixes: 09aea13ecf6f (&quot;media: mtk-jpeg: refactor some variables&quot;)
    > Cc: &lt;stable@vger.kernel.org&gt;
    > Signed-off-by: Guoqing Jiang &lt;guoqing.jiang@canonical.com&gt;
    > Signed-off-by: Hans Verkuil &lt;hverkuil-cisco@xs4all.nl&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ arm64: dts: freescale: imx8mp-verdin: Fix SD regulator startup delay (@Francesco Dolcini in [6f655bc1f712728](https://github.com/sophgo/linux-riscv/commit/6f655bc1f712728) at 2024-12-09 09:40:58)
    > commit 6c5789c9d2c06968532243daa235f6ff809ad71e upstream.
    > The power switch used to power the SD card interface might have
    > more than 2ms turn-on time, increase the startup delay to 20ms to
    > prevent failures.
    > Fixes: a39ed23bdf6e (&quot;arm64: dts: freescale: add initial support for verdin imx8m plus&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Francesco Dolcini &lt;francesco.dolcini@toradex.com&gt;
    > Signed-off-by: Shawn Guo &lt;shawnguo@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ media: imx-jpeg: Set video drvdata before register video device (@Ming Qian in [5ade59d28eade49](https://github.com/sophgo/linux-riscv/commit/5ade59d28eade49) at 2024-12-09 09:40:58)
    > commit d2b7ecc26bd5406d5ba927be1748aa99c568696c upstream.
    > The video drvdata should be set before the video device is registered,
    > otherwise video_drvdata() may return NULL in the open() file ops, and led
    > to oops.
    > Fixes: 2db16c6ed72c (&quot;media: imx-jpeg: Add V4L2 driver for i.MX8 JPEG Encoder/Decoder&quot;)
    > Cc: &lt;stable@vger.kernel.org&gt;
    > Signed-off-by: Ming Qian &lt;ming.qian@nxp.com&gt;
    > Reviewed-by: TaoJiang &lt;tao.jiang_2@nxp.com&gt;
    > Signed-off-by: Hans Verkuil &lt;hverkuil-cisco@xs4all.nl&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ media: platform: rga: fix 32-bit DMA limitation (@John Keeping in [4f0904a175c6a56](https://github.com/sophgo/linux-riscv/commit/4f0904a175c6a56) at 2024-12-09 09:40:58)
    > commit 953c03d8cb41d08fe6994f5d94c4393ac9da2f13 upstream.
    > The destination buffer flags are assigned twice but source is not set in
    > what looks like a copy+paste mistake.  Assign the source queue flags so
    > the 32-bit DMA limitation is handled consistently.
    > Fixes: ec9ef8dda2a2 (&quot;media: rockchip: rga: set dma mask to 32 bits&quot;)
    > Cc: &lt;stable@vger.kernel.org&gt;
    > Signed-off-by: John Keeping &lt;jkeeping@inmusicbrands.com&gt;
    > Reviewed-by: Michael Tretter &lt;m.tretter@pengutronix.de&gt;
    > Signed-off-by: Hans Verkuil &lt;hverkuil-cisco@xs4all.nl&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ media: i2c: dw9768: Fix pm_runtime_set_suspended() with runtime pm enabled (@Jinjie Ruan in [3c0be29b6aad981](https://github.com/sophgo/linux-riscv/commit/3c0be29b6aad981) at 2024-12-09 09:40:58)
    > commit d6594d50761728d09f23238cf9c368bab6260ef3 upstream.
    > It is not valid to call pm_runtime_set_suspended() and
    > pm_runtime_set_active() for devices with runtime PM enabled because it
    > returns -EAGAIN if it is enabled already and working. So, adjust the
    > order to fix it.
    > Cc: stable@vger.kernel.org
    > Fixes: 5f9a089b6de3 (&quot;dw9768: Enable low-power probe on ACPI&quot;)
    > Suggested-by: Sakari Ailus &lt;sakari.ailus@linux.intel.com&gt;
    > Signed-off-by: Jinjie Ruan &lt;ruanjinjie@huawei.com&gt;
    > Signed-off-by: Sakari Ailus &lt;sakari.ailus@linux.intel.com&gt;
    > Signed-off-by: Hans Verkuil &lt;hverkuil@xs4all.nl&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ media: imx-jpeg: Ensure power suppliers be suspended before detach them (@Ming Qian in [2f86d104539fab9](https://github.com/sophgo/linux-riscv/commit/2f86d104539fab9) at 2024-12-09 09:40:58)
    > commit fd0af4cd35da0eb550ef682b71cda70a4e36f6b9 upstream.
    > The power suppliers are always requested to suspend asynchronously,
    > dev_pm_domain_detach() requires the caller to ensure proper
    > synchronization of this function with power management callbacks.
    > otherwise the detach may led to kernel panic, like below:
    > [ 1457.107934] Unable to handle kernel NULL pointer dereference at virtual address 0000000000000040
    > [ 1457.116777] Mem abort info:
    > [ 1457.119589]   ESR &#x3D; 0x0000000096000004
    > [ 1457.123358]   EC &#x3D; 0x25: DABT (current EL), IL &#x3D; 32 bits
    > [ 1457.128692]   SET &#x3D; 0, FnV &#x3D; 0
    > [ 1457.131764]   EA &#x3D; 0, S1PTW &#x3D; 0
    > [ 1457.134920]   FSC &#x3D; 0x04: level 0 translation fault
    > [ 1457.139812] Data abort info:
    > [ 1457.142707]   ISV &#x3D; 0, ISS &#x3D; 0x00000004, ISS2 &#x3D; 0x00000000
    > [ 1457.148196]   CM &#x3D; 0, WnR &#x3D; 0, TnD &#x3D; 0, TagAccess &#x3D; 0
    > [ 1457.153256]   GCS &#x3D; 0, Overlay &#x3D; 0, DirtyBit &#x3D; 0, Xs &#x3D; 0
    > [ 1457.158563] user pgtable: 4k pages, 48-bit VAs, pgdp&#x3D;00000001138b6000
    > [ 1457.165000] [0000000000000040] pgd&#x3D;0000000000000000, p4d&#x3D;0000000000000000
    > [ 1457.171792] Internal error: Oops: 0000000096000004 [#1] PREEMPT SMP
    > [ 1457.178045] Modules linked in: v4l2_jpeg wave6_vpu_ctrl(-) [last unloaded: mxc_jpeg_encdec]
    > [ 1457.186383] CPU: 0 PID: 51938 Comm: kworker/0:3 Not tainted 6.6.36-gd23d64eea511 #66
    > [ 1457.194112] Hardware name: NXP i.MX95 19X19 board (DT)
    > [ 1457.199236] Workqueue: pm pm_runtime_work
    > [ 1457.203247] pstate: 60400009 (nZCv daif +PAN -UAO -TCO -DIT -SSBS BTYPE&#x3D;--)
    > [ 1457.210188] pc : genpd_runtime_suspend+0x20/0x290
    > [ 1457.214886] lr : __rpm_callback+0x48/0x1d8
    > [ 1457.218968] sp : ffff80008250bc50
    > [ 1457.222270] x29: ffff80008250bc50 x28: 0000000000000000 x27: 0000000000000000
    > [ 1457.229394] x26: 0000000000000000 x25: 0000000000000008 x24: 00000000000f4240
    > [ 1457.236518] x23: 0000000000000000 x22: ffff00008590f0e4 x21: 0000000000000008
    > [ 1457.243642] x20: ffff80008099c434 x19: ffff00008590f000 x18: ffffffffffffffff
    > [ 1457.250766] x17: 5300326563697665 x16: 645f676e696c6f6f x15: 63343a6d726f6674
    > [ 1457.257890] x14: 0000000000000004 x13: 00000000000003a4 x12: 0000000000000002
    > [ 1457.265014] x11: 0000000000000000 x10: 0000000000000a60 x9 : ffff80008250bbb0
    > [ 1457.272138] x8 : ffff000092937200 x7 : ffff0003fdf6af80 x6 : 0000000000000000
    > [ 1457.279262] x5 : 00000000410fd050 x4 : 0000000000200000 x3 : 0000000000000000
    > [ 1457.286386] x2 : 0000000000000000 x1 : 0000000000000000 x0 : ffff00008590f000
    > [ 1457.293510] Call trace:
    > [ 1457.295946]  genpd_runtime_suspend+0x20/0x290
    > [ 1457.300296]  __rpm_callback+0x48/0x1d8
    > [ 1457.304038]  rpm_callback+0x6c/0x78
    > [ 1457.307515]  rpm_suspend+0x10c/0x570
    > [ 1457.311077]  pm_runtime_work+0xc4/0xc8
    > [ 1457.314813]  process_one_work+0x138/0x248
    > [ 1457.318816]  worker_thread+0x320/0x438
    > [ 1457.322552]  kthread+0x110/0x114
    > [ 1457.325767]  ret_from_fork+0x10/0x20
    > Fixes: 2db16c6ed72c (&quot;media: imx-jpeg: Add V4L2 driver for i.MX8 JPEG Encoder/Decoder&quot;)
    > Cc: &lt;stable@vger.kernel.org&gt;
    > Signed-off-by: Ming Qian &lt;ming.qian@nxp.com&gt;
    > Reviewed-by: TaoJiang &lt;tao.jiang_2@nxp.com&gt;
    > Signed-off-by: Hans Verkuil &lt;hverkuil-cisco@xs4all.nl&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ media: i2c: tc358743: Fix crash in the probe error path when using polling (@Alexander Shiyan in [1def915b1564f43](https://github.com/sophgo/linux-riscv/commit/1def915b1564f43) at 2024-12-09 09:40:58)
    > commit 869f38ae07f7df829da4951c3d1f7a2be09c2e9a upstream.
    > If an error occurs in the probe() function, we should remove the polling
    > timer that was alarmed earlier, otherwise the timer is called with
    > arguments that are already freed, which results in a crash.
    > ------------[ cut here ]------------
    > WARNING: CPU: 3 PID: 0 at kernel/time/timer.c:1830 __run_timers+0x244/0x268
    > Modules linked in:
    > CPU: 3 UID: 0 PID: 0 Comm: swapper/3 Not tainted 6.11.0 #226
    > Hardware name: Diasom DS-RK3568-SOM-EVB (DT)
    > pstate: 804000c9 (Nzcv daIF +PAN -UAO -TCO -DIT -SSBS BTYPE&#x3D;--)
    > pc : __run_timers+0x244/0x268
    > lr : __run_timers+0x1d4/0x268
    > sp : ffffff80eff2baf0
    > x29: ffffff80eff2bb50 x28: 7fffffffffffffff x27: ffffff80eff2bb00
    > x26: ffffffc080f669c0 x25: ffffff80efef6bf0 x24: ffffff80eff2bb00
    > x23: 0000000000000000 x22: dead000000000122 x21: 0000000000000000
    > x20: ffffff80efef6b80 x19: ffffff80041c8bf8 x18: ffffffffffffffff
    > x17: ffffffc06f146000 x16: ffffff80eff27dc0 x15: 000000000000003e
    > x14: 0000000000000000 x13: 00000000000054da x12: 0000000000000000
    > x11: 00000000000639c0 x10: 000000000000000c x9 : 0000000000000009
    > x8 : ffffff80eff2cb40 x7 : ffffff80eff2cb40 x6 : ffffff8002bee480
    > x5 : ffffffc080cb2220 x4 : ffffffc080cb2150 x3 : 00000000000f4240
    > x2 : 0000000000000102 x1 : ffffff80eff2bb00 x0 : ffffff80041c8bf0
    > Call trace:
    >  __run_timers+0x244/0x268
    >  timer_expire_remote+0x50/0x68
    >  tmigr_handle_remote+0x388/0x39c
    >  run_timer_softirq+0x38/0x44
    >  handle_softirqs+0x138/0x298
    >  __do_softirq+0x14/0x20
    >  ____do_softirq+0x10/0x1c
    >  call_on_irq_stack+0x24/0x4c
    >  do_softirq_own_stack+0x1c/0x2c
    >  irq_exit_rcu+0x9c/0xcc
    >  el1_interrupt+0x48/0xc0
    >  el1h_64_irq_handler+0x18/0x24
    >  el1h_64_irq+0x7c/0x80
    >  default_idle_call+0x34/0x68
    >  do_idle+0x23c/0x294
    >  cpu_startup_entry+0x38/0x3c
    >  secondary_start_kernel+0x128/0x160
    >  __secondary_switched+0xb8/0xbc
    > ---[ end trace 0000000000000000 ]---
    > Fixes: 4e66a52a2e4c (&quot;[media] tc358743: Add support for platforms without IRQ line&quot;)
    > Signed-off-by: Alexander Shiyan &lt;eagle.alexander923@gmail.com&gt;
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Hans Verkuil &lt;hverkuil-cisco@xs4all.nl&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ arm64: dts: mediatek: mt8186-corsola: Fix GPU supply coupling max-spread (@Chen-Yu Tsai in [e7f2429130fbf5e](https://github.com/sophgo/linux-riscv/commit/e7f2429130fbf5e) at 2024-12-09 09:40:57)
    > commit 2f1aab0cb0661d533f008e4975325080351cdfc8 upstream.
    > The GPU SRAM supply is supposed to be always at least 0.1V higher than
    > the GPU supply. However when the DT was upstreamed, the spread was
    > incorrectly set to 0.01V.
    > Fixes: 8855d01fb81f (&quot;arm64: dts: mediatek: Add MT8186 Krabby platform based Tentacruel / Tentacool&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Chen-Yu Tsai &lt;wenst@chromium.org&gt;
    > Reviewed-by: AngeloGioacchino Del Regno &lt;angelogioacchino.delregno@collabora.com&gt;
    > Link: https://lore.kernel.org/r/20241021140537.3049232-1-wenst@chromium.org
    > Signed-off-by: AngeloGioacchino Del Regno &lt;angelogioacchino.delregno@collabora.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ arm64: dts: allwinner: pinephone: Add mount matrix to accelerometer (@Dragan Simic in [cd70598eb061f36](https://github.com/sophgo/linux-riscv/commit/cd70598eb061f36) at 2024-12-09 09:40:57)
    > commit 2496b2aaacf137250f4ca449f465e2cadaabb0e8 upstream.
    > The way InvenSense MPU-6050 accelerometer is mounted on the user-facing side
    > of the Pine64 PinePhone mainboard, which makes it rotated 90 degrees counter-
    > clockwise, [1] requires the accelerometer&#x27;s x- and y-axis to be swapped, and
    > the direction of the accelerometer&#x27;s y-axis to be inverted.
    > Rectify this by adding a mount-matrix to the accelerometer definition in the
    > Pine64 PinePhone dtsi file.
    > [1] https://files.pine64.org/doc/PinePhone/PinePhone%20mainboard%20bottom%20placement%20v1.1%2020191031.pdf
    > Fixes: 91f480d40942 (&quot;arm64: dts: allwinner: Add initial support for Pine64 PinePhone&quot;)
    > Cc: stable@vger.kernel.org
    > Suggested-by: Ondrej Jirman &lt;megi@xff.cz&gt;
    > Suggested-by: Andrey Skvortsov &lt;andrej.skvortzov@gmail.com&gt;
    > Signed-off-by: Dragan Simic &lt;dsimic@manjaro.org&gt;
    > Reviewed-by: Andrey Skvortsov &lt;andrej.skvortzov@gmail.com&gt;
    > Link: https://patch.msgid.link/129f0c754d071cca1db5d207d9d4a7bd9831dff7.1726773282.git.dsimic@manjaro.org
    > [wens@csie.org: Replaced Helped-by with Suggested-by]
    > Signed-off-by: Chen-Yu Tsai &lt;wens@csie.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ media: qcom: camss: fix error path on configuration of power domains (@Vladimir Zapolskiy in [c98586d8d01c9e8](https://github.com/sophgo/linux-riscv/commit/c98586d8d01c9e8) at 2024-12-09 09:40:57)
    > commit 4f45d65b781499d2a79eca12155532739c876aa2 upstream.
    > There is a chance to meet runtime issues during configuration of CAMSS
    > power domains, because on the error path dev_pm_domain_detach() is
    > unexpectedly called with NULL or error pointer.
    > One of the simplest ways to reproduce the problem is to probe CAMSS
    > driver before registration of CAMSS power domains, for instance if
    > a platform CAMCC driver is simply not built.
    > Warning backtrace example:
    > Unable to handle kernel NULL pointer dereference at virtual address 00000000000001a2
    > &lt;snip&gt;
    > pc : dev_pm_domain_detach+0x8/0x48
    > lr : camss_probe+0x374/0x9c0
    > &lt;snip&gt;
    > Call trace:
    > dev_pm_domain_detach+0x8/0x48
    > platform_probe+0x70/0xf0
    > really_probe+0xc4/0x2a8
    > __driver_probe_device+0x80/0x140
    > driver_probe_device+0x48/0x170
    > __device_attach_driver+0xc0/0x148
    > bus_for_each_drv+0x88/0xf0
    > __device_attach+0xb0/0x1c0
    > device_initial_probe+0x1c/0x30
    > bus_probe_device+0xb4/0xc0
    > deferred_probe_work_func+0x90/0xd0
    > process_one_work+0x164/0x3e0
    > worker_thread+0x310/0x420
    > kthread+0x120/0x130
    > ret_from_fork+0x10/0x20
    > Fixes: 23aa4f0cd327 (&quot;media: qcom: camss: Move VFE power-domain specifics into vfe.c&quot;)
    > Cc: &lt;stable@vger.kernel.org&gt;
    > Signed-off-by: Vladimir Zapolskiy &lt;vladimir.zapolskiy@linaro.org&gt;
    > Reviewed-by: Bryan O&#x27;Donoghue &lt;bryan.odonoghue@linaro.org&gt;
    > Signed-off-by: Hans Verkuil &lt;hverkuil-cisco@xs4all.nl&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ arm64: dts: freescale: imx8mm-verdin: Fix SD regulator startup delay (@Francesco Dolcini in [5d71869f3385e2b](https://github.com/sophgo/linux-riscv/commit/5d71869f3385e2b) at 2024-12-09 09:40:57)
    > commit 0ca7699c376743b633b6419a42888dba386d5351 upstream.
    > The power switch used to power the SD card interface might have
    > more than 2ms turn-on time, increase the startup delay to 20ms to
    > prevent failures.
    > Fixes: 6a57f224f734 (&quot;arm64: dts: freescale: add initial support for verdin imx8m mini&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Francesco Dolcini &lt;francesco.dolcini@toradex.com&gt;
    > Signed-off-by: Shawn Guo &lt;shawnguo@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ arm64: dts: mediatek: mt8186-corsola: Fix IT6505 reset line polarity (@Chen-Yu Tsai in [3f94622dbeaadb4](https://github.com/sophgo/linux-riscv/commit/3f94622dbeaadb4) at 2024-12-09 09:40:57)
    > commit fbcc95fceb6d179dd150df2dc613dfd9b013052c upstream.
    > The reset line of the IT6505 bridge chip is active low, not active high.
    > It was incorrectly inverted in the device tree as the implementation at
    > the time incorrectly inverted the polarity in its driver, due to a prior
    > device having an inline inverting level shifter.
    > Fix the polarity now while the external display pipeline is incomplete,
    > thereby avoiding any impact to running systems.
    > A matching fix for the driver should be included if this change is
    > backported.
    > Fixes: 8855d01fb81f (&quot;arm64: dts: mediatek: Add MT8186 Krabby platform based Tentacruel / Tentacool&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Chen-Yu Tsai &lt;wenst@chromium.org&gt;
    > Link: https://lore.kernel.org/r/20241029100226.660263-1-wenst@chromium.org
    > Signed-off-by: AngeloGioacchino Del Regno &lt;angelogioacchino.delregno@collabora.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ arm64: dts: ti: k3-am62-verdin: Fix SD regulator startup delay (@Francesco Dolcini in [2bea1d0e57ae4ff](https://github.com/sophgo/linux-riscv/commit/2bea1d0e57ae4ff) at 2024-12-09 09:40:57)
    > commit 2213ca51998fef61d3df4ca156054cdcc37c42b8 upstream.
    > The power switch used to power the SD card interface might have
    > more than 2ms turn-on time, increase the startup delay to 20ms to
    > prevent failures.
    > Fixes: 316b80246b16 (&quot;arm64: dts: ti: add verdin am62&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Francesco Dolcini &lt;francesco.dolcini@toradex.com&gt;
    > Link: https://lore.kernel.org/r/20241024130628.49650-1-francesco@dolcini.it
    > Signed-off-by: Vignesh Raghavendra &lt;vigneshr@ti.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ media: amphion: Set video drvdata before register video device (@Ming Qian in [182b9edc02c4cbb](https://github.com/sophgo/linux-riscv/commit/182b9edc02c4cbb) at 2024-12-09 09:40:57)
    > commit 8cbb1a7bd5973b57898b26eb804fe44af440bb63 upstream.
    > The video drvdata should be set before the video device is registered,
    > otherwise video_drvdata() may return NULL in the open() file ops, and led
    > to oops.
    > Fixes: 3cd084519c6f (&quot;media: amphion: add vpu v4l2 m2m support&quot;)
    > Cc: &lt;stable@vger.kernel.org&gt;
    > Signed-off-by: Ming Qian &lt;ming.qian@nxp.com&gt;
    > Reviewed-by: TaoJiang &lt;tao.jiang_2@nxp.com&gt;
    > Signed-off-by: Hans Verkuil &lt;hverkuil-cisco@xs4all.nl&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ md/md-bitmap: Add missing destroy_work_on_stack() (@Yuan Can in [c3d075489697145](https://github.com/sophgo/linux-riscv/commit/c3d075489697145) at 2024-12-09 09:40:56)
    > commit 6012169e8aae9c0eda38bbedcd7a1540a81220ae upstream.
    > This commit add missed destroy_work_on_stack() operations for
    > unplug_work.work in bitmap_unplug_async().
    > Fixes: a022325ab970 (&quot;md/md-bitmap: add a new helper to unplug bitmap asynchrously&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Yuan Can &lt;yuancan@huawei.com&gt;
    > Reviewed-by: Yu Kuai &lt;yukuai3@huawei.com&gt;
    > Link: https://lore.kernel.org/r/20241105130105.127336-1-yuancan@huawei.com
    > Signed-off-by: Song Liu &lt;song@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ md/raid5: Wait sync io to finish before changing group cnt (@Xiao Ni in [be19e6e4339d157](https://github.com/sophgo/linux-riscv/commit/be19e6e4339d157) at 2024-12-09 09:40:56)
    > commit fa1944bbe6220eb929e2c02e5e8706b908565711 upstream.
    > One customer reports a bug: raid5 is hung when changing thread cnt
    > while resync is running. The stripes are all in conf-&gt;handle_list
    > and new threads can&#x27;t handle them.
    > Commit b39f35ebe86d (&quot;md: don&#x27;t quiesce in mddev_suspend()&quot;) removes
    > pers-&gt;quiesce from mddev_suspend/resume. Before this patch, mddev_suspend
    > needs to wait for all ios including sync io to finish. Now it&#x27;s used
    > to only wait normal io.
    > Fix this by calling raid5_quiesce from raid5_store_group_thread_cnt
    > directly to wait all sync requests to finish before changing the group
    > cnt.
    > Fixes: b39f35ebe86d (&quot;md: don&#x27;t quiesce in mddev_suspend()&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Xiao Ni &lt;xni@redhat.com&gt;
    > Reviewed-by: Yu Kuai &lt;yukuai3@huawei.com&gt;
    > Link: https://lore.kernel.org/r/20241106095124.74577-1-xni@redhat.com
    > Signed-off-by: Song Liu &lt;song@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ btrfs: don&#x27;t loop for nowait writes when checking for cross references (@Filipe Manana in [b03d19312b908ea](https://github.com/sophgo/linux-riscv/commit/b03d19312b908ea) at 2024-12-09 09:40:56)
    > [ Upstream commit ed67f2a913a4f0fc505db29805c41dd07d3cb356 ]
    > When checking for delayed refs when verifying if there are cross
    > references for a data extent, we stop if the path has nowait set and we
    > can&#x27;t try lock the delayed ref head&#x27;s mutex, returning -EAGAIN with the
    > goal of making a write fallback to a blocking context. However we ignore
    > the -EAGAIN at btrfs_cross_ref_exist() when check_delayed_ref() returns
    > it, and keep looping instead of immediately returning the -EAGAIN to the
    > caller.
    > Fix this by not looping if we get -EAGAIN and we have a nowait path.
    > Fixes: 26ce91144631 (&quot;btrfs: make can_nocow_extent nowait compatible&quot;)
    > CC: stable@vger.kernel.org # 6.1+
    > Reviewed-by: Josef Bacik &lt;josef@toxicpanda.com&gt;
    > Signed-off-by: Filipe Manana &lt;fdmanana@suse.com&gt;
    > Signed-off-by: David Sterba &lt;dsterba@suse.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ btrfs: ref-verify: fix use-after-free after invalid ref action (@Filipe Manana in [a6f9e7a0bf1185c](https://github.com/sophgo/linux-riscv/commit/a6f9e7a0bf1185c) at 2024-12-09 09:40:56)
    > [ Upstream commit 7c4e39f9d2af4abaf82ca0e315d1fd340456620f ]
    > At btrfs_ref_tree_mod() after we successfully inserted the new ref entry
    > (local variable &#x27;ref&#x27;) into the respective block entry&#x27;s rbtree (local
    > variable &#x27;be&#x27;), if we find an unexpected action of BTRFS_DROP_DELAYED_REF,
    > we error out and free the ref entry without removing it from the block
    > entry&#x27;s rbtree. Then in the error path of btrfs_ref_tree_mod() we call
    > btrfs_free_ref_cache(), which iterates over all block entries and then
    > calls free_block_entry() for each one, and there we will trigger a
    > use-after-free when we are called against the block entry to which we
    > added the freed ref entry to its rbtree, since the rbtree still points
    > to the block entry, as we didn&#x27;t remove it from the rbtree before freeing
    > it in the error path at btrfs_ref_tree_mod(). Fix this by removing the
    > new ref entry from the rbtree before freeing it.
    > Syzbot report this with the following stack traces:
    > BTRFS error (device loop0 state EA):   Ref action 2, root 5, ref_root 0, parent 8564736, owner 0, offset 0, num_refs 18446744073709551615
    > __btrfs_mod_ref+0x7dd/0xac0 fs/btrfs/extent-tree.c:2523
    > update_ref_for_cow+0x9cd/0x11f0 fs/btrfs/ctree.c:512
    > btrfs_force_cow_block+0x9f6/0x1da0 fs/btrfs/ctree.c:594
    > btrfs_cow_block+0x35e/0xa40 fs/btrfs/ctree.c:754
    > btrfs_search_slot+0xbdd/0x30d0 fs/btrfs/ctree.c:2116
    > btrfs_insert_empty_items+0x9c/0x1a0 fs/btrfs/ctree.c:4314
    > btrfs_insert_empty_item fs/btrfs/ctree.h:669 [inline]
    > btrfs_insert_orphan_item+0x1f1/0x320 fs/btrfs/orphan.c:23
    > btrfs_orphan_add+0x6d/0x1a0 fs/btrfs/inode.c:3482
    > btrfs_unlink+0x267/0x350 fs/btrfs/inode.c:4293
    > vfs_unlink+0x365/0x650 fs/namei.c:4469
    > do_unlinkat+0x4ae/0x830 fs/namei.c:4533
    > __do_sys_unlinkat fs/namei.c:4576 [inline]
    > __se_sys_unlinkat fs/namei.c:4569 [inline]
    > __x64_sys_unlinkat+0xcc/0xf0 fs/namei.c:4569
    > do_syscall_x64 arch/x86/entry/common.c:52 [inline]
    > do_syscall_64+0xf3/0x230 arch/x86/entry/common.c:83
    > entry_SYSCALL_64_after_hwframe+0x77/0x7f
    > BTRFS error (device loop0 state EA):   Ref action 1, root 5, ref_root 5, parent 0, owner 260, offset 0, num_refs 1
    > __btrfs_mod_ref+0x76b/0xac0 fs/btrfs/extent-tree.c:2521
    > update_ref_for_cow+0x96a/0x11f0
    > btrfs_force_cow_block+0x9f6/0x1da0 fs/btrfs/ctree.c:594
    > btrfs_cow_block+0x35e/0xa40 fs/btrfs/ctree.c:754
    > btrfs_search_slot+0xbdd/0x30d0 fs/btrfs/ctree.c:2116
    > btrfs_lookup_inode+0xdc/0x480 fs/btrfs/inode-item.c:411
    > __btrfs_update_delayed_inode+0x1e7/0xb90 fs/btrfs/delayed-inode.c:1030
    > btrfs_update_delayed_inode fs/btrfs/delayed-inode.c:1114 [inline]
    > __btrfs_commit_inode_delayed_items+0x2318/0x24a0 fs/btrfs/delayed-inode.c:1137
    > __btrfs_run_delayed_items+0x213/0x490 fs/btrfs/delayed-inode.c:1171
    > btrfs_commit_transaction+0x8a8/0x3740 fs/btrfs/transaction.c:2313
    > prepare_to_relocate+0x3c4/0x4c0 fs/btrfs/relocation.c:3586
    > relocate_block_group+0x16c/0xd40 fs/btrfs/relocation.c:3611
    > btrfs_relocate_block_group+0x77d/0xd90 fs/btrfs/relocation.c:4081
    > btrfs_relocate_chunk+0x12c/0x3b0 fs/btrfs/volumes.c:3377
    > __btrfs_balance+0x1b0f/0x26b0 fs/btrfs/volumes.c:4161
    > btrfs_balance+0xbdc/0x10c0 fs/btrfs/volumes.c:4538
    > BTRFS error (device loop0 state EA):   Ref action 2, root 5, ref_root 0, parent 8564736, owner 0, offset 0, num_refs 18446744073709551615
    > __btrfs_mod_ref+0x7dd/0xac0 fs/btrfs/extent-tree.c:2523
    > update_ref_for_cow+0x9cd/0x11f0 fs/btrfs/ctree.c:512
    > btrfs_force_cow_block+0x9f6/0x1da0 fs/btrfs/ctree.c:594
    > btrfs_cow_block+0x35e/0xa40 fs/btrfs/ctree.c:754
    > btrfs_search_slot+0xbdd/0x30d0 fs/btrfs/ctree.c:2116
    > btrfs_lookup_inode+0xdc/0x480 fs/btrfs/inode-item.c:411
    > __btrfs_update_delayed_inode+0x1e7/0xb90 fs/btrfs/delayed-inode.c:1030
    > btrfs_update_delayed_inode fs/btrfs/delayed-inode.c:1114 [inline]
    > __btrfs_commit_inode_delayed_items+0x2318/0x24a0 fs/btrfs/delayed-inode.c:1137
    > __btrfs_run_delayed_items+0x213/0x490 fs/btrfs/delayed-inode.c:1171
    > btrfs_commit_transaction+0x8a8/0x3740 fs/btrfs/transaction.c:2313
    > prepare_to_relocate+0x3c4/0x4c0 fs/btrfs/relocation.c:3586
    > relocate_block_group+0x16c/0xd40 fs/btrfs/relocation.c:3611
    > btrfs_relocate_block_group+0x77d/0xd90 fs/btrfs/relocation.c:4081
    > btrfs_relocate_chunk+0x12c/0x3b0 fs/btrfs/volumes.c:3377
    > __btrfs_balance+0x1b0f/0x26b0 fs/btrfs/volumes.c:4161
    > btrfs_balance+0xbdc/0x10c0 fs/btrfs/volumes.c:4538
    > &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;
    > BUG: KASAN: slab-use-after-free in rb_first+0x69/0x70 lib/rbtree.c:473
    > Read of size 8 at addr ffff888042d1af38 by task syz.0.0/5329
    > CPU: 0 UID: 0 PID: 5329 Comm: syz.0.0 Not tainted 6.12.0-rc7-syzkaller #0
    > Hardware name: QEMU Standard PC (Q35 + ICH9, 2009), BIOS 1.16.3-debian-1.16.3-2~bpo12+1 04/01/2014
    > Call Trace:
    > &lt;TASK&gt;
    > __dump_stack lib/dump_stack.c:94 [inline]
    > dump_stack_lvl+0x241/0x360 lib/dump_stack.c:120
    > print_address_description mm/kasan/report.c:377 [inline]
    > print_report+0x169/0x550 mm/kasan/report.c:488
    > kasan_report+0x143/0x180 mm/kasan/report.c:601
    > rb_first+0x69/0x70 lib/rbtree.c:473
    > free_block_entry+0x78/0x230 fs/btrfs/ref-verify.c:248
    > btrfs_free_ref_cache+0xa3/0x100 fs/btrfs/ref-verify.c:917
    > btrfs_ref_tree_mod+0x139f/0x15e0 fs/btrfs/ref-verify.c:898
    > btrfs_free_extent+0x33c/0x380 fs/btrfs/extent-tree.c:3544
    > __btrfs_mod_ref+0x7dd/0xac0 fs/btrfs/extent-tree.c:2523
    > update_ref_for_cow+0x9cd/0x11f0 fs/btrfs/ctree.c:512
    > btrfs_force_cow_block+0x9f6/0x1da0 fs/btrfs/ctree.c:594
    > btrfs_cow_block+0x35e/0xa40 fs/btrfs/ctree.c:754
    > btrfs_search_slot+0xbdd/0x30d0 fs/btrfs/ctree.c:2116
    > btrfs_lookup_inode+0xdc/0x480 fs/btrfs/inode-item.c:411
    > __btrfs_update_delayed_inode+0x1e7/0xb90 fs/btrfs/delayed-inode.c:1030
    > btrfs_update_delayed_inode fs/btrfs/delayed-inode.c:1114 [inline]
    > __btrfs_commit_inode_delayed_items+0x2318/0x24a0 fs/btrfs/delayed-inode.c:1137
    > __btrfs_run_delayed_items+0x213/0x490 fs/btrfs/delayed-inode.c:1171
    > btrfs_commit_transaction+0x8a8/0x3740 fs/btrfs/transaction.c:2313
    > prepare_to_relocate+0x3c4/0x4c0 fs/btrfs/relocation.c:3586
    > relocate_block_group+0x16c/0xd40 fs/btrfs/relocation.c:3611
    > btrfs_relocate_block_group+0x77d/0xd90 fs/btrfs/relocation.c:4081
    > btrfs_relocate_chunk+0x12c/0x3b0 fs/btrfs/volumes.c:3377
    > __btrfs_balance+0x1b0f/0x26b0 fs/btrfs/volumes.c:4161
    > btrfs_balance+0xbdc/0x10c0 fs/btrfs/volumes.c:4538
    > btrfs_ioctl_balance+0x493/0x7c0 fs/btrfs/ioctl.c:3673
    > vfs_ioctl fs/ioctl.c:51 [inline]
    > __do_sys_ioctl fs/ioctl.c:907 [inline]
    > __se_sys_ioctl+0xf9/0x170 fs/ioctl.c:893
    > do_syscall_x64 arch/x86/entry/common.c:52 [inline]
    > do_syscall_64+0xf3/0x230 arch/x86/entry/common.c:83
    > entry_SYSCALL_64_after_hwframe+0x77/0x7f
    > RIP: 0033:0x7f996df7e719
    > RSP: 002b:00007f996ede7038 EFLAGS: 00000246 ORIG_RAX: 0000000000000010
    > RAX: ffffffffffffffda RBX: 00007f996e135f80 RCX: 00007f996df7e719
    > RDX: 0000000020000180 RSI: 00000000c4009420 RDI: 0000000000000004
    > RBP: 00007f996dff139e R08: 0000000000000000 R09: 0000000000000000
    > R10: 0000000000000000 R11: 0000000000000246 R12: 0000000000000000
    > R13: 0000000000000000 R14: 00007f996e135f80 R15: 00007fff79f32e68
    > &lt;/TASK&gt;
    > Allocated by task 5329:
    > kasan_save_stack mm/kasan/common.c:47 [inline]
    > kasan_save_track+0x3f/0x80 mm/kasan/common.c:68
    > poison_kmalloc_redzone mm/kasan/common.c:377 [inline]
    > __kasan_kmalloc+0x98/0xb0 mm/kasan/common.c:394
    > kasan_kmalloc include/linux/kasan.h:257 [inline]
    > __kmalloc_cache_noprof+0x19c/0x2c0 mm/slub.c:4295
    > kmalloc_noprof include/linux/slab.h:878 [inline]
    > kzalloc_noprof include/linux/slab.h:1014 [inline]
    > btrfs_ref_tree_mod+0x264/0x15e0 fs/btrfs/ref-verify.c:701
    > btrfs_free_extent+0x33c/0x380 fs/btrfs/extent-tree.c:3544
    > __btrfs_mod_ref+0x7dd/0xac0 fs/btrfs/extent-tree.c:2523
    > update_ref_for_cow+0x9cd/0x11f0 fs/btrfs/ctree.c:512
    > btrfs_force_cow_block+0x9f6/0x1da0 fs/btrfs/ctree.c:594
    > btrfs_cow_block+0x35e/0xa40 fs/btrfs/ctree.c:754
    > btrfs_search_slot+0xbdd/0x30d0 fs/btrfs/ctree.c:2116
    > btrfs_lookup_inode+0xdc/0x480 fs/btrfs/inode-item.c:411
    > __btrfs_update_delayed_inode+0x1e7/0xb90 fs/btrfs/delayed-inode.c:1030
    > btrfs_update_delayed_inode fs/btrfs/delayed-inode.c:1114 [inline]
    > __btrfs_commit_inode_delayed_items+0x2318/0x24a0 fs/btrfs/delayed-inode.c:1137
    > __btrfs_run_delayed_items+0x213/0x490 fs/btrfs/delayed-inode.c:1171
    > btrfs_commit_transaction+0x8a8/0x3740 fs/btrfs/transaction.c:2313
    > prepare_to_relocate+0x3c4/0x4c0 fs/btrfs/relocation.c:3586
    > relocate_block_group+0x16c/0xd40 fs/btrfs/relocation.c:3611
    > btrfs_relocate_block_group+0x77d/0xd90 fs/btrfs/relocation.c:4081
    > btrfs_relocate_chunk+0x12c/0x3b0 fs/btrfs/volumes.c:3377
    > __btrfs_balance+0x1b0f/0x26b0 fs/btrfs/volumes.c:4161
    > btrfs_balance+0xbdc/0x10c0 fs/btrfs/volumes.c:4538
    > btrfs_ioctl_balance+0x493/0x7c0 fs/btrfs/ioctl.c:3673
    > vfs_ioctl fs/ioctl.c:51 [inline]
    > __do_sys_ioctl fs/ioctl.c:907 [inline]
    > __se_sys_ioctl+0xf9/0x170 fs/ioctl.c:893
    > do_syscall_x64 arch/x86/entry/common.c:52 [inline]
    > do_syscall_64+0xf3/0x230 arch/x86/entry/common.c:83
    > entry_SYSCALL_64_after_hwframe+0x77/0x7f
    > Freed by task 5329:
    > kasan_save_stack mm/kasan/common.c:47 [inline]
    > kasan_save_track+0x3f/0x80 mm/kasan/common.c:68
    > kasan_save_free_info+0x40/0x50 mm/kasan/generic.c:579
    > poison_slab_object mm/kasan/common.c:247 [inline]
    > __kasan_slab_free+0x59/0x70 mm/kasan/common.c:264
    > kasan_slab_free include/linux/kasan.h:230 [inline]
    > slab_free_hook mm/slub.c:2342 [inline]
    > slab_free mm/slub.c:4579 [inline]
    > kfree+0x1a0/0x440 mm/slub.c:4727
    > btrfs_ref_tree_mod+0x136c/0x15e0
    > btrfs_free_extent+0x33c/0x380 fs/btrfs/extent-tree.c:3544
    > __btrfs_mod_ref+0x7dd/0xac0 fs/btrfs/extent-tree.c:2523
    > update_ref_for_cow+0x9cd/0x11f0 fs/btrfs/ctree.c:512
    > btrfs_force_cow_block+0x9f6/0x1da0 fs/btrfs/ctree.c:594
    > btrfs_cow_block+0x35e/0xa40 fs/btrfs/ctree.c:754
    > btrfs_search_slot+0xbdd/0x30d0 fs/btrfs/ctree.c:2116
    > btrfs_lookup_inode+0xdc/0x480 fs/btrfs/inode-item.c:411
    > __btrfs_update_delayed_inode+0x1e7/0xb90 fs/btrfs/delayed-inode.c:1030
    > btrfs_update_delayed_inode fs/btrfs/delayed-inode.c:1114 [inline]
    > __btrfs_commit_inode_delayed_items+0x2318/0x24a0 fs/btrfs/delayed-inode.c:1137
    > __btrfs_run_delayed_items+0x213/0x490 fs/btrfs/delayed-inode.c:1171
    > btrfs_commit_transaction+0x8a8/0x3740 fs/btrfs/transaction.c:2313
    > prepare_to_relocate+0x3c4/0x4c0 fs/btrfs/relocation.c:3586
    > relocate_block_group+0x16c/0xd40 fs/btrfs/relocation.c:3611
    > btrfs_relocate_block_group+0x77d/0xd90 fs/btrfs/relocation.c:4081
    > btrfs_relocate_chunk+0x12c/0x3b0 fs/btrfs/volumes.c:3377
    > __btrfs_balance+0x1b0f/0x26b0 fs/btrfs/volumes.c:4161
    > btrfs_balance+0xbdc/0x10c0 fs/btrfs/volumes.c:4538
    > btrfs_ioctl_balance+0x493/0x7c0 fs/btrfs/ioctl.c:3673
    > vfs_ioctl fs/ioctl.c:51 [inline]
    > __do_sys_ioctl fs/ioctl.c:907 [inline]
    > __se_sys_ioctl+0xf9/0x170 fs/ioctl.c:893
    > do_syscall_x64 arch/x86/entry/common.c:52 [inline]
    > do_syscall_64+0xf3/0x230 arch/x86/entry/common.c:83
    > entry_SYSCALL_64_after_hwframe+0x77/0x7f
    > The buggy address belongs to the object at ffff888042d1af00
    > which belongs to the cache kmalloc-64 of size 64
    > The buggy address is located 56 bytes inside of
    > freed 64-byte region [ffff888042d1af00, ffff888042d1af40)
    > The buggy address belongs to the physical page:
    > page: refcount:1 mapcount:0 mapping:0000000000000000 index:0x0 pfn:0x42d1a
    > anon flags: 0x4fff00000000000(node&#x3D;1|zone&#x3D;1|lastcpupid&#x3D;0x7ff)
    > page_type: f5(slab)
    > raw: 04fff00000000000 ffff88801ac418c0 0000000000000000 dead000000000001
    > raw: 0000000000000000 0000000000200020 00000001f5000000 0000000000000000
    > page dumped because: kasan: bad access detected
    > page_owner tracks the page as allocated
    > page last allocated via order 0, migratetype Unmovable, gfp_mask 0x52c40(GFP_NOFS|__GFP_NOWARN|__GFP_NORETRY|__GFP_COMP), pid 5055, tgid 5055 (dhcpcd-run-hook), ts 40377240074, free_ts 40376848335
    > set_page_owner include/linux/page_owner.h:32 [inline]
    > post_alloc_hook+0x1f3/0x230 mm/page_alloc.c:1541
    > prep_new_page mm/page_alloc.c:1549 [inline]
    > get_page_from_freelist+0x3649/0x3790 mm/page_alloc.c:3459
    > __alloc_pages_noprof+0x292/0x710 mm/page_alloc.c:4735
    > alloc_pages_mpol_noprof+0x3e8/0x680 mm/mempolicy.c:2265
    > alloc_slab_page+0x6a/0x140 mm/slub.c:2412
    > allocate_slab+0x5a/0x2f0 mm/slub.c:2578
    > new_slab mm/slub.c:2631 [inline]
    > ___slab_alloc+0xcd1/0x14b0 mm/slub.c:3818
    > __slab_alloc+0x58/0xa0 mm/slub.c:3908
    > __slab_alloc_node mm/slub.c:3961 [inline]
    > slab_alloc_node mm/slub.c:4122 [inline]
    > __do_kmalloc_node mm/slub.c:4263 [inline]
    > __kmalloc_noprof+0x25a/0x400 mm/slub.c:4276
    > kmalloc_noprof include/linux/slab.h:882 [inline]
    > kzalloc_noprof include/linux/slab.h:1014 [inline]
    > tomoyo_encode2 security/tomoyo/realpath.c:45 [inline]
    > tomoyo_encode+0x26f/0x540 security/tomoyo/realpath.c:80
    > tomoyo_realpath_from_path+0x59e/0x5e0 security/tomoyo/realpath.c:283
    > tomoyo_get_realpath security/tomoyo/file.c:151 [inline]
    > tomoyo_check_open_permission+0x255/0x500 security/tomoyo/file.c:771
    > security_file_open+0x777/0x990 security/security.c:3109
    > do_dentry_open+0x369/0x1460 fs/open.c:945
    > vfs_open+0x3e/0x330 fs/open.c:1088
    > do_open fs/namei.c:3774 [inline]
    > path_openat+0x2c84/0x3590 fs/namei.c:3933
    > page last free pid 5055 tgid 5055 stack trace:
    > reset_page_owner include/linux/page_owner.h:25 [inline]
    > free_pages_prepare mm/page_alloc.c:1112 [inline]
    > free_unref_page+0xcfb/0xf20 mm/page_alloc.c:2642
    > free_pipe_info+0x300/0x390 fs/pipe.c:860
    > put_pipe_info fs/pipe.c:719 [inline]
    > pipe_release+0x245/0x320 fs/pipe.c:742
    > __fput+0x23f/0x880 fs/file_table.c:431
    > __do_sys_close fs/open.c:1567 [inline]
    > __se_sys_close fs/open.c:1552 [inline]
    > __x64_sys_close+0x7f/0x110 fs/open.c:1552
    > do_syscall_x64 arch/x86/entry/common.c:52 [inline]
    > do_syscall_64+0xf3/0x230 arch/x86/entry/common.c:83
    > entry_SYSCALL_64_after_hwframe+0x77/0x7f
    > Memory state around the buggy address:
    > ffff888042d1ae00: fa fb fb fb fb fb fb fb fc fc fc fc fc fc fc fc
    > ffff888042d1ae80: 00 00 00 00 00 fc fc fc fc fc fc fc fc fc fc fc
    > &gt;ffff888042d1af00: fa fb fb fb fb fb fb fb fc fc fc fc fc fc fc fc
    > ^
    > ffff888042d1af80: 00 00 00 00 00 00 fc fc fc fc fc fc fc fc fc fc
    > ffff888042d1b000: 00 00 00 00 00 fc fc 00 00 00 00 00 fc fc 00 00
    > Reported-by: syzbot+7325f164162e200000c1@syzkaller.appspotmail.com
    > Link: https://lore.kernel.org/linux-btrfs/673723eb.050a0220.1324f8.00a8.GAE@google.com/T/#u
    > Fixes: fd708b81d972 (&quot;Btrfs: add a extent ref verify tool&quot;)
    > CC: stable@vger.kernel.org # 4.19+
    > Reviewed-by: Johannes Thumshirn &lt;johannes.thumshirn@wdc.com&gt;
    > Signed-off-by: Filipe Manana &lt;fdmanana@suse.com&gt;
    > Reviewed-by: David Sterba &lt;dsterba@suse.com&gt;
    > Signed-off-by: David Sterba &lt;dsterba@suse.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ btrfs: add a sanity check for btrfs root in btrfs_search_slot() (@Lizhi Xu in [93992c3d9629b02](https://github.com/sophgo/linux-riscv/commit/93992c3d9629b02) at 2024-12-09 09:40:56)
    > [ Upstream commit 3ed51857a50f530ac7a1482e069dfbd1298558d4 ]
    > Syzbot reports a null-ptr-deref in btrfs_search_slot().
    > The reproducer is using rescue&#x3D;ibadroots, and the extent tree root is
    > corrupted thus the extent tree is NULL.
    > When scrub tries to search the extent tree to gather the needed extent
    > info, btrfs_search_slot() doesn&#x27;t check if the target root is NULL or
    > not, resulting the null-ptr-deref.
    > Add sanity check for btrfs root before using it in btrfs_search_slot().
    > Reported-by: syzbot+3030e17bd57a73d39bd7@syzkaller.appspotmail.com
    > Fixes: 42437a6386ff (&quot;btrfs: introduce mount option rescue&#x3D;ignorebadroots&quot;)
    > Link: https://syzkaller.appspot.com/bug?extid&#x3D;3030e17bd57a73d39bd7
    > CC: stable@vger.kernel.org # 5.15+
    > Reviewed-by: Qu Wenruo &lt;wqu@suse.com&gt;
    > Tested-by: syzbot+3030e17bd57a73d39bd7@syzkaller.appspotmail.com
    > Signed-off-by: Lizhi Xu &lt;lizhi.xu@windriver.com&gt;
    > Reviewed-by: David Sterba &lt;dsterba@suse.com&gt;
    > Signed-off-by: David Sterba &lt;dsterba@suse.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ netkit: Add option for scrubbing skb meta data (@Daniel Borkmann in [596f7faa60b25a4](https://github.com/sophgo/linux-riscv/commit/596f7faa60b25a4) at 2024-12-09 09:40:56)
    > commit 83134ef4609388f6b9ca31a384f531155196c2a7 upstream.
    > Jordan reported that when running Cilium with netkit in per-endpoint-routes
    > mode, network policy misclassifies traffic. In this direct routing mode
    > of Cilium which is used in case of GKE/EKS/AKS, the Pod&#x27;s BPF program to
    > enforce policy sits on the netkit primary device&#x27;s egress side.
    > The issue here is that in case of netkit&#x27;s netkit_prep_forward(), it will
    > clear meta data such as skb-&gt;mark and skb-&gt;priority before executing the
    > BPF program. Thus, identity data stored in there from earlier BPF programs
    > (e.g. from tcx ingress on the physical device) gets cleared instead of
    > being made available for the primary&#x27;s program to process. While for traffic
    > egressing the Pod via the peer device this might be desired, this is
    > different for the primary one where compared to tcx egress on the host
    > veth this information would be available.
    > To address this, add a new parameter for the device orchestration to
    > allow control of skb-&gt;mark and skb-&gt;priority scrubbing, to make the two
    > accessible from BPF (and eventually leave it up to the program to scrub).
    > By default, the current behavior is retained. For netkit peer this also
    > enables the use case where applications could cooperate/signal intent to
    > the BPF program.
    > Note that struct netkit has a 4 byte hole between policy and bundle which
    > is used here, in other words, struct netkit&#x27;s first cacheline content used
    > in fast-path does not get moved around.
    > Fixes: 35dfaad7188c (&quot;netkit, bpf: Add bpf programmable net device&quot;)
    > Reported-by: Jordan Rife &lt;jrife@google.com&gt;
    > Signed-off-by: Daniel Borkmann &lt;daniel@iogearbox.net&gt;
    > Cc: Nikolay Aleksandrov &lt;razor@blackwall.org&gt;
    > Link: https://github.com/cilium/cilium/issues/34042
    > Acked-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Acked-by: Nikolay Aleksandrov &lt;razor@blackwall.org&gt;
    > Link: https://lore.kernel.org/r/20241004101335.117711-1-daniel@iogearbox.net
    > Signed-off-by: Martin KaFai Lau &lt;martin.lau@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ iommu/tegra241-cmdqv: Fix unused variable warning (@Will Deacon in [259449873c37da3](https://github.com/sophgo/linux-riscv/commit/259449873c37da3) at 2024-12-09 09:40:56)
    > commit 5492f0c4085a8fb8820ff974f17b83a7d6dab5a5 upstream.
    > While testing some io-pgtable changes, I ran into a compiler warning
    > from the Tegra CMDQ driver:
    > drivers/iommu/arm/arm-smmu-v3/tegra241-cmdqv.c:803:23: warning: unused variable &#x27;cmdqv_debugfs_dir&#x27; [-Wunused-variable]
    > 803 | static struct dentry *cmdqv_debugfs_dir;
    > |                       ^~~~~~~~~~~~~~~~~
    > 1 warning generated.
    > Guard the variable declaration with CONFIG_IOMMU_DEBUGFS to silence the
    > warning.
    > Signed-off-by: Will Deacon &lt;will@kernel.org&gt;
    > Cc: Jiri Slaby &lt;jirislaby@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ btrfs: fix use-after-free in btrfs_encoded_read_endio() (@Johannes Thumshirn in [f8a5129e4a9fc3f](https://github.com/sophgo/linux-riscv/commit/f8a5129e4a9fc3f) at 2024-12-09 09:40:55)
    > [ Upstream commit 05b36b04d74a517d6675bf2f90829ff1ac7e28dc ]
    > Shinichiro reported the following use-after free that sometimes is
    > happening in our CI system when running fstests&#x27; btrfs/284 on a TCMU
    > runner device:
    > BUG: KASAN: slab-use-after-free in lock_release+0x708/0x780
    > Read of size 8 at addr ffff888106a83f18 by task kworker/u80:6/219
    > CPU: 8 UID: 0 PID: 219 Comm: kworker/u80:6 Not tainted 6.12.0-rc6-kts+ #15
    > Hardware name: Supermicro Super Server/X11SPi-TF, BIOS 3.3 02/21/2020
    > Workqueue: btrfs-endio btrfs_end_bio_work [btrfs]
    > Call Trace:
    > &lt;TASK&gt;
    > dump_stack_lvl+0x6e/0xa0
    > ? lock_release+0x708/0x780
    > print_report+0x174/0x505
    > ? lock_release+0x708/0x780
    > ? __virt_addr_valid+0x224/0x410
    > ? lock_release+0x708/0x780
    > kasan_report+0xda/0x1b0
    > ? lock_release+0x708/0x780
    > ? __wake_up+0x44/0x60
    > lock_release+0x708/0x780
    > ? __pfx_lock_release+0x10/0x10
    > ? __pfx_do_raw_spin_lock+0x10/0x10
    > ? lock_is_held_type+0x9a/0x110
    > _raw_spin_unlock_irqrestore+0x1f/0x60
    > __wake_up+0x44/0x60
    > btrfs_encoded_read_endio+0x14b/0x190 [btrfs]
    > btrfs_check_read_bio+0x8d9/0x1360 [btrfs]
    > ? lock_release+0x1b0/0x780
    > ? trace_lock_acquire+0x12f/0x1a0
    > ? __pfx_btrfs_check_read_bio+0x10/0x10 [btrfs]
    > ? process_one_work+0x7e3/0x1460
    > ? lock_acquire+0x31/0xc0
    > ? process_one_work+0x7e3/0x1460
    > process_one_work+0x85c/0x1460
    > ? __pfx_process_one_work+0x10/0x10
    > ? assign_work+0x16c/0x240
    > worker_thread+0x5e6/0xfc0
    > ? __pfx_worker_thread+0x10/0x10
    > kthread+0x2c3/0x3a0
    > ? __pfx_kthread+0x10/0x10
    > ret_from_fork+0x31/0x70
    > ? __pfx_kthread+0x10/0x10
    > ret_from_fork_asm+0x1a/0x30
    > &lt;/TASK&gt;
    > Allocated by task 3661:
    > kasan_save_stack+0x30/0x50
    > kasan_save_track+0x14/0x30
    > __kasan_kmalloc+0xaa/0xb0
    > btrfs_encoded_read_regular_fill_pages+0x16c/0x6d0 [btrfs]
    > send_extent_data+0xf0f/0x24a0 [btrfs]
    > process_extent+0x48a/0x1830 [btrfs]
    > changed_cb+0x178b/0x2ea0 [btrfs]
    > btrfs_ioctl_send+0x3bf9/0x5c20 [btrfs]
    > _btrfs_ioctl_send+0x117/0x330 [btrfs]
    > btrfs_ioctl+0x184a/0x60a0 [btrfs]
    > __x64_sys_ioctl+0x12e/0x1a0
    > do_syscall_64+0x95/0x180
    > entry_SYSCALL_64_after_hwframe+0x76/0x7e
    > Freed by task 3661:
    > kasan_save_stack+0x30/0x50
    > kasan_save_track+0x14/0x30
    > kasan_save_free_info+0x3b/0x70
    > __kasan_slab_free+0x4f/0x70
    > kfree+0x143/0x490
    > btrfs_encoded_read_regular_fill_pages+0x531/0x6d0 [btrfs]
    > send_extent_data+0xf0f/0x24a0 [btrfs]
    > process_extent+0x48a/0x1830 [btrfs]
    > changed_cb+0x178b/0x2ea0 [btrfs]
    > btrfs_ioctl_send+0x3bf9/0x5c20 [btrfs]
    > _btrfs_ioctl_send+0x117/0x330 [btrfs]
    > btrfs_ioctl+0x184a/0x60a0 [btrfs]
    > __x64_sys_ioctl+0x12e/0x1a0
    > do_syscall_64+0x95/0x180
    > entry_SYSCALL_64_after_hwframe+0x76/0x7e
    > The buggy address belongs to the object at ffff888106a83f00
    > which belongs to the cache kmalloc-rnd-07-96 of size 96
    > The buggy address is located 24 bytes inside of
    > freed 96-byte region [ffff888106a83f00, ffff888106a83f60)
    > The buggy address belongs to the physical page:
    > page: refcount:1 mapcount:0 mapping:0000000000000000 index:0xffff888106a83800 pfn:0x106a83
    > flags: 0x17ffffc0000000(node&#x3D;0|zone&#x3D;2|lastcpupid&#x3D;0x1fffff)
    > page_type: f5(slab)
    > raw: 0017ffffc0000000 ffff888100053680 ffffea0004917200 0000000000000004
    > raw: ffff888106a83800 0000000080200019 00000001f5000000 0000000000000000
    > page dumped because: kasan: bad access detected
    > Memory state around the buggy address:
    > ffff888106a83e00: fa fb fb fb fb fb fb fb fb fb fb fb fc fc fc fc
    > ffff888106a83e80: fa fb fb fb fb fb fb fb fb fb fb fb fc fc fc fc
    > &gt;ffff888106a83f00: fa fb fb fb fb fb fb fb fb fb fb fb fc fc fc fc
    > ^
    > ffff888106a83f80: fa fb fb fb fb fb fb fb fb fb fb fb fc fc fc fc
    > ffff888106a84000: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
    > &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;
    > Further analyzing the trace and the crash dump&#x27;s vmcore file shows that
    > the wake_up() call in btrfs_encoded_read_endio() is calling wake_up() on
    > the wait_queue that is in the private data passed to the end_io handler.
    > Commit 4ff47df40447 (&quot;btrfs: move priv off stack in
    > btrfs_encoded_read_regular_fill_pages()&quot;) moved &#x27;struct
    > btrfs_encoded_read_private&#x27; off the stack.
    > Before that commit one can see a corruption of the private data when
    > analyzing the vmcore after a crash:
    > (struct btrfs_encoded_read_private *)0xffff88815626eec8 &#x3D; {
    > .wait &#x3D; (wait_queue_head_t){
    > .lock &#x3D; (spinlock_t){
    > .rlock &#x3D; (struct raw_spinlock){
    > .raw_lock &#x3D; (arch_spinlock_t){
    > .val &#x3D; (atomic_t){
    > .counter &#x3D; (int)-2005885696,
    > },
    > .locked &#x3D; (u8)0,
    > .pending &#x3D; (u8)157,
    > .locked_pending &#x3D; (u16)40192,
    > .tail &#x3D; (u16)34928,
    > },
    > .magic &#x3D; (unsigned int)536325682,
    > .owner_cpu &#x3D; (unsigned int)29,
    > .owner &#x3D; (void *)__SCT__tp_func_btrfs_transaction_commit+0x0 &#x3D; 0x0,
    > .dep_map &#x3D; (struct lockdep_map){
    > .key &#x3D; (struct lock_class_key *)0xffff8881575a3b6c,
    > .class_cache &#x3D; (struct lock_class *[2]){ 0xffff8882a71985c0, 0xffffea00066f5d40 },
    > .name &#x3D; (const char *)0xffff88815626f100 &#x3D; &quot;&quot;,
    > .wait_type_outer &#x3D; (u8)37,
    > .wait_type_inner &#x3D; (u8)178,
    > .lock_type &#x3D; (u8)154,
    > },
    > },
    > .__padding &#x3D; (u8 [24]){ 0, 157, 112, 136, 50, 174, 247, 31, 29 },
    > .dep_map &#x3D; (struct lockdep_map){
    > .key &#x3D; (struct lock_class_key *)0xffff8881575a3b6c,
    > .class_cache &#x3D; (struct lock_class *[2]){ 0xffff8882a71985c0, 0xffffea00066f5d40 },
    > .name &#x3D; (const char *)0xffff88815626f100 &#x3D; &quot;&quot;,
    > .wait_type_outer &#x3D; (u8)37,
    > .wait_type_inner &#x3D; (u8)178,
    > .lock_type &#x3D; (u8)154,
    > },
    > },
    > .head &#x3D; (struct list_head){
    > .next &#x3D; (struct list_head *)0x112cca,
    > .prev &#x3D; (struct list_head *)0x47,
    > },
    > },
    > .pending &#x3D; (atomic_t){
    > .counter &#x3D; (int)-1491499288,
    > },
    > .status &#x3D; (blk_status_t)130,
    > }
    > Here we can see several indicators of in-memory data corruption, e.g. the
    > large negative atomic values of -&gt;pending or
    > -&gt;wait-&gt;lock-&gt;rlock-&gt;raw_lock-&gt;val, as well as the bogus spinlock magic
    > 0x1ff7ae32 (decimal 536325682 above) instead of 0xdead4ead or the bogus
    > pointer values for -&gt;wait-&gt;head.
    > To fix this, change atomic_dec_return() to atomic_dec_and_test() to fix the
    > corruption, as atomic_dec_return() is defined as two instructions on
    > x86_64, whereas atomic_dec_and_test() is defined as a single atomic
    > operation. This can lead to a situation where counter value is already
    > decremented but the if statement in btrfs_encoded_read_endio() is not
    > completely processed, i.e. the 0 test has not completed. If another thread
    > continues executing btrfs_encoded_read_regular_fill_pages() the
    > atomic_dec_return() there can see an already updated -&gt;pending counter and
    > continues by freeing the private data. Continuing in the endio handler the
    > test for 0 succeeds and the wait_queue is woken up, resulting in a
    > use-after-free.
    > Reported-by: Shinichiro Kawasaki &lt;shinichiro.kawasaki@wdc.com&gt;
    > Suggested-by: Damien Le Moal &lt;Damien.LeMoal@wdc.com&gt;
    > Fixes: 1881fba89bd5 (&quot;btrfs: add BTRFS_IOC_ENCODED_READ ioctl&quot;)
    > CC: stable@vger.kernel.org # 6.1+
    > Reviewed-by: Filipe Manana &lt;fdmanana@suse.com&gt;
    > Reviewed-by: Qu Wenruo &lt;wqu@suse.com&gt;
    > Signed-off-by: Johannes Thumshirn &lt;johannes.thumshirn@wdc.com&gt;
    > Reviewed-by: David Sterba &lt;dsterba@suse.com&gt;
    > Signed-off-by: David Sterba &lt;dsterba@suse.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ btrfs: change btrfs_encoded_read() so that reading of extent is done by caller (@Mark Harmstone in [a0f5689a684e853](https://github.com/sophgo/linux-riscv/commit/a0f5689a684e853) at 2024-12-09 09:40:55)
    > [ Upstream commit 26efd44796c6dd7a64f039a0dda6d558eac97a3e ]
    > Change the behaviour of btrfs_encoded_read() so that if it needs to read
    > an extent from disk, it leaves the extent and inode locked and returns
    > -EIOCBQUEUED. The caller is then responsible for doing the I/O via
    > btrfs_encoded_read_regular() and unlocking the extent and inode.
    > Signed-off-by: Mark Harmstone &lt;maharmstone@fb.com&gt;
    > Reviewed-by: David Sterba &lt;dsterba@suse.com&gt;
    > Signed-off-by: David Sterba &lt;dsterba@suse.com&gt;
    > Stable-dep-of: 05b36b04d74a (&quot;btrfs: fix use-after-free in btrfs_encoded_read_endio()&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ quota: flush quota_release_work upon quota writeback (@Ojaswin Mujoo in [8ea87e347922588](https://github.com/sophgo/linux-riscv/commit/8ea87e347922588) at 2024-12-09 09:40:55)
    > [ Upstream commit ac6f420291b3fee1113f21d612fa88b628afab5b ]
    > One of the paths quota writeback is called from is:
    > freeze_super()
    > sync_filesystem()
    > ext4_sync_fs()
    > dquot_writeback_dquots()
    > Since we currently don&#x27;t always flush the quota_release_work queue in
    > this path, we can end up with the following race:
    > 1. dquot are added to releasing_dquots list during regular operations.
    > 2. FS Freeze starts, however, this does not flush the quota_release_work queue.
    > 3. Freeze completes.
    > 4. Kernel eventually tries to flush the workqueue while FS is frozen which
    > hits a WARN_ON since transaction gets started during frozen state:
    > ext4_journal_check_start+0x28/0x110 [ext4] (unreliable)
    > __ext4_journal_start_sb+0x64/0x1c0 [ext4]
    > ext4_release_dquot+0x90/0x1d0 [ext4]
    > quota_release_workfn+0x43c/0x4d0
    > Which is the following line:
    > WARN_ON(sb-&gt;s_writers.frozen &#x3D;&#x3D; SB_FREEZE_COMPLETE);
    > Which ultimately results in generic/390 failing due to dmesg
    > noise. This was detected on powerpc machine 15 cores.
    > To avoid this, make sure to flush the workqueue during
    > dquot_writeback_dquots() so we dont have any pending workitems after
    > freeze.
    > Reported-by: Disha Goel &lt;disgoel@linux.ibm.com&gt;
    > CC: stable@vger.kernel.org
    > Fixes: dabc8b207566 (&quot;quota: fix dqput() to follow the guarantees dquot_srcu should provide&quot;)
    > Reviewed-by: Baokun Li &lt;libaokun1@huawei.com&gt;
    > Signed-off-by: Ojaswin Mujoo &lt;ojaswin@linux.ibm.com&gt;
    > Signed-off-by: Jan Kara &lt;jack@suse.cz&gt;
    > Link: https://patch.msgid.link/20241121123855.645335-2-ojaswin@linux.ibm.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ xfs: remove unknown compat feature check in superblock write validation (@Long Li in [2e87ea9bf3671ab](https://github.com/sophgo/linux-riscv/commit/2e87ea9bf3671ab) at 2024-12-09 09:40:55)
    > [ Upstream commit 652f03db897ba24f9c4b269e254ccc6cc01ff1b7 ]
    > Compat features are new features that older kernels can safely ignore,
    > allowing read-write mounts without issues. The current sb write validation
    > implementation returns -EFSCORRUPTED for unknown compat features,
    > preventing filesystem write operations and contradicting the feature&#x27;s
    > definition.
    > Additionally, if the mounted image is unclean, the log recovery may need
    > to write to the superblock. Returning an error for unknown compat features
    > during sb write validation can cause mount failures.
    > Although XFS currently does not use compat feature flags, this issue
    > affects current kernels&#x27; ability to mount images that may use compat
    > feature flags in the future.
    > Since superblock read validation already warns about unknown compat
    > features, it&#x27;s unnecessary to repeat this warning during write validation.
    > Therefore, the relevant code in write validation is being removed.
    > Fixes: 9e037cb7972f (&quot;xfs: check for unknown v5 feature bits in superblock write verifier&quot;)
    > Cc: stable@vger.kernel.org # v4.19+
    > Signed-off-by: Long Li &lt;leo.lilong@huawei.com&gt;
    > Reviewed-by: Darrick J. Wong &lt;djwong@kernel.org&gt;
    > Reviewed-by: Christoph Hellwig &lt;hch@lst.de&gt;
    > Signed-off-by: Carlos Maiolino &lt;cem@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ btrfs: move priv off stack in btrfs_encoded_read_regular_fill_pages() (@Mark Harmstone in [13bfaeafbfe3c9a](https://github.com/sophgo/linux-riscv/commit/13bfaeafbfe3c9a) at 2024-12-09 09:40:55)
    > [ Upstream commit 68d3b27e05c7ca5545e88465f5e2be6eda0e11df ]
    > Change btrfs_encoded_read_regular_fill_pages() so that the priv struct
    > is allocated rather than stored on the stack, in preparation for adding
    > an asynchronous mode to the function.
    > Signed-off-by: Mark Harmstone &lt;maharmstone@fb.com&gt;
    > Reviewed-by: David Sterba &lt;dsterba@suse.com&gt;
    > Signed-off-by: David Sterba &lt;dsterba@suse.com&gt;
    > Stable-dep-of: 05b36b04d74a (&quot;btrfs: fix use-after-free in btrfs_encoded_read_endio()&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ btrfs: drop unused parameter file_offset from btrfs_encoded_read_regular_fill_pages() (@David Sterba in [11755f72e54f11a](https://github.com/sophgo/linux-riscv/commit/11755f72e54f11a) at 2024-12-09 09:40:55)
    > [ Upstream commit 590168edbe6317ca9f4066215fb099f43ffe745c ]
    > The file_offset parameter used to be passed to encoded read struct but
    > was removed in commit b665affe93d8 (&quot;btrfs: remove unused members from
    > struct btrfs_encoded_read_private&quot;).
    > Reviewed-by: Anand Jain &lt;anand.jain@oracle.com&gt;
    > Signed-off-by: David Sterba &lt;dsterba@suse.com&gt;
    > Stable-dep-of: 05b36b04d74a (&quot;btrfs: fix use-after-free in btrfs_encoded_read_endio()&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ sched: Initialize idle tasks only once (@Thomas Gleixner in [e80e6c1b93c455b](https://github.com/sophgo/linux-riscv/commit/e80e6c1b93c455b) at 2024-12-06 06:20:46)
    > commit b23decf8ac9102fc52c4de5196f4dc0a5f3eb80b upstream.
    > Idle tasks are initialized via __sched_fork() twice:
    > fork_idle()
    > copy_process()
    > sched_fork()
    > __sched_fork()
    > init_idle()
    > __sched_fork()
    > Instead of cleaning this up, sched_ext hacked around it. Even when analyis
    > and solution were provided in a discussion, nobody cared to clean this up.
    > init_idle() is also invoked from sched_init() to initialize the boot CPU&#x27;s
    > idle task, which requires the __sched_fork() invocation. But this can be
    > trivially solved by invoking __sched_fork() before init_idle() in
    > sched_init() and removing the __sched_fork() invocation from init_idle().
    > Do so and clean up the comments explaining this historical leftover.
    > Signed-off-by: Thomas Gleixner &lt;tglx@linutronix.de&gt;
    > Signed-off-by: Peter Zijlstra (Intel) &lt;peterz@infradead.org&gt;
    > Link: https://lore.kernel.org/r/20241028103142.359584747@linutronix.de
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ Linux 6.12.3 (@Greg Kroah-Hartman in [47edb26c8ed9dd1](https://github.com/sophgo/linux-riscv/commit/47edb26c8ed9dd1) at 2024-12-06 06:20:46)
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ brd: decrease the number of allocated pages which discarded (@Zhang Xianwei in [fbc342372adb265](https://github.com/sophgo/linux-riscv/commit/fbc342372adb265) at 2024-12-05 13:03:10)
    > [ Upstream commit 82734209bedd65a8b508844bab652b464379bfdd ]
    > The number of allocated pages which discarded will not decrease.
    > Fix it.
    > Fixes: 9ead7efc6f3f (&quot;brd: implement discard support&quot;)
    > Signed-off-by: Zhang Xianwei &lt;zhang.xianwei8@zte.com.cn&gt;
    > Reviewed-by: Ming Lei &lt;ming.lei@redhat.com&gt;
    > Link: https://lore.kernel.org/r/20241128170056565nPKSz2vsP8K8X2uk2iaDG@zte.com.cn
    > Signed-off-by: Jens Axboe &lt;axboe@kernel.dk&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ Linux 6.12.2 (@Greg Kroah-Hartman in [fa10f348fd80c7e](https://github.com/sophgo/linux-riscv/commit/fa10f348fd80c7e) at 2024-12-05 13:03:10)
    > Link: https://lore.kernel.org/r/20241203144743.428732212@linuxfoundation.org
    > Tested-by: Salvatore Bonaccorso &lt;carnil@debian.org&gt;
    > Tested-by: Peter Schneider &lt;pschneider1968@googlemail.com&gt;
    > Tested-by: Mark Brown &lt;broonie@kernel.org&gt;
    > Tested-by: Ronald Warsow &lt;rwarsow@gmx.de&gt;
    > Tested-by: SeongJae Park &lt;sj@kernel.org&gt;
    > Tested-by: Ron Economos &lt;re@w6rz.net&gt;
    > Tested-by: Shuah Khan &lt;skhan@linuxfoundation.org&gt;
    > Tested-by: Miguel Ojeda &lt;ojeda@kernel.org&gt;
    > Tested-by: kernelci.org bot &lt;bot@kernelci.org&gt;
    > Tested-by: Pavel Machek (CIP) &lt;pavel@denx.de&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ block: always verify unfreeze lock on the owner task (@Ming Lei in [b12cfcae8a83140](https://github.com/sophgo/linux-riscv/commit/b12cfcae8a83140) at 2024-12-05 13:03:10)
    > commit 6a78699838a0ddeed3620ddf50c1521f1fe1e811 upstream.
    > commit f1be1788a32e (&quot;block: model freeze &amp; enter queue as lock for
    > supporting lockdep&quot;) tries to apply lockdep for verifying freeze &amp;
    > unfreeze. However, the verification is only done the outmost freeze and
    > unfreeze. This way is actually not correct because q-&gt;mq_freeze_depth
    > still may drop to zero on other task instead of the freeze owner task.
    > Fix this issue by always verifying the last unfreeze lock on the owner
    > task context, and make sure both the outmost freeze &amp; unfreeze are
    > verified in the current task.
    > Fixes: f1be1788a32e (&quot;block: model freeze &amp; enter queue as lock for supporting lockdep&quot;)
    > Signed-off-by: Ming Lei &lt;ming.lei@redhat.com&gt;
    > Link: https://lore.kernel.org/r/20241031133723.303835-4-ming.lei@redhat.com
    > Signed-off-by: Jens Axboe &lt;axboe@kernel.dk&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ tools/power turbostat: Fix child&#x27;s argument forwarding (@Patryk Wlazlyn in [a14ab9f3c937747](https://github.com/sophgo/linux-riscv/commit/a14ab9f3c937747) at 2024-12-05 13:03:10)
    > [ Upstream commit 1da0daf746342dfdc114e4dc8fbf3ece28666d4f ]
    > Add &#x27;+&#x27; to optstring when early scanning for --no-msr and --no-perf.
    > It causes option processing to stop as soon as a nonoption argument is
    > encountered, effectively skipping child&#x27;s arguments.
    > Fixes: 3e4048466c39 (&quot;tools/power turbostat: Add --no-msr option&quot;)
    > Signed-off-by: Patryk Wlazlyn &lt;patryk.wlazlyn@linux.intel.com&gt;
    > Signed-off-by: Len Brown &lt;len.brown@intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ tools/power turbostat: Fix trailing &#x27;\n&#x27; parsing (@Zhang Rui in [a109b531e5d279f](https://github.com/sophgo/linux-riscv/commit/a109b531e5d279f) at 2024-12-05 13:03:10)
    > [ Upstream commit fed8511cc8996989178823052dc0200643e1389a ]
    > parse_cpu_string() parses the string input either from command line or
    > from /sys/fs/cgroup/cpuset.cpus.effective to get a list of CPUs that
    > turbostat can run with.
    > The cpu string returned by /sys/fs/cgroup/cpuset.cpus.effective contains
    > a trailing &#x27;\n&#x27;, but strtoul() fails to treat this as an error.
    > That says, for the code below
    > val &#x3D; (&quot;\n&quot;, NULL, 10);
    > val returns 0, and errno is also not set.
    > As a result, CPU0 is erroneously considered as allowed CPU and this
    > causes failures when turbostat tries to run on CPU0.
    > get_counters: Could not migrate to CPU 0
    > ...
    > turbostat: re-initialized with num_cpus 8, allowed_cpus 5
    > get_counters: Could not migrate to CPU 0
    > Add a check to return immediately if &#x27;\n&#x27; or &#x27;\0&#x27; is detected.
    > Fixes: 8c3dd2c9e542 (&quot;tools/power/turbostat: Abstrct function for parsing cpu string&quot;)
    > Signed-off-by: Zhang Rui &lt;rui.zhang@intel.com&gt;
    > Signed-off-by: Len Brown &lt;len.brown@intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ block: don&#x27;t verify IO lock for freeze/unfreeze in elevator_init_mq() (@Ming Lei in [6cea47849d6e8c1](https://github.com/sophgo/linux-riscv/commit/6cea47849d6e8c1) at 2024-12-05 13:03:10)
    > commit 357e1b7f730bd85a383e7afa75a3caba329c5707 upstream.
    > elevator_init_mq() is only called at the entry of add_disk_fwnode() when
    > disk IO isn&#x27;t allowed yet.
    > So not verify io lock(q-&gt;io_lockdep_map) for freeze &amp; unfreeze in
    > elevator_init_mq().
    > Reported-by: Marek Szyprowski &lt;m.szyprowski@samsung.com&gt;
    > Reported-by: Lai Yi &lt;yi1.lai@linux.intel.com&gt;
    > Fixes: f1be1788a32e (&quot;block: model freeze &amp; enter queue as lock for supporting lockdep&quot;)
    > Signed-off-by: Ming Lei &lt;ming.lei@redhat.com&gt;
    > Link: https://lore.kernel.org/r/20241031133723.303835-5-ming.lei@redhat.com
    > Signed-off-by: Jens Axboe &lt;axboe@kernel.dk&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ sh: intc: Fix use-after-free bug in register_intc_controller() (@Dan Carpenter in [588bdec1ff8b815](https://github.com/sophgo/linux-riscv/commit/588bdec1ff8b815) at 2024-12-05 13:03:10)
    > [ Upstream commit 63e72e551942642c48456a4134975136cdcb9b3c ]
    > In the error handling for this function, d is freed without ever
    > removing it from intc_list which would lead to a use after free.
    > To fix this, let&#x27;s only add it to the list after everything has
    > succeeded.
    > Fixes: 2dcec7a988a1 (&quot;sh: intc: set_irq_wake() support&quot;)
    > Signed-off-by: Dan Carpenter &lt;dan.carpenter@linaro.org&gt;
    > Reviewed-by: John Paul Adrian Glaubitz &lt;glaubitz@physik.fu-berlin.de&gt;
    > Signed-off-by: John Paul Adrian Glaubitz &lt;glaubitz@physik.fu-berlin.de&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ nfs/blocklayout: Don&#x27;t attempt unregister for invalid block device (@Benjamin Coddington in [faa4bacfaeed827](https://github.com/sophgo/linux-riscv/commit/faa4bacfaeed827) at 2024-12-05 13:03:09)
    > [ Upstream commit 3a4ce14d9a6b868e0787e4582420b721c04ee41e ]
    > Since commit d869da91cccb (&quot;nfs/blocklayout: Fix premature PR key
    > unregistration&quot;) an unmount of a pNFS SCSI layout-enabled NFS may
    > dereference a NULL block_device in:
    > bl_unregister_scsi+0x16/0xe0 [blocklayoutdriver]
    > bl_free_device+0x70/0x80 [blocklayoutdriver]
    > bl_free_deviceid_node+0x12/0x30 [blocklayoutdriver]
    > nfs4_put_deviceid_node+0x60/0xc0 [nfsv4]
    > nfs4_deviceid_purge_client+0x132/0x190 [nfsv4]
    > unset_pnfs_layoutdriver+0x59/0x60 [nfsv4]
    > nfs4_destroy_server+0x36/0x70 [nfsv4]
    > nfs_free_server+0x23/0xe0 [nfs]
    > deactivate_locked_super+0x30/0xb0
    > cleanup_mnt+0xba/0x150
    > task_work_run+0x59/0x90
    > syscall_exit_to_user_mode+0x217/0x220
    > do_syscall_64+0x8e/0x160
    > This happens because even though we were able to create the
    > nfs4_deviceid_node, the lookup for the device was unable to attach the
    > block device to the pnfs_block_dev.
    > If we never found a block device to register, we can avoid this case with
    > the PNFS_BDEV_REGISTERED flag.  Move the deref behind the test for the
    > flag.
    > Fixes: d869da91cccb (&quot;nfs/blocklayout: Fix premature PR key unregistration&quot;)
    > Signed-off-by: Benjamin Coddington &lt;bcodding@redhat.com&gt;
    > Reviewed-by: Christoph Hellwig &lt;hch@lst.de&gt;
    > Reviewed-by: Chuck Lever &lt;chuck.lever@oracle.com&gt;
    > Signed-off-by: Trond Myklebust &lt;trond.myklebust@hammerspace.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ nfs/blocklayout: Limit repeat device registration on failure (@Benjamin Coddington in [bff8460376e53de](https://github.com/sophgo/linux-riscv/commit/bff8460376e53de) at 2024-12-05 13:03:09)
    > [ Upstream commit 614733f9441ed53bb442d4734112ec1e24bd6da7 ]
    > Every pNFS SCSI IO wants to do LAYOUTGET, then within the layout find the
    > device which can drive GETDEVINFO, then finally may need to prep the device
    > with a reservation.  This slow work makes a mess of IO latencies if one of
    > the later steps is going to fail for awhile.
    > If we&#x27;re unable to register a SCSI device, ensure we mark the device as
    > unavailable so that it will timeout and be re-added via GETDEVINFO.  This
    > avoids repeated doomed attempts to register a device in the IO path.
    > Add some clarifying comments as well.
    > Fixes: d869da91cccb (&quot;nfs/blocklayout: Fix premature PR key unregistration&quot;)
    > Signed-off-by: Benjamin Coddington &lt;bcodding@redhat.com&gt;
    > Reviewed-by: Christoph Hellwig &lt;hch@lst.de&gt;
    > Reviewed-by: Chuck Lever &lt;chuck.lever@oracle.com&gt;
    > Signed-off-by: Trond Myklebust &lt;trond.myklebust@hammerspace.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ SUNRPC: timeout and cancel TLS handshake with -ETIMEDOUT (@Benjamin Coddington in [a84e6c15f101cd0](https://github.com/sophgo/linux-riscv/commit/a84e6c15f101cd0) at 2024-12-05 13:03:09)
    > [ Upstream commit d7bdd849ef1b681da03ac05ca0957b2cbe2d24b6 ]
    > We&#x27;ve noticed a situation where an unstable TCP connection can cause the
    > TLS handshake to timeout waiting for userspace to complete it.  When this
    > happens, we don&#x27;t want to return from xs_tls_handshake_sync() with zero, as
    > this will cause the upper xprt to be set CONNECTED, and subsequent attempts
    > to transmit will be returned with -EPIPE.  The sunrpc machine does not
    > recover from this situation and will spin attempting to transmit.
    > The return value of tls_handshake_cancel() can be used to detect a race
    > with completion:
    > tls_handshake_cancel - cancel a pending handshake
    > Return values:
    > %true - Uncompleted handshake request was canceled
    > %false - Handshake request already completed or not found
    > If true, we do not want the upper xprt to be connected, so return
    > -ETIMEDOUT.  If false, its possible the handshake request was lost and
    > that may be the reason for our timeout.  Again we do not want the upper
    > xprt to be connected, so return -ETIMEDOUT.
    > Ensure that we alway return an error from xs_tls_handshake_sync() if we
    > call tls_handshake_cancel().
    > Signed-off-by: Benjamin Coddington &lt;bcodding@redhat.com&gt;
    > Reviewed-by: Chuck Lever &lt;chuck.lever@oracle.com&gt;
    > Fixes: 75eb6af7acdf (&quot;SUNRPC: Add a TCP-with-TLS RPC transport class&quot;)
    > Signed-off-by: Trond Myklebust &lt;trond.myklebust@hammerspace.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ sunrpc: clear XPRT_SOCK_UPD_TIMEOUT when reset transport (@Liu Jian in [66d11ca91bf5100](https://github.com/sophgo/linux-riscv/commit/66d11ca91bf5100) at 2024-12-05 13:03:09)
    > [ Upstream commit 4db9ad82a6c823094da27de4825af693a3475d51 ]
    > Since transport-&gt;sock has been set to NULL during reset transport,
    > XPRT_SOCK_UPD_TIMEOUT also needs to be cleared. Otherwise, the
    > xs_tcp_set_socket_timeouts() may be triggered in xs_tcp_send_request()
    > to dereference the transport-&gt;sock that has been set to NULL.
    > Fixes: 7196dbb02ea0 (&quot;SUNRPC: Allow changing of the TCP timeout parameters on the fly&quot;)
    > Signed-off-by: Li Lingfeng &lt;lilingfeng3@huawei.com&gt;
    > Signed-off-by: Liu Jian &lt;liujian56@huawei.com&gt;
    > Signed-off-by: Trond Myklebust &lt;trond.myklebust@hammerspace.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ sunrpc: fix one UAF issue caused by sunrpc kernel tcp socket (@Liu Jian in [61c0a5eac96836d](https://github.com/sophgo/linux-riscv/commit/61c0a5eac96836d) at 2024-12-05 13:03:09)
    > [ Upstream commit 3f23f96528e8fcf8619895c4c916c52653892ec1 ]
    > BUG: KASAN: slab-use-after-free in tcp_write_timer_handler+0x156/0x3e0
    > Read of size 1 at addr ffff888111f322cd by task swapper/0/0
    > CPU: 0 UID: 0 PID: 0 Comm: swapper/0 Not tainted 6.12.0-rc4-dirty #7
    > Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1
    > Call Trace:
    > &lt;IRQ&gt;
    > dump_stack_lvl+0x68/0xa0
    > print_address_description.constprop.0+0x2c/0x3d0
    > print_report+0xb4/0x270
    > kasan_report+0xbd/0xf0
    > tcp_write_timer_handler+0x156/0x3e0
    > tcp_write_timer+0x66/0x170
    > call_timer_fn+0xfb/0x1d0
    > __run_timers+0x3f8/0x480
    > run_timer_softirq+0x9b/0x100
    > handle_softirqs+0x153/0x390
    > __irq_exit_rcu+0x103/0x120
    > irq_exit_rcu+0xe/0x20
    > sysvec_apic_timer_interrupt+0x76/0x90
    > &lt;/IRQ&gt;
    > &lt;TASK&gt;
    > asm_sysvec_apic_timer_interrupt+0x1a/0x20
    > RIP: 0010:default_idle+0xf/0x20
    > Code: 4c 01 c7 4c 29 c2 e9 72 ff ff ff 90 90 90 90 90 90 90 90 90 90 90 90
    > 90 90 90 90 f3 0f 1e fa 66 90 0f 00 2d 33 f8 25 00 fb f4 &lt;fa&gt; c3 cc cc cc
    > cc 66 66 2e 0f 1f 84 00 00 00 00 00 90 90 90 90 90
    > RSP: 0018:ffffffffa2007e28 EFLAGS: 00000242
    > RAX: 00000000000f3b31 RBX: 1ffffffff4400fc7 RCX: ffffffffa09c3196
    > RDX: 0000000000000000 RSI: 0000000000000000 RDI: ffffffff9f00590f
    > RBP: 0000000000000000 R08: 0000000000000001 R09: ffffed102360835d
    > R10: ffff88811b041aeb R11: 0000000000000001 R12: 0000000000000000
    > R13: ffffffffa202d7c0 R14: 0000000000000000 R15: 00000000000147d0
    > default_idle_call+0x6b/0xa0
    > cpuidle_idle_call+0x1af/0x1f0
    > do_idle+0xbc/0x130
    > cpu_startup_entry+0x33/0x40
    > rest_init+0x11f/0x210
    > start_kernel+0x39a/0x420
    > x86_64_start_reservations+0x18/0x30
    > x86_64_start_kernel+0x97/0xa0
    > common_startup_64+0x13e/0x141
    > &lt;/TASK&gt;
    > Allocated by task 595:
    > kasan_save_stack+0x24/0x50
    > kasan_save_track+0x14/0x30
    > __kasan_slab_alloc+0x87/0x90
    > kmem_cache_alloc_noprof+0x12b/0x3f0
    > copy_net_ns+0x94/0x380
    > create_new_namespaces+0x24c/0x500
    > unshare_nsproxy_namespaces+0x75/0xf0
    > ksys_unshare+0x24e/0x4f0
    > __x64_sys_unshare+0x1f/0x30
    > do_syscall_64+0x70/0x180
    > entry_SYSCALL_64_after_hwframe+0x76/0x7e
    > Freed by task 100:
    > kasan_save_stack+0x24/0x50
    > kasan_save_track+0x14/0x30
    > kasan_save_free_info+0x3b/0x60
    > __kasan_slab_free+0x54/0x70
    > kmem_cache_free+0x156/0x5d0
    > cleanup_net+0x5d3/0x670
    > process_one_work+0x776/0xa90
    > worker_thread+0x2e2/0x560
    > kthread+0x1a8/0x1f0
    > ret_from_fork+0x34/0x60
    > ret_from_fork_asm+0x1a/0x30
    > Reproduction script:
    > mkdir -p /mnt/nfsshare
    > mkdir -p /mnt/nfs/netns_1
    > mkfs.ext4 /dev/sdb
    > mount /dev/sdb /mnt/nfsshare
    > systemctl restart nfs-server
    > chmod 777 /mnt/nfsshare
    > exportfs -i -o rw,no_root_squash *:/mnt/nfsshare
    > ip netns add netns_1
    > ip link add name veth_1_peer type veth peer veth_1
    > ifconfig veth_1_peer 11.11.0.254 up
    > ip link set veth_1 netns netns_1
    > ip netns exec netns_1 ifconfig veth_1 11.11.0.1
    > ip netns exec netns_1 /root/iptables -A OUTPUT -d 11.11.0.254 -p tcp \
    > --tcp-flags FIN FIN  -j DROP
    > (note: In my environment, a DESTROY_CLIENTID operation is always sent
    > immediately, breaking the nfs tcp connection.)
    > ip netns exec netns_1 timeout -s 9 300 mount -t nfs -o proto&#x3D;tcp,vers&#x3D;4.1 \
    > 11.11.0.254:/mnt/nfsshare /mnt/nfs/netns_1
    > ip netns del netns_1
    > The reason here is that the tcp socket in netns_1 (nfs side) has been
    > shutdown and closed (done in xs_destroy), but the FIN message (with ack)
    > is discarded, and the nfsd side keeps sending retransmission messages.
    > As a result, when the tcp sock in netns_1 processes the received message,
    > it sends the message (FIN message) in the sending queue, and the tcp timer
    > is re-established. When the network namespace is deleted, the net structure
    > accessed by tcp&#x27;s timer handler function causes problems.
    > To fix this problem, let&#x27;s hold netns refcnt for the tcp kernel socket as
    > done in other modules. This is an ugly hack which can easily be backported
    > to earlier kernels. A proper fix which cleans up the interfaces will
    > follow, but may not be so easy to backport.
    > Fixes: 26abe14379f8 (&quot;net: Modify sk_alloc to not reference count the netns of kernel sockets.&quot;)
    > Signed-off-by: Liu Jian &lt;liujian56@huawei.com&gt;
    > Acked-by: Jeff Layton &lt;jlayton@kernel.org&gt;
    > Reviewed-by: Kuniyuki Iwashima &lt;kuniyu@amazon.com&gt;
    > Signed-off-by: Trond Myklebust &lt;trond.myklebust@hammerspace.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ nfs: ignore SB_RDONLY when mounting nfs (@Li Lingfeng in [56a5d998c912566](https://github.com/sophgo/linux-riscv/commit/56a5d998c912566) at 2024-12-05 13:03:09)
    > [ Upstream commit 52cb7f8f177878b4f22397b9c4d2c8f743766be3 ]
    > When exporting only one file system with fsid&#x3D;0 on the server side, the
    > client alternately uses the ro/rw mount options to perform the mount
    > operation, and a new vfsmount is generated each time.
    > It can be reproduced as follows:
    > [root@localhost ~]# mount /dev/sda /mnt2
    > [root@localhost ~]# echo &quot;/mnt2 *(rw,no_root_squash,fsid&#x3D;0)&quot; &gt;/etc/exports
    > [root@localhost ~]# systemctl restart nfs-server
    > [root@localhost ~]# mount -t nfs -o ro,vers&#x3D;4 127.0.0.1:/ /mnt/sdaa
    > [root@localhost ~]# mount -t nfs -o rw,vers&#x3D;4 127.0.0.1:/ /mnt/sdaa
    > [root@localhost ~]# mount -t nfs -o ro,vers&#x3D;4 127.0.0.1:/ /mnt/sdaa
    > [root@localhost ~]# mount -t nfs -o rw,vers&#x3D;4 127.0.0.1:/ /mnt/sdaa
    > [root@localhost ~]# mount | grep nfs4
    > 127.0.0.1:/ on /mnt/sdaa type nfs4 (ro,relatime,vers&#x3D;4.2,rsize&#x3D;1048576,...
    > 127.0.0.1:/ on /mnt/sdaa type nfs4 (rw,relatime,vers&#x3D;4.2,rsize&#x3D;1048576,...
    > 127.0.0.1:/ on /mnt/sdaa type nfs4 (ro,relatime,vers&#x3D;4.2,rsize&#x3D;1048576,...
    > 127.0.0.1:/ on /mnt/sdaa type nfs4 (rw,relatime,vers&#x3D;4.2,rsize&#x3D;1048576,...
    > [root@localhost ~]#
    > We expected that after mounting with the ro option, using the rw option to
    > mount again would return EBUSY, but the actual situation was not the case.
    > As shown above, when mounting for the first time, a superblock with the ro
    > flag will be generated, and at the same time, in do_new_mount_fc --&gt;
    > do_add_mount, it detects that the superblock corresponding to the current
    > target directory is inconsistent with the currently generated one
    > (path-&gt;mnt-&gt;mnt_sb !&#x3D; newmnt-&gt;mnt.mnt_sb), and a new vfsmount will be
    > generated.
    > When mounting with the rw option for the second time, since no matching
    > superblock can be found in the fs_supers list, a new superblock with the
    > rw flag will be generated again. The superblock in use (ro) is different
    > from the newly generated superblock (rw), and a new vfsmount will be
    > generated again.
    > When mounting with the ro option for the third time, the superblock (ro)
    > is found in fs_supers, the superblock in use (rw) is different from the
    > found superblock (ro), and a new vfsmount will be generated again.
    > We can switch between ro/rw through remount, and only one superblock needs
    > to be generated, thus avoiding the problem of repeated generation of
    > vfsmount caused by switching superblocks.
    > Furthermore, This can also resolve the issue described in the link.
    > Fixes: 275a5d24bf56 (&quot;NFS: Error when mounting the same filesystem with different options&quot;)
    > Link: https://lore.kernel.org/all/20240604112636.236517-3-lilingfeng@huaweicloud.com/
    > Signed-off-by: Li Lingfeng &lt;lilingfeng3@huawei.com&gt;
    > Signed-off-by: Trond Myklebust &lt;trond.myklebust@hammerspace.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ block, bfq: fix bfqq uaf in bfq_limit_depth() (@Yu Kuai in [01a853faaeaf337](https://github.com/sophgo/linux-riscv/commit/01a853faaeaf337) at 2024-12-05 13:03:09)
    > [ Upstream commit e8b8344de3980709080d86c157d24e7de07d70ad ]
    > Set new allocated bfqq to bic or remove freed bfqq from bic are both
    > protected by bfqd-&gt;lock, however bfq_limit_depth() is deferencing bfqq
    > from bic without the lock, this can lead to UAF if the io_context is
    > shared by multiple tasks.
    > For example, test bfq with io_uring can trigger following UAF in v6.6:
    > &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;
    > BUG: KASAN: slab-use-after-free in bfqq_group+0x15/0x50
    > Call Trace:
    > &lt;TASK&gt;
    > dump_stack_lvl+0x47/0x80
    > print_address_description.constprop.0+0x66/0x300
    > print_report+0x3e/0x70
    > kasan_report+0xb4/0xf0
    > bfqq_group+0x15/0x50
    > bfqq_request_over_limit+0x130/0x9a0
    > bfq_limit_depth+0x1b5/0x480
    > __blk_mq_alloc_requests+0x2b5/0xa00
    > blk_mq_get_new_requests+0x11d/0x1d0
    > blk_mq_submit_bio+0x286/0xb00
    > submit_bio_noacct_nocheck+0x331/0x400
    > __block_write_full_folio+0x3d0/0x640
    > writepage_cb+0x3b/0xc0
    > write_cache_pages+0x254/0x6c0
    > write_cache_pages+0x254/0x6c0
    > do_writepages+0x192/0x310
    > filemap_fdatawrite_wbc+0x95/0xc0
    > __filemap_fdatawrite_range+0x99/0xd0
    > filemap_write_and_wait_range.part.0+0x4d/0xa0
    > blkdev_read_iter+0xef/0x1e0
    > io_read+0x1b6/0x8a0
    > io_issue_sqe+0x87/0x300
    > io_wq_submit_work+0xeb/0x390
    > io_worker_handle_work+0x24d/0x550
    > io_wq_worker+0x27f/0x6c0
    > ret_from_fork_asm+0x1b/0x30
    > &lt;/TASK&gt;
    > Allocated by task 808602:
    > kasan_save_stack+0x1e/0x40
    > kasan_set_track+0x21/0x30
    > __kasan_slab_alloc+0x83/0x90
    > kmem_cache_alloc_node+0x1b1/0x6d0
    > bfq_get_queue+0x138/0xfa0
    > bfq_get_bfqq_handle_split+0xe3/0x2c0
    > bfq_init_rq+0x196/0xbb0
    > bfq_insert_request.isra.0+0xb5/0x480
    > bfq_insert_requests+0x156/0x180
    > blk_mq_insert_request+0x15d/0x440
    > blk_mq_submit_bio+0x8a4/0xb00
    > submit_bio_noacct_nocheck+0x331/0x400
    > __blkdev_direct_IO_async+0x2dd/0x330
    > blkdev_write_iter+0x39a/0x450
    > io_write+0x22a/0x840
    > io_issue_sqe+0x87/0x300
    > io_wq_submit_work+0xeb/0x390
    > io_worker_handle_work+0x24d/0x550
    > io_wq_worker+0x27f/0x6c0
    > ret_from_fork+0x2d/0x50
    > ret_from_fork_asm+0x1b/0x30
    > Freed by task 808589:
    > kasan_save_stack+0x1e/0x40
    > kasan_set_track+0x21/0x30
    > kasan_save_free_info+0x27/0x40
    > __kasan_slab_free+0x126/0x1b0
    > kmem_cache_free+0x10c/0x750
    > bfq_put_queue+0x2dd/0x770
    > __bfq_insert_request.isra.0+0x155/0x7a0
    > bfq_insert_request.isra.0+0x122/0x480
    > bfq_insert_requests+0x156/0x180
    > blk_mq_dispatch_plug_list+0x528/0x7e0
    > blk_mq_flush_plug_list.part.0+0xe5/0x590
    > __blk_flush_plug+0x3b/0x90
    > blk_finish_plug+0x40/0x60
    > do_writepages+0x19d/0x310
    > filemap_fdatawrite_wbc+0x95/0xc0
    > __filemap_fdatawrite_range+0x99/0xd0
    > filemap_write_and_wait_range.part.0+0x4d/0xa0
    > blkdev_read_iter+0xef/0x1e0
    > io_read+0x1b6/0x8a0
    > io_issue_sqe+0x87/0x300
    > io_wq_submit_work+0xeb/0x390
    > io_worker_handle_work+0x24d/0x550
    > io_wq_worker+0x27f/0x6c0
    > ret_from_fork+0x2d/0x50
    > ret_from_fork_asm+0x1b/0x30
    > Fix the problem by protecting bic_to_bfqq() with bfqd-&gt;lock.
    > CC: Jan Kara &lt;jack@suse.cz&gt;
    > Fixes: 76f1df88bbc2 (&quot;bfq: Limit number of requests consumed by each cgroup&quot;)
    > Signed-off-by: Yu Kuai &lt;yukuai3@huawei.com&gt;
    > Link: https://lore.kernel.org/r/20241129091509.2227136-1-yukuai1@huaweicloud.com
    > Signed-off-by: Jens Axboe &lt;axboe@kernel.dk&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ modpost: remove incorrect code in do_eisa_entry() (@Masahiro Yamada in [e70c21daad17efa](https://github.com/sophgo/linux-riscv/commit/e70c21daad17efa) at 2024-12-05 13:03:08)
    > [ Upstream commit 0c3e091319e4748cb36ac9a50848903dc6f54054 ]
    > This function contains multiple bugs after the following commits:
    >  - ac551828993e (&quot;modpost: i2c aliases need no trailing wildcard&quot;)
    >  - 6543becf26ff (&quot;mod/file2alias: make modalias generation safe for cross compiling&quot;)
    > Commit ac551828993e inserted the following code to do_eisa_entry():
    >     else
    >             strcat(alias, &quot;*&quot;);
    > This is incorrect because &#x27;alias&#x27; is uninitialized. If it is not
    > NULL-terminated, strcat() could cause a buffer overrun.
    > Even if &#x27;alias&#x27; happens to be zero-filled, it would output:
    > MODULE_ALIAS(&quot;*&quot;);
    > This would match anything. As a result, the module could be loaded by
    > any unrelated uevent from an unrelated subsystem.
    > Commit ac551828993e introduced another bug.            
    > Prior to that commit, the conditional check was:
    >     if (eisa-&gt;sig[0])
    > This checked if the first character of eisa_device_id::sig was not &#x27;\0&#x27;.
    > However, commit ac551828993e changed it as follows:
    >     if (sig[0])
    > sig[0] is NOT the first character of the eisa_device_id::sig. The
    > type of &#x27;sig&#x27; is &#x27;char (*)[8]&#x27;, meaning that the type of &#x27;sig[0]&#x27; is
    > &#x27;char [8]&#x27; instead of &#x27;char&#x27;. &#x27;sig[0]&#x27; and &#x27;symval&#x27; refer to the same
    > address, which never becomes NULL.
    > The correct conversion would have been:
    >     if ((*sig)[0])
    > However, this if-conditional was meaningless because the earlier change
    > in commit ac551828993e was incorrect.
    > This commit removes the entire incorrect code, which should never have
    > been executed.
    > Fixes: ac551828993e (&quot;modpost: i2c aliases need no trailing wildcard&quot;)
    > Fixes: 6543becf26ff (&quot;mod/file2alias: make modalias generation safe for cross compiling&quot;)
    > Signed-off-by: Masahiro Yamada &lt;masahiroy@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ block: Don&#x27;t allow an atomic write be truncated in blkdev_write_iter() (@John Garry in [d5457349e585bd5](https://github.com/sophgo/linux-riscv/commit/d5457349e585bd5) at 2024-12-05 13:03:08)
    > [ Upstream commit 2cbd51f1f8739fd2fdf4bae1386bcf75ce0176ba ]
    > A write which goes past the end of the bdev in blkdev_write_iter() will
    > be truncated. Truncating cannot tolerated for an atomic write, so error
    > that condition.
    > Fixes: caf336f81b3a (&quot;block: Add fops atomic write support&quot;)
    > Signed-off-by: John Garry &lt;john.g.garry@oracle.com&gt;
    > Reviewed-by: Christoph Hellwig &lt;hch@lst.de&gt;
    > Link: https://lore.kernel.org/r/20241127092318.632790-1-john.g.garry@oracle.com
    > Signed-off-by: Jens Axboe &lt;axboe@kernel.dk&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ cifs: unlock on error in smb3_reconfigure() (@Dan Carpenter in [b6229b7e2e8cf07](https://github.com/sophgo/linux-riscv/commit/b6229b7e2e8cf07) at 2024-12-05 13:03:08)
    > [ Upstream commit cda88d2fef7aa7de80b5697e8009fcbbb436f42d ]
    > Unlock before returning if smb3_sync_session_ctx_passwords() fails.
    > Fixes: 7e654ab7da03 (&quot;cifs: during remount, make sure passwords are in sync&quot;)
    > Signed-off-by: Dan Carpenter &lt;dan.carpenter@linaro.org&gt;
    > Reviewed-by: Bharath SM &lt;bharathsm@microsoft.com&gt;
    > Signed-off-by: Steve French &lt;stfrench@microsoft.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ Rename .data.once to .data..once to fix resetting WARN*_ONCE (@Masahiro Yamada in [48dd6c71976bc8c](https://github.com/sophgo/linux-riscv/commit/48dd6c71976bc8c) at 2024-12-05 13:03:08)
    > [ Upstream commit dbefa1f31a91670c9e7dac9b559625336206466f ]
    > Commit b1fca27d384e (&quot;kernel debug: support resetting WARN*_ONCE&quot;)
    > added support for clearing the state of once warnings. However,
    > it is not functional when CONFIG_LD_DEAD_CODE_DATA_ELIMINATION or
    > CONFIG_LTO_CLANG is enabled, because .data.once matches the
    > .data.[0-9a-zA-Z_]* pattern in the DATA_MAIN macro.
    > Commit cb87481ee89d (&quot;kbuild: linker script do not match C names unless
    > LD_DEAD_CODE_DATA_ELIMINATION is configured&quot;) was introduced to suppress
    > the issue for the default CONFIG_LD_DEAD_CODE_DATA_ELIMINATION&#x3D;n case,
    > providing a minimal fix for stable backporting. We were aware this did
    > not address the issue for CONFIG_LD_DEAD_CODE_DATA_ELIMINATION&#x3D;y. The
    > plan was to apply correct fixes and then revert cb87481ee89d. [1]
    > Seven years have passed since then, yet the #ifdef workaround remains in
    > place. Meanwhile, commit b1fca27d384e introduced the .data.once section,
    > and commit dc5723b02e52 (&quot;kbuild: add support for Clang LTO&quot;) extended
    > the #ifdef.
    > Using a &quot;..&quot; separator in the section name fixes the issue for
    > CONFIG_LD_DEAD_CODE_DATA_ELIMINATION and CONFIG_LTO_CLANG.
    > [1]: https://lore.kernel.org/linux-kbuild/CAK7LNASck6BfdLnESxXUeECYL26yUDm0cwRZuM4gmaWUkxjL5g@mail.gmail.com/
    > Fixes: b1fca27d384e (&quot;kernel debug: support resetting WARN*_ONCE&quot;)
    > Fixes: dc5723b02e52 (&quot;kbuild: add support for Clang LTO&quot;)
    > Signed-off-by: Masahiro Yamada &lt;masahiroy@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ kbuild: deb-pkg: Don&#x27;t fail if modules.order is missing (@Matt Fleming in [34d321f4536cc6b](https://github.com/sophgo/linux-riscv/commit/34d321f4536cc6b) at 2024-12-05 13:03:08)
    > [ Upstream commit bcbbf493f2fa6fa1f0832f6b5b4c80a65de242d6 ]
    > Kernels built without CONFIG_MODULES might still want to create -dbg deb
    > packages but install_linux_image_dbg() assumes modules.order always
    > exists. This obviously isn&#x27;t true if no modules were built, so we should
    > skip reading modules.order in that case.
    > Fixes: 16c36f8864e3 (&quot;kbuild: deb-pkg: use build ID instead of debug link for dbg package&quot;)
    > Signed-off-by: Matt Fleming &lt;mfleming@cloudflare.com&gt;
    > Signed-off-by: Masahiro Yamada &lt;masahiroy@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ smb: Initialize cfid-&gt;tcon before performing network ops (@Paul Aurich in [1b9ab6b648f8944](https://github.com/sophgo/linux-riscv/commit/1b9ab6b648f8944) at 2024-12-05 13:03:08)
    > [ Upstream commit c353ee4fb119a2582d0e011f66a76a38f5cf984d ]
    > Avoid leaking a tcon ref when a lease break races with opening the
    > cached directory. Processing the leak break might take a reference to
    > the tcon in cached_dir_lease_break() and then fail to release the ref in
    > cached_dir_offload_close, since cfid-&gt;tcon is still NULL.
    > Fixes: ebe98f1447bb (&quot;cifs: enable caching of directories for which a lease is held&quot;)
    > Signed-off-by: Paul Aurich &lt;paul@darkrain42.org&gt;
    > Signed-off-by: Steve French &lt;stfrench@microsoft.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ cifs: during remount, make sure passwords are in sync (@Shyam Prasad N in [0e4145774c01653](https://github.com/sophgo/linux-riscv/commit/0e4145774c01653) at 2024-12-05 13:03:08)
    > [ Upstream commit 0f0e357902957fba28ed31bde0d6921c6bd1485d ]
    > This fixes scenarios where remount can overwrite the only currently
    > working password, breaking reconnect.
    > We recently introduced a password2 field in both ses and ctx structs.
    > This was done so as to allow the client to rotate passwords for a mount
    > without any downtime. However, when the client transparently handles
    > password rotation, it can swap the values of the two password fields
    > in the ses struct, but not in smb3_fs_context struct that hangs off
    > cifs_sb. This can lead to a situation where a remount unintentionally
    > overwrites a working password in the ses struct.
    > In order to fix this, we first get the passwords in ctx struct
    > in-sync with ses struct, before replacing them with what the passwords
    > that could be passed as a part of remount.
    > Also, in order to avoid race condition between smb2_reconnect and
    > smb3_reconfigure, we make sure to lock session_mutex before changing
    > password and password2 fields of the ses structure.
    > Fixes: 35f834265e0d (&quot;smb3: fix broken reconnect when password changing on the server by allowing password rotation&quot;)
    > Signed-off-by: Shyam Prasad N &lt;sprasad@microsoft.com&gt;
    > Signed-off-by: Meetakshi Setiya &lt;msetiya@microsoft.com&gt;
    > Signed-off-by: Steve French &lt;stfrench@microsoft.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ cifs: Fix parsing native symlinks relative to the export (@Pali Rohár in [fc5a409552be479](https://github.com/sophgo/linux-riscv/commit/fc5a409552be479) at 2024-12-05 13:03:07)
    > [ Upstream commit 723f4ef90452aa629f3d923e92e0449d69362b1d ]
    > SMB symlink which has SYMLINK_FLAG_RELATIVE set is relative (as opposite of
    > the absolute) and it can be relative either to the current directory (where
    > is the symlink stored) or relative to the top level export path. To what it
    > is relative depends on the first character of the symlink target path.
    > If the first character is path separator then symlink is relative to the
    > export, otherwise to the current directory. Linux (and generally POSIX
    > systems) supports only symlink paths relative to the current directory
    > where is symlink stored.
    > Currently if Linux SMB client reads relative SMB symlink with first
    > character as path separator (slash), it let as is. Which means that Linux
    > interpret it as absolute symlink pointing from the root (/). But this
    > location is different than the top level directory of SMB export (unless
    > SMB export was mounted to the root) and thefore SMB symlinks relative to
    > the export are interpreted wrongly by Linux SMB client.
    > Fix this problem. As Linux does not have equivalent of the path relative to
    > the top of the mount point, convert such symlink target path relative to
    > the current directory. Do this by prepending &quot;../&quot; pattern N times before
    > the SMB target path, where N is the number of path separators found in SMB
    > symlink path.
    > So for example, if SMB share is mounted to Linux path /mnt/share/, symlink
    > is stored in file /mnt/share/test/folder1/symlink (so SMB symlink path is
    > test\folder1\symlink) and SMB symlink target points to \test\folder2\file,
    > then convert symlink target path to Linux path ../../test/folder2/file.
    > Deduplicate code for parsing SMB symlinks in native form from functions
    > smb2_parse_symlink_response() and parse_reparse_native_symlink() into new
    > function smb2_parse_native_symlink() and pass into this new function a new
    > full_path parameter from callers, which specify SMB full path where is
    > symlink stored.
    > This change fixes resolving of the native Windows symlinks relative to the
    > top level directory of the SMB share.
    > Signed-off-by: Pali Rohár &lt;pali@kernel.org&gt;
    > Signed-off-by: Steve French &lt;stfrench@microsoft.com&gt;
    > Stable-dep-of: f4ca4f5a36ea (&quot;cifs: Fix parsing reparse point with native symlink in SMB1 non-UNICODE session&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ Rename .data.unlikely to .data..unlikely (@Masahiro Yamada in [cc7d10339d95bf6](https://github.com/sophgo/linux-riscv/commit/cc7d10339d95bf6) at 2024-12-05 13:03:07)
    > [ Upstream commit bb43a59944f45e89aa158740b8a16ba8f0b0fa2b ]
    > Commit 7ccaba5314ca (&quot;consolidate WARN_...ONCE() static variables&quot;)
    > was intended to collect all .data.unlikely sections into one chunk.
    > However, this has not worked when CONFIG_LD_DEAD_CODE_DATA_ELIMINATION
    > or CONFIG_LTO_CLANG is enabled, because .data.unlikely matches the
    > .data.[0-9a-zA-Z_]* pattern in the DATA_MAIN macro.
    > Commit cb87481ee89d (&quot;kbuild: linker script do not match C names unless
    > LD_DEAD_CODE_DATA_ELIMINATION is configured&quot;) was introduced to suppress
    > the issue for the default CONFIG_LD_DEAD_CODE_DATA_ELIMINATION&#x3D;n case,
    > providing a minimal fix for stable backporting. We were aware this did
    > not address the issue for CONFIG_LD_DEAD_CODE_DATA_ELIMINATION&#x3D;y. The
    > plan was to apply correct fixes and then revert cb87481ee89d. [1]
    > Seven years have passed since then, yet the #ifdef workaround remains in
    > place.
    > Using a &quot;..&quot; separator in the section name fixes the issue for
    > CONFIG_LD_DEAD_CODE_DATA_ELIMINATION and CONFIG_LTO_CLANG.
    > [1]: https://lore.kernel.org/linux-kbuild/CAK7LNASck6BfdLnESxXUeECYL26yUDm0cwRZuM4gmaWUkxjL5g@mail.gmail.com/
    > Fixes: cb87481ee89d (&quot;kbuild: linker script do not match C names unless LD_DEAD_CODE_DATA_ELIMINATION is configured&quot;)
    > Signed-off-by: Masahiro Yamada &lt;masahiroy@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ cifs: Fix parsing reparse point with native symlink in SMB1 non-UNICODE session (@Pali Rohár in [cc0075cf26b59cf](https://github.com/sophgo/linux-riscv/commit/cc0075cf26b59cf) at 2024-12-05 13:03:07)
    > [ Upstream commit f4ca4f5a36eac9b4da378a0f28cbbe38534a0901 ]
    > SMB1 NT_TRANSACT_IOCTL/FSCTL_GET_REPARSE_POINT even in non-UNICODE mode
    > returns reparse buffer in UNICODE/UTF-16 format.
    > This is because FSCTL_GET_REPARSE_POINT is NT-based IOCTL which does not
    > distinguish between 8-bit non-UNICODE and 16-bit UNICODE modes and its path
    > buffers are always encoded in UTF-16.
    > This change fixes reading of native symlinks in SMB1 when UNICODE session
    > is not active.
    > Fixes: ed3e0a149b58 (&quot;smb: client: implement -&gt;query_reparse_point() for SMB1&quot;)
    > Signed-off-by: Pali Rohár &lt;pali@kernel.org&gt;
    > Signed-off-by: Steve French &lt;stfrench@microsoft.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ rtc: ab-eoz9: don&#x27;t fail temperature reads on undervoltage notification (@Maxime Chevallier in [9a066eec94cdee1](https://github.com/sophgo/linux-riscv/commit/9a066eec94cdee1) at 2024-12-05 13:03:07)
    > [ Upstream commit e0779a0dcf41a6452ac0a169cd96863feb5787c7 ]
    > The undervoltage flags reported by the RTC are useful to know if the
    > time and date are reliable after a reboot. Although the threshold VLOW1
    > indicates that the thermometer has been shutdown and time compensation
    > is off, it doesn&#x27;t mean that the temperature readout is currently
    > impossible.
    > As the system is running, the RTC voltage is now fully established and
    > we can read the temperature.
    > Fixes: 67075b63cce2 (&quot;rtc: add AB-RTCMC-32.768kHz-EOZ9 RTC support&quot;)
    > Signed-off-by: Maxime Chevallier &lt;maxime.chevallier@bootlin.com&gt;
    > Link: https://lore.kernel.org/r/20241122101031.68916-3-maxime.chevallier@bootlin.com
    > Signed-off-by: Alexandre Belloni &lt;alexandre.belloni@bootlin.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ smb: client: disable directory caching when dir_cache_timeout is zero (@Henrique Carvalho in [7fbe643b5681992](https://github.com/sophgo/linux-riscv/commit/7fbe643b5681992) at 2024-12-05 13:03:07)
    > [ Upstream commit ceaf1451990e3ea7fb50aebb5a149f57945f6e9f ]
    > Setting dir_cache_timeout to zero should disable the caching of
    > directory contents. Currently, even when dir_cache_timeout is zero,
    > some caching related functions are still invoked, which is unintended
    > behavior.
    > Fix the issue by setting tcon-&gt;nohandlecache to true when
    > dir_cache_timeout is zero, ensuring that directory handle caching
    > is properly disabled.
    > Fixes: 238b351d0935 (&quot;smb3: allow controlling length of time directory entries are cached with dir leases&quot;)
    > Reviewed-by: Paulo Alcantara (Red Hat) &lt;pc@manguebit.com&gt;
    > Reviewed-by: Enzo Matsumiya &lt;ematsumiya@suse.de&gt;
    > Signed-off-by: Henrique Carvalho &lt;henrique.carvalho@suse.com&gt;
    > Signed-off-by: Steve French &lt;stfrench@microsoft.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ x86/Documentation: Update algo in init_size description of boot protocol (@Andy Shevchenko in [0c92af9ead5aae4](https://github.com/sophgo/linux-riscv/commit/0c92af9ead5aae4) at 2024-12-05 13:03:07)
    > [ Upstream commit be4ca6c53e66cb275cf0d71f32dac0c4606b9dc0 ]
    > The init_size description of boot protocol has an example of the runtime
    > start address for the compressed bzImage. For non-relocatable kernel
    > it relies on the pref_address value (if not 0), but for relocatable case
    > only pays respect to the load_addres and kernel_alignment, and it is
    > inaccurate for the latter. Boot loader must consider the pref_address
    > as the Linux kernel relocates to it before being decompressed as nicely
    > described in this commit message a year ago:
    > 43b1d3e68ee7 (&quot;kexec: Allocate kernel above bzImage&#x27;s pref_address&quot;)
    > Due to this documentation inaccuracy some of the bootloaders (*) made a
    > mistake in the calculations and if kernel image is big enough, this may
    > lead to unbootable configurations.
    > )
    > In particular, kexec-tools missed that and resently got a couple of
    > changes which will be part of v2.0.30 release. For the record,
    > commit 43b1d3e68ee7 only fixed the kernel kexec implementation and
    > also missed to update the init_size description.
    > While at it, make an example C-like looking as it&#x27;s done elsewhere in
    > the document and fix indentation as presribed by the reStructuredText
    > specifications, so the syntax highliting will work properly.
    > Fixes: 43b1d3e68ee7 (&quot;kexec: Allocate kernel above bzImage&#x27;s pref_address&quot;)
    > Fixes: d297366ba692 (&quot;x86: document new bzImage fields&quot;)
    > Signed-off-by: Andy Shevchenko &lt;andriy.shevchenko@linux.intel.com&gt;
    > Signed-off-by: Ingo Molnar &lt;mingo@kernel.org&gt;
    > Acked-by: Randy Dunlap &lt;rdunlap@infradead.org&gt;
    > Cc: &quot;H. Peter Anvin&quot; &lt;hpa@zytor.com&gt;
    > Link: https://lore.kernel.org/r/20241125105005.1616154-1-andriy.shevchenko@linux.intel.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ perf/arm-smmuv3: Fix lockdep assert in -&gt;event_init() (@Chun-Tse Shao in [a476aba86d0fb8b](https://github.com/sophgo/linux-riscv/commit/a476aba86d0fb8b) at 2024-12-05 13:03:06)
    > [ Upstream commit 02a55f2743012a8089f09f6867220c3d57f16564 ]
    > Same as
    > https://lore.kernel.org/all/20240514180050.182454-1-namhyung@kernel.org/,
    > we should skip &#x60;for_each_sibling_event()&#x60; for group leader since it
    > doesn&#x27;t have the ctx yet.
    > Fixes: f3c0eba28704 (&quot;perf: Add a few assertions&quot;)
    > Reported-by: Greg Thelen &lt;gthelen@google.com&gt;
    > Cc: Namhyung Kim &lt;namhyung@kernel.org&gt;
    > Cc: Robin Murphy &lt;robin.murphy@arm.com&gt;
    > Cc: Tuan Phan &lt;tuanphan@os.amperecomputing.com&gt;
    > Signed-off-by: Chun-Tse Shao &lt;ctshao@google.com&gt;
    > Acked-by: Will Deacon &lt;will@kernel.org&gt;
    > Link: https://lore.kernel.org/r/20241108050806.3730811-1-ctshao@google.com
    > Signed-off-by: Catalin Marinas &lt;catalin.marinas@arm.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ perf/arm-cmn: Ensure port and device id bits are set properly (@Namhyung Kim in [6e7724e319ae5f8](https://github.com/sophgo/linux-riscv/commit/6e7724e319ae5f8) at 2024-12-05 13:03:06)
    > [ Upstream commit dfdf714fed559c09021df1d2a4bb64c0ad5f53bc ]
    > The portid_bits and deviceid_bits were set only for XP type nodes in
    > the arm_cmn_discover() and it confused other nodes to find XP nodes.
    > Copy the both bits from the XP nodes directly when it sets up a new
    > node.
    > Fixes: e79634b53e39 (&quot;perf/arm-cmn: Refactor node ID handling. Again.&quot;)
    > Signed-off-by: Namhyung Kim &lt;namhyung@kernel.org&gt;
    > Acked-by: Will Deacon &lt;will@kernel.org&gt;
    > Reviewed-by: Robin Murphy &lt;robin.murphy@arm.com&gt;
    > Link: https://lore.kernel.org/r/20241121001334.331334-1-namhyung@kernel.org
    > Signed-off-by: Catalin Marinas &lt;catalin.marinas@arm.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ block: fix uaf for flush rq while iterating tags (@Yu Kuai in [61092568f2a9acb](https://github.com/sophgo/linux-riscv/commit/61092568f2a9acb) at 2024-12-05 13:03:06)
    > [ Upstream commit 3802f73bd80766d70f319658f334754164075bc3 ]
    > blk_mq_clear_flush_rq_mapping() is not called during scsi probe, by
    > checking blk_queue_init_done(). However, QUEUE_FLAG_INIT_DONE is cleared
    > in del_gendisk by commit aec89dc5d421 (&quot;block: keep q_usage_counter in
    > atomic mode after del_gendisk&quot;), hence for disk like scsi, following
    > blk_mq_destroy_queue() will not clear flush rq from tags-&gt;rqs[] as well,
    > cause following uaf that is found by our syzkaller for v6.6:
    > &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;
    > BUG: KASAN: slab-use-after-free in blk_mq_find_and_get_req+0x16e/0x1a0 block/blk-mq-tag.c:261
    > Read of size 4 at addr ffff88811c969c20 by task kworker/1:2H/224909
    > CPU: 1 PID: 224909 Comm: kworker/1:2H Not tainted 6.6.0-ga836a5060850 #32
    > Workqueue: kblockd blk_mq_timeout_work
    > Call Trace:
    > __dump_stack lib/dump_stack.c:88 [inline]
    > dump_stack_lvl+0x91/0xf0 lib/dump_stack.c:106
    > print_address_description.constprop.0+0x66/0x300 mm/kasan/report.c:364
    > print_report+0x3e/0x70 mm/kasan/report.c:475
    > kasan_report+0xb8/0xf0 mm/kasan/report.c:588
    > blk_mq_find_and_get_req+0x16e/0x1a0 block/blk-mq-tag.c:261
    > bt_iter block/blk-mq-tag.c:288 [inline]
    > __sbitmap_for_each_set include/linux/sbitmap.h:295 [inline]
    > sbitmap_for_each_set include/linux/sbitmap.h:316 [inline]
    > bt_for_each+0x455/0x790 block/blk-mq-tag.c:325
    > blk_mq_queue_tag_busy_iter+0x320/0x740 block/blk-mq-tag.c:534
    > blk_mq_timeout_work+0x1a3/0x7b0 block/blk-mq.c:1673
    > process_one_work+0x7c4/0x1450 kernel/workqueue.c:2631
    > process_scheduled_works kernel/workqueue.c:2704 [inline]
    > worker_thread+0x804/0xe40 kernel/workqueue.c:2785
    > kthread+0x346/0x450 kernel/kthread.c:388
    > ret_from_fork+0x4d/0x80 arch/x86/kernel/process.c:147
    > ret_from_fork_asm+0x1b/0x30 arch/x86/entry/entry_64.S:293
    > Allocated by task 942:
    > kasan_save_stack+0x22/0x50 mm/kasan/common.c:45
    > kasan_set_track+0x25/0x30 mm/kasan/common.c:52
    > ____kasan_kmalloc mm/kasan/common.c:374 [inline]
    > __kasan_kmalloc mm/kasan/common.c:383 [inline]
    > __kasan_kmalloc+0xaa/0xb0 mm/kasan/common.c:380
    > kasan_kmalloc include/linux/kasan.h:198 [inline]
    > __do_kmalloc_node mm/slab_common.c:1007 [inline]
    > __kmalloc_node+0x69/0x170 mm/slab_common.c:1014
    > kmalloc_node include/linux/slab.h:620 [inline]
    > kzalloc_node include/linux/slab.h:732 [inline]
    > blk_alloc_flush_queue+0x144/0x2f0 block/blk-flush.c:499
    > blk_mq_alloc_hctx+0x601/0x940 block/blk-mq.c:3788
    > blk_mq_alloc_and_init_hctx+0x27f/0x330 block/blk-mq.c:4261
    > blk_mq_realloc_hw_ctxs+0x488/0x5e0 block/blk-mq.c:4294
    > blk_mq_init_allocated_queue+0x188/0x860 block/blk-mq.c:4350
    > blk_mq_init_queue_data block/blk-mq.c:4166 [inline]
    > blk_mq_init_queue+0x8d/0x100 block/blk-mq.c:4176
    > scsi_alloc_sdev+0x843/0xd50 drivers/scsi/scsi_scan.c:335
    > scsi_probe_and_add_lun+0x77c/0xde0 drivers/scsi/scsi_scan.c:1189
    > __scsi_scan_target+0x1fc/0x5a0 drivers/scsi/scsi_scan.c:1727
    > scsi_scan_channel drivers/scsi/scsi_scan.c:1815 [inline]
    > scsi_scan_channel+0x14b/0x1e0 drivers/scsi/scsi_scan.c:1791
    > scsi_scan_host_selected+0x2fe/0x400 drivers/scsi/scsi_scan.c:1844
    > scsi_scan+0x3a0/0x3f0 drivers/scsi/scsi_sysfs.c:151
    > store_scan+0x2a/0x60 drivers/scsi/scsi_sysfs.c:191
    > dev_attr_store+0x5c/0x90 drivers/base/core.c:2388
    > sysfs_kf_write+0x11c/0x170 fs/sysfs/file.c:136
    > kernfs_fop_write_iter+0x3fc/0x610 fs/kernfs/file.c:338
    > call_write_iter include/linux/fs.h:2083 [inline]
    > new_sync_write+0x1b4/0x2d0 fs/read_write.c:493
    > vfs_write+0x76c/0xb00 fs/read_write.c:586
    > ksys_write+0x127/0x250 fs/read_write.c:639
    > do_syscall_x64 arch/x86/entry/common.c:51 [inline]
    > do_syscall_64+0x70/0x120 arch/x86/entry/common.c:81
    > entry_SYSCALL_64_after_hwframe+0x78/0xe2
    > Freed by task 244687:
    > kasan_save_stack+0x22/0x50 mm/kasan/common.c:45
    > kasan_set_track+0x25/0x30 mm/kasan/common.c:52
    > kasan_save_free_info+0x2b/0x50 mm/kasan/generic.c:522
    > ____kasan_slab_free mm/kasan/common.c:236 [inline]
    > __kasan_slab_free+0x12a/0x1b0 mm/kasan/common.c:244
    > kasan_slab_free include/linux/kasan.h:164 [inline]
    > slab_free_hook mm/slub.c:1815 [inline]
    > slab_free_freelist_hook mm/slub.c:1841 [inline]
    > slab_free mm/slub.c:3807 [inline]
    > __kmem_cache_free+0xe4/0x520 mm/slub.c:3820
    > blk_free_flush_queue+0x40/0x60 block/blk-flush.c:520
    > blk_mq_hw_sysfs_release+0x4a/0x170 block/blk-mq-sysfs.c:37
    > kobject_cleanup+0x136/0x410 lib/kobject.c:689
    > kobject_release lib/kobject.c:720 [inline]
    > kref_put include/linux/kref.h:65 [inline]
    > kobject_put+0x119/0x140 lib/kobject.c:737
    > blk_mq_release+0x24f/0x3f0 block/blk-mq.c:4144
    > blk_free_queue block/blk-core.c:298 [inline]
    > blk_put_queue+0xe2/0x180 block/blk-core.c:314
    > blkg_free_workfn+0x376/0x6e0 block/blk-cgroup.c:144
    > process_one_work+0x7c4/0x1450 kernel/workqueue.c:2631
    > process_scheduled_works kernel/workqueue.c:2704 [inline]
    > worker_thread+0x804/0xe40 kernel/workqueue.c:2785
    > kthread+0x346/0x450 kernel/kthread.c:388
    > ret_from_fork+0x4d/0x80 arch/x86/kernel/process.c:147
    > ret_from_fork_asm+0x1b/0x30 arch/x86/entry/entry_64.S:293
    > Other than blk_mq_clear_flush_rq_mapping(), the flag is only used in
    > blk_register_queue() from initialization path, hence it&#x27;s safe not to
    > clear the flag in del_gendisk. And since QUEUE_FLAG_REGISTERED already
    > make sure that queue should only be registered once, there is no need
    > to test the flag as well.
    > Fixes: 6cfeadbff3f8 (&quot;blk-mq: don&#x27;t clear flush_rq from tags-&gt;rqs[]&quot;)
    > Depends-on: commit aec89dc5d421 (&quot;block: keep q_usage_counter in atomic mode after del_gendisk&quot;)
    > Signed-off-by: Yu Kuai &lt;yukuai3@huawei.com&gt;
    > Reviewed-by: Ming Lei &lt;ming.lei@redhat.com&gt;
    > Link: https://lore.kernel.org/r/20241104110005.1412161-1-yukuai1@huaweicloud.com
    > Signed-off-by: Jens Axboe &lt;axboe@kernel.dk&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ block: return unsigned int from bdev_io_min (@Christoph Hellwig in [5e15cc7a1d9335c](https://github.com/sophgo/linux-riscv/commit/5e15cc7a1d9335c) at 2024-12-05 13:03:06)
    > [ Upstream commit 46fd48ab3ea3eb3bb215684bd66ea3d260b091a9 ]
    > The underlying limit is defined as an unsigned int, so return that from
    > bdev_io_min as well.
    > Fixes: ac481c20ef8f (&quot;block: Topology ioctls&quot;)
    > Signed-off-by: Christoph Hellwig &lt;hch@lst.de&gt;
    > Reviewed-by: Martin K. Petersen &lt;martin.petersen@oracle.com&gt;
    > Reviewed-by: John Garry &lt;john.g.garry@oracle.com&gt;
    > Link: https://lore.kernel.org/r/20241119072602.1059488-1-hch@lst.de
    > Signed-off-by: Jens Axboe &lt;axboe@kernel.dk&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ 9p/xen: fix init sequence (@Alex Zenla in [592fb738d8682bb](https://github.com/sophgo/linux-riscv/commit/592fb738d8682bb) at 2024-12-05 13:03:06)
    > [ Upstream commit 7ef3ae82a6ebbf4750967d1ce43bcdb7e44ff74b ]
    > Large amount of mount hangs observed during hotplugging of 9pfs devices. The
    > 9pfs Xen driver attempts to initialize itself more than once, causing the
    > frontend and backend to disagree: the backend listens on a channel that the
    > frontend does not send on, resulting in stalled processing.
    > Only allow initialization of 9p frontend once.
    > Fixes: c15fe55d14b3b (&quot;9p/xen: fix connection sequence&quot;)
    > Signed-off-by: Alex Zenla &lt;alex@edera.dev&gt;
    > Signed-off-by: Alexander Merritt &lt;alexander@edera.dev&gt;
    > Signed-off-by: Ariadne Conill &lt;ariadne@ariadne.space&gt;
    > Reviewed-by: Juergen Gross &lt;jgross@suse.com&gt;
    > Message-ID: &lt;20241119211633.38321-1-alexander@edera.dev&gt;
    > Signed-off-by: Dominique Martinet &lt;asmadeus@codewreck.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ nvme-fabrics: fix kernel crash while shutting down controller (@Nilay Shroff in [5416b76a8156c1b](https://github.com/sophgo/linux-riscv/commit/5416b76a8156c1b) at 2024-12-05 13:03:06)
    > [ Upstream commit e9869c85c81168a1275f909d5972a3fc435304be ]
    > The nvme keep-alive operation, which executes at a periodic interval,
    > could potentially sneak in while shutting down a fabric controller.
    > This may lead to a race between the fabric controller admin queue
    > destroy code path (invoked while shutting down controller) and hw/hctx
    > queue dispatcher called from the nvme keep-alive async request queuing
    > operation. This race could lead to the kernel crash shown below:
    > Call Trace:
    > autoremove_wake_function+0x0/0xbc (unreliable)
    > __blk_mq_sched_dispatch_requests+0x114/0x24c
    > blk_mq_sched_dispatch_requests+0x44/0x84
    > blk_mq_run_hw_queue+0x140/0x220
    > nvme_keep_alive_work+0xc8/0x19c [nvme_core]
    > process_one_work+0x200/0x4e0
    > worker_thread+0x340/0x504
    > kthread+0x138/0x140
    > start_kernel_thread+0x14/0x18
    > While shutting down fabric controller, if nvme keep-alive request sneaks
    > in then it would be flushed off. The nvme_keep_alive_end_io function is
    > then invoked to handle the end of the keep-alive operation which
    > decrements the admin-&gt;q_usage_counter and assuming this is the last/only
    > request in the admin queue then the admin-&gt;q_usage_counter becomes zero.
    > If that happens then blk-mq destroy queue operation (blk_mq_destroy_
    > queue()) which could be potentially running simultaneously on another
    > cpu (as this is the controller shutdown code path) would forward
    > progress and deletes the admin queue. So, now from this point onward
    > we are not supposed to access the admin queue resources. However the
    > issue here&#x27;s that the nvme keep-alive thread running hw/hctx queue
    > dispatch operation hasn&#x27;t yet finished its work and so it could still
    > potentially access the admin queue resource while the admin queue had
    > been already deleted and that causes the above crash.
    > The above kernel crash is regression caused due to changes implemented
    > in commit a54a93d0e359 (&quot;nvme: move stopping keep-alive into
    > nvme_uninit_ctrl()&quot;). Ideally we should stop keep-alive before destroyin
    > g the admin queue and freeing the admin tagset so that it wouldn&#x27;t sneak
    > in during the shutdown operation. However we removed the keep alive stop
    > operation from the beginning of the controller shutdown code path in commit
    > a54a93d0e359 (&quot;nvme: move stopping keep-alive into nvme_uninit_ctrl()&quot;)
    > and added it under nvme_uninit_ctrl() which executes very late in the
    > shutdown code path after the admin queue is destroyed and its tagset is
    > removed. So this change created the possibility of keep-alive sneaking in
    > and interfering with the shutdown operation and causing observed kernel
    > crash.
    > To fix the observed crash, we decided to move nvme_stop_keep_alive() from
    > nvme_uninit_ctrl() to nvme_remove_admin_tag_set(). This change would ensure
    > that we don&#x27;t forward progress and delete the admin queue until the keep-
    > alive operation is finished (if it&#x27;s in-flight) or cancelled and that would
    > help contain the race condition explained above and hence avoid the crash.
    > Moving nvme_stop_keep_alive() to nvme_remove_admin_tag_set() instead of
    > adding nvme_stop_keep_alive() to the beginning of the controller shutdown
    > code path in nvme_stop_ctrl(), as was the case earlier before commit
    > a54a93d0e359 (&quot;nvme: move stopping keep-alive into nvme_uninit_ctrl()&quot;),
    > would help save one callsite of nvme_stop_keep_alive().
    > Fixes: a54a93d0e359 (&quot;nvme: move stopping keep-alive into nvme_uninit_ctrl()&quot;)
    > Link: https://lore.kernel.org/all/1a21f37b-0f2a-4745-8c56-4dc8628d3983@linux.ibm.com/
    > Reviewed-by: Ming Lei &lt;ming.lei@redhat.com&gt;
    > Signed-off-by: Nilay Shroff &lt;nilay@linux.ibm.com&gt;
    > Signed-off-by: Keith Busch &lt;kbusch@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ 9p/xen: fix release of IRQ (@Alex Zenla in [530bc9f03a102fa](https://github.com/sophgo/linux-riscv/commit/530bc9f03a102fa) at 2024-12-05 13:03:06)
    > [ Upstream commit e43c608f40c065b30964f0a806348062991b802d ]
    > Kernel logs indicate an IRQ was double-freed.
    > Pass correct device ID during IRQ release.
    > Fixes: 71ebd71921e45 (&quot;xen/9pfs: connect to the backend&quot;)
    > Signed-off-by: Alex Zenla &lt;alex@edera.dev&gt;
    > Signed-off-by: Alexander Merritt &lt;alexander@edera.dev&gt;
    > Signed-off-by: Ariadne Conill &lt;ariadne@ariadne.space&gt;
    > Reviewed-by: Juergen Gross &lt;jgross@suse.com&gt;
    > Message-ID: &lt;20241121225100.5736-1-alexander@edera.dev&gt;
    > [Dominique: remove confusing variable reset to 0]
    > Signed-off-by: Dominique Martinet &lt;asmadeus@codewreck.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ rtc: rzn1: fix BCD to rtc_time conversion errors (@Wolfram Sang in [c5b75986dbae69f](https://github.com/sophgo/linux-riscv/commit/c5b75986dbae69f) at 2024-12-05 13:03:05)
    > [ Upstream commit 55727188dfa3572aecd946e58fab9e4a64f06894 ]
    > tm_mon describes months from 0 to 11, but the register contains BCD from
    > 1 to 12. tm_year contains years since 1900, but the BCD contains 20XX.
    > Apply the offsets when converting these numbers.
    > Fixes: deeb4b5393e1 (&quot;rtc: rzn1: Add new RTC driver&quot;)
    > Signed-off-by: Wolfram Sang &lt;wsa+renesas@sang-engineering.com&gt;
    > Reviewed-by: Miquel Raynal &lt;miquel.raynal@bootlin.com&gt;
    > Link: https://lore.kernel.org/r/20241113113032.27409-1-wsa+renesas@sang-engineering.com
    > Signed-off-by: Alexandre Belloni &lt;alexandre.belloni@bootlin.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ block: model freeze &amp; enter queue as lock for supporting lockdep (@Ming Lei in [a6fc2ba1c7e57cc](https://github.com/sophgo/linux-riscv/commit/a6fc2ba1c7e57cc) at 2024-12-05 13:03:05)
    > [ Upstream commit f1be1788a32e8fa63416ad4518bbd1a85a825c9d ]
    > Recently we got several deadlock report[1][2][3] caused by
    > blk_mq_freeze_queue and blk_enter_queue().
    > Turns out the two are just like acquiring read/write lock, so model them
    > as read/write lock for supporting lockdep:
    > 1) model q-&gt;q_usage_counter as two locks(io and queue lock)
    > - queue lock covers sync with blk_enter_queue()
    > - io lock covers sync with bio_enter_queue()
    > 2) make the lockdep class/key as per-queue:
    > - different subsystem has very different lock use pattern, shared lock
    > class causes false positive easily
    > - freeze_queue degrades to no lock in case that disk state becomes DEAD
    > because bio_enter_queue() won&#x27;t be blocked any more
    > - freeze_queue degrades to no lock in case that request queue becomes dying
    > because blk_enter_queue() won&#x27;t be blocked any more
    > 3) model blk_mq_freeze_queue() as acquire_exclusive &amp; try_lock
    > - it is exclusive lock, so dependency with blk_enter_queue() is covered
    > - it is trylock because blk_mq_freeze_queue() are allowed to run
    > concurrently
    > 4) model blk_enter_queue() &amp; bio_enter_queue() as acquire_read()
    > - nested blk_enter_queue() are allowed
    > - dependency with blk_mq_freeze_queue() is covered
    > - blk_queue_exit() is often called from other contexts(such as irq), and
    > it can&#x27;t be annotated as lock_release(), so simply do it in
    > blk_enter_queue(), this way still covered cases as many as possible
    > With lockdep support, such kind of reports may be reported asap and
    > needn&#x27;t wait until the real deadlock is triggered.
    > For example, lockdep report can be triggered in the report[3] with this
    > patch applied.
    > [1] occasional block layer hang when setting &#x27;echo noop &gt; /sys/block/sda/queue/scheduler&#x27;
    > https://bugzilla.kernel.org/show_bug.cgi?id&#x3D;219166
    > [2] del_gendisk() vs blk_queue_enter() race condition
    > https://lore.kernel.org/linux-block/20241003085610.GK11458@google.com/
    > [3] queue_freeze &amp; queue_enter deadlock in scsi
    > https://lore.kernel.org/linux-block/ZxG38G9BuFdBpBHZ@fedora/T/#u
    > Reviewed-by: Christoph Hellwig &lt;hch@lst.de&gt;
    > Signed-off-by: Ming Lei &lt;ming.lei@redhat.com&gt;
    > Link: https://lore.kernel.org/r/20241025003722.3630252-4-ming.lei@redhat.com
    > Signed-off-by: Jens Axboe &lt;axboe@kernel.dk&gt;
    > Stable-dep-of: 3802f73bd807 (&quot;block: fix uaf for flush rq while iterating tags&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ blk-mq: add non_owner variant of start_freeze/unfreeze queue APIs (@Ming Lei in [9c3d53f113426d2](https://github.com/sophgo/linux-riscv/commit/9c3d53f113426d2) at 2024-12-05 13:03:05)
    > [ Upstream commit 8acdd0e7bfadda6b5103f2960d293581954454ed ]
    > Add non_owner variant of start_freeze/unfreeze queue APIs, so that the
    > caller knows that what they are doing, and we can skip lockdep support
    > for non_owner variant in per-call level.
    > Prepare for supporting lockdep for freezing/unfreezing queue.
    > Reviewed-by: Christoph Hellwig &lt;hch@lst.de&gt;
    > Suggested-by: Christoph Hellwig &lt;hch@lst.de&gt;
    > Signed-off-by: Ming Lei &lt;ming.lei@redhat.com&gt;
    > Link: https://lore.kernel.org/r/20241025003722.3630252-2-ming.lei@redhat.com
    > Signed-off-by: Jens Axboe &lt;axboe@kernel.dk&gt;
    > Stable-dep-of: 3802f73bd807 (&quot;block: fix uaf for flush rq while iterating tags&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ Revert &quot;nfs: don&#x27;t reuse partially completed requests in nfs_lock_and_join_requests&quot; (@Trond Myklebust in [8f95ffb8f86e79e](https://github.com/sophgo/linux-riscv/commit/8f95ffb8f86e79e) at 2024-12-05 13:03:05)
    > [ Upstream commit 66f9dac9077c9c063552e465212abeb8f97d28a7 ]
    > This reverts commit b571cfcb9dcac187c6d967987792d37cb0688610.
    > This patch appears to assume that if one request is complete, then the
    > others will complete too before unlocking. That is not a valid
    > assumption, since other requests could hit a non-fatal error or a short
    > write that would cause them not to complete.
    > Reported-by: Igor Raits &lt;igor@gooddata.com&gt;
    > Link: https://bugzilla.kernel.org/show_bug.cgi?id&#x3D;219508
    > Fixes: b571cfcb9dca (&quot;nfs: don&#x27;t reuse partially completed requests in nfs_lock_and_join_requests&quot;)
    > Signed-off-by: Trond Myklebust &lt;trond.myklebust@hammerspace.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ nvme/multipath: Fix RCU list traversal to use SRCU primitive (@Breno Leitao in [4eaa19c6205c370](https://github.com/sophgo/linux-riscv/commit/4eaa19c6205c370) at 2024-12-05 13:03:05)
    > [ Upstream commit 5dd18f09ce7399df6fffe80d1598add46c395ae9 ]
    > The code currently uses list_for_each_entry_rcu() while holding an SRCU
    > lock, triggering false positive warnings with CONFIG_PROVE_RCU&#x3D;y
    > enabled:
    > drivers/nvme/host/multipath.c:168 RCU-list traversed in non-reader section!!
    > drivers/nvme/host/multipath.c:227 RCU-list traversed in non-reader section!!
    > drivers/nvme/host/multipath.c:260 RCU-list traversed in non-reader section!!
    > While the list is properly protected by SRCU lock, the code uses the
    > wrong list traversal primitive. Replace list_for_each_entry_rcu() with
    > list_for_each_entry_srcu() to correctly indicate SRCU-based protection
    > and eliminate the false warning.
    > Signed-off-by: Breno Leitao &lt;leitao@debian.org&gt;
    > Fixes: be647e2c76b2 (&quot;nvme: use srcu for iterating namespace list&quot;)
    > Signed-off-by: Keith Busch &lt;kbusch@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ net/9p/usbg: fix handling of the failed kzalloc() memory allocation (@Mirsad Todorovac in [2cdb416de8b5795](https://github.com/sophgo/linux-riscv/commit/2cdb416de8b5795) at 2024-12-05 13:03:05)
    > [ Upstream commit ff1060813d9347e8c45c8b8cff93a4dfdb6726ad ]
    > On the linux-next, next-20241108 vanilla kernel, the coccinelle tool gave the
    > following error report:
    > ./net/9p/trans_usbg.c:912:5-11: ERROR: allocation function on line 911 returns
    > NULL not ERR_PTR on failure
    > kzalloc() failure is fixed to handle the NULL return case on the memory exhaustion.
    > Fixes: a3be076dc174d (&quot;net/9p/usbg: Add new usb gadget function transport&quot;)
    > Cc: Michael Grzeschik &lt;m.grzeschik@pengutronix.de&gt;
    > Cc: Eric Van Hensbergen &lt;ericvh@kernel.org&gt;
    > Cc: Latchesar Ionkov &lt;lucho@ionkov.net&gt;
    > Cc: Dominique Martinet &lt;asmadeus@codewreck.org&gt;
    > Cc: Christian Schoenebeck &lt;linux_oss@crudebyte.com&gt;
    > Cc: v9fs@lists.linux.dev
    > Cc: linux-kernel@vger.kernel.org
    > Signed-off-by: Mirsad Todorovac &lt;mtodorovac69@gmail.com&gt;
    > Message-ID: &lt;20241109211840.721226-2-mtodorovac69@gmail.com&gt;
    > Signed-off-by: Dominique Martinet &lt;asmadeus@codewreck.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ jffs2: fix use of uninitialized variable (@Qingfang Deng in [fb014a3284c43f5](https://github.com/sophgo/linux-riscv/commit/fb014a3284c43f5) at 2024-12-05 13:03:04)
    > [ Upstream commit 3ba44ee966bc3c41dd8a944f963466c8fcc60dc8 ]
    > When building the kernel with -Wmaybe-uninitialized, the compiler
    > reports this warning:
    > In function &#x27;jffs2_mark_erased_block&#x27;,
    > inlined from &#x27;jffs2_erase_pending_blocks&#x27; at fs/jffs2/erase.c:116:4:
    > fs/jffs2/erase.c:474:9: warning: &#x27;bad_offset&#x27; may be used uninitialized [-Wmaybe-uninitialized]
    > 474 |         jffs2_erase_failed(c, jeb, bad_offset);
    > |         ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    > fs/jffs2/erase.c: In function &#x27;jffs2_erase_pending_blocks&#x27;:
    > fs/jffs2/erase.c:402:18: note: &#x27;bad_offset&#x27; was declared here
    > 402 |         uint32_t bad_offset;
    > |                  ^~~~~~~~~~
    > When mtd-&gt;point() is used, jffs2_erase_pending_blocks can return -EIO
    > without initializing bad_offset, which is later used at the filebad
    > label in jffs2_mark_erased_block.
    > Fix it by initializing this variable.
    > Fixes: 8a0f572397ca (&quot;[JFFS2] Return values of jffs2_block_check_erase error paths&quot;)
    > Signed-off-by: Qingfang Deng &lt;qingfang.deng@siflower.com.cn&gt;
    > Reviewed-by: Zhihao Cheng &lt;chengzhihao1@huawei.com&gt;
    > Signed-off-by: Richard Weinberger &lt;richard@nod.at&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ hostfs: Fix the NULL vs IS_ERR() bug for __filemap_get_folio() (@ZhangPeng in [f888356886be469](https://github.com/sophgo/linux-riscv/commit/f888356886be469) at 2024-12-05 13:03:04)
    > [ Upstream commit bed2cc482600296fe04edbc38005ba2851449c10 ]
    > The __filemap_get_folio() function returns error pointers.
    > It never returns NULL. So use IS_ERR() to check it.
    > Fixes: 1da86618bdce (&quot;fs: Convert aops-&gt;write_begin to take a folio&quot;)
    > Signed-off-by: ZhangPeng &lt;zhangpeng362@huawei.com&gt;
    > Acked-by: Johannes Berg &lt;johannes@sipsolutions.net&gt;
    > Signed-off-by: Richard Weinberger &lt;richard@nod.at&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ rtc: check if __rtc_read_time was successful in rtc_timer_do_work() (@Yongliang Gao in [e77bce0a8c3989b](https://github.com/sophgo/linux-riscv/commit/e77bce0a8c3989b) at 2024-12-05 13:03:04)
    > [ Upstream commit e8ba8a2bc4f60a1065f23d6a0e7cbea945a0f40d ]
    > If the __rtc_read_time call fails,, the struct rtc_time tm; may contain
    > uninitialized data, or an illegal date/time read from the RTC hardware.
    > When calling rtc_tm_to_ktime later, the result may be a very large value
    > (possibly KTIME_MAX). If there are periodic timers in rtc-&gt;timerqueue,
    > they will continually expire, may causing kernel softlockup.
    > Fixes: 6610e0893b8b (&quot;RTC: Rework RTC code to use timerqueue for events&quot;)
    > Signed-off-by: Yongliang Gao &lt;leonylgao@tencent.com&gt;
    > Acked-by: Jingqun Li &lt;jingqunli@tencent.com&gt;
    > Link: https://lore.kernel.org/r/20241011043153.3788112-1-leonylgao@gmail.com
    > Signed-off-by: Alexandre Belloni &lt;alexandre.belloni@bootlin.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ubifs: Correct the total block count by deducting journal reservation (@Zhihao Cheng in [7f0b3524a6c26cc](https://github.com/sophgo/linux-riscv/commit/7f0b3524a6c26cc) at 2024-12-05 13:03:04)
    > [ Upstream commit 84a2bee9c49769310efa19601157ef50a1df1267 ]
    > Since commit e874dcde1cbf (&quot;ubifs: Reserve one leb for each journal
    > head while doing budget&quot;), available space is calulated by deducting
    > reservation for all journal heads. However, the total block count (
    > which is only used by statfs) is not updated yet, which will cause
    > the wrong displaying for used space(total - available).
    > Fix it by deducting reservation for all journal heads from total
    > block count.
    > Fixes: e874dcde1cbf (&quot;ubifs: Reserve one leb for each journal head while doing budget&quot;)
    > Signed-off-by: Zhihao Cheng &lt;chengzhihao1@huawei.com&gt;
    > Signed-off-by: Richard Weinberger &lt;richard@nod.at&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ubi: fastmap: Fix duplicate slab cache names while attaching (@Zhihao Cheng in [7402c4bcb8a3f0d](https://github.com/sophgo/linux-riscv/commit/7402c4bcb8a3f0d) at 2024-12-05 13:03:04)
    > [ Upstream commit bcddf52b7a17adcebc768d26f4e27cf79adb424c ]
    > Since commit 4c39529663b9 (&quot;slab: Warn on duplicate cache names when
    > DEBUG_VM&#x3D;y&quot;), the duplicate slab cache names can be detected and a
    > kernel WARNING is thrown out.
    > In UBI fast attaching process, alloc_ai() could be invoked twice
    > with the same slab cache name &#x27;ubi_aeb_slab_cache&#x27;, which will trigger
    > following warning messages:
    > kmem_cache of name &#x27;ubi_aeb_slab_cache&#x27; already exists
    > WARNING: CPU: 0 PID: 7519 at mm/slab_common.c:107
    > __kmem_cache_create_args+0x100/0x5f0
    > Modules linked in: ubi(+) nandsim [last unloaded: nandsim]
    > CPU: 0 UID: 0 PID: 7519 Comm: modprobe Tainted: G 6.12.0-rc2
    > RIP: 0010:__kmem_cache_create_args+0x100/0x5f0
    > Call Trace:
    > __kmem_cache_create_args+0x100/0x5f0
    > alloc_ai+0x295/0x3f0 [ubi]
    > ubi_attach+0x3c3/0xcc0 [ubi]
    > ubi_attach_mtd_dev+0x17cf/0x3fa0 [ubi]
    > ubi_init+0x3fb/0x800 [ubi]
    > do_init_module+0x265/0x7d0
    > __x64_sys_finit_module+0x7a/0xc0
    > The problem could be easily reproduced by loading UBI device by fastmap
    > with CONFIG_DEBUG_VM&#x3D;y.
    > Fix it by using different slab names for alloc_ai() callers.
    > Fixes: d2158f69a7d4 (&quot;UBI: Remove alloc_ai() slab name from parameter list&quot;)
    > Fixes: fdf10ed710c0 (&quot;ubi: Rework Fastmap attach base code&quot;)
    > Signed-off-by: Zhihao Cheng &lt;chengzhihao1@huawei.com&gt;
    > Signed-off-by: Richard Weinberger &lt;richard@nod.at&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ubi: fastmap: wl: Schedule fm_work if wear-leveling pool is empty (@Zhihao Cheng in [366fda649f1a105](https://github.com/sophgo/linux-riscv/commit/366fda649f1a105) at 2024-12-05 13:03:04)
    > [ Upstream commit c4595fe394a289927077e3da561db27811919ee0 ]
    > Since commit 14072ee33d5a (&quot;ubi: fastmap: Check wl_pool for free peb
    > before wear leveling&quot;), wear_leveling_worker() won&#x27;t schedule fm_work
    > if wear-leveling pool is empty, which could temporarily disable the
    > wear-leveling until the fastmap is updated(eg. pool becomes empty).
    > Fix it by scheduling fm_work if wl_pool is empty during wear-leveing.
    > Fixes: 14072ee33d5a (&quot;ubi: fastmap: Check wl_pool for free peb before wear leveling&quot;)
    > Signed-off-by: Zhihao Cheng &lt;chengzhihao1@huawei.com&gt;
    > Signed-off-by: Richard Weinberger &lt;richard@nod.at&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ubifs: authentication: Fix use-after-free in ubifs_tnc_end_commit (@Waqar Hameed in [2497479aecebe86](https://github.com/sophgo/linux-riscv/commit/2497479aecebe86) at 2024-12-05 13:03:04)
    > [ Upstream commit 4617fb8fc15effe8eda4dd898d4e33eb537a7140 ]
    > After an insertion in TNC, the tree might split and cause a node to
    > change its &#x60;znode-&gt;parent&#x60;. A further deletion of other nodes in the
    > tree (which also could free the nodes), the aforementioned node&#x27;s
    > &#x60;znode-&gt;cparent&#x60; could still point to a freed node. This
    > &#x60;znode-&gt;cparent&#x60; may not be updated when getting nodes to commit in
    > &#x60;ubifs_tnc_start_commit()&#x60;. This could then trigger a use-after-free
    > when accessing the &#x60;znode-&gt;cparent&#x60; in &#x60;write_index()&#x60; in
    > &#x60;ubifs_tnc_end_commit()&#x60;.
    > This can be triggered by running
    > rm -f /etc/test-file.bin
    > dd if&#x3D;/dev/urandom of&#x3D;/etc/test-file.bin bs&#x3D;1M count&#x3D;60 conv&#x3D;fsync
    > in a loop, and with &#x60;CONFIG_UBIFS_FS_AUTHENTICATION&#x60;. KASAN then
    > reports:
    > BUG: KASAN: use-after-free in ubifs_tnc_end_commit+0xa5c/0x1950
    > Write of size 32 at addr ffffff800a3af86c by task ubifs_bgt0_20/153
    > Call trace:
    > dump_backtrace+0x0/0x340
    > show_stack+0x18/0x24
    > dump_stack_lvl+0x9c/0xbc
    > print_address_description.constprop.0+0x74/0x2b0
    > kasan_report+0x1d8/0x1f0
    > kasan_check_range+0xf8/0x1a0
    > memcpy+0x84/0xf4
    > ubifs_tnc_end_commit+0xa5c/0x1950
    > do_commit+0x4e0/0x1340
    > ubifs_bg_thread+0x234/0x2e0
    > kthread+0x36c/0x410
    > ret_from_fork+0x10/0x20
    > Allocated by task 401:
    > kasan_save_stack+0x38/0x70
    > __kasan_kmalloc+0x8c/0xd0
    > __kmalloc+0x34c/0x5bc
    > tnc_insert+0x140/0x16a4
    > ubifs_tnc_add+0x370/0x52c
    > ubifs_jnl_write_data+0x5d8/0x870
    > do_writepage+0x36c/0x510
    > ubifs_writepage+0x190/0x4dc
    > __writepage+0x58/0x154
    > write_cache_pages+0x394/0x830
    > do_writepages+0x1f0/0x5b0
    > filemap_fdatawrite_wbc+0x170/0x25c
    > file_write_and_wait_range+0x140/0x190
    > ubifs_fsync+0xe8/0x290
    > vfs_fsync_range+0xc0/0x1e4
    > do_fsync+0x40/0x90
    > __arm64_sys_fsync+0x34/0x50
    > invoke_syscall.constprop.0+0xa8/0x260
    > do_el0_svc+0xc8/0x1f0
    > el0_svc+0x34/0x70
    > el0t_64_sync_handler+0x108/0x114
    > el0t_64_sync+0x1a4/0x1a8
    > Freed by task 403:
    > kasan_save_stack+0x38/0x70
    > kasan_set_track+0x28/0x40
    > kasan_set_free_info+0x28/0x4c
    > __kasan_slab_free+0xd4/0x13c
    > kfree+0xc4/0x3a0
    > tnc_delete+0x3f4/0xe40
    > ubifs_tnc_remove_range+0x368/0x73c
    > ubifs_tnc_remove_ino+0x29c/0x2e0
    > ubifs_jnl_delete_inode+0x150/0x260
    > ubifs_evict_inode+0x1d4/0x2e4
    > evict+0x1c8/0x450
    > iput+0x2a0/0x3c4
    > do_unlinkat+0x2cc/0x490
    > __arm64_sys_unlinkat+0x90/0x100
    > invoke_syscall.constprop.0+0xa8/0x260
    > do_el0_svc+0xc8/0x1f0
    > el0_svc+0x34/0x70
    > el0t_64_sync_handler+0x108/0x114
    > el0t_64_sync+0x1a4/0x1a8
    > The offending &#x60;memcpy()&#x60; in &#x60;ubifs_copy_hash()&#x60; has a use-after-free
    > when a node becomes root in TNC but still has a &#x60;cparent&#x60; to an already
    > freed node. More specifically, consider the following TNC:
    > zroot
    > /
    > /
    > zp1
    > /
    > /
    > zn
    > Inserting a new node &#x60;zn_new&#x60; with a key smaller then &#x60;zn&#x60; will trigger
    > a split in &#x60;tnc_insert()&#x60; if &#x60;zp1&#x60; is full:
    > zroot
    > /   \
    > /     \
    > zp1     zp2
    > /         \
    > /           \
    > zn_new          zn
    > &#x60;zn-&gt;parent&#x60; has now been moved to &#x60;zp2&#x60;, *but* &#x60;zn-&gt;cparent&#x60; still
    > points to &#x60;zp1&#x60;.
    > Now, consider a removal of all the nodes _except_ &#x60;zn&#x60;. Just when
    > &#x60;tnc_delete()&#x60; is about to delete &#x60;zroot&#x60; and &#x60;zp2&#x60;:
    > zroot
    > \
    > \
    > zp2
    > \
    > \
    > zn
    > &#x60;zroot&#x60; and &#x60;zp2&#x60; get freed and the tree collapses:
    > zn
    > &#x60;zn&#x60; now becomes the new &#x60;zroot&#x60;.
    > &#x60;get_znodes_to_commit()&#x60; will now only find &#x60;zn&#x60;, the new &#x60;zroot&#x60;, and
    > &#x60;write_index()&#x60; will check its &#x60;znode-&gt;cparent&#x60; that wrongly points to
    > the already freed &#x60;zp1&#x60;. &#x60;ubifs_copy_hash()&#x60; thus gets wrongly called
    > with &#x60;znode-&gt;cparent-&gt;zbranch[znode-&gt;iip].hash&#x60; that triggers the
    > use-after-free!
    > Fix this by explicitly setting &#x60;znode-&gt;cparent&#x60; to &#x60;NULL&#x60; in
    > &#x60;get_znodes_to_commit()&#x60; for the root node. The search for the dirty
    > nodes is bottom-up in the tree. Thus, when &#x60;find_next_dirty(znode)&#x60;
    > returns NULL, the current &#x60;znode&#x60; _is_ the root node. Add an assert for
    > this.
    > Fixes: 16a26b20d2af (&quot;ubifs: authentication: Add hashes to index nodes&quot;)
    > Tested-by: Waqar Hameed &lt;waqar.hameed@axis.com&gt;
    > Co-developed-by: Zhihao Cheng &lt;chengzhihao1@huawei.com&gt;
    > Signed-off-by: Zhihao Cheng &lt;chengzhihao1@huawei.com&gt;
    > Signed-off-by: Waqar Hameed &lt;waqar.hameed@axis.com&gt;
    > Reviewed-by: Zhihao Cheng &lt;chengzhihao1@huawei.com&gt;
    > Signed-off-by: Richard Weinberger &lt;richard@nod.at&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ um: ubd: Initialize ubd&#x27;s disk pointer in ubd_add (@Tiwei Bie in [f5e01fe96c0f75c](https://github.com/sophgo/linux-riscv/commit/f5e01fe96c0f75c) at 2024-12-05 13:03:03)
    > [ Upstream commit df700802abcac3c7c4a4ced099aa42b9a144eea8 ]
    > Currently, the initialization of the disk pointer in the ubd structure
    > is missing. It should be initialized with the allocated gendisk pointer
    > in ubd_add().
    > Fixes: 32621ad7a7ea (&quot;ubd: remove the ubd_gendisk array&quot;)
    > Signed-off-by: Tiwei Bie &lt;tiwei.btw@antgroup.com&gt;
    > Acked-By: Anton Ivanov &lt;anton.ivanov@cambridgegreys.com&gt;
    > Link: https://patch.msgid.link/20241104163203.435515-2-tiwei.btw@antgroup.com
    > Signed-off-by: Johannes Berg &lt;johannes.berg@intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ um: Always dump trace for specified task in show_stack (@Tiwei Bie in [f1ed1fbad9a841d](https://github.com/sophgo/linux-riscv/commit/f1ed1fbad9a841d) at 2024-12-05 13:03:03)
    > [ Upstream commit 0f659ff362eac69777c4c191b7e5ccb19d76c67d ]
    > Currently, show_stack() always dumps the trace of the current task.
    > However, it should dump the trace of the specified task if one is
    > provided. Otherwise, things like running &quot;echo t &gt; sysrq-trigger&quot;
    > won&#x27;t work as expected.
    > Fixes: 970e51feaddb (&quot;um: Add support for CONFIG_STACKTRACE&quot;)
    > Signed-off-by: Tiwei Bie &lt;tiwei.btw@antgroup.com&gt;
    > Link: https://patch.msgid.link/20241106103933.1132365-1-tiwei.btw@antgroup.com
    > Signed-off-by: Johannes Berg &lt;johannes.berg@intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ kfifo: don&#x27;t include dma-mapping.h in kfifo.h (@Christoph Hellwig in [e64d571d183e69a](https://github.com/sophgo/linux-riscv/commit/e64d571d183e69a) at 2024-12-05 13:03:03)
    > [ Upstream commit 44059790a5cb9258ae6137387e4c39b717fd2ced ]
    > Nothing in kfifo.h directly needs dma-mapping.h, only two macros
    > use DMA_MAPPING_ERROR when actually instantiated.  Drop the
    > dma-mapping.h include to reduce include bloat.
    > Add an explicity &lt;linux/io.h&gt; include to drivers/mailbox/omap-mailbox.c
    > as that file uses __raw_readl and __raw_writel through a complicated
    > include chain involving &lt;linux/dma-mapping.h&gt;
    > Fixes: d52b761e4b1a (&quot;kfifo: add kfifo_dma_out_prepare_mapped()&quot;)
    > Signed-off-by: Christoph Hellwig &lt;hch@lst.de&gt;
    > Link: https://lore.kernel.org/r/20241023055317.313234-1-hch@lst.de
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ nfs/localio: must clear res.replen in nfs_local_read_done (@NeilBrown in [de5dac261eeab99](https://github.com/sophgo/linux-riscv/commit/de5dac261eeab99) at 2024-12-05 13:03:03)
    > [ Upstream commit 650703bc4ed3edf841e851c99ab8e7ba9e5262a3 ]
    > Otherwise memory corruption can occur due to NFSv3 LOCALIO reads
    > leaving garbage in res.replen:
    > - nfs3_read_done() copies that into server-&gt;read_hdrsize; from there
    > nfs3_proc_read_setup() copies it to args.replen in new requests.
    > - nfs3_xdr_enc_read3args() passes that to rpc_prepare_reply_pages()
    > which includes it in hdrsize for xdr_init_pages, so that rq_rcv_buf
    > contains a ridiculous len.
    > - This is copied to rq_private_buf and xs_read_stream_request()
    > eventually passes the kvec to sock_recvmsg() which receives incoming
    > data into entirely the wrong place.
    > This is easily reproduced with NFSv3 LOCALIO that is servicing reads
    > when it is made to pivot back to using normal RPC.  This switch back
    > to using normal NFSv3 with RPC can occur for a few reasons but this
    > issue was exposed with a test that stops and then restarts the NFSv3
    > server while LOCALIO is performing heavy read IO.
    > Fixes: 70ba381e1a43 (&quot;nfs: add LOCALIO support&quot;)
    > Reported-by: Mike Snitzer &lt;snitzer@kernel.org&gt;
    > Signed-off-by: NeilBrown &lt;neilb@suse.de&gt;
    > Co-developed-by: Mike Snitzer &lt;snitzer@kernel.org&gt;
    > Signed-off-by: Mike Snitzer &lt;snitzer@kernel.org&gt;
    > Signed-off-by: Trond Myklebust &lt;trond.myklebust@hammerspace.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ rtc: abx80x: Fix WDT bit position of the status register (@Nobuhiro Iwamatsu in [c9b411df55f102a](https://github.com/sophgo/linux-riscv/commit/c9b411df55f102a) at 2024-12-05 13:03:03)
    > [ Upstream commit 10e078b273ee7a2b8b4f05a64ac458f5e652d18d ]
    > The WDT bit in the status register is 5, not 6. This fixes from 6 to 5.
    > Link: https://abracon.com/Support/AppsManuals/Precisiontiming/AB08XX-Application-Manual.pdf
    > Link: https://www.microcrystal.com/fileadmin/Media/Products/RTC/App.Manual/RV-1805-C3_App-Manual.pdf
    > Fixes: 749e36d0a0d7 (&quot;rtc: abx80x: add basic watchdog support&quot;)
    > Cc: Jeremy Gebben &lt;jgebben@sweptlaser.com&gt;
    > Signed-off-by: Nobuhiro Iwamatsu &lt;iwamatsu@nigauri.org&gt;
    > Link: https://lore.kernel.org/r/20241008041737.1640633-1-iwamatsu@nigauri.org
    > Signed-off-by: Alexandre Belloni &lt;alexandre.belloni@bootlin.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ NFSv4.0: Fix a use-after-free problem in the asynchronous open() (@Trond Myklebust in [b56ae8e715557b4](https://github.com/sophgo/linux-riscv/commit/b56ae8e715557b4) at 2024-12-05 13:03:03)
    > [ Upstream commit 2fdb05dc0931250574f0cb0ebeb5ed8e20f4a889 ]
    > Yang Erkun reports that when two threads are opening files at the same
    > time, and are forced to abort before a reply is seen, then the call to
    > nfs_release_seqid() in nfs4_opendata_free() can result in a
    > use-after-free of the pointer to the defunct rpc task of the other
    > thread.
    > The fix is to ensure that if the RPC call is aborted before the call to
    > nfs_wait_on_sequence() is complete, then we must call nfs_release_seqid()
    > in nfs4_open_release() before the rpc_task is freed.
    > Reported-by: Yang Erkun &lt;yangerkun@huawei.com&gt;
    > Fixes: 24ac23ab88df (&quot;NFSv4: Convert open() into an asynchronous RPC call&quot;)
    > Reviewed-by: Yang Erkun &lt;yangerkun@huawei.com&gt;
    > Signed-off-by: Trond Myklebust &lt;trond.myklebust@hammerspace.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ rtc: st-lpc: Use IRQF_NO_AUTOEN flag in request_irq() (@Jinjie Ruan in [251f142b519d9d8](https://github.com/sophgo/linux-riscv/commit/251f142b519d9d8) at 2024-12-05 13:03:03)
    > [ Upstream commit b6cd7adec0cf03f0aefc55676e71dd721cbc71a8 ]
    > If request_irq() fails in st_rtc_probe(), there is no need to enable
    > the irq, and if it succeeds, disable_irq() after request_irq() still has
    > a time gap in which interrupts can come.
    > request_irq() with IRQF_NO_AUTOEN flag will disable IRQ auto-enable when
    > request IRQ.
    > Fixes: b5b2bdfc2893 (&quot;rtc: st: Add new driver for ST&#x27;s LPC RTC&quot;)
    > Signed-off-by: Jinjie Ruan &lt;ruanjinjie@huawei.com&gt;
    > Link: https://lore.kernel.org/r/20240912033727.3013951-1-ruanjinjie@huawei.com
    > Signed-off-by: Alexandre Belloni &lt;alexandre.belloni@bootlin.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ SUNRPC: make sure cache entry active before cache_show (@Yang Erkun in [d882e2b7fad3f5e](https://github.com/sophgo/linux-riscv/commit/d882e2b7fad3f5e) at 2024-12-05 13:03:02)
    > commit 2862eee078a4d2d1f584e7f24fa50dddfa5f3471 upstream.
    > The function &#x60;c_show&#x60; was called with protection from RCU. This only
    > ensures that &#x60;cp&#x60; will not be freed. Therefore, the reference count for
    > &#x60;cp&#x60; can drop to zero, which will trigger a refcount use-after-free
    > warning when &#x60;cache_get&#x60; is called. To resolve this issue, use
    > &#x60;cache_get_rcu&#x60; to ensure that &#x60;cp&#x60; remains active.
    > ------------[ cut here ]------------
    > refcount_t: addition on 0; use-after-free.
    > WARNING: CPU: 7 PID: 822 at lib/refcount.c:25
    > refcount_warn_saturate+0xb1/0x120
    > CPU: 7 UID: 0 PID: 822 Comm: cat Not tainted 6.12.0-rc3+ #1
    > Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS
    > 1.16.1-2.fc37 04/01/2014
    > RIP: 0010:refcount_warn_saturate+0xb1/0x120
    > Call Trace:
    > &lt;TASK&gt;
    > c_show+0x2fc/0x380 [sunrpc]
    > seq_read_iter+0x589/0x770
    > seq_read+0x1e5/0x270
    > proc_reg_read+0xe1/0x140
    > vfs_read+0x125/0x530
    > ksys_read+0xc1/0x160
    > do_syscall_64+0x5f/0x170
    > entry_SYSCALL_64_after_hwframe+0x76/0x7e
    > Cc: stable@vger.kernel.org # v4.20+
    > Signed-off-by: Yang Erkun &lt;yangerkun@huawei.com&gt;
    > Reviewed-by: Jeff Layton &lt;jlayton@kernel.org&gt;
    > Signed-off-by: Chuck Lever &lt;chuck.lever@oracle.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ NFSD: Prevent a potential integer overflow (@Chuck Lever in [ccd3394f9a7200d](https://github.com/sophgo/linux-riscv/commit/ccd3394f9a7200d) at 2024-12-05 13:03:02)
    > commit 7f33b92e5b18e904a481e6e208486da43e4dc841 upstream.
    > If the tag length is &gt;&#x3D; U32_MAX - 3 then the &quot;length + 4&quot; addition
    > can result in an integer overflow. Address this by splitting the
    > decoding into several steps so that decode_cb_compound4res() does
    > not have to perform arithmetic on the unsafe length value.
    > Reported-by: Dan Carpenter &lt;dan.carpenter@linaro.org&gt;
    > Cc: stable@vger.kernel.org
    > Reviewed-by: Jeff Layton &lt;jlayton@kernel.org&gt;
    > Signed-off-by: Chuck Lever &lt;chuck.lever@oracle.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ um: Fix potential integer overflow during physmem setup (@Tiwei Bie in [a9c95f787b88b29](https://github.com/sophgo/linux-riscv/commit/a9c95f787b88b29) at 2024-12-05 13:03:02)
    > [ Upstream commit a98b7761f697e590ed5d610d87fa12be66f23419 ]
    > This issue happens when the real map size is greater than LONG_MAX,
    > which can be easily triggered on UML/i386.
    > Fixes: fe205bdd1321 (&quot;um: Print minimum physical memory requirement&quot;)
    > Signed-off-by: Tiwei Bie &lt;tiwei.btw@antgroup.com&gt;
    > Link: https://patch.msgid.link/20240916045950.508910-3-tiwei.btw@antgroup.com
    > Signed-off-by: Johannes Berg &lt;johannes.berg@intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ um: Fix the return value of elf_core_copy_task_fpregs (@Tiwei Bie in [a60368b192a3ca7](https://github.com/sophgo/linux-riscv/commit/a60368b192a3ca7) at 2024-12-05 13:03:02)
    > [ Upstream commit 865e3845eeaa21e9a62abc1361644e67124f1ec0 ]
    > This function is expected to return a boolean value, which should be
    > true on success and false on failure.
    > Fixes: d1254b12c93e (&quot;uml: fix x86_64 core dump crash&quot;)
    > Signed-off-by: Tiwei Bie &lt;tiwei.btw@antgroup.com&gt;
    > Link: https://patch.msgid.link/20240913023302.130300-1-tiwei.btw@antgroup.com
    > Signed-off-by: Johannes Berg &lt;johannes.berg@intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ipc: fix memleak if msg_init_ns failed in create_ipc_ns (@Ma Wupeng in [928de5fcd462498](https://github.com/sophgo/linux-riscv/commit/928de5fcd462498) at 2024-12-05 13:03:02)
    > commit bc8f5921cd69188627c08041276238de222ab466 upstream.
    > Percpu memory allocation may failed during create_ipc_ns however this
    > fail is not handled properly since ipc sysctls and mq sysctls is not
    > released properly. Fix this by release these two resource when failure.
    > Here is the kmemleak stack when percpu failed:
    > unreferenced object 0xffff88819de2a600 (size 512):
    > comm &quot;shmem_2nstest&quot;, pid 120711, jiffies 4300542254
    > hex dump (first 32 bytes):
    > 60 aa 9d 84 ff ff ff ff fc 18 48 b2 84 88 ff ff  &#x60;.........H.....
    > 04 00 00 00 a4 01 00 00 20 e4 56 81 ff ff ff ff  ........ .V.....
    > backtrace (crc be7cba35):
    > [&lt;ffffffff81b43f83&gt;] __kmalloc_node_track_caller_noprof+0x333/0x420
    > [&lt;ffffffff81a52e56&gt;] kmemdup_noprof+0x26/0x50
    > [&lt;ffffffff821b2f37&gt;] setup_mq_sysctls+0x57/0x1d0
    > [&lt;ffffffff821b29cc&gt;] copy_ipcs+0x29c/0x3b0
    > [&lt;ffffffff815d6a10&gt;] create_new_namespaces+0x1d0/0x920
    > [&lt;ffffffff815d7449&gt;] copy_namespaces+0x2e9/0x3e0
    > [&lt;ffffffff815458f3&gt;] copy_process+0x29f3/0x7ff0
    > [&lt;ffffffff8154b080&gt;] kernel_clone+0xc0/0x650
    > [&lt;ffffffff8154b6b1&gt;] __do_sys_clone+0xa1/0xe0
    > [&lt;ffffffff843df8ff&gt;] do_syscall_64+0xbf/0x1c0
    > [&lt;ffffffff846000b0&gt;] entry_SYSCALL_64_after_hwframe+0x4b/0x53
    > Link: https://lkml.kernel.org/r/20241023093129.3074301-1-mawupeng1@huawei.com
    > Fixes: 72d1e611082e (&quot;ipc/msg: mitigate the lock contention with percpu counter&quot;)
    > Signed-off-by: Ma Wupeng &lt;mawupeng1@huawei.com&gt;
    > Cc: &lt;stable@vger.kernel.org&gt;
    > Signed-off-by: Andrew Morton &lt;akpm@linux-foundation.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ Input: cs40l50 - fix wrong usage of INIT_WORK() (@Yuan Can in [76b9f8cbb1a33d4](https://github.com/sophgo/linux-riscv/commit/76b9f8cbb1a33d4) at 2024-12-05 13:03:02)
    > commit 5c822c0ce5cc83ed4cd8394f3dc46dae8d9a681d upstream.
    > In cs40l50_add(), the work_data is a local variable and the work_data.work
    > should initialize with INIT_WORK_ONSTACK() instead of INIT_WORK().
    > Small error in cs40l50_erase() also fixed in this commit.
    > Fixes: c38fe1bb5d21 (&quot;Input: cs40l50 - Add support for the CS40L50 haptic driver&quot;)
    > Signed-off-by: Yuan Can &lt;yuancan@huawei.com&gt;
    > Reviewed-by: James Ogletree &lt;jogletre@opensource.cirrus.com&gt;
    > Link: https://lore.kernel.org/r/20241106013549.78142-1-yuancan@huawei.com
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Dmitry Torokhov &lt;dmitry.torokhov@gmail.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ f2fs: fix to do sanity check on node blkaddr in truncate_node() (@Chao Yu in [0a5c8b3fbf6200f](https://github.com/sophgo/linux-riscv/commit/0a5c8b3fbf6200f) at 2024-12-05 13:03:02)
    > commit 6babe00ccd34fc65b78ef8b99754e32b4385f23d upstream.
    > syzbot reports a f2fs bug as below:
    > ------------[ cut here ]------------
    > kernel BUG at fs/f2fs/segment.c:2534!
    > RIP: 0010:f2fs_invalidate_blocks+0x35f/0x370 fs/f2fs/segment.c:2534
    > Call Trace:
    > truncate_node+0x1ae/0x8c0 fs/f2fs/node.c:909
    > f2fs_remove_inode_page+0x5c2/0x870 fs/f2fs/node.c:1288
    > f2fs_evict_inode+0x879/0x15c0 fs/f2fs/inode.c:856
    > evict+0x4e8/0x9b0 fs/inode.c:723
    > f2fs_handle_failed_inode+0x271/0x2e0 fs/f2fs/inode.c:986
    > f2fs_create+0x357/0x530 fs/f2fs/namei.c:394
    > lookup_open fs/namei.c:3595 [inline]
    > open_last_lookups fs/namei.c:3694 [inline]
    > path_openat+0x1c03/0x3590 fs/namei.c:3930
    > do_filp_open+0x235/0x490 fs/namei.c:3960
    > do_sys_openat2+0x13e/0x1d0 fs/open.c:1415
    > do_sys_open fs/open.c:1430 [inline]
    > __do_sys_openat fs/open.c:1446 [inline]
    > __se_sys_openat fs/open.c:1441 [inline]
    > __x64_sys_openat+0x247/0x2a0 fs/open.c:1441
    > do_syscall_x64 arch/x86/entry/common.c:52 [inline]
    > do_syscall_64+0xf3/0x230 arch/x86/entry/common.c:83
    > entry_SYSCALL_64_after_hwframe+0x77/0x7f
    > RIP: 0010:f2fs_invalidate_blocks+0x35f/0x370 fs/f2fs/segment.c:2534
    > The root cause is: on a fuzzed image, blkaddr in nat entry may be
    > corrupted, then it will cause system panic when using it in
    > f2fs_invalidate_blocks(), to avoid this, let&#x27;s add sanity check on
    > nat blkaddr in truncate_node().
    > Reported-by: syzbot+33379ce4ac76acf7d0c7@syzkaller.appspotmail.com
    > Closes: https://lore.kernel.org/linux-f2fs-devel/0000000000009a6cd706224ca720@google.com/
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Chao Yu &lt;chao@kernel.org&gt;
    > Signed-off-by: Jaegeuk Kim &lt;jaegeuk@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ usb: dwc3: gadget: Add missing check for single port RAM in TxFIFO resizing logic (@Selvarasu Ganesan in [de7c079c8cca04b](https://github.com/sophgo/linux-riscv/commit/de7c079c8cca04b) at 2024-12-05 13:03:01)
    > commit 61eb055cd3048ee01ca43d1be924167d33e16fdc upstream.
    > The existing implementation of the TxFIFO resizing logic only supports
    > scenarios where more than one port RAM is used. However, there is a need
    > to resize the TxFIFO in USB2.0-only mode where only a single port RAM is
    > available. This commit introduces the necessary changes to support
    > TxFIFO resizing in such scenarios by adding a missing check for single
    > port RAM.
    > This fix addresses certain platform configurations where the existing
    > TxFIFO resizing logic does not work properly due to the absence of
    > support for single port RAM. By adding this missing check, we ensure
    > that the TxFIFO resizing logic works correctly in all scenarios,
    > including those with a single port RAM.
    > Fixes: 9f607a309fbe (&quot;usb: dwc3: Resize TX FIFOs to meet EP bursting requirements&quot;)
    > Cc: stable@vger.kernel.org # 6.12.x: fad16c82: usb: dwc3: gadget: Refine the logic for resizing Tx FIFOs
    > Signed-off-by: Selvarasu Ganesan &lt;selvarasu.g@samsung.com&gt;
    > Acked-by: Thinh Nguyen &lt;Thinh.Nguyen@synopsys.com&gt;
    > Link: https://lore.kernel.org/r/20241112044807.623-1-selvarasu.g@samsung.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ lib: string_helpers: silence snprintf() output truncation warning (@Bartosz Golaszewski in [9517bc76ff4b2fe](https://github.com/sophgo/linux-riscv/commit/9517bc76ff4b2fe) at 2024-12-05 13:03:01)
    > commit a508ef4b1dcc82227edc594ffae583874dd425d7 upstream.
    > The output of &quot;.%03u&quot; with the unsigned int in range [0, 4294966295] may
    > get truncated if the target buffer is not 12 bytes. This can&#x27;t really
    > happen here as the &#x27;remainder&#x27; variable cannot exceed 999 but the
    > compiler doesn&#x27;t know it. To make it happy just increase the buffer to
    > where the warning goes away.
    > Fixes: 3c9f3681d0b4 (&quot;[SCSI] lib: add generic helper to print sizes rounded to the correct SI range&quot;)
    > Signed-off-by: Bartosz Golaszewski &lt;bartosz.golaszewski@linaro.org&gt;
    > Reviewed-by: Andy Shevchenko &lt;andy@kernel.org&gt;
    > Cc: James E.J. Bottomley &lt;James.Bottomley@HansenPartnership.com&gt;
    > Cc: Kees Cook &lt;kees@kernel.org&gt;
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Andrew Morton &lt;akpm@linux-foundation.org&gt;
    > Link: https://lore.kernel.org/r/20241101205453.9353-1-brgl@bgdev.pl
    > Signed-off-by: Kees Cook &lt;kees@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ counter: stm32-timer-cnt: fix device_node handling in probe_encoder() (@Javier Carrasco in [838096717410366](https://github.com/sophgo/linux-riscv/commit/838096717410366) at 2024-12-05 13:03:01)
    > commit 147359e23e5c9652ff8c5a98a51a7323bd51c94a upstream.
    > Device nodes accessed via of_get_compatible_child() require
    > of_node_put() to be called when the node is no longer required to avoid
    > leaving a reference to the node behind, leaking the resource.
    > In this case, the usage of &#x27;tnode&#x27; is straightforward and there are no
    > error paths, allowing for a single of_node_put() when &#x27;tnode&#x27; is no
    > longer required.
    > Cc: stable@vger.kernel.org
    > Fixes: 29646ee33cc3 (&quot;counter: stm32-timer-cnt: add checks on quadrature encoder capability&quot;)
    > Signed-off-by: Javier Carrasco &lt;javier.carrasco.cruz@gmail.com&gt;
    > Link: https://lore.kernel.org/r/20241027-stm32-timer-cnt-of_node_put-v1-1-ebd903cdf7ac@gmail.com
    > Signed-off-by: William Breathitt Gray &lt;wbg@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ staging: vchiq_arm: Fix missing refcount decrement in error path for fw_node (@Javier Carrasco in [7d4fb115fbf17f9](https://github.com/sophgo/linux-riscv/commit/7d4fb115fbf17f9) at 2024-12-05 13:03:01)
    > commit 22a3703af127e897dc7df89372b85bb9dc331c5f upstream.
    > An error path was introduced without including the required call to
    > of_node_put() to decrement the node&#x27;s refcount and avoid leaking memory.
    > If the call to kzalloc() for &#x27;mgmt&#x27; fails, the probe returns without
    > decrementing the refcount.
    > Use the automatic cleanup facility to fix the bug and protect the code
    > against new error paths where the call to of_node_put() might be missing
    > again.
    > Cc: stable@vger.kernel.org
    > Fixes: 1c9e16b73166 (&quot;staging: vc04_services: vchiq_arm: Split driver static and runtime data&quot;)
    > Signed-off-by: Javier Carrasco &lt;javier.carrasco.cruz@gmail.com&gt;
    > Reviewed-by: Dan Carpenter &lt;dan.carpenter@linaro.org&gt;
    > Reviewed-by: Umang Jain &lt;umang.jain@ideasonboard.com&gt;
    > Link: https://lore.kernel.org/r/20241014-vchiq_arm-of_node_put-v2-2-cafe0a4c2666@gmail.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ usb: dwc3: gadget: Fix looping of queued SG entries (@Thinh Nguyen in [70777a23a54e359](https://github.com/sophgo/linux-riscv/commit/70777a23a54e359) at 2024-12-05 13:03:01)
    > commit b7fc65f5141c24785dc8c19249ca4efcf71b3524 upstream.
    > The dwc3_request-&gt;num_queued_sgs is decremented on completion. If a
    > partially completed request is handled, then the
    > dwc3_request-&gt;num_queued_sgs no longer reflects the total number of
    > num_queued_sgs (it would be cleared).
    > Correctly check the number of request SG entries remained to be prepare
    > and queued. Failure to do this may cause null pointer dereference when
    > accessing non-existent SG entry.
    > Cc: stable@vger.kernel.org
    > Fixes: c96e6725db9d (&quot;usb: dwc3: gadget: Correct the logic for queuing sgs&quot;)
    > Signed-off-by: Thinh Nguyen &lt;Thinh.Nguyen@synopsys.com&gt;
    > Link: https://lore.kernel.org/r/d07a7c4aa0fcf746cdca0515150dbe5c52000af7.1731545781.git.Thinh.Nguyen@synopsys.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ ublk: fix error code for unsupported command (@Ming Lei in [31e45c09a8ea0cd](https://github.com/sophgo/linux-riscv/commit/31e45c09a8ea0cd) at 2024-12-05 13:03:01)
    > commit 34c1227035b3ab930a1ae6ab6f22fec1af8ab09e upstream.
    > ENOTSUPP is for kernel use only, and shouldn&#x27;t be sent to userspace.
    > Fix it by replacing it with EOPNOTSUPP.
    > Cc: stable@vger.kernel.org
    > Fixes: bfbcef036396 (&quot;ublk_drv: move ublk_get_device_from_id into ublk_ctrl_uring_cmd&quot;)
    > Signed-off-by: Ming Lei &lt;ming.lei@redhat.com&gt;
    > Link: https://lore.kernel.org/r/20241119030646.2319030-1-ming.lei@redhat.com
    > Signed-off-by: Jens Axboe &lt;axboe@kernel.dk&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ usb: dwc3: gadget: Fix checking for number of TRBs left (@Thinh Nguyen in [2f6c3acece2b87b](https://github.com/sophgo/linux-riscv/commit/2f6c3acece2b87b) at 2024-12-05 13:03:01)
    > commit 02a6982b0ccfcdc39e20016f5fc9a1b7826a6ee7 upstream.
    > The check whether the TRB ring is full or empty in dwc3_calc_trbs_left()
    > is insufficient. It assumes there are active TRBs if there&#x27;s any request
    > in the started_list. However, that&#x27;s not the case for requests with a
    > large SG list.
    > That is, if we have a single usb request that requires more TRBs than
    > the total TRBs in the TRB ring, the queued TRBs will be available when
    > all the TRBs in the ring are completed. But the request is only
    > partially completed and remains in the started_list. With the current
    > logic, the TRB ring is empty, but dwc3_calc_trbs_left() returns 0.
    > Fix this by additionally checking for the request-&gt;num_trbs for active
    > TRB count.
    > Cc: stable@vger.kernel.org
    > Fixes: 51f1954ad853 (&quot;usb: dwc3: gadget: Fix dwc3_calc_trbs_left()&quot;)
    > Signed-off-by: Thinh Nguyen &lt;Thinh.Nguyen@synopsys.com&gt;
    > Link: https://lore.kernel.org/r/708dc62b56b77da1f704cc2ae9b6ddb1f2dbef1f.1731545781.git.Thinh.Nguyen@synopsys.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ usb: misc: ljca: set small runtime autosuspend delay (@Stanislaw Gruszka in [87c74bd56aac20f](https://github.com/sophgo/linux-riscv/commit/87c74bd56aac20f) at 2024-12-05 13:03:00)
    > commit 2481af79671a6603fce201cbbc48f31e488e9fae upstream.
    > On some Lenovo platforms, the patch works around problems with ov2740
    > sensor initialization, which manifest themself like below:
    > [    4.540476] ov2740 i2c-INT3474:01: error -EIO: failed to find sensor
    > [    4.542066] ov2740 i2c-INT3474:01: probe with driver ov2740 failed with error -5
    > or
    > [    7.742633] ov2740 i2c-INT3474:01: chip id mismatch: 2740 !&#x3D; 0
    > [    7.742638] ov2740 i2c-INT3474:01: error -ENXIO: failed to find sensor
    > and also by random failures of video stream start.
    > Issue can be reproduced by this script:
    > n&#x3D;0
    > k&#x3D;0
    > while [ $n -lt 50 ] ; do
    > sudo modprobe -r ov2740
    > sleep &#x60;expr $RANDOM % 5&#x60;
    > sudo modprobe ov2740
    > if media-ctl -p  | grep -q ov2740 ; then
    > let k++
    > fi
    > let n++
    > done
    > echo Success rate $k/$n
    > Without the patch, success rate is approximately 15 or 50 tries.
    > With the patch it does not fail.
    > This problem is some hardware or firmware malfunction, that can not be
    > easy debug and fix. While setting small autosuspend delay is not perfect
    > workaround as user can configure it to any value, it will prevent
    > the failures by default.
    > Additionally setting small autosuspend delay should have positive effect
    > on power consumption as for most ljca workloads device is used for just
    > a few milliseconds flowed by long periods of at least 100ms of inactivity
    > (usually more).
    > Fixes: acd6199f195d (&quot;usb: Add support for Intel LJCA device&quot;)
    > Cc: stable@vger.kernel.org
    > Reviewed-by: Hans de Goede &lt;hdegoede@redhat.com&gt;
    > Tested-by: Hans de Goede &lt;hdegoede@redhat.com&gt; # ThinkPad X1 Yoga Gen 8, ov2740
    > Acked-by: Sakari Ailus &lt;sakari.ailus@linux.intel.com&gt;
    > Signed-off-by: Stanislaw Gruszka &lt;stanislaw.gruszka@linux.intel.com&gt;
    > Link: https://lore.kernel.org/r/20241112075514.680712-2-stanislaw.gruszka@linux.intel.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ smb: During unmount, ensure all cached dir instances drop their dentry (@Paul Aurich in [548812afd96982a](https://github.com/sophgo/linux-riscv/commit/548812afd96982a) at 2024-12-05 13:03:00)
    > commit 3fa640d035e5ae526769615c35cb9ed4be6e3662 upstream.
    > The unmount process (cifs_kill_sb() calling close_all_cached_dirs()) can
    > race with various cached directory operations, which ultimately results
    > in dentries not being dropped and these kernel BUGs:
    > BUG: Dentry ffff88814f37e358{i&#x3D;1000000000080,n&#x3D;/}  still in use (2) [unmount of cifs cifs]
    > VFS: Busy inodes after unmount of cifs (cifs)
    > ------------[ cut here ]------------
    > kernel BUG at fs/super.c:661!
    > This happens when a cfid is in the process of being cleaned up when, and
    > has been removed from the cfids-&gt;entries list, including:
    > - Receiving a lease break from the server
    > - Server reconnection triggers invalidate_all_cached_dirs(), which
    > removes all the cfids from the list
    > - The laundromat thread decides to expire an old cfid.
    > To solve these problems, dropping the dentry is done in queued work done
    > in a newly-added cfid_put_wq workqueue, and close_all_cached_dirs()
    > flushes that workqueue after it drops all the dentries of which it&#x27;s
    > aware. This is a global workqueue (rather than scoped to a mount), but
    > the queued work is minimal.
    > The final cleanup work for cleaning up a cfid is performed via work
    > queued in the serverclose_wq workqueue; this is done separate from
    > dropping the dentries so that close_all_cached_dirs() doesn&#x27;t block on
    > any server operations.
    > Both of these queued works expect to invoked with a cfid reference and
    > a tcon reference to avoid those objects from being freed while the work
    > is ongoing.
    > While we&#x27;re here, add proper locking to close_all_cached_dirs(), and
    > locking around the freeing of cfid-&gt;dentry.
    > Fixes: ebe98f1447bb (&quot;cifs: enable caching of directories for which a lease is held&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Paul Aurich &lt;paul@darkrain42.org&gt;
    > Signed-off-by: Steve French &lt;stfrench@microsoft.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ smb: prevent use-after-free due to open_cached_dir error paths (@Paul Aurich in [47655a12c6b1bca](https://github.com/sophgo/linux-riscv/commit/47655a12c6b1bca) at 2024-12-05 13:03:00)
    > commit a9685b409a03b73d2980bbfa53eb47555802d0a9 upstream.
    > If open_cached_dir() encounters an error parsing the lease from the
    > server, the error handling may race with receiving a lease break,
    > resulting in open_cached_dir() freeing the cfid while the queued work is
    > pending.
    > Update open_cached_dir() to drop refs rather than directly freeing the
    > cfid.
    > Have cached_dir_lease_break(), cfids_laundromat_worker(), and
    > invalidate_all_cached_dirs() clear has_lease immediately while still
    > holding cfids-&gt;cfid_list_lock, and then use this to also simplify the
    > reference counting in cfids_laundromat_worker() and
    > invalidate_all_cached_dirs().
    > Fixes this KASAN splat (which manually injects an error and lease break
    > in open_cached_dir()):
    > &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;
    > BUG: KASAN: slab-use-after-free in smb2_cached_lease_break+0x27/0xb0
    > Read of size 8 at addr ffff88811cc24c10 by task kworker/3:1/65
    > CPU: 3 UID: 0 PID: 65 Comm: kworker/3:1 Not tainted 6.12.0-rc6-g255cf264e6e5-dirty #87
    > Hardware name: VMware, Inc. VMware Virtual Platform/440BX Desktop Reference Platform, BIOS 6.00 11/12/2020
    > Workqueue: cifsiod smb2_cached_lease_break
    > Call Trace:
    > &lt;TASK&gt;
    > dump_stack_lvl+0x77/0xb0
    > print_report+0xce/0x660
    > kasan_report+0xd3/0x110
    > smb2_cached_lease_break+0x27/0xb0
    > process_one_work+0x50a/0xc50
    > worker_thread+0x2ba/0x530
    > kthread+0x17c/0x1c0
    > ret_from_fork+0x34/0x60
    > ret_from_fork_asm+0x1a/0x30
    > &lt;/TASK&gt;
    > Allocated by task 2464:
    > kasan_save_stack+0x33/0x60
    > kasan_save_track+0x14/0x30
    > __kasan_kmalloc+0xaa/0xb0
    > open_cached_dir+0xa7d/0x1fb0
    > smb2_query_path_info+0x43c/0x6e0
    > cifs_get_fattr+0x346/0xf10
    > cifs_get_inode_info+0x157/0x210
    > cifs_revalidate_dentry_attr+0x2d1/0x460
    > cifs_getattr+0x173/0x470
    > vfs_statx_path+0x10f/0x160
    > vfs_statx+0xe9/0x150
    > vfs_fstatat+0x5e/0xc0
    > __do_sys_newfstatat+0x91/0xf0
    > do_syscall_64+0x95/0x1a0
    > entry_SYSCALL_64_after_hwframe+0x76/0x7e
    > Freed by task 2464:
    > kasan_save_stack+0x33/0x60
    > kasan_save_track+0x14/0x30
    > kasan_save_free_info+0x3b/0x60
    > __kasan_slab_free+0x51/0x70
    > kfree+0x174/0x520
    > open_cached_dir+0x97f/0x1fb0
    > smb2_query_path_info+0x43c/0x6e0
    > cifs_get_fattr+0x346/0xf10
    > cifs_get_inode_info+0x157/0x210
    > cifs_revalidate_dentry_attr+0x2d1/0x460
    > cifs_getattr+0x173/0x470
    > vfs_statx_path+0x10f/0x160
    > vfs_statx+0xe9/0x150
    > vfs_fstatat+0x5e/0xc0
    > __do_sys_newfstatat+0x91/0xf0
    > do_syscall_64+0x95/0x1a0
    > entry_SYSCALL_64_after_hwframe+0x76/0x7e
    > Last potentially related work creation:
    > kasan_save_stack+0x33/0x60
    > __kasan_record_aux_stack+0xad/0xc0
    > insert_work+0x32/0x100
    > __queue_work+0x5c9/0x870
    > queue_work_on+0x82/0x90
    > open_cached_dir+0x1369/0x1fb0
    > smb2_query_path_info+0x43c/0x6e0
    > cifs_get_fattr+0x346/0xf10
    > cifs_get_inode_info+0x157/0x210
    > cifs_revalidate_dentry_attr+0x2d1/0x460
    > cifs_getattr+0x173/0x470
    > vfs_statx_path+0x10f/0x160
    > vfs_statx+0xe9/0x150
    > vfs_fstatat+0x5e/0xc0
    > __do_sys_newfstatat+0x91/0xf0
    > do_syscall_64+0x95/0x1a0
    > entry_SYSCALL_64_after_hwframe+0x76/0x7e
    > The buggy address belongs to the object at ffff88811cc24c00
    > which belongs to the cache kmalloc-1k of size 1024
    > The buggy address is located 16 bytes inside of
    > freed 1024-byte region [ffff88811cc24c00, ffff88811cc25000)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Paul Aurich &lt;paul@darkrain42.org&gt;
    > Signed-off-by: Steve French &lt;stfrench@microsoft.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ usb: musb: Fix hardware lockup on first Rx endpoint request (@Hubert Wiśniewski in [0c89445e6d475b7](https://github.com/sophgo/linux-riscv/commit/0c89445e6d475b7) at 2024-12-05 13:03:00)
    > commit 3fc137386c4620305bbc2a216868c53f9245670a upstream.
    > There is a possibility that a request&#x27;s callback could be invoked from
    > usb_ep_queue() (call trace below, supplemented with missing calls):
    > req-&gt;complete from usb_gadget_giveback_request
    > (drivers/usb/gadget/udc/core.c:999)
    > usb_gadget_giveback_request from musb_g_giveback
    > (drivers/usb/musb/musb_gadget.c:147)
    > musb_g_giveback from rxstate
    > (drivers/usb/musb/musb_gadget.c:784)
    > rxstate from musb_ep_restart
    > (drivers/usb/musb/musb_gadget.c:1169)
    > musb_ep_restart from musb_ep_restart_resume_work
    > (drivers/usb/musb/musb_gadget.c:1176)
    > musb_ep_restart_resume_work from musb_queue_resume_work
    > (drivers/usb/musb/musb_core.c:2279)
    > musb_queue_resume_work from musb_gadget_queue
    > (drivers/usb/musb/musb_gadget.c:1241)
    > musb_gadget_queue from usb_ep_queue
    > (drivers/usb/gadget/udc/core.c:300)
    > According to the docstring of usb_ep_queue(), this should not happen:
    > &quot;Note that @req&#x27;s -&gt;complete() callback must never be called from within
    > usb_ep_queue() as that can create deadlock situations.&quot;
    > In fact, a hardware lockup might occur in the following sequence:
    > 1. The gadget is initialized using musb_gadget_enable().
    > 2. Meanwhile, a packet arrives, and the RXPKTRDY flag is set, raising an
    > interrupt.
    > 3. If IRQs are enabled, the interrupt is handled, but musb_g_rx() finds an
    > empty queue (next_request() returns NULL). The interrupt flag has
    > already been cleared by the glue layer handler, but the RXPKTRDY flag
    > remains set.
    > 4. The first request is enqueued using usb_ep_queue(), leading to the call
    > of req-&gt;complete(), as shown in the call trace above.
    > 5. If the callback enables IRQs and another packet is waiting, step (3)
    > repeats. The request queue is empty because usb_g_giveback() removes the
    > request before invoking the callback.
    > 6. The endpoint remains locked up, as the interrupt triggered by hardware
    > setting the RXPKTRDY flag has been handled, but the flag itself remains
    > set.
    > For this scenario to occur, it is only necessary for IRQs to be enabled at
    > some point during the complete callback. This happens with the USB Ethernet
    > gadget, whose rx_complete() callback calls netif_rx(). If called in the
    > task context, netif_rx() disables the bottom halves (BHs). When the BHs are
    > re-enabled, IRQs are also enabled to allow soft IRQs to be processed. The
    > gadget itself is initialized at module load (or at boot if built-in), but
    > the first request is enqueued when the network interface is brought up,
    > triggering rx_complete() in the task context via ioctl(). If a packet
    > arrives while the interface is down, it can prevent the interface from
    > receiving any further packets from the USB host.
    > The situation is quite complicated with many parties involved. This
    > particular issue can be resolved in several possible ways:
    > 1. Ensure that callbacks never enable IRQs. This would be difficult to
    > enforce, as discovering how netif_rx() interacts with interrupts was
    > already quite challenging and u_ether is not the only function driver.
    > Similar &quot;bugs&quot; could be hidden in other drivers as well.
    > 2. Disable MUSB interrupts in musb_g_giveback() before calling the callback
    > and re-enable them afterwars (by calling musb_{dis,en}able_interrupts(),
    > for example). This would ensure that MUSB interrupts are not handled
    > during the callback, even if IRQs are enabled. In fact, it would allow
    > IRQs to be enabled when releasing the lock. However, this feels like an
    > inelegant hack.
    > 3. Modify the interrupt handler to clear the RXPKTRDY flag if the request
    > queue is empty. While this approach also feels like a hack, it wastes
    > CPU time by attempting to handle incoming packets when the software is
    > not ready to process them.
    > 4. Flush the Rx FIFO instead of calling rxstate() in musb_ep_restart().
    > This ensures that the hardware can receive packets when there is at
    > least one request in the queue. Once IRQs are enabled, the interrupt
    > handler will be able to correctly process the next incoming packet
    > (eventually calling rxstate()). This approach may cause one or two
    > packets to be dropped (two if double buffering is enabled), but this
    > seems to be a minor issue, as packet loss can occur when the software is
    > not yet ready to process them. Additionally, this solution makes the
    > gadget driver compliant with the rule mentioned in the docstring of
    > usb_ep_queue().
    > There may be additional solutions, but from these four, the last one has
    > been chosen as it seems to be the most appropriate, as it addresses the
    > &quot;bad&quot; behavior of the driver.
    > Fixes: baebdf48c360 (&quot;net: dev: Makes sure netif_rx() can be invoked in any context.&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Hubert Wiśniewski &lt;hubert.wisniewski.25632@gmail.com&gt;
    > Link: https://lore.kernel.org/r/4ee1ead4525f78fb5909a8cbf99513ad0082ad21.camel@gmail.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ usb: dwc3: ep0: Don&#x27;t clear ep0 DWC3_EP_TRANSFER_STARTED (@Thinh Nguyen in [068aab9564d4a2e](https://github.com/sophgo/linux-riscv/commit/068aab9564d4a2e) at 2024-12-05 13:03:00)
    > commit 5d2fb074dea289c41f5aaf2c3f68286bee370634 upstream.
    > The driver cannot issue the End Transfer command to the SETUP transfer.
    > Don&#x27;t clear DWC3_EP_TRANSFER_STARTED flag to make sure that the driver
    > won&#x27;t send Start Transfer command again, which can cause no-resource
    > error. For example this can occur if the host issues a reset to the
    > device.
    > Cc: stable@vger.kernel.org
    > Fixes: 76cb323f80ac (&quot;usb: dwc3: ep0: clear all EP0 flags&quot;)
    > Signed-off-by: Thinh Nguyen &lt;Thinh.Nguyen@synopsys.com&gt;
    > Link: https://lore.kernel.org/r/d3d618185fd614bb7426352a9fc1199641d3b5f5.1731545781.git.Thinh.Nguyen@synopsys.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ usb: misc: ljca: move usb_autopm_put_interface() after wait for response (@Stanislaw Gruszka in [04737703e40fff8](https://github.com/sophgo/linux-riscv/commit/04737703e40fff8) at 2024-12-05 13:03:00)
    > commit 5c5d8eb8af06df615e8b1dc88e5847196c846045 upstream.
    > Do not mark interface as ready to suspend when we are still waiting
    > for response messages from the device.
    > Fixes: acd6199f195d (&quot;usb: Add support for Intel LJCA device&quot;)
    > Cc: stable@vger.kernel.org
    > Reviewed-by: Hans de Goede &lt;hdegoede@redhat.com&gt;
    > Tested-by: Hans de Goede &lt;hdegoede@redhat.com&gt; # ThinkPad X1 Yoga Gen 8, ov2740
    > Acked-by: Sakari Ailus &lt;sakari.ailus@linux.intel.com&gt;
    > Signed-off-by: Stanislaw Gruszka &lt;stanislaw.gruszka@linux.intel.com&gt;
    > Link: https://lore.kernel.org/r/20241112075514.680712-1-stanislaw.gruszka@linux.intel.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ ALSA: hda/realtek: Apply quirk for Medion E15433 (@Takashi Iwai in [bb060d38c17c387](https://github.com/sophgo/linux-riscv/commit/bb060d38c17c387) at 2024-12-05 13:02:59)
    > commit ca0f79f0286046f6a91c099dc941cf7afae198d6 upstream.
    > Medion E15433 laptop wich ALC269VC (SSID 2782:1705) needs the same
    > workaround for the missing speaker as another model.
    > Link: https://bugzilla.suse.com/show_bug.cgi?id&#x3D;1233298
    > Cc: &lt;stable@vger.kernel.org&gt;
    > Link: https://patch.msgid.link/20241128072646.15659-1-tiwai@suse.de
    > Signed-off-by: Takashi Iwai &lt;tiwai@suse.de&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ smb: client: handle max length for SMB symlinks (@Paulo Alcantara in [86be153441abf70](https://github.com/sophgo/linux-riscv/commit/86be153441abf70) at 2024-12-05 13:02:59)
    > commit 0812340811e45ec4039d409049be53056182a552 upstream.
    > We can&#x27;t use PATH_MAX for SMB symlinks because
    > (1) Windows Server will fail FSCTL_SET_REPARSE_POINT with
    > STATUS_IO_REPARSE_DATA_INVALID when input buffer is larger than
    > 16K, as specified in MS-FSA 2.1.5.10.37.
    > (2) The client won&#x27;t be able to parse large SMB responses that
    > includes SMB symlink path within SMB2_CREATE or SMB2_IOCTL
    > responses.
    > Fix this by defining a maximum length value (4060) for SMB symlinks
    > that both client and server can handle.
    > Cc: David Howells &lt;dhowells@redhat.com&gt;
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Paulo Alcantara (Red Hat) &lt;pc@manguebit.com&gt;
    > Signed-off-by: Steve French &lt;stfrench@microsoft.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ smb3: request handle caching when caching directories (@Steve French in [7b58644f4ade0e1](https://github.com/sophgo/linux-riscv/commit/7b58644f4ade0e1) at 2024-12-05 13:02:59)
    > commit 9ed9d83a51a9636d367c796252409e7b2f4de4d4 upstream.
    > This client was only requesting READ caching, not READ and HANDLE caching
    > in the LeaseState on the open requests we send for directories.  To
    > delay closing a handle (e.g. for caching directory contents) we should
    > be requesting HANDLE as well as READ (as we already do for deferred
    > close of files).   See MS-SMB2 3.3.1.4 e.g.
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Steve French &lt;stfrench@microsoft.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ fs/smb/client: implement chmod() for SMB3 POSIX Extensions (@Ralph Boehme in [797d0d61ae3bb0b](https://github.com/sophgo/linux-riscv/commit/797d0d61ae3bb0b) at 2024-12-05 13:02:59)
    > commit d413eabff18d640031fc955d107ad9c03c3bf9f1 upstream.
    > The NT ACL format for an SMB3 POSIX Extensions chmod() is a single ACE with the
    > magic S-1-5-88-3-mode SID:
    > NT Security Descriptor
    > Revision: 1
    > Type: 0x8004, Self Relative, DACL Present
    > Offset to owner SID: 56
    > Offset to group SID: 124
    > Offset to SACL: 0
    > Offset to DACL: 20
    > Owner: S-1-5-21-3177838999-3893657415-1037673384-1000
    > Group: S-1-22-2-1000
    > NT User (DACL) ACL
    > Revision: NT4 (2)
    > Size: 36
    > Num ACEs: 1
    > NT ACE: S-1-5-88-3-438, flags 0x00, Access Allowed, mask 0x00000000
    > Type: Access Allowed
    > NT ACE Flags: 0x00
    > Size: 28
    > Access required: 0x00000000
    > SID: S-1-5-88-3-438
    > Owner and Group should be NULL, but the server is not required to fail the
    > request if they are present.
    > Signed-off-by: Ralph Boehme &lt;slow@samba.org&gt;
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Steve French &lt;stfrench@microsoft.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ smb: Don&#x27;t leak cfid when reconnect races with open_cached_dir (@Paul Aurich in [73a57b25b4df23f](https://github.com/sophgo/linux-riscv/commit/73a57b25b4df23f) at 2024-12-05 13:02:59)
    > commit 7afb86733685c64c604d32faf00fa4a1f22c2ab1 upstream.
    > open_cached_dir() may either race with the tcon reconnection even before
    > compound_send_recv() or directly trigger a reconnection via
    > SMB2_open_init() or SMB_query_info_init().
    > The reconnection process invokes invalidate_all_cached_dirs() via
    > cifs_mark_open_files_invalid(), which removes all cfids from the
    > cfids-&gt;entries list but doesn&#x27;t drop a ref if has_lease isn&#x27;t true. This
    > results in the currently-being-constructed cfid not being on the list,
    > but still having a refcount of 2. It leaks if returned from
    > open_cached_dir().
    > Fix this by setting cfid-&gt;has_lease when the ref is actually taken; the
    > cfid will not be used by other threads until it has a valid time.
    > Addresses these kmemleaks:
    > unreferenced object 0xffff8881090c4000 (size 1024):
    > comm &quot;bash&quot;, pid 1860, jiffies 4295126592
    > hex dump (first 32 bytes):
    > 00 01 00 00 00 00 ad de 22 01 00 00 00 00 ad de  ........&quot;.......
    > 00 ca 45 22 81 88 ff ff f8 dc 4f 04 81 88 ff ff  ..E&quot;......O.....
    > backtrace (crc 6f58c20f):
    > [&lt;ffffffff8b895a1e&gt;] __kmalloc_cache_noprof+0x2be/0x350
    > [&lt;ffffffff8bda06e3&gt;] open_cached_dir+0x993/0x1fb0
    > [&lt;ffffffff8bdaa750&gt;] cifs_readdir+0x15a0/0x1d50
    > [&lt;ffffffff8b9a853f&gt;] iterate_dir+0x28f/0x4b0
    > [&lt;ffffffff8b9a9aed&gt;] __x64_sys_getdents64+0xfd/0x200
    > [&lt;ffffffff8cf6da05&gt;] do_syscall_64+0x95/0x1a0
    > [&lt;ffffffff8d00012f&gt;] entry_SYSCALL_64_after_hwframe+0x76/0x7e
    > unreferenced object 0xffff8881044fdcf8 (size 8):
    > comm &quot;bash&quot;, pid 1860, jiffies 4295126592
    > hex dump (first 8 bytes):
    > 00 cc cc cc cc cc cc cc                          ........
    > backtrace (crc 10c106a9):
    > [&lt;ffffffff8b89a3d3&gt;] __kmalloc_node_track_caller_noprof+0x363/0x480
    > [&lt;ffffffff8b7d7256&gt;] kstrdup+0x36/0x60
    > [&lt;ffffffff8bda0700&gt;] open_cached_dir+0x9b0/0x1fb0
    > [&lt;ffffffff8bdaa750&gt;] cifs_readdir+0x15a0/0x1d50
    > [&lt;ffffffff8b9a853f&gt;] iterate_dir+0x28f/0x4b0
    > [&lt;ffffffff8b9a9aed&gt;] __x64_sys_getdents64+0xfd/0x200
    > [&lt;ffffffff8cf6da05&gt;] do_syscall_64+0x95/0x1a0
    > [&lt;ffffffff8d00012f&gt;] entry_SYSCALL_64_after_hwframe+0x76/0x7e
    > And addresses these BUG splats when unmounting the SMB filesystem:
    > BUG: Dentry ffff888140590ba0{i&#x3D;1000000000080,n&#x3D;/}  still in use (2) [unmount of cifs cifs]
    > WARNING: CPU: 3 PID: 3433 at fs/dcache.c:1536 umount_check+0xd0/0x100
    > Modules linked in:
    > CPU: 3 UID: 0 PID: 3433 Comm: bash Not tainted 6.12.0-rc4-g850925a8133c-dirty #49
    > Hardware name: VMware, Inc. VMware Virtual Platform/440BX Desktop Reference Platform, BIOS 6.00 11/12/2020
    > RIP: 0010:umount_check+0xd0/0x100
    > Code: 8d 7c 24 40 e8 31 5a f4 ff 49 8b 54 24 40 41 56 49 89 e9 45 89 e8 48 89 d9 41 57 48 89 de 48 c7 c7 80 e7 db ac e8 f0 72 9a ff &lt;0f&gt; 0b 58 31 c0 5a 5b 5d 41 5c 41 5d 41 5e 41 5f e9 2b e5 5d 01 41
    > RSP: 0018:ffff88811cc27978 EFLAGS: 00010286
    > RAX: 0000000000000000 RBX: ffff888140590ba0 RCX: ffffffffaaf20bae
    > RDX: dffffc0000000000 RSI: 0000000000000008 RDI: ffff8881f6fb6f40
    > RBP: ffff8881462ec000 R08: 0000000000000001 R09: ffffed1023984ee3
    > R10: ffff88811cc2771f R11: 00000000016cfcc0 R12: ffff888134383e08
    > R13: 0000000000000002 R14: ffff8881462ec668 R15: ffffffffaceab4c0
    > FS:  00007f23bfa98740(0000) GS:ffff8881f6f80000(0000) knlGS:0000000000000000
    > CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
    > CR2: 0000556de4a6f808 CR3: 0000000123c80000 CR4: 0000000000350ef0
    > Call Trace:
    > &lt;TASK&gt;
    > d_walk+0x6a/0x530
    > shrink_dcache_for_umount+0x6a/0x200
    > generic_shutdown_super+0x52/0x2a0
    > kill_anon_super+0x22/0x40
    > cifs_kill_sb+0x159/0x1e0
    > deactivate_locked_super+0x66/0xe0
    > cleanup_mnt+0x140/0x210
    > task_work_run+0xfb/0x170
    > syscall_exit_to_user_mode+0x29f/0x2b0
    > do_syscall_64+0xa1/0x1a0
    > entry_SYSCALL_64_after_hwframe+0x76/0x7e
    > RIP: 0033:0x7f23bfb93ae7
    > Code: ff ff ff ff c3 66 0f 1f 44 00 00 48 8b 0d 11 93 0d 00 f7 d8 64 89 01 b8 ff ff ff ff eb bf 0f 1f 44 00 00 b8 50 00 00 00 0f 05 &lt;48&gt; 3d 01 f0 ff ff 73 01 c3 48 8b 0d e9 92 0d 00 f7 d8 64 89 01 48
    > RSP: 002b:00007ffee9138598 EFLAGS: 00000246 ORIG_RAX: 0000000000000050
    > RAX: 0000000000000000 RBX: 0000558f1803e9a0 RCX: 00007f23bfb93ae7
    > RDX: 0000000000000000 RSI: 0000000000000004 RDI: 0000558f1803e9a0
    > RBP: 0000558f1803e600 R08: 0000000000000007 R09: 0000558f17fab610
    > R10: d91d5ec34ab757b0 R11: 0000000000000246 R12: 0000000000000001
    > R13: 0000000000000000 R14: 0000000000000015 R15: 0000000000000000
    > &lt;/TASK&gt;
    > irq event stamp: 1163486
    > hardirqs last  enabled at (1163485): [&lt;ffffffffac98d344&gt;] _raw_spin_unlock_irqrestore+0x34/0x60
    > hardirqs last disabled at (1163486): [&lt;ffffffffac97dcfc&gt;] __schedule+0xc7c/0x19a0
    > softirqs last  enabled at (1163482): [&lt;ffffffffab79a3ee&gt;] __smb_send_rqst+0x3de/0x990
    > softirqs last disabled at (1163480): [&lt;ffffffffac2314f1&gt;] release_sock+0x21/0xf0
    > ---[ end trace 0000000000000000 ]---
    > VFS: Busy inodes after unmount of cifs (cifs)
    > ------------[ cut here ]------------
    > kernel BUG at fs/super.c:661!
    > Oops: invalid opcode: 0000 [#1] PREEMPT SMP KASAN NOPTI
    > CPU: 1 UID: 0 PID: 3433 Comm: bash Tainted: G        W          6.12.0-rc4-g850925a8133c-dirty #49
    > Tainted: [W]&#x3D;WARN
    > Hardware name: VMware, Inc. VMware Virtual Platform/440BX Desktop Reference Platform, BIOS 6.00 11/12/2020
    > RIP: 0010:generic_shutdown_super+0x290/0x2a0
    > Code: e8 15 7c f7 ff 48 8b 5d 28 48 89 df e8 09 7c f7 ff 48 8b 0b 48 89 ee 48 8d 95 68 06 00 00 48 c7 c7 80 7f db ac e8 00 69 af ff &lt;0f&gt; 0b 66 66 2e 0f 1f 84 00 00 00 00 00 0f 1f 00 90 90 90 90 90 90
    > RSP: 0018:ffff88811cc27a50 EFLAGS: 00010246
    > RAX: 000000000000003e RBX: ffffffffae994420 RCX: 0000000000000027
    > RDX: 0000000000000000 RSI: ffffffffab06180e RDI: ffff8881f6eb18c8
    > RBP: ffff8881462ec000 R08: 0000000000000001 R09: ffffed103edd6319
    > R10: ffff8881f6eb18cb R11: 00000000016d3158 R12: ffff8881462ec9c0
    > R13: ffff8881462ec050 R14: 0000000000000001 R15: 0000000000000000
    > FS:  00007f23bfa98740(0000) GS:ffff8881f6e80000(0000) knlGS:0000000000000000
    > CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
    > CR2: 00007f8364005d68 CR3: 0000000123c80000 CR4: 0000000000350ef0
    > Call Trace:
    > &lt;TASK&gt;
    > kill_anon_super+0x22/0x40
    > cifs_kill_sb+0x159/0x1e0
    > deactivate_locked_super+0x66/0xe0
    > cleanup_mnt+0x140/0x210
    > task_work_run+0xfb/0x170
    > syscall_exit_to_user_mode+0x29f/0x2b0
    > do_syscall_64+0xa1/0x1a0
    > entry_SYSCALL_64_after_hwframe+0x76/0x7e
    > RIP: 0033:0x7f23bfb93ae7
    > &lt;/TASK&gt;
    > Modules linked in:
    > ---[ end trace 0000000000000000 ]---
    > RIP: 0010:generic_shutdown_super+0x290/0x2a0
    > Code: e8 15 7c f7 ff 48 8b 5d 28 48 89 df e8 09 7c f7 ff 48 8b 0b 48 89 ee 48 8d 95 68 06 00 00 48 c7 c7 80 7f db ac e8 00 69 af ff &lt;0f&gt; 0b 66 66 2e 0f 1f 84 00 00 00 00 00 0f 1f 00 90 90 90 90 90 90
    > RSP: 0018:ffff88811cc27a50 EFLAGS: 00010246
    > RAX: 000000000000003e RBX: ffffffffae994420 RCX: 0000000000000027
    > RDX: 0000000000000000 RSI: ffffffffab06180e RDI: ffff8881f6eb18c8
    > RBP: ffff8881462ec000 R08: 0000000000000001 R09: ffffed103edd6319
    > R10: ffff8881f6eb18cb R11: 00000000016d3158 R12: ffff8881462ec9c0
    > R13: ffff8881462ec050 R14: 0000000000000001 R15: 0000000000000000
    > FS:  00007f23bfa98740(0000) GS:ffff8881f6e80000(0000) knlGS:0000000000000000
    > CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
    > CR2: 00007f8364005d68 CR3: 0000000123c80000 CR4: 0000000000350ef0
    > This reproduces eventually with an SMB mount and two shells running
    > these loops concurrently
    > - while true; do
    > cd ~; sleep 1;
    > for i in {1..3}; do cd /mnt/test/subdir;
    > echo $PWD; sleep 1; cd ..; echo $PWD; sleep 1;
    > done;
    > echo ...;
    > done
    > - while true; do
    > iptables -F OUTPUT; mount -t cifs -a;
    > for _ in {0..2}; do ls /mnt/test/subdir/ | wc -l; done;
    > iptables -I OUTPUT -p tcp --dport 445 -j DROP;
    > sleep 10
    > echo &quot;unmounting&quot;; umount -l -t cifs -a; echo &quot;done unmounting&quot;;
    > sleep 20
    > echo &quot;recovering&quot;; iptables -F OUTPUT;
    > sleep 10;
    > done
    > Fixes: ebe98f1447bb (&quot;cifs: enable caching of directories for which a lease is held&quot;)
    > Fixes: 5c86919455c1 (&quot;smb: client: fix use-after-free in smb2_query_info_compound()&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Paul Aurich &lt;paul@darkrain42.org&gt;
    > Signed-off-by: Steve French &lt;stfrench@microsoft.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ smb: client: fix use-after-free of signing key (@Paulo Alcantara in [0e2b654a3848bf9](https://github.com/sophgo/linux-riscv/commit/0e2b654a3848bf9) at 2024-12-05 13:02:59)
    > commit 343d7fe6df9e247671440a932b6a73af4fa86d95 upstream.
    > Customers have reported use-after-free in @ses-&gt;auth_key.response with
    > SMB2.1 + sign mounts which occurs due to following race:
    > task A                         task B
    > cifs_mount()
    > dfs_mount_share()
    > get_session()
    > cifs_mount_get_session()    cifs_send_recv()
    > cifs_get_smb_ses()          compound_send_recv()
    > cifs_setup_session()        smb2_setup_request()
    > kfree_sensitive()           smb2_calc_signature()
    > crypto_shash_setkey() *UAF*
    > Fix this by ensuring that we have a valid @ses-&gt;auth_key.response by
    > checking whether @ses-&gt;ses_status is SES_GOOD or SES_EXITING with
    > @ses-&gt;ses_lock held.  After commit 24a9799aa8ef (&quot;smb: client: fix UAF
    > in smb2_reconnect_server()&quot;), we made sure to call -&gt;logoff() only
    > when @ses was known to be good (e.g. valid -&gt;auth_key.response), so
    > it&#x27;s safe to access signing key when @ses-&gt;ses_status &#x3D;&#x3D; SES_EXITING.
    > Cc: stable@vger.kernel.org
    > Reported-by: Jay Shin &lt;jaeshin@redhat.com&gt;
    > Signed-off-by: Paulo Alcantara (Red Hat) &lt;pc@manguebit.com&gt;
    > Signed-off-by: Steve French &lt;stfrench@microsoft.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ ALSA: hda/realtek: fix mute/micmute LEDs don&#x27;t work for EliteBook X G1i (@Dirk Su in [0c90cb0b7fa594a](https://github.com/sophgo/linux-riscv/commit/0c90cb0b7fa594a) at 2024-12-05 13:02:59)
    > commit 7ba81e4c3aa0ca25f06dc4456e7d36fa8e76385f upstream.
    > HP EliteBook X G1i needs ALC285_FIXUP_HP_GPIO_LED quirk to
    > make mic-mute/audio-mute working.
    > Signed-off-by: Dirk Su &lt;dirk.su@canonical.com&gt;
    > Cc: &lt;stable@vger.kernel.org&gt;
    > Link: https://patch.msgid.link/20241126060531.22759-1-dirk.su@canonical.com
    > Signed-off-by: Takashi Iwai &lt;tiwai@suse.de&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ ALSA: rawmidi: Fix kvfree() call in spinlock (@Takashi Iwai in [df225df83925f87](https://github.com/sophgo/linux-riscv/commit/df225df83925f87) at 2024-12-05 13:02:58)
    > commit 20c0c49720dc4e205d4c1d64add56a5043c5ec5f upstream.
    > At the conversion of locking with guard(), I overlooked that kvfree()
    > must not be called inside the spinlock unlike kfree(), and this was
    > caught by syzkaller now.
    > This patch reverts the conversion partially for restoring the kvfree()
    > call outside the spinlock.  It&#x27;s not trivial to use guard() in this
    > context, unfortunately.
    > Fixes: 84bb065b316e (&quot;ALSA: rawmidi: Use guard() for locking&quot;)
    > Reported-by: syzbot+351f8764833934c68836@syzkaller.appspotmail.com
    > Reported-by: Eric Dumazet &lt;eric.dumazet@gmail.com&gt;
    > Closes: https://lore.kernel.org/6744737b.050a0220.1cc393.007e.GAE@google.com
    > Cc: &lt;stable@vger.kernel.org&gt;
    > Link: https://patch.msgid.link/20241125142041.16578-1-tiwai@suse.de
    > Signed-off-by: Takashi Iwai &lt;tiwai@suse.de&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ ALSA: hda/realtek: Set PCBeep to default value for ALC274 (@Kailang Yang in [add3ab2485aca27](https://github.com/sophgo/linux-riscv/commit/add3ab2485aca27) at 2024-12-05 13:02:58)
    > commit 155699ccab7c78cbba69798242b68bc8ac66d5d2 upstream.
    > BIOS Enable PC beep path cause pop noise via speaker during boot time.
    > Set to default value from driver will solve the issue.
    > Signed-off-by: Kailang Yang &lt;kailang@realtek.com&gt;
    > Cc: &lt;stable@vger.kernel.org&gt;
    > Link: https://lore.kernel.org/2721bb57e20a44c3826c473e933f9105@realtek.com
    > Signed-off-by: Takashi Iwai &lt;tiwai@suse.de&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ ALSA: ump: Fix evaluation of MIDI 1.0 FB info (@Takashi Iwai in [acd3e1859e9a940](https://github.com/sophgo/linux-riscv/commit/acd3e1859e9a940) at 2024-12-05 13:02:58)
    > commit 7be34f6feedd60e418de1c2c48e661d70416635f upstream.
    > The m1.0 field of UMP Function Block info specifies whether the given
    > FB is a MIDI 1.0 port or not.  When implementing the UMP support on
    > Linux, I somehow interpreted as if it were bit flags, but the field is
    > actually an enumeration from 0 to 2, where 2 means MIDI 1.0 *and* low
    > speed.
    > This patch corrects the interpretation and sets the right bit flags
    > depending on the m1.0 field of FB Info.  This effectively fixes the
    > missing detection of MIDI 1.0 FB when m1.0 is 2.
    > Fixes: 37e0e14128e0 (&quot;ALSA: ump: Support UMP Endpoint and Function Block parsing&quot;)
    > Cc: &lt;stable@vger.kernel.org&gt;
    > Link: https://patch.msgid.link/20241127070059.8099-1-tiwai@suse.de
    > Signed-off-by: Takashi Iwai &lt;tiwai@suse.de&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ ALSA: hda/realtek: Enable speaker pins for Medion E15443 platform (@Kailang Yang in [98b5ade3a44d8f6](https://github.com/sophgo/linux-riscv/commit/98b5ade3a44d8f6) at 2024-12-05 13:02:58)
    > commit 31917b7bd892de730ab67b215c62aeeea778112e upstream.
    > Speaker has no sound for Medion E15443.
    > Added another speaker pins for Medion E15443 platform.
    > Signed-off-by: Kailang Yang &lt;kailang@realtek.com&gt;
    > Cc: &lt;stable@vger.kernel.org&gt;
    > Link: https://lore.kernel.org/eac4f3aca2ab45e59ccd207a90ee60e9@realtek.com
    > Signed-off-by: Takashi Iwai &lt;tiwai@suse.de&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ ALSA: hda/realtek: Fix Internal Speaker and Mic boost of Infinix Y4 Max (@Dinesh Kumar in [409e6297ca3498f](https://github.com/sophgo/linux-riscv/commit/409e6297ca3498f) at 2024-12-05 13:02:58)
    > commit 5ebe792a5139f1ce6e4aed22bef12e7e2660df96 upstream.
    > Internal Speaker of Infinix Y4 Max remains muted due to incorrect
    > Pin configuration, and the Internal Mic records high noise. This patch
    > corrects the Pin configuration for the Internal Speaker and limits
    > the Internal Mic boost.
    > HW Probe for device: https://linux-hardware.org/?probe&#x3D;6d4386c347
    > Test: Internal Speaker works fine, Mic has low noise.
    > Signed-off-by: Dinesh Kumar &lt;desikumar81@gmail.com&gt;
    > Cc: &lt;stable@vger.kernel.org&gt;
    > Link: https://patch.msgid.link/20241125092842.13208-1-desikumar81@gmail.com
    > Signed-off-by: Takashi Iwai &lt;tiwai@suse.de&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ ALSA: pcm: Add sanity NULL check for the default mmap fault handler (@Takashi Iwai in [0c4c9bf5eab7bee](https://github.com/sophgo/linux-riscv/commit/0c4c9bf5eab7bee) at 2024-12-05 13:02:58)
    > commit d2913a07d9037fe7aed4b7e680684163eaed6bc4 upstream.
    > A driver might allow the mmap access before initializing its
    > runtime-&gt;dma_area properly.  Add a proper NULL check before passing to
    > virt_to_page() for avoiding a panic.
    > Reported-by: syzbot+4bf62a7b1d0f4fdb7ae2@syzkaller.appspotmail.com
    > Cc: &lt;stable@vger.kernel.org&gt;
    > Link: https://patch.msgid.link/20241120141104.7060-1-tiwai@suse.de
    > Signed-off-by: Takashi Iwai &lt;tiwai@suse.de&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ ALSA: hda/realtek: Update ALC225 depop procedure (@Kailang Yang in [010135da59ee7c3](https://github.com/sophgo/linux-riscv/commit/010135da59ee7c3) at 2024-12-05 13:02:58)
    > commit 1fd50509fe14a9adc9329e0454b986157a4c155a upstream.
    > Old procedure has a chance to meet Headphone no output.
    > Fixes: da911b1f5e98 (&quot;ALSA: hda/realtek - update ALC225 depop optimize&quot;)
    > Signed-off-by: Kailang Yang &lt;kailang@realtek.com&gt;
    > Cc: &lt;stable@vger.kernel.org&gt;
    > Link: https://lore.kernel.org/5a27b016ba9d42b4a4e6dadce50a3ba4@realtek.com
    > Signed-off-by: Takashi Iwai &lt;tiwai@suse.de&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ soc: fsl: rcpm: fix missing of_node_put() in copy_ippdexpcr1_setting() (@Javier Carrasco in [e8351aa0d5bcfa3](https://github.com/sophgo/linux-riscv/commit/e8351aa0d5bcfa3) at 2024-12-05 13:02:57)
    > commit c9f1efabf8e3b3ff886a42669f7093789dbeca94 upstream.
    > of_find_compatible_node() requires a call to of_node_put() when the
    > pointer to the node is not required anymore to decrement its refcount
    > and avoid leaking memory.
    > Add the missing call to of_node_put() after the node has been used.
    > Cc: stable@vger.kernel.org
    > Fixes: e95f287deed2 (&quot;soc: fsl: handle RCPM errata A-008646 on SoC LS1021A&quot;)
    > Signed-off-by: Javier Carrasco &lt;javier.carrasco.cruz@gmail.com&gt;
    > Link: https://lore.kernel.org/r/20241013-rcpm-of_node_put-v1-1-9a8e55a01eae@gmail.com
    > Signed-off-by: Christophe Leroy &lt;christophe.leroy@csgroup.eu&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ x86/microcode/AMD: Flush patch buffer mapping after application (@Borislav Petkov (AMD) in [dbdec47842bb784](https://github.com/sophgo/linux-riscv/commit/dbdec47842bb784) at 2024-12-05 13:02:57)
    > commit c809b0d0e52d01c30066367b2952c4c4186b1047 upstream.
    > Due to specific requirements while applying microcode patches on Zen1
    > and 2, the patch buffer mapping needs to be flushed from the TLB after
    > application. Do so.
    > If not, unnecessary and unnatural delays happen in the boot process.
    > Reported-by: Thomas De Schampheleire &lt;thomas.de_schampheleire@nokia.com&gt;
    > Signed-off-by: Borislav Petkov (AMD) &lt;bp@alien8.de&gt;
    > Tested-by: Thomas De Schampheleire &lt;thomas.de_schampheleire@nokia.com&gt;
    > Cc: &lt;stable@kernel.org&gt; # f1d84b59cbb9 (&quot;x86/mm: Carve out INVLPG inline asm for use by others&quot;)
    > Link: https://lore.kernel.org/r/ZyulbYuvrkshfsd2@antipodes
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ media: v4l2-core: v4l2-dv-timings: check cvt/gtf result (@Hans Verkuil in [74be6d7ddcf6913](https://github.com/sophgo/linux-riscv/commit/74be6d7ddcf6913) at 2024-12-05 13:02:57)
    > commit 9f070b1862f3411b8bcdfd51a8eaad25286f9deb upstream.
    > The v4l2_detect_cvt/gtf functions should check the result against the
    > timing capabilities: these functions calculate the timings, so if they
    > are out of bounds, they should be rejected.
    > To do this, add the struct v4l2_dv_timings_cap as argument to those
    > functions.
    > This required updates to the adv7604 and adv7842 drivers since the
    > prototype of these functions has now changed. The timings struct
    > that is passed to v4l2_detect_cvt/gtf in those two drivers is filled
    > with the timings detected by the hardware.
    > The vivid driver was also updated, but an additional check was added:
    > the width and height specified by VIDIOC_S_DV_TIMINGS has to match the
    > calculated result, otherwise something went wrong. Note that vivid
    > emulates* hardware, so all the values passed to the v4l2_detect_cvt/gtf
    > functions came from the timings struct that was filled by userspace
    > and passed on to the driver via VIDIOC_S_DV_TIMINGS. So these fields
    > can contain random data. Both the constraints check via
    > struct v4l2_dv_timings_cap and the additional width/height check
    > ensure that the resulting timings are sane and not messed up by the
    > v4l2_detect_cvt/gtf calculations.
    > Signed-off-by: Hans Verkuil &lt;hverkuil@xs4all.nl&gt;
    > Fixes: 2576415846bc (&quot;[media] v4l2: move dv-timings related code to v4l2-dv-timings.c&quot;)
    > Cc: stable@vger.kernel.org
    > Reported-by: syzbot+a828133770f62293563e@syzkaller.appspotmail.com
    > Closes: https://lore.kernel.org/linux-media/000000000000013050062127830a@google.com/
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ soc: fsl: cpm1: qmc: Set the ret error code on platform_get_irq() failure (@Herve Codina in [7168d14c2d2c982](https://github.com/sophgo/linux-riscv/commit/7168d14c2d2c982) at 2024-12-05 13:02:57)
    > commit cb3daa51db819a172e9524e96e2ed96b4237e51a upstream.
    > A kernel test robot detected a missing error code:
    > qmc.c:1942 qmc_probe() warn: missing error code &#x27;ret&#x27;
    > Indeed, the error returned by platform_get_irq() is checked and the
    > operation is aborted in case of failure but the ret error code is
    > not set in that case.
    > Set the ret error code.
    > Reported-by: kernel test robot &lt;lkp@intel.com&gt;
    > Reported-by: Dan Carpenter &lt;dan.carpenter@linaro.org&gt;
    > Closes: https://lore.kernel.org/r/202411051350.KNy6ZIWA-lkp@intel.com/
    > Fixes: 3178d58e0b97 (&quot;soc: fsl: cpm1: Add support for QMC&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Herve Codina &lt;herve.codina@bootlin.com&gt;
    > Link: https://lore.kernel.org/r/20241105145623.401528-1-herve.codina@bootlin.com
    > Signed-off-by: Christophe Leroy &lt;christophe.leroy@csgroup.eu&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ netdev-genl: Hold rcu_read_lock in napi_get (@Joe Damato in [343e3e903ce950a](https://github.com/sophgo/linux-riscv/commit/343e3e903ce950a) at 2024-12-05 13:02:57)
    > commit c53bf100f68619acf6cedcf4cf5249a1ca2db0b4 upstream.
    > Hold rcu_read_lock in netdev_nl_napi_get_doit, which calls napi_by_id
    > and is required to be called under rcu_read_lock.
    > Cc: stable@vger.kernel.org
    > Fixes: 27f91aaf49b3 (&quot;netdev-genl: Add netlink framework functions for napi&quot;)
    > Signed-off-by: Joe Damato &lt;jdamato@fastly.com&gt;
    > Link: https://patch.msgid.link/20241114175157.16604-1-jdamato@fastly.com
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ x86/mm: Carve out INVLPG inline asm for use by others (@Borislav Petkov (AMD) in [12d616419929aa0](https://github.com/sophgo/linux-riscv/commit/12d616419929aa0) at 2024-12-05 13:02:57)
    > commit f1d84b59cbb9547c243d93991acf187fdbe9fbe9 upstream.
    > No functional changes.
    > Signed-off-by: Borislav Petkov (AMD) &lt;bp@alien8.de&gt;
    > Link: https://lore.kernel.org/r/ZyulbYuvrkshfsd2@antipodes
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ gve: Flow steering trigger reset only for timeout error (@Ziwei Xiao in [caa629d2e31d256](https://github.com/sophgo/linux-riscv/commit/caa629d2e31d256) at 2024-12-05 13:02:56)
    > commit 8ffade77b6337a8767fae9820d57d7a6413dd1a1 upstream.
    > When configuring flow steering rules, the driver is currently going
    > through a reset for all errors from the device. Instead, the driver
    > should only reset when there&#x27;s a timeout error from the device.
    > Fixes: 57718b60df9b (&quot;gve: Add flow steering adminq commands&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Ziwei Xiao &lt;ziweixiao@google.com&gt;
    > Signed-off-by: Jeroen de Borst &lt;jeroendb@google.com&gt;
    > Reviewed-by: Harshitha Ramamurthy &lt;hramamurthy@google.com&gt;
    > Reviewed-by: Simon Horman &lt;horms@kernel.org&gt;
    > Link: https://patch.msgid.link/20241113175930.2585680-1-jeroendb@google.com
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ arm64: dts: mediatek: mt8186-corsola-voltorb: Merge speaker codec nodes (@Chen-Yu Tsai in [b6a1ba1915dfff7](https://github.com/sophgo/linux-riscv/commit/b6a1ba1915dfff7) at 2024-12-05 13:02:56)
    > commit 26ea2459d1724406bf0b342df6b4b1f002d7f8e3 upstream.
    > The Voltorb device uses a speaker codec different from the original
    > Corsola device. When the Voltorb device tree was first added, the new
    > codec was added as a separate node when it should have just replaced the
    > existing one.
    > Merge the two nodes. The only differences are the compatible string and
    > the GPIO line property name. This keeps the device node path for the
    > speaker codec the same across the MT8186 Chromebook line. Also rename
    > the related labels and node names from having rt1019p to speaker codec.
    > Cc: stable@vger.kernel.org # v6.11+
    > Signed-off-by: Chen-Yu Tsai &lt;wenst@chromium.org&gt;
    > Reviewed-by: AngeloGioacchino Del Regno &lt;angelogioacchino.delregno@collabora.com&gt;
    > Link: https://lore.kernel.org/r/20241018082113.1297268-1-wenst@chromium.org
    > Signed-off-by: AngeloGioacchino Del Regno &lt;angelogioacchino.delregno@collabora.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ blk-mq: Make blk_mq_quiesce_tagset() hold the tag list mutex less long (@Bart Van Assche in [aeb420ebdff41d6](https://github.com/sophgo/linux-riscv/commit/aeb420ebdff41d6) at 2024-12-05 13:02:56)
    > commit ccd9e252c515ac5a3ed04a414c95d1307d17f159 upstream.
    > Make sure that the tag_list_lock mutex is not held any longer than
    > necessary. This change reduces latency if e.g. blk_mq_quiesce_tagset()
    > is called concurrently from more than one thread. This function is used
    > by the NVMe core and also by the UFS driver.
    > Reported-by: Peter Wang &lt;peter.wang@mediatek.com&gt;
    > Cc: Chao Leng &lt;lengchao@huawei.com&gt;
    > Cc: Ming Lei &lt;ming.lei@redhat.com&gt;
    > Cc: stable@vger.kernel.org
    > Fixes: 414dd48e882c (&quot;blk-mq: add tagset quiesce interface&quot;)
    > Signed-off-by: Bart Van Assche &lt;bvanassche@acm.org&gt;
    > Reviewed-by: Keith Busch &lt;kbusch@kernel.org&gt;
    > Link: https://lore.kernel.org/r/20241022181617.2716173-1-bvanassche@acm.org
    > Signed-off-by: Jens Axboe &lt;axboe@kernel.dk&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ i40e: Fix handling changed priv flags (@Peter Große in [8e04747ffc0c64f](https://github.com/sophgo/linux-riscv/commit/8e04747ffc0c64f) at 2024-12-05 13:02:56)
    > commit ea301aec8bb718b02b68761d2229fc12c9fefa29 upstream.
    > After assembling the new private flags on a PF, the operation to determine
    > the changed flags uses the wrong bitmaps. Instead of xor-ing orig_flags
    > with new_flags, it uses the still unchanged pf-&gt;flags, thus changed_flags
    > is always 0.
    > Fix it by using the correct bitmaps.
    > The issue was discovered while debugging why disabling source pruning
    > stopped working with release 6.7. Although the new flags will be copied to
    > pf-&gt;flags later on in that function, disabling source pruning requires
    > a reset of the PF, which was skipped due to this bug.
    > Disabling source pruning:
    > $ sudo ethtool --set-priv-flags eno1 disable-source-pruning on
    > $ sudo ethtool --show-priv-flags eno1
    > Private flags for eno1:
    > MFP                   : off
    > total-port-shutdown   : off
    > LinkPolling           : off
    > flow-director-atr     : on
    > veb-stats             : off
    > hw-atr-eviction       : off
    > link-down-on-close    : off
    > legacy-rx             : off
    > disable-source-pruning: on
    > disable-fw-lldp       : off
    > rs-fec                : off
    > base-r-fec            : off
    > vf-vlan-pruning       : off
    > Regarding reproducing:
    > I observed the issue with a rather complicated lab setup, where
    > two VLAN interfaces are created on eno1
    > each with a different MAC address assigned
    > each moved into a separate namespace
    > both VLANs are bridged externally, so they form a single layer 2 network
    > The external bridge is done via a channel emulator adding packet loss and
    > delay and the application in the namespaces tries to send/receive traffic
    > and measure the performance. Sender and receiver are separated by
    > namespaces, yet the network card &quot;sees its own traffic&quot; send back to it.
    > To make that work, source pruning has to be disabled.
    > Cc: stable@vger.kernel.org
    > Fixes: 70756d0a4727 (&quot;i40e: Use DECLARE_BITMAP for flags and hw_features fields in i40e_pf&quot;)
    > Signed-off-by: Peter Große &lt;pegro@friiks.de&gt;
    > Reviewed-by: Paul Menzel &lt;pmenzel@molgen.mpg.de&gt;
    > Reviewed-by: Przemek Kitszel &lt;przemyslaw.kitszel@intel.com&gt;
    > Tested-by: Pucha Himasekhar Reddy &lt;himasekharx.reddy.pucha@intel.com&gt; (A Contingent worker at Intel)
    > Signed-off-by: Tony Nguyen &lt;anthony.l.nguyen@intel.com&gt;
    > Link: https://patch.msgid.link/20241113210705.1296408-1-anthony.l.nguyen@intel.com
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ media: wl128x: Fix atomicity violation in fmc_send_cmd() (@Qiu-ji Chen in [80a3b2ee01eecf2](https://github.com/sophgo/linux-riscv/commit/80a3b2ee01eecf2) at 2024-12-05 13:02:56)
    > commit ca59f9956d4519ab18ab2270be47c6b8c6ced091 upstream.
    > Atomicity violation occurs when the fmc_send_cmd() function is executed
    > simultaneously with the modification of the fmdev-&gt;resp_skb value.
    > Consider a scenario where, after passing the validity check within the
    > function, a non-null fmdev-&gt;resp_skb variable is assigned a null value.
    > This results in an invalid fmdev-&gt;resp_skb variable passing the validity
    > check. As seen in the later part of the function, skb &#x3D; fmdev-&gt;resp_skb;
    > when the invalid fmdev-&gt;resp_skb passes the check, a null pointer
    > dereference error may occur at line 478, evt_hdr &#x3D; (void *)skb-&gt;data;
    > To address this issue, it is recommended to include the validity check of
    > fmdev-&gt;resp_skb within the locked section of the function. This
    > modification ensures that the value of fmdev-&gt;resp_skb does not change
    > during the validation process, thereby maintaining its validity.
    > This possible bug is found by an experimental static analysis tool
    > developed by our team. This tool analyzes the locking APIs
    > to extract function pairs that can be concurrently executed, and then
    > analyzes the instructions in the paired functions to identify possible
    > concurrency bugs including data races and atomicity violations.
    > Fixes: e8454ff7b9a4 (&quot;[media] drivers:media:radio: wl128x: FM Driver Common sources&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Qiu-ji Chen &lt;chenqiuji666@gmail.com&gt;
    > Signed-off-by: Hans Verkuil &lt;hverkuil-cisco@xs4all.nl&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ media: intel/ipu6: do not handle interrupts when device is disabled (@Stanislaw Gruszka in [57241487a364851](https://github.com/sophgo/linux-riscv/commit/57241487a364851) at 2024-12-05 13:02:56)
    > commit 1429826883bb18847092b2e04c6598ef34bae1d4 upstream.
    > Some IPU6 devices have shared interrupts. We need to handle properly
    > case when interrupt is triggered from other device on shared irq line
    > and IPU6 itself disabled. In such case we get 0xffffffff from
    > ISR_STATUS register and handle all irq&#x27;s cases, for what we are not
    > not prepared and usually hang the whole system.
    > To avoid the issue use pm_runtime_get_if_active() to check if
    > the device is enabled and prevent suspending it when we handle irq
    > until the end of irq. Additionally use synchronize_irq() in suspend
    > Fixes: ab29a2478e70 (&quot;media: intel/ipu6: add IPU6 buttress interface driver&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Stanislaw Gruszka &lt;stanislaw.gruszka@linux.intel.com&gt;
    > Reviewed-by: Hans de Goede &lt;hdegoede@redhat.com&gt;
    > Tested-by: Hans de Goede &lt;hdegoede@redhat.com&gt; # ThinkPad X1 Yoga Gen 8, ov2740
    > Signed-off-by: Sakari Ailus &lt;sakari.ailus@linux.intel.com&gt;
    > Signed-off-by: Hans Verkuil &lt;hverkuil@xs4all.nl&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ HID: wacom: Interpret tilt data from Intuos Pro BT as signed values (@Jason Gerecke in [28d4191e1978ac3](https://github.com/sophgo/linux-riscv/commit/28d4191e1978ac3) at 2024-12-05 13:02:56)
    > commit 49a397ad24ee5e2c53a59dada2780d7e71bd3f77 upstream.
    > The tilt data contained in the Bluetooth packets of an Intuos Pro are
    > supposed to be interpreted as signed values. Simply casting the values
    > to type &#x60;char&#x60; is not guaranteed to work since it is implementation-
    > defined whether it is signed or unsigned. At least one user has noticed
    > the data being reported incorrectly on their system. To ensure that the
    > data is interpreted properly, we specifically cast to &#x60;signed char&#x60;
    > instead.
    > Link: https://github.com/linuxwacom/input-wacom/issues/445
    > Fixes: 4922cd26f03c (&quot;HID: wacom: Support 2nd-gen Intuos Pro&#x27;s Bluetooth classic interface&quot;)
    > CC: stable@vger.kernel.org # 4.11+
    > Signed-off-by: Jason Gerecke &lt;jason.gerecke@wacom.com&gt;
    > Signed-off-by: Jiri Kosina &lt;jkosina@suse.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ arm64: tls: Fix context-switching of tpidrro_el0 when kpti is enabled (@Will Deacon in [e4d1f38bc0ec1b8](https://github.com/sophgo/linux-riscv/commit/e4d1f38bc0ec1b8) at 2024-12-05 13:02:55)
    > commit 67ab51cbdfee02ef07fb9d7d14cc0bf6cb5a5e5c upstream.
    > Commit 18011eac28c7 (&quot;arm64: tls: Avoid unconditional zeroing of
    > tpidrro_el0 for native tasks&quot;) tried to optimise the context switching
    > of tpidrro_el0 by eliding the clearing of the register when switching
    > to a native task with kpti enabled, on the erroneous assumption that
    > the kpti trampoline entry code would already have taken care of the
    > write.
    > Although the kpti trampoline does zero the register on entry from a
    > native task, the check in tls_thread_switch() is on the *next* task and
    > so we can end up leaving a stale, non-zero value in the register if the
    > previous task was 32-bit.
    > Drop the broken optimisation and zero tpidrro_el0 unconditionally when
    > switching to a native 64-bit task.
    > Cc: Mark Rutland &lt;mark.rutland@arm.com&gt;
    > Cc: stable@vger.kernel.org
    > Fixes: 18011eac28c7 (&quot;arm64: tls: Avoid unconditional zeroing of tpidrro_el0 for native tasks&quot;)
    > Signed-off-by: Will Deacon &lt;will@kernel.org&gt;
    > Acked-by: Mark Rutland &lt;mark.rutland@arm.com&gt;
    > Link: https://lore.kernel.org/r/20241114095332.23391-1-will@kernel.org
    > Signed-off-by: Catalin Marinas &lt;catalin.marinas@arm.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ block: fix missing dispatching request when queue is started or unquiesced (@Muchun Song in [8b25c0a165dd20c](https://github.com/sophgo/linux-riscv/commit/8b25c0a165dd20c) at 2024-12-05 13:02:55)
    > commit 2003ee8a9aa14d766b06088156978d53c2e9be3d upstream.
    > Supposing the following scenario with a virtio_blk driver.
    > CPU0                    CPU1                    CPU2
    > blk_mq_try_issue_directly()
    > __blk_mq_issue_directly()
    > q-&gt;mq_ops-&gt;queue_rq()
    > virtio_queue_rq()
    > blk_mq_stop_hw_queue()
    > virtblk_done()
    > blk_mq_try_issue_directly()
    > if (blk_mq_hctx_stopped())
    > blk_mq_request_bypass_insert()                  blk_mq_run_hw_queue()
    > blk_mq_run_hw_queue()     blk_mq_run_hw_queue()
    > blk_mq_insert_request()
    > return
    > After CPU0 has marked the queue as stopped, CPU1 will see the queue is
    > stopped. But before CPU1 puts the request on the dispatch list, CPU2
    > receives the interrupt of completion of request, so it will run the
    > hardware queue and marks the queue as non-stopped. Meanwhile, CPU1 also
    > runs the same hardware queue. After both CPU1 and CPU2 complete
    > blk_mq_run_hw_queue(), CPU1 just puts the request to the same hardware
    > queue and returns. It misses dispatching a request. Fix it by running
    > the hardware queue explicitly. And blk_mq_request_issue_directly()
    > should handle a similar situation. Fix it as well.
    > Fixes: d964f04a8fde (&quot;blk-mq: fix direct issue&quot;)
    > Cc: stable@vger.kernel.org
    > Cc: Muchun Song &lt;muchun.song@linux.dev&gt;
    > Signed-off-by: Muchun Song &lt;songmuchun@bytedance.com&gt;
    > Reviewed-by: Ming Lei &lt;ming.lei@redhat.com&gt;
    > Link: https://lore.kernel.org/r/20241014092934.53630-2-songmuchun@bytedance.com
    > Signed-off-by: Jens Axboe &lt;axboe@kernel.dk&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ sh: cpuinfo: Fix a warning for CONFIG_CPUMASK_OFFSTACK (@Huacai Chen in [701e32900683378](https://github.com/sophgo/linux-riscv/commit/701e32900683378) at 2024-12-05 13:02:55)
    > commit 3c891f7c6a4e90bb1199497552f24b26e46383bc upstream.
    > When CONFIG_CPUMASK_OFFSTACK and CONFIG_DEBUG_PER_CPU_MAPS are selected,
    > cpu_max_bits_warn() generates a runtime warning similar as below when
    > showing /proc/cpuinfo. Fix this by using nr_cpu_ids (the runtime limit)
    > instead of NR_CPUS to iterate CPUs.
    > [    3.052463] ------------[ cut here ]------------
    > [    3.059679] WARNING: CPU: 3 PID: 1 at include/linux/cpumask.h:108 show_cpuinfo+0x5e8/0x5f0
    > [    3.070072] Modules linked in: efivarfs autofs4
    > [    3.076257] CPU: 0 PID: 1 Comm: systemd Not tainted 5.19-rc5+ #1052
    > [    3.099465] Stack : 9000000100157b08 9000000000f18530 9000000000cf846c 9000000100154000
    > [    3.109127]         9000000100157a50 0000000000000000 9000000100157a58 9000000000ef7430
    > [    3.118774]         90000001001578e8 0000000000000040 0000000000000020 ffffffffffffffff
    > [    3.128412]         0000000000aaaaaa 1ab25f00eec96a37 900000010021de80 900000000101c890
    > [    3.138056]         0000000000000000 0000000000000000 0000000000000000 0000000000aaaaaa
    > [    3.147711]         ffff8000339dc220 0000000000000001 0000000006ab4000 0000000000000000
    > [    3.157364]         900000000101c998 0000000000000004 9000000000ef7430 0000000000000000
    > [    3.167012]         0000000000000009 000000000000006c 0000000000000000 0000000000000000
    > [    3.176641]         9000000000d3de08 9000000001639390 90000000002086d8 00007ffff0080286
    > [    3.186260]         00000000000000b0 0000000000000004 0000000000000000 0000000000071c1c
    > [    3.195868]         ...
    > [    3.199917] Call Trace:
    > [    3.203941] [&lt;90000000002086d8&gt;] show_stack+0x38/0x14c
    > [    3.210666] [&lt;9000000000cf846c&gt;] dump_stack_lvl+0x60/0x88
    > [    3.217625] [&lt;900000000023d268&gt;] __warn+0xd0/0x100
    > [    3.223958] [&lt;9000000000cf3c90&gt;] warn_slowpath_fmt+0x7c/0xcc
    > [    3.231150] [&lt;9000000000210220&gt;] show_cpuinfo+0x5e8/0x5f0
    > [    3.238080] [&lt;90000000004f578c&gt;] seq_read_iter+0x354/0x4b4
    > [    3.245098] [&lt;90000000004c2e90&gt;] new_sync_read+0x17c/0x1c4
    > [    3.252114] [&lt;90000000004c5174&gt;] vfs_read+0x138/0x1d0
    > [    3.258694] [&lt;90000000004c55f8&gt;] ksys_read+0x70/0x100
    > [    3.265265] [&lt;9000000000cfde9c&gt;] do_syscall+0x7c/0x94
    > [    3.271820] [&lt;9000000000202fe4&gt;] handle_syscall+0xc4/0x160
    > [    3.281824] ---[ end trace 8b484262b4b8c24c ]---
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Huacai Chen &lt;chenhuacai@loongson.cn&gt;
    > Reviewed-by: John Paul Adrian Glaubitz &lt;glaubitz@physik.fu-berlin.de&gt;
    > Tested-by: John Paul Adrian Glaubitz &lt;glaubitz@physik.fu-berlin.de&gt;
    > Signed-off-by: John Paul Adrian Glaubitz &lt;glaubitz@physik.fu-berlin.de&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ ublk: fix ublk_ch_mmap() for 64K page size (@Ming Lei in [4ef8b6f7c4f19ee](https://github.com/sophgo/linux-riscv/commit/4ef8b6f7c4f19ee) at 2024-12-05 13:02:55)
    > commit d369735e02ef122d19d4c3d093028da0eb400636 upstream.
    > In ublk_ch_mmap(), queue id is calculated in the following way:
    > (vma-&gt;vm_pgoff &lt;&lt; PAGE_SHIFT) / &#x60;max_cmd_buf_size&#x60;
    > &#x27;max_cmd_buf_size&#x27; is equal to
    > &#x60;UBLK_MAX_QUEUE_DEPTH * sizeof(struct ublksrv_io_desc)&#x60;
    > and UBLK_MAX_QUEUE_DEPTH is 4096 and part of UAPI, so &#x27;max_cmd_buf_size&#x27;
    > is always page aligned in 4K page size kernel. However, it isn&#x27;t true in
    > 64K page size kernel.
    > Fixes the issue by always rounding up &#x27;max_cmd_buf_size&#x27; with PAGE_SIZE.
    > Cc: stable@vger.kernel.org
    > Fixes: 71f28f3136af (&quot;ublk_drv: add io_uring based userspace block driver&quot;)
    > Signed-off-by: Ming Lei &lt;ming.lei@redhat.com&gt;
    > Link: https://lore.kernel.org/r/20241111110718.1394001-1-ming.lei@redhat.com
    > Signed-off-by: Jens Axboe &lt;axboe@kernel.dk&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ block: fix ordering between checking BLK_MQ_S_STOPPED request adding (@Muchun Song in [4170346747d141a](https://github.com/sophgo/linux-riscv/commit/4170346747d141a) at 2024-12-05 13:02:55)
    > commit 96a9fe64bfd486ebeeacf1e6011801ffe89dae18 upstream.
    > Supposing first scenario with a virtio_blk driver.
    > CPU0                        CPU1
    > blk_mq_try_issue_directly()
    > __blk_mq_issue_directly()
    > q-&gt;mq_ops-&gt;queue_rq()
    > virtio_queue_rq()
    > blk_mq_stop_hw_queue()
    > virtblk_done()
    > blk_mq_request_bypass_insert()  1) store
    > blk_mq_start_stopped_hw_queue()
    > clear_bit(BLK_MQ_S_STOPPED)       3) store
    > blk_mq_run_hw_queue()
    > if (!blk_mq_hctx_has_pending()) 4) load
    > return
    > blk_mq_sched_dispatch_requests()
    > blk_mq_run_hw_queue()
    > if (!blk_mq_hctx_has_pending())
    > return
    > blk_mq_sched_dispatch_requests()
    > if (blk_mq_hctx_stopped())  2) load
    > return
    > __blk_mq_sched_dispatch_requests()
    > Supposing another scenario.
    > CPU0                        CPU1
    > blk_mq_requeue_work()
    > blk_mq_insert_request() 1) store
    > virtblk_done()
    > blk_mq_start_stopped_hw_queue()
    > blk_mq_run_hw_queues()        clear_bit(BLK_MQ_S_STOPPED)       3) store
    > blk_mq_run_hw_queue()
    > if (!blk_mq_hctx_has_pending()) 4) load
    > return
    > blk_mq_sched_dispatch_requests()
    > if (blk_mq_hctx_stopped())  2) load
    > continue
    > blk_mq_run_hw_queue()
    > Both scenarios are similar, the full memory barrier should be inserted
    > between 1) and 2), as well as between 3) and 4) to make sure that either
    > CPU0 sees BLK_MQ_S_STOPPED is cleared or CPU1 sees dispatch list.
    > Otherwise, either CPU will not rerun the hardware queue causing
    > starvation of the request.
    > The easy way to fix it is to add the essential full memory barrier into
    > helper of blk_mq_hctx_stopped(). In order to not affect the fast path
    > (hardware queue is not stopped most of the time), we only insert the
    > barrier into the slow path. Actually, only slow path needs to care about
    > missing of dispatching the request to the low-level device driver.
    > Fixes: 320ae51feed5 (&quot;blk-mq: new multi-queue block IO queueing mechanism&quot;)
    > Cc: stable@vger.kernel.org
    > Cc: Muchun Song &lt;muchun.song@linux.dev&gt;
    > Signed-off-by: Muchun Song &lt;songmuchun@bytedance.com&gt;
    > Reviewed-by: Ming Lei &lt;ming.lei@redhat.com&gt;
    > Link: https://lore.kernel.org/r/20241014092934.53630-4-songmuchun@bytedance.com
    > Signed-off-by: Jens Axboe &lt;axboe@kernel.dk&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ block: fix ordering between checking QUEUE_FLAG_QUIESCED request adding (@Muchun Song in [2094bd1b5225047](https://github.com/sophgo/linux-riscv/commit/2094bd1b5225047) at 2024-12-05 13:02:55)
    > commit 6bda857bcbb86fb9d0e54fbef93a093d51172acc upstream.
    > Supposing the following scenario.
    > CPU0                        CPU1
    > blk_mq_insert_request()     1) store
    > blk_mq_unquiesce_queue()
    > blk_queue_flag_clear()                3) store
    > blk_mq_run_hw_queues()
    > blk_mq_run_hw_queue()
    > if (!blk_mq_hctx_has_pending()) 4) load
    > return
    > blk_mq_run_hw_queue()
    > if (blk_queue_quiesced()) 2) load
    > return
    > blk_mq_sched_dispatch_requests()
    > The full memory barrier should be inserted between 1) and 2), as well as
    > between 3) and 4) to make sure that either CPU0 sees QUEUE_FLAG_QUIESCED
    > is cleared or CPU1 sees dispatch list or setting of bitmap of software
    > queue. Otherwise, either CPU will not rerun the hardware queue causing
    > starvation.
    > So the first solution is to 1) add a pair of memory barrier to fix the
    > problem, another solution is to 2) use hctx-&gt;queue-&gt;queue_lock to
    > synchronize QUEUE_FLAG_QUIESCED. Here, we chose 2) to fix it since
    > memory barrier is not easy to be maintained.
    > Fixes: f4560ffe8cec (&quot;blk-mq: use QUEUE_FLAG_QUIESCED to quiesce queue&quot;)
    > Cc: stable@vger.kernel.org
    > Cc: Muchun Song &lt;muchun.song@linux.dev&gt;
    > Signed-off-by: Muchun Song &lt;songmuchun@bytedance.com&gt;
    > Reviewed-by: Ming Lei &lt;ming.lei@redhat.com&gt;
    > Link: https://lore.kernel.org/r/20241014092934.53630-3-songmuchun@bytedance.com
    > Signed-off-by: Jens Axboe &lt;axboe@kernel.dk&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ iio: gts: Fix uninitialized symbol &#x27;ret&#x27; (@Zicheng Qu in [14d85fb8a13ef8f](https://github.com/sophgo/linux-riscv/commit/14d85fb8a13ef8f) at 2024-12-05 13:02:55)
    > commit e2fb2f89faf87b681038475d093214f4cbe12ebb upstream.
    > Initialize the variable ret at the time of declaration to prevent it from
    > being returned without a defined value. Fixes smatch warning:
    > drivers/iio/industrialio-gts-helper.c:256 gain_to_scaletables() error:
    > uninitialized symbol &#x27;ret&#x27;.
    > Cc: stable@vger.kernel.org # v6.6+
    > Fixes: 38416c28e168 (&quot;iio: light: Add gain-time-scale helpers&quot;)
    > Signed-off-by: Zicheng Qu &lt;quzicheng@huawei.com&gt;
    > Reviewed-by: Matti Vaittinen &lt;mazziesaccount@gmail.com&gt;
    > Link: https://patch.msgid.link/20241031014505.2313035-1-quzicheng@huawei.com
    > Signed-off-by: Jonathan Cameron &lt;Jonathan.Cameron@huawei.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ serial: amba-pl011: Fix RX stall when DMA is used (@Kartik Rajput in [e881c8f0a7d591b](https://github.com/sophgo/linux-riscv/commit/e881c8f0a7d591b) at 2024-12-05 13:02:54)
    > commit 2bcacc1c87acf9a8ebc17de18cb2b3cfeca547cf upstream.
    > Function pl011_throttle_rx() calls pl011_stop_rx() to disable RX, which
    > also disables the RX DMA by clearing the RXDMAE bit of the DMACR
    > register. However, to properly unthrottle RX when DMA is used, the
    > function pl011_unthrottle_rx() is expected to set the RXDMAE bit of
    > the DMACR register, which it currently lacks. This causes RX to stall
    > after the throttle API is called.
    > Set RXDMAE bit in the DMACR register while unthrottling RX if RX DMA is
    > used.
    > Fixes: 211565b10099 (&quot;serial: pl011: UPSTAT_AUTORTS requires .throttle/unthrottle&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Kartik Rajput &lt;kkartik@nvidia.com&gt;
    > Reviewed-by: Linus Walleij &lt;linus.walleij@linaro.org&gt;
    > Link: https://lore.kernel.org/r/20241113092629.60226-1-kkartik@nvidia.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ mtd: ubi: fix unreleased fwnode_handle in find_volume_fwnode() (@Javier Carrasco in [b5dc237d1989039](https://github.com/sophgo/linux-riscv/commit/b5dc237d1989039) at 2024-12-05 13:02:54)
    > commit 07593293ffabba14125c8998525adde5a832bfa3 upstream.
    > The &#x27;fw_vols&#x27; fwnode_handle initialized via
    > device_get_named_child_node() requires explicit calls to
    > fwnode_handle_put() when the variable is no longer required.
    > Add the missing calls to fwnode_handle_put() before the function
    > returns.
    > Cc: stable@vger.kernel.org
    > Fixes: 51932f9fc487 (&quot;mtd: ubi: populate ubi volume fwnode&quot;)
    > Signed-off-by: Javier Carrasco &lt;javier.carrasco.cruz@gmail.com&gt;
    > Reviewed-by: Zhihao Cheng &lt;chengzhihao1@huawei.com&gt;
    > Signed-off-by: Richard Weinberger &lt;richard@nod.at&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ serial: 8250: omap: Move pm_runtime_get_sync (@Bin Liu in [ac0e4f5f7690088](https://github.com/sophgo/linux-riscv/commit/ac0e4f5f7690088) at 2024-12-05 13:02:54)
    > commit bcc7ba668818dcadd2f1db66b39ed860a63ecf97 upstream.
    > Currently in omap_8250_shutdown, the dma-&gt;rx_running flag is
    > set to zero in omap_8250_rx_dma_flush. Next pm_runtime_get_sync
    > is called, which is a runtime resume call stack which can
    > re-set the flag. When the call omap_8250_shutdown returns, the
    > flag is expected to be UN-SET, but this is not the case. This
    > is causing issues the next time UART is re-opened and
    > omap_8250_rx_dma is called. Fix by moving pm_runtime_get_sync
    > before the omap_8250_rx_dma_flush.
    > cc: stable@vger.kernel.org
    > Fixes: 0e31c8d173ab (&quot;tty: serial: 8250_omap: add custom DMA-RX callback&quot;)
    > Signed-off-by: Bin Liu &lt;b-liu@ti.com&gt;
    > [Judith: Add commit message]
    > Signed-off-by: Judith Mendez &lt;jm@ti.com&gt;
    > Reviewed-by: Kevin Hilman &lt;khilman@baylibre.com&gt;
    > Tested-by: Kevin Hilman &lt;khilman@baylibre.com&gt;
    > Link: https://lore.kernel.org/r/20241031172315.453750-1-jm@ti.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ Revert &quot;block, bfq: merge bfq_release_process_ref() into bfq_put_cooperator()&quot; (@Zach Wade in [7baf94232651f39](https://github.com/sophgo/linux-riscv/commit/7baf94232651f39) at 2024-12-05 13:02:54)
    > commit cf5a60d971c7b59efb89927919404be655a9e35a upstream.
    > This reverts commit bc3b1e9e7c50e1de0f573eea3871db61dd4787de.
    > The bic is associated with sync_bfqq, and bfq_release_process_ref cannot
    > be put into bfq_put_cooperator.
    > kasan report:
    > [  400.347277] &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;
    > [  400.347287] BUG: KASAN: slab-use-after-free in bic_set_bfqq+0x200/0x230
    > [  400.347420] Read of size 8 at addr ffff88881cab7d60 by task dockerd/5800
    > [  400.347430]
    > [  400.347436] CPU: 24 UID: 0 PID: 5800 Comm: dockerd Kdump: loaded Tainted: G E 6.12.0 #32
    > [  400.347450] Tainted: [E]&#x3D;UNSIGNED_MODULE
    > [  400.347454] Hardware name: VMware, Inc. VMware20,1/440BX Desktop Reference Platform, BIOS VMW201.00V.20192059.B64.2207280713 07/28/2022
    > [  400.347460] Call Trace:
    > [  400.347464]  &lt;TASK&gt;
    > [  400.347468]  dump_stack_lvl+0x5d/0x80
    > [  400.347490]  print_report+0x174/0x505
    > [  400.347521]  kasan_report+0xe0/0x160
    > [  400.347541]  bic_set_bfqq+0x200/0x230
    > [  400.347549]  bfq_bic_update_cgroup+0x419/0x740
    > [  400.347560]  bfq_bio_merge+0x133/0x320
    > [  400.347584]  blk_mq_submit_bio+0x1761/0x1e20
    > [  400.347625]  __submit_bio+0x28b/0x7b0
    > [  400.347664]  submit_bio_noacct_nocheck+0x6b2/0xd30
    > [  400.347690]  iomap_readahead+0x50c/0x680
    > [  400.347731]  read_pages+0x17f/0x9c0
    > [  400.347785]  page_cache_ra_unbounded+0x366/0x4a0
    > [  400.347795]  filemap_fault+0x83d/0x2340
    > [  400.347819]  __xfs_filemap_fault+0x11a/0x7d0 [xfs]
    > [  400.349256]  __do_fault+0xf1/0x610
    > [  400.349270]  do_fault+0x977/0x11a0
    > [  400.349281]  __handle_mm_fault+0x5d1/0x850
    > [  400.349314]  handle_mm_fault+0x1f8/0x560
    > [  400.349324]  do_user_addr_fault+0x324/0x970
    > [  400.349337]  exc_page_fault+0x76/0xf0
    > [  400.349350]  asm_exc_page_fault+0x26/0x30
    > [  400.349360] RIP: 0033:0x55a480d77375
    > [  400.349384] Code: cc cc cc cc cc cc cc cc cc cc cc cc cc cc cc cc cc cc cc cc cc 49 3b 66 10 0f 86 ae 02 00 00 55 48 89 e5 48 83 ec 58 48 8b 10 &lt;83&gt; 7a 10 00 0f 84 27 02 00 00 44 0f b6 42 28 44 0f b6 4a 29 41 80
    > [  400.349392] RSP: 002b:00007f18c37fd8b8 EFLAGS: 00010216
    > [  400.349401] RAX: 00007f18c37fd9d0 RBX: 0000000000000000 RCX: 0000000000000000
    > [  400.349407] RDX: 000055a484407d38 RSI: 000000c000e8b0c0 RDI: 0000000000000000
    > [  400.349412] RBP: 00007f18c37fd910 R08: 000055a484017f60 R09: 000055a484066f80
    > [  400.349417] R10: 0000000000194000 R11: 0000000000000005 R12: 0000000000000008
    > [  400.349422] R13: 0000000000000000 R14: 000000c000476a80 R15: 0000000000000000
    > [  400.349430]  &lt;/TASK&gt;
    > [  400.349452]
    > [  400.349454] Allocated by task 5800:
    > [  400.349459]  kasan_save_stack+0x30/0x50
    > [  400.349469]  kasan_save_track+0x14/0x30
    > [  400.349475]  __kasan_slab_alloc+0x89/0x90
    > [  400.349482]  kmem_cache_alloc_node_noprof+0xdc/0x2a0
    > [  400.349492]  bfq_get_queue+0x1ef/0x1100
    > [  400.349502]  __bfq_get_bfqq_handle_split+0x11a/0x510
    > [  400.349511]  bfq_insert_requests+0xf55/0x9030
    > [  400.349519]  blk_mq_flush_plug_list+0x446/0x14c0
    > [  400.349527]  __blk_flush_plug+0x27c/0x4e0
    > [  400.349534]  blk_finish_plug+0x52/0xa0
    > [  400.349540]  _xfs_buf_ioapply+0x739/0xc30 [xfs]
    > [  400.350246]  __xfs_buf_submit+0x1b2/0x640 [xfs]
    > [  400.350967]  xfs_buf_read_map+0x306/0xa20 [xfs]
    > [  400.351672]  xfs_trans_read_buf_map+0x285/0x7d0 [xfs]
    > [  400.352386]  xfs_imap_to_bp+0x107/0x270 [xfs]
    > [  400.353077]  xfs_iget+0x70d/0x1eb0 [xfs]
    > [  400.353786]  xfs_lookup+0x2ca/0x3a0 [xfs]
    > [  400.354506]  xfs_vn_lookup+0x14e/0x1a0 [xfs]
    > [  400.355197]  __lookup_slow+0x19c/0x340
    > [  400.355204]  lookup_one_unlocked+0xfc/0x120
    > [  400.355211]  ovl_lookup_single+0x1b3/0xcf0 [overlay]
    > [  400.355255]  ovl_lookup_layer+0x316/0x490 [overlay]
    > [  400.355295]  ovl_lookup+0x844/0x1fd0 [overlay]
    > [  400.355351]  lookup_one_qstr_excl+0xef/0x150
    > [  400.355357]  do_unlinkat+0x22a/0x620
    > [  400.355366]  __x64_sys_unlinkat+0x109/0x1e0
    > [  400.355375]  do_syscall_64+0x82/0x160
    > [  400.355384]  entry_SYSCALL_64_after_hwframe+0x76/0x7e
    > [  400.355393]
    > [  400.355395] Freed by task 5800:
    > [  400.355400]  kasan_save_stack+0x30/0x50
    > [  400.355407]  kasan_save_track+0x14/0x30
    > [  400.355413]  kasan_save_free_info+0x3b/0x70
    > [  400.355422]  __kasan_slab_free+0x4f/0x70
    > [  400.355429]  kmem_cache_free+0x176/0x520
    > [  400.355438]  bfq_put_queue+0x67e/0x980
    > [  400.355447]  bfq_bic_update_cgroup+0x407/0x740
    > [  400.355454]  bfq_bio_merge+0x133/0x320
    > [  400.355460]  blk_mq_submit_bio+0x1761/0x1e20
    > [  400.355467]  __submit_bio+0x28b/0x7b0
    > [  400.355473]  submit_bio_noacct_nocheck+0x6b2/0xd30
    > [  400.355480]  iomap_readahead+0x50c/0x680
    > [  400.355490]  read_pages+0x17f/0x9c0
    > [  400.355498]  page_cache_ra_unbounded+0x366/0x4a0
    > [  400.355505]  filemap_fault+0x83d/0x2340
    > [  400.355514]  __xfs_filemap_fault+0x11a/0x7d0 [xfs]
    > [  400.356204]  __do_fault+0xf1/0x610
    > [  400.356213]  do_fault+0x977/0x11a0
    > [  400.356221]  __handle_mm_fault+0x5d1/0x850
    > [  400.356230]  handle_mm_fault+0x1f8/0x560
    > [  400.356238]  do_user_addr_fault+0x324/0x970
    > [  400.356248]  exc_page_fault+0x76/0xf0
    > [  400.356258]  asm_exc_page_fault+0x26/0x30
    > [  400.356266]
    > [  400.356269] The buggy address belongs to the object at ffff88881cab7bc0
    > which belongs to the cache bfq_queue of size 576
    > [  400.356276] The buggy address is located 416 bytes inside of
    > freed 576-byte region [ffff88881cab7bc0, ffff88881cab7e00)
    > [  400.356285]
    > [  400.356287] The buggy address belongs to the physical page:
    > [  400.356292] page: refcount:1 mapcount:0 mapping:0000000000000000 index:0xffff88881cab0b00 pfn:0x81cab0
    > [  400.356300] head: order:3 mapcount:0 entire_mapcount:0 nr_pages_mapped:0 pincount:0
    > [  400.356323] flags: 0x50000000000040(head|node&#x3D;1|zone&#x3D;2)
    > [  400.356331] page_type: f5(slab)
    > [  400.356340] raw: 0050000000000040 ffff88880a00c280 dead000000000122 0000000000000000
    > [  400.356347] raw: ffff88881cab0b00 00000000802e0025 00000001f5000000 0000000000000000
    > [  400.356354] head: 0050000000000040 ffff88880a00c280 dead000000000122 0000000000000000
    > [  400.356359] head: ffff88881cab0b00 00000000802e0025 00000001f5000000 0000000000000000
    > [  400.356365] head: 0050000000000003 ffffea002072ac01 ffffffffffffffff 0000000000000000
    > [  400.356370] head: 0000000000000008 0000000000000000 00000000ffffffff 0000000000000000
    > [  400.356378] page dumped because: kasan: bad access detected
    > [  400.356381]
    > [  400.356383] Memory state around the buggy address:
    > [  400.356387]  ffff88881cab7c00: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
    > [  400.356392]  ffff88881cab7c80: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
    > [  400.356397] &gt;ffff88881cab7d00: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
    > [  400.356400]                                                        ^
    > [  400.356405]  ffff88881cab7d80: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
    > [  400.356409]  ffff88881cab7e00: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
    > [  400.356413] &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;
    > Cc: stable@vger.kernel.org
    > Fixes: bc3b1e9e7c50 (&quot;block, bfq: merge bfq_release_process_ref() into bfq_put_cooperator()&quot;)
    > Signed-off-by: Zach Wade &lt;zachwade.k@gmail.com&gt;
    > Cc: Ding Hui &lt;dinghui@sangfor.com.cn&gt;
    > Reviewed-by: Yu Kuai &lt;yukuai3@huawei.com&gt;
    > Link: https://lore.kernel.org/r/20241119153410.2546-1-zachwade.k@gmail.com
    > Signed-off-by: Jens Axboe &lt;axboe@kernel.dk&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ block: Prevent potential deadlock in blk_revalidate_disk_zones() (@Damien Le Moal in [43375e9bb705cfb](https://github.com/sophgo/linux-riscv/commit/43375e9bb705cfb) at 2024-12-05 13:02:54)
    > commit 0b83c86b444ab467134b0e618f45ad2216a4973c upstream.
    > The function blk_revalidate_disk_zones() calls the function
    > disk_update_zone_resources() after freezing the device queue. In turn,
    > disk_update_zone_resources() calls queue_limits_start_update() which
    > takes a queue limits mutex lock, resulting in the ordering:
    > q-&gt;q_usage_counter check -&gt; q-&gt;limits_lock. However, the usual ordering
    > is to always take a queue limit lock before freezing the queue to commit
    > the limits updates, e.g., the code pattern:
    > lim &#x3D; queue_limits_start_update(q);
    > ...
    > blk_mq_freeze_queue(q);
    > ret &#x3D; queue_limits_commit_update(q, &amp;lim);
    > blk_mq_unfreeze_queue(q);
    > Thus, blk_revalidate_disk_zones() introduces a potential circular
    > locking dependency deadlock that lockdep sometimes catches with the
    > splat:
    > [   51.934109] &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;
    > [   51.935916] WARNING: possible circular locking dependency detected
    > [   51.937561] 6.12.0+ #2107 Not tainted
    > [   51.938648] ------------------------------------------------------
    > [   51.940351] kworker/u16:4/157 is trying to acquire lock:
    > [   51.941805] ffff9fff0aa0bea8 (&amp;q-&gt;limits_lock){+.+.}-{4:4}, at: disk_update_zone_resources+0x86/0x170
    > [   51.944314]
    > but task is already holding lock:
    > [   51.945688] ffff9fff0aa0b890 (&amp;q-&gt;q_usage_counter(queue)#3){++++}-{0:0}, at: blk_revalidate_disk_zones+0x15f/0x340
    > [   51.948527]
    > which lock already depends on the new lock.
    > [   51.951296]
    > the existing dependency chain (in reverse order) is:
    > [   51.953708]
    > -&gt; #1 (&amp;q-&gt;q_usage_counter(queue)#3){++++}-{0:0}:
    > [   51.956131]        blk_queue_enter+0x1c9/0x1e0
    > [   51.957290]        blk_mq_alloc_request+0x187/0x2a0
    > [   51.958365]        scsi_execute_cmd+0x78/0x490 [scsi_mod]
    > [   51.959514]        read_capacity_16+0x111/0x410 [sd_mod]
    > [   51.960693]        sd_revalidate_disk.isra.0+0x872/0x3240 [sd_mod]
    > [   51.962004]        sd_probe+0x2d7/0x520 [sd_mod]
    > [   51.962993]        really_probe+0xd5/0x330
    > [   51.963898]        __driver_probe_device+0x78/0x110
    > [   51.964925]        driver_probe_device+0x1f/0xa0
    > [   51.965916]        __driver_attach_async_helper+0x60/0xe0
    > [   51.967017]        async_run_entry_fn+0x2e/0x140
    > [   51.968004]        process_one_work+0x21f/0x5a0
    > [   51.968987]        worker_thread+0x1dc/0x3c0
    > [   51.969868]        kthread+0xe0/0x110
    > [   51.970377]        ret_from_fork+0x31/0x50
    > [   51.970983]        ret_from_fork_asm+0x11/0x20
    > [   51.971587]
    > -&gt; #0 (&amp;q-&gt;limits_lock){+.+.}-{4:4}:
    > [   51.972479]        __lock_acquire+0x1337/0x2130
    > [   51.973133]        lock_acquire+0xc5/0x2d0
    > [   51.973691]        __mutex_lock+0xda/0xcf0
    > [   51.974300]        disk_update_zone_resources+0x86/0x170
    > [   51.975032]        blk_revalidate_disk_zones+0x16c/0x340
    > [   51.975740]        sd_zbc_revalidate_zones+0x73/0x160 [sd_mod]
    > [   51.976524]        sd_revalidate_disk.isra.0+0x465/0x3240 [sd_mod]
    > [   51.977824]        sd_probe+0x2d7/0x520 [sd_mod]
    > [   51.978917]        really_probe+0xd5/0x330
    > [   51.979915]        __driver_probe_device+0x78/0x110
    > [   51.981047]        driver_probe_device+0x1f/0xa0
    > [   51.982143]        __driver_attach_async_helper+0x60/0xe0
    > [   51.983282]        async_run_entry_fn+0x2e/0x140
    > [   51.984319]        process_one_work+0x21f/0x5a0
    > [   51.985873]        worker_thread+0x1dc/0x3c0
    > [   51.987289]        kthread+0xe0/0x110
    > [   51.988546]        ret_from_fork+0x31/0x50
    > [   51.989926]        ret_from_fork_asm+0x11/0x20
    > [   51.991376]
    > other info that might help us debug this:
    > [   51.994127]  Possible unsafe locking scenario:
    > [   51.995651]        CPU0                    CPU1
    > [   51.996694]        ----                    ----
    > [   51.997716]   lock(&amp;q-&gt;q_usage_counter(queue)#3);
    > [   51.998817]                                lock(&amp;q-&gt;limits_lock);
    > [   52.000043]                                lock(&amp;q-&gt;q_usage_counter(queue)#3);
    > [   52.001638]   lock(&amp;q-&gt;limits_lock);
    > [   52.002485]
    > ** DEADLOCK ***
    > Prevent this issue by moving the calls to blk_mq_freeze_queue() and
    > blk_mq_unfreeze_queue() around the call to queue_limits_commit_update()
    > in disk_update_zone_resources(). In case of revalidation failure, the
    > call to disk_free_zone_resources() in blk_revalidate_disk_zones()
    > is still done with the queue frozen as before.
    > Fixes: 843283e96e5a (&quot;block: Fake max open zones limit when there is no limit&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Damien Le Moal &lt;dlemoal@kernel.org&gt;
    > Reviewed-by: Christoph Hellwig &lt;hch@lst.de&gt;
    > Link: https://lore.kernel.org/r/20241126104705.183996-1-dlemoal@kernel.org
    > Signed-off-by: Jens Axboe &lt;axboe@kernel.dk&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ serial: amba-pl011: fix build regression (@Arnd Bergmann in [1fae444a616620b](https://github.com/sophgo/linux-riscv/commit/1fae444a616620b) at 2024-12-05 13:02:54)
    > commit b5a23a60e8ab5711f4952912424347bf3864ce8d upstream.
    > When CONFIG_DMA_ENGINE is disabled, the driver now fails to build:
    > drivers/tty/serial/amba-pl011.c: In function &#x27;pl011_unthrottle_rx&#x27;:
    > drivers/tty/serial/amba-pl011.c:1822:16: error: &#x27;struct uart_amba_port&#x27; has no member named &#x27;using_rx_dma&#x27;
    > 1822 |         if (uap-&gt;using_rx_dma) {
    > |                ^~
    > drivers/tty/serial/amba-pl011.c:1823:20: error: &#x27;struct uart_amba_port&#x27; has no member named &#x27;dmacr&#x27;
    > 1823 |                 uap-&gt;dmacr |&#x3D; UART011_RXDMAE;
    > |                    ^~
    > drivers/tty/serial/amba-pl011.c:1824:32: error: &#x27;struct uart_amba_port&#x27; has no member named &#x27;dmacr&#x27;
    > 1824 |                 pl011_write(uap-&gt;dmacr, uap, REG_DMACR);
    > |                                ^~
    > Add the missing #ifdef check around these field accesses, matching
    > what other parts of this driver do.
    > Fixes: 2bcacc1c87ac (&quot;serial: amba-pl011: Fix RX stall when DMA is used&quot;)
    > Cc: stable &lt;stable@kernel.org&gt;
    > Reported-by: kernel test robot &lt;lkp@intel.com&gt;
    > Closes: https://lore.kernel.org/oe-kbuild-all/202411140617.nkjeHhsK-lkp@intel.com/
    > Signed-off-by: Arnd Bergmann &lt;arnd@arndb.de&gt;
    > Link: https://lore.kernel.org/r/20241115110021.744332-1-arnd@kernel.org
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ um: vector: Do not use drvdata in release (@Tiwei Bie in [12f52e373d63f00](https://github.com/sophgo/linux-riscv/commit/12f52e373d63f00) at 2024-12-05 13:02:54)
    > commit 51b39d741970742a5c41136241a9c48ac607cf82 upstream.
    > The drvdata is not available in release. Let&#x27;s just use container_of()
    > to get the vector_device instance. Otherwise, removing a vector device
    > will result in a crash:
    > RIP: 0033:vector_device_release+0xf/0x50
    > RSP: 00000000e187bc40  EFLAGS: 00010202
    > RAX: 0000000060028f61 RBX: 00000000600f1baf RCX: 00000000620074e0
    > RDX: 000000006220b9c0 RSI: 0000000060551c80 RDI: 0000000000000000
    > RBP: 00000000e187bc50 R08: 00000000603ad594 R09: 00000000e187bb70
    > R10: 000000000000135a R11: 00000000603ad422 R12: 00000000623ae028
    > R13: 000000006287a200 R14: 0000000062006d30 R15: 00000000623700b6
    > Kernel panic - not syncing: Segfault with no mm
    > CPU: 0 UID: 0 PID: 16 Comm: kworker/0:1 Not tainted 6.12.0-rc6-g59b723cd2adb #1
    > Workqueue: events mc_work_proc
    > Stack:
    > 60028f61 623ae028 e187bc80 60276fcd
    > 6220b9c0 603f5820 623ae028 00000000
    > e187bcb0 603a2bcd 623ae000 62370010
    > Call Trace:
    > [&lt;60028f61&gt;] ? vector_device_release+0x0/0x50
    > [&lt;60276fcd&gt;] device_release+0x70/0xba
    > [&lt;603a2bcd&gt;] kobject_put+0xba/0xe7
    > [&lt;60277265&gt;] put_device+0x19/0x1c
    > [&lt;60281266&gt;] platform_device_put+0x26/0x29
    > [&lt;60281e5f&gt;] platform_device_unregister+0x2c/0x2e
    > [&lt;60029422&gt;] vector_remove+0x52/0x58
    > [&lt;60031316&gt;] ? mconsole_reply+0x0/0x50
    > [&lt;600310c8&gt;] mconsole_remove+0x160/0x1cc
    > [&lt;603b19f4&gt;] ? strlen+0x0/0x15
    > [&lt;60066611&gt;] ? __dequeue_entity+0x1a9/0x206
    > [&lt;600666a7&gt;] ? set_next_entity+0x39/0x63
    > [&lt;6006666e&gt;] ? set_next_entity+0x0/0x63
    > [&lt;60038fa6&gt;] ? um_set_signals+0x0/0x43
    > [&lt;6003070c&gt;] mc_work_proc+0x77/0x91
    > [&lt;60057664&gt;] process_scheduled_works+0x1b3/0x2dd
    > [&lt;60055f32&gt;] ? assign_work+0x0/0x58
    > [&lt;60057f0a&gt;] worker_thread+0x1e9/0x293
    > [&lt;6005406f&gt;] ? set_pf_worker+0x0/0x64
    > [&lt;6005d65d&gt;] ? arch_local_irq_save+0x0/0x2d
    > [&lt;6005d748&gt;] ? kthread_exit+0x0/0x3a
    > [&lt;60057d21&gt;] ? worker_thread+0x0/0x293
    > [&lt;6005dbf1&gt;] kthread+0x126/0x12b
    > [&lt;600219c5&gt;] new_thread_handler+0x85/0xb6
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Tiwei Bie &lt;tiwei.btw@antgroup.com&gt;
    > Acked-By: Anton Ivanov &lt;anton.ivanov@cambridgegreys.com&gt;
    > Link: https://patch.msgid.link/20241104163203.435515-5-tiwei.btw@antgroup.com
    > Signed-off-by: Johannes Berg &lt;johannes.berg@intel.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ um: net: Do not use drvdata in release (@Tiwei Bie in [f04cd022ee1fde2](https://github.com/sophgo/linux-riscv/commit/f04cd022ee1fde2) at 2024-12-05 13:02:53)
    > commit d1db692a9be3b4bd3473b64fcae996afaffe8438 upstream.
    > The drvdata is not available in release. Let&#x27;s just use container_of()
    > to get the uml_net instance. Otherwise, removing a network device will
    > result in a crash:
    > RIP: 0033:net_device_release+0x10/0x6f
    > RSP: 00000000e20c7c40  EFLAGS: 00010206
    > RAX: 000000006002e4e7 RBX: 00000000600f1baf RCX: 00000000624074e0
    > RDX: 0000000062778000 RSI: 0000000060551c80 RDI: 00000000627af028
    > RBP: 00000000e20c7c50 R08: 00000000603ad594 R09: 00000000e20c7b70
    > R10: 000000000000135a R11: 00000000603ad422 R12: 0000000000000000
    > R13: 0000000062c7af00 R14: 0000000062406d60 R15: 00000000627700b6
    > Kernel panic - not syncing: Segfault with no mm
    > CPU: 0 UID: 0 PID: 29 Comm: kworker/0:2 Not tainted 6.12.0-rc6-g59b723cd2adb #1
    > Workqueue: events mc_work_proc
    > Stack:
    > 627af028 62c7af00 e20c7c80 60276fcd
    > 62778000 603f5820 627af028 00000000
    > e20c7cb0 603a2bcd 627af000 62770010
    > Call Trace:
    > [&lt;60276fcd&gt;] device_release+0x70/0xba
    > [&lt;603a2bcd&gt;] kobject_put+0xba/0xe7
    > [&lt;60277265&gt;] put_device+0x19/0x1c
    > [&lt;60281266&gt;] platform_device_put+0x26/0x29
    > [&lt;60281e5f&gt;] platform_device_unregister+0x2c/0x2e
    > [&lt;6002ec9c&gt;] net_remove+0x63/0x69
    > [&lt;60031316&gt;] ? mconsole_reply+0x0/0x50
    > [&lt;600310c8&gt;] mconsole_remove+0x160/0x1cc
    > [&lt;60087d40&gt;] ? __remove_hrtimer+0x38/0x74
    > [&lt;60087ff8&gt;] ? hrtimer_try_to_cancel+0x8c/0x98
    > [&lt;6006b3cf&gt;] ? dl_server_stop+0x3f/0x48
    > [&lt;6006b390&gt;] ? dl_server_stop+0x0/0x48
    > [&lt;600672e8&gt;] ? dequeue_entities+0x327/0x390
    > [&lt;60038fa6&gt;] ? um_set_signals+0x0/0x43
    > [&lt;6003070c&gt;] mc_work_proc+0x77/0x91
    > [&lt;60057664&gt;] process_scheduled_works+0x1b3/0x2dd
    > [&lt;60055f32&gt;] ? assign_work+0x0/0x58
    > [&lt;60057f0a&gt;] worker_thread+0x1e9/0x293
    > [&lt;6005406f&gt;] ? set_pf_worker+0x0/0x64
    > [&lt;6005d65d&gt;] ? arch_local_irq_save+0x0/0x2d
    > [&lt;6005d748&gt;] ? kthread_exit+0x0/0x3a
    > [&lt;60057d21&gt;] ? worker_thread+0x0/0x293
    > [&lt;6005dbf1&gt;] kthread+0x126/0x12b
    > [&lt;600219c5&gt;] new_thread_handler+0x85/0xb6
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Tiwei Bie &lt;tiwei.btw@antgroup.com&gt;
    > Acked-By: Anton Ivanov &lt;anton.ivanov@cambridgegreys.com&gt;
    > Link: https://patch.msgid.link/20241104163203.435515-4-tiwei.btw@antgroup.com
    > Signed-off-by: Johannes Berg &lt;johannes.berg@intel.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ irqchip/irq-mvebu-sei: Move misplaced select() callback to SEI CP domain (@Russell King (Oracle) in [de71e9796b8d011](https://github.com/sophgo/linux-riscv/commit/de71e9796b8d011) at 2024-12-05 13:02:53)
    > commit 12aaf67584cf19dc84615b7aba272fe642c35b8b upstream.
    > Commit fbdf14e90ce4 (&quot;irqchip/irq-mvebu-sei: Switch to MSI parent&quot;)
    > introduced in v6.11-rc1 broke Mavell Armada platforms (and possibly others)
    > by incorrectly switching irq-mvebu-sei to MSI parent.
    > In the above commit, msi_parent_ops is set for the sei-&gt;cp_domain, but
    > rather than adding a .select method to mvebu_sei_cp_domain_ops (which is
    > associated with sei-&gt;cp_domain), it was added to mvebu_sei_domain_ops which
    > is associated with sei-&gt;sei_domain, which doesn&#x27;t have any
    > msi_parent_ops. This makes the call to msi_lib_irq_domain_select() always
    > fail.
    > This bug manifests itself with the following kernel messages on Armada 8040
    > based systems:
    > platform f21e0000.interrupt-controller:interrupt-controller@50: deferred probe pending: (reason unknown)
    > platform f41e0000.interrupt-controller:interrupt-controller@50: deferred probe pending: (reason unknown)
    > Move the select callback to mvebu_sei_cp_domain_ops to cure it.
    > Fixes: fbdf14e90ce4 (&quot;irqchip/irq-mvebu-sei: Switch to MSI parent&quot;)
    > Signed-off-by: Russell King (Oracle) &lt;rmk+kernel@armlinux.org.uk&gt;
    > Signed-off-by: Thomas Gleixner &lt;tglx@linutronix.de&gt;
    > Cc: stable@vger.kernel.org
    > Link: https://lore.kernel.org/all/E1tE6bh-004CmX-QU@rmk-PC.armlinux.org.uk
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ x86/CPU/AMD: Terminate the erratum_1386_microcode array (@Sebastian Andrzej Siewior in [ccfee14f08b8699](https://github.com/sophgo/linux-riscv/commit/ccfee14f08b8699) at 2024-12-05 13:02:53)
    > commit ff6cdc407f4179748f4673c39b0921503199a0ad upstream.
    > The erratum_1386_microcode array requires an empty entry at the end.
    > Otherwise x86_match_cpu_with_stepping() will continue iterate the array after
    > it ended.
    > Add an empty entry to erratum_1386_microcode to its end.
    > Fixes: 29ba89f189528 (&quot;x86/CPU/AMD: Improve the erratum 1386 workaround&quot;)
    > Signed-off-by: Sebastian Andrzej Siewior &lt;bigeasy@linutronix.de&gt;
    > Signed-off-by: Borislav Petkov (AMD) &lt;bp@alien8.de&gt;
    > Cc: &lt;stable@kernel.org&gt;
    > Link: https://lore.kernel.org/r/20241126134722.480975-1-bigeasy@linutronix.de
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ dt-bindings: serial: rs485: Fix rs485-rts-delay property (@Michal Simek in [b1ec4c49ef70b1d](https://github.com/sophgo/linux-riscv/commit/b1ec4c49ef70b1d) at 2024-12-05 13:02:53)
    > commit 12b3642b6c242061d3ba84e6e3050c3141ded14c upstream.
    > Code expects array only with 2 items which should be checked.
    > But also item checking is not working as it should likely because of
    > incorrect items description.
    > Fixes: d50f974c4f7f (&quot;dt-bindings: serial: Convert rs485 bindings to json-schema&quot;)
    > Signed-off-by: Michal Simek &lt;michal.simek@amd.com&gt;
    > Cc: stable@vger.kernel.org
    > Reviewed-by: Krzysztof Kozlowski &lt;krzk@kernel.org&gt;
    > Link: https://lore.kernel.org/r/820c639b9e22fe037730ed44d1b044cdb6d28b75.1726480384.git.michal.simek@amd.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ ubi: wl: Put source PEB into correct list if trying locking LEB failed (@Zhihao Cheng in [6a72e933f20d719](https://github.com/sophgo/linux-riscv/commit/6a72e933f20d719) at 2024-12-05 13:02:53)
    > commit d610020f030bec819f42de327c2bd5437d2766b3 upstream.
    > During wear-leveing work, the source PEB will be moved into scrub list
    > when source LEB cannot be locked in ubi_eba_copy_leb(), which is wrong
    > for non-scrub type source PEB. The problem could bring extra and
    > ineffective wear-leveing jobs, which makes more or less negative effects
    > for the life time of flash. Specifically, the process is divided 2 steps:
    > 1. wear_leveling_worker // generate false scrub type PEB
    > ubi_eba_copy_leb // MOVE_RETRY is returned
    > leb_write_trylock // trylock failed
    > scrubbing &#x3D; 1;
    > e1 is put into ubi-&gt;scrub
    > 2. wear_leveling_worker // schedule false scrub type PEB for wl
    > scrubbing &#x3D; 1
    > e1 &#x3D; rb_entry(rb_first(&amp;ubi-&gt;scrub))
    > The problem can be reproduced easily by running fsstress on a small
    > UBIFS partition(&lt;64M, simulated by nandsim) for 5~10mins
    > (CONFIG_MTD_UBI_FASTMAP&#x3D;y,CONFIG_MTD_UBI_WL_THRESHOLD&#x3D;50). Following
    > message is shown:
    > ubi0: scrubbed PEB 66 (LEB 0:10), data moved to PEB 165
    > Since scrub type source PEB has set variable scrubbing as &#x27;1&#x27;, and
    > variable scrubbing is checked before variable keep, so the problem can
    > be fixed by setting keep variable as 1 directly if the source LEB cannot
    > be locked.
    > Fixes: e801e128b220 (&quot;UBI: fix missing scrub when there is a bit-flip&quot;)
    > CC: stable@vger.kernel.org
    > Signed-off-by: Zhihao Cheng &lt;chengzhihao1@huawei.com&gt;
    > Signed-off-by: Richard Weinberger &lt;richard@nod.at&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ um: ubd: Do not use drvdata in release (@Tiwei Bie in [16cf8511680809a](https://github.com/sophgo/linux-riscv/commit/16cf8511680809a) at 2024-12-05 13:02:53)
    > commit 5bee35e5389f450a7eea7318deb9073e9414d3b1 upstream.
    > The drvdata is not available in release. Let&#x27;s just use container_of()
    > to get the ubd instance. Otherwise, removing a ubd device will result
    > in a crash:
    > RIP: 0033:blk_mq_free_tag_set+0x1f/0xba
    > RSP: 00000000e2083bf0  EFLAGS: 00010246
    > RAX: 000000006021463a RBX: 0000000000000348 RCX: 0000000062604d00
    > RDX: 0000000004208060 RSI: 00000000605241a0 RDI: 0000000000000348
    > RBP: 00000000e2083c10 R08: 0000000062414010 R09: 00000000601603f7
    > R10: 000000000000133a R11: 000000006038c4bd R12: 0000000000000000
    > R13: 0000000060213a5c R14: 0000000062405d20 R15: 00000000604f7aa0
    > Kernel panic - not syncing: Segfault with no mm
    > CPU: 0 PID: 17 Comm: kworker/0:1 Not tainted 6.8.0-rc3-00107-gba3f67c11638 #1
    > Workqueue: events mc_work_proc
    > Stack:
    > 00000000 604f7ef0 62c5d000 62405d20
    > e2083c30 6002c776 6002c755 600e47ff
    > e2083c60 6025ffe3 04208060 603d36e0
    > Call Trace:
    > [&lt;6002c776&gt;] ubd_device_release+0x21/0x55
    > [&lt;6002c755&gt;] ? ubd_device_release+0x0/0x55
    > [&lt;600e47ff&gt;] ? kfree+0x0/0x100
    > [&lt;6025ffe3&gt;] device_release+0x70/0xba
    > [&lt;60381d6a&gt;] kobject_put+0xb5/0xe2
    > [&lt;6026027b&gt;] put_device+0x19/0x1c
    > [&lt;6026a036&gt;] platform_device_put+0x26/0x29
    > [&lt;6026ac5a&gt;] platform_device_unregister+0x2c/0x2e
    > [&lt;6002c52e&gt;] ubd_remove+0xb8/0xd6
    > [&lt;6002bb74&gt;] ? mconsole_reply+0x0/0x50
    > [&lt;6002b926&gt;] mconsole_remove+0x160/0x1cc
    > [&lt;6002bbbc&gt;] ? mconsole_reply+0x48/0x50
    > [&lt;6003379c&gt;] ? um_set_signals+0x3b/0x43
    > [&lt;60061c55&gt;] ? update_min_vruntime+0x14/0x70
    > [&lt;6006251f&gt;] ? dequeue_task_fair+0x164/0x235
    > [&lt;600620aa&gt;] ? update_cfs_group+0x0/0x40
    > [&lt;603a0e77&gt;] ? __schedule+0x0/0x3ed
    > [&lt;60033761&gt;] ? um_set_signals+0x0/0x43
    > [&lt;6002af6a&gt;] mc_work_proc+0x77/0x91
    > [&lt;600520b4&gt;] process_scheduled_works+0x1af/0x2c3
    > [&lt;6004ede3&gt;] ? assign_work+0x0/0x58
    > [&lt;600527a1&gt;] worker_thread+0x2f7/0x37a
    > [&lt;6004ee3b&gt;] ? set_pf_worker+0x0/0x64
    > [&lt;6005765d&gt;] ? arch_local_irq_save+0x0/0x2d
    > [&lt;60058e07&gt;] ? kthread_exit+0x0/0x3a
    > [&lt;600524aa&gt;] ? worker_thread+0x0/0x37a
    > [&lt;60058f9f&gt;] kthread+0x130/0x135
    > [&lt;6002068e&gt;] new_thread_handler+0x85/0xb6
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Tiwei Bie &lt;tiwei.btw@antgroup.com&gt;
    > Acked-By: Anton Ivanov &lt;anton.ivanov@cambridgegreys.com&gt;
    > Link: https://patch.msgid.link/20241104163203.435515-3-tiwei.btw@antgroup.com
    > Signed-off-by: Johannes Berg &lt;johannes.berg@intel.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ serial: 8250_fintek: Add support for F81216E (@Filip Brozovic in [07524c95ab13def](https://github.com/sophgo/linux-riscv/commit/07524c95ab13def) at 2024-12-05 13:02:53)
    > commit 166105c9030a30ba08574a9998afc7b60bc72dd7 upstream.
    > The F81216E is a LPC/eSPI to 4 UART Super I/O and is mostly compatible with
    > the F81216H, but does not support RS-485 auto-direction delays on any port.
    > Signed-off-by: Filip Brozovic &lt;fbrozovic@gmail.com&gt;
    > Cc: stable &lt;stable@kernel.org&gt;
    > Link: https://lore.kernel.org/r/20241110111703.15494-1-fbrozovic@gmail.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ RISC-V: Check scalar unaligned access on all CPUs (@Jesse Taube in [c4ae2baea54c91b](https://github.com/sophgo/linux-riscv/commit/c4ae2baea54c91b) at 2024-12-05 13:02:52)
    > commit 8d20a739f17a2de9e269db72330f5655d6545dd4 upstream.
    > Originally, the check_unaligned_access_emulated_all_cpus function
    > only checked the boot hart. This fixes the function to check all
    > harts.
    > Fixes: 71c54b3d169d (&quot;riscv: report misaligned accesses emulation to hwprobe&quot;)
    > Signed-off-by: Jesse Taube &lt;jesse@rivosinc.com&gt;
    > Reviewed-by: Charlie Jenkins &lt;charlie@rivosinc.com&gt;
    > Reviewed-by: Evan Green &lt;evan@rivosinc.com&gt;
    > Cc: stable@vger.kernel.org
    > Link: https://lore.kernel.org/r/20241017-jesse_unaligned_vector-v10-1-5b33500160f8@rivosinc.com
    > Signed-off-by: Palmer Dabbelt &lt;palmer@rivosinc.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ platform/chrome: cros_ec_typec: fix missing fwnode reference decrement (@Javier Carrasco in [a9c9e2289d53e0d](https://github.com/sophgo/linux-riscv/commit/a9c9e2289d53e0d) at 2024-12-05 13:02:52)
    > commit 9c41f371457bd9a24874e3c7934d9745e87fbc58 upstream.
    > The device_for_each_child_node() macro requires explicit calls to
    > fwnode_handle_put() upon early exits (return, break, goto) to decrement
    > the fwnode&#x27;s refcount, and avoid levaing a node reference behind.
    > Add the missing fwnode_handle_put() after the common label for all error
    > paths.
    > Cc: stable@vger.kernel.org
    > Fixes: fdc6b21e2444 (&quot;platform/chrome: Add Type C connector class driver&quot;)
    > Signed-off-by: Javier Carrasco &lt;javier.carrasco.cruz@gmail.com&gt;
    > Link: https://lore.kernel.org/r/20241013-cross_ec_typec_fwnode_handle_put-v2-1-9182b2cd7767@gmail.com
    > Signed-off-by: Tzung-Bi Shih &lt;tzungbi@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ smb: client: fix NULL ptr deref in crypto_aead_setkey() (@Paulo Alcantara in [9b8904b53b5ace0](https://github.com/sophgo/linux-riscv/commit/9b8904b53b5ace0) at 2024-12-05 13:02:52)
    > commit 4bdec0d1f658f7c98749bd2c5a486e6cfa8565d2 upstream.
    > Neither SMB3.0 or SMB3.02 supports encryption negotiate context, so
    > when SMB2_GLOBAL_CAP_ENCRYPTION flag is set in the negotiate response,
    > the client uses AES-128-CCM as the default cipher.  See MS-SMB2
    > 3.3.5.4.
    > Commit b0abcd65ec54 (&quot;smb: client: fix UAF in async decryption&quot;) added
    > a @server-&gt;cipher_type check to conditionally call
    > smb3_crypto_aead_allocate(), but that check would always be false as
    > @server-&gt;cipher_type is unset for SMB3.02.
    > Fix the following KASAN splat by setting @server-&gt;cipher_type for
    > SMB3.02 as well.
    > mount.cifs //srv/share /mnt -o vers&#x3D;3.02,seal,...
    > BUG: KASAN: null-ptr-deref in crypto_aead_setkey+0x2c/0x130
    > Read of size 8 at addr 0000000000000020 by task mount.cifs/1095
    > CPU: 1 UID: 0 PID: 1095 Comm: mount.cifs Not tainted 6.12.0 #1
    > Hardware name: QEMU Standard PC (Q35 + ICH9, 2009), BIOS 1.16.3-3.fc41
    > 04/01/2014
    > Call Trace:
    > &lt;TASK&gt;
    > dump_stack_lvl+0x5d/0x80
    > ? crypto_aead_setkey+0x2c/0x130
    > kasan_report+0xda/0x110
    > ? crypto_aead_setkey+0x2c/0x130
    > crypto_aead_setkey+0x2c/0x130
    > crypt_message+0x258/0xec0 [cifs]
    > ? __asan_memset+0x23/0x50
    > ? __pfx_crypt_message+0x10/0x10 [cifs]
    > ? mark_lock+0xb0/0x6a0
    > ? hlock_class+0x32/0xb0
    > ? mark_lock+0xb0/0x6a0
    > smb3_init_transform_rq+0x352/0x3f0 [cifs]
    > ? lock_acquire.part.0+0xf4/0x2a0
    > smb_send_rqst+0x144/0x230 [cifs]
    > ? __pfx_smb_send_rqst+0x10/0x10 [cifs]
    > ? hlock_class+0x32/0xb0
    > ? smb2_setup_request+0x225/0x3a0 [cifs]
    > ? __pfx_cifs_compound_last_callback+0x10/0x10 [cifs]
    > compound_send_recv+0x59b/0x1140 [cifs]
    > ? __pfx_compound_send_recv+0x10/0x10 [cifs]
    > ? __create_object+0x5e/0x90
    > ? hlock_class+0x32/0xb0
    > ? do_raw_spin_unlock+0x9a/0xf0
    > cifs_send_recv+0x23/0x30 [cifs]
    > SMB2_tcon+0x3ec/0xb30 [cifs]
    > ? __pfx_SMB2_tcon+0x10/0x10 [cifs]
    > ? lock_acquire.part.0+0xf4/0x2a0
    > ? __pfx_lock_release+0x10/0x10
    > ? do_raw_spin_trylock+0xc6/0x120
    > ? lock_acquire+0x3f/0x90
    > ? _get_xid+0x16/0xd0 [cifs]
    > ? __pfx_SMB2_tcon+0x10/0x10 [cifs]
    > ? cifs_get_smb_ses+0xcdd/0x10a0 [cifs]
    > cifs_get_smb_ses+0xcdd/0x10a0 [cifs]
    > ? __pfx_cifs_get_smb_ses+0x10/0x10 [cifs]
    > ? cifs_get_tcp_session+0xaa0/0xca0 [cifs]
    > cifs_mount_get_session+0x8a/0x210 [cifs]
    > dfs_mount_share+0x1b0/0x11d0 [cifs]
    > ? __pfx___lock_acquire+0x10/0x10
    > ? __pfx_dfs_mount_share+0x10/0x10 [cifs]
    > ? lock_acquire.part.0+0xf4/0x2a0
    > ? find_held_lock+0x8a/0xa0
    > ? hlock_class+0x32/0xb0
    > ? lock_release+0x203/0x5d0
    > cifs_mount+0xb3/0x3d0 [cifs]
    > ? do_raw_spin_trylock+0xc6/0x120
    > ? __pfx_cifs_mount+0x10/0x10 [cifs]
    > ? lock_acquire+0x3f/0x90
    > ? find_nls+0x16/0xa0
    > ? smb3_update_mnt_flags+0x372/0x3b0 [cifs]
    > cifs_smb3_do_mount+0x1e2/0xc80 [cifs]
    > ? __pfx_vfs_parse_fs_string+0x10/0x10
    > ? __pfx_cifs_smb3_do_mount+0x10/0x10 [cifs]
    > smb3_get_tree+0x1bf/0x330 [cifs]
    > vfs_get_tree+0x4a/0x160
    > path_mount+0x3c1/0xfb0
    > ? kasan_quarantine_put+0xc7/0x1d0
    > ? __pfx_path_mount+0x10/0x10
    > ? kmem_cache_free+0x118/0x3e0
    > ? user_path_at+0x74/0xa0
    > __x64_sys_mount+0x1a6/0x1e0
    > ? __pfx___x64_sys_mount+0x10/0x10
    > ? mark_held_locks+0x1a/0x90
    > do_syscall_64+0xbb/0x1d0
    > entry_SYSCALL_64_after_hwframe+0x77/0x7f
    > Cc: Tom Talpey &lt;tom@talpey.com&gt;
    > Reported-by: Jianhong Yin &lt;jiyin@redhat.com&gt;
    > Cc: stable@vger.kernel.org # v6.12
    > Fixes: b0abcd65ec54 (&quot;smb: client: fix UAF in async decryption&quot;)
    > Signed-off-by: Paulo Alcantara (Red Hat) &lt;pc@manguebit.com&gt;
    > Signed-off-by: Steve French &lt;stfrench@microsoft.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ ksmbd: fix use-after-free in SMB request handling (@Yunseong Kim in [96261adb998a3b5](https://github.com/sophgo/linux-riscv/commit/96261adb998a3b5) at 2024-12-05 13:02:52)
    > commit 9a8c5d89d327ff58e9b2517f8a6afb4181d32c6e upstream.
    > A race condition exists between SMB request handling in
    > &#x60;ksmbd_conn_handler_loop()&#x60; and the freeing of &#x60;ksmbd_conn&#x60; in the
    > workqueue handler &#x60;handle_ksmbd_work()&#x60;. This leads to a UAF.
    > - KASAN: slab-use-after-free Read in handle_ksmbd_work
    > - KASAN: slab-use-after-free in rtlock_slowlock_locked
    > This race condition arises as follows:
    > - &#x60;ksmbd_conn_handler_loop()&#x60; waits for &#x60;conn-&gt;r_count&#x60; to reach zero:
    > &#x60;wait_event(conn-&gt;r_count_q, atomic_read(&amp;conn-&gt;r_count) &#x3D;&#x3D; 0);&#x60;
    > - Meanwhile, &#x60;handle_ksmbd_work()&#x60; decrements &#x60;conn-&gt;r_count&#x60; using
    > &#x60;atomic_dec_return(&amp;conn-&gt;r_count)&#x60;, and if it reaches zero, calls
    > &#x60;ksmbd_conn_free()&#x60;, which frees &#x60;conn&#x60;.
    > - However, after &#x60;handle_ksmbd_work()&#x60; decrements &#x60;conn-&gt;r_count&#x60;,
    > it may still access &#x60;conn-&gt;r_count_q&#x60; in the following line:
    > &#x60;waitqueue_active(&amp;conn-&gt;r_count_q)&#x60; or &#x60;wake_up(&amp;conn-&gt;r_count_q)&#x60;
    > This results in a UAF, as &#x60;conn&#x60; has already been freed.
    > The discovery of this UAF can be referenced in the following PR for
    > syzkaller&#x27;s support for SMB requests.
    > Link: https://github.com/google/syzkaller/pull/5524
    > Fixes: ee426bfb9d09 (&quot;ksmbd: add refcnt to ksmbd_conn struct&quot;)
    > Cc: linux-cifs@vger.kernel.org
    > Cc: stable@vger.kernel.org # v6.6.55+, v6.10.14+, v6.11.3+
    > Cc: syzkaller@googlegroups.com
    > Signed-off-by: Yunseong Kim &lt;yskelg@gmail.com&gt;
    > Acked-by: Namjae Jeon &lt;linkinjeon@kernel.org&gt;
    > Signed-off-by: Steve French &lt;stfrench@microsoft.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ cifs: support mounting with alternate password to allow password rotation (@Meetakshi Setiya in [486f2c22ba57da6](https://github.com/sophgo/linux-riscv/commit/486f2c22ba57da6) at 2024-12-05 13:02:52)
    > commit b9aef1b13a0a92aa7058ba235afb24b5b89153ca upstream.
    > Fixes the case for example where the password specified on mount is a
    > recently expired password, but password2 is valid.  Without this patch
    > this mount scenario would fail.
    > This patch introduces the following changes to support password rotation on
    > mount:
    > 1. If an existing session is not found and the new session setup results in
    > EACCES, EKEYEXPIRED or EKEYREVOKED, swap password and password2 (if
    > available), and retry the mount.
    > 2. To match the new mount with an existing session, add conditions to check
    > if a) password and password2 of the new mount and the existing session are
    > the same, or b) password of the new mount is the same as the password2 of
    > the existing session, and password2 of the new mount is the same as the
    > password of the existing session.
    > 3. If an existing session is found, but needs reconnect, retry the session
    > setup after swapping password and password2 (if available), in case the
    > previous attempt results in EACCES, EKEYEXPIRED or EKEYREVOKED.
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Meetakshi Setiya &lt;msetiya@microsoft.com&gt;
    > Signed-off-by: Steve French &lt;stfrench@microsoft.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ parisc/ftrace: Fix function graph tracing disablement (@Josh Poimboeuf in [3017be7b843b4e8](https://github.com/sophgo/linux-riscv/commit/3017be7b843b4e8) at 2024-12-05 13:02:52)
    > commit a5f05a138a8cac035bf9da9b6ed0e532bc7942c8 upstream.
    > Due to an apparent copy-paste bug, the parisc implementation of
    > ftrace_disable_ftrace_graph_caller() doesn&#x27;t actually do anything.
    > It enables the (already-enabled) static key rather than disabling it.
    > The result is that after function graph tracing has been &quot;disabled&quot;, any
    > subsequent (non-graph) function tracing will inadvertently also enable
    > the slow fgraph return address hijacking.
    > Fixes: 98f2926171ae (&quot;parisc/ftrace: use static key to enable/disable function graph tracer&quot;)
    > Cc: stable@vger.kernel.org # 5.16+
    > Signed-off-by: Josh Poimboeuf &lt;jpoimboe@kernel.org&gt;
    > Signed-off-by: Helge Deller &lt;deller@gmx.de&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ RISC-V: Scalar unaligned access emulated on hotplug CPUs (@Jesse Taube in [2bb383015281275](https://github.com/sophgo/linux-riscv/commit/2bb383015281275) at 2024-12-05 13:02:52)
    > commit 9c528b5f7927b857b40f3c46afbc869827af3c94 upstream.
    > The check_unaligned_access_emulated() function should have been called
    > during CPU hotplug to ensure that if all CPUs had emulated unaligned
    > accesses, the new CPU also does.
    > This patch adds the call to check_unaligned_access_emulated() in
    > the hotplug path.
    > Fixes: 55e0bf49a0d0 (&quot;RISC-V: Probe misaligned access speed in parallel&quot;)
    > Signed-off-by: Jesse Taube &lt;jesse@rivosinc.com&gt;
    > Reviewed-by: Evan Green &lt;evan@rivosinc.com&gt;
    > Cc: stable@vger.kernel.org
    > Link: https://lore.kernel.org/r/20241017-jesse_unaligned_vector-v10-2-5b33500160f8@rivosinc.com
    > Signed-off-by: Palmer Dabbelt &lt;palmer@rivosinc.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ gpio: exar: set value when external pull-up or pull-down is present (@Sai Kumar Cholleti in [b3cb59cfaa17afd](https://github.com/sophgo/linux-riscv/commit/b3cb59cfaa17afd) at 2024-12-05 13:02:51)
    > commit 72cef64180de04a7b055b4773c138d78f4ebdb77 upstream.
    > Setting GPIO direction &#x3D; high, sometimes results in GPIO value &#x3D; 0.
    > If a GPIO is pulled high, the following construction results in the
    > value being 0 when the desired value is 1:
    > $ echo &quot;high&quot; &gt; /sys/class/gpio/gpio336/direction
    > $ cat /sys/class/gpio/gpio336/value
    > 0
    > Before the GPIO direction is changed from an input to an output,
    > exar_set_value() is called with value &#x3D; 1, but since the GPIO is an
    > input when exar_set_value() is called, _regmap_update_bits() reads a 1
    > due to an external pull-up.  regmap_set_bits() sets force_write &#x3D;
    > false, so the value (1) is not written.  When the direction is then
    > changed, the GPIO becomes an output with the value of 0 (the hardware
    > default).
    > regmap_write_bits() sets force_write &#x3D; true, so the value is always
    > written by exar_set_value() and an external pull-up doesn&#x27;t affect the
    > outcome of setting direction &#x3D; high.
    > The same can happen when a GPIO is pulled low, but the scenario is a
    > little more complicated.
    > $ echo high &gt; /sys/class/gpio/gpio351/direction
    > $ cat /sys/class/gpio/gpio351/value
    > 1
    > $ echo in &gt; /sys/class/gpio/gpio351/direction
    > $ cat /sys/class/gpio/gpio351/value
    > 0
    > $ echo low &gt; /sys/class/gpio/gpio351/direction
    > $ cat /sys/class/gpio/gpio351/value
    > 1
    > Fixes: 36fb7218e878 (&quot;gpio: exar: switch to using regmap&quot;)
    > Co-developed-by: Matthew McClain &lt;mmcclain@noprivs.com&gt;
    > Signed-off-by: Matthew McClain &lt;mmcclain@noprivs.com&gt;
    > Signed-off-by: Sai Kumar Cholleti &lt;skmr537@gmail.com&gt;
    > Cc: stable@vger.kernel.org
    > Reviewed-by: Andy Shevchenko &lt;andriy.shevchenko@linux.intel.com&gt;
    > Link: https://lore.kernel.org/r/20241105071523.2372032-1-skmr537@gmail.com
    > Signed-off-by: Bartosz Golaszewski &lt;bartosz.golaszewski@linaro.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ spi: Fix acpi deferred irq probe (@Stanislaw Gruszka in [97b68bda72f7b13](https://github.com/sophgo/linux-riscv/commit/97b68bda72f7b13) at 2024-12-05 13:02:51)
    > commit d24cfee7f63d6b44d45a67c5662bd1cc48e8b3ca upstream.
    > When probing spi device take care of deferred probe of ACPI irq gpio
    > similar like for OF/DT case.
    > &gt;From practical standpoint this fixes issue with vsc-tp driver on
    > Dell XP 9340 laptop, which try to request interrupt with spi-&gt;irq
    > equal to -EPROBE_DEFER and fail to probe with the following error:
    > vsc-tp spi-INTC10D0:00: probe with driver vsc-tp failed with error -22
    > Suggested-by: Hans de Goede &lt;hdegoede@redhat.com&gt;
    > Fixes: 33ada67da352 (&quot;ACPI / spi: attach GPIO IRQ from ACPI description to SPI device&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Stanislaw Gruszka &lt;stanislaw.gruszka@linux.intel.com&gt;
    > Reviewed-by: Hans de Goede &lt;hdegoede@redhat.com&gt;
    > Tested-by: Alexis Lothoré &lt;alexis.lothore@bootlin.com&gt; # Dell XPS9320, ov01a10
    > Link: https://patch.msgid.link/20241122094224.226773-1-stanislaw.gruszka@linux.intel.com
    > Signed-off-by: Mark Brown &lt;broonie@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ cpufreq: mediatek-hw: Fix wrong return value in mtk_cpufreq_get_cpu_power() (@Jinjie Ruan in [941202d8c326037](https://github.com/sophgo/linux-riscv/commit/941202d8c326037) at 2024-12-05 13:02:51)
    > commit 172bf5ed04cb6c9e66d58de003938ed5c8756570 upstream.
    > mtk_cpufreq_get_cpu_power() return 0 if the policy is NULL. Then in
    > em_create_perf_table(), the later zero check for power is not invalid
    > as power is uninitialized. As Lukasz suggested, it must return -EINVAL when
    > the &#x27;policy&#x27; is not found. So return -EINVAL to fix it.
    > Cc: stable@vger.kernel.org
    > Fixes: 4855e26bcf4d (&quot;cpufreq: mediatek-hw: Add support for CPUFREQ HW&quot;)
    > Reviewed-by: Lukasz Luba &lt;lukasz.luba@arm.com&gt;
    > Suggested-by: Lukasz Luba &lt;lukasz.luba@arm.com&gt;
    > Signed-off-by: Jinjie Ruan &lt;ruanjinjie@huawei.com&gt;
    > Signed-off-by: Viresh Kumar &lt;viresh.kumar@linaro.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ mtd: spi-nor: core: replace dummy buswidth from addr to data (@Cheng Ming Lin in [77f53f49ad62842](https://github.com/sophgo/linux-riscv/commit/77f53f49ad62842) at 2024-12-05 13:02:51)
    > commit 98d1fb94ce75f39febd456d6d3cbbe58b6678795 upstream.
    > The default dummy cycle for Macronix SPI NOR flash in Octal Output
    > Read Mode(1-1-8) is 20.
    > Currently, the dummy buswidth is set according to the address bus width.
    > In the 1-1-8 mode, this means the dummy buswidth is 1. When converting
    > dummy cycles to bytes, this results in 20 x 1 / 8 &#x3D; 2 bytes, causing the
    > host to read data 4 cycles too early.
    > Since the protocol data buswidth is always greater than or equal to the
    > address buswidth. Setting the dummy buswidth to match the data buswidth
    > increases the likelihood that the dummy cycle-to-byte conversion will be
    > divisible, preventing the host from reading data prematurely.
    > Fixes: 0e30f47232ab (&quot;mtd: spi-nor: add support for DTR protocol&quot;)
    > Cc: stable@vger.kernel.org
    > Reviewed-by: Pratyush Yadav &lt;pratyush@kernel.org&gt;
    > Signed-off-by: Cheng Ming Lin &lt;chengminglin@mxic.com.tw&gt;
    > Link: https://lore.kernel.org/r/20241112075242.174010-2-linchengming884@gmail.com
    > Signed-off-by: Tudor Ambarus &lt;tudor.ambarus@linaro.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ blk-settings: round down io_opt to physical_block_size (@Mikulas Patocka in [37c2ca4e89d049d](https://github.com/sophgo/linux-riscv/commit/37c2ca4e89d049d) at 2024-12-05 13:02:51)
    > commit 9c0ba14828d64744ccd195c610594ba254a1a9ab upstream.
    > There was a bug report [1] where the user got a warning alignment
    > inconsistency. The user has optimal I/O 16776704 (0xFFFE00) and physical
    > block size 4096. Note that the optimal I/O size may be set by the DMA
    > engines or SCSI controllers and they have no knowledge about the disks
    > attached to them, so the situation with optimal I/O not aligned to
    > physical block size may happen.
    > This commit makes blk_validate_limits round down optimal I/O size to the
    > physical block size of the block device.
    > Closes: https://lore.kernel.org/dm-devel/1426ad71-79b4-4062-b2bf-84278be66a5d@redhat.com/T/ [1]
    > Signed-off-by: Mikulas Patocka &lt;mpatocka@redhat.com&gt;
    > Fixes: a23634644afc (&quot;block: take io_opt and io_min into account for max_sectors&quot;)
    > Cc: stable@vger.kernel.org	# v6.11+
    > Reviewed-by: Christoph Hellwig &lt;hch@lst.de&gt;
    > Link: https://lore.kernel.org/r/3dc0014b-9690-dc38-81c9-4a316a2d4fb2@redhat.com
    > Signed-off-by: Jens Axboe &lt;axboe@kernel.dk&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ netfilter: ipset: add missing range check in bitmap_ip_uadt (@Jeongjun Park in [15794835378ed56](https://github.com/sophgo/linux-riscv/commit/15794835378ed56) at 2024-12-05 13:02:51)
    > commit 35f56c554eb1b56b77b3cf197a6b00922d49033d upstream.
    > When tb[IPSET_ATTR_IP_TO] is not present but tb[IPSET_ATTR_CIDR] exists,
    > the values of ip and ip_to are slightly swapped. Therefore, the range check
    > for ip should be done later, but this part is missing and it seems that the
    > vulnerability occurs.
    > So we should add missing range checks and remove unnecessary range checks.
    > Cc: &lt;stable@vger.kernel.org&gt;
    > Reported-by: syzbot+58c872f7790a4d2ac951@syzkaller.appspotmail.com
    > Fixes: 72205fc68bd1 (&quot;netfilter: ipset: bitmap:ip set type support&quot;)
    > Signed-off-by: Jeongjun Park &lt;aha310510@gmail.com&gt;
    > Acked-by: Jozsef Kadlecsik &lt;kadlec@blackhole.kfki.hu&gt;
    > Signed-off-by: Pablo Neira Ayuso &lt;pablo@netfilter.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ io_uring: fix corner case forgetting to vunmap (@Pavel Begunkov in [d222fd21dd21b0e](https://github.com/sophgo/linux-riscv/commit/d222fd21dd21b0e) at 2024-12-05 13:02:50)
    > commit 43eef70e7e2ac74e7767731dd806720c7fb5e010 upstream.
    > io_pages_unmap() is a bit tricky in trying to figure whether the pages
    > were previously vmap&#x27;ed or not. In particular If there is juts one page
    > it belives there is no need to vunmap. Paired io_pages_map(), however,
    > could&#x27;ve failed io_mem_alloc_compound() and attempted to
    > io_mem_alloc_single(), which does vmap, and that leads to unpaired vmap.
    > The solution is to fail if io_mem_alloc_compound() can&#x27;t allocate a
    > single page. That&#x27;s the easiest way to deal with it, and those two
    > functions are getting removed soon, so no need to overcomplicate it.
    > Cc: stable@vger.kernel.org
    > Fixes: 3ab1db3c6039e (&quot;io_uring: get rid of remap_pfn_range() for mapping rings/sqes&quot;)
    > Signed-off-by: Pavel Begunkov &lt;asml.silence@gmail.com&gt;
    > Link: https://lore.kernel.org/r/477e75a3907a2fe83249e49c0a92cd480b2c60e0.1732569842.git.asml.silence@gmail.com
    > Signed-off-by: Jens Axboe &lt;axboe@kernel.dk&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ Revert &quot;usb: gadget: composite: fix OS descriptors w_value logic&quot; (@Michal Vrastil in [ca82b37c4720acf](https://github.com/sophgo/linux-riscv/commit/ca82b37c4720acf) at 2024-12-05 13:02:50)
    > commit 51cdd69d6a857f527d6d0697a2e1f0fa8bca1005 upstream.
    > This reverts commit ec6ce7075ef879b91a8710829016005dc8170f17.
    > Fix installation of WinUSB driver using OS descriptors. Without the
    > fix the drivers are not installed correctly and the property
    > &#x27;DeviceInterfaceGUID&#x27; is missing on host side.
    > The original change was based on the assumption that the interface
    > number is in the high byte of wValue but it is in the low byte,
    > instead. Unfortunately, the fix is based on MS documentation which is
    > also wrong.
    > The actual USB request for OS descriptors (using USB analyzer) looks
    > like:
    > Offset  0   1   2   3   4   5   6   7
    > 0x000   C1  A1  02  00  05  00  0A  00
    > C1: bmRequestType (device to host, vendor, interface)
    > A1: nas magic number
    > 0002: wValue (2: nas interface)
    > 0005: wIndex (5: get extended property i.e. nas interface GUID)
    > 008E: wLength (142)
    > The fix was tested on Windows 10 and Windows 11.
    > Cc: stable@vger.kernel.org
    > Fixes: ec6ce7075ef8 (&quot;usb: gadget: composite: fix OS descriptors w_value logic&quot;)
    > Signed-off-by: Michal Vrastil &lt;michal.vrastil@hidglobal.com&gt;
    > Signed-off-by: Elson Roy Serrao &lt;quic_eserrao@quicinc.com&gt;
    > Acked-by: Peter korsgaard &lt;peter@korsgaard.com&gt;
    > Link: https://lore.kernel.org/r/20241113235433.20244-1-quic_eserrao@quicinc.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ io_uring: check for overflows in io_pin_pages (@Pavel Begunkov in [aaa90844afd499c](https://github.com/sophgo/linux-riscv/commit/aaa90844afd499c) at 2024-12-05 13:02:50)
    > commit 0c0a4eae26ac78379d0c1db053de168a8febc6c9 upstream.
    > WARNING: CPU: 0 PID: 5834 at io_uring/memmap.c:144 io_pin_pages+0x149/0x180 io_uring/memmap.c:144
    > CPU: 0 UID: 0 PID: 5834 Comm: syz-executor825 Not tainted 6.12.0-next-20241118-syzkaller #0
    > Call Trace:
    > &lt;TASK&gt;
    > __io_uaddr_map+0xfb/0x2d0 io_uring/memmap.c:183
    > io_rings_map io_uring/io_uring.c:2611 [inline]
    > io_allocate_scq_urings+0x1c0/0x650 io_uring/io_uring.c:3470
    > io_uring_create+0x5b5/0xc00 io_uring/io_uring.c:3692
    > io_uring_setup io_uring/io_uring.c:3781 [inline]
    > ...
    > &lt;/TASK&gt;
    > io_pin_pages()&#x27;s uaddr parameter came directly from the user and can be
    > garbage. Don&#x27;t just add size to it as it can overflow.
    > Cc: stable@vger.kernel.org
    > Reported-by: syzbot+2159cbb522b02847c053@syzkaller.appspotmail.com
    > Signed-off-by: Pavel Begunkov &lt;asml.silence@gmail.com&gt;
    > Link: https://lore.kernel.org/r/1b7520ddb168e1d537d64be47414a0629d0d8f8f.1732581026.git.asml.silence@gmail.com
    > Signed-off-by: Jens Axboe &lt;axboe@kernel.dk&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ serial: sh-sci: Clean sci_ports[0] after at earlycon exit (@Claudiu Beznea in [2fa5da1f9135026](https://github.com/sophgo/linux-riscv/commit/2fa5da1f9135026) at 2024-12-05 13:02:50)
    > commit 3791ea69a4858b81e0277f695ca40f5aae40f312 upstream.
    > The early_console_setup() function initializes the sci_ports[0].port with
    > an object of type struct uart_port obtained from the object of type
    > struct earlycon_device received as argument by the early_console_setup().
    > It may happen that later, when the rest of the serial ports are probed,
    > the serial port that was used as earlycon (e.g., port A) to be mapped to a
    > different position in sci_ports[] and the slot 0 to be used by a different
    > serial port (e.g., port B), as follows:
    > sci_ports[0] &#x3D; port A
    > sci_ports[X] &#x3D; port B
    > In this case, the new port mapped at index zero will have associated data
    > that was used for earlycon.
    > In case this happens, after Linux boot, any access to the serial port that
    > maps on sci_ports[0] (port A) will block the serial port that was used as
    > earlycon (port B).
    > To fix this, add early_console_exit() that clean the sci_ports[0] at
    > earlycon exit time.
    > Fixes: 0b0cced19ab1 (&quot;serial: sh-sci: Add CONFIG_SERIAL_EARLYCON support&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Claudiu Beznea &lt;claudiu.beznea.uj@bp.renesas.com&gt;
    > Link: https://lore.kernel.org/r/20241106120118.1719888-4-claudiu.beznea.uj@bp.renesas.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ Revert &quot;fs: don&#x27;t block i_writecount during exec&quot; (@Christian Brauner in [13111945c2420c2](https://github.com/sophgo/linux-riscv/commit/13111945c2420c2) at 2024-12-05 13:02:50)
    > commit 3b832035387ff508fdcf0fba66701afc78f79e3d upstream.
    > This reverts commit 2a010c41285345da60cece35575b4e0af7e7bf44.
    > Rui Ueyama &lt;rui314@gmail.com&gt; writes:
    > &gt; I&#x27;m the creator and the maintainer of the mold linker
    > &gt; (https://github.com/rui314/mold). Recently, we discovered that mold
    > &gt; started causing process crashes in certain situations due to a change
    > &gt; in the Linux kernel. Here are the details:
    > &gt;
    > &gt; - In general, overwriting an existing file is much faster than
    > &gt; creating an empty file and writing to it on Linux, so mold attempts to
    > &gt; reuse an existing executable file if it exists.
    > &gt;
    > &gt; - If a program is running, opening the executable file for writing
    > &gt; previously failed with ETXTBSY. If that happens, mold falls back to
    > &gt; creating a new file.
    > &gt;
    > &gt; - However, the Linux kernel recently changed the behavior so that
    > &gt; writing to an executable file is now always permitted
    > &gt; (https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id&#x3D;2a010c412853).
    > &gt;
    > &gt; That caused mold to write to an executable file even if there&#x27;s a
    > &gt; process running that file. Since changes to mmap&#x27;ed files are
    > &gt; immediately visible to other processes, any processes running that
    > &gt; file would almost certainly crash in a very mysterious way.
    > &gt; Identifying the cause of these random crashes took us a few days.
    > &gt;
    > &gt; Rejecting writes to an executable file that is currently running is a
    > &gt; well-known behavior, and Linux had operated that way for a very long
    > &gt; time. So, I don’t believe relying on this behavior was our mistake;
    > &gt; rather, I see this as a regression in the Linux kernel.
    > Quoting myself from commit 2a010c412853 (&quot;fs: don&#x27;t block i_writecount during exec&quot;)
    > &gt; Yes, someone in userspace could potentially be relying on this. It&#x27;s not
    > &gt; completely out of the realm of possibility but let&#x27;s find out if that&#x27;s
    > &gt; actually the case and not guess.
    > It seems we found out that someone is relying on this obscure behavior.
    > So revert the change.
    > Link: https://github.com/rui314/mold/issues/1361
    > Link: https://lore.kernel.org/r/4a2bc207-76be-4715-8e12-7fc45a76a125@leemhuis.info
    > Cc: &lt;stable@vger.kernel.org&gt;
    > Signed-off-by: Christian Brauner &lt;brauner@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ Revert &quot;serial: sh-sci: Clean sci_ports[0] after at earlycon exit&quot; (@Greg Kroah-Hartman in [0a9fd032f934b2f](https://github.com/sophgo/linux-riscv/commit/0a9fd032f934b2f) at 2024-12-05 13:02:50)
    > commit 718632467d88e98816fa01ab12681ef1c2aa56f8 upstream.
    > This reverts commit 3791ea69a4858b81e0277f695ca40f5aae40f312.
    > It was reported to cause boot-time issues, so revert it for now.
    > Reported-by: Geert Uytterhoeven &lt;geert@linux-m68k.org&gt;
    > Fixes: 3791ea69a485 (&quot;serial: sh-sci: Clean sci_ports[0] after at earlycon exit&quot;)
    > Cc: stable &lt;stable@kernel.org&gt;
    > Cc: Claudiu Beznea &lt;claudiu.beznea.uj@bp.renesas.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ Revert &quot;f2fs: remove unreachable lazytime mount option parsing&quot; (@Jaegeuk Kim in [0586f12896b51f6](https://github.com/sophgo/linux-riscv/commit/0586f12896b51f6) at 2024-12-05 13:02:50)
    > commit acff9409dd40beaca2bd982678d222e2740ad84b upstream.
    > This reverts commit 54f43a10fa257ad4af02a1d157fefef6ebcfa7dc.
    > The above commit broke the lazytime mount, given
    > mount(&quot;/dev/vdb&quot;, &quot;/mnt/test&quot;, &quot;f2fs&quot;, 0, &quot;lazytime&quot;);
    > CC: stable@vger.kernel.org # 6.11+
    > Signed-off-by: Daniel Rosenberg &lt;drosen@google.com&gt;
    > Reviewed-by: Chao Yu &lt;chao@kernel.org&gt;
    > Signed-off-by: Jaegeuk Kim &lt;jaegeuk@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ wifi: rtlwifi: Drastically reduce the attempts to read efuse in case of failures (@Guilherme G. Piccoli in [ac064c656f105b9](https://github.com/sophgo/linux-riscv/commit/ac064c656f105b9) at 2024-12-05 13:02:49)
    > commit 5c1b544563005a00591a3aa86ecff62ed4d11be3 upstream.
    > Syzkaller reported a hung task with uevent_show() on stack trace. That
    > specific issue was addressed by another commit [0], but even with that
    > fix applied (for example, running v6.12-rc5) we face another type of hung
    > task that comes from the same reproducer [1]. By investigating that, we
    > could narrow it to the following path:
    > (a) Syzkaller emulates a Realtek USB WiFi adapter using raw-gadget and
    > dummy_hcd infrastructure.
    > (b) During the probe of rtl8192cu, the driver ends-up performing an efuse
    > read procedure (which is related to EEPROM load IIUC), and here lies the
    > issue: the function read_efuse() calls read_efuse_byte() many times, as
    > loop iterations depending on the efuse size (in our example, 512 in total).
    > This procedure for reading efuse bytes relies in a loop that performs an
    > I/O read up to *10k* times in case of failures. We measured the time of
    > the loop inside read_efuse_byte() alone, and in this reproducer (which
    > involves the dummy_hcd emulation layer), it takes 15 seconds each. As a
    > consequence, we have the driver stuck in its probe routine for big time,
    > exposing a stack trace like below if we attempt to reboot the system, for
    > example:
    > task:kworker/0:3 state:D stack:0 pid:662 tgid:662 ppid:2 flags:0x00004000
    > Workqueue: usb_hub_wq hub_event
    > Call Trace:
    > __schedule+0xe22/0xeb6
    > schedule_timeout+0xe7/0x132
    > __wait_for_common+0xb5/0x12e
    > usb_start_wait_urb+0xc5/0x1ef
    > ? usb_alloc_urb+0x95/0xa4
    > usb_control_msg+0xff/0x184
    > _usbctrl_vendorreq_sync+0xa0/0x161
    > _usb_read_sync+0xb3/0xc5
    > read_efuse_byte+0x13c/0x146
    > read_efuse+0x351/0x5f0
    > efuse_read_all_map+0x42/0x52
    > rtl_efuse_shadow_map_update+0x60/0xef
    > rtl_get_hwinfo+0x5d/0x1c2
    > rtl92cu_read_eeprom_info+0x10a/0x8d5
    > ? rtl92c_read_chip_version+0x14f/0x17e
    > rtl_usb_probe+0x323/0x851
    > usb_probe_interface+0x278/0x34b
    > really_probe+0x202/0x4a4
    > __driver_probe_device+0x166/0x1b2
    > driver_probe_device+0x2f/0xd8
    > [...]
    > We propose hereby to drastically reduce the attempts of doing the I/O
    > reads in case of failures, restricted to USB devices (given that
    > they&#x27;re inherently slower than PCIe ones). By retrying up to 10 times
    > (instead of 10000), we got reponsiveness in the reproducer, while seems
    > reasonable to believe that there&#x27;s no sane USB device implementation in
    > the field requiring this amount of retries at every I/O read in order
    > to properly work. Based on that assumption, it&#x27;d be good to have it
    > backported to stable but maybe not since driver implementation (the 10k
    > number comes from day 0), perhaps up to 6.x series makes sense.
    > [0] Commit 15fffc6a5624 (&quot;driver core: Fix uevent_show() vs driver detach race&quot;)
    > [1] A note about that: this syzkaller report presents multiple reproducers
    > that differs by the type of emulated USB device. For this specific case,
    > check the entry from 2024/08/08 06:23 in the list of crashes; the C repro
    > is available at https://syzkaller.appspot.com/text?tag&#x3D;ReproC&amp;x&#x3D;1521fc83980000.
    > Cc: stable@vger.kernel.org # v6.1+
    > Reported-by: syzbot+edd9fe0d3a65b14588d5@syzkaller.appspotmail.com
    > Tested-by: Bitterblue Smith &lt;rtl8821cerfe2@gmail.com&gt;
    > Signed-off-by: Guilherme G. Piccoli &lt;gpiccoli@igalia.com&gt;
    > Signed-off-by: Ping-Ke Shih &lt;pkshih@realtek.com&gt;
    > Link: https://patch.msgid.link/20241101193412.1390391-1-gpiccoli@igalia.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ wifi: ath12k: fix warning when unbinding (@Jose Ignacio Tornos Martinez in [94c9100b600f05a](https://github.com/sophgo/linux-riscv/commit/94c9100b600f05a) at 2024-12-05 13:02:49)
    > commit ca68ce0d9f4bcd032fd1334441175ae399642a06 upstream.
    > If there is an error during some initialization related to firmware,
    > the buffers dp-&gt;tx_ring[i].tx_status are released.
    > However this is released again when the device is unbinded (ath12k_pci),
    > and we get:
    > WARNING: CPU: 0 PID: 2098 at mm/slub.c:4689 free_large_kmalloc+0x4d/0x80
    > Call Trace:
    > free_large_kmalloc
    > ath12k_dp_free
    > ath12k_core_deinit
    > ath12k_pci_remove
    > ...
    > The issue is always reproducible from a VM because the MSI addressing
    > initialization is failing.
    > In order to fix the issue, just set the buffers to NULL after releasing in
    > order to avoid the double free.
    > cc: stable@vger.kernel.org
    > Fixes: d889913205cf (&quot;wifi: ath12k: driver for Qualcomm Wi-Fi 7 devices&quot;)
    > Signed-off-by: Jose Ignacio Tornos Martinez &lt;jtornosm@redhat.com&gt;
    > Link: https://patch.msgid.link/20241017181004.199589-3-jtornosm@redhat.com
    > Signed-off-by: Jeff Johnson &lt;quic_jjohnson@quicinc.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ usb: xhci: Avoid queuing redundant Stop Endpoint commands (@Michal Pecio in [6debdd82c33cc0d](https://github.com/sophgo/linux-riscv/commit/6debdd82c33cc0d) at 2024-12-05 13:02:49)
    > commit 474538b8dd1cd9c666e56cfe8ef60fbb0fb513f4 upstream.
    > Stop Endpoint command on an already stopped endpoint fails and may be
    > misinterpreted as a known hardware bug by the completion handler. This
    > results in an unnecessary delay with repeated retries of the command.
    > Avoid queuing this command when endpoint state flags indicate that it&#x27;s
    > stopped or halted and the command will fail. If commands are pending on
    > the endpoint, their completion handlers will process cancelled TDs so
    > it&#x27;s done. In case of waiting for external operations like clearing TT
    > buffer, the endpoint is stopped and cancelled TDs can be processed now.
    > This eliminates practically all unnecessary retries because an endpoint
    > with pending URBs is maintained in Running state by the driver, unless
    > aforementioned commands or other operations are pending on it. This is
    > guaranteed by xhci_ring_ep_doorbell() and by the fact that it is called
    > every time any of those operations completes.
    > The only known exceptions are hardware bugs (the endpoint never starts
    > at all) and Stream Protocol errors not associated with any TRB, which
    > cause an endpoint reset not followed by restart. Sounds like a bug.
    > Generally, these retries are only expected to happen when the endpoint
    > fails to start for unknown/no reason, which is a worse problem itself,
    > and fixing the bug eliminates the retries too.
    > All cases were tested and found to work as expected. SET_DEQ_PENDING
    > was produced by patching uvcvideo to unlink URBs in 100us intervals,
    > which then runs into this case very often. EP_HALTED was produced by
    > restarting &#x27;cat /dev/ttyUSB0&#x27; on a serial dongle with broken cable.
    > EP_CLEARING_TT by the same, with the dongle on an external hub.
    > Fixes: fd9d55d190c0 (&quot;xhci: retry Stop Endpoint on buggy NEC controllers&quot;)
    > CC: stable@vger.kernel.org
    > Signed-off-by: Michal Pecio &lt;michal.pecio@gmail.com&gt;
    > Signed-off-by: Mathias Nyman &lt;mathias.nyman@linux.intel.com&gt;
    > Link: https://lore.kernel.org/r/20241106101459.775897-34-mathias.nyman@linux.intel.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ ARM: dts: omap36xx: declare 1GHz OPP as turbo again (@Andreas Kemnade in [522614145afdd4f](https://github.com/sophgo/linux-riscv/commit/522614145afdd4f) at 2024-12-05 13:02:49)
    > commit 96a64e9730c2c76cfa5c510583a0fbf40d62886b upstream.
    > Operating stable without reduced chip life at 1Ghz needs several
    > technologies working: The technologies involve
    > - SmartReflex
    > - DVFS
    > As this cannot directly specified in the OPP table as dependecies in the
    > devicetree yet, use the turbo flag again to mark this OPP as something
    > special to have some kind of opt-in.
    > So revert commit
    > 5f1bf7ae8481 (&quot;ARM: dts: omap36xx: Remove turbo mode for 1GHz variants&quot;)
    > Practical reasoning:
    > At least the GTA04A5 (DM3730) has become unstable with that OPP enabled.
    > Furthermore nothing enforces the availability of said technologies,
    > even in the kernel configuration, so allow users to rather opt-in.
    > Cc: Stable@vger.kernel.org
    > Fixes: 5f1bf7ae8481 (&quot;ARM: dts: omap36xx: Remove turbo mode for 1GHz variants&quot;)
    > Signed-off-by: Andreas Kemnade &lt;andreas@kemnade.info&gt;
    > Link: https://lore.kernel.org/r/20241018214727.275162-1-andreas@kemnade.info
    > Signed-off-by: Kevin Hilman &lt;khilman@baylibre.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ wifi: ath12k: fix crash when unbinding (@Jose Ignacio Tornos Martinez in [488d2959c28621e](https://github.com/sophgo/linux-riscv/commit/488d2959c28621e) at 2024-12-05 13:02:49)
    > commit 1304446f67863385dc4c914b6e0194f6664ee764 upstream.
    > If there is an error during some initialization related to firmware,
    > the function ath12k_dp_cc_cleanup is called to release resources.
    > However this is released again when the device is unbinded (ath12k_pci),
    > and we get:
    > BUG: kernel NULL pointer dereference, address: 0000000000000020
    > at RIP: 0010:ath12k_dp_cc_cleanup.part.0+0xb6/0x500 [ath12k]
    > Call Trace:
    > ath12k_dp_cc_cleanup
    > ath12k_dp_free
    > ath12k_core_deinit
    > ath12k_pci_remove
    > ...
    > The issue is always reproducible from a VM because the MSI addressing
    > initialization is failing.
    > In order to fix the issue, just set to NULL the released structure in
    > ath12k_dp_cc_cleanup at the end.
    > cc: stable@vger.kernel.org
    > Fixes: d889913205cf (&quot;wifi: ath12k: driver for Qualcomm Wi-Fi 7 devices&quot;)
    > Signed-off-by: Jose Ignacio Tornos Martinez &lt;jtornosm@redhat.com&gt;
    > Link: https://patch.msgid.link/20241017181004.199589-2-jtornosm@redhat.com
    > Signed-off-by: Jeff Johnson &lt;quic_jjohnson@quicinc.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ wifi: brcmfmac: release &#x27;root&#x27; node in all execution paths (@Javier Carrasco in [3d6a8b8595dd7c4](https://github.com/sophgo/linux-riscv/commit/3d6a8b8595dd7c4) at 2024-12-05 13:02:49)
    > commit 2e19a3b590ebf2e351fc9d0e7c323430e65b6b6d upstream.
    > The fixed patch introduced an additional condition to enter the scope
    > where the &#x27;root&#x27; device_node is released (!settings-&gt;board_type,
    > currently &#x27;err&#x27;), which avoid decrementing the refcount with a call to
    > of_node_put() if that second condition is not satisfied.
    > Move the call to of_node_put() to the point where &#x27;root&#x27; is no longer
    > required to avoid leaking the resource if err is not zero.
    > Cc: stable@vger.kernel.org
    > Fixes: 7682de8b3351 (&quot;wifi: brcmfmac: of: Fetch Apple properties&quot;)
    > Signed-off-by: Javier Carrasco &lt;javier.carrasco.cruz@gmail.com&gt;
    > Signed-off-by: Kalle Valo &lt;kvalo@kernel.org&gt;
    > Link: https://patch.msgid.link/20241030-brcmfmac-of-cleanup-v1-1-0b90eefb4279@gmail.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ wifi: nl80211: fix bounds checker error in nl80211_parse_sched_scan (@Aleksei Vetrov in [1a7b62ddf2c7642](https://github.com/sophgo/linux-riscv/commit/1a7b62ddf2c7642) at 2024-12-05 13:02:49)
    > commit 9c46a3a5b394d6d123866aa44436fc2cd342eb0d upstream.
    > The channels array in the cfg80211_scan_request has a __counted_by
    > attribute attached to it, which points to the n_channels variable. This
    > attribute is used in bounds checking, and if it is not set before the
    > array is filled, then the bounds sanitizer will issue a warning or a
    > kernel panic if CONFIG_UBSAN_TRAP is set.
    > This patch sets the size of allocated memory as the initial value for
    > n_channels. It is updated with the actual number of added elements after
    > the array is filled.
    > Fixes: aa4ec06c455d (&quot;wifi: cfg80211: use __counted_by where appropriate&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Aleksei Vetrov &lt;vvvvvv@google.com&gt;
    > Reviewed-by: Jeff Johnson &lt;quic_jjohnson@quicinc.com&gt;
    > Link: https://patch.msgid.link/20241029-nl80211_parse_sched_scan-bounds-checker-fix-v2-1-c804b787341f@google.com
    > Signed-off-by: Johannes Berg &lt;johannes.berg@intel.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ xhci: Don&#x27;t perform Soft Retry for Etron xHCI host (@Kuangyi Chiang in [a92cd42097f4a1a](https://github.com/sophgo/linux-riscv/commit/a92cd42097f4a1a) at 2024-12-05 13:02:48)
    > commit e735e957f2b9cfe4be486e0304732ec36928591f upstream.
    > Since commit f8f80be501aa (&quot;xhci: Use soft retry to recover faster from
    > transaction errors&quot;), unplugging USB device while enumeration results in
    > errors like this:
    > [ 364.855321] xhci_hcd 0000:0b:00.0: ERROR Transfer event for disabled endpoint slot 5 ep 2
    > [ 364.864622] xhci_hcd 0000:0b:00.0: @0000002167656d70 67f03000 00000021 0c000000 05038001
    > [ 374.934793] xhci_hcd 0000:0b:00.0: Abort failed to stop command ring: -110
    > [ 374.958793] xhci_hcd 0000:0b:00.0: xHCI host controller not responding, assume dead
    > [ 374.967590] xhci_hcd 0000:0b:00.0: HC died; cleaning up
    > [ 374.973984] xhci_hcd 0000:0b:00.0: Timeout while waiting for configure endpoint command
    > Seems that Etorn xHCI host can not perform Soft Retry correctly, apply
    > XHCI_NO_SOFT_RETRY quirk to disable Soft Retry and then issue is gone.
    > This patch depends on commit a4a251f8c235 (&quot;usb: xhci: do not perform
    > Soft Retry for some xHCI hosts&quot;).
    > Fixes: f8f80be501aa (&quot;xhci: Use soft retry to recover faster from transaction errors&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Kuangyi Chiang &lt;ki.chiang65@gmail.com&gt;
    > Signed-off-by: Mathias Nyman &lt;mathias.nyman@linux.intel.com&gt;
    > Link: https://lore.kernel.org/r/20241106101459.775897-21-mathias.nyman@linux.intel.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ xhci: Fix control transfer error on Etron xHCI host (@Kuangyi Chiang in [9258c9ed32294ce](https://github.com/sophgo/linux-riscv/commit/9258c9ed32294ce) at 2024-12-05 13:02:48)
    > commit 5e1c67abc9301d05130b7e267c204e7005503b33 upstream.
    > Performing a stability stress test on a USB3.0 2.5G ethernet adapter
    > results in errors like this:
    > [   91.441469] r8152 2-3:1.0 eth3: get_registers -71
    > [   91.458659] r8152 2-3:1.0 eth3: get_registers -71
    > [   91.475911] r8152 2-3:1.0 eth3: get_registers -71
    > [   91.493203] r8152 2-3:1.0 eth3: get_registers -71
    > [   91.510421] r8152 2-3:1.0 eth3: get_registers -71
    > The r8152 driver will periodically issue lots of control-IN requests
    > to access the status of ethernet adapter hardware registers during
    > the test.
    > This happens when the xHCI driver enqueue a control TD (which cross
    > over the Link TRB between two ring segments, as shown) in the endpoint
    > zero&#x27;s transfer ring. Seems the Etron xHCI host can not perform this
    > TD correctly, causing the USB transfer error occurred, maybe the upper
    > driver retry that control-IN request can solve problem, but not all
    > drivers do this.
    > |     |
    > -------
    > | TRB | Setup Stage
    > -------
    > | TRB | Link
    > -------
    > -------
    > | TRB | Data Stage
    > -------
    > | TRB | Status Stage
    > -------
    > |     |
    > To work around this, the xHCI driver should enqueue a No Op TRB if
    > next available TRB is the Link TRB in the ring segment, this can
    > prevent the Setup and Data Stage TRB to be breaked by the Link TRB.
    > Check if the XHCI_ETRON_HOST quirk flag is set before invoking the
    > workaround in xhci_queue_ctrl_tx().
    > Fixes: d0e96f5a71a0 (&quot;USB: xhci: Control transfer support.&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Kuangyi Chiang &lt;ki.chiang65@gmail.com&gt;
    > Signed-off-by: Mathias Nyman &lt;mathias.nyman@linux.intel.com&gt;
    > Link: https://lore.kernel.org/r/20241106101459.775897-20-mathias.nyman@linux.intel.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ xhci: Don&#x27;t issue Reset Device command to Etron xHCI host (@Kuangyi Chiang in [827f963a0b6c5e3](https://github.com/sophgo/linux-riscv/commit/827f963a0b6c5e3) at 2024-12-05 13:02:48)
    > commit 76d98856b1c6d06ce18f32c20527a4f9d283e660 upstream.
    > Sometimes the hub driver does not recognize the USB device connected
    > to the external USB2.0 hub when the system resumes from S4.
    > After the SetPortFeature(PORT_RESET) request is completed, the hub
    > driver calls the HCD reset_device callback, which will issue a Reset
    > Device command and free all structures associated with endpoints
    > that were disabled.
    > This happens when the xHCI driver issue a Reset Device command to
    > inform the Etron xHCI host that the USB device associated with a
    > device slot has been reset. Seems that the Etron xHCI host can not
    > perform this command correctly, affecting the USB device.
    > To work around this, the xHCI driver should obtain a new device slot
    > with reference to commit 651aaf36a7d7 (&quot;usb: xhci: Handle USB transaction
    > error on address command&quot;), which is another way to inform the Etron
    > xHCI host that the USB device has been reset.
    > Add a new XHCI_ETRON_HOST quirk flag to invoke the workaround in
    > xhci_discover_or_reset_device().
    > Fixes: 2a8f82c4ceaf (&quot;USB: xhci: Notify the xHC when a device is reset.&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Kuangyi Chiang &lt;ki.chiang65@gmail.com&gt;
    > Signed-off-by: Mathias Nyman &lt;mathias.nyman@linux.intel.com&gt;
    > Link: https://lore.kernel.org/r/20241106101459.775897-19-mathias.nyman@linux.intel.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ usb: xhci: Fix TD invalidation under pending Set TR Dequeue (@Michal Pecio in [61bce2d8fffc4a9](https://github.com/sophgo/linux-riscv/commit/61bce2d8fffc4a9) at 2024-12-05 13:02:48)
    > commit 484c3bab2d5dfa13ff659a51a06e9a393141eefc upstream.
    > xhci_invalidate_cancelled_tds() may not work correctly if the hardware
    > is modifying endpoint or stream contexts at the same time by executing
    > a Set TR Dequeue command. And even if it worked, it would be unable to
    > queue Set TR Dequeue for the next stream, failing to clear xHC cache.
    > On stream endpoints, a chain of Set TR Dequeue commands may take some
    > time to execute and we may want to cancel more TDs during this time.
    > Currently this leads to Stop Endpoint completion handler calling this
    > function without testing for SET_DEQ_PENDING, which will trigger the
    > aforementioned problems when it happens.
    > On all endpoints, a halt condition causes Reset Endpoint to be queued
    > and an error status given to the class driver, which may unlink more
    > URBs in response. Stop Endpoint is queued and its handler may execute
    > concurrently with Set TR Dequeue queued by Reset Endpoint handler.
    > (Reset Endpoint handler calls this function too, but there seems to
    > be no possibility of it running concurrently with Set TR Dequeue).
    > Fix xhci_invalidate_cancelled_tds() to work correctly under a pending
    > Set TR Dequeue. Bail out of the function when SET_DEQ_PENDING is set,
    > then make the completion handler call the function again and also call
    > xhci_giveback_invalidated_tds(), which needs to be called next.
    > This seems to fix another potential bug, where the handler would call
    > xhci_invalidate_cancelled_tds(), which may clear some deferred TDs if
    > a sanity check fails, and the TDs wouldn&#x27;t be given back promptly.
    > Said sanity check seems to be wrong and prone to false positives when
    > the endpoint halts, but fixing it is beyond the scope of this change,
    > besides ensuring that cleared TDs are given back properly.
    > Fixes: 5ceac4402f5d (&quot;xhci: Handle TD clearing for multiple streams case&quot;)
    > CC: stable@vger.kernel.org
    > Signed-off-by: Michal Pecio &lt;michal.pecio@gmail.com&gt;
    > Signed-off-by: Mathias Nyman &lt;mathias.nyman@linux.intel.com&gt;
    > Link: https://lore.kernel.org/r/20241106101459.775897-33-mathias.nyman@linux.intel.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ Bluetooth: Fix type of len in rfcomm_sock_getsockopt{,_old}() (@Andrej Shadura in [33209e6f29595a1](https://github.com/sophgo/linux-riscv/commit/33209e6f29595a1) at 2024-12-05 13:02:48)
    > commit 5fe6caa62b07fd39cd6a28acc8f92ba2955e11a6 upstream.
    > Commit 9bf4e919ccad worked around an issue introduced after an innocuous
    > optimisation change in LLVM main:
    > &gt; len is defined as an &#x27;int&#x27; because it is assigned from
    > &gt; &#x27;__user int *optlen&#x27;. However, it is clamped against the result of
    > &gt; sizeof(), which has a type of &#x27;size_t&#x27; (&#x27;unsigned long&#x27; for 64-bit
    > &gt; platforms). This is done with min_t() because min() requires compatible
    > &gt; types, which results in both len and the result of sizeof() being casted
    > &gt; to &#x27;unsigned int&#x27;, meaning len changes signs and the result of sizeof()
    > &gt; is truncated. From there, len is passed to copy_to_user(), which has a
    > &gt; third parameter type of &#x27;unsigned long&#x27;, so it is widened and changes
    > &gt; signs again. This excessive casting in combination with the KCSAN
    > &gt; instrumentation causes LLVM to fail to eliminate the __bad_copy_from()
    > &gt; call, failing the build.
    > The same issue occurs in rfcomm in functions rfcomm_sock_getsockopt and
    > rfcomm_sock_getsockopt_old.
    > Change the type of len to size_t in both rfcomm_sock_getsockopt and
    > rfcomm_sock_getsockopt_old and replace min_t() with min().
    > Cc: stable@vger.kernel.org
    > Co-authored-by: Aleksei Vetrov &lt;vvvvvv@google.com&gt;
    > Improves: 9bf4e919ccad (&quot;Bluetooth: Fix type of len in {l2cap,sco}_sock_getsockopt_old()&quot;)
    > Link: https://github.com/ClangBuiltLinux/linux/issues/2007
    > Link: https://github.com/llvm/llvm-project/issues/85647
    > Signed-off-by: Andrej Shadura &lt;andrew.shadura@collabora.co.uk&gt;
    > Reviewed-by: Nathan Chancellor &lt;nathan@kernel.org&gt;
    > Signed-off-by: Luiz Augusto von Dentz &lt;luiz.von.dentz@intel.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ usb: xhci: Limit Stop Endpoint retries (@Michal Pecio in [2637e8c5fb94703](https://github.com/sophgo/linux-riscv/commit/2637e8c5fb94703) at 2024-12-05 13:02:48)
    > commit 42b7581376015c1bbcbe5831f043cd0ac119d028 upstream.
    > Some host controllers fail to atomically transition an endpoint to the
    > Running state on a doorbell ring and enter a hidden &quot;Restarting&quot; state,
    > which looks very much like Stopped, with the important difference that
    > it will spontaneously transition to Running anytime soon.
    > A Stop Endpoint command queued in the Restarting state typically fails
    > with Context State Error and the completion handler sees the Endpoint
    > Context State as either still Stopped or already Running. Even a case
    > of Halted was observed, when an error occurred right after the restart.
    > The Halted state is already recovered from by resetting the endpoint.
    > The Running state is handled by retrying Stop Endpoint.
    > The Stopped state was recognized as a problem on NEC controllers and
    > worked around also by retrying, because the endpoint soon restarts and
    > then stops for good. But there is a risk: the command may fail if the
    > endpoint is &quot;stopped for good&quot; already, and retries will fail forever.
    > The possibility of this was not realized at the time, but a number of
    > cases were discovered later and reproduced. Some proved difficult to
    > deal with, and it is outright impossible to predict if an endpoint may
    > fail to ever start at all due to a hardware bug. One such bug (albeit
    > on ASM3142, not on NEC) was found to be reliably triggered simply by
    > toggling an AX88179 NIC up/down in a tight loop for a few seconds.
    > An endless retries storm is quite nasty. Besides putting needless load
    > on the xHC and CPU, it causes URBs never to be given back, paralyzing
    > the device and connection/disconnection logic for the whole bus if the
    > device is unplugged. User processes waiting for URBs become unkillable,
    > drivers and kworker threads lock up and xhci_hcd cannot be reloaded.
    > For peace of mind, impose a timeout on Stop Endpoint retries in this
    > case. If they don&#x27;t succeed in 100ms, consider the endpoint stopped
    > permanently for some reason and just give back the unlinked URBs. This
    > failure case is rare already and work is under way to make it rarer.
    > Start this work today by also handling one simple case of race with
    > Reset Endpoint, because it costs just two lines to implement.
    > Fixes: fd9d55d190c0 (&quot;xhci: retry Stop Endpoint on buggy NEC controllers&quot;)
    > CC: stable@vger.kernel.org
    > Signed-off-by: Michal Pecio &lt;michal.pecio@gmail.com&gt;
    > Signed-off-by: Mathias Nyman &lt;mathias.nyman@linux.intel.com&gt;
    > Link: https://lore.kernel.org/r/20241106101459.775897-32-mathias.nyman@linux.intel.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ xhci: Combine two if statements for Etron xHCI host (@Kuangyi Chiang in [218796e95aeff0e](https://github.com/sophgo/linux-riscv/commit/218796e95aeff0e) at 2024-12-05 13:02:48)
    > commit d7b11fe5790203fcc0db182249d7bfd945e44ccb upstream.
    > Combine two if statements, because these hosts have the same
    > quirk flags applied.
    > [Mathias: has stable tag because other fixes in series depend on this]
    > Fixes: 91f7a1524a92 (&quot;xhci: Apply broken streams quirk to Etron EJ188 xHCI host&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Kuangyi Chiang &lt;ki.chiang65@gmail.com&gt;
    > Signed-off-by: Mathias Nyman &lt;mathias.nyman@linux.intel.com&gt;
    > Link: https://lore.kernel.org/r/20241106101459.775897-18-mathias.nyman@linux.intel.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ pinctrl: qcom: spmi: fix debugfs drive strength (@Johan Hovold in [d66a757db1eb286](https://github.com/sophgo/linux-riscv/commit/d66a757db1eb286) at 2024-12-05 13:02:47)
    > commit 6bc0ebfb1d920f13c522545f114cdabb49e9408a upstream.
    > Commit 723e8462a4fe (&quot;pinctrl: qcom: spmi-gpio: Fix the GPIO strength
    > mapping&quot;) fixed a long-standing issue in the Qualcomm SPMI PMIC gpio
    > driver which had the &#x27;low&#x27; and &#x27;high&#x27; drive strength settings switched
    > but failed to update the debugfs interface which still gets this wrong.
    > Fix the debugfs code so that the exported values match the hardware
    > settings.
    > Note that this probably means that most devicetrees that try to describe
    > the firmware settings got this wrong if the settings were derived from
    > debugfs. Before the above mentioned commit the settings would have
    > actually matched the firmware settings even if they were described
    > incorrectly, but now they are inverted.
    > Fixes: 723e8462a4fe (&quot;pinctrl: qcom: spmi-gpio: Fix the GPIO strength mapping&quot;)
    > Fixes: eadff3024472 (&quot;pinctrl: Qualcomm SPMI PMIC GPIO pin controller driver&quot;)
    > Cc: Anjelique Melendez &lt;quic_amelende@quicinc.com&gt;
    > Cc: stable@vger.kernel.org	# 3.19
    > Signed-off-by: Johan Hovold &lt;johan+linaro@kernel.org&gt;
    > Reviewed-by: Konrad Dybcio &lt;konrad.dybcio@oss.qualcomm.com&gt;
    > Link: https://lore.kernel.org/20241025121622.1496-1-johan+linaro@kernel.org
    > Signed-off-by: Linus Walleij &lt;linus.walleij@linaro.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ exfat: fix uninit-value in __exfat_get_dentry_set (@Namjae Jeon in [c500b0cca21a19f](https://github.com/sophgo/linux-riscv/commit/c500b0cca21a19f) at 2024-12-05 13:02:47)
    > commit 02dffe9ab092fc4c8800aee68cb7eafd37a980c4 upstream.
    > There is no check if stream size and start_clu are invalid.
    > If start_clu is EOF cluster and stream size is 4096, It will
    > cause uninit value access. because ei-&gt;hint_femp.eidx could
    > be 128(if cluster size is 4K) and wrong hint will allocate
    > next cluster. and this cluster will be same with the cluster
    > that is allocated by exfat_extend_valid_size(). The previous
    > patch will check invalid start_clu, but for clarity, initialize
    > hint_femp.eidx to zero.
    > Cc: stable@vger.kernel.org
    > Reported-by: syzbot+01218003be74b5e1213a@syzkaller.appspotmail.com
    > Tested-by: syzbot+01218003be74b5e1213a@syzkaller.appspotmail.com
    > Reviewed-by: Yuezhang Mo &lt;Yuezhang.Mo@sony.com&gt;
    > Signed-off-by: Namjae Jeon &lt;linkinjeon@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ dt-bindings: pinctrl: samsung: Fix interrupt constraint for variants with fallbacks (@Krzysztof Kozlowski in [c2fa62fc872bcad](https://github.com/sophgo/linux-riscv/commit/c2fa62fc872bcad) at 2024-12-05 13:02:47)
    > commit ffb30875172eabff727e2896f097ccd4bb68723f upstream.
    > Commit 904140fa4553 (&quot;dt-bindings: pinctrl: samsung: use Exynos7
    > fallbacks for newer wake-up controllers&quot;) added
    > samsung,exynos7-wakeup-eint fallback to some compatibles, so the
    > intention in the if:then: conditions was to handle the cases:
    > 1. Single Exynos7 compatible or Exynos5433+Exynos7 or
    > Exynos7885+Exynos7: only one interrupt
    > 2. Exynos850+Exynos7: no interrupts
    > This was not implemented properly however and if:then: block matches
    > only single Exynos5433 or Exynos7885 compatibles, which do not exist in
    > DTS anymore, so basically is a no-op and no enforcement on number of
    > interrupts is made by the binding.
    > Fix the if:then: condition so interrupts in the Exynos5433 and
    > Exynos7885 wake-up pin controller will be properly constrained.
    > Fixes: 904140fa4553 (&quot;dt-bindings: pinctrl: samsung: use Exynos7 fallbacks for newer wake-up controllers&quot;)
    > Cc: stable@vger.kernel.org
    > Acked-by: Rob Herring (Arm) &lt;robh@kernel.org&gt;
    > Reviewed-by: Linus Walleij &lt;linus.walleij@linaro.org&gt;
    > Link: https://lore.kernel.org/r/20241015065848.29429-1-krzysztof.kozlowski@linaro.org
    > Signed-off-by: Krzysztof Kozlowski &lt;krzysztof.kozlowski@linaro.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ fcntl: make F_DUPFD_QUERY associative (@Christian Brauner in [a4fc6966d83b9e2](https://github.com/sophgo/linux-riscv/commit/a4fc6966d83b9e2) at 2024-12-05 13:02:47)
    > commit 2714b0d1f36999dbd99a3474a24e7301acbd74f1 upstream.
    > Currently when passing a closed file descriptor to
    > fcntl(fd, F_DUPFD_QUERY, fd_dup) the order matters:
    > fd &#x3D; open(&quot;/dev/null&quot;);
    > fd_dup &#x3D; dup(fd);
    > When we now close one of the file descriptors we get:
    > (1) fcntl(fd, fd_dup) // -EBADF
    > (2) fcntl(fd_dup, fd) // 0 aka not equal
    > depending on which file descriptor is passed first. That&#x27;s not a huge
    > deal but it gives the api I slightly weird feel. Make it so that the
    > order doesn&#x27;t matter by requiring that both file descriptors are valid:
    > (1&#x27;) fcntl(fd, fd_dup) // -EBADF
    > (2&#x27;) fcntl(fd_dup, fd) // -EBADF
    > Link: https://lore.kernel.org/r/20241008-duften-formel-251f967602d5@brauner
    > Fixes: c62b758bae6a (&quot;fcntl: add F_DUPFD_QUERY fcntl()&quot;)
    > Reviewed-by: Jeff Layton &lt;jlayton@kernel.org&gt;
    > Reviewed-By: Lennart Poettering &lt;lennart@poettering.net&gt;
    > Cc: stable@vger.kernel.org
    > Reported-by: Lennart Poettering &lt;lennart@poettering.net&gt;
    > Signed-off-by: Christian Brauner &lt;brauner@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ exfat: fix out-of-bounds access of directory entries (@Yuezhang Mo in [3ddd1cb2b458ff6](https://github.com/sophgo/linux-riscv/commit/3ddd1cb2b458ff6) at 2024-12-05 13:02:47)
    > commit 184fa506e392eb78364d9283c961217ff2c0617b upstream.
    > In the case of the directory size is greater than or equal to
    > the cluster size, if start_clu becomes an EOF cluster(an invalid
    > cluster) due to file system corruption, then the directory entry
    > where ei-&gt;hint_femp.eidx hint is outside the directory, resulting
    > in an out-of-bounds access, which may cause further file system
    > corruption.
    > This commit adds a check for start_clu, if it is an invalid cluster,
    > the file or directory will be treated as empty.
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Yuezhang Mo &lt;Yuezhang.Mo@sony.com&gt;
    > Co-developed-by: Namjae Jeon &lt;linkinjeon@kernel.org&gt;
    > Signed-off-by: Namjae Jeon &lt;linkinjeon@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ dt-bindings: iio: dac: ad3552r: fix maximum spi speed (@Angelo Dureghello in [2efa8def4a3ff9d](https://github.com/sophgo/linux-riscv/commit/2efa8def4a3ff9d) at 2024-12-05 13:02:47)
    > commit d1d1c117f39b2057d1e978f26a8bd9631ddb193b upstream.
    > Fix maximum SPI clock speed, as per datasheet (Rev. B, page 6).
    > Fixes: b0a96c5f599e (&quot;dt-bindings: iio: dac: Add adi,ad3552r.yaml&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Angelo Dureghello &lt;adureghello@baylibre.com&gt;
    > Acked-by: Krzysztof Kozlowski &lt;krzysztof.kozlowski@linaro.org&gt;
    > Link: https://patch.msgid.link/20241003-wip-bl-ad3552r-axi-v0-iio-testing-v4-4-ceb157487329@baylibre.com
    > Signed-off-by: Jonathan Cameron &lt;Jonathan.Cameron@huawei.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ apparmor: test: Fix memory leak for aa_unpack_strdup() (@Jinjie Ruan in [d62ee5739a66644](https://github.com/sophgo/linux-riscv/commit/d62ee5739a66644) at 2024-12-05 13:02:46)
    > commit 7290f59231910ccba427d441a6e8b8c6f6112448 upstream.
    > The string allocated by kmemdup() in aa_unpack_strdup() is not
    > freed and cause following memory leaks, free them to fix it.
    > unreferenced object 0xffffff80c6af8a50 (size 8):
    > comm &quot;kunit_try_catch&quot;, pid 225, jiffies 4294894407
    > hex dump (first 8 bytes):
    > 74 65 73 74 69 6e 67 00                          testing.
    > backtrace (crc 5eab668b):
    > [&lt;0000000001e3714d&gt;] kmemleak_alloc+0x34/0x40
    > [&lt;000000006e6c7776&gt;] __kmalloc_node_track_caller_noprof+0x300/0x3e0
    > [&lt;000000006870467c&gt;] kmemdup_noprof+0x34/0x60
    > [&lt;000000001176bb03&gt;] aa_unpack_strdup+0xd0/0x18c
    > [&lt;000000008ecde918&gt;] policy_unpack_test_unpack_strdup_with_null_name+0xf8/0x3ec
    > [&lt;0000000032ef8f77&gt;] kunit_try_run_case+0x13c/0x3ac
    > [&lt;00000000f3edea23&gt;] kunit_generic_run_threadfn_adapter+0x80/0xec
    > [&lt;00000000adf936cf&gt;] kthread+0x2e8/0x374
    > [&lt;0000000041bb1628&gt;] ret_from_fork+0x10/0x20
    > unreferenced object 0xffffff80c2a29090 (size 8):
    > comm &quot;kunit_try_catch&quot;, pid 227, jiffies 4294894409
    > hex dump (first 8 bytes):
    > 74 65 73 74 69 6e 67 00                          testing.
    > backtrace (crc 5eab668b):
    > [&lt;0000000001e3714d&gt;] kmemleak_alloc+0x34/0x40
    > [&lt;000000006e6c7776&gt;] __kmalloc_node_track_caller_noprof+0x300/0x3e0
    > [&lt;000000006870467c&gt;] kmemdup_noprof+0x34/0x60
    > [&lt;000000001176bb03&gt;] aa_unpack_strdup+0xd0/0x18c
    > [&lt;0000000046a45c1a&gt;] policy_unpack_test_unpack_strdup_with_name+0xd0/0x3c4
    > [&lt;0000000032ef8f77&gt;] kunit_try_run_case+0x13c/0x3ac
    > [&lt;00000000f3edea23&gt;] kunit_generic_run_threadfn_adapter+0x80/0xec
    > [&lt;00000000adf936cf&gt;] kthread+0x2e8/0x374
    > [&lt;0000000041bb1628&gt;] ret_from_fork+0x10/0x20
    > Cc: stable@vger.kernel.org
    > Fixes: 4d944bcd4e73 (&quot;apparmor: add AppArmor KUnit tests for policy unpack&quot;)
    > Signed-off-by: Jinjie Ruan &lt;ruanjinjie@huawei.com&gt;
    > Signed-off-by: John Johansen &lt;john.johansen@canonical.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ locking/lockdep: Avoid creating new name string literals in lockdep_set_subclass() (@Ahmed Ehab in [88232a223ae4781](https://github.com/sophgo/linux-riscv/commit/88232a223ae4781) at 2024-12-05 13:02:46)
    > commit d7fe143cb115076fed0126ad8cf5ba6c3e575e43 upstream.
    > Syzbot reports a problem that a warning will be triggered while
    > searching a lock class in look_up_lock_class().
    > The cause of the issue is that a new name is created and used by
    > lockdep_set_subclass() instead of using the existing one. This results
    > in a lock instance has a different name pointer than previous registered
    > one stored in lock class, and WARN_ONCE() is triggered because of that
    > in look_up_lock_class().
    > To fix this, change lockdep_set_subclass() to use the existing name
    > instead of a new one. Hence, no new name will be created by
    > lockdep_set_subclass(). Hence, the warning is avoided.
    > [boqun: Reword the commit log to state the correct issue]
    > Reported-by: &lt;syzbot+7f4a6f7f7051474e40ad@syzkaller.appspotmail.com&gt;
    > Fixes: de8f5e4f2dc1f (&quot;lockdep: Introduce wait-type checks&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Ahmed Ehab &lt;bottaawesome633@gmail.com&gt;
    > Signed-off-by: Boqun Feng &lt;boqun.feng@gmail.com&gt;
    > Link: https://lore.kernel.org/lkml/20240824221031.7751-1-bottaawesome633@gmail.com/
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ fsnotify: Fix ordering of iput() and watched_objects decrement (@Jann Horn in [83af1cfa10d9aaf](https://github.com/sophgo/linux-riscv/commit/83af1cfa10d9aaf) at 2024-12-05 13:02:46)
    > commit 21d1b618b6b9da46c5116c640ac4b1cc8d40d63a upstream.
    > Ensure the superblock is kept alive until we&#x27;re done with iput().
    > Holding a reference to an inode is not allowed unless we ensure the
    > superblock stays alive, which fsnotify does by keeping the
    > watched_objects count elevated, so iput() must happen before the
    > watched_objects decrement.
    > This can lead to a UAF of something like sb-&gt;s_fs_info in tmpfs, but the
    > UAF is hard to hit because race orderings that oops are more likely, thanks
    > to the CHECK_DATA_CORRUPTION() block in generic_shutdown_super().
    > Also, ensure that fsnotify_put_sb_watched_objects() doesn&#x27;t call
    > fsnotify_sb_watched_objects() on a superblock that may have already been
    > freed, which would cause a UAF read of sb-&gt;s_fsnotify_info.
    > Cc: stable@kernel.org
    > Fixes: d2f277e26f52 (&quot;fsnotify: rename fsnotify_{get,put}_sb_connectors()&quot;)
    > Signed-off-by: Jann Horn &lt;jannh@google.com&gt;
    > Signed-off-by: Jan Kara &lt;jack@suse.cz&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ tty: ldsic: fix tty_ldisc_autoload sysctl&#x27;s proc_handler (@Nicolas Bouchinet in [53bbfa689670d00](https://github.com/sophgo/linux-riscv/commit/53bbfa689670d00) at 2024-12-05 13:02:46)
    > commit 635a9fca54f4f4148be1ae1c7c6bd37af80f5773 upstream.
    > Commit 7c0cca7c847e (&quot;tty: ldisc: add sysctl to prevent autoloading of
    > ldiscs&quot;) introduces the tty_ldisc_autoload sysctl with the wrong
    > proc_handler. .extra1 and .extra2 parameters are set to avoid other values
    > thant SYSCTL_ZERO or SYSCTL_ONE to be set but proc_dointvec do not uses
    > them.
    > This commit fixes this by using proc_dointvec_minmax instead of
    > proc_dointvec.
    > Fixes: 7c0cca7c847e (&quot;tty: ldisc: add sysctl to prevent autoloading of ldiscs&quot;)
    > Cc: stable &lt;stable@kernel.org&gt;
    > Signed-off-by: Nicolas Bouchinet &lt;nicolas.bouchinet@ssi.gouv.fr&gt;
    > Reviewed-by: Lin Feng &lt;linf@wangsu.com&gt;
    > Reviewed-by: Jiri Slaby &lt;jirislaby@kernel.org&gt;
    > Link: https://lore.kernel.org/r/20241112131357.49582-4-nicolas.bouchinet@clip-os.org
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ tools/nolibc: s390: include std.h (@Thomas Weißschuh in [2bd8303a2391d30](https://github.com/sophgo/linux-riscv/commit/2bd8303a2391d30) at 2024-12-05 13:02:46)
    > commit 711b5875814b2a0e9a5aaf7a85ba7c80f5a389b1 upstream.
    > arch-s390.h uses types from std.h, but does not include it.
    > Depending on the inclusion order the compilation can fail.
    > Include std.h explicitly to avoid these errors.
    > Fixes: 404fa87c0eaf (&quot;tools/nolibc: s390: provide custom implementation for sys_fork&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Thomas Weißschuh &lt;thomas.weissschuh@linutronix.de&gt;
    > Link: https://lore.kernel.org/r/20240927-nolibc-s390-std-h-v1-1-30442339a6b9@linutronix.de
    > Signed-off-by: Thomas Weißschuh &lt;linux@weissschuh.net&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ comedi: Flush partial mappings in error case (@Jann Horn in [297f14fbb81895f](https://github.com/sophgo/linux-riscv/commit/297f14fbb81895f) at 2024-12-05 13:02:46)
    > commit ce8f9fb651fac95dd41f69afe54d935420b945bd upstream.
    > If some remap_pfn_range() calls succeeded before one failed, we still have
    > buffer pages mapped into the userspace page tables when we drop the buffer
    > reference with comedi_buf_map_put(bm). The userspace mappings are only
    > cleaned up later in the mmap error path.
    > Fix it by explicitly flushing all mappings in our VMA on the error path.
    > See commit 79a61cc3fc04 (&quot;mm: avoid leaving partial pfn mappings around in
    > error case&quot;).
    > Cc: stable@vger.kernel.org
    > Fixes: ed9eccbe8970 (&quot;Staging: add comedi core&quot;)
    > Signed-off-by: Jann Horn &lt;jannh@google.com&gt;
    > Link: https://lore.kernel.org/r/20241017-comedi-tlb-v3-1-16b82f9372ce@google.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ iio: dac: adi-axi-dac: fix wrong register bitfield (@Angelo Dureghello in [22840f10787c7cb](https://github.com/sophgo/linux-riscv/commit/22840f10787c7cb) at 2024-12-05 13:02:46)
    > commit 70602f529e4d76798c95aeed5ce2a8d36263abe5 upstream.
    > Fix ADI_DAC_R1_MODE of AXI_DAC_REG_CNTRL_2.
    > Both generic DAC and ad3552r DAC IPs docs are reporting
    > bit 5 for it.
    > Link: https://wiki.analog.com/resources/fpga/docs/axi_dac_ip
    > Fixes: 4e3949a192e4 (&quot;iio: dac: add support for AXI DAC IP core&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Angelo Dureghello &lt;adureghello@baylibre.com&gt;
    > Reviewed-by: Nuno Sa &lt;nuno.sa@analog.com&gt;
    > Link: https://patch.msgid.link/20241008-wip-bl-ad3552r-axi-v0-iio-testing-v5-1-3d410944a63d@baylibre.com
    > Signed-off-by: Jonathan Cameron &lt;Jonathan.Cameron@huawei.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ Compiler Attributes: disable __counted_by for clang &lt; 19.1.3 (@Jan Hendrik Farr in [e46d4caa776f08a](https://github.com/sophgo/linux-riscv/commit/e46d4caa776f08a) at 2024-12-05 13:02:45)
    > commit f06e108a3dc53c0f5234d18de0bd224753db5019 upstream.
    > This patch disables __counted_by for clang versions &lt; 19.1.3 because
    > of the two issues listed below. It does this by introducing
    > CONFIG_CC_HAS_COUNTED_BY.
    > 1. clang &lt; 19.1.2 has a bug that can lead to __bdos returning 0:
    > https://github.com/llvm/llvm-project/pull/110497
    > 2. clang &lt; 19.1.3 has a bug that can lead to __bdos being off by 4:
    > https://github.com/llvm/llvm-project/pull/112636
    > Fixes: c8248faf3ca2 (&quot;Compiler Attributes: counted_by: Adjust name and identifier expansion&quot;)
    > Cc: stable@vger.kernel.org # 6.6.x: 16c31dd7fdf6: Compiler Attributes: counted_by: bump min gcc version
    > Cc: stable@vger.kernel.org # 6.6.x: 2993eb7a8d34: Compiler Attributes: counted_by: fixup clang URL
    > Cc: stable@vger.kernel.org # 6.6.x: 231dc3f0c936: lkdtm/bugs: Improve warning message for compilers without counted_by support
    > Cc: stable@vger.kernel.org # 6.6.x
    > Reported-by: Nathan Chancellor &lt;nathan@kernel.org&gt;
    > Closes: https://lore.kernel.org/all/20240913164630.GA4091534@thelio-3990X/
    > Reported-by: kernel test robot &lt;oliver.sang@intel.com&gt;
    > Closes: https://lore.kernel.org/oe-lkp/202409260949.a1254989-oliver.sang@intel.com
    > Link: https://lore.kernel.org/all/Zw8iawAF5W2uzGuh@archlinux/T/#m204c09f63c076586a02d194b87dffc7e81b8de7b
    > Suggested-by: Nathan Chancellor &lt;nathan@kernel.org&gt;
    > Signed-off-by: Jan Hendrik Farr &lt;kernel@jfarr.cc&gt;
    > Reviewed-by: Nathan Chancellor &lt;nathan@kernel.org&gt;
    > Tested-by: Nathan Chancellor &lt;nathan@kernel.org&gt;
    > Reviewed-by: Miguel Ojeda &lt;ojeda@kernel.org&gt;
    > Reviewed-by: Thorsten Blum &lt;thorsten.blum@linux.dev&gt;
    > Link: https://lore.kernel.org/r/20241029140036.577804-2-kernel@jfarr.cc
    > Signed-off-by: Kees Cook &lt;kees@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ fsnotify: fix sending inotify event with unexpected filename (@Amir Goldstein in [a6b283526b8415b](https://github.com/sophgo/linux-riscv/commit/a6b283526b8415b) at 2024-12-05 13:02:45)
    > commit aa52c54da40d9eee3ba87c05cdcb0cd07c04fa13 upstream.
    > We got a report that adding a fanotify filsystem watch prevents tail -f
    > from receiving events.
    > Reproducer:
    > 1. Create 3 windows / login sessions. Become root in each session.
    > 2. Choose a mounted filesystem that is pretty quiet; I picked /boot.
    > 3. In the first window, run: fsnotifywait -S -m /boot
    > 4. In the second window, run: echo data &gt;&gt; /boot/foo
    > 5. In the third window, run: tail -f /boot/foo
    > 6. Go back to the second window and run: echo more data &gt;&gt; /boot/foo
    > 7. Observe that the tail command doesn&#x27;t show the new data.
    > 8. In the first window, hit control-C to interrupt fsnotifywait.
    > 9. In the second window, run: echo still more data &gt;&gt; /boot/foo
    > 10. Observe that the tail command in the third window has now printed
    > the missing data.
    > When stracing tail, we observed that when fanotify filesystem mark is
    > set, tail does get the inotify event, but the event is receieved with
    > the filename:
    > read(4, &quot;\1\0\0\0\2\0\0\0\0\0\0\0\20\0\0\0foo\0\0\0\0\0\0\0\0\0\0\0\0\0&quot;,
    > 50) &#x3D; 32
    > This is unexpected, because tail is watching the file itself and not its
    > parent and is inconsistent with the inotify event received by tail when
    > fanotify filesystem mark is not set:
    > read(4, &quot;\1\0\0\0\2\0\0\0\0\0\0\0\0\0\0\0&quot;, 50) &#x3D; 16
    > The inteference between different fsnotify groups was caused by the fact
    > that the mark on the sb requires the filename, so the filename is passed
    > to fsnotify().  Later on, fsnotify_handle_event() tries to take care of
    > not passing the filename to groups (such as inotify) that are interested
    > in the filename only when the parent is watching.
    > But the logic was incorrect for the case that no group is watching the
    > parent, some groups are watching the sb and some watching the inode.
    > Reported-by: Miklos Szeredi &lt;miklos@szeredi.hu&gt;
    > Fixes: 7372e79c9eb9 (&quot;fanotify: fix logic of reporting name info with watched parent&quot;)
    > Cc: stable@vger.kernel.org # 5.10+
    > Signed-off-by: Amir Goldstein &lt;amir73il@gmail.com&gt;
    > Signed-off-by: Jan Kara &lt;jack@suse.cz&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ LoongArch: Explicitly specify code model in Makefile (@Huacai Chen in [7b3a7918f10dbc3](https://github.com/sophgo/linux-riscv/commit/7b3a7918f10dbc3) at 2024-12-05 13:02:45)
    > commit e67e0eb6a98b261caf45048f9eb95fd7609289c0 upstream.
    > LoongArch&#x27;s toolchain may change the default code model from normal to
    > medium. This is unnecessary for kernel, and generates some relocations
    > which cannot be handled by the module loader. So explicitly specify the
    > code model to normal in Makefile (for Rust &#x27;normal&#x27; is &#x27;small&#x27;).
    > Cc: stable@vger.kernel.org
    > Tested-by: Haiyong Sun &lt;sunhaiyong@loongson.cn&gt;
    > Signed-off-by: Huacai Chen &lt;chenhuacai@loongson.cn&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ PCI: Fix use-after-free of slot-&gt;bus on hot remove (@Lukas Wunner in [69d2ceac11acf85](https://github.com/sophgo/linux-riscv/commit/69d2ceac11acf85) at 2024-12-05 13:02:45)
    > commit c7acef99642b763ba585f4a43af999fcdbcc3dc4 upstream.
    > Dennis reports a boot crash on recent Lenovo laptops with a USB4 dock.
    > Since commit 0fc70886569c (&quot;thunderbolt: Reset USB4 v2 host router&quot;) and
    > commit 59a54c5f3dbd (&quot;thunderbolt: Reset topology created by the boot
    > firmware&quot;), USB4 v2 and v1 Host Routers are reset on probe of the
    > thunderbolt driver.
    > The reset clears the Presence Detect State and Data Link Layer Link Active
    > bits at the USB4 Host Router&#x27;s Root Port and thus causes hot removal of the
    > dock.
    > The crash occurs when pciehp is unbound from one of the dock&#x27;s Downstream
    > Ports:  pciehp creates a pci_slot on bind and destroys it on unbind.  The
    > pci_slot contains a pointer to the pci_bus below the Downstream Port, but
    > a reference on that pci_bus is never acquired.  The pci_bus is destroyed
    > before the pci_slot, so a use-after-free ensues when pci_slot_release()
    > accesses slot-&gt;bus.
    > In principle this should not happen because pci_stop_bus_device() unbinds
    > pciehp (and therefore destroys the pci_slot) before the pci_bus is
    > destroyed by pci_remove_bus_device().
    > However the stacktrace provided by Dennis shows that pciehp is unbound from
    > pci_remove_bus_device() instead of pci_stop_bus_device().  To understand
    > the significance of this, one needs to know that the PCI core uses a two
    > step process to remove a portion of the hierarchy:  It first unbinds all
    > drivers in the sub-hierarchy in pci_stop_bus_device() and then actually
    > removes the devices in pci_remove_bus_device().  There is no precaution to
    > prevent driver binding in-between pci_stop_bus_device() and
    > pci_remove_bus_device().
    > In Dennis&#x27; case, it seems removal of the hierarchy by pciehp races with
    > driver binding by pci_bus_add_devices().  pciehp is bound to the
    > Downstream Port after pci_stop_bus_device() has run, so it is unbound by
    > pci_remove_bus_device() instead of pci_stop_bus_device().  Because the
    > pci_bus has already been destroyed at that point, accesses to it result in
    > a use-after-free.
    > One might conclude that driver binding needs to be prevented after
    > pci_stop_bus_device() has run.  However it seems risky that pci_slot points
    > to pci_bus without holding a reference.  Solely relying on correct ordering
    > of driver unbind versus pci_bus destruction is certainly not defensive
    > programming.
    > If pci_slot has a need to access data in pci_bus, it ought to acquire a
    > reference.  Amend pci_create_slot() accordingly.  Dennis reports that the
    > crash is not reproducible with this change.
    > Abridged stacktrace:
    > pcieport 0000:00:07.0: PME: Signaling with IRQ 156
    > pcieport 0000:00:07.0: pciehp: Slot #12 AttnBtn- PwrCtrl- MRL- AttnInd- PwrInd- HotPlug+ Surprise+ Interlock- NoCompl+ IbPresDis- LLActRep+
    > pci_bus 0000:20: dev 00, created physical slot 12
    > pcieport 0000:00:07.0: pciehp: Slot(12): Card not present
    > ...
    > pcieport 0000:21:02.0: pciehp: pcie_disable_notification: SLOTCTRL d8 write cmd 0
    > Oops: general protection fault, probably for non-canonical address 0x6b6b6b6b6b6b6b6b: 0000 [#1] PREEMPT SMP NOPTI
    > CPU: 13 UID: 0 PID: 134 Comm: irq/156-pciehp Not tainted 6.11.0-devel+ #1
    > RIP: 0010:dev_driver_string+0x12/0x40
    > pci_destroy_slot
    > pciehp_remove
    > pcie_port_remove_service
    > device_release_driver_internal
    > bus_remove_device
    > device_del
    > device_unregister
    > remove_iter
    > device_for_each_child
    > pcie_portdrv_remove
    > pci_device_remove
    > device_release_driver_internal
    > bus_remove_device
    > device_del
    > pci_remove_bus_device (recursive invocation)
    > pci_remove_bus_device
    > pciehp_unconfigure_device
    > pciehp_disable_slot
    > pciehp_handle_presence_or_link_change
    > pciehp_ist
    > Link: https://lore.kernel.org/r/4bfd4c0e976c1776cd08e76603903b338cf25729.1728579288.git.lukas@wunner.de
    > Reported-by: Dennis Wassenberg &lt;Dennis.Wassenberg@secunet.com&gt;
    > Closes: https://lore.kernel.org/r/6de4b45ff2b32dd91a805ec02ec8ec73ef411bf6.camel@secunet.com/
    > Tested-by: Dennis Wassenberg &lt;Dennis.Wassenberg@secunet.com&gt;
    > Signed-off-by: Lukas Wunner &lt;lukas@wunner.de&gt;
    > Signed-off-by: Bjorn Helgaas &lt;bhelgaas@google.com&gt;
    > Reviewed-by: Mika Westerberg &lt;mika.westerberg@linux.intel.com&gt;
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ clk: clk-loongson2: Fix potential buffer overflow in flexible-array member access (@Gustavo A. R. Silva in [1bf8877150128c3](https://github.com/sophgo/linux-riscv/commit/1bf8877150128c3) at 2024-12-05 13:02:45)
    > commit 02fb4f0084331ef72c28d0c70fcb15d1bea369ec upstream.
    > Flexible-array member &#x60;hws&#x60; in &#x60;struct clk_hw_onecell_data&#x60; is annotated
    > with the &#x60;counted_by()&#x60; attribute. This means that when memory is
    > allocated for this array, the _counter_, which in this case is member
    > &#x60;num&#x60; in the flexible structure, should be set to the maximum number of
    > elements the flexible array can contain, or fewer.
    > In this case, the total number of elements for the flexible array is
    > determined by variable &#x60;clks_num&#x60; when allocating heap space via
    > &#x60;devm_kzalloc()&#x60;, as shown below:
    > 289         struct loongson2_clk_provider *clp;
    > ...
    > 296         for (p &#x3D; data; p-&gt;name; p++)
    > 297                 clks_num++;
    > 298
    > 299         clp &#x3D; devm_kzalloc(dev, struct_size(clp, clk_data.hws, clks_num),
    > 300                            GFP_KERNEL);
    > So, &#x60;clp-&gt;clk_data.num&#x60; should be set to &#x60;clks_num&#x60; or less, and not
    > exceed &#x60;clks_num&#x60;, as is currently the case. Otherwise, if data is
    > written into &#x60;clp-&gt;clk_data.hws[clks_num]&#x60;, the instrumentation
    > provided by the compiler won&#x27;t detect the overflow, leading to a
    > memory corruption bug at runtime.
    > Fix this issue by setting &#x60;clp-&gt;clk_data.num&#x60; to &#x60;clks_num&#x60;.
    > Fixes: 9796ec0bd04b (&quot;clk: clk-loongson2: Refactor driver for adding new platforms&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Gustavo A. R. Silva &lt;gustavoars@kernel.org&gt;
    > Link: https://lore.kernel.org/r/ZzaN5MpmMr0hwHw9@kspp
    > Signed-off-by: Stephen Boyd &lt;sboyd@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ clk: clk-loongson2: Fix memory corruption bug in struct loongson2_clk_provider (@Gustavo A. R. Silva in [145de18065b9840](https://github.com/sophgo/linux-riscv/commit/145de18065b9840) at 2024-12-05 13:02:45)
    > commit 6e4bf018bb040955da53dae9f8628ef8fcec2dbe upstream.
    > Some heap space is allocated for the flexible structure &#x60;struct
    > clk_hw_onecell_data&#x60; and its flexible-array member &#x60;hws&#x60; through
    > the composite structure &#x60;struct loongson2_clk_provider&#x60; in function
    > &#x60;loongson2_clk_probe()&#x60;, as shown below:
    > 289         struct loongson2_clk_provider *clp;
    > ...
    > 296         for (p &#x3D; data; p-&gt;name; p++)
    > 297                 clks_num++;
    > 298
    > 299         clp &#x3D; devm_kzalloc(dev, struct_size(clp, clk_data.hws, clks_num),
    > 300                            GFP_KERNEL);
    > Then some data is written into the flexible array:
    > 350                 clp-&gt;clk_data.hws[p-&gt;id] &#x3D; hw;
    > This corrupts &#x60;clk_lock&#x60;, which is the spinlock variable immediately
    > following the &#x60;clk_data&#x60; member in &#x60;struct loongson2_clk_provider&#x60;:
    > struct loongson2_clk_provider {
    > void __iomem *base;
    > struct device *dev;
    > struct clk_hw_onecell_data clk_data;
    > spinlock_t clk_lock;	/* protect access to DIV registers */
    > };
    > The problem is that the flexible structure is currently placed in the
    > middle of &#x60;struct loongson2_clk_provider&#x60; instead of at the end.
    > Fix this by moving &#x60;struct clk_hw_onecell_data clk_data;&#x60; to the end of
    > &#x60;struct loongson2_clk_provider&#x60;. Also, add a code comment to help
    > prevent this from happening again in case new members are added to the
    > structure in the future.
    > This change also fixes the following -Wflex-array-member-not-at-end
    > warning:
    > drivers/clk/clk-loongson2.c:32:36: warning: structure containing a flexible array member is not at the end of another structure [-Wflex-array-member-not-at-end]
    > Fixes: 9796ec0bd04b (&quot;clk: clk-loongson2: Refactor driver for adding new platforms&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Gustavo A. R. Silva &lt;gustavoars@kernel.org&gt;
    > Link: https://lore.kernel.org/r/ZzZ-cd_EFXs6qFaH@kspp
    > Signed-off-by: Stephen Boyd &lt;sboyd@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ KVM: arm64: vgic-its: Clear DTE when MAPD unmaps a device (@Kunkun Jiang in [1059f1e5f5c0657](https://github.com/sophgo/linux-riscv/commit/1059f1e5f5c0657) at 2024-12-05 13:02:45)
    > commit e9649129d33dca561305fc590a7c4ba8c3e5675a upstream.
    > vgic_its_save_device_tables will traverse its-&gt;device_list to
    > save DTE for each device. vgic_its_restore_device_tables will
    > traverse each entry of device table and check if it is valid.
    > Restore if valid.
    > But when MAPD unmaps a device, it does not invalidate the
    > corresponding DTE. In the scenario of continuous saves
    > and restores, there may be a situation where a device&#x27;s DTE
    > is not saved but is restored. This is unreasonable and may
    > cause restore to fail. This patch clears the corresponding
    > DTE when MAPD unmaps a device.
    > Cc: stable@vger.kernel.org
    > Fixes: 57a9a117154c (&quot;KVM: arm64: vgic-its: Device table save/restore&quot;)
    > Co-developed-by: Shusen Li &lt;lishusen2@huawei.com&gt;
    > Signed-off-by: Shusen Li &lt;lishusen2@huawei.com&gt;
    > Signed-off-by: Kunkun Jiang &lt;jiangkunkun@huawei.com&gt;
    > [Jing: Update with entry write helper]
    > Signed-off-by: Jing Zhang &lt;jingzhangos@google.com&gt;
    > Link: https://lore.kernel.org/r/20241107214137.428439-5-jingzhangos@google.com
    > Signed-off-by: Oliver Upton &lt;oliver.upton@linux.dev&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ KVM: arm64: Get rid of userspace_irqchip_in_use (@Raghavendra Rao Ananta in [fe425d5239a28c2](https://github.com/sophgo/linux-riscv/commit/fe425d5239a28c2) at 2024-12-05 13:02:44)
    > commit 38d7aacca09230fdb98a34194fec2af597e8e20d upstream.
    > Improper use of userspace_irqchip_in_use led to syzbot hitting the
    > following WARN_ON() in kvm_timer_update_irq():
    > WARNING: CPU: 0 PID: 3281 at arch/arm64/kvm/arch_timer.c:459
    > kvm_timer_update_irq+0x21c/0x394
    > Call trace:
    > kvm_timer_update_irq+0x21c/0x394 arch/arm64/kvm/arch_timer.c:459
    > kvm_timer_vcpu_reset+0x158/0x684 arch/arm64/kvm/arch_timer.c:968
    > kvm_reset_vcpu+0x3b4/0x560 arch/arm64/kvm/reset.c:264
    > kvm_vcpu_set_target arch/arm64/kvm/arm.c:1553 [inline]
    > kvm_arch_vcpu_ioctl_vcpu_init arch/arm64/kvm/arm.c:1573 [inline]
    > kvm_arch_vcpu_ioctl+0x112c/0x1b3c arch/arm64/kvm/arm.c:1695
    > kvm_vcpu_ioctl+0x4ec/0xf74 virt/kvm/kvm_main.c:4658
    > vfs_ioctl fs/ioctl.c:51 [inline]
    > __do_sys_ioctl fs/ioctl.c:907 [inline]
    > __se_sys_ioctl fs/ioctl.c:893 [inline]
    > __arm64_sys_ioctl+0x108/0x184 fs/ioctl.c:893
    > __invoke_syscall arch/arm64/kernel/syscall.c:35 [inline]
    > invoke_syscall+0x78/0x1b8 arch/arm64/kernel/syscall.c:49
    > el0_svc_common+0xe8/0x1b0 arch/arm64/kernel/syscall.c:132
    > do_el0_svc+0x40/0x50 arch/arm64/kernel/syscall.c:151
    > el0_svc+0x54/0x14c arch/arm64/kernel/entry-common.c:712
    > el0t_64_sync_handler+0x84/0xfc arch/arm64/kernel/entry-common.c:730
    > el0t_64_sync+0x190/0x194 arch/arm64/kernel/entry.S:598
    > The following sequence led to the scenario:
    > - Userspace creates a VM and a vCPU.
    > - The vCPU is initialized with KVM_ARM_VCPU_PMU_V3 during
    > KVM_ARM_VCPU_INIT.
    > - Without any other setup, such as vGIC or vPMU, userspace issues
    > KVM_RUN on the vCPU. Since the vPMU is requested, but not setup,
    > kvm_arm_pmu_v3_enable() fails in kvm_arch_vcpu_run_pid_change().
    > As a result, KVM_RUN returns after enabling the timer, but before
    > incrementing &#x27;userspace_irqchip_in_use&#x27;:
    > kvm_arch_vcpu_run_pid_change()
    > ret &#x3D; kvm_arm_pmu_v3_enable()
    > if (!vcpu-&gt;arch.pmu.created)
    > return -EINVAL;
    > if (ret)
    > return ret;
    > [...]
    > if (!irqchip_in_kernel(kvm))
    > static_branch_inc(&amp;userspace_irqchip_in_use);
    > - Userspace ignores the error and issues KVM_ARM_VCPU_INIT again.
    > Since the timer is already enabled, control moves through the
    > following flow, ultimately hitting the WARN_ON():
    > kvm_timer_vcpu_reset()
    > if (timer-&gt;enabled)
    > kvm_timer_update_irq()
    > if (!userspace_irqchip())
    > ret &#x3D; kvm_vgic_inject_irq()
    > ret &#x3D; vgic_lazy_init()
    > if (unlikely(!vgic_initialized(kvm)))
    > if (kvm-&gt;arch.vgic.vgic_model !&#x3D;
    > KVM_DEV_TYPE_ARM_VGIC_V2)
    > return -EBUSY;
    > WARN_ON(ret);
    > Theoretically, since userspace_irqchip_in_use&#x27;s functionality can be
    > simply replaced by &#x27;!irqchip_in_kernel()&#x27;, get rid of the static key
    > to avoid the mismanagement, which also helps with the syzbot issue.
    > Cc: &lt;stable@vger.kernel.org&gt;
    > Reported-by: syzbot &lt;syzkaller@googlegroups.com&gt;
    > Suggested-by: Marc Zyngier &lt;maz@kernel.org&gt;
    > Signed-off-by: Raghavendra Rao Ananta &lt;rananta@google.com&gt;
    > Signed-off-by: Oliver Upton &lt;oliver.upton@linux.dev&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ KVM: arm64: vgic-v3: Sanitise guest writes to GICR_INVLPIR (@Marc Zyngier in [f594a5683a88591](https://github.com/sophgo/linux-riscv/commit/f594a5683a88591) at 2024-12-05 13:02:44)
    > commit d561491ba927cb5634094ff311795e9d618e9b86 upstream.
    > Make sure we filter out non-LPI invalidation when handling writes
    > to GICR_INVLPIR.
    > Fixes: 4645d11f4a553 (&quot;KVM: arm64: vgic-v3: Implement MMIO-based LPI invalidation&quot;)
    > Reported-by: Alexander Potapenko &lt;glider@google.com&gt;
    > Tested-by: Alexander Potapenko &lt;glider@google.com&gt;
    > Signed-off-by: Marc Zyngier &lt;maz@kernel.org&gt;
    > Cc: stable@vger.kernel.org
    > Link: https://lore.kernel.org/r/20241117165757.247686-2-maz@kernel.org
    > Signed-off-by: Oliver Upton &lt;oliver.upton@linux.dev&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ Revert &quot;KVM: VMX: Move LOAD_IA32_PERF_GLOBAL_CTRL errata handling out of setup_vmcs_config()&quot; (@Sean Christopherson in [f3c6fa7ce9786e9](https://github.com/sophgo/linux-riscv/commit/f3c6fa7ce9786e9) at 2024-12-05 13:02:44)
    > commit 85434c3c73fcad58870016ddfe5eaa5036672675 upstream.
    > Revert back to clearing VM_{ENTRY,EXIT}_LOAD_IA32_PERF_GLOBAL_CTRL in KVM&#x27;s
    > golden VMCS config, as applying the workaround during vCPU creation is
    > pointless and broken.  KVM *unconditionally* clears the controls in the
    > values returned by vmx_vmentry_ctrl() and vmx_vmexit_ctrl(), as KVM loads
    > PERF_GLOBAL_CTRL if and only if its necessary to do so.  E.g. if KVM wants
    > to run the guest with the same PERF_GLOBAL_CTRL as the host, then there&#x27;s
    > no need to re-load the MSR on entry and exit.
    > Even worse, the buggy commit failed to apply the erratum where it&#x27;s
    > actually needed, add_atomic_switch_msr().  As a result, KVM completely
    > ignores the erratum for all intents and purposes, i.e. uses the flawed
    > VMCS controls to load PERF_GLOBAL_CTRL.
    > To top things off, the patch was intended to be dropped, as the premise
    > of an L1 VMM being able to pivot on FMS is flawed, and KVM can (and now
    > does) fully emulate the controls in software.  Simply revert the commit,
    > as all upstream supported kernels that have the buggy commit should also
    > have commit f4c93d1a0e71 (&quot;KVM: nVMX: Always emulate PERF_GLOBAL_CTRL
    > VM-Entry/VM-Exit controls&quot;), i.e. the (likely theoretical) live migration
    > concern is a complete non-issue.
    > Opportunistically drop the manual &quot;kvm: &quot; scope from the warning about
    > the erratum, as KVM now uses pr_fmt() to provide the correct scope (v6.1
    > kernels and earlier don&#x27;t, but the erratum only applies to CPUs that are
    > 15+ years old; it&#x27;s not worth a separate patch).
    > This reverts commit 9d78d6fb186bc4aff41b5d6c4726b76649d3cb53.
    > Link: https://lore.kernel.org/all/YtnZmCutdd5tpUmz@google.com
    > Fixes: 9d78d6fb186b (&quot;KVM: VMX: Move LOAD_IA32_PERF_GLOBAL_CTRL errata handling out of setup_vmcs_config()&quot;)
    > Cc: stable@vger.kernel.org
    > Cc: Vitaly Kuznetsov &lt;vkuznets@redhat.com&gt;
    > Cc: Maxim Levitsky &lt;mlevitsk@redhat.com&gt;
    > Signed-off-by: Sean Christopherson &lt;seanjc@google.com&gt;
    > Reviewed-by: Vitaly Kuznetsov &lt;vkuznets@redhat.com&gt;
    > Message-ID: &lt;20241119011433.1797921-1-seanjc@google.com&gt;
    > Signed-off-by: Paolo Bonzini &lt;pbonzini@redhat.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ KVM: arm64: vgic-its: Clear ITE when DISCARD frees an ITE (@Kunkun Jiang in [eabd7ef14048bb6](https://github.com/sophgo/linux-riscv/commit/eabd7ef14048bb6) at 2024-12-05 13:02:44)
    > commit 7602ffd1d5e8927fadd5187cb4aed2fdc9c47143 upstream.
    > When DISCARD frees an ITE, it does not invalidate the
    > corresponding ITE. In the scenario of continuous saves and
    > restores, there may be a situation where an ITE is not saved
    > but is restored. This is unreasonable and may cause restore
    > to fail. This patch clears the corresponding ITE when DISCARD
    > frees an ITE.
    > Cc: stable@vger.kernel.org
    > Fixes: eff484e0298d (&quot;KVM: arm64: vgic-its: ITT save and restore&quot;)
    > Signed-off-by: Kunkun Jiang &lt;jiangkunkun@huawei.com&gt;
    > [Jing: Update with entry write helper]
    > Signed-off-by: Jing Zhang &lt;jingzhangos@google.com&gt;
    > Link: https://lore.kernel.org/r/20241107214137.428439-6-jingzhangos@google.com
    > Signed-off-by: Oliver Upton &lt;oliver.upton@linux.dev&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ KVM: arm64: Don&#x27;t retire aborted MMIO instruction (@Oliver Upton in [d0571c3add987bc](https://github.com/sophgo/linux-riscv/commit/d0571c3add987bc) at 2024-12-05 13:02:44)
    > commit e735a5da64420a86be370b216c269b5dd8e830e2 upstream.
    > Returning an abort to the guest for an unsupported MMIO access is a
    > documented feature of the KVM UAPI. Nevertheless, it&#x27;s clear that this
    > plumbing has seen limited testing, since userspace can trivially cause a
    > WARN in the MMIO return:
    > WARNING: CPU: 0 PID: 30558 at arch/arm64/include/asm/kvm_emulate.h:536 kvm_handle_mmio_return+0x46c/0x5c4 arch/arm64/include/asm/kvm_emulate.h:536
    > Call trace:
    > kvm_handle_mmio_return+0x46c/0x5c4 arch/arm64/include/asm/kvm_emulate.h:536
    > kvm_arch_vcpu_ioctl_run+0x98/0x15b4 arch/arm64/kvm/arm.c:1133
    > kvm_vcpu_ioctl+0x75c/0xa78 virt/kvm/kvm_main.c:4487
    > __do_sys_ioctl fs/ioctl.c:51 [inline]
    > __se_sys_ioctl fs/ioctl.c:893 [inline]
    > __arm64_sys_ioctl+0x14c/0x1c8 fs/ioctl.c:893
    > __invoke_syscall arch/arm64/kernel/syscall.c:35 [inline]
    > invoke_syscall+0x98/0x2b8 arch/arm64/kernel/syscall.c:49
    > el0_svc_common+0x1e0/0x23c arch/arm64/kernel/syscall.c:132
    > do_el0_svc+0x48/0x58 arch/arm64/kernel/syscall.c:151
    > el0_svc+0x38/0x68 arch/arm64/kernel/entry-common.c:712
    > el0t_64_sync_handler+0x90/0xfc arch/arm64/kernel/entry-common.c:730
    > el0t_64_sync+0x190/0x194 arch/arm64/kernel/entry.S:598
    > The splat is complaining that KVM is advancing PC while an exception is
    > pending, i.e. that KVM is retiring the MMIO instruction despite a
    > pending synchronous external abort. Womp womp.
    > Fix the glaring UAPI bug by skipping over all the MMIO emulation in
    > case there is a pending synchronous exception. Note that while userspace
    > is capable of pending an asynchronous exception (SError, IRQ, or FIQ),
    > it is still safe to retire the MMIO instruction in this case as (1) they
    > are by definition asynchronous, and (2) KVM relies on hardware support
    > for pending/delivering these exceptions instead of the software state
    > machine for advancing PC.
    > Cc: stable@vger.kernel.org
    > Fixes: da345174ceca (&quot;KVM: arm/arm64: Allow user injection of external data aborts&quot;)
    > Reported-by: Alexander Potapenko &lt;glider@google.com&gt;
    > Reviewed-by: Marc Zyngier &lt;maz@kernel.org&gt;
    > Link: https://lore.kernel.org/r/20241025203106.3529261-2-oliver.upton@linux.dev
    > Signed-off-by: Oliver Upton &lt;oliver.upton@linux.dev&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ KVM: arm64: Ignore PMCNTENSET_EL0 while checking for overflow status (@Raghavendra Rao Ananta in [8b6916f4cf7d4ab](https://github.com/sophgo/linux-riscv/commit/8b6916f4cf7d4ab) at 2024-12-05 13:02:44)
    > commit 54bbee190d42166209185d89070c58a343bf514b upstream.
    > DDI0487K.a D13.3.1 describes the PMU overflow condition, which evaluates
    > to true if any counter&#x27;s global enable (PMCR_EL0.E), overflow flag
    > (PMOVSSET_EL0[n]), and interrupt enable (PMINTENSET_EL1[n]) are all 1.
    > Of note, this does not require a counter to be enabled
    > (i.e. PMCNTENSET_EL0[n] &#x3D; 1) to generate an overflow.
    > Align kvm_pmu_overflow_status() with the reality of the architecture
    > and stop using PMCNTENSET_EL0 as part of the overflow condition. The
    > bug was discovered while running an SBSA PMU test [*], which only sets
    > PMCR.E, PMOVSSET&lt;0&gt;, PMINTENSET&lt;0&gt;, and expects an overflow interrupt.
    > Cc: stable@vger.kernel.org
    > Fixes: 76d883c4e640 (&quot;arm64: KVM: Add access handler for PMOVSSET and PMOVSCLR register&quot;)
    > Link: https://github.com/ARM-software/sbsa-acs/blob/master/test_pool/pmu/operating_system/test_pmu001.c
    > Signed-off-by: Raghavendra Rao Ananta &lt;rananta@google.com&gt;
    > [ oliver: massaged changelog ]
    > Reviewed-by: Marc Zyngier &lt;maz@kernel.org&gt;
    > Link: https://lore.kernel.org/r/20241120005230.2335682-2-oliver.upton@linux.dev
    > Signed-off-by: Oliver Upton &lt;oliver.upton@linux.dev&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ KVM: arm64: vgic-its: Add a data length check in vgic_its_save_* (@Jing Zhang in [46018a04c5d20e0](https://github.com/sophgo/linux-riscv/commit/46018a04c5d20e0) at 2024-12-05 13:02:44)
    > commit 7fe28d7e68f92cc3d0668b8f2fbdf5c303ac3022 upstream.
    > In all the vgic_its_save_*() functinos, they do not check whether
    > the data length is 8 bytes before calling vgic_write_guest_lock.
    > This patch adds the check. To prevent the kernel from being blown up
    > when the fault occurs, KVM_BUG_ON() is used. And the other BUG_ON()s
    > are replaced together.
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Kunkun Jiang &lt;jiangkunkun@huawei.com&gt;
    > [Jing: Update with the new entry read/write helpers]
    > Signed-off-by: Jing Zhang &lt;jingzhangos@google.com&gt;
    > Link: https://lore.kernel.org/r/20241107214137.428439-4-jingzhangos@google.com
    > Signed-off-by: Oliver Upton &lt;oliver.upton@linux.dev&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ crypto: x86/aegis128 - access 32-bit arguments as 32-bit (@Eric Biggers in [d6933f2ea22b189](https://github.com/sophgo/linux-riscv/commit/d6933f2ea22b189) at 2024-12-05 13:02:43)
    > commit 3b2f2d22fb424e9bebda4dbf6676cbfc7f9f62cd upstream.
    > Fix the AEGIS assembly code to access &#x27;unsigned int&#x27; arguments as 32-bit
    > values instead of 64-bit, since the upper bits of the corresponding
    > 64-bit registers are not guaranteed to be zero.
    > Note: there haven&#x27;t been any reports of this bug actually causing
    > incorrect behavior.  Neither gcc nor clang guarantee zero-extension to
    > 64 bits, but zero-extension is likely to happen in practice because most
    > instructions that operate on 32-bit registers zero-extend to 64 bits.
    > Fixes: 1d373d4e8e15 (&quot;crypto: x86 - Add optimized AEGIS implementations&quot;)
    > Cc: stable@vger.kernel.org
    > Reviewed-by: Ondrej Mosnacek &lt;omosnace@redhat.com&gt;
    > Signed-off-by: Eric Biggers &lt;ebiggers@google.com&gt;
    > Signed-off-by: Herbert Xu &lt;herbert@gondor.apana.org.au&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ KVM: x86/mmu: Skip the &quot;try unsync&quot; path iff the old SPTE was a leaf SPTE (@Sean Christopherson in [cb02ac1579aa530](https://github.com/sophgo/linux-riscv/commit/cb02ac1579aa530) at 2024-12-05 13:02:43)
    > commit 2867eb782cf7f64c2ac427596133b6f9c3f64b7a upstream.
    > Apply make_spte()&#x27;s optimization to skip trying to unsync shadow pages if
    > and only if the old SPTE was a leaf SPTE, as non-leaf SPTEs in direct MMUs
    > are always writable, i.e. could trigger a false positive and incorrectly
    > lead to KVM creating a SPTE without write-protecting or marking shadow
    > pages unsync.
    > This bug only affects the TDP MMU, as the shadow MMU only overwrites a
    > shadow-present SPTE when synchronizing SPTEs (and only 4KiB SPTEs can be
    > unsync).  Specifically, mmu_set_spte() drops any non-leaf SPTEs *before*
    > calling make_spte(), whereas the TDP MMU can do a direct replacement of a
    > page table with the leaf SPTE.
    > Opportunistically update the comment to explain why skipping the unsync
    > stuff is safe, as opposed to simply saying &quot;it&#x27;s someone else&#x27;s problem&quot;.
    > Cc: stable@vger.kernel.org
    > Tested-by: Alex Bennée &lt;alex.bennee@linaro.org&gt;
    > Signed-off-by: Sean Christopherson &lt;seanjc@google.com&gt;
    > Tested-by: Dmitry Osipenko &lt;dmitry.osipenko@collabora.com&gt;
    > Signed-off-by: Paolo Bonzini &lt;pbonzini@redhat.com&gt;
    > Message-ID: &lt;20241010182427.1434605-5-seanjc@google.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ perf/x86/intel/pt: Fix buffer full but size is 0 case (@Adrian Hunter in [bc9b40fae656148](https://github.com/sophgo/linux-riscv/commit/bc9b40fae656148) at 2024-12-05 13:02:43)
    > commit 5b590160d2cf776b304eb054afafea2bd55e3620 upstream.
    > If the trace data buffer becomes full, a truncated flag [T] is reported
    > in PERF_RECORD_AUX.  In some cases, the size reported is 0, even though
    > data must have been added to make the buffer full.
    > That happens when the buffer fills up from empty to full before the
    > Intel PT driver has updated the buffer position.  Then the driver
    > calculates the new buffer position before calculating the data size.
    > If the old and new positions are the same, the data size is reported
    > as 0, even though it is really the whole buffer size.
    > Fix by detecting when the buffer position is wrapped, and adjust the
    > data size calculation accordingly.
    > Example
    > Use a very small buffer size (8K) and observe the size of truncated [T]
    > data. Before the fix, it is possible to see records of 0 size.
    > Before:
    > $ perf record -m,8K -e intel_pt// uname
    > Linux
    > [ perf record: Woken up 2 times to write data ]
    > [ perf record: Captured and wrote 0.105 MB perf.data ]
    > $ perf script -D --no-itrace | grep AUX | grep -F &#x27;[T]&#x27;
    > Warning:
    > AUX data lost 2 times out of 3!
    > 5 19462712368111 0x19710 [0x40]: PERF_RECORD_AUX offset: 0 size: 0 flags: 0x1 [T]
    > 5 19462712700046 0x19ba8 [0x40]: PERF_RECORD_AUX offset: 0x170 size: 0xe90 flags: 0x1 [T]
    > After:
    > $ perf record -m,8K -e intel_pt// uname
    > Linux
    > [ perf record: Woken up 3 times to write data ]
    > [ perf record: Captured and wrote 0.040 MB perf.data ]
    > $ perf script -D --no-itrace | grep AUX | grep -F &#x27;[T]&#x27;
    > Warning:
    > AUX data lost 2 times out of 3!
    > 1 113720802995 0x4948 [0x40]: PERF_RECORD_AUX offset: 0 size: 0x2000 flags: 0x1 [T]
    > 1 113720979812 0x6b10 [0x40]: PERF_RECORD_AUX offset: 0x2000 size: 0x2000 flags: 0x1 [T]
    > Fixes: 52ca9ced3f70 (&quot;perf/x86/intel/pt: Add Intel PT PMU driver&quot;)
    > Signed-off-by: Adrian Hunter &lt;adrian.hunter@intel.com&gt;
    > Signed-off-by: Peter Zijlstra (Intel) &lt;peterz@infradead.org&gt;
    > Cc: stable@vger.kernel.org
    > Link: https://lkml.kernel.org/r/20241022155920.17511-2-adrian.hunter@intel.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ KVM: x86: add back X86_LOCAL_APIC dependency (@Arnd Bergmann in [b44026c099c5809](https://github.com/sophgo/linux-riscv/commit/b44026c099c5809) at 2024-12-05 13:02:43)
    > commit 1331343af6f502aecd274d522dd34bf7c965f484 upstream.
    > Enabling KVM now causes a build failure on x86-32 if X86_LOCAL_APIC
    > is disabled:
    > arch/x86/kvm/svm/svm.c: In function &#x27;svm_emergency_disable_virtualization_cpu&#x27;:
    > arch/x86/kvm/svm/svm.c:597:9: error: &#x27;kvm_rebooting&#x27; undeclared (first use in this function); did you mean &#x27;kvm_irq_routing&#x27;?
    > 597 |         kvm_rebooting &#x3D; true;
    > |         ^~~~~~~~~~~~~
    > |         kvm_irq_routing
    > arch/x86/kvm/svm/svm.c:597:9: note: each undeclared identifier is reported only once for each function it appears in
    > make[6]: *** [scripts/Makefile.build:221: arch/x86/kvm/svm/svm.o] Error 1
    > In file included from include/linux/rculist.h:11,
    > from include/linux/hashtable.h:14,
    > from arch/x86/kvm/svm/avic.c:18:
    > arch/x86/kvm/svm/avic.c: In function &#x27;avic_pi_update_irte&#x27;:
    > arch/x86/kvm/svm/avic.c:909:38: error: &#x27;struct kvm&#x27; has no member named &#x27;irq_routing&#x27;
    > 909 |         irq_rt &#x3D; srcu_dereference(kvm-&gt;irq_routing, &amp;kvm-&gt;irq_srcu);
    > |                                      ^~
    > include/linux/rcupdate.h:538:17: note: in definition of macro &#x27;__rcu_dereference_check&#x27;
    > 538 |         typeof(*p) *local &#x3D; (typeof(*p) *__force)READ_ONCE(p); \
    > Move the dependency to the same place as before.
    > Fixes: ea4290d77bda (&quot;KVM: x86: leave kvm.ko out of the build if no vendor module is requested&quot;)
    > Cc: stable@vger.kernel.org
    > Reported-by: kernel test robot &lt;lkp@intel.com&gt;
    > Closes: https://lore.kernel.org/oe-kbuild-all/202410060426.e9Xsnkvi-lkp@intel.com/
    > Signed-off-by: Arnd Bergmann &lt;arnd@arndb.de&gt;
    > Acked-by: Sean Christopherson &lt;seanjc@google.com&gt;
    > [sean: add Cc to stable, tweak shortlog scope]
    > Signed-off-by: Sean Christopherson &lt;seanjc@google.com&gt;
    > Message-ID: &lt;20241118172002.1633824-2-seanjc@google.com&gt;
    > Signed-off-by: Paolo Bonzini &lt;pbonzini@redhat.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ KVM: x86: Break CONFIG_KVM_X86&#x27;s direct dependency on KVM_INTEL || KVM_AMD (@Sean Christopherson in [952741d54de920c](https://github.com/sophgo/linux-riscv/commit/952741d54de920c) at 2024-12-05 13:02:43)
    > commit 9ee62c33c0fe017ee02501a877f6f562363122fa upstream.
    > Rework CONFIG_KVM_X86&#x27;s dependency to only check if KVM_INTEL or KVM_AMD
    > is selected, i.e. not &#x27;n&#x27;.  Having KVM_X86 depend directly on the vendor
    > modules results in KVM_X86 being set to &#x27;m&#x27; if at least one of KVM_INTEL
    > or KVM_AMD is enabled, but neither is &#x27;y&#x27;, regardless of the value of KVM
    > itself.
    > The documentation for def_tristate doesn&#x27;t explicitly state that this is
    > the intended behavior, but it does clearly state that the &quot;if&quot; section is
    > parsed as a dependency, i.e. the behavior is consistent with how tristate
    > dependencies are handled in general.
    > Optionally dependencies for this default value can be added with &quot;if&quot;.
    > Fixes: ea4290d77bda (&quot;KVM: x86: leave kvm.ko out of the build if no vendor module is requested&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Sean Christopherson &lt;seanjc@google.com&gt;
    > Message-ID: &lt;20241118172002.1633824-3-seanjc@google.com&gt;
    > Signed-off-by: Paolo Bonzini &lt;pbonzini@redhat.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ KVM: x86: switch hugepage recovery thread to vhost_task (@Paolo Bonzini in [91248a2e4101288](https://github.com/sophgo/linux-riscv/commit/91248a2e4101288) at 2024-12-05 13:02:43)
    > commit d96c77bd4eeba469bddbbb14323d2191684da82a upstream.
    > kvm_vm_create_worker_thread() is meant to be used for kthreads that
    > can consume significant amounts of CPU time on behalf of a VM or in
    > response to how the VM behaves (for example how it accesses its memory).
    > Therefore it wants to charge the CPU time consumed by that work to
    > the VM&#x27;s container.
    > However, because of these threads, cgroups which have kvm instances
    > inside never complete freezing.  This can be trivially reproduced:
    > root@test ~# mkdir /sys/fs/cgroup/test
    > root@test ~# echo $$ &gt; /sys/fs/cgroup/test/cgroup.procs
    > root@test ~# qemu-system-x86_64 -nographic -enable-kvm
    > and in another terminal:
    > root@test ~# echo 1 &gt; /sys/fs/cgroup/test/cgroup.freeze
    > root@test ~# cat /sys/fs/cgroup/test/cgroup.events
    > populated 1
    > frozen 0
    > The cgroup freezing happens in the signal delivery path but
    > kvm_nx_huge_page_recovery_worker, while joining non-root cgroups, never
    > calls into the signal delivery path and thus never gets frozen. Because
    > the cgroup freezer determines whether a given cgroup is frozen by
    > comparing the number of frozen threads to the total number of threads
    > in the cgroup, the cgroup never becomes frozen and users waiting for
    > the state transition may hang indefinitely.
    > Since the worker kthread is tied to a user process, it&#x27;s better if
    > it behaves similarly to user tasks as much as possible, including
    > being able to send SIGSTOP and SIGCONT.  In fact, vhost_task is all
    > that kvm_vm_create_worker_thread() wanted to be and more: not only it
    > inherits the userspace process&#x27;s cgroups, it has other niceties like
    > being parented properly in the process tree.  Use it instead of the
    > homegrown alternative.
    > Incidentally, the new code is also better behaved when you flip recovery
    > back and forth to disabled and back to enabled.  If your recovery period
    > is 1 minute, it will run the next recovery after 1 minute independent
    > of how many times you flipped the parameter.
    > (Commit message based on emails from Tejun).
    > Reported-by: Tejun Heo &lt;tj@kernel.org&gt;
    > Reported-by: Luca Boccassi &lt;bluca@debian.org&gt;
    > Acked-by: Tejun Heo &lt;tj@kernel.org&gt;
    > Tested-by: Luca Boccassi &lt;bluca@debian.org&gt;
    > Cc: stable@vger.kernel.org
    > Reviewed-by: Sean Christopherson &lt;seanjc@google.com&gt;
    > Signed-off-by: Paolo Bonzini &lt;pbonzini@redhat.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ powerpc/pseries: Fix KVM guest detection for disabling hardlockup detector (@Gautam Menghani in [58d6473042e8ef1](https://github.com/sophgo/linux-riscv/commit/58d6473042e8ef1) at 2024-12-05 13:02:43)
    > commit 44e5d21e6d3fd2a1fed7f0327cf72e99397e2eaf upstream.
    > As per the kernel documentation[1], hardlockup detector should
    > be disabled in KVM guests as it may give false positives. On
    > PPC, hardlockup detector is enabled inside KVM guests because
    > disable_hardlockup_detector() is marked as early_initcall and it
    > relies on kvm_guest static key (is_kvm_guest()) which is initialized
    > later during boot by check_kvm_guest(), which is a core_initcall.
    > check_kvm_guest() is also called in pSeries_smp_probe(), which is called
    > before initcalls, but it is skipped if KVM guest does not have doorbell
    > support or if the guest is launched with SMT&#x3D;1.
    > Call check_kvm_guest() in disable_hardlockup_detector() so that
    > is_kvm_guest() check goes through fine and hardlockup detector can be
    > disabled inside the KVM guest.
    > [1]: Documentation/admin-guide/sysctl/kernel.rst
    > Fixes: 633c8e9800f3 (&quot;powerpc/pseries: Enable hardlockup watchdog for PowerVM partitions&quot;)
    > Cc: stable@vger.kernel.org # v5.14+
    > Signed-off-by: Gautam Menghani &lt;gautam@linux.ibm.com&gt;
    > Signed-off-by: Michael Ellerman &lt;mpe@ellerman.id.au&gt;
    > Link: https://patch.msgid.link/20241108094839.33084-1-gautam@linux.ibm.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ ASoC: codecs: Fix atomicity violation in snd_soc_component_get_drvdata() (@Qiu-ji Chen in [b5bcf578e8f92f7](https://github.com/sophgo/linux-riscv/commit/b5bcf578e8f92f7) at 2024-12-05 13:02:42)
    > commit 1157733344651ca505e259d6554591ff156922fa upstream.
    > An atomicity violation occurs when the validity of the variables
    > da7219-&gt;clk_src and da7219-&gt;mclk_rate is being assessed. Since the entire
    > assessment is not protected by a lock, the da7219 variable might still be
    > in flux during the assessment, rendering this check invalid.
    > To fix this issue, we recommend adding a lock before the block
    > if ((da7219-&gt;clk_src &#x3D;&#x3D; clk_id) &amp;&amp; (da7219-&gt;mclk_rate &#x3D;&#x3D; freq)) so that
    > the legitimacy check for da7219-&gt;clk_src and da7219-&gt;mclk_rate is
    > protected by the lock, ensuring the validity of the check.
    > This possible bug is found by an experimental static analysis tool
    > developed by our team. This tool analyzes the locking APIs
    > to extract function pairs that can be concurrently executed, and then
    > analyzes the instructions in the paired functions to identify possible
    > concurrency bugs including data races and atomicity violations.
    > Fixes: 6d817c0e9fd7 (&quot;ASoC: codecs: Add da7219 codec driver&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Qiu-ji Chen &lt;chenqiuji666@gmail.com&gt;
    > Link: https://patch.msgid.link/20240930101216.23723-1-chenqiuji666@gmail.com
    > Signed-off-by: Mark Brown &lt;broonie@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ ASoC: da7213: Populate max_register to regmap_config (@Claudiu Beznea in [b09a655dc756750](https://github.com/sophgo/linux-riscv/commit/b09a655dc756750) at 2024-12-05 13:02:42)
    > commit 9d4f9f6a7bb1afbde57d08c98f2db4ff019ee19d upstream.
    > On the Renesas RZ/G3S SMARC Carrier II board having a DA7212 codec (using
    > da7213 driver) connected to one SSIF-2 available on the Renesas RZ/G3S SoC
    > it has been discovered that using the runtime PM API for suspend/resume
    > (as will be proposed in the following commits) leads to the codec not
    > being propertly initialized after resume. This is because w/o
    > max_register populated to regmap_config the regcache_rbtree_sync()
    > breaks on base_reg &gt; max condition and the regcache_sync_block() call is
    > skipped.
    > Fixes: ef5c2eba2412 (&quot;ASoC: codecs: Add da7213 codec&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Claudiu Beznea &lt;claudiu.beznea.uj@bp.renesas.com&gt;
    > Link: https://patch.msgid.link/20241106081826.1211088-23-claudiu.beznea.uj@bp.renesas.com
    > Signed-off-by: Mark Brown &lt;broonie@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ docs: media: update location of the media patches (@Mauro Carvalho Chehab in [a7f28636da6f903](https://github.com/sophgo/linux-riscv/commit/a7f28636da6f903) at 2024-12-05 13:02:42)
    > commit 72ad4ff638047bbbdf3232178fea4bec1f429319 upstream.
    > Due to recent changes on the way we&#x27;re maintaining media, the
    > location of the main tree was updated.
    > Change docs accordingly.
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Mauro Carvalho Chehab &lt;mchehab+huawei@kernel.org&gt;
    > Reviewed-by: Hans Verkuil &lt;hverkuil@xs4all.nl&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ ASoC: amd: yc: Add a quirk for microfone on Lenovo ThinkPad P14s Gen 5 21MES00B00 (@Ilya Zverev in [9ab9a7fa19d6584](https://github.com/sophgo/linux-riscv/commit/9ab9a7fa19d6584) at 2024-12-05 13:02:42)
    > commit b682aa788e5f9f1ddacdfbb453e49fd3f4e83721 upstream.
    > New ThinkPads need new quirk entries. Ilya has tested this one.
    > Laptop product id is 21MES00B00, though the shorthand 21ME works.
    > Closes: https://bugzilla.kernel.org/show_bug.cgi?id&#x3D;219533
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Ilya Zverev &lt;ilya@zverev.info&gt;
    > Link: https://patch.msgid.link/20241127134420.14471-1-ilya@zverev.info
    > Signed-off-by: Mark Brown &lt;broonie@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ jfs: xattr: check invalid xattr size more strictly (@Artem Sadovnikov in [8c505ebeed8045b](https://github.com/sophgo/linux-riscv/commit/8c505ebeed8045b) at 2024-12-05 13:02:42)
    > commit d9f9d96136cba8fedd647d2c024342ce090133c2 upstream.
    > Commit 7c55b78818cf (&quot;jfs: xattr: fix buffer overflow for invalid xattr&quot;)
    > also addresses this issue but it only fixes it for positive values, while
    > ea_size is an integer type and can take negative values, e.g. in case of
    > a corrupted filesystem. This still breaks validation and would overflow
    > because of implicit conversion from int to size_t in print_hex_dump().
    > Fix this issue by clamping the ea_size value instead.
    > Found by Linux Verification Center (linuxtesting.org) with Syzkaller.
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Artem Sadovnikov &lt;ancowi69@gmail.com&gt;
    > Signed-off-by: Dave Kleikamp &lt;dave.kleikamp@oracle.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ MAINTAINERS: update location of media main tree (@Mauro Carvalho Chehab in [6f9be323d3306c4](https://github.com/sophgo/linux-riscv/commit/6f9be323d3306c4) at 2024-12-05 13:02:42)
    > commit dc51b3cc9d4d2a04bdbfe34f7746fc9122cc3f49 upstream.
    > There were some recent changes on the way we&#x27;re handling
    > media patches. Now, the official tree is located at:
    > https://git.linuxtv.org/media.git/
    > Update it at MAINTAINERS file.
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Mauro Carvalho Chehab &lt;mchehab+huawei@kernel.org&gt;
    > Reviewed-by: Hans Verkuil &lt;hverkuil@xs4all.nl&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ ext4: supress data-race warnings in ext4_free_inodes_{count,set}() (@Jeongjun Park in [ec56ada623cf178](https://github.com/sophgo/linux-riscv/commit/ec56ada623cf178) at 2024-12-05 13:02:41)
    > commit 902cc179c931a033cd7f4242353aa2733bf8524c upstream.
    > find_group_other() and find_group_orlov() read *_lo, *_hi with
    > ext4_free_inodes_count without additional locking. This can cause
    > data-race warning, but since the lock is held for most writes and free
    > inodes value is generally not a problem even if it is incorrect, it is
    > more appropriate to use READ_ONCE()/WRITE_ONCE() than to add locking.
    > &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;
    > BUG: KCSAN: data-race in ext4_free_inodes_count / ext4_free_inodes_set
    > write to 0xffff88810404300e of 2 bytes by task 6254 on cpu 1:
    > ext4_free_inodes_set+0x1f/0x80 fs/ext4/super.c:405
    > __ext4_new_inode+0x15ca/0x2200 fs/ext4/ialloc.c:1216
    > ext4_symlink+0x242/0x5a0 fs/ext4/namei.c:3391
    > vfs_symlink+0xca/0x1d0 fs/namei.c:4615
    > do_symlinkat+0xe3/0x340 fs/namei.c:4641
    > __do_sys_symlinkat fs/namei.c:4657 [inline]
    > __se_sys_symlinkat fs/namei.c:4654 [inline]
    > __x64_sys_symlinkat+0x5e/0x70 fs/namei.c:4654
    > x64_sys_call+0x1dda/0x2d60 arch/x86/include/generated/asm/syscalls_64.h:267
    > do_syscall_x64 arch/x86/entry/common.c:52 [inline]
    > do_syscall_64+0x54/0x120 arch/x86/entry/common.c:83
    > entry_SYSCALL_64_after_hwframe+0x76/0x7e
    > read to 0xffff88810404300e of 2 bytes by task 6257 on cpu 0:
    > ext4_free_inodes_count+0x1c/0x80 fs/ext4/super.c:349
    > find_group_other fs/ext4/ialloc.c:594 [inline]
    > __ext4_new_inode+0x6ec/0x2200 fs/ext4/ialloc.c:1017
    > ext4_symlink+0x242/0x5a0 fs/ext4/namei.c:3391
    > vfs_symlink+0xca/0x1d0 fs/namei.c:4615
    > do_symlinkat+0xe3/0x340 fs/namei.c:4641
    > __do_sys_symlinkat fs/namei.c:4657 [inline]
    > __se_sys_symlinkat fs/namei.c:4654 [inline]
    > __x64_sys_symlinkat+0x5e/0x70 fs/namei.c:4654
    > x64_sys_call+0x1dda/0x2d60 arch/x86/include/generated/asm/syscalls_64.h:267
    > do_syscall_x64 arch/x86/entry/common.c:52 [inline]
    > do_syscall_64+0x54/0x120 arch/x86/entry/common.c:83
    > entry_SYSCALL_64_after_hwframe+0x76/0x7e
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Jeongjun Park &lt;aha310510@gmail.com&gt;
    > Reviewed-by: Andreas Dilger &lt;adilger@dilger.ca&gt;
    > Link: https://patch.msgid.link/20241003125337.47283-1-aha310510@gmail.com
    > Signed-off-by: Theodore Ts&#x27;o &lt;tytso@mit.edu&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ ALSA: usb-audio: Fix potential out-of-bound accesses for Extigy and Mbox devices (@Benoît Sevens in [b521b53ac6eb04e](https://github.com/sophgo/linux-riscv/commit/b521b53ac6eb04e) at 2024-12-05 13:02:41)
    > commit b909df18ce2a998afef81d58bbd1a05dc0788c40 upstream.
    > A bogus device can provide a bNumConfigurations value that exceeds the
    > initial value used in usb_get_configuration for allocating dev-&gt;config.
    > This can lead to out-of-bounds accesses later, e.g. in
    > usb_destroy_configuration.
    > Signed-off-by: Benoît Sevens &lt;bsevens@google.com&gt;
    > Fixes: 1da177e4c3f4 (&quot;Linux-2.6.12-rc2&quot;)
    > Cc: stable@kernel.org
    > Link: https://patch.msgid.link/20241120124144.3814457-1-bsevens@google.com
    > Signed-off-by: Takashi Iwai &lt;tiwai@suse.de&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ ext4: fix FS_IOC_GETFSMAP handling (@Theodore Ts&#x27;o in [ad34d9c738fe79b](https://github.com/sophgo/linux-riscv/commit/ad34d9c738fe79b) at 2024-12-05 13:02:41)
    > commit 4a622e4d477bb12ad5ed4abbc7ad1365de1fa347 upstream.
    > The original implementation ext4&#x27;s FS_IOC_GETFSMAP handling only
    > worked when the range of queried blocks included at least one free
    > (unallocated) block range.  This is because how the metadata blocks
    > were emitted was as a side effect of ext4_mballoc_query_range()
    > calling ext4_getfsmap_datadev_helper(), and that function was only
    > called when a free block range was identified.  As a result, this
    > caused generic/365 to fail.
    > Fix this by creating a new function ext4_getfsmap_meta_helper() which
    > gets called so that blocks before the first free block range in a
    > block group can get properly reported.
    > Signed-off-by: Theodore Ts&#x27;o &lt;tytso@mit.edu&gt;
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ usb: ehci-spear: fix call balance of sehci clk handling routines (@Vitalii Mordan in [a3245450eb91b5d](https://github.com/sophgo/linux-riscv/commit/a3245450eb91b5d) at 2024-12-05 13:02:41)
    > commit 40c974826734836402abfd44efbf04f63a2cc1c1 upstream.
    > If the clock sehci-&gt;clk was not enabled in spear_ehci_hcd_drv_probe,
    > it should not be disabled in any path.
    > Conversely, if it was enabled in spear_ehci_hcd_drv_probe, it must be disabled
    > in all error paths to ensure proper cleanup.
    > Found by Linux Verification Center (linuxtesting.org) with Klever.
    > Fixes: 7675d6ba436f (&quot;USB: EHCI: make ehci-spear a separate driver&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Vitalii Mordan &lt;mordan@ispras.ru&gt;
    > Acked-by: Alan Stern &lt;stern@rowland.harvard.edu&gt;
    > Link: https://lore.kernel.org/r/20241114230310.432213-1-mordan@ispras.ru
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ usb: typec: ucsi: glink: fix off-by-one in connector_status (@Dmitry Baryshkov in [6ba6f7f29e0dff4](https://github.com/sophgo/linux-riscv/commit/6ba6f7f29e0dff4) at 2024-12-05 13:02:41)
    > commit 4a22918810980897393fa1776ea3877e4baf8cca upstream.
    > UCSI connector&#x27;s indices start from 1 up to 3, PMIC_GLINK_MAX_PORTS.
    > Correct the condition in the pmic_glink_ucsi_connector_status()
    > callback, fixing Type-C orientation reporting for the third USB-C
    > connector.
    > Fixes: 76716fd5bf09 (&quot;usb: typec: ucsi: glink: move GPIO reading into connector_status callback&quot;)
    > Cc: stable@vger.kernel.org
    > Reported-by: Abel Vesa &lt;abel.vesa@linaro.org&gt;
    > Reviewed-by: Neil Armstrong &lt;neil.armstrong@linaro.org&gt;
    > Reviewed-by: Johan Hovold &lt;johan+linaro@kernel.org&gt;
    > Tested-by: Johan Hovold &lt;johan+linaro@kernel.org&gt;
    > Signed-off-by: Dmitry Baryshkov &lt;dmitry.baryshkov@linaro.org&gt;
    > Link: https://lore.kernel.org/r/20241109-ucsi-glue-fixes-v2-1-8b21ff4f9fbe@linaro.org
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ xfs: fix simplify extent lookup in xfs_can_free_eofblocks (@Darrick J. Wong in [66b606298653865](https://github.com/sophgo/linux-riscv/commit/66b606298653865) at 2024-12-05 13:02:41)
    > commit 62027820eb4486f075b89ec31c1548c6cb1bb13f upstream.
    > In commit 11f4c3a53adde, we tried to simplify the extent lookup in
    > xfs_can_free_eofblocks so that it doesn&#x27;t incur the overhead of all the
    > extra stuff that xfs_bmapi_read does around the iext lookup.
    > Unfortunately, this causes regressions on generic/603, xfs/108,
    > generic/219, xfs/173, generic/694, xfs/052, generic/230, and xfs/441
    > when always_cow is turned on.  In all cases, the regressions take the
    > form of alwayscow files consuming rather more space than the golden
    > output is expecting.  I observed that in all these cases, the cause of
    > the excess space usage was due to CoW fork delalloc reservations that go
    > beyond EOF.
    > For alwayscow files we allow posteof delalloc CoW reservations because
    > all writes go through the CoW fork.  Recall that all extents in the CoW
    > fork are accounted for via i_delayed_blks, which means that prior to
    > this patch, we&#x27;d invoke xfs_free_eofblocks on first close if anything
    > was in the CoW fork.  Now we don&#x27;t do that.
    > Fix the problem by reverting the removal of the i_delayed_blks check.
    > Cc: &lt;stable@vger.kernel.org&gt; # v6.12-rc1
    > Fixes: 11f4c3a53adde (&quot;xfs: simplify extent lookup in xfs_can_free_eofblocks&quot;)
    > Signed-off-by: Darrick J. Wong &lt;djwong@kernel.org&gt;
    > Reviewed-by: Christoph Hellwig &lt;hch@lst.de&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ ALSA: usb-audio: Fix out of bounds reads when finding clock sources (@Takashi Iwai in [096bb5b43edf755](https://github.com/sophgo/linux-riscv/commit/096bb5b43edf755) at 2024-12-05 13:02:41)
    > commit a3dd4d63eeb452cfb064a13862fb376ab108f6a6 upstream.
    > The current USB-audio driver code doesn&#x27;t check bLength of each
    > descriptor at traversing for clock descriptors.  That is, when a
    > device provides a bogus descriptor with a shorter bLength, the driver
    > might hit out-of-bounds reads.
    > For addressing it, this patch adds sanity checks to the validator
    > functions for the clock descriptor traversal.  When the descriptor
    > length is shorter than expected, it&#x27;s skipped in the loop.
    > For the clock source and clock multiplier descriptors, we can just
    > check bLength against the sizeof() of each descriptor type.
    > OTOH, the clock selector descriptor of UAC2 and UAC3 has an array
    > of bNrInPins elements and two more fields at its tail, hence those
    > have to be checked in addition to the sizeof() check.
    > Reported-by: Benoît Sevens &lt;bsevens@google.com&gt;
    > Cc: &lt;stable@vger.kernel.org&gt;
    > Link: https://lore.kernel.org/20241121140613.3651-1-bsevens@google.com
    > Link: https://patch.msgid.link/20241125144629.20757-1-tiwai@suse.de
    > Signed-off-by: Takashi Iwai &lt;tiwai@suse.de&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ net_sched: sch_fq: don&#x27;t follow the fast path if Tx is behind now (@Jakub Kicinski in [d716851d0acfa2d](https://github.com/sophgo/linux-riscv/commit/d716851d0acfa2d) at 2024-12-05 13:02:40)
    > commit 122aba8c80618eca904490b1733af27fb8f07528 upstream.
    > Recent kernels cause a lot of TCP retransmissions
    > [ ID] Interval           Transfer     Bitrate         Retr  Cwnd
    > [  5]   0.00-1.00   sec  2.24 GBytes  19.2 Gbits/sec  2767    442 KBytes
    > [  5]   1.00-2.00   sec  2.23 GBytes  19.1 Gbits/sec  2312    350 KBytes
    > ^^^^
    > Replacing the qdisc with pfifo makes retransmissions go away.
    > It appears that a flow may have a delayed packet with a very near
    > Tx time. Later, we may get busy processing Rx and the target Tx time
    > will pass, but we won&#x27;t service Tx since the CPU is busy with Rx.
    > If Rx sees an ACK and we try to push more data for the delayed flow
    > we may fastpath the skb, not realizing that there are already &quot;ready
    > to send&quot; packets for this flow sitting in the qdisc.
    > Don&#x27;t trust the fastpath if we are &quot;behind&quot; according to the projected
    > Tx time for next flow waiting in the Qdisc. Because we consider anything
    > within the offload window to be okay for fastpath we must consider
    > the entire offload window as &quot;now&quot;.
    > Qdisc config:
    > qdisc fq 8001: dev eth0 parent 1234:1 limit 10000p flow_limit 100p \
    > buckets 32768 orphan_mask 1023 bands 3 \
    > priomap 1 2 2 2 1 2 0 0 1 1 1 1 1 1 1 1 \
    > weights 589824 196608 65536 quantum 3028b initial_quantum 15140b \
    > low_rate_threshold 550Kbit \
    > refill_delay 40ms timer_slack 10us horizon 10s horizon_drop
    > For iperf this change seems to do fine, the reordering is gone.
    > The fastpath still gets used most of the time:
    > gc 0 highprio 0 fastpath 142614 throttled 418309 latency 19.1us
    > xx_behind 2731
    > where &quot;xx_behind&quot; counts how many times we hit the new &quot;return false&quot;.
    > CC: stable@vger.kernel.org
    > Fixes: 076433bd78d7 (&quot;net_sched: sch_fq: add fast path for mostly idle qdisc&quot;)
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Reviewed-by: Eric Dumazet &lt;edumazet@google.com&gt;
    > Link: https://patch.msgid.link/20241124022148.3126719-1-kuba@kernel.org
    > Signed-off-by: Paolo Abeni &lt;pabeni@redhat.com&gt;
    > [stable: drop the offload horizon, it&#x27;s not supported / 0]
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ ASoC: amd: yc: Fix for enabling DMIC on acp6x via _DSD entry (@Venkata Prasad Potturu in [b4b69142aae7d6d](https://github.com/sophgo/linux-riscv/commit/b4b69142aae7d6d) at 2024-12-05 13:02:40)
    > [ Upstream commit 4095cf872084ecfdfdb0e681f3e9ff9745acfa75 ]
    > Add condition check to register ACP PDM sound card by reading
    > _WOV acpi entry.
    > Fixes: 5426f506b584 (&quot;ASoC: amd: Add support for enabling DMIC on acp6x via _DSD&quot;)
    > Signed-off-by: Venkata Prasad Potturu &lt;venkataprasad.potturu@amd.com&gt;
    > Link: https://patch.msgid.link/20241127112227.227106-1-venkataprasad.potturu@amd.com
    > Signed-off-by: Mark Brown &lt;broonie@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ f2fs: fix fiemap failure issue when page size is 16KB (@Xiuhong Wang in [98b872563010df0](https://github.com/sophgo/linux-riscv/commit/98b872563010df0) at 2024-12-05 13:02:40)
    > commit a7a7c1d423a6351a6541e95c797da5358e5ad1ea upstream.
    > After enable 16K page size, an infinite loop may occur in
    > fiemap (fm_length&#x3D;UINT64_MAX) on a file, such as the 16KB
    > scratch.img during the remount operation in Android.
    > The condition for whether fiemap continues to map is to check
    > whether the number of bytes corresponding to the next map.m_lblk
    > exceeds blks_to_bytes(inode,max_inode_blocks(inode)) if there are HOLE.
    > The latter does not take into account the maximum size of a file with 16KB
    > page size, so the loop cannot be jumped out.
    > The following is the fail trace:
    > When f2fs_map_blocks reaches map.m_lblk&#x3D;3936, it needs to go to the
    > first direct node block, so the map is 3936 + 4090 &#x3D; 8026,
    > The next map is the second direct node block, that is,
    > 8026 + 4090 &#x3D; 12116,
    > The next map is the first indirect node block, that is,
    > 12116 + 4090 * 4090 &#x3D; 16740216,
    > The next map is the second indirect node block, that is,
    > 16740216 + 4090 * 4090 &#x3D; 33468316,
    > The next map is the first double indirect node block, that is,
    > 33468316 + 4090 * 4090 * 4090 &#x3D; 68451397316
    > Since map.m_lblk represents the address of a block, which is 32
    > bits, truncation will occur, that is, 68451397316 becomes
    > 4026887876, and the number of bytes corresponding to the block
    > number does not exceed blks_to_bytes(inode,max_inode_blocks(inode)),
    > so the loop will not be jumped out.
    > The next time, it will be considered that it should still be a
    > double indirect node block, that is,
    > 4026887876 + 4090 * 4090 * 4090 &#x3D; 72444816876, which will be
    > truncated to 3725340140, and the loop will not be jumped out.
    > 156.374871: f2fs_map_blocks: dev &#x3D; (254,57), ino &#x3D; 7449, file offset &#x3D; 0, start blkaddr &#x3D; 0x8e00, len &#x3D; 0x200, flags &#x3D; 2,seg_type &#x3D; 8, may_create &#x3D; 0, multidevice &#x3D; 0, flag &#x3D; 1, err &#x3D; 0
    > 156.374916: f2fs_map_blocks: dev &#x3D; (254,57), ino &#x3D; 7449, file offset &#x3D; 512, start blkaddr &#x3D; 0x0, len &#x3D; 0x0, flags &#x3D; 0 , seg_type &#x3D; 8, may_create &#x3D; 0, multidevice &#x3D; 0, flag &#x3D; 1, err &#x3D; 0
    > 156.374920: f2fs_map_blocks: dev &#x3D; (254,57), ino &#x3D; 7449, file offset &#x3D; 513, start blkaddr &#x3D; 0x0, len &#x3D; 0x0, flags &#x3D; 0, seg_type &#x3D; 8, may_create &#x3D; 0, multidevice &#x3D; 0, flag &#x3D; 1, err &#x3D; 0
    > ......
    > 156.385747: f2fs_map_blocks: dev &#x3D; (254,57), ino &#x3D; 7449, file offset &#x3D; 3935, start blkaddr &#x3D; 0x0, len &#x3D; 0x0, flags &#x3D; 0, seg_type &#x3D; 8, may_create &#x3D; 0, multidevice &#x3D; 0, flag &#x3D; 1, err &#x3D; 0
    > 156.385752: f2fs_map_blocks: dev &#x3D; (254,57), ino &#x3D; 7449, file offset &#x3D; 3936, start blkaddr &#x3D; 0x0, len &#x3D; 0x0, flags &#x3D; 0, seg_type &#x3D; 8, may_create &#x3D; 0, multidevice &#x3D; 0, flag &#x3D; 1, err &#x3D; 0
    > 156.385755: f2fs_map_blocks: dev &#x3D; (254,57), ino &#x3D; 7449, file offset &#x3D; 8026, start blkaddr &#x3D; 0x0, len &#x3D; 0x0, flags &#x3D; 0, seg_type &#x3D; 8, may_create &#x3D; 0, multidevice &#x3D; 0, flag &#x3D; 1, err &#x3D; 0
    > 156.385758: f2fs_map_blocks: dev &#x3D; (254,57), ino &#x3D; 7449, file offset &#x3D; 12116, start blkaddr &#x3D; 0x0, len &#x3D; 0x0, flags &#x3D; 0, seg_type &#x3D; 8, may_create &#x3D; 0, multidevice &#x3D; 0, flag &#x3D; 1, err &#x3D; 0
    > 156.385761: f2fs_map_blocks: dev &#x3D; (254,57), ino &#x3D; 7449, file offset &#x3D; 16740216, start blkaddr &#x3D; 0x0, len &#x3D; 0x0, flags &#x3D; 0, seg_type &#x3D; 8, may_create &#x3D; 0, multidevice &#x3D; 0, flag &#x3D; 1, err &#x3D; 0
    > 156.385764: f2fs_map_blocks: dev &#x3D; (254,57), ino &#x3D; 7449, file offset &#x3D; 33468316, start blkaddr &#x3D; 0x0, len &#x3D; 0x0, flags &#x3D; 0, seg_type &#x3D; 8, may_create &#x3D; 0, multidevice &#x3D; 0, flag &#x3D; 1, err &#x3D; 0
    > 156.385767: f2fs_map_blocks: dev &#x3D; (254,57), ino &#x3D; 7449, file offset &#x3D; 4026887876, start blkaddr &#x3D; 0x0, len &#x3D; 0x0, flags &#x3D; 0, seg_type &#x3D; 8, may_create &#x3D; 0, multidevice &#x3D; 0, flag &#x3D; 1, err &#x3D; 0
    > 156.385770: f2fs_map_blocks: dev &#x3D; (254,57), ino &#x3D; 7449, file offset &#x3D; 3725340140, start blkaddr &#x3D; 0x0, len &#x3D; 0x0, flags &#x3D; 0, seg_type &#x3D; 8, may_create &#x3D; 0, multidevice &#x3D; 0, flag &#x3D; 1, err &#x3D; 0
    > 156.385772: f2fs_map_blocks: dev &#x3D; (254,57), ino &#x3D; 7449, file offset &#x3D; 4026887876, start blkaddr &#x3D; 0x0, len &#x3D; 0x0, flags &#x3D; 0, seg_type &#x3D; 8, may_create &#x3D; 0, multidevice &#x3D; 0, flag &#x3D; 1, err &#x3D; 0
    > 156.385775: f2fs_map_blocks: dev &#x3D; (254,57), ino &#x3D; 7449, file offset &#x3D; 3725340140, start blkaddr &#x3D; 0x0, len &#x3D; 0x0, flags &#x3D; 0, seg_type &#x3D; 8, may_create &#x3D; 0, multidevice &#x3D; 0, flag &#x3D; 1, err &#x3D; 0
    > Commit a6a010f5def5 (&quot;f2fs: Restrict max filesize for 16K f2fs&quot;)
    > has set the maximum allowed file size to (U32_MAX + 1) * F2FS_BLKSIZE,
    > so max_file_blocks should be used here to limit it, that is,
    > maxbytes defined above. And the max_inode_blocks function is not
    > called by other functions except here, so cleanup it.
    > Signed-off-by: Xiuhong Wang &lt;xiuhong.wang@unisoc.com&gt;
    > Signed-off-by: Zhiguo Niu &lt;zhiguo.niu@unisoc.com&gt;
    > Reviewed-by: Chao Yu &lt;chao@kernel.org&gt;
    > Signed-off-by: Jaegeuk Kim &lt;jaegeuk@kernel.org&gt;
    > Cc: Daniel Rosenberg &lt;drosen@google.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ ALSA: core: Fix possible NULL dereference caused by kunit_kzalloc() (@Zichen Xie in [8bfff486ecc79a7](https://github.com/sophgo/linux-riscv/commit/8bfff486ecc79a7) at 2024-12-05 13:02:40)
    > [ Upstream commit 9ad467a2b2716d4ed12f003b041aa6c776a13ff5 ]
    > kunit_kzalloc() may return a NULL pointer, dereferencing it without
    > NULL check may lead to NULL dereference.
    > Add NULL checks for all the kunit_kzalloc() in sound_kunit.c
    > Fixes: 3e39acf56ede (&quot;ALSA: core: Add sound core KUnit test&quot;)
    > Signed-off-by: Zichen Xie &lt;zichenxie0106@gmail.com&gt;
    > Link: https://patch.msgid.link/20241126192448.12645-1-zichenxie0106@gmail.com
    > Signed-off-by: Takashi Iwai &lt;tiwai@suse.de&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ASoC: mediatek: Check num_codecs is not zero to avoid panic during probe (@Nícolas F. R. A. Prado in [550279449ff54c5](https://github.com/sophgo/linux-riscv/commit/550279449ff54c5) at 2024-12-05 13:02:40)
    > [ Upstream commit 2f2020327cc8561d7c520d2f2d9acea84fa7b3a3 ]
    > Following commit 13f58267cda3 (&quot;ASoC: soc.h: don&#x27;t create dummy
    > Component via COMP_DUMMY()&quot;), COMP_DUMMY() became an array with zero
    > length, and only gets populated with the dummy struct after the card is
    > registered. Since the sound card driver&#x27;s probe happens before the card
    > registration, accessing any of the members of a dummy component during
    > probe will result in undefined behavior.
    > This can be observed in the mt8188 and mt8195 machine sound drivers. By
    > omitting a dai link subnode in the sound card&#x27;s node in the Devicetree,
    > the default uninitialized dummy codec is used, and when its dai_name
    > pointer gets passed to strcmp() it results in a null pointer dereference
    > and a kernel panic.
    > In addition to that, set_card_codec_info() in the generic helpers file,
    > mtk-soundcard-driver.c, will populate a dai link with a dummy codec when
    > a dai link node is present in DT but with no codec property.
    > The result is that at probe time, a dummy codec can either be
    > uninitialized with num_codecs &#x3D; 0, or be an initialized dummy codec,
    > with num_codecs &#x3D; 1 and dai_name &#x3D; &quot;snd-soc-dummy-dai&quot;. In order to
    > accommodate for both situations, check that num_codecs is not zero
    > before accessing the codecs&#x27; fields but still check for the codec&#x27;s dai
    > name against &quot;snd-soc-dummy-dai&quot; as needed.
    > While at it, also drop the check that dai_name is not null in the mt8192
    > driver, introduced in commit 4d4e1b6319e5 (&quot;ASoC: mediatek: mt8192:
    > Check existence of dai_name before dereferencing&quot;), as it is actually
    > redundant given the preceding num_codecs !&#x3D; 0 check.
    > Fixes: 13f58267cda3 (&quot;ASoC: soc.h: don&#x27;t create dummy Component via COMP_DUMMY()&quot;)
    > Signed-off-by: Nícolas F. R. A. Prado &lt;nfraprado@collabora.com&gt;
    > Reviewed-by: AngeloGioacchino Del Regno &lt;angelogioacchino.delregno@collabora.com&gt;
    > Acked-by: Kuninori Morimoto &lt;kuninori.morimoto.gx@renesas.com&gt;
    > Reviewed-by: Fei Shao &lt;fshao@chromium.org&gt;
    > Acked-by: Trevor Wu &lt;trevor.wu@mediatek.com&gt;
    > Link: https://patch.msgid.link/20241126-asoc-mtk-dummy-panic-v1-1-42d53e168d2e@collabora.com
    > Signed-off-by: Mark Brown &lt;broonie@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ s390/pci: Fix potential double remove of hotplug slot (@Niklas Schnelle in [371bd905599d18d](https://github.com/sophgo/linux-riscv/commit/371bd905599d18d) at 2024-12-05 13:02:40)
    > [ Upstream commit c4a585e952ca403a370586d3f16e8331a7564901 ]
    > In commit 6ee600bfbe0f (&quot;s390/pci: remove hotplug slot when releasing the
    > device&quot;) the zpci_exit_slot() was moved from zpci_device_reserved() to
    > zpci_release_device() with the intention of keeping the hotplug slot
    > around until the device is actually removed.
    > Now zpci_release_device() is only called once all references are
    > dropped. Since the zPCI subsystem only drops its reference once the
    > device is in the reserved state it follows that zpci_release_device()
    > must only deal with devices in the reserved state. Despite that it
    > contains code to tear down from both configured and standby state. For
    > the standby case this already includes the removal of the hotplug slot
    > so would cause a double removal if a device was ever removed in
    > either configured or standby state.
    > Instead of causing a potential double removal in a case that should
    > never happen explicitly WARN_ON() if a device in non-reserved state is
    > released and get rid of the dead code cases.
    > Fixes: 6ee600bfbe0f (&quot;s390/pci: remove hotplug slot when releasing the device&quot;)
    > Reviewed-by: Matthew Rosato &lt;mjrosato@linux.ibm.com&gt;
    > Reviewed-by: Gerd Bayer &lt;gbayer@linux.ibm.com&gt;
    > Tested-by: Gerd Bayer &lt;gbayer@linux.ibm.com&gt;
    > Signed-off-by: Niklas Schnelle &lt;schnelle@linux.ibm.com&gt;
    > Signed-off-by: Heiko Carstens &lt;hca@linux.ibm.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ xen: Fix the issue of resource not being properly released in xenbus_dev_probe() (@Qiu-ji Chen in [2f977a4c82d35d0](https://github.com/sophgo/linux-riscv/commit/2f977a4c82d35d0) at 2024-12-05 13:02:40)
    > commit afc545da381ba0c651b2658966ac737032676f01 upstream.
    > This patch fixes an issue in the function xenbus_dev_probe(). In the
    > xenbus_dev_probe() function, within the if (err) branch at line 313, the
    > program incorrectly returns err directly without releasing the resources
    > allocated by err &#x3D; drv-&gt;probe(dev, id). As the return value is non-zero,
    > the upper layers assume the processing logic has failed. However, the probe
    > operation was performed earlier without a corresponding remove operation.
    > Since the probe actually allocates resources, failing to perform the remove
    > operation could lead to problems.
    > To fix this issue, we followed the resource release logic of the
    > xenbus_dev_remove() function by adding a new block fail_remove before the
    > fail_put block. After entering the branch if (err) at line 313, the
    > function will use a goto statement to jump to the fail_remove block,
    > ensuring that the previously acquired resources are correctly released,
    > thus preventing the reference count leak.
    > This bug was identified by an experimental static analysis tool developed
    > by our team. The tool specializes in analyzing reference count operations
    > and detecting potential issues where resources are not properly managed.
    > In this case, the tool flagged the missing release operation as a
    > potential problem, which led to the development of this patch.
    > Fixes: 4bac07c993d0 (&quot;xen: add the Xenbus sysfs and virtual device hotplug driver&quot;)
    > Cc: stable@vger.kernel.org
    > Signed-off-by: Qiu-ji Chen &lt;chenqiuji666@gmail.com&gt;
    > Reviewed-by: Juergen Gross &lt;jgross@suse.com&gt;
    > Message-ID: &lt;20241105130919.4621-1-chenqiuji666@gmail.com&gt;
    > Signed-off-by: Juergen Gross &lt;jgross@suse.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;

+ drm/radeon: Fix spurious unplug event on radeon HDMI (@Steven &#x27;Steve&#x27; Kendall in [ea371ce029c37f3](https://github.com/sophgo/linux-riscv/commit/ea371ce029c37f3) at 2024-12-05 13:02:39)
    > [ Upstream commit 7037bb04265ef05c6ffad56d884b0df76f57b095 ]
    > On several HP models (tested on HP 3125 and HP Probook 455 G2),
    > spurious unplug events are emitted upon login on Chrome OS.
    > This is likely due to the way Chrome OS restarts graphics
    > upon login, so it&#x27;s possible it&#x27;s an issue on other
    > distributions but not as common, though I haven&#x27;t
    > reproduced the issue elsewhere.
    > Use logic from an earlier version of the merged change
    > (see link below) which iterates over connectors and finds
    > matching encoders, rather than the other way around.
    > Also fixes an issue with screen mirroring on Chrome OS.
    > I&#x27;ve deployed this patch on Fedora and did not observe
    > any regression on these devices.
    > Link: https://gitlab.freedesktop.org/drm/amd/-/issues/1569#note_1603002
    > Link: https://gitlab.freedesktop.org/drm/amd/-/issues/3771
    > Fixes: 20ea34710f7b (&quot;drm/radeon: Add HD-audio component notifier support (v6)&quot;)
    > Signed-off-by: Steven &#x27;Steve&#x27; Kendall &lt;skend@chromium.org&gt;
    > Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ASoC: imx-audmix: Add NULL check in imx_audmix_probe (@Charles Han in [dc5aa71f39b44d8](https://github.com/sophgo/linux-riscv/commit/dc5aa71f39b44d8) at 2024-12-05 13:02:39)
    > [ Upstream commit e038f43edaf0083f6aa7c9415d86cf28dfd152f9 ]
    > devm_kasprintf() can return a NULL pointer on failure,but this
    > returned value in imx_audmix_probe() is not checked.
    > Add NULL check in imx_audmix_probe(), to handle kernel NULL
    > pointer dereference error.
    > Fixes: 05d996e11348 (&quot;ASoC: imx-audmix: Split capture device for audmix&quot;)
    > Signed-off-by: Charles Han &lt;hanchunchao@inspur.com&gt;
    > Link: https://patch.msgid.link/20241118084553.4195-1-hanchunchao@inspur.com
    > Signed-off-by: Mark Brown &lt;broonie@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ apparmor: fix &#x27;Do simple duplicate message elimination&#x27; (@chao liu in [97d28eee4028a25](https://github.com/sophgo/linux-riscv/commit/97d28eee4028a25) at 2024-12-05 13:02:39)
    > [ Upstream commit 9b897132424fe76bf6c61f22f9cf12af7f1d1e6a ]
    > Multiple profiles shared &#x27;ent-&gt;caps&#x27;, so some logs missed.
    > Fixes: 0ed3b28ab8bf (&quot;AppArmor: mediation of non file objects&quot;)
    > Signed-off-by: chao liu &lt;liuzgyid@outlook.com&gt;
    > Signed-off-by: John Johansen &lt;john.johansen@canonical.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/amd/display: Fix null check for pipe_ctx-&gt;plane_state in hwss_setup_dpp (@Zicheng Qu in [95792a18da07953](https://github.com/sophgo/linux-riscv/commit/95792a18da07953) at 2024-12-05 13:02:39)
    > [ Upstream commit 2bc96c95070571c6c824e0d4c7783bee25a37876 ]
    > This commit addresses a null pointer dereference issue in
    > hwss_setup_dpp(). The issue could occur when pipe_ctx-&gt;plane_state is
    > null. The fix adds a check to ensure &#x60;pipe_ctx-&gt;plane_state&#x60; is not null
    > before accessing. This prevents a null pointer dereference.
    > Fixes: 0baae6246307 (&quot;drm/amd/display: Refactor fast update to use new HWSS build sequence&quot;)
    > Reviewed-by: Tom Chung &lt;chiahsuan.chung@amd.com&gt;
    > Signed-off-by: Zicheng Qu &lt;quzicheng@huawei.com&gt;
    > Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ALSA: hda/realtek: Update ALC256 depop procedure (@Kailang Yang in [4ed7f16070a8475](https://github.com/sophgo/linux-riscv/commit/4ed7f16070a8475) at 2024-12-05 13:02:39)
    > [ Upstream commit cc3d0b5dd989d3238d456f9fd385946379a9c13d ]
    > Old procedure has a chance to meet Headphone no output.
    > Fixes: 4a219ef8f370 (&quot;ALSA: hda/realtek - Add ALC256 HP depop function&quot;)
    > Signed-off-by: Kailang Yang &lt;kailang@realtek.com&gt;
    > Link: https://lore.kernel.org/463c5f93715d4714967041a0a8cec28e@realtek.com
    > Signed-off-by: Takashi Iwai &lt;tiwai@suse.de&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/amd/display: Fix null check for pipe_ctx-&gt;plane_state in dcn20_program_pipe (@Zicheng Qu in [3609259326171cd](https://github.com/sophgo/linux-riscv/commit/3609259326171cd) at 2024-12-05 13:02:39)
    > [ Upstream commit 6a057072ddd127255350357dd880903e8fa23f36 ]
    > This commit addresses a null pointer dereference issue in
    > dcn20_program_pipe(). Previously, commit 8e4ed3cf1642 (&quot;drm/amd/display:
    > Add null check for pipe_ctx-&gt;plane_state in dcn20_program_pipe&quot;)
    > partially fixed the null pointer dereference issue. However, in
    > dcn20_update_dchubp_dpp(), the variable pipe_ctx is passed in, and
    > plane_state is accessed again through pipe_ctx. Multiple if statements
    > directly call attributes of plane_state, leading to potential null
    > pointer dereference issues. This patch adds necessary null checks to
    > ensure stability.
    > Fixes: 8e4ed3cf1642 (&quot;drm/amd/display: Add null check for pipe_ctx-&gt;plane_state in dcn20_program_pipe&quot;)
    > Reviewed-by: Tom Chung &lt;chiahsuan.chung@amd.com&gt;
    > Signed-off-by: Zicheng Qu &lt;quzicheng@huawei.com&gt;
    > Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/xe/ufence: Wake up waiters after setting ufence-&gt;signalled (@Nirmoy Das in [1133853bd68762a](https://github.com/sophgo/linux-riscv/commit/1133853bd68762a) at 2024-12-05 13:02:39)
    > [ Upstream commit 37a1cf288e4538eb39b38dbc745fe0da7ae53d94 ]
    > If a previous ufence is not signalled, vm_bind will return -EBUSY.
    > Delaying the modification of ufence-&gt;signalled can cause issues if the
    > UMD reuses the same ufence so update ufence-&gt;signalled before waking up
    > waiters.
    > Cc: Matthew Brost &lt;matthew.brost@intel.com&gt;
    > Link: https://gitlab.freedesktop.org/drm/xe/kernel/-/issues/3233
    > Fixes: 977e5b82e090 (&quot;drm/xe: Expose user fence from xe_sync_entry&quot;)
    > Reviewed-by: Matthew Brost &lt;matthew.brost@intel.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20241114150537.4161573-1-nirmoy.das@intel.com
    > Signed-off-by: Nirmoy Das &lt;nirmoy.das@intel.com&gt;
    > (cherry picked from commit 553a5d14fcd927194c409b10faced6a6dbc678d1)
    > Signed-off-by: Thomas Hellström &lt;thomas.hellstrom@linux.intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ phy: realtek: usb: fix NULL deref in rtk_usb2phy_probe (@Charles Han in [fb83c9a08324e37](https://github.com/sophgo/linux-riscv/commit/fb83c9a08324e37) at 2024-12-05 13:02:38)
    > [ Upstream commit 04e3e9188291a183b27306ddb833722c0d083d6a ]
    > In rtk_usb2phy_probe() devm_kzalloc() may return NULL
    > but this returned value is not checked.
    > Fixes: 134e6d25f6bd (&quot;phy: realtek: usb: Add driver for the Realtek SoC USB 2.0 PHY&quot;)
    > Signed-off-by: Charles Han &lt;hanchunchao@inspur.com&gt;
    > Link: https://lore.kernel.org/r/20241025065912.143692-1-hanchunchao@inspur.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ counter: ti-ecap-capture: Add check for clk_enable() (@Jiasheng Jiang in [fb6855605509a40](https://github.com/sophgo/linux-riscv/commit/fb6855605509a40) at 2024-12-05 13:02:38)
    > [ Upstream commit 1437d9f1c56fce9c24e566508bce1d218dd5497a ]
    > Add check for the return value of clk_enable() in order to catch the
    > potential exception.
    > Fixes: 4e2f42aa00b6 (&quot;counter: ti-ecap-capture: capture driver support for ECAP&quot;)
    > Reviewed-by: Julien Panis &lt;jpanis@baylibre.com&gt;
    > Signed-off-by: Jiasheng Jiang &lt;jiashengjiangcool@gmail.com&gt;
    > Link: https://lore.kernel.org/r/20241104194059.47924-1-jiashengjiangcool@gmail.com
    > Signed-off-by: William Breathitt Gray &lt;wbg@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ firmware_loader: Fix possible resource leak in fw_log_firmware_info() (@Gaosheng Cui in [f380f895dbb2a11](https://github.com/sophgo/linux-riscv/commit/f380f895dbb2a11) at 2024-12-05 13:02:38)
    > [ Upstream commit 369a9c046c2fdfe037f05b43b84c386bdbccc103 ]
    > The alg instance should be released under the exception path, otherwise
    > there may be resource leak here.
    > To mitigate this, free the alg instance with crypto_free_shash when kmalloc
    > fails.
    > Fixes: 02fe26f25325 (&quot;firmware_loader: Add debug message with checksum for FW file&quot;)
    > Signed-off-by: Gaosheng Cui &lt;cuigaosheng1@huawei.com&gt;
    > Reviewed-by: Amadeusz Sławiński &lt;amadeuszx.slawinski@linux.intel.com&gt;
    > Reviewed-by: Russ Weight &lt;russ.weight@linux.dev&gt;
    > Link: https://lore.kernel.org/r/20241016110335.3677924-1-cuigaosheng1@huawei.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ bus: mhi: host: Switch trace_mhi_gen_tre fields to native endian (@Carl Vanderlip in [cdb76fa1597ce2d](https://github.com/sophgo/linux-riscv/commit/cdb76fa1597ce2d) at 2024-12-05 13:02:38)
    > [ Upstream commit 23388a1b305e8aac714fafd5fdc72a580586bd0c ]
    > Each of the __field() macros were triggering sparse warnings similar to:
    > trace.h:87:1: sparse: sparse: cast to restricted __le64
    > trace.h:87:1: sparse: sparse: restricted __le64 degrades to integer
    > trace.h:87:1: sparse: sparse: restricted __le64 degrades to integer
    > Change each little endian type to its similarly sized native integer.
    > Convert inputs into native endian.
    > Reported-by: kernel test robot &lt;lkp@intel.com&gt;
    > Closes: https://lore.kernel.org/oe-kbuild-all/202402071859.8qMhgJEQ-lkp@intel.com/
    > Fixes: ceeb64f41fe6 (&quot;bus: mhi: host: Add tracing support&quot;)
    > Signed-off-by: Carl Vanderlip &lt;quic_carlv@quicinc.com&gt;
    > Reviewed-by: Jeffrey Hugo &lt;quic_jhugo@quicinc.com&gt;
    > Reviewed-by: Mayank Rana &lt;quic_mrana@quicinc.com&gt;
    > Reviewed-by: Manivannan Sadhasivam &lt;manivannan.sadhasivam@linaro.org&gt;
    > Link: https://lore.kernel.org/r/20241004170321.4047492-1-quic_carlv@quicinc.com
    > Signed-off-by: Manivannan Sadhasivam &lt;manivannan.sadhasivam@linaro.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ counter: stm32-timer-cnt: Add check for clk_enable() (@Jiasheng Jiang in [c4b8ecba1997a8e](https://github.com/sophgo/linux-riscv/commit/c4b8ecba1997a8e) at 2024-12-05 13:02:38)
    > [ Upstream commit 842c3755a6bfbfcafa4a1438078d2485a9eb1d87 ]
    > Add check for the return value of clk_enable() in order to catch the
    > potential exception.
    > Fixes: c5b8425514da (&quot;counter: stm32-timer-cnt: add power management support&quot;)
    > Fixes: ad29937e206f (&quot;counter: Add STM32 Timer quadrature encoder&quot;)
    > Signed-off-by: Jiasheng Jiang &lt;jiashengjiangcool@gmail.com&gt;
    > Link: https://lore.kernel.org/r/20241104191825.40155-1-jiashengjiangcool@gmail.com
    > Signed-off-by: William Breathitt Gray &lt;wbg@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ phy: realtek: usb: fix NULL deref in rtk_usb3phy_probe (@Charles Han in [776f13ad1f88485](https://github.com/sophgo/linux-riscv/commit/776f13ad1f88485) at 2024-12-05 13:02:38)
    > [ Upstream commit bf373d2919d98f3d1fe1b19a0304f72fe74386d9 ]
    > In rtk_usb3phy_probe() devm_kzalloc() may return NULL
    > but this returned value is not checked.
    > Fixes: adda6e82a7de (&quot;phy: realtek: usb: Add driver for the Realtek SoC USB 3.0 PHY&quot;)
    > Signed-off-by: Charles Han &lt;hanchunchao@inspur.com&gt;
    > Link: https://lore.kernel.org/r/20241025070744.149070-1-hanchunchao@inspur.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ usb: typec: fix potential array underflow in ucsi_ccg_sync_control() (@Dan Carpenter in [56971710cd541f2](https://github.com/sophgo/linux-riscv/commit/56971710cd541f2) at 2024-12-05 13:02:38)
    > [ Upstream commit e56aac6e5a25630645607b6856d4b2a17b2311a5 ]
    > The &quot;command&quot; variable can be controlled by the user via debugfs.  The
    > worry is that if con_index is zero then &quot;&amp;uc-&gt;ucsi-&gt;connector[con_index
    > - 1]&quot; would be an array underflow.
    > Fixes: 170a6726d0e2 (&quot;usb: typec: ucsi: add support for separate DP altmode devices&quot;)
    > Signed-off-by: Dan Carpenter &lt;dan.carpenter@linaro.org&gt;
    > Reviewed-by: Heikki Krogerus &lt;heikki.krogerus@linux.intel.com&gt;
    > Link: https://lore.kernel.org/r/c69ef0b3-61b0-4dde-98dd-97b97f81d912@stanley.mountain
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ iio: accel: adxl380: fix raw sample read (@Antoniu Miclaus in [c41dba28df05273](https://github.com/sophgo/linux-riscv/commit/c41dba28df05273) at 2024-12-05 13:02:37)
    > [ Upstream commit bfa335f18d91c52fa0f8ba3e4d49afebbd9ee792 ]
    > The adxl380_read_chn function returns either a negative value in case an
    > error occurs or the actual sample.
    > Check only for negative values after a channel is read.
    > Fixes: df36de13677a (&quot;iio: accel: add ADXL380 driver&quot;)
    > Signed-off-by: Antoniu Miclaus &lt;antoniu.miclaus@analog.com&gt;
    > Link: https://patch.msgid.link/20241101095202.20121-1-antoniu.miclaus@analog.com
    > Signed-off-by: Jonathan Cameron &lt;Jonathan.Cameron@huawei.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ iio: adc: pac1921: Check for error code from devm_mutex_init() call (@Andy Shevchenko in [ab90d20d3e8f584](https://github.com/sophgo/linux-riscv/commit/ab90d20d3e8f584) at 2024-12-05 13:02:37)
    > [ Upstream commit 869aa5e847696bcda8966be9d03de2560226bcc3 ]
    > Even if it&#x27;s not critical, the avoidance of checking the error code
    > from devm_mutex_init() call today diminishes the point of using devm
    > variant of it. Tomorrow it may even leak something. Add the missed
    > check.
    > Fixes: 371f778b83cd (&quot;iio: adc: add support for pac1921&quot;)
    > Signed-off-by: Andy Shevchenko &lt;andriy.shevchenko@linux.intel.com&gt;
    > Acked-by: Matteo Martelli &lt;matteomartelli3@gmail.com&gt;
    > Link: https://patch.msgid.link/20241030162013.2100253-3-andriy.shevchenko@linux.intel.com
    > Signed-off-by: Jonathan Cameron &lt;Jonathan.Cameron@huawei.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ iio: adc: ad4000: fix reading unsigned data (@David Lechner in [7899bb1bbb77dcd](https://github.com/sophgo/linux-riscv/commit/7899bb1bbb77dcd) at 2024-12-05 13:02:37)
    > [ Upstream commit 62dd96ac9cdf2814f41cfc55ecaf22a28aad6ccb ]
    > Fix reading unsigned data from the AD4000 ADC via the _raw sysfs
    > attribute by ensuring that *val is set before returning from
    > ad4000_single_conversion(). This was not being set in any code path
    > and was causing the attribute to return a random value.
    > Fixes: 938fd562b974 (&quot;iio: adc: Add support for AD4000&quot;)
    > Signed-off-by: David Lechner &lt;dlechner@baylibre.com&gt;
    > Link: https://patch.msgid.link/20241030-iio-adc-ad4000-fix-reading-unsigned-data-v1-1-2e28dd75fe29@baylibre.com
    > Signed-off-by: Jonathan Cameron &lt;Jonathan.Cameron@huawei.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ iio: backend: fix wrong pointer passed to IS_ERR() (@Yang Yingliang in [542c273e87772dd](https://github.com/sophgo/linux-riscv/commit/542c273e87772dd) at 2024-12-05 13:02:37)
    > [ Upstream commit fa4076314480bcb2bb32051027735b1cde07eea2 ]
    > It should be fwnode_back passed to IS_ERR().
    > Fixes: c464cc610f51 (&quot;iio: add child nodes support in iio backend framework&quot;)
    > Signed-off-by: Yang Yingliang &lt;yangyingliang@huawei.com&gt;
    > Link: https://patch.msgid.link/20241028135215.1549-1-yangyingliang@huaweicloud.com
    > Signed-off-by: Jonathan Cameron &lt;Jonathan.Cameron@huawei.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ interconnect: qcom: icc-rpmh: probe defer incase of missing QoS clock dependency (@Raviteja Laggyshetty in [00ded066e77fa50](https://github.com/sophgo/linux-riscv/commit/00ded066e77fa50) at 2024-12-05 13:02:37)
    > [ Upstream commit 05123e3299dd6aa02508469b303262338c2a661c ]
    > Return -EPROBE_DEFER from interconnect provider incase probe defer is
    > received from devm_clk_bulk_get_all(). This would help in reattempting
    > the inteconnect driver probe, once the required QoS clocks are
    > available.
    > Suggested-by: Bjorn Andersson &lt;andersson@kernel.org&gt;
    > Signed-off-by: Raviteja Laggyshetty &lt;quic_rlaggysh@quicinc.com&gt;
    > Reviewed-by: Konrad Dybcio &lt;konradybcio@kernel.org&gt;
    > Fixes: 0a7be6b35da8 (&quot;interconnect: qcom: icc-rpmh: Add QoS configuration support&quot;)
    > Link: https://lore.kernel.org/r/20240911094516.16901-1-quic_rlaggysh@quicinc.com
    > Signed-off-by: Georgi Djakov &lt;djakov@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ iio: adc: ad4000: Check for error code from devm_mutex_init() call (@Andy Shevchenko in [009cf422dcc8403](https://github.com/sophgo/linux-riscv/commit/009cf422dcc8403) at 2024-12-05 13:02:37)
    > [ Upstream commit 8ebfd09255219ae55f8a101f6aeb0f64dd780d88 ]
    > Even if it&#x27;s not critical, the avoidance of checking the error code
    > from devm_mutex_init() call today diminishes the point of using devm
    > variant of it. Tomorrow it may even leak something. Add the missed
    > check.
    > Fixes: 938fd562b974 (&quot;iio: adc: Add support for AD4000&quot;)
    > Signed-off-by: Andy Shevchenko &lt;andriy.shevchenko@linux.intel.com&gt;
    > Link: https://patch.msgid.link/20241030162013.2100253-2-andriy.shevchenko@linux.intel.com
    > Signed-off-by: Jonathan Cameron &lt;Jonathan.Cameron@huawei.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ USB: chaoskey: fail open after removal (@Oliver Neukum in [b20b6f29047fb58](https://github.com/sophgo/linux-riscv/commit/b20b6f29047fb58) at 2024-12-05 13:02:36)
    > [ Upstream commit 422dc0a4d12d0b80dd3aab3fe5943f665ba8f041 ]
    > chaoskey_open() takes the lock only to increase the
    > counter of openings. That means that the mutual exclusion
    > with chaoskey_disconnect() cannot prevent an increase
    > of the counter and chaoskey_open() returning a success.
    > If that race is hit, chaoskey_disconnect() will happily
    > free all resources associated with the device after
    > it has dropped the lock, as it has read the counter
    > as zero.
    > To prevent this race chaoskey_open() has to check
    > the presence of the device under the lock.
    > However, the current per device lock cannot be used,
    > because it is a part of the data structure to be
    > freed. Hence an additional global mutex is needed.
    > The issue is as old as the driver.
    > Signed-off-by: Oliver Neukum &lt;oneukum@suse.com&gt;
    > Reported-by: syzbot+422188bce66e76020e55@syzkaller.appspotmail.com
    > Closes: https://syzkaller.appspot.com/bug?extid&#x3D;422188bce66e76020e55
    > Fixes: 66e3e591891da (&quot;usb: Add driver for Altus Metrum ChaosKey device (v2)&quot;)
    > Rule: add
    > Link: https://lore.kernel.org/stable/20241002132201.552578-1-oneukum%40suse.com
    > Link: https://lore.kernel.org/r/20241002132201.552578-1-oneukum@suse.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ USB: chaoskey: Fix possible deadlock chaoskey_list_lock (@Edward Adam Davis in [9d35229751666de](https://github.com/sophgo/linux-riscv/commit/9d35229751666de) at 2024-12-05 13:02:36)
    > [ Upstream commit d73dc7b182be4238b75278bfae16afb4c5564a58 ]
    > [Syzbot reported two possible deadlocks]
    > The first possible deadlock is:
    > WARNING: possible recursive locking detected
    > 6.12.0-rc1-syzkaller-00027-g4a9fe2a8ac53 #0 Not tainted
    > --------------------------------------------
    > syz-executor363/2651 is trying to acquire lock:
    > ffffffff89b120e8 (chaoskey_list_lock){+.+.}-{3:3}, at: chaoskey_release+0x15d/0x2c0 drivers/usb/misc/chaoskey.c:322
    > but task is already holding lock:
    > ffffffff89b120e8 (chaoskey_list_lock){+.+.}-{3:3}, at: chaoskey_release+0x7f/0x2c0 drivers/usb/misc/chaoskey.c:299
    > other info that might help us debug this:
    > Possible unsafe locking scenario:
    > CPU0
    > ----
    > lock(chaoskey_list_lock);
    > lock(chaoskey_list_lock);
    > ** DEADLOCK ***
    > The second possible deadlock is:
    > WARNING: possible circular locking dependency detected
    > 6.12.0-rc1-syzkaller-00027-g4a9fe2a8ac53 #0 Not tainted
    > ------------------------------------------------------
    > kworker/0:2/804 is trying to acquire lock:
    > ffffffff899dadb0 (minor_rwsem){++++}-{3:3}, at: usb_deregister_dev+0x7c/0x1e0 drivers/usb/core/file.c:186
    > but task is already holding lock:
    > ffffffff89b120e8 (chaoskey_list_lock){+.+.}-{3:3}, at: chaoskey_disconnect+0xa8/0x2a0 drivers/usb/misc/chaoskey.c:235
    > which lock already depends on the new lock.
    > the existing dependency chain (in reverse order) is:
    > -&gt; #1 (chaoskey_list_lock){+.+.}-{3:3}:
    > __mutex_lock_common kernel/locking/mutex.c:608 [inline]
    > __mutex_lock+0x175/0x9c0 kernel/locking/mutex.c:752
    > chaoskey_open+0xdd/0x220 drivers/usb/misc/chaoskey.c:274
    > usb_open+0x186/0x220 drivers/usb/core/file.c:47
    > chrdev_open+0x237/0x6a0 fs/char_dev.c:414
    > do_dentry_open+0x6cb/0x1390 fs/open.c:958
    > vfs_open+0x82/0x3f0 fs/open.c:1088
    > do_open fs/namei.c:3774 [inline]
    > path_openat+0x1e6a/0x2d60 fs/namei.c:3933
    > do_filp_open+0x1dc/0x430 fs/namei.c:3960
    > do_sys_openat2+0x17a/0x1e0 fs/open.c:1415
    > do_sys_open fs/open.c:1430 [inline]
    > __do_sys_openat fs/open.c:1446 [inline]
    > __se_sys_openat fs/open.c:1441 [inline]
    > __x64_sys_openat+0x175/0x210 fs/open.c:1441
    > do_syscall_x64 arch/x86/entry/common.c:52 [inline]
    > do_syscall_64+0xcd/0x250 arch/x86/entry/common.c:83
    > entry_SYSCALL_64_after_hwframe+0x77/0x7f
    > -&gt; #0 (minor_rwsem){++++}-{3:3}:
    > check_prev_add kernel/locking/lockdep.c:3161 [inline]
    > check_prevs_add kernel/locking/lockdep.c:3280 [inline]
    > validate_chain kernel/locking/lockdep.c:3904 [inline]
    > __lock_acquire+0x250b/0x3ce0 kernel/locking/lockdep.c:5202
    > lock_acquire.part.0+0x11b/0x380 kernel/locking/lockdep.c:5825
    > down_write+0x93/0x200 kernel/locking/rwsem.c:1577
    > usb_deregister_dev+0x7c/0x1e0 drivers/usb/core/file.c:186
    > chaoskey_disconnect+0xb7/0x2a0 drivers/usb/misc/chaoskey.c:236
    > usb_unbind_interface+0x1e8/0x970 drivers/usb/core/driver.c:461
    > device_remove drivers/base/dd.c:569 [inline]
    > device_remove+0x122/0x170 drivers/base/dd.c:561
    > __device_release_driver drivers/base/dd.c:1273 [inline]
    > device_release_driver_internal+0x44a/0x610 drivers/base/dd.c:1296
    > bus_remove_device+0x22f/0x420 drivers/base/bus.c:576
    > device_del+0x396/0x9f0 drivers/base/core.c:3864
    > usb_disable_device+0x36c/0x7f0 drivers/usb/core/message.c:1418
    > usb_disconnect+0x2e1/0x920 drivers/usb/core/hub.c:2304
    > hub_port_connect drivers/usb/core/hub.c:5361 [inline]
    > hub_port_connect_change drivers/usb/core/hub.c:5661 [inline]
    > port_event drivers/usb/core/hub.c:5821 [inline]
    > hub_event+0x1bed/0x4f40 drivers/usb/core/hub.c:5903
    > process_one_work+0x9c5/0x1ba0 kernel/workqueue.c:3229
    > process_scheduled_works kernel/workqueue.c:3310 [inline]
    > worker_thread+0x6c8/0xf00 kernel/workqueue.c:3391
    > kthread+0x2c1/0x3a0 kernel/kthread.c:389
    > ret_from_fork+0x45/0x80 arch/x86/kernel/process.c:147
    > ret_from_fork_asm+0x1a/0x30 arch/x86/entry/entry_64.S:244
    > other info that might help us debug this:
    > Possible unsafe locking scenario:
    > CPU0                    CPU1
    > ----                    ----
    > lock(chaoskey_list_lock);
    > lock(minor_rwsem);
    > lock(chaoskey_list_lock);
    > lock(minor_rwsem);
    > ** DEADLOCK ***
    > [Analysis]
    > The first is AA lock, it because wrong logic, it need a unlock.
    > The second is AB lock, it needs to rearrange the order of lock usage.
    > Fixes: 422dc0a4d12d (&quot;USB: chaoskey: fail open after removal&quot;)
    > Reported-by: syzbot+685e14d04fe35692d3bc@syzkaller.appspotmail.com
    > Reported-by: syzbot+1f8ca5ee82576ec01f12@syzkaller.appspotmail.com
    > Closes: https://syzkaller.appspot.com/bug?extid&#x3D;685e14d04fe35692d3bc
    > Signed-off-by: Edward Adam Davis &lt;eadavis@qq.com&gt;
    > Tested-by: syzbot+685e14d04fe35692d3bc@syzkaller.appspotmail.com
    > Reported-by: syzbot+5f1ce62e956b7b19610e@syzkaller.appspotmail.com
    > Tested-by: syzbot+5f1ce62e956b7b19610e@syzkaller.appspotmail.com
    > Tested-by: syzbot+1f8ca5ee82576ec01f12@syzkaller.appspotmail.com
    > Link: https://lore.kernel.org/r/tencent_84EB865C89862EC22EE94CB3A7C706C59206@qq.com
    > Cc: Oliver Neukum &lt;oneukum@suse.com&gt;
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ usb: using mutex lock and supporting O_NONBLOCK flag in iowarrior_read() (@Jeongjun Park in [7cd0064f2109727](https://github.com/sophgo/linux-riscv/commit/7cd0064f2109727) at 2024-12-05 13:02:36)
    > [ Upstream commit 44feafbaa66ec86232b123bb8437a6a262442025 ]
    > iowarrior_read() uses the iowarrior dev structure, but does not use any
    > lock on the structure. This can cause various bugs including data-races,
    > so it is more appropriate to use a mutex lock to safely protect the
    > iowarrior dev structure. When using a mutex lock, you should split the
    > branch to prevent blocking when the O_NONBLOCK flag is set.
    > In addition, it is unnecessary to check for NULL on the iowarrior dev
    > structure obtained by reading file-&gt;private_data. Therefore, it is
    > better to remove the check.
    > Fixes: 946b960d13c1 (&quot;USB: add driver for iowarrior devices.&quot;)
    > Signed-off-by: Jeongjun Park &lt;aha310510@gmail.com&gt;
    > Link: https://lore.kernel.org/r/20240919103403.3986-1-aha310510@gmail.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ misc: apds990x: Fix missing pm_runtime_disable() (@Jinjie Ruan in [7a285d781e020f2](https://github.com/sophgo/linux-riscv/commit/7a285d781e020f2) at 2024-12-05 13:02:36)
    > [ Upstream commit 3c5d8b819d27012264edd17e6ae7fffda382fe44 ]
    > The pm_runtime_disable() is missing in probe error path,
    > so add it to fix it.
    > Fixes: 92b1f84d46b2 (&quot;drivers/misc: driver for APDS990X ALS and proximity sensors&quot;)
    > Signed-off-by: Jinjie Ruan &lt;ruanjinjie@huawei.com&gt;
    > Link: https://lore.kernel.org/r/20240923035556.3009105-1-ruanjinjie@huawei.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ devres: Fix page faults when tracing devres from unloaded modules (@Keita Morisaki in [50ec32f914119dc](https://github.com/sophgo/linux-riscv/commit/50ec32f914119dc) at 2024-12-05 13:02:36)
    > [ Upstream commit 765399553714e934a219d698953d435f4f99caa7 ]
    > The devres ftrace event logs the name of the devres node, which is often a
    > function name (e.g., &quot;devm_work_drop&quot;) stringified by macros like
    > devm_add_action. Currently, ftrace stores this name as a string literal
    > address, which can become invalid when the module containing the string is
    > unloaded. This results in page faults when ftrace tries to access the name.
    > This behavior is problematic because the devres ftrace event is designed to
    > trace resource management throughout a device driver&#x27;s lifecycle, including
    > during module unload. The event should be available even after the module
    > is unloaded to properly diagnose resource issues.
    > Fix the issue by copying the devres node name into the ftrace ring buffer
    > using __assign_str(), instead of storing just the address. This ensures
    > that ftrace can always access the name, even if the module is unloaded.
    > This change increases the memory usage for each of the ftrace entry by
    > 12-16 bytes assuming the average devres node name is 20 bytes long,
    > depending on the size of const char *.
    > Note that this change does not affect anything unless all of following
    > conditions are met.
    > - CONFIG_DEBUG_DEVRES is enabled
    > - ftrace tracing is enabled
    > - The devres event is enabled in ftrace tracing
    > Fixes: 09705dcb63d2 (&quot;devres: Enable trace events&quot;)
    > Reviewed-by: Andy Shevchenko &lt;andriy.shevchenko@linux.intel.com&gt;
    > Signed-off-by: Keita Morisaki &lt;keyz@google.com&gt;
    > Link: https://lore.kernel.org/r/20240928125005.714781-1-keyz@google.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ usb: yurex: make waiting on yurex_write interruptible (@Oliver Neukum in [2a0f671e9f0ba83](https://github.com/sophgo/linux-riscv/commit/2a0f671e9f0ba83) at 2024-12-05 13:02:36)
    > [ Upstream commit e0aa9614ab0fd35b404e4b16ebe879f9fc152591 ]
    > The IO yurex_write() needs to wait for in order to have a device
    > ready for writing again can take a long time time.
    > Consequently the sleep is done in an interruptible state.
    > Therefore others waiting for yurex_write() itself to finish should
    > use mutex_lock_interruptible.
    > Signed-off-by: Oliver Neukum &lt;oneukum@suse.com&gt;
    > Fixes: 6bc235a2e24a5 (&quot;USB: add driver for Meywa-Denki &amp; Kayac YUREX&quot;)
    > Rule: add
    > Link: https://lore.kernel.org/stable/20240924084415.300557-1-oneukum%40suse.com
    > Link: https://lore.kernel.org/r/20240924084415.300557-1-oneukum@suse.com
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ usb: gadget: uvc: wake pump everytime we update the free list (@Michael Grzeschik in [14367e7170d4ed4](https://github.com/sophgo/linux-riscv/commit/14367e7170d4ed4) at 2024-12-05 13:02:36)
    > [ Upstream commit adc292d54de9db2e6b8ecb7f81f278bbbaf713e9 ]
    > Since the req_free list will updated if enqueuing one request was not
    > possible it will be added back to the free list. With every available
    > free request in the queue it is a valid case for the pump worker to use
    > it and continue the pending bufferdata into requests for the req_ready
    > list.
    > Fixes: 6acba0345b68 (&quot;usb:gadget:uvc Do not use worker thread to pump isoc usb requests&quot;)
    > Signed-off-by: Michael Grzeschik &lt;m.grzeschik@pengutronix.de&gt;
    > Link: https://lore.kernel.org/r/20240403-uvc_request_length_by_interval-v7-1-e224bb1035f0@pengutronix.de
    > Signed-off-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ iio: light: al3010: Fix an error handling path in al3010_probe() (@Christophe JAILLET in [ff2672174d90164](https://github.com/sophgo/linux-riscv/commit/ff2672174d90164) at 2024-12-05 13:02:35)
    > [ Upstream commit a4b7064d34186cf4970fe0333c3b27346cf8f819 ]
    > If i2c_smbus_write_byte_data() fails in al3010_init(),
    > al3010_set_pwr(false) is not called.
    > In order to avoid such a situation, move the devm_add_action_or_reset()
    > witch calls al3010_set_pwr(false) right after a successful
    > al3010_set_pwr(true).
    > Fixes: c36b5195ab70 (&quot;iio: light: add Dyna-Image AL3010 driver&quot;)
    > Signed-off-by: Christophe JAILLET &lt;christophe.jaillet@wanadoo.fr&gt;
    > Link: https://patch.msgid.link/ee5d10a2dd2b70f29772d5df33774d3974a80f30.1725993353.git.christophe.jaillet@wanadoo.fr
    > Signed-off-by: Jonathan Cameron &lt;Jonathan.Cameron@huawei.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ip6mr: fix tables suspicious RCU usage (@Paolo Abeni in [ead7c1263ebe1eb](https://github.com/sophgo/linux-riscv/commit/ead7c1263ebe1eb) at 2024-12-05 13:02:35)
    > [ Upstream commit f1553c9894b4dbeb10a2ab15ab1aa113b3b4047c ]
    > Several places call ip6mr_get_table() with no RCU nor RTNL lock.
    > Add RCU protection inside such helper and provide a lockless variant
    > for the few callers that already acquired the relevant lock.
    > Note that some users additionally reference the table outside the RCU
    > lock. That is actually safe as the table deletion can happen only
    > after all table accesses are completed.
    > Fixes: e2d57766e674 (&quot;net: Provide compat support for SIOCGETMIFCNT_IN6 and SIOCGETSGCNT_IN6.&quot;)
    > Fixes: d7c31cbde4bc (&quot;net: ip6mr: add RTM_GETROUTE netlink op&quot;)
    > Reviewed-by: David Ahern &lt;dsahern@kernel.org&gt;
    > Signed-off-by: Paolo Abeni &lt;pabeni@redhat.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ Bluetooth: MGMT: Fix possible deadlocks (@Luiz Augusto von Dentz in [cac34e44281f1f1](https://github.com/sophgo/linux-riscv/commit/cac34e44281f1f1) at 2024-12-05 13:02:35)
    > [ Upstream commit a66dfaf18fd61bb75ef8cee83db46b2aadf153d0 ]
    > This fixes possible deadlocks like the following caused by
    > hci_cmd_sync_dequeue causing the destroy function to run:
    > INFO: task kworker/u19:0:143 blocked for more than 120 seconds.
    > Tainted: G        W  O        6.8.0-2024-03-19-intel-next-iLS-24ww14 #1
    > &quot;echo 0 &gt; /proc/sys/kernel/hung_task_timeout_secs&quot; disables this message.
    > task:kworker/u19:0   state:D stack:0     pid:143   tgid:143   ppid:2      flags:0x00004000
    > Workqueue: hci0 hci_cmd_sync_work [bluetooth]
    > Call Trace:
    > &lt;TASK&gt;
    > __schedule+0x374/0xaf0
    > schedule+0x3c/0xf0
    > schedule_preempt_disabled+0x1c/0x30
    > __mutex_lock.constprop.0+0x3ef/0x7a0
    > __mutex_lock_slowpath+0x13/0x20
    > mutex_lock+0x3c/0x50
    > mgmt_set_connectable_complete+0xa4/0x150 [bluetooth]
    > ? kfree+0x211/0x2a0
    > hci_cmd_sync_dequeue+0xae/0x130 [bluetooth]
    > ? __pfx_cmd_complete_rsp+0x10/0x10 [bluetooth]
    > cmd_complete_rsp+0x26/0x80 [bluetooth]
    > mgmt_pending_foreach+0x4d/0x70 [bluetooth]
    > __mgmt_power_off+0x8d/0x180 [bluetooth]
    > ? _raw_spin_unlock_irq+0x23/0x40
    > hci_dev_close_sync+0x445/0x5b0 [bluetooth]
    > hci_set_powered_sync+0x149/0x250 [bluetooth]
    > set_powered_sync+0x24/0x60 [bluetooth]
    > hci_cmd_sync_work+0x90/0x150 [bluetooth]
    > process_one_work+0x13e/0x300
    > worker_thread+0x2f7/0x420
    > ? __pfx_worker_thread+0x10/0x10
    > kthread+0x107/0x140
    > ? __pfx_kthread+0x10/0x10
    > ret_from_fork+0x3d/0x60
    > ? __pfx_kthread+0x10/0x10
    > ret_from_fork_asm+0x1b/0x30
    > &lt;/TASK&gt;
    > Tested-by: Kiran K &lt;kiran.k@intel.com&gt;
    > Fixes: f53e1c9c726d (&quot;Bluetooth: MGMT: Fix possible crash on mgmt_index_removed&quot;)
    > Signed-off-by: Luiz Augusto von Dentz &lt;luiz.von.dentz@intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ rxrpc: Improve setsockopt() handling of malformed user input (@Michal Luczaj in [8052a9b9714d181](https://github.com/sophgo/linux-riscv/commit/8052a9b9714d181) at 2024-12-05 13:02:35)
    > [ Upstream commit 02020056647017e70509bb58c3096448117099e1 ]
    > copy_from_sockptr() does not return negative value on error; instead, it
    > reports the number of bytes that failed to copy. Since it&#x27;s deprecated,
    > switch to copy_safe_from_sockptr().
    > Note: Keeping the &#x60;optlen !&#x3D; sizeof(unsigned int)&#x60; check as
    > copy_safe_from_sockptr() by itself would also accept
    > optlen &gt; sizeof(unsigned int). Which would allow a more lenient handling
    > of inputs.
    > Fixes: 17926a79320a (&quot;[AF_RXRPC]: Provide secure RxRPC sockets for use by userspace and kernel both&quot;)
    > Signed-off-by: Michal Luczaj &lt;mhal@rbox.co&gt;
    > Signed-off-by: Paolo Abeni &lt;pabeni@redhat.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ipmr: fix tables suspicious RCU usage (@Paolo Abeni in [72bb7903de7058b](https://github.com/sophgo/linux-riscv/commit/72bb7903de7058b) at 2024-12-05 13:02:35)
    > [ Upstream commit fc9c273d6daaa9866f349bbe8cae25c67764c456 ]
    > Similar to the previous patch, plumb the RCU lock inside
    > the ipmr_get_table(), provided a lockless variant and apply
    > the latter in the few spots were the lock is already held.
    > Fixes: 709b46e8d90b (&quot;net: Add compat ioctl support for the ipv4 multicast ioctl SIOCGETSGCNT&quot;)
    > Fixes: f0ad0860d01e (&quot;ipv4: ipmr: support multiple tables&quot;)
    > Reviewed-by: David Ahern &lt;dsahern@kernel.org&gt;
    > Signed-off-by: Paolo Abeni &lt;pabeni@redhat.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ tcp: Fix use-after-free of nreq in reqsk_timer_handler(). (@Kuniyuki Iwashima in [6d845028609a4af](https://github.com/sophgo/linux-riscv/commit/6d845028609a4af) at 2024-12-05 13:02:35)
    > [ Upstream commit c31e72d021db2714df03df6c42855a1db592716c ]
    > The cited commit replaced inet_csk_reqsk_queue_drop_and_put() with
    > __inet_csk_reqsk_queue_drop() and reqsk_put() in reqsk_timer_handler().
    > Then, oreq should be passed to reqsk_put() instead of req; otherwise
    > use-after-free of nreq could happen when reqsk is migrated but the
    > retry attempt failed (e.g. due to timeout).
    > Let&#x27;s pass oreq to reqsk_put().
    > Fixes: e8c526f2bdf1 (&quot;tcp/dccp: Don&#x27;t use timer_pending() in reqsk_queue_unlink().&quot;)
    > Reported-by: Liu Jian &lt;liujian56@huawei.com&gt;
    > Closes: https://lore.kernel.org/netdev/1284490f-9525-42ee-b7b8-ccadf6606f6d@huawei.com/
    > Signed-off-by: Kuniyuki Iwashima &lt;kuniyu@amazon.com&gt;
    > Reviewed-by: Vadim Fedorenko &lt;vadim.fedorenko@linux.dev&gt;
    > Reviewed-by: Liu Jian &lt;liujian56@huawei.com&gt;
    > Reviewed-by: Eric Dumazet &lt;edumazet@google.com&gt;
    > Reviewed-by: Martin KaFai Lau &lt;martin.lau@kernel.org&gt;
    > Link: https://patch.msgid.link/20241123174236.62438-1-kuniyu@amazon.com
    > Signed-off-by: Paolo Abeni &lt;pabeni@redhat.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ llc: Improve setsockopt() handling of malformed user input (@Michal Luczaj in [3c0e013b9ffebc6](https://github.com/sophgo/linux-riscv/commit/3c0e013b9ffebc6) at 2024-12-05 13:02:35)
    > [ Upstream commit 1465036b10be4b8b00eb31c879e86de633ad74c1 ]
    > copy_from_sockptr() is used incorrectly: return value is the number of
    > bytes that could not be copied. Since it&#x27;s deprecated, switch to
    > copy_safe_from_sockptr().
    > Note: Keeping the &#x60;optlen !&#x3D; sizeof(int)&#x60; check as copy_safe_from_sockptr()
    > by itself would also accept optlen &gt; sizeof(int). Which would allow a more
    > lenient handling of inputs.
    > Fixes: 1da177e4c3f4 (&quot;Linux-2.6.12-rc2&quot;)
    > Suggested-by: David Wei &lt;dw@davidwei.uk&gt;
    > Signed-off-by: Michal Luczaj &lt;mhal@rbox.co&gt;
    > Signed-off-by: Paolo Abeni &lt;pabeni@redhat.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ bnxt_en: Set backplane link modes correctly for ethtool (@Shravya KN in [b83c913d53ca68c](https://github.com/sophgo/linux-riscv/commit/b83c913d53ca68c) at 2024-12-05 13:02:34)
    > [ Upstream commit 5007991670941c132fb3bc0484c009cf4bcea30f ]
    > Use the return value from bnxt_get_media() to determine the port and
    > link modes.  bnxt_get_media() returns the proper BNXT_MEDIA_KR when
    > the PHY is backplane.  This will correct the ethtool settings for
    > backplane devices.
    > Fixes: 5d4e1bf60664 (&quot;bnxt_en: extend media types to supported and autoneg modes&quot;)
    > Reviewed-by: Somnath Kotur &lt;somnath.kotur@broadcom.com&gt;
    > Signed-off-by: Shravya KN &lt;shravya.k-n@broadcom.com&gt;
    > Signed-off-by: Michael Chan &lt;michael.chan@broadcom.com&gt;
    > Signed-off-by: Paolo Abeni &lt;pabeni@redhat.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ Bluetooth: MGMT: Fix slab-use-after-free Read in set_powered_sync (@Luiz Augusto von Dentz in [87819234aa1d2a0](https://github.com/sophgo/linux-riscv/commit/87819234aa1d2a0) at 2024-12-05 13:02:34)
    > [ Upstream commit 0b882940665ca2849386ee459d4331aa2f8c4e7d ]
    > This fixes the following crash:
    > &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;
    > BUG: KASAN: slab-use-after-free in set_powered_sync+0x3a/0xc0 net/bluetooth/mgmt.c:1353
    > Read of size 8 at addr ffff888029b4dd18 by task kworker/u9:0/54
    > CPU: 1 UID: 0 PID: 54 Comm: kworker/u9:0 Not tainted 6.11.0-rc6-syzkaller-01155-gf723224742fc #0
    > Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 08/06/2024
    > Workqueue: hci0 hci_cmd_sync_work
    > Call Trace:
    > &lt;TASK&gt;
    > __dump_stack lib/dump_stack.c:93 [inline]
    > dump_stack_lvl+0x241/0x360 lib/dump_stack.c:119
    > print_address_description mm/kasan/report.c:377 [inline]
    > print_report+0x169/0x550 mm/kasan/report.c:488
    > q kasan_report+0x143/0x180 mm/kasan/report.c:601
    > set_powered_sync+0x3a/0xc0 net/bluetooth/mgmt.c:1353
    > hci_cmd_sync_work+0x22b/0x400 net/bluetooth/hci_sync.c:328
    > process_one_work kernel/workqueue.c:3231 [inline]
    > process_scheduled_works+0xa2c/0x1830 kernel/workqueue.c:3312
    > worker_thread+0x86d/0xd10 kernel/workqueue.c:3389
    > kthread+0x2f0/0x390 kernel/kthread.c:389
    > ret_from_fork+0x4b/0x80 arch/x86/kernel/process.c:147
    > ret_from_fork_asm+0x1a/0x30 arch/x86/entry/entry_64.S:244
    > &lt;/TASK&gt;
    > Allocated by task 5247:
    > kasan_save_stack mm/kasan/common.c:47 [inline]
    > kasan_save_track+0x3f/0x80 mm/kasan/common.c:68
    > poison_kmalloc_redzone mm/kasan/common.c:370 [inline]
    > __kasan_kmalloc+0x98/0xb0 mm/kasan/common.c:387
    > kasan_kmalloc include/linux/kasan.h:211 [inline]
    > __kmalloc_cache_noprof+0x19c/0x2c0 mm/slub.c:4193
    > kmalloc_noprof include/linux/slab.h:681 [inline]
    > kzalloc_noprof include/linux/slab.h:807 [inline]
    > mgmt_pending_new+0x65/0x250 net/bluetooth/mgmt_util.c:269
    > mgmt_pending_add+0x36/0x120 net/bluetooth/mgmt_util.c:296
    > set_powered+0x3cd/0x5e0 net/bluetooth/mgmt.c:1394
    > hci_mgmt_cmd+0xc47/0x11d0 net/bluetooth/hci_sock.c:1712
    > hci_sock_sendmsg+0x7b8/0x11c0 net/bluetooth/hci_sock.c:1832
    > sock_sendmsg_nosec net/socket.c:730 [inline]
    > __sock_sendmsg+0x221/0x270 net/socket.c:745
    > sock_write_iter+0x2dd/0x400 net/socket.c:1160
    > new_sync_write fs/read_write.c:497 [inline]
    > vfs_write+0xa72/0xc90 fs/read_write.c:590
    > ksys_write+0x1a0/0x2c0 fs/read_write.c:643
    > do_syscall_x64 arch/x86/entry/common.c:52 [inline]
    > do_syscall_64+0xf3/0x230 arch/x86/entry/common.c:83
    > entry_SYSCALL_64_after_hwframe+0x77/0x7f
    > Freed by task 5246:
    > kasan_save_stack mm/kasan/common.c:47 [inline]
    > kasan_save_track+0x3f/0x80 mm/kasan/common.c:68
    > kasan_save_free_info+0x40/0x50 mm/kasan/generic.c:579
    > poison_slab_object+0xe0/0x150 mm/kasan/common.c:240
    > __kasan_slab_free+0x37/0x60 mm/kasan/common.c:256
    > kasan_slab_free include/linux/kasan.h:184 [inline]
    > slab_free_hook mm/slub.c:2256 [inline]
    > slab_free mm/slub.c:4477 [inline]
    > kfree+0x149/0x360 mm/slub.c:4598
    > settings_rsp+0x2bc/0x390 net/bluetooth/mgmt.c:1443
    > mgmt_pending_foreach+0xd1/0x130 net/bluetooth/mgmt_util.c:259
    > __mgmt_power_off+0x112/0x420 net/bluetooth/mgmt.c:9455
    > hci_dev_close_sync+0x665/0x11a0 net/bluetooth/hci_sync.c:5191
    > hci_dev_do_close net/bluetooth/hci_core.c:483 [inline]
    > hci_dev_close+0x112/0x210 net/bluetooth/hci_core.c:508
    > sock_do_ioctl+0x158/0x460 net/socket.c:1222
    > sock_ioctl+0x629/0x8e0 net/socket.c:1341
    > vfs_ioctl fs/ioctl.c:51 [inline]
    > __do_sys_ioctl fs/ioctl.c:907 [inline]
    > __se_sys_ioctl+0xfc/0x170 fs/ioctl.c:893
    > do_syscall_x64 arch/x86/entry/common.c:52 [inline]
    > do_syscall_64+0xf3/0x230 arch/x86/entry/common.c:83gv
    > entry_SYSCALL_64_after_hwframe+0x77/0x7f
    > Reported-by: syzbot+03d6270b6425df1605bf@syzkaller.appspotmail.com
    > Tested-by: syzbot+03d6270b6425df1605bf@syzkaller.appspotmail.com
    > Closes: https://syzkaller.appspot.com/bug?extid&#x3D;03d6270b6425df1605bf
    > Fixes: 275f3f648702 (&quot;Bluetooth: Fix not checking MGMT cmd pending queue&quot;)
    > Signed-off-by: Luiz Augusto von Dentz &lt;luiz.von.dentz@intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ bnxt_en: Fix receive ring space parameters when XDP is active (@Shravya KN in [84353386762a0a1](https://github.com/sophgo/linux-riscv/commit/84353386762a0a1) at 2024-12-05 13:02:34)
    > [ Upstream commit 3051a77a09dfe3022aa012071346937fdf059033 ]
    > The MTU setting at the time an XDP multi-buffer is attached
    > determines whether the aggregation ring will be used and the
    > rx_skb_func handler.  This is done in bnxt_set_rx_skb_mode().
    > If the MTU is later changed, the aggregation ring setting may need
    > to be changed and it may become out-of-sync with the settings
    > initially done in bnxt_set_rx_skb_mode().  This may result in
    > random memory corruption and crashes as the HW may DMA data larger
    > than the allocated buffer size, such as:
    > BUG: kernel NULL pointer dereference, address: 00000000000003c0
    > PGD 0 P4D 0
    > Oops: 0000 [#1] PREEMPT SMP NOPTI
    > CPU: 17 PID: 0 Comm: swapper/17 Kdump: loaded Tainted: G S         OE      6.1.0-226bf9805506 #1
    > Hardware name: Wiwynn Delta Lake PVT BZA.02601.0150/Delta Lake-Class1, BIOS F0E_3A12 08/26/2021
    > RIP: 0010:bnxt_rx_pkt+0xe97/0x1ae0 [bnxt_en]
    > Code: 8b 95 70 ff ff ff 4c 8b 9d 48 ff ff ff 66 41 89 87 b4 00 00 00 e9 0b f7 ff ff 0f b7 43 0a 49 8b 95 a8 04 00 00 25 ff 0f 00 00 &lt;0f&gt; b7 14 42 48 c1 e2 06 49 03 95 a0 04 00 00 0f b6 42 33f
    > RSP: 0018:ffffa19f40cc0d18 EFLAGS: 00010202
    > RAX: 00000000000001e0 RBX: ffff8e2c805c6100 RCX: 00000000000007ff
    > RDX: 0000000000000000 RSI: ffff8e2c271ab990 RDI: ffff8e2c84f12380
    > RBP: ffffa19f40cc0e48 R08: 000000000001000d R09: 974ea2fcddfa4cbf
    > R10: 0000000000000000 R11: ffffa19f40cc0ff8 R12: ffff8e2c94b58980
    > R13: ffff8e2c952d6600 R14: 0000000000000016 R15: ffff8e2c271ab990
    > FS:  0000000000000000(0000) GS:ffff8e3b3f840000(0000) knlGS:0000000000000000
    > CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
    > CR2: 00000000000003c0 CR3: 0000000e8580a004 CR4: 00000000007706e0
    > DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
    > DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
    > PKRU: 55555554
    > Call Trace:
    > &lt;IRQ&gt;
    > __bnxt_poll_work+0x1c2/0x3e0 [bnxt_en]
    > To address the issue, we now call bnxt_set_rx_skb_mode() within
    > bnxt_change_mtu() to properly set the AGG rings configuration and
    > update rx_skb_func based on the new MTU value.
    > Additionally, BNXT_FLAG_NO_AGG_RINGS is cleared at the beginning of
    > bnxt_set_rx_skb_mode() to make sure it gets set or cleared based on
    > the current MTU.
    > Fixes: 08450ea98ae9 (&quot;bnxt_en: Fix max_mtu setting for multi-buf XDP&quot;)
    > Co-developed-by: Somnath Kotur &lt;somnath.kotur@broadcom.com&gt;
    > Signed-off-by: Somnath Kotur &lt;somnath.kotur@broadcom.com&gt;
    > Signed-off-by: Shravya KN &lt;shravya.k-n@broadcom.com&gt;
    > Signed-off-by: Michael Chan &lt;michael.chan@broadcom.com&gt;
    > Signed-off-by: Paolo Abeni &lt;pabeni@redhat.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ bnxt_en: Reserve rings after PCIe AER recovery if NIC interface is down (@Saravanan Vajravel in [3c38fe57c83798a](https://github.com/sophgo/linux-riscv/commit/3c38fe57c83798a) at 2024-12-05 13:02:34)
    > [ Upstream commit 5311598f7f3293683cdc761df71ae3469327332c ]
    > After successful PCIe AER recovery, FW will reset all resource
    > reservations.  If it is IF_UP, the driver will call bnxt_open() and
    > all resources will be reserved again.  It it is IF_DOWN, we should
    > call bnxt_reserve_rings() so that we can reserve resources including
    > RoCE resources to allow RoCE to resume after AER.  Without this
    > patch, RoCE fails to resume in this IF_DOWN scenario.
    > Later, if it becomes IF_UP, bnxt_open() will see that resources have
    > been reserved and will not reserve again.
    > Fixes: fb1e6e562b37 (&quot;bnxt_en: Fix AER recovery.&quot;)
    > Reviewed-by: Somnath Kotur &lt;somnath.kotur@broadcom.com&gt;
    > Reviewed-by: Pavan Chebbi &lt;pavan.chebbi@broadcom.com&gt;
    > Reviewed-by: Kashyap Desai &lt;kashyap.desai@broadcom.com&gt;
    > Signed-off-by: Saravanan Vajravel &lt;saravanan.vajravel@broadcom.com&gt;
    > Signed-off-by: Michael Chan &lt;michael.chan@broadcom.com&gt;
    > Signed-off-by: Paolo Abeni &lt;pabeni@redhat.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ bnxt_en: Unregister PTP during PCI shutdown and suspend (@Michael Chan in [39497f45ff2d179](https://github.com/sophgo/linux-riscv/commit/39497f45ff2d179) at 2024-12-05 13:02:34)
    > [ Upstream commit 3661c05c54e8db7064aa96a0774654740974dffc ]
    > If we go through the PCI shutdown or suspend path, we shutdown the
    > NIC but PTP remains registered.  If the kernel continues to run for
    > a little bit, the periodic PTP .do_aux_work() function may be called
    > and it will read the PHC from the BAR register.  Since the device
    > has already been disabled, it will cause a PCIe completion timeout.
    > Fix it by calling bnxt_ptp_clear() in the PCI shutdown/suspend
    > handlers.  bnxt_ptp_clear() will unregister from PTP and
    > .do_aux_work() will be canceled.
    > In bnxt_resume(), we need to re-initialize PTP.
    > Fixes: a521c8a01d26 (&quot;bnxt_en: Move bnxt_ptp_init() from bnxt_open() back to bnxt_init_one()&quot;)
    > Cc: Richard Cochran &lt;richardcochran@gmail.com&gt;
    > Reviewed-by: Somnath Kotur &lt;somnath.kotur@broadcom.com&gt;
    > Reviewed-by: Pavan Chebbi &lt;pavan.chebbi@broadcom.com&gt;
    > Reviewed-by: Kalesh AP &lt;kalesh-anakkur.purayil@broadcom.com&gt;
    > Signed-off-by: Michael Chan &lt;michael.chan@broadcom.com&gt;
    > Signed-off-by: Paolo Abeni &lt;pabeni@redhat.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ bnxt_en: Refactor bnxt_ptp_init() (@Michael Chan in [2ef2038f2668dd1](https://github.com/sophgo/linux-riscv/commit/2ef2038f2668dd1) at 2024-12-05 13:02:34)
    > [ Upstream commit 1e9614cd956268e10a669c0593e7e54d03d0c087 ]
    > Instead of passing the 2nd parameter phc_cfg to bnxt_ptp_init().
    > Store it in bp-&gt;ptp_cfg so that the caller doesn&#x27;t need to know what
    > the value should be.
    > In the next patch, we&#x27;ll need to call bnxt_ptp_init() in bnxt_resume()
    > and this will make it easier.
    > Reviewed-by: Somnath Kotur &lt;somnath.kotur@broadcom.com&gt;
    > Reviewed-by: Pavan Chebbi &lt;pavan.chebbi@broadcom.com&gt;
    > Reviewed-by: Kalesh AP &lt;kalesh-anakkur.purayil@broadcom.com&gt;
    > Signed-off-by: Michael Chan &lt;michael.chan@broadcom.com&gt;
    > Signed-off-by: Paolo Abeni &lt;pabeni@redhat.com&gt;
    > Stable-dep-of: 3661c05c54e8 (&quot;bnxt_en: Unregister PTP during PCI shutdown and suspend&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ bnxt_en: Fix queue start to update vnic RSS table (@Somnath Kotur in [099a39ec5f10205](https://github.com/sophgo/linux-riscv/commit/099a39ec5f10205) at 2024-12-05 13:02:34)
    > [ Upstream commit 5ac066b7b062ee753a14557ea11bdc62364c8090 ]
    > HWRM_RING_FREE followed by a HWRM_RING_ALLOC is not guaranteed to
    > have the same FW ring ID as before.  So we must reinitialize the
    > RSS table with the correct ring IDs.  Otherwise, traffic may not
    > resume properly if the restarted ring ID is stale.  Since this
    > feature is only supported on P5_PLUS chips, we call
    > bnxt_vnic_set_rss_p5() to update the HW RSS table.
    > Fixes: 2d694c27d32e (&quot;bnxt_en: implement netdev_queue_mgmt_ops&quot;)
    > Cc: David Wei &lt;dw@davidwei.uk&gt;
    > Reviewed-by: Kalesh AP &lt;kalesh-anakkur.purayil@broadcom.com&gt;
    > Reviewed-by: Andy Gospodarek &lt;andrew.gospodarek@broadcom.com&gt;
    > Signed-off-by: Somnath Kotur &lt;somnath.kotur@broadcom.com&gt;
    > Signed-off-by: Michael Chan &lt;michael.chan@broadcom.com&gt;
    > Signed-off-by: Paolo Abeni &lt;pabeni@redhat.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ octeontx2-af: RPM: fix stale RSFEC counters (@Hariprasad Kelam in [5132e401521b93c](https://github.com/sophgo/linux-riscv/commit/5132e401521b93c) at 2024-12-05 13:02:33)
    > [ Upstream commit 07cd1eb166a3fa7244afa74d48bd13c9df7c559d ]
    > The earlier patch sets the &#x27;Stats control register&#x27; for RPM
    > receive/transmit statistics instead of RSFEC statistics,
    > causing the driver to return stale FEC counters.
    > Fixes: 84ad3642115d (&quot;octeontx2-af: Add FEC stats for RPM/RPM_USX block&quot;)
    > Signed-off-by: Hariprasad Kelam &lt;hkelam@marvell.com&gt;
    > Signed-off-by: Paolo Abeni &lt;pabeni@redhat.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ net: hsr: fix hsr_init_sk() vs network/transport headers. (@Eric Dumazet in [50aa2502d42928a](https://github.com/sophgo/linux-riscv/commit/50aa2502d42928a) at 2024-12-05 13:02:33)
    > [ Upstream commit 9cfb5e7f0ded2bfaabc270ceb5f91d13f0e805b9 ]
    > Following sequence in hsr_init_sk() is invalid :
    > skb_reset_mac_header(skb);
    > skb_reset_mac_len(skb);
    > skb_reset_network_header(skb);
    > skb_reset_transport_header(skb);
    > It is invalid because skb_reset_mac_len() needs the correct
    > network header, which should be after the mac header.
    > This patch moves the skb_reset_network_header()
    > and skb_reset_transport_header() before
    > the call to dev_hard_header().
    > As a result skb-&gt;mac_len is no longer set to a value
    > close to 65535.
    > Fixes: 48b491a5cc74 (&quot;net: hsr: fix mac_len checks&quot;)
    > Signed-off-by: Eric Dumazet &lt;edumazet@google.com&gt;
    > Cc: George McCollister &lt;george.mccollister@gmail.com&gt;
    > Link: https://patch.msgid.link/20241122171343.897551-1-edumazet@google.com
    > Signed-off-by: Paolo Abeni &lt;pabeni@redhat.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ octeontx2-af: Quiesce traffic before NIX block reset (@Hariprasad Kelam in [25a1f2947482cfa](https://github.com/sophgo/linux-riscv/commit/25a1f2947482cfa) at 2024-12-05 13:02:33)
    > [ Upstream commit 762ca6eed026346d9d41ed5ac633083c4f1e5071 ]
    > During initialization, the AF driver resets all blocks. The RPM (MAC)
    > block and NIX block operate on a credit-based model. When the NIX block
    > resets during active traffic flow, it doesn&#x27;t release credits to the RPM
    > block. This causes the RPM FIFO to overflow, leading to receive traffic
    > struck.
    > To address this issue, the patch introduces the following changes:
    > 1. Stop receiving traffic at the MAC level during AF driver
    > initialization.
    > 2. Perform an X2P reset (prevents RXFIFO of all LMACS from pushing data)
    > 3. Reset the NIX block.
    > 4. Clear the X2P reset and re-enable receiving traffic.
    > Fixes: 54d557815e15 (&quot;octeontx2-af: Reset all RVU blocks&quot;)
    > Signed-off-by: Hariprasad Kelam &lt;hkelam@marvell.com&gt;
    > Signed-off-by: Paolo Abeni &lt;pabeni@redhat.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ octeontx2-af: RPM: fix stale FCFEC counters (@Hariprasad Kelam in [18f712ec7e7d6ef](https://github.com/sophgo/linux-riscv/commit/18f712ec7e7d6ef) at 2024-12-05 13:02:33)
    > [ Upstream commit 6fc2164108462b913a1290fa2c44054c70b060ef ]
    > The corrected words register(FCFECX_VL0_CCW_LO)/Uncorrected words
    > register (FCFECX_VL0_NCCW_LO) of FCFEC counter has different LMAC
    > offset which needs to be accessed differently.
    > Fixes: 84ad3642115d (&quot;octeontx2-af: Add FEC stats for RPM/RPM_USX block&quot;)
    > Signed-off-by: Hariprasad Kelam &lt;hkelam@marvell.com&gt;
    > Signed-off-by: Paolo Abeni &lt;pabeni@redhat.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ spi: atmel-quadspi: Fix register name in verbose logging function (@Csókás, Bence in [18dcd8a978d1532](https://github.com/sophgo/linux-riscv/commit/18dcd8a978d1532) at 2024-12-05 13:02:33)
    > [ Upstream commit 2ac40e6d0ccdd93031f8b1af61b0fe5cdd704923 ]
    > &#x60;atmel_qspi_reg_name()&#x60; is used for pretty-printing register offsets
    > for verbose logging of register accesses. However, due to a typo
    > (likely a copy-paste error), QSPI_RD&#x27;s offset prints as &quot;MR&quot;, the
    > name of the previous register. Fix this typo.
    > Fixes: c528ecfbef04 (&quot;spi: atmel-quadspi: Add verbose debug facilities to monitor register accesses&quot;)
    > Signed-off-by: Csókás, Bence &lt;csokas.bence@prolan.hu&gt;
    > Reviewed-by: Alexander Dahl &lt;ada@thorsis.com&gt;
    > Link: https://patch.msgid.link/20241122141302.2599636-1-csokas.bence@prolan.hu
    > Signed-off-by: Mark Brown &lt;broonie@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ octeontx2-af: RPM: Fix low network performance (@Hariprasad Kelam in [0309a0aabed7093](https://github.com/sophgo/linux-riscv/commit/0309a0aabed7093) at 2024-12-05 13:02:33)
    > [ Upstream commit d1e8884e050c1255a9ceb477f5ff926ee9214a23 ]
    > Low network performance is observed even on RPMs with larger
    > FIFO lengths.
    > The cn10kb silicon has three RPM blocks with the following
    > FIFO sizes:
    > --------------------
    > | RPM0  |   256KB  |
    > | RPM1  |   256KB  |
    > | RPM2  |   128KB  |
    > --------------------
    > The current design stores the FIFO length in a common structure for all
    > RPMs (mac_ops). As a result, the FIFO length of the last RPM is applied
    > to all RPMs, leading to reduced network performance.
    > This patch resolved the problem by storing the fifo length in per MAC
    > structure (cgx).
    > Fixes: b9d0fedc6234 (&quot;octeontx2-af: cn10kb: Add RPM_USX MAC support&quot;)
    > Signed-off-by: Hariprasad Kelam &lt;hkelam@marvell.com&gt;
    > Signed-off-by: Paolo Abeni &lt;pabeni@redhat.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ net: mdio-ipq4019: add missing error check (@Rosen Penev in [dac8e870472e445](https://github.com/sophgo/linux-riscv/commit/dac8e870472e445) at 2024-12-05 13:02:32)
    > [ Upstream commit 9cc8d0ecdd2aad42e377e971e3bb114339df609e ]
    > If an optional resource is found but fails to remap, return on failure.
    > Avoids any potential problems when using the iomapped resource as the
    > assumption is that it&#x27;s available.
    > Fixes: 23a890d493e3 (&quot;net: mdio: Add the reset function for IPQ MDIO driver&quot;)
    > Signed-off-by: Rosen Penev &lt;rosenp@gmail.com&gt;
    > Reviewed-by: Andrew Lunn &lt;andrew@lunn.ch&gt;
    > Link: https://patch.msgid.link/20241121193152.8966-1-rosenp@gmail.com
    > Signed-off-by: Paolo Abeni &lt;pabeni@redhat.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ net/ipv6: delete temporary address if mngtmpaddr is removed or unmanaged (@Hangbin Liu in [cb74207ef98317f](https://github.com/sophgo/linux-riscv/commit/cb74207ef98317f) at 2024-12-05 13:02:32)
    > [ Upstream commit 00b5b7aab9e422d00d5a9d03d7e0760a76b5d57f ]
    > RFC8981 section 3.4 says that existing temporary addresses must have their
    > lifetimes adjusted so that no temporary addresses should ever remain &quot;valid&quot;
    > or &quot;preferred&quot; longer than the incoming SLAAC Prefix Information. This would
    > strongly imply in Linux&#x27;s case that if the &quot;mngtmpaddr&quot; address is deleted or
    > un-flagged as such, its corresponding temporary addresses must be cleared out
    > right away.
    > But now the temporary address is renewed even after ‘mngtmpaddr’ is removed
    > or becomes unmanaged as manage_tempaddrs() set temporary addresses
    > prefered/valid time to 0, and later in addrconf_verify_rtnl() all checkings
    > failed to remove the addresses. Fix this by deleting the temporary address
    > directly for these situations.
    > Fixes: 778964f2fdf0 (&quot;ipv6/addrconf: fix timing bug in tempaddr regen&quot;)
    > Signed-off-by: Hangbin Liu &lt;liuhangbin@gmail.com&gt;
    > Reviewed-by: David Ahern &lt;dsahern@kernel.org&gt;
    > Signed-off-by: Paolo Abeni &lt;pabeni@redhat.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ rtase: Corrects error handling of the rtase_check_mac_version_valid() (@Justin Lai in [ac774812a9625c8](https://github.com/sophgo/linux-riscv/commit/ac774812a9625c8) at 2024-12-05 13:02:32)
    > [ Upstream commit a01cfcfda5cc787552b344cbc92f9c363c81ad4f ]
    > Previously, when the hardware version ID was determined to be invalid,
    > only an error message was printed without any further handling. Therefore,
    > this patch makes the necessary corrections to address this.
    > Fixes: a36e9f5cfe9e (&quot;rtase: Add support for a pci table in this module&quot;)
    > Signed-off-by: Justin Lai &lt;justinlai0215@realtek.com&gt;
    > Signed-off-by: Paolo Abeni &lt;pabeni@redhat.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ rtase: Correct the speed for RTL907XD-V1 (@Justin Lai in [a0e3a09bcc36954](https://github.com/sophgo/linux-riscv/commit/a0e3a09bcc36954) at 2024-12-05 13:02:32)
    > [ Upstream commit c1fc14c4df801fe2d9ec3160b52fa63569ce164c ]
    > Previously, the reported speed was uniformly set to SPEED_5000, but the
    > RTL907XD-V1 actually operates at a speed of SPEED_10000. Therefore, this
    > patch makes the necessary correction.
    > Fixes: dd7f17c40fd1 (&quot;rtase: Implement ethtool function&quot;)
    > Signed-off-by: Justin Lai &lt;justinlai0215@realtek.com&gt;
    > Signed-off-by: Paolo Abeni &lt;pabeni@redhat.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ net: stmmac: dwmac-socfpga: Set RX watchdog interrupt as broken (@Maxime Chevallier in [9fc97e6d5984c64](https://github.com/sophgo/linux-riscv/commit/9fc97e6d5984c64) at 2024-12-05 13:02:32)
    > [ Upstream commit 407618d66dba55e7db1278872e8be106808bbe91 ]
    > On DWMAC3 and later, there&#x27;s a RX Watchdog interrupt that&#x27;s used for
    > interrupt coalescing. It&#x27;s known to be buggy on some platforms, and
    > dwmac-socfpga appears to be one of them. Changing the interrupt
    > coalescing from ethtool doesn&#x27;t appear to have any effect here.
    > Without disabling RIWT (Received Interrupt Watchdog Timer, I
    > believe...), we observe latencies while receiving traffic that amount to
    > around ~0.4ms. This was discovered with NTP but can be easily reproduced
    > with a simple ping. Without this patch :
    > 64 bytes from 192.168.5.2: icmp_seq&#x3D;1 ttl&#x3D;64 time&#x3D;0.657 ms
    > With this patch :
    > 64 bytes from 192.168.5.2: icmp_seq&#x3D;1 ttl&#x3D;64 time&#x3D;0.254 ms
    > Fixes: 801d233b7302 (&quot;net: stmmac: Add SOCFPGA glue driver&quot;)
    > Signed-off-by: Maxime Chevallier &lt;maxime.chevallier@bootlin.com&gt;
    > Link: https://patch.msgid.link/20241122141256.764578-1-maxime.chevallier@bootlin.com
    > Signed-off-by: Paolo Abeni &lt;pabeni@redhat.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ octeontx2-af: RPM: Fix mismatch in lmac type (@Hariprasad Kelam in [8d8ae9cc97e738a](https://github.com/sophgo/linux-riscv/commit/8d8ae9cc97e738a) at 2024-12-05 13:02:32)
    > [ Upstream commit 7ebbbb23ea5b6d051509cb11399afac5042c9266 ]
    > Due to a bug in the previous patch, there is a mismatch
    > between the lmac type reported by the driver and the actual
    > hardware configuration.
    > Fixes: 3ad3f8f93c81 (&quot;octeontx2-af: cn10k: MAC internal loopback support&quot;)
    > Signed-off-by: Hariprasad Kelam &lt;hkelam@marvell.com&gt;
    > Signed-off-by: Paolo Abeni &lt;pabeni@redhat.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ marvell: pxa168_eth: fix call balance of pep-&gt;clk handling routines (@Vitalii Mordan in [749ecbb2f0776c7](https://github.com/sophgo/linux-riscv/commit/749ecbb2f0776c7) at 2024-12-05 13:02:32)
    > [ Upstream commit b032ae57d4fe2b2445e3bc190db6fcaa8c102f68 ]
    > If the clock pep-&gt;clk was not enabled in pxa168_eth_probe,
    > it should not be disabled in any path.
    > Conversely, if it was enabled in pxa168_eth_probe, it must be disabled
    > in all error paths to ensure proper cleanup.
    > Use the devm_clk_get_enabled helper function to ensure proper call balance
    > for pep-&gt;clk.
    > Found by Linux Verification Center (linuxtesting.org) with Klever.
    > Fixes: a49f37eed22b (&quot;net: add Fast Ethernet driver for PXA168.&quot;)
    > Signed-off-by: Vitalii Mordan &lt;mordan@ispras.ru&gt;
    > Link: https://patch.msgid.link/20241121200658.2203871-1-mordan@ispras.ru
    > Signed-off-by: Paolo Abeni &lt;pabeni@redhat.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ rtase: Refactor the rtase_check_mac_version_valid() function (@Justin Lai in [b55b245e46f6c85](https://github.com/sophgo/linux-riscv/commit/b55b245e46f6c85) at 2024-12-05 13:02:31)
    > [ Upstream commit a1f8609ff1f658e410f78d800ca947d57e51996a ]
    > Different hardware requires different configurations, but this distinction
    > was not made previously. Additionally, the error message was not clear
    > enough. Therefore, this patch will address the issues mentioned above.
    > Fixes: a36e9f5cfe9e (&quot;rtase: Add support for a pci table in this module&quot;)
    > Signed-off-by: Justin Lai &lt;justinlai0215@realtek.com&gt;
    > Signed-off-by: Paolo Abeni &lt;pabeni@redhat.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ exfat: fix file being changed by unaligned direct write (@Yuezhang Mo in [ad6e5bdca39bc35](https://github.com/sophgo/linux-riscv/commit/ad6e5bdca39bc35) at 2024-12-05 13:02:31)
    > [ Upstream commit 2e94e5bb94a3e641a25716a560bf474225fda83c ]
    > Unaligned direct writes are invalid and should return an error
    > without making any changes, rather than extending -&gt;valid_size
    > and then returning an error. Therefore, alignment checking is
    > required before extending -&gt;valid_size.
    > Fixes: 11a347fb6cef (&quot;exfat: change to get file size from DataLength&quot;)
    > Signed-off-by: Yuezhang Mo &lt;Yuezhang.Mo@sony.com&gt;
    > Co-developed-by: Namjae Jeon &lt;linkinjeon@kernel.org&gt;
    > Signed-off-by: Namjae Jeon &lt;linkinjeon@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ net/l2tp: fix warning in l2tp_exit_net found by syzbot (@James Chapman in [a487cc8986d6dd7](https://github.com/sophgo/linux-riscv/commit/a487cc8986d6dd7) at 2024-12-05 13:02:31)
    > [ Upstream commit 5d066766c5f1252f98ff859265bcd1a5b52ac46c ]
    > In l2tp&#x27;s net exit handler, we check that an IDR is empty before
    > destroying it:
    > WARN_ON_ONCE(!idr_is_empty(&amp;pn-&gt;l2tp_tunnel_idr));
    > idr_destroy(&amp;pn-&gt;l2tp_tunnel_idr);
    > By forcing memory allocation failures in idr_alloc_32, syzbot is able
    > to provoke a condition where idr_is_empty returns false despite there
    > being no items in the IDR. This turns out to be because the radix tree
    > of the IDR contains only internal radix-tree nodes and it is this that
    > causes idr_is_empty to return false. The internal nodes are cleaned by
    > idr_destroy.
    > Use idr_for_each to check that the IDR is empty instead of
    > idr_is_empty to avoid the problem.
    > Reported-by: syzbot+332fe1e67018625f63c9@syzkaller.appspotmail.com
    > Closes: https://syzkaller.appspot.com/bug?extid&#x3D;332fe1e67018625f63c9
    > Fixes: 73d33bd063c4 (&quot;l2tp: avoid using drain_workqueue in l2tp_pre_exit_net&quot;)
    > Signed-off-by: James Chapman &lt;jchapman@katalix.com&gt;
    > Link: https://patch.msgid.link/20241118140411.1582555-1-jchapman@katalix.com
    > Signed-off-by: Paolo Abeni &lt;pabeni@redhat.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ s390/iucv: MSG_PEEK causes memory leak in iucv_sock_destruct() (@Sidraya Jayagond in [9f603e66e1c59c1](https://github.com/sophgo/linux-riscv/commit/9f603e66e1c59c1) at 2024-12-05 13:02:31)
    > [ Upstream commit ebaf81317e42aa990ad20b113cfe3a7b20d4e937 ]
    > Passing MSG_PEEK flag to skb_recv_datagram() increments skb refcount
    > (skb-&gt;users) and iucv_sock_recvmsg() does not decrement skb refcount
    > at exit.
    > This results in skb memory leak in skb_queue_purge() and WARN_ON in
    > iucv_sock_destruct() during socket close. To fix this decrease
    > skb refcount by one if MSG_PEEK is set in order to prevent memory
    > leak and WARN_ON.
    > WARNING: CPU: 2 PID: 6292 at net/iucv/af_iucv.c:286 iucv_sock_destruct+0x144/0x1a0 [af_iucv]
    > CPU: 2 PID: 6292 Comm: afiucv_test_msg Kdump: loaded Tainted: G        W          6.10.0-rc7 #1
    > Hardware name: IBM 3931 A01 704 (z/VM 7.3.0)
    > Call Trace:
    > [&lt;001587c682c4aa98&gt;] iucv_sock_destruct+0x148/0x1a0 [af_iucv]
    > [&lt;001587c682c4a9d0&gt;] iucv_sock_destruct+0x80/0x1a0 [af_iucv]
    > [&lt;001587c704117a32&gt;] __sk_destruct+0x52/0x550
    > [&lt;001587c704104a54&gt;] __sock_release+0xa4/0x230
    > [&lt;001587c704104c0c&gt;] sock_close+0x2c/0x40
    > [&lt;001587c702c5f5a8&gt;] __fput+0x2e8/0x970
    > [&lt;001587c7024148c4&gt;] task_work_run+0x1c4/0x2c0
    > [&lt;001587c7023b0716&gt;] do_exit+0x996/0x1050
    > [&lt;001587c7023b13aa&gt;] do_group_exit+0x13a/0x360
    > [&lt;001587c7023b1626&gt;] __s390x_sys_exit_group+0x56/0x60
    > [&lt;001587c7022bccca&gt;] do_syscall+0x27a/0x380
    > [&lt;001587c7049a6a0c&gt;] __do_syscall+0x9c/0x160
    > [&lt;001587c7049ce8a8&gt;] system_call+0x70/0x98
    > Last Breaking-Event-Address:
    > [&lt;001587c682c4a9d4&gt;] iucv_sock_destruct+0x84/0x1a0 [af_iucv]
    > Fixes: eac3731bd04c (&quot;[S390]: Add AF_IUCV socket support&quot;)
    > Reviewed-by: Alexandra Winter &lt;wintera@linux.ibm.com&gt;
    > Reviewed-by: Thorsten Winkler &lt;twinkler@linux.ibm.com&gt;
    > Signed-off-by: Sidraya Jayagond &lt;sidraya@linux.ibm.com&gt;
    > Signed-off-by: Alexandra Winter &lt;wintera@linux.ibm.com&gt;
    > Reviewed-by: David Wei &lt;dw@davidwei.uk&gt;
    > Link: https://patch.msgid.link/20241119152219.3712168-1-wintera@linux.ibm.com
    > Signed-off-by: Paolo Abeni &lt;pabeni@redhat.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ net: usb: lan78xx: Fix refcounting and autosuspend on invalid WoL configuration (@Oleksij Rempel in [9ca72f4247e3cd5](https://github.com/sophgo/linux-riscv/commit/9ca72f4247e3cd5) at 2024-12-05 13:02:31)
    > [ Upstream commit e863ff806f72098bccaf8fa89c80d9ad6187c3b0 ]
    > Validate Wake-on-LAN (WoL) options in &#x60;lan78xx_set_wol&#x60; before calling
    > &#x60;usb_autopm_get_interface&#x60;. This prevents USB autopm refcounting issues
    > and ensures the adapter can properly enter autosuspend when invalid WoL
    > options are provided.
    > Fixes: eb9ad088f966 (&quot;lan78xx: Check for supported Wake-on-LAN modes&quot;)
    > Signed-off-by: Oleksij Rempel &lt;o.rempel@pengutronix.de&gt;
    > Acked-by: Florian Fainelli &lt;f.fainelli@gmail.com&gt;
    > Link: https://patch.msgid.link/20241118140351.2398166-1-o.rempel@pengutronix.de
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ net: microchip: vcap: Add typegroup table terminators in kunit tests (@Guenter Roeck in [36d3af0fab42a4c](https://github.com/sophgo/linux-riscv/commit/36d3af0fab42a4c) at 2024-12-05 13:02:31)
    > [ Upstream commit f164b296638d1eb1fb1c537e93ab5c8b49966546 ]
    > VCAP API unit tests fail randomly with errors such as
    > # vcap_api_iterator_init_test: EXPECTATION FAILED at drivers/net/ethernet/microchip/vcap/vcap_api_kunit.c:387
    > Expected 134 + 7 &#x3D;&#x3D; iter.offset, but
    > 134 + 7 &#x3D;&#x3D; 141 (0x8d)
    > iter.offset &#x3D;&#x3D; 17214 (0x433e)
    > # vcap_api_iterator_init_test: EXPECTATION FAILED at drivers/net/ethernet/microchip/vcap/vcap_api_kunit.c:388
    > Expected 5 &#x3D;&#x3D; iter.reg_idx, but
    > iter.reg_idx &#x3D;&#x3D; 702 (0x2be)
    > # vcap_api_iterator_init_test: EXPECTATION FAILED at drivers/net/ethernet/microchip/vcap/vcap_api_kunit.c:389
    > Expected 11 &#x3D;&#x3D; iter.reg_bitpos, but
    > iter.reg_bitpos &#x3D;&#x3D; 15 (0xf)
    > # vcap_api_iterator_init_test: pass:0 fail:1 skip:0 total:1
    > Comments in the code state that &quot;A typegroup table ends with an all-zero
    > terminator&quot;. Add the missing terminators.
    > Some of the typegroups did have a terminator of &quot;.offset &#x3D; 0, .width &#x3D; 0,
    > .value &#x3D; 0,&quot;. Replace those terminators with &quot;{ }&quot; (no trailing &#x27;,&#x27;) for
    > consistency and to excplicitly state &quot;this is a terminator&quot;.
    > Fixes: 67d637516fa9 (&quot;net: microchip: sparx5: Adding KUNIT test for the VCAP API&quot;)
    > Cc: Steen Hegelund &lt;steen.hegelund@microchip.com&gt;
    > Signed-off-by: Guenter Roeck &lt;linux@roeck-us.net&gt;
    > Reviewed-by: Daniel Machon &lt;daniel.machon@microchip.com&gt;
    > Reviewed-by: Jacob Keller &lt;jacob.e.keller@intel.com&gt;
    > Link: https://patch.msgid.link/20241119213202.2884639-1-linux@roeck-us.net
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ netlink: fix false positive warning in extack during dumps (@Jakub Kicinski in [28af028a71371df](https://github.com/sophgo/linux-riscv/commit/28af028a71371df) at 2024-12-05 13:02:31)
    > [ Upstream commit 3bf39fa849ab8ed52abb6715922e6102d3df9f97 ]
    > Commit under fixes extended extack reporting to dumps.
    > It works under normal conditions, because extack errors are
    > usually reported during -&gt;start() or the first -&gt;dump(),
    > it&#x27;s quite rare that the dump starts okay but fails later.
    > If the dump does fail later, however, the input skb will
    > already have the initiating message pulled, so checking
    > if bad attr falls within skb-&gt;data will fail.
    > Switch the check to using nlh, which is always valid.
    > syzbot found a way to hit that scenario by filling up
    > the receive queue. In this case we initiate a dump
    > but don&#x27;t call -&gt;dump() until there is read space for
    > an skb.
    > WARNING: CPU: 1 PID: 5845 at net/netlink/af_netlink.c:2210 netlink_ack_tlv_fill+0x1a8/0x560 net/netlink/af_netlink.c:2209
    > RIP: 0010:netlink_ack_tlv_fill+0x1a8/0x560 net/netlink/af_netlink.c:2209
    > Call Trace:
    > &lt;TASK&gt;
    > netlink_dump_done+0x513/0x970 net/netlink/af_netlink.c:2250
    > netlink_dump+0x91f/0xe10 net/netlink/af_netlink.c:2351
    > netlink_recvmsg+0x6bb/0x11d0 net/netlink/af_netlink.c:1983
    > sock_recvmsg_nosec net/socket.c:1051 [inline]
    > sock_recvmsg+0x22f/0x280 net/socket.c:1073
    > __sys_recvfrom+0x246/0x3d0 net/socket.c:2267
    > __do_sys_recvfrom net/socket.c:2285 [inline]
    > __se_sys_recvfrom net/socket.c:2281 [inline]
    > __x64_sys_recvfrom+0xde/0x100 net/socket.c:2281
    > do_syscall_x64 arch/x86/entry/common.c:52 [inline]
    > do_syscall_64+0xf3/0x230 arch/x86/entry/common.c:83
    > entry_SYSCALL_64_after_hwframe+0x77/0x7f
    > RIP: 0033:0x7ff37dd17a79
    > Reported-by: syzbot+d4373fa8042c06cefa84@syzkaller.appspotmail.com
    > Fixes: 8af4f60472fc (&quot;netlink: support all extack types in dumps&quot;)
    > Reviewed-by: Jacob Keller &lt;jacob.e.keller@intel.com&gt;
    > Link: https://patch.msgid.link/20241119224432.1713040-1-kuba@kernel.org
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ fs/ntfs3: Equivalent transition from page to folio (@Konstantin Komarov in [e38ac7fbd5bcc64](https://github.com/sophgo/linux-riscv/commit/e38ac7fbd5bcc64) at 2024-12-05 13:02:30)
    > [ Upstream commit 045fff619312fb013540c80cff18aab3c33048ab ]
    > If using the proposed function folio_zero_range(), should one switch
    > from &#x27;start + end&#x27; to &#x27;start + length,&#x27; or use folio_zero_segment()
    > Fixes: 1da86618bdce (&quot;fs: Convert aops-&gt;write_begin to take a folio&quot;)
    > Signed-off-by: Konstantin Komarov &lt;almaz.alexandrovich@paragon-software.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ tg3: Set coherent DMA mask bits to 31 for BCM57766 chipsets (@Pavan Chebbi in [aadf3e1e6b7372e](https://github.com/sophgo/linux-riscv/commit/aadf3e1e6b7372e) at 2024-12-05 13:02:30)
    > [ Upstream commit 614f4d166eeeb9bd709b0ad29552f691c0f45776 ]
    > The hardware on Broadcom 1G chipsets have a known limitation
    > where they cannot handle DMA addresses that cross over 4GB.
    > When such an address is encountered, the hardware sets the
    > address overflow error bit in the DMA status register and
    > triggers a reset.
    > However, BCM57766 hardware is setting the overflow bit and
    > triggering a reset in some cases when there is no actual
    > underlying address overflow. The hardware team analyzed the
    > issue and concluded that it is happening when the status
    > block update has an address with higher (b16 to b31) bits
    > as 0xffff following a previous update that had lowest bits
    > as 0xffff.
    > To work around this bug in the BCM57766 hardware, set the
    > coherent dma mask from the current 64b to 31b. This will
    > ensure that upper bits of the status block DMA address are
    > always at most 0x7fff, thus avoiding the improper overflow
    > check described above. This work around is intended for only
    > status block and ring memories and has no effect on TX and
    > RX buffers as they do not require coherent memory.
    > Fixes: 72f2afb8a685 (&quot;[TG3]: Add DMA address workaround&quot;)
    > Reported-by: Salam Noureddine &lt;noureddine@arista.com&gt;
    > Reviewed-by: Kalesh AP &lt;kalesh-anakkur.purayil@broadcom.com&gt;
    > Reviewed-by: Somnath Kotur &lt;somnath.kotur@broadcom.com&gt;
    > Signed-off-by: Pavan Chebbi &lt;pavan.chebbi@broadcom.com&gt;
    > Reviewed-by: Michal Kubiak &lt;michal.kubiak@intel.com&gt;
    > Link: https://patch.msgid.link/20241119055741.147144-1-pavan.chebbi@broadcom.com
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ power: reset: ep93xx: add AUXILIARY_BUS dependency (@Arnd Bergmann in [7c29aa9487d499d](https://github.com/sophgo/linux-riscv/commit/7c29aa9487d499d) at 2024-12-05 13:02:30)
    > [ Upstream commit b6d445f6724deda3fd87fa33358009d947a64c5d ]
    > This fails to link when compile-testing and the auxiliary bus is not built-in:
    > x86_64-linux-ld: drivers/power/reset/ep93xx-restart.o: in function &#x60;ep93xx_reboot_driver_init&#x27;:
    > ep93xx-restart.c:(.init.text+0x11): undefined reference to &#x60;__auxiliary_driver_register&#x27;
    > x86_64-linux-ld: drivers/power/reset/ep93xx-restart.o: in function &#x60;ep93xx_reboot_driver_exit&#x27;:
    > ep93xx-restart.c:(.exit.text+0x8): undefined reference to &#x60;auxiliary_driver_unregister&#x27;
    > Add the appropriate dependency.
    > Fixes: 9fa7cdb4368f (&quot;power: reset: Add a driver for the ep93xx reset&quot;)
    > Signed-off-by: Arnd Bergmann &lt;arnd@arndb.de&gt;
    > Link: https://lore.kernel.org/r/20241111104418.3891756-1-arnd@kernel.org
    > Signed-off-by: Sebastian Reichel &lt;sebastian.reichel@collabora.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ net: usb: lan78xx: Fix double free issue with interrupt buffer allocation (@Oleksij Rempel in [7ac9f3c981eecee](https://github.com/sophgo/linux-riscv/commit/7ac9f3c981eecee) at 2024-12-05 13:02:30)
    > [ Upstream commit 03819abbeb11117dcbba40bfe322b88c0c88a6b6 ]
    > In lan78xx_probe(), the buffer &#x60;buf&#x60; was being freed twice: once
    > implicitly through &#x60;usb_free_urb(dev-&gt;urb_intr)&#x60; with the
    > &#x60;URB_FREE_BUFFER&#x60; flag and again explicitly by &#x60;kfree(buf)&#x60;. This caused
    > a double free issue.
    > To resolve this, reordered &#x60;kmalloc()&#x60; and &#x60;usb_alloc_urb()&#x60; calls to
    > simplify the initialization sequence and removed the redundant
    > &#x60;kfree(buf)&#x60;.  Now, &#x60;buf&#x60; is allocated after &#x60;usb_alloc_urb()&#x60;, ensuring
    > it is correctly managed by  &#x60;usb_fill_int_urb()&#x60; and freed by
    > &#x60;usb_free_urb()&#x60; as intended.
    > Fixes: a6df95cae40b (&quot;lan78xx: Fix memory allocation bug&quot;)
    > Cc: John Efstathiades &lt;john.efstathiades@pebblebay.com&gt;
    > Signed-off-by: Oleksij Rempel &lt;o.rempel@pengutronix.de&gt;
    > Link: https://patch.msgid.link/20241116130558.1352230-1-o.rempel@pengutronix.de
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ net: usb: lan78xx: Fix memory leak on device unplug by freeing PHY device (@Oleksij Rempel in [77f02199e86e855](https://github.com/sophgo/linux-riscv/commit/77f02199e86e855) at 2024-12-05 13:02:30)
    > [ Upstream commit ae7370e61c5d8f5bcefc2d4fca724bd4e9bbf789 ]
    > Add calls to &#x60;phy_device_free&#x60; after &#x60;fixed_phy_unregister&#x60; to fix a
    > memory leak that occurs when the device is unplugged. This ensures
    > proper cleanup of pseudo fixed-link PHYs.
    > Fixes: 89b36fb5e532 (&quot;lan78xx: Lan7801 Support for Fixed PHY&quot;)
    > Cc: Raghuram Chary J &lt;raghuramchary.jallipalli@microchip.com&gt;
    > Signed-off-by: Oleksij Rempel &lt;o.rempel@pengutronix.de&gt;
    > Link: https://patch.msgid.link/20241116130558.1352230-2-o.rempel@pengutronix.de
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ power: supply: rt9471: Use IC status regfield to report real charger status (@ChiYuan Huang in [709565eaca55f28](https://github.com/sophgo/linux-riscv/commit/709565eaca55f28) at 2024-12-05 13:02:30)
    > [ Upstream commit c46a9ee5c6210682611d3d4276436c23a95e1996 ]
    > Use IC status regfield to rewrite the &#x27;get_staus&#x27; function. The original
    > one cannot cover some special scenario like as charger OTG or JEITA case.
    > Fixes: 4a1a5f6781d8 (&quot;power: supply: rt9471: Add Richtek RT9471 charger driver&quot;)
    > Reported-by: Lucas Tsai &lt;lucas_tsai@richtek.com&gt;
    > Signed-off-by: ChiYuan Huang &lt;cy_huang@richtek.com&gt;
    > Link: https://lore.kernel.org/r/67ba92bb4a9c51d9cafadab30b788a3a2c3048e1.1727252762.git.cy_huang@richtek.com
    > Signed-off-by: Sebastian Reichel &lt;sebastian.reichel@collabora.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ power: supply: rt9471: Fix wrong WDT function regfield declaration (@ChiYuan Huang in [29313f25bb6b465](https://github.com/sophgo/linux-riscv/commit/29313f25bb6b465) at 2024-12-05 13:02:30)
    > [ Upstream commit d10ff07dd2b933e3864c592ca932996b07bbf22a ]
    > Fix F_WDT and F_WDT_RST wrong regfield declaration.
    > Fixes: 4a1a5f6781d8 (&quot;power: supply: rt9471: Add Richtek RT9471 charger driver&quot;)
    > Reported-by: Lucas Tsai &lt;lucas_tsai@richtek.com&gt;
    > Signed-off-by: ChiYuan Huang &lt;cy_huang@richtek.com&gt;
    > Link: https://lore.kernel.org/r/f862e23f220612f01fabb6d8e76cfaf63756c22b.1727252762.git.cy_huang@richtek.com
    > Signed-off-by: Sebastian Reichel &lt;sebastian.reichel@collabora.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ power: supply: core: Remove might_sleep() from power_supply_put() (@Bart Van Assche in [f7f7f22dbb82133](https://github.com/sophgo/linux-riscv/commit/f7f7f22dbb82133) at 2024-12-05 13:02:29)
    > [ Upstream commit f6da4553ff24a5d1c959c9627c965323adc3d307 ]
    > The put_device() call in power_supply_put() may call
    > power_supply_dev_release(). The latter function does not sleep so
    > power_supply_put() doesn&#x27;t sleep either. Hence, remove the might_sleep()
    > call from power_supply_put(). This patch suppresses false positive
    > complaints about calling a sleeping function from atomic context if
    > power_supply_put() is called from atomic context.
    > Cc: Kyle Tso &lt;kyletso@google.com&gt;
    > Cc: Krzysztof Kozlowski &lt;krzk@kernel.org&gt;
    > Fixes: 1a352462b537 (&quot;power_supply: Add power_supply_put for decrementing device reference counter&quot;)
    > Signed-off-by: Bart Van Assche &lt;bvanassche@acm.org&gt;
    > Reviewed-by: Krzysztof Kozlowski &lt;krzysztof.kozlowski@linaro.org&gt;
    > Link: https://lore.kernel.org/r/20240917193914.47566-1-bvanassche@acm.org
    > Signed-off-by: Sebastian Reichel &lt;sebastian.reichel@collabora.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ LoongArch: BPF: Sign-extend return values (@Tiezhu Yang in [d5d83242a1d778c](https://github.com/sophgo/linux-riscv/commit/d5d83242a1d778c) at 2024-12-05 13:02:29)
    > [ Upstream commit 73c359d1d356cf10236ccd358bd55edab33e9424 ]
    > (1) Description of Problem:
    > When testing BPF JIT with the latest compiler toolchains on LoongArch,
    > there exist some strange failed test cases, dmesg shows something like
    > this:
    > # dmesg -t | grep FAIL | head -1
    > ... ret -3 !&#x3D; -3 (0xfffffffd !&#x3D; 0xfffffffd)FAIL ...
    > (2) Steps to Reproduce:
    > # echo 1 &gt; /proc/sys/net/core/bpf_jit_enable
    > # modprobe test_bpf
    > (3) Additional Info:
    > There are no failed test cases compiled with the lower version of GCC
    > such as 13.3.0, while the problems only appear with higher version of
    > GCC such as 14.2.0.
    > This is because the problems were hidden by the lower version of GCC due
    > to redundant sign extension instructions generated by compiler, but with
    > optimization of higher version of GCC, the sign extension instructions
    > have been removed.
    > (4) Root Cause Analysis:
    > The LoongArch architecture does not expose sub-registers, and hold all
    > 32-bit values in a sign-extended format. While BPF, on the other hand,
    > exposes sub-registers, and use zero-extension (similar to arm64/x86).
    > This has led to some subtle bugs, where a BPF JITted program has not
    > sign-extended the a0 register (return value in LoongArch land), passed
    > the return value up the kernel, for example:
    > | int from_bpf(void);
    > |
    > | long foo(void)
    > | {
    > |    return from_bpf();
    > | }
    > Here, a0 would be 0xffffffff instead of the expected 0xffffffffffffffff.
    > Internally, the LoongArch JIT uses a5 as a dedicated register for BPF
    > return values. That is to say, the LoongArch BPF uses a5 for BPF return
    > values, which are zero-extended, whereas the LoongArch ABI uses a0 which
    > is sign-extended.
    > (5) Final Solution:
    > Keep a5 zero-extended, but explicitly sign-extend a0 (which is used
    > outside BPF land). Because libbpf currently defines the return value
    > of an ebpf program as a 32-bit unsigned integer, just use addi.w to
    > extend bit 31 into bits 63 through 32 of a5 to a0. This is similar to
    > commit 2f1b0d3d7331 (&quot;riscv, bpf: Sign-extend return values&quot;).
    > Fixes: 5dc615520c4d (&quot;LoongArch: Add BPF JIT support&quot;)
    > Acked-by: John Fastabend &lt;john.fastabend@gmail.com&gt;
    > Signed-off-by: Tiezhu Yang &lt;yangtiezhu@loongson.cn&gt;
    > Signed-off-by: Huacai Chen &lt;chenhuacai@loongson.cn&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ LoongArch: Fix build failure with GCC 15 (-std&#x3D;gnu23) (@Tiezhu Yang in [cd5364ed1726c98](https://github.com/sophgo/linux-riscv/commit/cd5364ed1726c98) at 2024-12-05 13:02:29)
    > [ Upstream commit 947d5d036c788156f09e83e7f16322ffe8124384 ]
    > Whenever I try to build the kernel with upcoming GCC 15 which defaults
    > to -std&#x3D;gnu23 I get a build failure:
    > CC      arch/loongarch/vdso/vgetcpu.o
    > In file included from ./include/uapi/linux/posix_types.h:5,
    > from ./include/uapi/linux/types.h:14,
    > from ./include/linux/types.h:6,
    > from ./include/linux/kasan-checks.h:5,
    > from ./include/asm-generic/rwonce.h:26,
    > from ./arch/loongarch/include/generated/asm/rwonce.h:1,
    > from ./include/linux/compiler.h:317,
    > from ./include/asm-generic/bug.h:5,
    > from ./arch/loongarch/include/asm/bug.h:60,
    > from ./include/linux/bug.h:5,
    > from ./include/linux/mmdebug.h:5,
    > from ./include/linux/mm.h:6,
    > from ./arch/loongarch/include/asm/vdso.h:10,
    > from arch/loongarch/vdso/vgetcpu.c:6:
    > ./include/linux/stddef.h:11:9: error: expected identifier before &#x27;false&#x27;
    > 11 |         false   &#x3D; 0,
    > |         ^~~~~
    > ./include/linux/types.h:35:33: error: two or more data types in declaration specifiers
    > 35 | typedef _Bool                   bool;
    > |                                 ^~~~
    > ./include/linux/types.h:35:1: warning: useless type name in empty declaration
    > 35 | typedef _Bool                   bool;
    > | ^~~~~~~
    > The kernel builds explicitly with -std&#x3D;gnu11 in top Makefile, but
    > arch/loongarch/vdso does not use KBUILD_CFLAGS from the rest of the
    > kernel, just add -std&#x3D;gnu11 flag to arch/loongarch/vdso/Makefile.
    > By the way, commit e8c07082a810 (&quot;Kbuild: move to -std&#x3D;gnu11&quot;) did a
    > similar change for arch/arm64/kernel/vdso32/Makefile.
    > Fixes: c6b99bed6b8f (&quot;LoongArch: Add VDSO and VSYSCALL support&quot;)
    > Signed-off-by: Tiezhu Yang &lt;yangtiezhu@loongson.cn&gt;
    > Signed-off-by: Huacai Chen &lt;chenhuacai@loongson.cn&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ gpio: zevio: Add missed label initialisation (@Andy Shevchenko in [9b081b5f1a5ae82](https://github.com/sophgo/linux-riscv/commit/9b081b5f1a5ae82) at 2024-12-05 13:02:29)
    > [ Upstream commit 5bbed54ba66925ebca19092d0750630f943d7bf2 ]
    > Initialise the GPIO chip label correctly as it was done by
    > of_mm_gpiochip_add_data() before the below mentioned change.
    > Fixes: cf8f4462e5fa (&quot;gpio: zevio: drop of_gpio.h header&quot;)
    > Signed-off-by: Andy Shevchenko &lt;andriy.shevchenko@linux.intel.com&gt;
    > Link: https://lore.kernel.org/r/20241118092729.516736-1-andriy.shevchenko@linux.intel.com
    > Signed-off-by: Bartosz Golaszewski &lt;bartosz.golaszewski@linaro.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ fs_parser: update mount_api doc to match function signature (@Randy Dunlap in [92303af64435e88](https://github.com/sophgo/linux-riscv/commit/92303af64435e88) at 2024-12-05 13:02:29)
    > [ Upstream commit c66f759832a83cb273ba5a55c66dcc99384efa74 ]
    > Add the missing &#x27;name&#x27; parameter to the mount_api documentation for
    > fs_validate_description().
    > Fixes: 96cafb9ccb15 (&quot;fs_parser: remove fs_parameter_description name field&quot;)
    > Signed-off-by: Randy Dunlap &lt;rdunlap@infradead.org&gt;
    > Link: https://lore.kernel.org/r/20241125215021.231758-1-rdunlap@infradead.org
    > Cc: Eric Sandeen &lt;sandeen@redhat.com&gt;
    > Cc: David Howells &lt;dhowells@redhat.com&gt;
    > Cc: Al Viro &lt;viro@zeniv.linux.org.uk&gt;
    > Cc: Christian Brauner &lt;brauner@kernel.org&gt;
    > Cc: Jan Kara &lt;jack@suse.cz&gt;
    > Cc: Jonathan Corbet &lt;corbet@lwn.net&gt;
    > Cc: linux-doc@vger.kernel.org
    > Signed-off-by: Christian Brauner &lt;brauner@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ vfio/pci: Properly hide first-in-list PCIe extended capability (@Avihai Horon in [1ef195178fb5524](https://github.com/sophgo/linux-riscv/commit/1ef195178fb5524) at 2024-12-05 13:02:29)
    > [ Upstream commit fe4bf8d0b6716a423b16495d55b35d3fe515905d ]
    > There are cases where a PCIe extended capability should be hidden from
    > the user. For example, an unknown capability (i.e., capability with ID
    > greater than PCI_EXT_CAP_ID_MAX) or a capability that is intentionally
    > chosen to be hidden from the user.
    > Hiding a capability is done by virtualizing and modifying the &#x27;Next
    > Capability Offset&#x27; field of the previous capability so it points to the
    > capability after the one that should be hidden.
    > The special case where the first capability in the list should be hidden
    > is handled differently because there is no previous capability that can
    > be modified. In this case, the capability ID and version are zeroed
    > while leaving the next pointer intact. This hides the capability and
    > leaves an anchor for the rest of the capability list.
    > However, today, hiding the first capability in the list is not done
    > properly if the capability is unknown, as struct
    > vfio_pci_core_device-&gt;pci_config_map is set to the capability ID during
    > initialization but the capability ID is not properly checked later when
    > used in vfio_config_do_rw(). This leads to the following warning [1] and
    > to an out-of-bounds access to ecap_perms array.
    > Fix it by checking cap_id in vfio_config_do_rw(), and if it is greater
    > than PCI_EXT_CAP_ID_MAX, use an alternative struct perm_bits for direct
    > read only access instead of the ecap_perms array.
    > Note that this is safe since the above is the only case where cap_id can
    > exceed PCI_EXT_CAP_ID_MAX (except for the special capabilities, which
    > are already checked before).
    > [1]
    > WARNING: CPU: 118 PID: 5329 at drivers/vfio/pci/vfio_pci_config.c:1900 vfio_pci_config_rw+0x395/0x430 [vfio_pci_core]
    > CPU: 118 UID: 0 PID: 5329 Comm: simx-qemu-syste Not tainted 6.12.0+ #1
    > (snip)
    > Call Trace:
    > &lt;TASK&gt;
    > ? show_regs+0x69/0x80
    > ? __warn+0x8d/0x140
    > ? vfio_pci_config_rw+0x395/0x430 [vfio_pci_core]
    > ? report_bug+0x18f/0x1a0
    > ? handle_bug+0x63/0xa0
    > ? exc_invalid_op+0x19/0x70
    > ? asm_exc_invalid_op+0x1b/0x20
    > ? vfio_pci_config_rw+0x395/0x430 [vfio_pci_core]
    > ? vfio_pci_config_rw+0x244/0x430 [vfio_pci_core]
    > vfio_pci_rw+0x101/0x1b0 [vfio_pci_core]
    > vfio_pci_core_read+0x1d/0x30 [vfio_pci_core]
    > vfio_device_fops_read+0x27/0x40 [vfio]
    > vfs_read+0xbd/0x340
    > ? vfio_device_fops_unl_ioctl+0xbb/0x740 [vfio]
    > ? __rseq_handle_notify_resume+0xa4/0x4b0
    > __x64_sys_pread64+0x96/0xc0
    > x64_sys_call+0x1c3d/0x20d0
    > do_syscall_64+0x4d/0x120
    > entry_SYSCALL_64_after_hwframe+0x76/0x7e
    > Fixes: 89e1f7d4c66d (&quot;vfio: Add PCI device driver&quot;)
    > Signed-off-by: Avihai Horon &lt;avihaih@nvidia.com&gt;
    > Reviewed-by: Yi Liu &lt;yi.l.liu@intel.com&gt;
    > Tested-by: Yi Liu &lt;yi.l.liu@intel.com&gt;
    > Link: https://lore.kernel.org/r/20241124142739.21698-1-avihaih@nvidia.com
    > Signed-off-by: Alex Williamson &lt;alex.williamson@redhat.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ power: supply: bq27xxx: Fix registers of bq27426 (@Barnabás Czémán in [1a753f0674edcfb](https://github.com/sophgo/linux-riscv/commit/1a753f0674edcfb) at 2024-12-05 13:02:29)
    > [ Upstream commit 34f99d3b706a519e556841f405c224ca708b1f54 ]
    > Correct bq27426 registers, according to technical reference manual
    > it does not have Design Capacity register so it is not register
    > compatible with bq27421.
    > Fixes: 5ef6a16033b47 (&quot;power: supply: bq27xxx: Add support for BQ27426&quot;)
    > Signed-off-by: Barnabás Czémán &lt;barnabas.czeman@mainlining.org&gt;
    > Link: https://lore.kernel.org/r/20241016-fix_bq27426-v2-1-aa6c0f51a9f6@mainlining.org
    > Signed-off-by: Sebastian Reichel &lt;sebastian.reichel@collabora.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ phy: airoha: Fix REG_CSR_2L_JCPLL_SDM_HREN config in airoha_pcie_phy_init_ssc_jcpll() (@Lorenzo Bianconi in [c61a9f4609f9258](https://github.com/sophgo/linux-riscv/commit/c61a9f4609f9258) at 2024-12-05 13:02:28)
    > [ Upstream commit 6fd016c965d241673a2e62afbf9eeb4bcbfbbe45 ]
    > Fix typo configuring REG_CSR_2L_JCPLL_SDM_HREN register in
    > airoha_pcie_phy_init_ssc_jcpll routine.
    > Fixes: d7d2818b9383 (&quot;phy: airoha: Add PCIe PHY driver for EN7581 SoC.&quot;)
    > Signed-off-by: Lorenzo Bianconi &lt;lorenzo@kernel.org&gt;
    > Link: https://lore.kernel.org/r/20240918-airoha-en7581-phy-fixes-v1-3-8291729a87f8@kernel.org
    > Signed-off-by: Vinod Koul &lt;vkoul@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ vfio/mlx5: Fix an unwind issue in mlx5vf_add_migration_pages() (@Yishai Hadas in [c44f1b2ddfa81c8](https://github.com/sophgo/linux-riscv/commit/c44f1b2ddfa81c8) at 2024-12-05 13:02:28)
    > [ Upstream commit 22e87bf3f77c18f5982c19ffe2732ef0c7a25f16 ]
    > Fix an unwind issue in mlx5vf_add_migration_pages().
    > If a set of pages is allocated but fails to be added to the SG table,
    > they need to be freed to prevent a memory leak.
    > Any pages successfully added to the SG table will be freed as part of
    > mlx5vf_free_data_buffer().
    > Fixes: 6fadb021266d (&quot;vfio/mlx5: Implement vfio_pci driver for mlx5 devices&quot;)
    > Signed-off-by: Yishai Hadas &lt;yishaih@nvidia.com&gt;
    > Reviewed-by: Jason Gunthorpe &lt;jgg@nvidia.com&gt;
    > Link: https://lore.kernel.org/r/20241114095318.16556-2-yishaih@nvidia.com
    > Signed-off-by: Alex Williamson &lt;alex.williamson@redhat.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ vdpa/mlx5: Fix suboptimal range on iotlb iteration (@Si-Wei Liu in [342137eee6b758c](https://github.com/sophgo/linux-riscv/commit/342137eee6b758c) at 2024-12-05 13:02:28)
    > [ Upstream commit 35025963326e44d8bced3eecd42d2f040f4f0024 ]
    > The starting iova address to iterate iotlb map entry within a range
    > was set to an irrelevant value when passing to the itree_next()
    > iterator, although luckily it doesn&#x27;t affect the outcome of finding
    > out the granule of the smallest iotlb map size. Fix the code to make
    > it consistent with the following for-loop.
    > Fixes: 94abbccdf291 (&quot;vdpa/mlx5: Add shared memory registration code&quot;)
    > Signed-off-by: Si-Wei Liu &lt;si-wei.liu@oracle.com&gt;
    > Signed-off-by: Dragos Tatulea &lt;dtatulea@nvidia.com&gt;
    > Message-Id: &lt;20241021134040.975221-3-dtatulea@nvidia.com&gt;
    > Signed-off-by: Michael S. Tsirkin &lt;mst@redhat.com&gt;
    > Acked-by: Jason Wang &lt;jasowang@redhat.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ phy: airoha: Fix REG_CSR_2L_RX{0,1}_REV0 definitions (@Lorenzo Bianconi in [306272003734dde](https://github.com/sophgo/linux-riscv/commit/306272003734dde) at 2024-12-05 13:02:28)
    > [ Upstream commit e56272f2bb8314eb13b0eb0a4e8055831c700255 ]
    > Fix the following register definitions for REG_CSR_2L_RX{0,1}_REV0
    > registers:
    > - CSR_2L_PXP_VOS_PNINV
    > - CSR_2L_PXP_FE_GAIN_NORMAL_MODE
    > - CSR_2L_PXP_FE_GAIN_TRAIN_MODE
    > Fixes: d7d2818b9383 (&quot;phy: airoha: Add PCIe PHY driver for EN7581 SoC.&quot;)
    > Signed-off-by: Lorenzo Bianconi &lt;lorenzo@kernel.org&gt;
    > Link: https://lore.kernel.org/r/20240918-airoha-en7581-phy-fixes-v1-4-8291729a87f8@kernel.org
    > Signed-off-by: Vinod Koul &lt;vkoul@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ vfio/mlx5: Fix unwind flows in mlx5vf_pci_save/resume_device_data() (@Yishai Hadas in [2b24c649235d9eb](https://github.com/sophgo/linux-riscv/commit/2b24c649235d9eb) at 2024-12-05 13:02:28)
    > [ Upstream commit cb04444c243c001fc27f275e84792ff1c2b96867 ]
    > Fix unwind flows in mlx5vf_pci_save_device_data() and
    > mlx5vf_pci_resume_device_data() to avoid freeing the migf pointer at the
    > &#x27;end&#x27; label, as this will be handled by fput(migf-&gt;filp) through
    > mlx5vf_release_file().
    > To ensure mlx5vf_release_file() functions correctly, move the
    > initialization of migf fields (such as migf-&gt;lock) to occur before any
    > potential unwind flow, as these fields may be accessed within
    > mlx5vf_release_file().
    > Fixes: 9945a67ea4b3 (&quot;vfio/mlx5: Refactor PD usage&quot;)
    > Signed-off-by: Yishai Hadas &lt;yishaih@nvidia.com&gt;
    > Reviewed-by: Jason Gunthorpe &lt;jgg@nvidia.com&gt;
    > Link: https://lore.kernel.org/r/20241114095318.16556-3-yishaih@nvidia.com
    > Signed-off-by: Alex Williamson &lt;alex.williamson@redhat.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ selftests/mount_setattr: Fix failures on 64K PAGE_SIZE kernels (@Michael Ellerman in [1de8894196dc8d4](https://github.com/sophgo/linux-riscv/commit/1de8894196dc8d4) at 2024-12-05 13:02:28)
    > [ Upstream commit f13242a46438e690067a4bf47068fde4d5719947 ]
    > Currently the mount_setattr_test fails on machines with a 64K PAGE_SIZE,
    > with errors such as:
    > #  RUN           mount_setattr_idmapped.invalid_fd_negative ...
    > mkfs.ext4: No space left on device while writing out and closing file system
    > # mount_setattr_test.c:1055:invalid_fd_negative:Expected system(&quot;mkfs.ext4 -q /mnt/C/ext4.img&quot;) (256) &#x3D;&#x3D; 0 (0)
    > # invalid_fd_negative: Test terminated by assertion
    > #          FAIL  mount_setattr_idmapped.invalid_fd_negative
    > not ok 12 mount_setattr_idmapped.invalid_fd_negative
    > The code creates a 100,000 byte tmpfs:
    > ASSERT_EQ(mount(&quot;testing&quot;, &quot;/mnt&quot;, &quot;tmpfs&quot;, MS_NOATIME | MS_NODEV,
    > &quot;size&#x3D;100000,mode&#x3D;700&quot;), 0);
    > And then a little later creates a 2MB ext4 filesystem in that tmpfs:
    > ASSERT_EQ(ftruncate(img_fd, 1024 * 2048), 0);
    > ASSERT_EQ(system(&quot;mkfs.ext4 -q /mnt/C/ext4.img&quot;), 0);
    > At first glance it seems like that should never work, after all 2MB is
    > larger than 100,000 bytes. However the filesystem image doesn&#x27;t actually
    > occupy 2MB on &quot;disk&quot; (actually RAM, due to tmpfs). On 4K kernels the
    > ext4.img uses ~84KB of actual space (according to du), which just fits.
    > However on 64K PAGE_SIZE kernels the ext4.img takes at least 256KB,
    > which is too large to fit in the tmpfs, hence the errors.
    > It seems fraught to rely on the ext4.img taking less space on disk than
    > the allocated size, so instead create the tmpfs with a size of 2MB. With
    > that all 21 tests pass on 64K PAGE_SIZE kernels.
    > Fixes: 01eadc8dd96d (&quot;tests: add mount_setattr() selftests&quot;)
    > Signed-off-by: Michael Ellerman &lt;mpe@ellerman.id.au&gt;
    > Link: https://lore.kernel.org/r/20241115134114.1219555-1-mpe@ellerman.id.au
    > Reviewed-by: Ritesh Harjani (IBM) &lt;ritesh.list@gmail.com&gt;
    > Signed-off-by: Christian Brauner &lt;brauner@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ phy: airoha: Fix REG_CSR_2L_PLL_CMN_RESERVE0 config in airoha_pcie_phy_init_clk_out() (@Lorenzo Bianconi in [855d7c535d7aa71](https://github.com/sophgo/linux-riscv/commit/855d7c535d7aa71) at 2024-12-05 13:02:27)
    > [ Upstream commit 09a19fb75498985cbb598f1fa43a7d2416925c30 ]
    > Fix typo configuring REG_CSR_2L_PLL_CMN_RESERVE0 register in
    > airoha_pcie_phy_init_clk_out routine.
    > Fixes: d7d2818b9383 (&quot;phy: airoha: Add PCIe PHY driver for EN7581 SoC.&quot;)
    > Signed-off-by: Lorenzo Bianconi &lt;lorenzo@kernel.org&gt;
    > Link: https://lore.kernel.org/r/20240918-airoha-en7581-phy-fixes-v1-1-8291729a87f8@kernel.org
    > Signed-off-by: Vinod Koul &lt;vkoul@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ hwmon: (aquacomputer_d5next) Fix length of speed_input array (@Aleksa Savic in [854adcd7999df81](https://github.com/sophgo/linux-riscv/commit/854adcd7999df81) at 2024-12-05 13:02:27)
    > [ Upstream commit 998b5a78a9ce1cc4378e7281e4ea310e37596170 ]
    > Commit 120584c728a6 (&quot;hwmon: (aquacomputer_d5next) Add support for Octo
    > flow sensor&quot;) added support for reading Octo flow sensor, but didn&#x27;t
    > update the priv-&gt;speed_input array length. Since Octo has 8 fans, with
    > the addition of the flow sensor the proper length for speed_input is 9.
    > Reported by Arne Schwabe on Github [1], who received a UBSAN warning.
    > Fixes: 120584c728a6 (&quot;hwmon: (aquacomputer_d5next) Add support for Octo flow sensor&quot;)
    > Closes: https://github.com/aleksamagicka/aquacomputer_d5next-hwmon/issues/100 [1]
    > Reported-by: Arne Schwabe &lt;arne@rfc2549.org&gt;
    > Signed-off-by: Aleksa Savic &lt;savicaleksa83@gmail.com&gt;
    > Message-ID: &lt;20241124152725.7205-1-savicaleksa83@gmail.com&gt;
    > Signed-off-by: Guenter Roeck &lt;linux@roeck-us.net&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ hwmon: (tps23861) Fix reporting of negative temperatures (@Murad Masimov in [7052e96be286870](https://github.com/sophgo/linux-riscv/commit/7052e96be286870) at 2024-12-05 13:02:27)
    > [ Upstream commit de2bf507fabba9c0c678cf5ed54beb546f5ca29a ]
    > Negative temperatures are reported as large positive temperatures
    > due to missing sign extension from unsigned int to long. Cast unsigned
    > raw register values to signed before performing the calculations
    > to fix the problem.
    > Found by Linux Verification Center (linuxtesting.org) with SVACE.
    > Fixes: fff7b8ab2255 (&quot;hwmon: add Texas Instruments TPS23861 driver&quot;)
    > Signed-off-by: Murad Masimov &lt;m.masimov@maxima.ru&gt;
    > Message-ID: &lt;20241121173604.2021-1-m.masimov@maxima.ru&gt;
    > [groeck: Updated subject and description]
    > Signed-off-by: Guenter Roeck &lt;linux@roeck-us.net&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ f2fs: fix to do cast in F2FS_{BLK_TO_BYTES, BTYES_TO_BLK} to avoid overflow (@Chao Yu in [45438da8438f21b](https://github.com/sophgo/linux-riscv/commit/45438da8438f21b) at 2024-12-05 13:02:27)
    > [ Upstream commit 3273d8ad947dea925a65a78ca29e5351c960c801 ]
    > It missed to cast variable to unsigned long long type before
    > bit shift, which will cause overflow, fix it.
    > Fixes: f7ef9b83b583 (&quot;f2fs: introduce macros to convert bytes and blocks in f2fs&quot;)
    > Signed-off-by: Chao Yu &lt;chao@kernel.org&gt;
    > Signed-off-by: Jaegeuk Kim &lt;jaegeuk@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ nfs_common: must not hold RCU while calling nfsd_file_put_local (@Mike Snitzer in [3e6e3e97d64f50d](https://github.com/sophgo/linux-riscv/commit/3e6e3e97d64f50d) at 2024-12-05 13:02:27)
    > [ Upstream commit c840b8e1f039e90f97ca55525667eb961422f86c ]
    > Move holding the RCU from nfs_to_nfsd_file_put_local to
    > nfs_to_nfsd_net_put.  It is the call to nfs_to-&gt;nfsd_serv_put that
    > requires the RCU anyway (the puts for nfsd_file and netns were
    > combined to avoid an extra indirect reference but that
    > micro-optimization isn&#x27;t possible now).
    > This fixes xfstests generic/013 and it triggering:
    > &quot;Voluntary context switch within RCU read-side critical section!&quot;
    > [  143.545738] Call Trace:
    > [  143.546206]  &lt;TASK&gt;
    > [  143.546625]  ? show_regs+0x6d/0x80
    > [  143.547267]  ? __warn+0x91/0x140
    > [  143.547951]  ? rcu_note_context_switch+0x496/0x5d0
    > [  143.548856]  ? report_bug+0x193/0x1a0
    > [  143.549557]  ? handle_bug+0x63/0xa0
    > [  143.550214]  ? exc_invalid_op+0x1d/0x80
    > [  143.550938]  ? asm_exc_invalid_op+0x1f/0x30
    > [  143.551736]  ? rcu_note_context_switch+0x496/0x5d0
    > [  143.552634]  ? wakeup_preempt+0x62/0x70
    > [  143.553358]  __schedule+0xaa/0x1380
    > [  143.554025]  ? _raw_spin_unlock_irqrestore+0x12/0x40
    > [  143.554958]  ? try_to_wake_up+0x1fe/0x6b0
    > [  143.555715]  ? wake_up_process+0x19/0x20
    > [  143.556452]  schedule+0x2e/0x120
    > [  143.557066]  schedule_preempt_disabled+0x19/0x30
    > [  143.557933]  rwsem_down_read_slowpath+0x24d/0x4a0
    > [  143.558818]  ? xfs_efi_item_format+0x50/0xc0 [xfs]
    > [  143.559894]  down_read+0x4e/0xb0
    > [  143.560519]  xlog_cil_commit+0x1b2/0xbc0 [xfs]
    > [  143.561460]  ? _raw_spin_unlock+0x12/0x30
    > [  143.562212]  ? xfs_inode_item_precommit+0xc7/0x220 [xfs]
    > [  143.563309]  ? xfs_trans_run_precommits+0x69/0xd0 [xfs]
    > [  143.564394]  __xfs_trans_commit+0xb5/0x330 [xfs]
    > [  143.565367]  xfs_trans_roll+0x48/0xc0 [xfs]
    > [  143.566262]  xfs_defer_trans_roll+0x57/0x100 [xfs]
    > [  143.567278]  xfs_defer_finish_noroll+0x27a/0x490 [xfs]
    > [  143.568342]  xfs_defer_finish+0x1a/0x80 [xfs]
    > [  143.569267]  xfs_bunmapi_range+0x4d/0xb0 [xfs]
    > [  143.570208]  xfs_itruncate_extents_flags+0x13d/0x230 [xfs]
    > [  143.571353]  xfs_free_eofblocks+0x12e/0x190 [xfs]
    > [  143.572359]  xfs_file_release+0x12d/0x140 [xfs]
    > [  143.573324]  __fput+0xe8/0x2d0
    > [  143.573922]  __fput_sync+0x1d/0x30
    > [  143.574574]  nfsd_filp_close+0x33/0x60 [nfsd]
    > [  143.575430]  nfsd_file_free+0x96/0x150 [nfsd]
    > [  143.576274]  nfsd_file_put+0xf7/0x1a0 [nfsd]
    > [  143.577104]  nfsd_file_put_local+0x18/0x30 [nfsd]
    > [  143.578070]  nfs_close_local_fh+0x101/0x110 [nfs_localio]
    > [  143.579079]  __put_nfs_open_context+0xc9/0x180 [nfs]
    > [  143.580031]  nfs_file_clear_open_context+0x4a/0x60 [nfs]
    > [  143.581038]  nfs_file_release+0x3e/0x60 [nfs]
    > [  143.581879]  __fput+0xe8/0x2d0
    > [  143.582464]  __fput_sync+0x1d/0x30
    > [  143.583108]  __x64_sys_close+0x41/0x80
    > [  143.583823]  x64_sys_call+0x189a/0x20d0
    > [  143.584552]  do_syscall_64+0x64/0x170
    > [  143.585240]  entry_SYSCALL_64_after_hwframe+0x76/0x7e
    > [  143.586185] RIP: 0033:0x7f3c5153efd7
    > Fixes: 65f2a5c36635 (&quot;nfs_common: fix race in NFS calls to nfsd_file_put_local() and nfsd_serv_put()&quot;)
    > Signed-off-by: Mike Snitzer &lt;snitzer@kernel.org&gt;
    > Reviewed-by: NeilBrown &lt;neilb@suse.de&gt;
    > Reviewed-by: Jeff Layton &lt;jlayton@kernel.org&gt;
    > Signed-off-by: Chuck Lever &lt;chuck.lever@oracle.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ phy: airoha: Fix REG_PCIE_PMA_TX_RESET config in airoha_pcie_phy_init_csr_2l() (@Lorenzo Bianconi in [3c093a47de20f05](https://github.com/sophgo/linux-riscv/commit/3c093a47de20f05) at 2024-12-05 13:02:27)
    > [ Upstream commit f9c5d6369d3e8e36b7beb15e86b1ef0911ace85f ]
    > Fix typos configuring REG_PCIE_PMA_TX_RESET register in
    > airoha_pcie_phy_init_csr_2l routine for lane0 and lane1
    > Fixes: d7d2818b9383 (&quot;phy: airoha: Add PCIe PHY driver for EN7581 SoC.&quot;)
    > Signed-off-by: Lorenzo Bianconi &lt;lorenzo@kernel.org&gt;
    > Link: https://lore.kernel.org/r/20240918-airoha-en7581-phy-fixes-v1-2-8291729a87f8@kernel.org
    > Signed-off-by: Vinod Koul &lt;vkoul@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ perf bpf-filter: Return -ENOMEM directly when pfi allocation fails (@Hao Ge in [0945a6eec2cfc0e](https://github.com/sophgo/linux-riscv/commit/0945a6eec2cfc0e) at 2024-12-05 13:02:27)
    > [ Upstream commit bd077a53ad87cb111632e564cdfe8dfbe96786de ]
    > Directly return -ENOMEM when pfi allocation fails,
    > instead of performing other operations on pfi.
    > Fixes: 0fe2b18ddc40 (&quot;perf bpf-filter: Support multiple events properly&quot;)
    > Signed-off-by: Hao Ge &lt;gehao@kylinos.cn&gt;
    > Acked-by: Namhyung Kim &lt;namhyung@kernel.org&gt;
    > Cc: hao.ge@linux.dev
    > Cc: bpf@vger.kernel.org
    > Link: https://lore.kernel.org/r/20241113030537.26732-1-hao.ge@linux.dev
    > Signed-off-by: Namhyung Kim &lt;namhyung@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ NFSD: Cap the number of bytes copied by nfs4_reset_recoverydir() (@Chuck Lever in [f063b03b81f8c72](https://github.com/sophgo/linux-riscv/commit/f063b03b81f8c72) at 2024-12-05 13:02:26)
    > [ Upstream commit f64ea4af43161bb86ffc77e6aeb5bcf5c3229df0 ]
    > It&#x27;s only current caller already length-checks the string, but let&#x27;s
    > be safe.
    > Fixes: 0964a3d3f1aa (&quot;[PATCH] knfsd: nfsd4 reboot dirname fix&quot;)
    > Reviewed-by: Jeff Layton &lt;jlayton@kernel.org&gt;
    > Signed-off-by: Chuck Lever &lt;chuck.lever@oracle.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ nfsd: release svc_expkey/svc_export with rcu_work (@Yang Erkun in [ad4363a24a5746b](https://github.com/sophgo/linux-riscv/commit/ad4363a24a5746b) at 2024-12-05 13:02:26)
    > [ Upstream commit f8c989a0c89a75d30f899a7cabdc14d72522bb8d ]
    > The last reference for &#x60;cache_head&#x60; can be reduced to zero in &#x60;c_show&#x60;
    > and &#x60;e_show&#x60;(using &#x60;rcu_read_lock&#x60; and &#x60;rcu_read_unlock&#x60;). Consequently,
    > &#x60;svc_export_put&#x60; and &#x60;expkey_put&#x60; will be invoked, leading to two
    > issues:
    > 1. The &#x60;svc_export_put&#x60; will directly free ex_uuid. However,
    > &#x60;e_show&#x60;/&#x60;c_show&#x60; will access &#x60;ex_uuid&#x60; after &#x60;cache_put&#x60;, which can
    > trigger a use-after-free issue, shown below.
    > &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;
    > BUG: KASAN: slab-use-after-free in svc_export_show+0x362/0x430 [nfsd]
    > Read of size 1 at addr ff11000010fdc120 by task cat/870
    > CPU: 1 UID: 0 PID: 870 Comm: cat Not tainted 6.12.0-rc3+ #1
    > Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS
    > 1.16.1-2.fc37 04/01/2014
    > Call Trace:
    > &lt;TASK&gt;
    > dump_stack_lvl+0x53/0x70
    > print_address_description.constprop.0+0x2c/0x3a0
    > print_report+0xb9/0x280
    > kasan_report+0xae/0xe0
    > svc_export_show+0x362/0x430 [nfsd]
    > c_show+0x161/0x390 [sunrpc]
    > seq_read_iter+0x589/0x770
    > seq_read+0x1e5/0x270
    > proc_reg_read+0xe1/0x140
    > vfs_read+0x125/0x530
    > ksys_read+0xc1/0x160
    > do_syscall_64+0x5f/0x170
    > entry_SYSCALL_64_after_hwframe+0x76/0x7e
    > Allocated by task 830:
    > kasan_save_stack+0x20/0x40
    > kasan_save_track+0x14/0x30
    > __kasan_kmalloc+0x8f/0xa0
    > __kmalloc_node_track_caller_noprof+0x1bc/0x400
    > kmemdup_noprof+0x22/0x50
    > svc_export_parse+0x8a9/0xb80 [nfsd]
    > cache_do_downcall+0x71/0xa0 [sunrpc]
    > cache_write_procfs+0x8e/0xd0 [sunrpc]
    > proc_reg_write+0xe1/0x140
    > vfs_write+0x1a5/0x6d0
    > ksys_write+0xc1/0x160
    > do_syscall_64+0x5f/0x170
    > entry_SYSCALL_64_after_hwframe+0x76/0x7e
    > Freed by task 868:
    > kasan_save_stack+0x20/0x40
    > kasan_save_track+0x14/0x30
    > kasan_save_free_info+0x3b/0x60
    > __kasan_slab_free+0x37/0x50
    > kfree+0xf3/0x3e0
    > svc_export_put+0x87/0xb0 [nfsd]
    > cache_purge+0x17f/0x1f0 [sunrpc]
    > nfsd_destroy_serv+0x226/0x2d0 [nfsd]
    > nfsd_svc+0x125/0x1e0 [nfsd]
    > write_threads+0x16a/0x2a0 [nfsd]
    > nfsctl_transaction_write+0x74/0xa0 [nfsd]
    > vfs_write+0x1a5/0x6d0
    > ksys_write+0xc1/0x160
    > do_syscall_64+0x5f/0x170
    > entry_SYSCALL_64_after_hwframe+0x76/0x7e
    > 2. We cannot sleep while using &#x60;rcu_read_lock&#x60;/&#x60;rcu_read_unlock&#x60;.
    > However, &#x60;svc_export_put&#x60;/&#x60;expkey_put&#x60; will call path_put, which
    > subsequently triggers a sleeping operation due to the following
    > &#x60;dput&#x60;.
    > &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;
    > WARNING: suspicious RCU usage
    > 5.10.0-dirty #141 Not tainted
    > -----------------------------
    > ...
    > Call Trace:
    > dump_stack+0x9a/0xd0
    > ___might_sleep+0x231/0x240
    > dput+0x39/0x600
    > path_put+0x1b/0x30
    > svc_export_put+0x17/0x80
    > e_show+0x1c9/0x200
    > seq_read_iter+0x63f/0x7c0
    > seq_read+0x226/0x2d0
    > vfs_read+0x113/0x2c0
    > ksys_read+0xc9/0x170
    > do_syscall_64+0x33/0x40
    > entry_SYSCALL_64_after_hwframe+0x67/0xd1
    > Fix these issues by using &#x60;rcu_work&#x60; to help release
    > &#x60;svc_expkey&#x60;/&#x60;svc_export&#x60;. This approach allows for an asynchronous
    > context to invoke &#x60;path_put&#x60; and also facilitates the freeing of
    > &#x60;uuid/exp/key&#x60; after an RCU grace period.
    > Fixes: 9ceddd9da134 (&quot;knfsd: Allow lockless lookups of the exports&quot;)
    > Signed-off-by: Yang Erkun &lt;yangerkun@huawei.com&gt;
    > Reviewed-by: Jeff Layton &lt;jlayton@kernel.org&gt;
    > Signed-off-by: Chuck Lever &lt;chuck.lever@oracle.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ NFSD: Fix nfsd4_shutdown_copy() (@Chuck Lever in [9e7c4cfdf7fef14](https://github.com/sophgo/linux-riscv/commit/9e7c4cfdf7fef14) at 2024-12-05 13:02:26)
    > [ Upstream commit 62a8642ba00aa8ceb0a02ade942f5ec52e877c95 ]
    > nfsd4_shutdown_copy() is just this:
    > while ((copy &#x3D; nfsd4_get_copy(clp)) !&#x3D; NULL)
    > nfsd4_stop_copy(copy);
    > nfsd4_get_copy() bumps @copy&#x27;s reference count, preventing
    > nfsd4_stop_copy() from releasing @copy.
    > A while loop like this usually works by removing the first element
    > of the list, but neither nfsd4_get_copy() nor nfsd4_stop_copy()
    > alters the async_copies list.
    > Best I can tell, then, is that nfsd4_shutdown_copy() continues to
    > loop until other threads manage to remove all the items from this
    > list. The spinning loop blocks shutdown until these items are gone.
    > Possibly the reason we haven&#x27;t seen this issue in the field is
    > because client_has_state() prevents __destroy_client() from calling
    > nfsd4_shutdown_copy() if there are any items on this list. In a
    > subsequent patch I plan to remove that restriction.
    > Fixes: e0639dc5805a (&quot;NFSD introduce async copy feature&quot;)
    > Reviewed-by: Jeff Layton &lt;jlayton@kernel.org&gt;
    > Signed-off-by: Chuck Lever &lt;chuck.lever@oracle.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ NFSD: Prevent NULL dereference in nfsd4_process_cb_update() (@Chuck Lever in [4a4ffc1aa9d618e](https://github.com/sophgo/linux-riscv/commit/4a4ffc1aa9d618e) at 2024-12-05 13:02:26)
    > [ Upstream commit 1e02c641c3a43c88cecc08402000418e15578d38 ]
    > @ses is initialized to NULL. If __nfsd4_find_backchannel() finds no
    > available backchannel session, setup_callback_client() will try to
    > dereference @ses and segfault.
    > Fixes: dcbeaa68dbbd (&quot;nfsd4: allow backchannel recovery&quot;)
    > Reviewed-by: Jeff Layton &lt;jlayton@kernel.org&gt;
    > Signed-off-by: Chuck Lever &lt;chuck.lever@oracle.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ remoteproc: qcom_q6v5_mss: Re-order writes to the IMEM region (@Sibi Sankar in [32389feeb40ba2f](https://github.com/sophgo/linux-riscv/commit/32389feeb40ba2f) at 2024-12-05 13:02:26)
    > [ Upstream commit 7b22b7719fc17d5979a991c918c868ab041be5c8 ]
    > Any write access to the IMEM region when the Q6 is setting up XPU
    > protection on it will result in a XPU violation. Fix this by ensuring
    > IMEM writes related to the MBA post-mortem logs happen before the Q6
    > is brought out of reset.
    > Fixes: 318130cc9362 (&quot;remoteproc: qcom_q6v5_mss: Add MBA log extraction support&quot;)
    > Signed-off-by: Sibi Sankar &lt;quic_sibis@quicinc.com&gt;
    > Reviewed-by: Douglas Anderson &lt;dianders@chromium.org&gt;
    > Tested-by: Douglas Anderson &lt;dianders@chromium.org&gt;
    > Link: https://lore.kernel.org/r/20240819073020.3291287-1-quic_sibis@quicinc.com
    > Signed-off-by: Bjorn Andersson &lt;andersson@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ svcrdma: fix miss destroy percpu_counter in svc_rdma_proc_init() (@Ye Bin in [20322edcbad82a6](https://github.com/sophgo/linux-riscv/commit/20322edcbad82a6) at 2024-12-05 13:02:26)
    > [ Upstream commit ce89e742a4c12b20f09a43fec1b21db33f2166cd ]
    > There&#x27;s issue as follows:
    > RPC: Registered rdma transport module.
    > RPC: Registered rdma backchannel transport module.
    > RPC: Unregistered rdma transport module.
    > RPC: Unregistered rdma backchannel transport module.
    > BUG: unable to handle page fault for address: fffffbfff80c609a
    > PGD 123fee067 P4D 123fee067 PUD 123fea067 PMD 10c624067 PTE 0
    > Oops: Oops: 0000 [#1] PREEMPT SMP KASAN NOPTI
    > RIP: 0010:percpu_counter_destroy_many+0xf7/0x2a0
    > Call Trace:
    > &lt;TASK&gt;
    > __die+0x1f/0x70
    > page_fault_oops+0x2cd/0x860
    > spurious_kernel_fault+0x36/0x450
    > do_kern_addr_fault+0xca/0x100
    > exc_page_fault+0x128/0x150
    > asm_exc_page_fault+0x26/0x30
    > percpu_counter_destroy_many+0xf7/0x2a0
    > mmdrop+0x209/0x350
    > finish_task_switch.isra.0+0x481/0x840
    > schedule_tail+0xe/0xd0
    > ret_from_fork+0x23/0x80
    > ret_from_fork_asm+0x1a/0x30
    > &lt;/TASK&gt;
    > If register_sysctl() return NULL, then svc_rdma_proc_cleanup() will not
    > destroy the percpu counters which init in svc_rdma_proc_init().
    > If CONFIG_HOTPLUG_CPU is enabled, residual nodes may be in the
    > &#x27;percpu_counters&#x27; list. The above issue may occur once the module is
    > removed. If the CONFIG_HOTPLUG_CPU configuration is not enabled, memory
    > leakage occurs.
    > To solve above issue just destroy all percpu counters when
    > register_sysctl() return NULL.
    > Fixes: 1e7e55731628 (&quot;svcrdma: Restore read and write stats&quot;)
    > Fixes: 22df5a22462e (&quot;svcrdma: Convert rdma_stat_sq_starve to a per-CPU counter&quot;)
    > Fixes: df971cd853c0 (&quot;svcrdma: Convert rdma_stat_recv to a per-CPU counter&quot;)
    > Signed-off-by: Ye Bin &lt;yebin10@huawei.com&gt;
    > Signed-off-by: Chuck Lever &lt;chuck.lever@oracle.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ PCI: endpoint: epf-mhi: Avoid NULL dereference if DT lacks &#x27;mmio&#x27; (@Zhongqiu Han in [0e6d92e3b973de7](https://github.com/sophgo/linux-riscv/commit/0e6d92e3b973de7) at 2024-12-05 13:02:26)
    > [ Upstream commit 5089b3d874e9933d9842e90410d3af1520494757 ]
    > If platform_get_resource_byname() fails and returns NULL because DT lacks
    > an &#x27;mmio&#x27; property for the MHI endpoint, dereferencing res-&gt;start will
    > cause a NULL pointer access. Add a check to prevent it.
    > Fixes: 1bf5f25324f7 (&quot;PCI: endpoint: Add PCI Endpoint function driver for MHI bus&quot;)
    > Link: https://lore.kernel.org/r/20241105120735.1240728-1-quic_zhonhan@quicinc.com
    > Signed-off-by: Zhongqiu Han &lt;quic_zhonhan@quicinc.com&gt;
    > [kwilczynski: error message update per the review feedback]
    > Signed-off-by: Krzysztof Wilczyński &lt;kwilczynski@kernel.org&gt;
    > [bhelgaas: commit log]
    > Signed-off-by: Bjorn Helgaas &lt;bhelgaas@google.com&gt;
    > Reviewed-by: Niklas Cassel &lt;cassel@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ remoteproc: qcom: pas: Remove subdevs on the error path of adsp_probe() (@Joe Hattori in [f0074854ee33cbc](https://github.com/sophgo/linux-riscv/commit/f0074854ee33cbc) at 2024-12-05 13:02:25)
    > [ Upstream commit 587b67cf62a91b10a47f41c20ed8ad71db375334 ]
    > Current implementation of adsp_probe() in qcom_q6v5_pas.c does not
    > remove the subdevs of adsp on the error path. Fix this bug by calling
    > qcom_remove_{ssr,sysmon,pdm,smd,glink}_subdev(), qcom_q6v5_deinit(), and
    > adsp_unassign_memory_region() appropriately.
    > Fixes: 4b48921a8f74 (&quot;remoteproc: qcom: Use common SMD edge handler&quot;)
    > Signed-off-by: Joe Hattori &lt;joe@pf.is.s.u-tokyo.ac.jp&gt;
    > Link: https://lore.kernel.org/r/a1cabc64240022a7f1d5237aa2aa6f72d8fb7052.1731038950.git.joe@pf.is.s.u-tokyo.ac.jp
    > Signed-off-by: Bjorn Andersson &lt;andersson@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ perf trace: Avoid garbage when not printing a syscall&#x27;s arguments (@Benjamin Peterson in [da7df496b899a7c](https://github.com/sophgo/linux-riscv/commit/da7df496b899a7c) at 2024-12-05 13:02:25)
    > [ Upstream commit 1302e352b26f34991b619b5d0b621b76d20a3883 ]
    > syscall__scnprintf_args may not place anything in the output buffer
    > (e.g., because the arguments are all zero). If that happened in
    > trace__fprintf_sys_enter, its fprintf would receive an unitialized
    > buffer leading to garbage output.
    > Fix the problem by passing the (possibly zero) bounds of the argument
    > buffer to the output fprintf.
    > Fixes: a98392bb1e169a04 (&quot;perf trace: Use beautifiers on syscalls:sys_enter_ handlers&quot;)
    > Signed-off-by: Benjamin Peterson &lt;benjamin@engflow.com&gt;
    > Tested-by: Arnaldo Carvalho de Melo &lt;acme@redhat.com&gt;
    > Tested-by: Howard Chu &lt;howardchu95@gmail.com&gt;
    > Cc: Adrian Hunter &lt;adrian.hunter@intel.com&gt;
    > Cc: Alexander Shishkin &lt;alexander.shishkin@linux.intel.com&gt;
    > Cc: Ian Rogers &lt;irogers@google.com&gt;
    > Cc: Ingo Molnar &lt;mingo@redhat.com&gt;
    > Cc: Jiri Olsa &lt;jolsa@kernel.org&gt;
    > Cc: Kan Liang &lt;kan.liang@linux.intel.com&gt;
    > Cc: Mark Rutland &lt;mark.rutland@arm.com&gt;
    > Cc: Namhyung Kim &lt;namhyung@kernel.org&gt;
    > Cc: Peter Zijlstra &lt;peterz@infradead.org&gt;
    > Link: https://lore.kernel.org/r/20241107232128.108981-2-benjamin@engflow.com
    > Signed-off-by: Arnaldo Carvalho de Melo &lt;acme@redhat.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ rpmsg: glink: use only lower 16-bits of param2 for CMD_OPEN name length (@Jonathan Marek in [a02229d8f949f81](https://github.com/sophgo/linux-riscv/commit/a02229d8f949f81) at 2024-12-05 13:02:25)
    > [ Upstream commit 06c59d97f63c1b8af521fa5aef8a716fb988b285 ]
    > The name len field of the CMD_OPEN packet is only 16-bits and the upper
    > 16-bits of &quot;param2&quot; are a different &quot;prio&quot; field, which can be nonzero in
    > certain situations, and CMD_OPEN packets can be unexpectedly dropped
    > because of this.
    > Fix this by masking out the upper 16 bits of param2.
    > Fixes: b4f8e52b89f6 (&quot;rpmsg: Introduce Qualcomm RPM glink driver&quot;)
    > Signed-off-by: Jonathan Marek &lt;jonathan@marek.ca&gt;
    > Reviewed-by: Dmitry Baryshkov &lt;dmitry.baryshkov@linaro.org&gt;
    > Link: https://lore.kernel.org/r/20241007235935.6216-1-jonathan@marek.ca
    > Signed-off-by: Bjorn Andersson &lt;andersson@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ remoteproc: qcom: pas: add minidump_id to SM8350 resources (@Dmitry Baryshkov in [9946b4be0863a03](https://github.com/sophgo/linux-riscv/commit/9946b4be0863a03) at 2024-12-05 13:02:25)
    > [ Upstream commit e8983156d54f59f57e648ecd44f01c16572da842 ]
    > Specify minidump_id for the SM8350 DSPs. It was omitted for in the
    > original commit e8b4e9a21af7 (&quot;remoteproc: qcom: pas: Add SM8350 PAS
    > remoteprocs&quot;).
    > Fixes: e8b4e9a21af7 (&quot;remoteproc: qcom: pas: Add SM8350 PAS remoteprocs&quot;)
    > Signed-off-by: Dmitry Baryshkov &lt;dmitry.baryshkov@linaro.org&gt;
    > Reviewed-by: Neil Armstrong &lt;neil.armstrong@linaro.org&gt;
    > Link: https://lore.kernel.org/r/20241027-sar2130p-adsp-v1-2-bd204e39d24e@linaro.org
    > Signed-off-by: Bjorn Andersson &lt;andersson@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ remoteproc: qcom: adsp: Remove subdevs on the error path of adsp_probe() (@Joe Hattori in [48b469f0fcfeda1](https://github.com/sophgo/linux-riscv/commit/48b469f0fcfeda1) at 2024-12-05 13:02:25)
    > [ Upstream commit fe80d3205e91e36e67f4d3d6c326793298d15766 ]
    > Current implementation of adsp_probe() in qcom_q6v5_adsp.c and does not
    > remove the subdevs of adsp on the error path. Fix this bug by calling
    > qcom_remove_{ssr,sysmon,pdm,smd,glink}_subdev(), and qcom_q6v5_deinit()
    > appropriately.
    > Fixes: dc160e449122 (&quot;remoteproc: qcom: Introduce Non-PAS ADSP PIL driver&quot;)
    > Signed-off-by: Joe Hattori &lt;joe@pf.is.s.u-tokyo.ac.jp&gt;
    > Link: https://lore.kernel.org/r/fed3df4219543d46b88bacf87990d947f3fac8d7.1731038950.git.joe@pf.is.s.u-tokyo.ac.jp
    > Signed-off-by: Bjorn Andersson &lt;andersson@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ perf trace: Do not lose last events in a race (@Benjamin Peterson in [3217b29268a5a43](https://github.com/sophgo/linux-riscv/commit/3217b29268a5a43) at 2024-12-05 13:02:25)
    > [ Upstream commit 3fd7c36973a250e17a4ee305a31545a9426021f4 ]
    > If a perf trace event selector specifies a maximum number of events to output
    > (i.e., &quot;/nr&#x3D;N/&quot; syntax), the event printing handler, trace__event_handler,
    > disables the event selector after the maximum number events are
    > printed.
    > Furthermore, trace__event_handler checked if the event selector was
    > disabled before doing any work. This avoided exceeding the maximum
    > number of events to print if more events were in the buffer before the
    > selector was disabled.
    > However, the event selector can be disabled for reasons other than
    > exceeding the maximum number of events. In particular, when the traced
    > subprocess exits, the main loop disables all event selectors. This meant
    > the last events of a traced subprocess might be lost to the printing
    > handler&#x27;s short-circuiting logic.
    > This nondeterministic problem could be seen by running the following many times:
    > $ perf trace -e syscalls:sys_enter_exit_group true
    > trace__event_handler should simply check for exceeding the maximum number of
    > events to print rather than the state of the event selector.
    > Fixes: a9c5e6c1e9bff42c (&quot;perf trace: Introduce per-event maximum number of events property&quot;)
    > Signed-off-by: Benjamin Peterson &lt;benjamin@engflow.com&gt;
    > Tested-by: Howard Chu &lt;howardchu95@gmail.com&gt;
    > Cc: Adrian Hunter &lt;adrian.hunter@intel.com&gt;
    > Cc: Alexander Shishkin &lt;alexander.shishkin@linux.intel.com&gt;
    > Cc: Ian Rogers &lt;irogers@google.com&gt;
    > Cc: Ingo Molnar &lt;mingo@redhat.com&gt;
    > Cc: Jiri Olsa &lt;jolsa@kernel.org&gt;
    > Cc: Kan Liang &lt;kan.liang@linux.intel.com&gt;
    > Cc: Mark Rutland &lt;mark.rutland@arm.com&gt;
    > Cc: Namhyung Kim &lt;namhyung@kernel.org&gt;
    > Cc: Peter Zijlstra &lt;peterz@infradead.org&gt;
    > Link: https://lore.kernel.org/r/20241107232128.108981-1-benjamin@engflow.com
    > Signed-off-by: Arnaldo Carvalho de Melo &lt;acme@redhat.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ perf trace: Fix tracing itself, creating feedback loops (@Howard Chu in [179789326b5c419](https://github.com/sophgo/linux-riscv/commit/179789326b5c419) at 2024-12-05 13:02:25)
    > [ Upstream commit fe4f9b4124967ffb75d66994520831231b779550 ]
    > There exists a pids_filtered map in augmented_raw_syscalls.bpf.c that
    > ceases to provide functionality after the BPF skeleton migration done
    > in:
    > 5e6da6be3082f77b (&quot;perf trace: Migrate BPF augmentation to use a skeleton&quot;)
    > Before the migration, pid_filtered map works, courtesy of Arnaldo
    > Carvalho de Melo &lt;acme@kernel.org&gt;:
    > ⬢ [acme@toolbox perf-tools]$ git log --oneline -5
    > 6f769c3458b6cf2d (HEAD) perf tests trace+probe_vfs_getname.sh: Accept quotes surrounding the filename
    > 7777ac3dfe29f55d perf test trace+probe_vfs_getname.sh: Remove stray \ before /
    > 33d9c5062113a4bd perf script python: Add stub for PMU symbol to the python binding
    > e59fea47f83e8a9a perf symbols: Fix DSO kernel load and symbol process to correctly map DSO to its long_name, type and adjust_symbols
    > 878460e8d0ff84a0 perf build: Remove -Wno-unused-but-set-variable from the flex flags when building with clang &lt; 13.0.0
    > root@x1:/home/acme/git/perf-tools# perf trace -e /tmp/augmented_raw_syscalls.o -e write* --max-events&#x3D;30  &amp;
    > [1] 180632
    > root@x1:/home/acme/git/perf-tools#      0.000 ( 0.051 ms): NetworkManager/1127 write(fd: 3, buf: 0x7ffeb508ef70, count: 8)                           &#x3D; 8
    > 0.115 ( 0.010 ms): NetworkManager/1127 write(fd: 3, buf: 0x7ffeb508ef70, count: 8)                           &#x3D; 8
    > 0.916 ( 0.068 ms): sudo/156867 write(fd: 8, buf: 0x55cb4cd2f650, count: 246)                         &#x3D; 246
    > 1.699 ( 0.047 ms): sudo/156867 write(fd: 8, buf: 0x55cb4cd2f650, count: 121)                         &#x3D; 121
    > 2.167 ( 0.041 ms): sudo/156867 write(fd: 8, buf: 0x55cb4cd2f650, count: 121)                         &#x3D; 121
    > 2.739 ( 0.042 ms): sudo/156867 write(fd: 8, buf: 0x55cb4cd2f650, count: 121)                         &#x3D; 121
    > 3.138 ( 0.027 ms): sudo/156867 write(fd: 8, buf: 0x55cb4cd2f650, count: 121)                         &#x3D; 121
    > 3.477 ( 0.027 ms): sudo/156867 write(fd: 8, buf: 0x55cb4cd2f650, count: 121)                         &#x3D; 121
    > 3.738 ( 0.023 ms): sudo/156867 write(fd: 8, buf: 0x55cb4cd2f650, count: 121)                         &#x3D; 121
    > 3.946 ( 0.024 ms): sudo/156867 write(fd: 8, buf: 0x55cb4cd2f650, count: 121)                         &#x3D; 121
    > 4.195 ( 0.024 ms): sudo/156867 write(fd: 8, buf: 0x55cb4cd2f650, count: 121)                         &#x3D; 121
    > 4.212 ( 0.026 ms): NetworkManager/1127 write(fd: 3, buf: 0x7ffeb508ef70, count: 8)                           &#x3D; 8
    > 4.285 ( 0.006 ms): NetworkManager/1127 write(fd: 3, buf: 0x7ffeb508ef70, count: 8)                           &#x3D; 8
    > 4.445 ( 0.018 ms): sudo/156867 write(fd: 8, buf: 0x55cb4cd2f650, count: 260)                         &#x3D; 260
    > 4.508 ( 0.009 ms): sudo/156867 write(fd: 8, buf: 0x55cb4cd2f650, count: 124)                         &#x3D; 124
    > 4.592 ( 0.010 ms): sudo/156867 write(fd: 8, buf: 0x55cb4cd2f650, count: 116)                         &#x3D; 116
    > 4.666 ( 0.009 ms): sudo/156867 write(fd: 8, buf: 0x55cb4cd2f650, count: 130)                         &#x3D; 130
    > 4.715 ( 0.010 ms): sudo/156867 write(fd: 8, buf: 0x55cb4cd2f650, count: 95)                          &#x3D; 95
    > 4.765 ( 0.007 ms): sudo/156867 write(fd: 8, buf: 0x55cb4cd2f650, count: 102)                         &#x3D; 102
    > 4.815 ( 0.009 ms): sudo/156867 write(fd: 8, buf: 0x55cb4cd2f650, count: 79)                          &#x3D; 79
    > 4.890 ( 0.008 ms): sudo/156867 write(fd: 8, buf: 0x55cb4cd2f650, count: 57)                          &#x3D; 57
    > 4.937 ( 0.007 ms): sudo/156867 write(fd: 8, buf: 0x55cb4cd2f650, count: 89)                          &#x3D; 89
    > 5.009 ( 0.010 ms): sudo/156867 write(fd: 8, buf: 0x55cb4cd2f650, count: 112)                         &#x3D; 112
    > 5.059 ( 0.010 ms): sudo/156867 write(fd: 8, buf: 0x55cb4cd2f650, count: 112)                         &#x3D; 112
    > 5.116 ( 0.007 ms): sudo/156867 write(fd: 8, buf: 0x55cb4cd2f650, count: 79)                          &#x3D; 79
    > 5.152 ( 0.009 ms): sudo/156867 write(fd: 8, buf: 0x55cb4cd2f650, count: 33)                          &#x3D; 33
    > 5.215 ( 0.008 ms): sudo/156867 write(fd: 8, buf: 0x55cb4cd2f650, count: 37)                          &#x3D; 37
    > 5.293 ( 0.010 ms): sudo/156867 write(fd: 8, buf: 0x55cb4cd2f650, count: 128)                         &#x3D; 128
    > 5.339 ( 0.009 ms): sudo/156867 write(fd: 8, buf: 0x55cb4cd2f650, count: 89)                          &#x3D; 89
    > 5.384 ( 0.008 ms): sudo/156867 write(fd: 8, buf: 0x55cb4cd2f650, count: 100)                         &#x3D; 100
    > [1]+  Done                    perf trace -e /tmp/augmented_raw_syscalls.o -e write* --max-events&#x3D;30
    > root@x1:/home/acme/git/perf-tools#
    > No events for the &#x27;perf trace&#x27; (pid 180632), i.e. no feedback loop.
    > If we leave it running:
    > root@x1:/home/acme/git/perf-tools# perf trace -e /tmp/augmented_raw_syscalls.o -e landlock_add_rule &amp;
    > [1] 181068
    > root@x1:/home/acme/git/perf-tools#
    > And then look at what maps it sets up:
    > root@x1:/home/acme/git/perf-tools# bpftool map | grep pids_filtered -A3
    > 1190: hash  name pids_filtered  flags 0x0
    > key 4B  value 1B  max_entries 64  memlock 7264B
    > btf_id 1613
    > pids perf(181068)
    > root@x1:/home/acme/git/perf-tools#
    > And ask for dumping its contents:
    > We see that we are _also_ setting it to filter those:
    > root@x1:/home/acme/git/perf-tools# bpftool map dump id 1190
    > [{
    > &quot;key&quot;: 181068,
    > &quot;value&quot;: 1
    > },{
    > &quot;key&quot;: 156801,
    > &quot;value&quot;: 1
    > }
    > ]
    > Now testing the migration commit:
    > perf $ git log
    > commit 5e6da6be3082f77be06894a1a94d52a90b4007dc (HEAD)
    > Author: Ian Rogers &lt;irogers@google.com&gt;
    > Date:   Thu Aug 10 11:48:51 2023 -0700
    > perf trace: Migrate BPF augmentation to use a skeleton
    > perf $ ./perf trace -e write --max-events&#x3D;10 &amp; echo #!
    > [1] 1808653
    > perf $
    > 0.000 ( 0.010 ms): :1808671/1808671 write(fd: 1, buf: 0x6003f5b26fc0, count: 11) &#x3D; 11
    > 0.162 (         ): perf/1808653 write(fd: 2, buf: 0x7fffc2174e50, count: 11)     ...
    > 0.174 (         ): perf/1808653 write(fd: 2, buf: 0x74ce21804563, count: 1)      ...
    > 0.184 (         ): perf/1808653 write(fd: 2, buf: 0x57b936589052, count: 5)
    > The feedback loop is there.
    > Keep it running, look into the bpf map:
    > perf $ bpftool map | grep pids_filtered
    > 10675: hash  name pids_filtered  flags 0x0
    > perf $ bpftool map dump id 10675
    > []
    > The map is empty.
    > Now, this commit:
    > 64917f4df048a064 (&quot;perf trace: Use heuristic when deciding if a syscall tracepoint &quot;const char *&quot; field is really a string&quot;)
    > Temporarily fixed the feedback loop for perf trace -e write, that&#x27;s
    > because before using the heuristic, write is hooked to sys_enter_openat:
    > perf $ git log
    > commit 83a0943b1870944612a8aa0049f910826ebfd4f7 (HEAD)
    > Author: Arnaldo Carvalho de Melo &lt;acme@redhat.com&gt;
    > Date:   Thu Aug 17 12:11:51 2023 -0300
    > perf trace: Use the augmented_raw_syscall BPF skel only for tracing syscalls
    > perf $ ./perf trace -e write --max-events&#x3D;10 -v 2&gt;&amp;1 | grep Reusing
    > Reusing &quot;openat&quot; BPF sys_enter augmenter for &quot;write&quot;
    > And after the heuristic fix, it&#x27;s unaugmented:
    > perf $ git log
    > commit 64917f4df048a0649ea7901c2321f020e71e6f24 (HEAD)
    > Author: Arnaldo Carvalho de Melo &lt;acme@redhat.com&gt;
    > Date:   Thu Aug 17 15:14:21 2023 -0300
    > perf trace: Use heuristic when deciding if a syscall tracepoint &quot;const char *&quot; field is really a string
    > perf $ ./perf trace -e write --max-events&#x3D;10 -v 2&gt;&amp;1 | grep Reusing
    > perf $
    > After using the heuristic, write is hooked to syscall_unaugmented, which
    > returns 1.
    > SEC(&quot;tp/raw_syscalls/sys_enter&quot;)
    > int syscall_unaugmented(struct syscall_enter_args *args)
    > {
    > return 1;
    > }
    > If the BPF program returns 1, the tracepoint filter will filter it
    > (since the tracepoint filter for perf is correctly set), but before the
    > heuristic, when it was hooked to a sys_enter_openat(), which is a BPF
    > program that calls bpf_perf_event_output() and writes to the buffer, it
    > didn&#x27;t get filtered, thus creating feedback loop. So switching write to
    > unaugmented accidentally fixed the problem.
    > But some syscalls are not so lucky, for example newfstatat:
    > perf $ ./perf trace -e newfstatat --max-events&#x3D;100 &amp; echo #!
    > [1] 2166948
    > 457.718 (         ): perf/2166948 newfstatat(dfd: CWD, filename: &quot;/proc/self/ns/mnt&quot;, statbuf: 0x7fff0132a9f0) ...
    > 457.749 (         ): perf/2166948 newfstatat(dfd: CWD, filename: &quot;/proc/2166950/ns/mnt&quot;, statbuf: 0x7fff0132aa80) ...
    > 457.962 (         ): perf/2166948 newfstatat(dfd: CWD, filename: &quot;/proc/self/ns/mnt&quot;, statbuf: 0x7fff0132a9f0) ...
    > Currently, write is augmented by the new BTF general augmenter (which
    > calls bpf_perf_event_output()). The problem, which luckily got fixed,
    > resurfaced, and that’s how it was discovered.
    > Fixes: 5e6da6be3082f77b (&quot;perf trace: Migrate BPF augmentation to use a skeleton&quot;)
    > Signed-off-by: Howard Chu &lt;howardchu95@gmail.com&gt;
    > Tested-by: Arnaldo Carvalho de Melo &lt;acme@redhat.com&gt;
    > Cc: Adrian Hunter &lt;adrian.hunter@intel.com&gt;
    > Cc: Alexander Shishkin &lt;alexander.shishkin@linux.intel.com&gt;
    > Cc: Ian Rogers &lt;irogers@google.com&gt;
    > Cc: Ingo Molnar &lt;mingo@redhat.com&gt;
    > Cc: James Clark &lt;james.clark@linaro.org&gt;
    > Cc: Jiri Olsa &lt;jolsa@kernel.org&gt;
    > Cc: Kan Liang &lt;kan.liang@linux.intel.com&gt;
    > Cc: Mark Rutland &lt;mark.rutland@arm.com&gt;
    > Cc: Namhyung Kim &lt;namhyung@kernel.org&gt;
    > Cc: Peter Zijlstra &lt;peterz@infradead.org&gt;
    > Link: https://lore.kernel.org/r/20241030052431.2220130-1-howardchu95@gmail.com
    > [ Check if trace-&gt;skel is non-NULL, as it is only initialized if trace-&gt;trace_syscalls is set ]
    > Signed-off-by: Arnaldo Carvalho de Melo &lt;acme@redhat.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ m68k: coldfire/device.c: only build FEC when HW macros are defined (@Antonio Quartulli in [fe1b4c7164695eb](https://github.com/sophgo/linux-riscv/commit/fe1b4c7164695eb) at 2024-12-05 13:02:24)
    > [ Upstream commit 63a24cf8cc330e5a68ebd2e20ae200096974c475 ]
    > When CONFIG_FEC is set (due to COMPILE_TEST) along with
    > CONFIG_M54xx, coldfire/device.c has compile errors due to
    > missing MCFEC_* and MCF_IRQ_FEC_* symbols.
    > Make the whole FEC blocks dependent on having the HW macros
    > defined, rather than on CONFIG_FEC itself.
    > This fix is very similar to commit e6e1e7b19fa1 (&quot;m68k: coldfire/device.c: only build for MCF_EDMA when h/w macros are defined&quot;)
    > Fixes: b7ce7f0d0efc (&quot;m68knommu: merge common ColdFire FEC platform setup code&quot;)
    > To: Greg Ungerer &lt;gerg@linux-m68k.org&gt;
    > To: Geert Uytterhoeven &lt;geert@linux-m68k.org&gt;
    > Cc: linux-m68k@lists.linux-m68k.org
    > Cc: linux-kernel@vger.kernel.org
    > Signed-off-by: Antonio Quartulli &lt;antonio@mandelbit.com&gt;
    > Signed-off-by: Greg Ungerer &lt;gerg@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ svcrdma: Address an integer overflow (@Chuck Lever in [e5c440c227ecdc7](https://github.com/sophgo/linux-riscv/commit/e5c440c227ecdc7) at 2024-12-05 13:02:24)
    > [ Upstream commit 3c63d8946e578663b868cb9912dac616ea68bfd0 ]
    > Dan Carpenter reports:
    > &gt; Commit 78147ca8b4a9 (&quot;svcrdma: Add a &quot;parsed chunk list&quot; data
    > &gt; structure&quot;) from Jun 22, 2020 (linux-next), leads to the following
    > &gt; Smatch static checker warning:
    > &gt;
    > &gt;	net/sunrpc/xprtrdma/svc_rdma_recvfrom.c:498 xdr_check_write_chunk()
    > &gt;	warn: potential user controlled sizeof overflow &#x27;segcount * 4 * 4&#x27;
    > &gt;
    > &gt; net/sunrpc/xprtrdma/svc_rdma_recvfrom.c
    > &gt;     488 static bool xdr_check_write_chunk(struct svc_rdma_recv_ctxt *rctxt)
    > &gt;     489 {
    > &gt;     490         u32 segcount;
    > &gt;     491         __be32 *p;
    > &gt;     492
    > &gt;     493         if (xdr_stream_decode_u32(&amp;rctxt-&gt;rc_stream, &amp;segcount))
    > &gt;                                                               ^^^^^^^^
    > &gt;
    > &gt;     494                 return false;
    > &gt;     495
    > &gt;     496         /* A bogus segcount causes this buffer overflow check to fail. */
    > &gt;     497         p &#x3D; xdr_inline_decode(&amp;rctxt-&gt;rc_stream,
    > &gt; --&gt; 498                               segcount * rpcrdma_segment_maxsz * sizeof(*p));
    > &gt;
    > &gt;
    > &gt; segcount is an untrusted u32.  On 32bit systems anything &gt;&#x3D; SIZE_MAX / 16 will
    > &gt; have an integer overflow and some those values will be accepted by
    > &gt; xdr_inline_decode().
    > Reported-by: Dan Carpenter &lt;dan.carpenter@linaro.org&gt;
    > Fixes: 78147ca8b4a9 (&quot;svcrdma: Add a &quot;parsed chunk list&quot; data structure&quot;)
    > Reviewed-by: Jeff Layton &lt;jlayton@kernel.org&gt;
    > Signed-off-by: Chuck Lever &lt;chuck.lever@oracle.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ m68k: mcfgpio: Fix incorrect register offset for CONFIG_M5441x (@Jean-Michel Hautbois in [d883be45ab314b0](https://github.com/sophgo/linux-riscv/commit/d883be45ab314b0) at 2024-12-05 13:02:24)
    > [ Upstream commit f212140962c93cd5da43283a18e31681540fc23d ]
    > Fix a typo in the CONFIG_M5441x preprocessor condition, where the GPIO
    > register offset was incorrectly set to 8 instead of 0. This prevented
    > proper GPIO configuration for m5441x targets.
    > Fixes: bea8bcb12da0 (&quot;m68knommu: Add support for the Coldfire m5441x.&quot;)
    > Signed-off-by: Jean-Michel Hautbois &lt;jeanmichel.hautbois@yoseli.org&gt;
    > Signed-off-by: Greg Ungerer &lt;gerg@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ perf list: Fix topic and pmu_name argument order (@Jean-Philippe Romain in [d1089acab6852d6](https://github.com/sophgo/linux-riscv/commit/d1089acab6852d6) at 2024-12-05 13:02:24)
    > [ Upstream commit d99b3125726aade4f5ec4aae04805134ab4b0abd ]
    > Fix function definitions to match header file declaration. Fix two
    > callers to pass the arguments in the right order.
    > On Intel Tigerlake, before:
    > &#x60;&#x60;&#x60;
    > $ perf list -j|grep &quot;\&quot;Topic\&quot;&quot;|sort|uniq
    > &quot;Topic&quot;: &quot;cache&quot;,
    > &quot;Topic&quot;: &quot;cpu&quot;,
    > &quot;Topic&quot;: &quot;floating point&quot;,
    > &quot;Topic&quot;: &quot;frontend&quot;,
    > &quot;Topic&quot;: &quot;memory&quot;,
    > &quot;Topic&quot;: &quot;other&quot;,
    > &quot;Topic&quot;: &quot;pfm icl&quot;,
    > &quot;Topic&quot;: &quot;pfm ix86arch&quot;,
    > &quot;Topic&quot;: &quot;pfm perf_raw&quot;,
    > &quot;Topic&quot;: &quot;pipeline&quot;,
    > &quot;Topic&quot;: &quot;tool&quot;,
    > &quot;Topic&quot;: &quot;uncore interconnect&quot;,
    > &quot;Topic&quot;: &quot;uncore memory&quot;,
    > &quot;Topic&quot;: &quot;uncore other&quot;,
    > &quot;Topic&quot;: &quot;virtual memory&quot;,
    > $ perf list -j|grep &quot;\&quot;Unit\&quot;&quot;|sort|uniq
    > &quot;Unit&quot;: &quot;cache&quot;,
    > &quot;Unit&quot;: &quot;cpu&quot;,
    > &quot;Unit&quot;: &quot;cstate_core&quot;,
    > &quot;Unit&quot;: &quot;cstate_pkg&quot;,
    > &quot;Unit&quot;: &quot;i915&quot;,
    > &quot;Unit&quot;: &quot;icl&quot;,
    > &quot;Unit&quot;: &quot;intel_bts&quot;,
    > &quot;Unit&quot;: &quot;intel_pt&quot;,
    > &quot;Unit&quot;: &quot;ix86arch&quot;,
    > &quot;Unit&quot;: &quot;msr&quot;,
    > &quot;Unit&quot;: &quot;perf_raw&quot;,
    > &quot;Unit&quot;: &quot;power&quot;,
    > &quot;Unit&quot;: &quot;tool&quot;,
    > &quot;Unit&quot;: &quot;uncore_arb&quot;,
    > &quot;Unit&quot;: &quot;uncore_clock&quot;,
    > &quot;Unit&quot;: &quot;uncore_imc_free_running_0&quot;,
    > &quot;Unit&quot;: &quot;uncore_imc_free_running_1&quot;,
    > &#x60;&#x60;&#x60;
    > After:
    > &#x60;&#x60;&#x60;
    > $ perf list -j|grep &quot;\&quot;Topic\&quot;&quot;|sort|uniq
    > &quot;Topic&quot;: &quot;cache&quot;,
    > &quot;Topic&quot;: &quot;floating point&quot;,
    > &quot;Topic&quot;: &quot;frontend&quot;,
    > &quot;Topic&quot;: &quot;memory&quot;,
    > &quot;Topic&quot;: &quot;other&quot;,
    > &quot;Topic&quot;: &quot;pfm icl&quot;,
    > &quot;Topic&quot;: &quot;pfm ix86arch&quot;,
    > &quot;Topic&quot;: &quot;pfm perf_raw&quot;,
    > &quot;Topic&quot;: &quot;pipeline&quot;,
    > &quot;Topic&quot;: &quot;tool&quot;,
    > &quot;Topic&quot;: &quot;uncore interconnect&quot;,
    > &quot;Topic&quot;: &quot;uncore memory&quot;,
    > &quot;Topic&quot;: &quot;uncore other&quot;,
    > &quot;Topic&quot;: &quot;virtual memory&quot;,
    > $ perf list -j|grep &quot;\&quot;Unit\&quot;&quot;|sort|uniq
    > &quot;Unit&quot;: &quot;cpu&quot;,
    > &quot;Unit&quot;: &quot;cstate_core&quot;,
    > &quot;Unit&quot;: &quot;cstate_pkg&quot;,
    > &quot;Unit&quot;: &quot;i915&quot;,
    > &quot;Unit&quot;: &quot;icl&quot;,
    > &quot;Unit&quot;: &quot;intel_bts&quot;,
    > &quot;Unit&quot;: &quot;intel_pt&quot;,
    > &quot;Unit&quot;: &quot;ix86arch&quot;,
    > &quot;Unit&quot;: &quot;msr&quot;,
    > &quot;Unit&quot;: &quot;perf_raw&quot;,
    > &quot;Unit&quot;: &quot;power&quot;,
    > &quot;Unit&quot;: &quot;tool&quot;,
    > &quot;Unit&quot;: &quot;uncore_arb&quot;,
    > &quot;Unit&quot;: &quot;uncore_clock&quot;,
    > &quot;Unit&quot;: &quot;uncore_imc_free_running_0&quot;,
    > &quot;Unit&quot;: &quot;uncore_imc_free_running_1&quot;,
    > &#x60;&#x60;&#x60;
    > Fixes: e5c6109f4813246a (&quot;perf list: Reorganize to use callbacks to allow honouring command line options&quot;)
    > Reviewed-by: Kan Liang &lt;kan.liang@linux.intel.com&gt;
    > Signed-off-by: Jean-Philippe Romain &lt;jean-philippe.romain@foss.st.com&gt;
    > Tested-by: Ian Rogers &lt;irogers@google.com&gt;
    > Cc: Adrian Hunter &lt;adrian.hunter@intel.com&gt;
    > Cc: Alexander Shishkin &lt;alexander.shishkin@linux.intel.com&gt;
    > Cc: Ingo Molnar &lt;mingo@redhat.com&gt;
    > Cc: Jiri Olsa &lt;jolsa@kernel.org&gt;
    > Cc: Junhao He &lt;hejunhao3@huawei.com&gt;
    > Cc: Mark Rutland &lt;mark.rutland@arm.com&gt;
    > Cc: Namhyung Kim &lt;namhyung@kernel.org&gt;
    > Cc: Peter Zijlstra &lt;peterz@infradead.org&gt;
    > Link: https://lore.kernel.org/r/20241109025801.560378-1-irogers@google.com
    > [ I fixed the two callers and added it to Jean-Phillippe&#x27;s original change. ]
    > Signed-off-by: Ian Rogers &lt;irogers@google.com&gt;
    > Signed-off-by: Arnaldo Carvalho de Melo &lt;acme@redhat.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ perf trace: avoid garbage when not printing a trace event&#x27;s arguments (@Benjamin Peterson in [660ea0db314df4d](https://github.com/sophgo/linux-riscv/commit/660ea0db314df4d) at 2024-12-05 13:02:24)
    > [ Upstream commit 5fb8e56542a3cf469fdf25d77f50e21cbff3ae7e ]
    > trace__fprintf_tp_fields may not print any tracepoint arguments. E.g., if the
    > argument values are all zero. Previously, this would result in a totally
    > uninitialized buffer being passed to fprintf, which could lead to garbage on the
    > console. Fix the problem by passing the number of initialized bytes fprintf.
    > Fixes: f11b2803bb88 (&quot;perf trace: Allow choosing how to augment the tracepoint arguments&quot;)
    > Signed-off-by: Benjamin Peterson &lt;benjamin@engflow.com&gt;
    > Tested-by: Howard Chu &lt;howardchu95@gmail.com&gt;
    > Tested-by: Arnaldo Carvalho de Melo &lt;acme@redhat.com&gt;
    > Link: https://lore.kernel.org/r/20241103204816.7834-1-benjamin@engflow.com
    > Signed-off-by: Namhyung Kim &lt;namhyung@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ nfsd: drop inode parameter from nfsd4_change_attribute() (@Jeff Layton in [38795ff45c4d62f](https://github.com/sophgo/linux-riscv/commit/38795ff45c4d62f) at 2024-12-05 13:02:24)
    > [ Upstream commit f67eef8da0e8c54709fefdecd16ad8d70f0c9d20 ]
    > The inode that nfs4_open_delegation() passes to this function is
    > wrong, which throws off the result. The inode will end up getting a
    > directory-style change attr instead of a regular-file-style one.
    > Fix up nfs4_delegation_stat() to fetch STATX_MODE, and then drop the
    > inode parameter from nfsd4_change_attribute(), since it&#x27;s no longer
    > needed.
    > Fixes: c5967721e106 (&quot;NFSD: handle GETATTR conflict with write delegation&quot;)
    > Signed-off-by: Jeff Layton &lt;jlayton@kernel.org&gt;
    > Signed-off-by: Chuck Lever &lt;chuck.lever@oracle.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ f2fs: fix race in concurrent f2fs_stop_gc_thread (@Long Li in [c631207897a9b3d](https://github.com/sophgo/linux-riscv/commit/c631207897a9b3d) at 2024-12-05 13:02:23)
    > [ Upstream commit 7b0033dbc48340a1c1c3f12448ba17d6587ca092 ]
    > In my test case, concurrent calls to f2fs shutdown report the following
    > stack trace:
    > Oops: general protection fault, probably for non-canonical address 0xc6cfff63bb5513fc: 0000 [#1] PREEMPT SMP PTI
    > CPU: 0 UID: 0 PID: 678 Comm: f2fs_rep_shutdo Not tainted 6.12.0-rc5-next-20241029-g6fb2fa9805c5-dirty #85
    > Call Trace:
    > &lt;TASK&gt;
    > ? show_regs+0x8b/0xa0
    > ? __die_body+0x26/0xa0
    > ? die_addr+0x54/0x90
    > ? exc_general_protection+0x24b/0x5c0
    > ? asm_exc_general_protection+0x26/0x30
    > ? kthread_stop+0x46/0x390
    > f2fs_stop_gc_thread+0x6c/0x110
    > f2fs_do_shutdown+0x309/0x3a0
    > f2fs_ioc_shutdown+0x150/0x1c0
    > __f2fs_ioctl+0xffd/0x2ac0
    > f2fs_ioctl+0x76/0xe0
    > vfs_ioctl+0x23/0x60
    > __x64_sys_ioctl+0xce/0xf0
    > x64_sys_call+0x2b1b/0x4540
    > do_syscall_64+0xa7/0x240
    > entry_SYSCALL_64_after_hwframe+0x76/0x7e
    > The root cause is a race condition in f2fs_stop_gc_thread() called from
    > different f2fs shutdown paths:
    > [CPU0]                       [CPU1]
    > ----------------------       -----------------------
    > f2fs_stop_gc_thread          f2fs_stop_gc_thread
    > gc_th &#x3D; sbi-&gt;gc_thread
    > gc_th &#x3D; sbi-&gt;gc_thread
    > kfree(gc_th)
    > sbi-&gt;gc_thread &#x3D; NULL
    > &lt; gc_th !&#x3D; NULL &gt;
    > kthread_stop(gc_th-&gt;f2fs_gc_task) //UAF
    > The commit c7f114d864ac (&quot;f2fs: fix to avoid use-after-free in
    > f2fs_stop_gc_thread()&quot;) attempted to fix this issue by using a read
    > semaphore to prevent races between shutdown and remount threads, but
    > it fails to prevent all race conditions.
    > Fix it by converting to write lock of s_umount in f2fs_do_shutdown().
    > Fixes: 7950e9ac638e (&quot;f2fs: stop gc/discard thread after fs shutdown&quot;)
    > Signed-off-by: Long Li &lt;leo.lilong@huawei.com&gt;
    > Reviewed-by: Chao Yu &lt;chao@kernel.org&gt;
    > Signed-off-by: Jaegeuk Kim &lt;jaegeuk@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ f2fs: fix to avoid forcing direct write to use buffered IO on inline_data inode (@Chao Yu in [bbe48e47b978558](https://github.com/sophgo/linux-riscv/commit/bbe48e47b978558) at 2024-12-05 13:02:23)
    > [ Upstream commit 26e6f59d0bbaac76fa3413462d780bd2b5f9f653 ]
    > Jinsu Lee reported a performance regression issue, after commit
    > 5c8764f8679e (&quot;f2fs: fix to force buffered IO on inline_data
    > inode&quot;), we forced direct write to use buffered IO on inline_data
    > inode, it will cause performace regression due to memory copy
    > and data flush.
    > It&#x27;s fine to not force direct write to use buffered IO, as it
    > can convert inline inode before committing direct write IO.
    > Fixes: 5c8764f8679e (&quot;f2fs: fix to force buffered IO on inline_data inode&quot;)
    > Reported-by: Jinsu Lee &lt;jinsu1.lee@samsung.com&gt;
    > Closes: https://lore.kernel.org/linux-f2fs-devel/af03dd2c-e361-4f80-b2fd-39440766cf6e@kernel.org
    > Signed-off-by: Chao Yu &lt;chao@kernel.org&gt;
    > Signed-off-by: Jaegeuk Kim &lt;jaegeuk@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ f2fs: fix to map blocks correctly for direct write (@Chao Yu in [a10cc033b27685f](https://github.com/sophgo/linux-riscv/commit/a10cc033b27685f) at 2024-12-05 13:02:23)
    > [ Upstream commit 5dd00ebda337b9295e7027691fa70540da369ff2 ]
    > f2fs_map_blocks() supports to map continuous holes or preallocated
    > address, we should avoid setting F2FS_MAP_MAPPED for these cases
    > only, otherwise, it may fail f2fs_iomap_begin(), and make direct
    > write fallbacking to use buffered IO and flush, result in performance
    > regression.
    > Fixes: 9f0f6bf42714 (&quot;f2fs: support to map continuous holes or preallocated address&quot;)
    > Reported-by: kernel test robot &lt;oliver.sang@intel.com&gt;
    > Closes: https://lore.kernel.org/oe-lkp/202409122103.e45aa13b-oliver.sang@intel.com
    > Cc: Cyril Hrubis &lt;chrubis@suse.cz&gt;
    > Signed-off-by: Chao Yu &lt;chao@kernel.org&gt;
    > Signed-off-by: Jaegeuk Kim &lt;jaegeuk@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ PCI: tegra194: Move controller cleanups to pex_ep_event_pex_rst_deassert() (@Manivannan Sadhasivam in [72034050ccf4202](https://github.com/sophgo/linux-riscv/commit/72034050ccf4202) at 2024-12-05 13:02:23)
    > [ Upstream commit 40e2125381dc11379112485e3eefdd25c6df5375 ]
    > Currently, the endpoint cleanup function dw_pcie_ep_cleanup() and EPF
    > deinit notify function pci_epc_deinit_notify() are called during the
    > execution of pex_ep_event_pex_rst_assert() i.e., when the host has asserted
    > PERST#. But quickly after this step, refclk will also be disabled by the
    > host.
    > All of the tegra194 endpoint SoCs supported as of now depend on the refclk
    > from the host for keeping the controller operational. Due to this
    > limitation, any access to the hardware registers in the absence of refclk
    > will result in a whole endpoint crash. Unfortunately, most of the
    > controller cleanups require accessing the hardware registers (like eDMA
    > cleanup performed in dw_pcie_ep_cleanup(), etc...). So these cleanup
    > functions can cause the crash in the endpoint SoC once host asserts PERST#.
    > One way to address this issue is by generating the refclk in the endpoint
    > itself and not depending on the host. But that is not always possible as
    > some of the endpoint designs do require the endpoint to consume refclk from
    > the host.
    > Thus, fix this crash by moving the controller cleanups to the start of
    > the pex_ep_event_pex_rst_deassert() function. This function is called
    > whenever the host has deasserted PERST# and it is guaranteed that the
    > refclk would be active at this point. So at the start of this function
    > (after enabling resources) the controller cleanup can be performed. Once
    > finished, rest of the code execution for PERST# deassert can continue as
    > usual.
    > Fixes: 473b2cf9c4d1 (&quot;PCI: endpoint: Introduce &#x27;epc_deinit&#x27; event and notify the EPF drivers&quot;)
    > Fixes: 570d7715eed8 (&quot;PCI: dwc: ep: Introduce dw_pcie_ep_cleanup() API for drivers supporting PERST#&quot;)
    > Link: https://lore.kernel.org/r/20240817-pci-qcom-ep-cleanup-v1-2-d6b958226559@linaro.org
    > Signed-off-by: Manivannan Sadhasivam &lt;manivannan.sadhasivam@linaro.org&gt;
    > Signed-off-by: Krzysztof Wilczyński &lt;kwilczynski@kernel.org&gt;
    > Cc: Jonathan Hunter &lt;jonathanh@nvidia.com&gt;
    > Cc: Thierry Reding &lt;thierry.reding@gmail.com&gt;
    > Cc: Vidya Sagar &lt;vidyas@nvidia.com&gt;
    > Cc: linux-tegra@vger.kernel.org
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ PCI: qcom-ep: Move controller cleanups to qcom_pcie_perst_deassert() (@Manivannan Sadhasivam in [516969d5765e230](https://github.com/sophgo/linux-riscv/commit/516969d5765e230) at 2024-12-05 13:02:23)
    > [ Upstream commit 7d7cf89b119af433354f865fc01017b9f8aa411a ]
    > Currently, the endpoint cleanup function dw_pcie_ep_cleanup() and EPF
    > deinit notify function pci_epc_deinit_notify() are called during the
    > execution of qcom_pcie_perst_assert() i.e., when the host has asserted
    > PERST#. But quickly after this step, refclk will also be disabled by the
    > host.
    > All of the Qcom endpoint SoCs supported as of now depend on the refclk from
    > the host for keeping the controller operational. Due to this limitation,
    > any access to the hardware registers in the absence of refclk will result
    > in a whole endpoint crash. Unfortunately, most of the controller cleanups
    > require accessing the hardware registers (like eDMA cleanup performed in
    > dw_pcie_ep_cleanup(), powering down MHI EPF etc...). So these cleanup
    > functions are currently causing the crash in the endpoint SoC once host
    > asserts PERST#.
    > One way to address this issue is by generating the refclk in the endpoint
    > itself and not depending on the host. But that is not always possible as
    > some of the endpoint designs do require the endpoint to consume refclk from
    > the host (as I was told by the Qcom engineers).
    > Thus, fix this crash by moving the controller cleanups to the start of
    > the qcom_pcie_perst_deassert() function. qcom_pcie_perst_deassert() is
    > called whenever the host has deasserted PERST# and it is guaranteed that
    > the refclk would be active at this point. So at the start of this function
    > (after enabling resources), the controller cleanup can be performed. Once
    > finished, rest of the code execution for PERST# deassert can continue as
    > usual.
    > Fixes: 473b2cf9c4d1 (&quot;PCI: endpoint: Introduce &#x27;epc_deinit&#x27; event and notify the EPF drivers&quot;)
    > Fixes: 570d7715eed8 (&quot;PCI: dwc: ep: Introduce dw_pcie_ep_cleanup() API for drivers supporting PERST#&quot;)
    > Link: https://lore.kernel.org/r/20240817-pci-qcom-ep-cleanup-v1-1-d6b958226559@linaro.org
    > Signed-off-by: Manivannan Sadhasivam &lt;manivannan.sadhasivam@linaro.org&gt;
    > Signed-off-by: Krzysztof Wilczyński &lt;kwilczynski@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ perf build: Add missing cflags when building with custom libtraceevent (@Yicong Yang in [0f296a347a106f1](https://github.com/sophgo/linux-riscv/commit/0f296a347a106f1) at 2024-12-05 13:02:23)
    > [ Upstream commit d5a0a4ab4af4c27de097b78d6f1b7e7f7e31908f ]
    > When building with custom libtraceevent, below errors occur:
    > $ make -C tools/perf NO_LIBPYTHON&#x3D;1 PKG_CONFIG_PATH&#x3D;&lt;custom libtraceevent&gt;
    > In file included from util/session.h:5,
    > from builtin-buildid-list.c:17:
    > util/trace-event.h:153:10: fatal error: traceevent/event-parse.h: No such file or directory
    > 153 | #include &lt;traceevent/event-parse.h&gt;
    > |          ^~~~~~~~~~~~~~~~~~~~~~~~~~
    > &lt;snip similar errors of missing headers&gt;
    > This is because the include path is missed in the cflags. Add it.
    > Fixes: 0f0e1f445690 (&quot;perf build: Use pkg-config for feature check for libtrace{event,fs}&quot;)
    > Signed-off-by: Yicong Yang &lt;yangyicong@hisilicon.com&gt;
    > Reviewed-by: Leo Yan &lt;leo.yan@arm.com&gt;
    > Reviewed-by: Guilherme Amadio &lt;amadio@gentoo.org&gt;
    > Cc: linuxarm@huawei.com
    > Link: https://lore.kernel.org/r/20241024133236.31016-1-yangyicong@huawei.com
    > Signed-off-by: Namhyung Kim &lt;namhyung@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ PCI: j721e: Deassert PERST# after a delay of PCIE_T_PVPERL_MS milliseconds (@Siddharth Vadapalli in [0c4612370c52205](https://github.com/sophgo/linux-riscv/commit/0c4612370c52205) at 2024-12-05 13:02:23)
    > [ Upstream commit 22a9120479a40a56c13c5e473a0100fad2e017c0 ]
    > According to Section 2.2 of the PCI Express Card Electromechanical
    > Specification (Revision 5.1), in order to ensure that the power and the
    > reference clock are stable, PERST# has to be deasserted after a delay of
    > 100 milliseconds (TPVPERL).
    > Currently, it is being assumed that the power is already stable, which
    > is not necessarily true.
    > Hence, change the delay to PCIE_T_PVPERL_MS to guarantee that power and
    > reference clock are stable.
    > Fixes: f3e25911a430 (&quot;PCI: j721e: Add TI J721E PCIe driver&quot;)
    > Fixes: f96b69713733 (&quot;PCI: j721e: Use T_PERST_CLK_US macro&quot;)
    > Link: https://lore.kernel.org/r/20241104074420.1862932-1-s-vadapalli@ti.com
    > Signed-off-by: Siddharth Vadapalli &lt;s-vadapalli@ti.com&gt;
    > Signed-off-by: Krzysztof Wilczyński &lt;kwilczynski@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ i3c: master: Remove i3c_dev_disable_ibi_locked(olddev) on device hotjoin (@Frank Li in [c31c7b81c1d8f57](https://github.com/sophgo/linux-riscv/commit/c31c7b81c1d8f57) at 2024-12-05 13:02:22)
    > [ Upstream commit 36faa04ce3d9c962b4b29d285ad07ca29e2988e4 ]
    > When a new device hotjoins, a new dynamic address is assigned.
    > i3c_master_add_i3c_dev_locked() identifies that the device was previously
    > attached to the bus and locates the olddev.
    > i3c_master_add_i3c_dev_locked()
    > {
    > ...
    > olddev &#x3D; i3c_master_search_i3c_dev_duplicate(newdev);
    > ...
    > if (olddev) {
    > ...
    > i3c_dev_disable_ibi_locked(olddev);
    > ^^^^^^
    > The olddev should not receive any commands on the i3c bus as it
    > does not exist and has been assigned a new address. This will
    > result in NACK or timeout. So remove it.
    > }
    > i3c_dev_free_ibi_locked(olddev);
    > ^^^^^^^^
    > This function internally calls i3c_dev_disable_ibi_locked() function
    > causing to send DISEC command with old Address.
    > The olddev should not receive any commands on the i3c bus as it
    > does not exist and has been assigned a new address. This will
    > result in NACK or timeout. So, update the olddev-&gt;ibi-&gt;enabled
    > flag to false to avoid DISEC with OldAddr.
    > }
    > Include part of Ravindra Yashvant Shinde&#x27;s work:
    > https://lore.kernel.org/linux-i3c/20240820151917.3904956-1-ravindra.yashvant.shinde@nxp.com/T/#u
    > Fixes: 317bacf960a4 (&quot;i3c: master: add enable(disable) hot join in sys entry&quot;)
    > Co-developed-by: Ravindra Yashvant Shinde &lt;ravindra.yashvant.shinde@nxp.com&gt;
    > Signed-off-by: Ravindra Yashvant Shinde &lt;ravindra.yashvant.shinde@nxp.com&gt;
    > Reviewed-by: Miquel Raynal &lt;miquel.raynal@bootlin.com&gt;
    > Signed-off-by: Frank Li &lt;Frank.Li@nxp.com&gt;
    > Link: https://lore.kernel.org/r/20241001162232.223724-1-Frank.Li@nxp.com
    > Signed-off-by: Alexandre Belloni &lt;alexandre.belloni@bootlin.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ f2fs: check curseg-&gt;inited before write_sum_page in change_curseg (@Yongpeng Yang in [abfd2c13ba9c2d1](https://github.com/sophgo/linux-riscv/commit/abfd2c13ba9c2d1) at 2024-12-05 13:02:22)
    > [ Upstream commit 43563069e1c1df417d2eed6eca8a22fc6b04691d ]
    > In the __f2fs_init_atgc_curseg-&gt;get_atssr_segment calling,
    > curseg-&gt;segno is NULL_SEGNO, indicating that there is no summary
    > block that needs to be written.
    > Fixes: 093749e296e2 (&quot;f2fs: support age threshold based garbage collection&quot;)
    > Signed-off-by: Yongpeng Yang &lt;yangyongpeng1@oppo.com&gt;
    > Reviewed-by: Chao Yu &lt;chao@kernel.org&gt;
    > Signed-off-by: Jaegeuk Kim &lt;jaegeuk@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ PCI: qcom: Enable MSI interrupts together with Link up if &#x27;Global IRQ&#x27; is supported (@Manivannan Sadhasivam in [a16e6f79665aa95](https://github.com/sophgo/linux-riscv/commit/a16e6f79665aa95) at 2024-12-05 13:02:22)
    > [ Upstream commit ba4a2e2317b9faeca9193ed6d3193ddc3cf2aba3 ]
    > Currently, if &#x27;Global IRQ&#x27; is supported by the platform, only the Link up
    > interrupt is enabled in the PARF_INT_ALL_MASK register. This masks MSIs
    > on some platforms. The MSI bits in PARF_INT_ALL_MASK register are enabled
    > by default in the hardware, but commit 4581403f6792 (&quot;PCI: qcom: Enumerate
    > endpoints based on Link up event in &#x27;global_irq&#x27; interrupt&quot;) disabled them
    > and enabled only the Link up interrupt. While MSI continued to work on the
    > SM8450 platform that was used to test the offending commit, on other
    > platforms like SM8250, X1E80100, MSIs are getting masked. And they require
    > enabling the MSI interrupt bits in the register to unmask (enable) the
    > MSIs.
    > Even though the MSI interrupt enable bits in PARF_INT_ALL_MASK are
    > described as &#x27;diagnostic&#x27; interrupts in the internal documentation,
    > disabling them masks MSI on these platforms. Due to this, MSIs were not
    > reported to be received these platforms while supporting &#x27;Global IRQ&#x27;.
    > So, enable the MSI interrupts along with the Link up interrupt in the
    > PARF_INT_ALL_MASK register if &#x27;Global IRQ&#x27; is supported. This ensures that
    > the MSIs continue to work and also the driver is able to catch the Link
    > up interrupt for enumerating endpoint devices.
    > Fixes: 4581403f6792 (&quot;PCI: qcom: Enumerate endpoints based on Link up event in &#x27;global_irq&#x27; interrupt&quot;)
    > Closes: https://lore.kernel.org/linux-pci/9a692c98-eb0a-4d86-b642-ea655981ff53@kernel.org/
    > Link: https://lore.kernel.org/r/20241007051255.4378-1-manivannan.sadhasivam@linaro.org
    > Reported-by: Konrad Dybcio &lt;konradybcio@kernel.org&gt;
    > Tested-by: Konrad Dybcio &lt;konrad.dybcio@oss.qualcomm.com&gt; # SL7
    > Signed-off-by: Manivannan Sadhasivam &lt;manivannan.sadhasivam@linaro.org&gt;
    > Signed-off-by: Krzysztof Wilczyński &lt;kwilczynski@kernel.org&gt;
    > Reviewed-by: Qiang Yu &lt;quic_qianyu@quicinc.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ f2fs: fix the wrong f2fs_bug_on condition in f2fs_do_replace_block (@LongPing Wei in [9b57a3f7e3d3878](https://github.com/sophgo/linux-riscv/commit/9b57a3f7e3d3878) at 2024-12-05 13:02:22)
    > [ Upstream commit c3af1f13476ec23fd99c98d060a89be28c1e8871 ]
    > This f2fs_bug_on was introduced by commit 2c1905042c8c (&quot;f2fs: check
    > segment type in __f2fs_replace_block&quot;) when there were only 6 curseg types.
    > After commit d0b9e42ab615 (&quot;f2fs: introduce inmem curseg&quot;) was introduced,
    > the condition should be changed to checking curseg-&gt;seg_type.
    > Fixes: d0b9e42ab615 (&quot;f2fs: introduce inmem curseg&quot;)
    > Signed-off-by: LongPing Wei &lt;weilongping@oppo.com&gt;
    > Reviewed-by: Chao Yu &lt;chao@kernel.org&gt;
    > Signed-off-by: Jaegeuk Kim &lt;jaegeuk@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ f2fs: fix to avoid potential deadlock in f2fs_record_stop_reason() (@Chao Yu in [801092a2c9c251e](https://github.com/sophgo/linux-riscv/commit/801092a2c9c251e) at 2024-12-05 13:02:22)
    > [ Upstream commit f10a890308a7cd8794e21f646f09827c6cb4bf5d ]
    > syzbot reports deadlock issue of f2fs as below:
    > &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;
    > WARNING: possible circular locking dependency detected
    > 6.12.0-rc3-syzkaller-00087-gc964ced77262 #0 Not tainted
    > ------------------------------------------------------
    > kswapd0/79 is trying to acquire lock:
    > ffff888011824088 (&amp;sbi-&gt;sb_lock){++++}-{3:3}, at: f2fs_down_write fs/f2fs/f2fs.h:2199 [inline]
    > ffff888011824088 (&amp;sbi-&gt;sb_lock){++++}-{3:3}, at: f2fs_record_stop_reason+0x52/0x1d0 fs/f2fs/super.c:4068
    > but task is already holding lock:
    > ffff88804bd92610 (sb_internal#2){.+.+}-{0:0}, at: f2fs_evict_inode+0x662/0x15c0 fs/f2fs/inode.c:842
    > which lock already depends on the new lock.
    > the existing dependency chain (in reverse order) is:
    > -&gt; #2 (sb_internal#2){.+.+}-{0:0}:
    > lock_acquire+0x1ed/0x550 kernel/locking/lockdep.c:5825
    > percpu_down_read include/linux/percpu-rwsem.h:51 [inline]
    > __sb_start_write include/linux/fs.h:1716 [inline]
    > sb_start_intwrite+0x4d/0x1c0 include/linux/fs.h:1899
    > f2fs_evict_inode+0x662/0x15c0 fs/f2fs/inode.c:842
    > evict+0x4e8/0x9b0 fs/inode.c:725
    > f2fs_evict_inode+0x1a4/0x15c0 fs/f2fs/inode.c:807
    > evict+0x4e8/0x9b0 fs/inode.c:725
    > dispose_list fs/inode.c:774 [inline]
    > prune_icache_sb+0x239/0x2f0 fs/inode.c:963
    > super_cache_scan+0x38c/0x4b0 fs/super.c:223
    > do_shrink_slab+0x701/0x1160 mm/shrinker.c:435
    > shrink_slab+0x1093/0x14d0 mm/shrinker.c:662
    > shrink_one+0x43b/0x850 mm/vmscan.c:4818
    > shrink_many mm/vmscan.c:4879 [inline]
    > lru_gen_shrink_node mm/vmscan.c:4957 [inline]
    > shrink_node+0x3799/0x3de0 mm/vmscan.c:5937
    > kswapd_shrink_node mm/vmscan.c:6765 [inline]
    > balance_pgdat mm/vmscan.c:6957 [inline]
    > kswapd+0x1ca3/0x3700 mm/vmscan.c:7226
    > kthread+0x2f0/0x390 kernel/kthread.c:389
    > ret_from_fork+0x4b/0x80 arch/x86/kernel/process.c:147
    > ret_from_fork_asm+0x1a/0x30 arch/x86/entry/entry_64.S:244
    > -&gt; #1 (fs_reclaim){+.+.}-{0:0}:
    > lock_acquire+0x1ed/0x550 kernel/locking/lockdep.c:5825
    > __fs_reclaim_acquire mm/page_alloc.c:3834 [inline]
    > fs_reclaim_acquire+0x88/0x130 mm/page_alloc.c:3848
    > might_alloc include/linux/sched/mm.h:318 [inline]
    > prepare_alloc_pages+0x147/0x5b0 mm/page_alloc.c:4493
    > __alloc_pages_noprof+0x16f/0x710 mm/page_alloc.c:4722
    > alloc_pages_mpol_noprof+0x3e8/0x680 mm/mempolicy.c:2265
    > alloc_pages_noprof mm/mempolicy.c:2345 [inline]
    > folio_alloc_noprof+0x128/0x180 mm/mempolicy.c:2352
    > filemap_alloc_folio_noprof+0xdf/0x500 mm/filemap.c:1010
    > do_read_cache_folio+0x2eb/0x850 mm/filemap.c:3787
    > read_mapping_folio include/linux/pagemap.h:1011 [inline]
    > f2fs_commit_super+0x3c0/0x7d0 fs/f2fs/super.c:4032
    > f2fs_record_stop_reason+0x13b/0x1d0 fs/f2fs/super.c:4079
    > f2fs_handle_critical_error+0x2ac/0x5c0 fs/f2fs/super.c:4174
    > f2fs_write_inode+0x35f/0x4d0 fs/f2fs/inode.c:785
    > write_inode fs/fs-writeback.c:1503 [inline]
    > __writeback_single_inode+0x711/0x10d0 fs/fs-writeback.c:1723
    > writeback_single_inode+0x1f3/0x660 fs/fs-writeback.c:1779
    > sync_inode_metadata+0xc4/0x120 fs/fs-writeback.c:2849
    > f2fs_release_file+0xa8/0x100 fs/f2fs/file.c:1941
    > __fput+0x23f/0x880 fs/file_table.c:431
    > task_work_run+0x24f/0x310 kernel/task_work.c:228
    > resume_user_mode_work include/linux/resume_user_mode.h:50 [inline]
    > exit_to_user_mode_loop kernel/entry/common.c:114 [inline]
    > exit_to_user_mode_prepare include/linux/entry-common.h:328 [inline]
    > __syscall_exit_to_user_mode_work kernel/entry/common.c:207 [inline]
    > syscall_exit_to_user_mode+0x168/0x370 kernel/entry/common.c:218
    > do_syscall_64+0x100/0x230 arch/x86/entry/common.c:89
    > entry_SYSCALL_64_after_hwframe+0x77/0x7f
    > -&gt; #0 (&amp;sbi-&gt;sb_lock){++++}-{3:3}:
    > check_prev_add kernel/locking/lockdep.c:3161 [inline]
    > check_prevs_add kernel/locking/lockdep.c:3280 [inline]
    > validate_chain+0x18ef/0x5920 kernel/locking/lockdep.c:3904
    > __lock_acquire+0x1384/0x2050 kernel/locking/lockdep.c:5202
    > lock_acquire+0x1ed/0x550 kernel/locking/lockdep.c:5825
    > down_write+0x99/0x220 kernel/locking/rwsem.c:1577
    > f2fs_down_write fs/f2fs/f2fs.h:2199 [inline]
    > f2fs_record_stop_reason+0x52/0x1d0 fs/f2fs/super.c:4068
    > f2fs_handle_critical_error+0x2ac/0x5c0 fs/f2fs/super.c:4174
    > f2fs_evict_inode+0xa61/0x15c0 fs/f2fs/inode.c:883
    > evict+0x4e8/0x9b0 fs/inode.c:725
    > f2fs_evict_inode+0x1a4/0x15c0 fs/f2fs/inode.c:807
    > evict+0x4e8/0x9b0 fs/inode.c:725
    > dispose_list fs/inode.c:774 [inline]
    > prune_icache_sb+0x239/0x2f0 fs/inode.c:963
    > super_cache_scan+0x38c/0x4b0 fs/super.c:223
    > do_shrink_slab+0x701/0x1160 mm/shrinker.c:435
    > shrink_slab+0x1093/0x14d0 mm/shrinker.c:662
    > shrink_one+0x43b/0x850 mm/vmscan.c:4818
    > shrink_many mm/vmscan.c:4879 [inline]
    > lru_gen_shrink_node mm/vmscan.c:4957 [inline]
    > shrink_node+0x3799/0x3de0 mm/vmscan.c:5937
    > kswapd_shrink_node mm/vmscan.c:6765 [inline]
    > balance_pgdat mm/vmscan.c:6957 [inline]
    > kswapd+0x1ca3/0x3700 mm/vmscan.c:7226
    > kthread+0x2f0/0x390 kernel/kthread.c:389
    > ret_from_fork+0x4b/0x80 arch/x86/kernel/process.c:147
    > ret_from_fork_asm+0x1a/0x30 arch/x86/entry/entry_64.S:244
    > other info that might help us debug this:
    > Chain exists of:
    > &amp;sbi-&gt;sb_lock --&gt; fs_reclaim --&gt; sb_internal#2
    > Possible unsafe locking scenario:
    > CPU0                    CPU1
    > ----                    ----
    > rlock(sb_internal#2);
    > lock(fs_reclaim);
    > lock(sb_internal#2);
    > lock(&amp;sbi-&gt;sb_lock);
    > Root cause is there will be potential deadlock in between
    > below tasks:
    > Thread A				Kswapd
    > - f2fs_ioc_commit_atomic_write
    > - mnt_want_write_file -- down_read lock A
    > - balance_pgdat
    > - __fs_reclaim_acquire  -- lock B
    > - shrink_node
    > - prune_icache_sb
    > - dispose_list
    > - f2fs_evict_inode
    > - sb_start_intwrite  -- down_read lock A
    > - f2fs_do_sync_file
    > - f2fs_write_inode
    > - f2fs_handle_critical_error
    > - f2fs_record_stop_reason
    > - f2fs_commit_super
    > - read_mapping_folio
    > - filemap_alloc_folio_noprof
    > - fs_reclaim_acquire  -- lock B
    > Both threads try to acquire read lock of lock A, then its upcoming write
    > lock grabber will trigger deadlock.
    > Let&#x27;s always create an asynchronous task in f2fs_handle_critical_error()
    > rather than calling f2fs_record_stop_reason() synchronously to avoid
    > this potential deadlock issue.
    > Fixes: b62e71be2110 (&quot;f2fs: support errors&#x3D;remount-ro|continue|panic mountoption&quot;)
    > Reported-by: syzbot+be4a9983e95a5e25c8d3@syzkaller.appspotmail.com
    > Closes: https://lore.kernel.org/all/6704d667.050a0220.1e4d62.0081.GAE@google.com
    > Signed-off-by: Chao Yu &lt;chao@kernel.org&gt;
    > Reviewed-by: Daejun Park &lt;daejun7.park@samsung.com&gt;
    > Signed-off-by: Jaegeuk Kim &lt;jaegeuk@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ f2fs: Fix not used variable &#x27;index&#x27; (@Zeng Heng in [5e69964251f93c8](https://github.com/sophgo/linux-riscv/commit/5e69964251f93c8) at 2024-12-05 13:02:22)
    > [ Upstream commit 0c3a38a4b442893f8baca72e44a2a27d52d6cc75 ]
    > Fix the following compilation warning:
    > fs/f2fs/data.c:2391:10: warning: variable ‘index’ set but not used
    > [-Wunused-but-set-variable]
    > 2391 |  pgoff_t index;
    > Only define and set the variable index when the CONFIG_F2FS_FS_COMPRESSION
    > is enabled.
    > Fixes: db92e6c729d8 (&quot;f2fs: convert f2fs_mpage_readpages() to use folio&quot;)
    > Signed-off-by: Zeng Heng &lt;zengheng4@huawei.com&gt;
    > Reviewed-by: Chao Yu &lt;chao@kernel.org&gt;
    > Signed-off-by: Jaegeuk Kim &lt;jaegeuk@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ f2fs: fix to avoid use GC_AT when setting gc_mode as GC_URGENT_LOW or GC_URGENT_MID (@Zhiguo Niu in [248f5a5b43cff2d](https://github.com/sophgo/linux-riscv/commit/248f5a5b43cff2d) at 2024-12-05 13:02:22)
    > [ Upstream commit 296b8cb34e65fa93382cf919be5a056f719c9a26 ]
    > If gc_mode is set to GC_URGENT_LOW or GC_URGENT_MID, cost benefit GC
    > approach should be used, but if ATGC is enabled at the same time,
    > Age-threshold approach will be selected, which can only do amount of
    > GC and it is much less than the numbers of CB approach.
    > some traces:
    > f2fs_gc-254:48-396     [007] ..... 2311600.684028: f2fs_gc_begin: dev &#x3D; (254,48), gc_type &#x3D; Background GC, no_background_GC &#x3D; 0, nr_free_secs &#x3D; 0, nodes &#x3D; 1053, dents &#x3D; 2, imeta &#x3D; 18, free_sec:44898, free_seg:44898, rsv_seg:239, prefree_seg:0
    > f2fs_gc-254:48-396     [007] ..... 2311600.684527: f2fs_get_victim: dev &#x3D; (254,48), type &#x3D; No TYPE, policy &#x3D; (Background GC, LFS-mode, Age-threshold), victim &#x3D; 10, cost &#x3D; 4294364975, ofs_unit &#x3D; 1, pre_victim_secno &#x3D; -1, prefree &#x3D; 0, free &#x3D; 44898
    > f2fs_gc-254:48-396     [007] ..... 2311600.714835: f2fs_gc_end: dev &#x3D; (254,48), ret &#x3D; 0, seg_freed &#x3D; 0, sec_freed &#x3D; 0, nodes &#x3D; 1562, dents &#x3D; 2, imeta &#x3D; 18, free_sec:44898, free_seg:44898, rsv_seg:239, prefree_seg:0
    > f2fs_gc-254:48-396     [007] ..... 2311600.714843: f2fs_background_gc: dev &#x3D; (254,48), wait_ms &#x3D; 50, prefree &#x3D; 0, free &#x3D; 44898
    > f2fs_gc-254:48-396     [007] ..... 2311600.771785: f2fs_gc_begin: dev &#x3D; (254,48), gc_type &#x3D; Background GC, no_background_GC &#x3D; 0, nr_free_secs &#x3D; 0, nodes &#x3D; 1562, dents &#x3D; 2, imeta &#x3D; 18, free_sec:44898, free_seg:44898, rsv_seg:239, prefree_seg:
    > f2fs_gc-254:48-396     [007] ..... 2311600.772275: f2fs_gc_end: dev &#x3D; (254,48), ret &#x3D; -61, seg_freed &#x3D; 0, sec_freed &#x3D; 0, nodes &#x3D; 1562, dents &#x3D; 2, imeta &#x3D; 18, free_sec:44898, free_seg:44898, rsv_seg:239, prefree_seg:0
    > Fixes: 0e5e81114de1 (&quot;f2fs: add GC_URGENT_LOW mode in gc_urgent&quot;)
    > Fixes: d98af5f45520 (&quot;f2fs: introduce gc_urgent_mid mode&quot;)
    > Signed-off-by: Zhiguo Niu &lt;zhiguo.niu@unisoc.com&gt;
    > Reviewed-by: Chao Yu &lt;chao@kernel.org&gt;
    > Signed-off-by: Jaegeuk Kim &lt;jaegeuk@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ perf ftrace latency: Fix unit on histogram first entry when using --use-nsec (@Arnaldo Carvalho de Melo in [d4ce0224559db73](https://github.com/sophgo/linux-riscv/commit/d4ce0224559db73) at 2024-12-05 13:02:21)
    > [ Upstream commit 064d569e20e82c065b1dec9d20c29c7087bb1a00 ]
    > The use_nsec arg wasn&#x27;t being taken into account when printing the first
    > histogram entry, fix it:
    > root@number:~# perf ftrace latency --use-nsec -T switch_mm_irqs_off -a sleep 2
    > #   DURATION     |      COUNT | GRAPH                                          |
    > 0 - 1    us |          0 |                                                |
    > 1 - 2    ns |          0 |                                                |
    > 2 - 4    ns |          0 |                                                |
    > 4 - 8    ns |          0 |                                                |
    > 8 - 16   ns |          0 |                                                |
    > 16 - 32   ns |          0 |                                                |
    > 32 - 64   ns |        125 |                                                |
    > 64 - 128  ns |        335 |                                                |
    > 128 - 256  ns |       2155 | ####                                           |
    > 256 - 512  ns |       9996 | ###################                            |
    > 512 - 1024 ns |       4958 | #########                                      |
    > 1 - 2    us |       4636 | #########                                      |
    > 2 - 4    us |       1053 | ##                                             |
    > 4 - 8    us |         15 |                                                |
    > 8 - 16   us |          1 |                                                |
    > 16 - 32   us |          0 |                                                |
    > 32 - 64   us |          0 |                                                |
    > 64 - 128  us |          0 |                                                |
    > 128 - 256  us |          0 |                                                |
    > 256 - 512  us |          0 |                                                |
    > 512 - 1024 us |          0 |                                                |
    > 1 - ...  ms |          0 |                                                |
    > root@number:~#
    > After:
    > root@number:~# perf ftrace latency --use-nsec -T switch_mm_irqs_off -a sleep 2
    > #   DURATION     |      COUNT | GRAPH                                          |
    > 0 - 1    ns |          0 |                                                |
    > 1 - 2    ns |          0 |                                                |
    > 2 - 4    ns |          0 |                                                |
    > 4 - 8    ns |          0 |                                                |
    > 8 - 16   ns |          0 |                                                |
    > 16 - 32   ns |          0 |                                                |
    > 32 - 64   ns |         19 |                                                |
    > 64 - 128  ns |         94 |                                                |
    > 128 - 256  ns |       2191 | ####                                           |
    > 256 - 512  ns |       9719 | ####################                           |
    > 512 - 1024 ns |       5330 | ###########                                    |
    > 1 - 2    us |       4104 | ########                                       |
    > 2 - 4    us |        807 | #                                              |
    > 4 - 8    us |          9 |                                                |
    > 8 - 16   us |          0 |                                                |
    > 16 - 32   us |          0 |                                                |
    > 32 - 64   us |          0 |                                                |
    > 64 - 128  us |          0 |                                                |
    > 128 - 256  us |          0 |                                                |
    > 256 - 512  us |          0 |                                                |
    > 512 - 1024 us |          0 |                                                |
    > 1 - ...  ms |          0 |                                                |
    > root@number:~#
    > Fixes: 84005bb6148618cc (&quot;perf ftrace latency: Add -n/--use-nsec option&quot;)
    > Signed-off-by: Arnaldo Carvalho de Melo &lt;acme@redhat.com&gt;
    > Cc: Gabriele Monaco &lt;gmonaco@redhat.com&gt;
    > Link: https://lore.kernel.org/r/ZyE3frB-hMXHCnMO@x1
    > Signed-off-by: Namhyung Kim &lt;namhyung@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ perf disasm: Use disasm_line__free() to properly free disasm_line (@Li Huafei in [ae20be3a5e57c25](https://github.com/sophgo/linux-riscv/commit/ae20be3a5e57c25) at 2024-12-05 13:02:21)
    > [ Upstream commit b4e0e9a1e30059f4523c9b6a1f8045ad89b5db8a ]
    > The structure disasm_line contains members that require dynamically
    > allocated memory and need to be freed correctly using
    > disasm_line__free().
    > This patch fixes the incorrect release in
    > symbol__disassemble_capstone().
    > Fixes: 6d17edc113de (&quot;perf annotate: Use libcapstone to disassemble&quot;)
    > Signed-off-by: Li Huafei &lt;lihuafei1@huawei.com&gt;
    > Tested-by: Athira Rajeev &lt;atrajeev@linux.vnet.ibm.com&gt;
    > Cc: sesse@google.com
    > Cc: kjain@linux.ibm.com
    > Link: https://lore.kernel.org/r/20241019154157.282038-1-lihuafei1@huawei.com
    > Signed-off-by: Namhyung Kim &lt;namhyung@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ rust: macros: fix documentation of the paste! macro (@Paolo Bonzini in [96ef0372fccf14c](https://github.com/sophgo/linux-riscv/commit/96ef0372fccf14c) at 2024-12-05 13:02:21)
    > [ Upstream commit 15541c9263ce34ff95a06bc68f45d9bc5c990bcd ]
    > One of the example in this section uses a curious mix of the constant
    > and function declaration syntaxes; fix it.
    > Signed-off-by: Paolo Bonzini &lt;pbonzini@redhat.com&gt;
    > Reviewed-by: Alice Ryhl &lt;aliceryhl@google.com&gt;
    > Fixes: 823d4737d4c2 (&quot;rust: macros: add &#x60;paste!&#x60; proc macro&quot;)
    > Link: https://lore.kernel.org/r/20241019072208.1016707-1-pbonzini@redhat.com
    > Signed-off-by: Miguel Ojeda &lt;ojeda@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ rust: block: fix formatting of &#x60;kernel::block::mq::request&#x60; module (@Francesco Zardi in [5f525ae90f9ab25](https://github.com/sophgo/linux-riscv/commit/5f525ae90f9ab25) at 2024-12-05 13:02:21)
    > [ Upstream commit 28e848386b92645f93b9f2fdba5882c3ca7fb3e2 ]
    > Fix several issues with rustdoc formatting for the
    > &#x60;kernel::block::mq::Request&#x60; module, in particular:
    > - An ordered list not rendering correctly, fixed by using numbers
    > prefixes instead of letters.
    > - Code snippets formatted as regular text, fixed by wrapping the
    > code with &#x60;back-ticks&#x60;.
    > - References to types missing intra-doc links, fixed by wrapping the
    > types with [square brackets].
    > Reported-by: Miguel Ojeda &lt;ojeda@kernel.org&gt;
    > Closes: https://github.com/Rust-for-Linux/linux/issues/1108
    > Signed-off-by: Francesco Zardi &lt;frazar00@gmail.com&gt;
    > Acked-by: Andreas Hindborg &lt;a.hindborg@kernel.org&gt;
    > Fixes: 3253aba3408a (&quot;rust: block: introduce &#x60;kernel::block::mq&#x60; module&quot;)
    > Link: https://lore.kernel.org/r/20240903173027.16732-3-frazar00@gmail.com
    > [ Added an extra intra-doc link. Took the chance to add some periods
    > for consistency. Reworded slightly. - Miguel ]
    > Signed-off-by: Miguel Ojeda &lt;ojeda@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ perf disasm: Fix not cleaning up disasm_line in symbol__disassemble_raw() (@Li Huafei in [4ad9592cc70a952](https://github.com/sophgo/linux-riscv/commit/4ad9592cc70a952) at 2024-12-05 13:02:21)
    > [ Upstream commit 150dab31d5609f896fbfaa06b442ca314da79858 ]
    > In symbol__disassemble_raw(), the created disasm_line should be
    > discarded before returning an error. When creating disasm_line fails,
    > break the loop and then release the created lines.
    > Fixes: 0b971e6bf1c3 (&quot;perf annotate: Add support to capture and parse raw instruction in powerpc using dso__data_read_offset utility&quot;)
    > Signed-off-by: Li Huafei &lt;lihuafei1@huawei.com&gt;
    > Tested-by: Athira Rajeev &lt;atrajeev@linux.vnet.ibm.com&gt;
    > Cc: sesse@google.com
    > Cc: kjain@linux.ibm.com
    > Link: https://lore.kernel.org/r/20241019154157.282038-3-lihuafei1@huawei.com
    > Signed-off-by: Namhyung Kim &lt;namhyung@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ virtiofs: use pages instead of pointer for kernel direct IO (@Hou Tao in [2bc07714dc955a9](https://github.com/sophgo/linux-riscv/commit/2bc07714dc955a9) at 2024-12-05 13:02:21)
    > [ Upstream commit 41748675c0bf252b3c5f600a95830f0936d366c1 ]
    > When trying to insert a 10MB kernel module kept in a virtio-fs with cache
    > disabled, the following warning was reported:
    > ------------[ cut here ]------------
    > WARNING: CPU: 1 PID: 404 at mm/page_alloc.c:4551 ......
    > Modules linked in:
    > CPU: 1 PID: 404 Comm: insmod Not tainted 6.9.0-rc5+ #123
    > Hardware name: QEMU Standard PC (i440FX + PIIX, 1996) ......
    > RIP: 0010:__alloc_pages+0x2bf/0x380
    > ......
    > Call Trace:
    > &lt;TASK&gt;
    > ? __warn+0x8e/0x150
    > ? __alloc_pages+0x2bf/0x380
    > __kmalloc_large_node+0x86/0x160
    > __kmalloc+0x33c/0x480
    > virtio_fs_enqueue_req+0x240/0x6d0
    > virtio_fs_wake_pending_and_unlock+0x7f/0x190
    > queue_request_and_unlock+0x55/0x60
    > fuse_simple_request+0x152/0x2b0
    > fuse_direct_io+0x5d2/0x8c0
    > fuse_file_read_iter+0x121/0x160
    > __kernel_read+0x151/0x2d0
    > kernel_read+0x45/0x50
    > kernel_read_file+0x1a9/0x2a0
    > init_module_from_file+0x6a/0xe0
    > idempotent_init_module+0x175/0x230
    > __x64_sys_finit_module+0x5d/0xb0
    > x64_sys_call+0x1c3/0x9e0
    > do_syscall_64+0x3d/0xc0
    > entry_SYSCALL_64_after_hwframe+0x4b/0x53
    > ......
    > &lt;/TASK&gt;
    > ---[ end trace 0000000000000000 ]---
    > The warning is triggered as follows:
    > 1) syscall finit_module() handles the module insertion and it invokes
    > kernel_read_file() to read the content of the module first.
    > 2) kernel_read_file() allocates a 10MB buffer by using vmalloc() and
    > passes it to kernel_read(). kernel_read() constructs a kvec iter by
    > using iov_iter_kvec() and passes it to fuse_file_read_iter().
    > 3) virtio-fs disables the cache, so fuse_file_read_iter() invokes
    > fuse_direct_io(). As for now, the maximal read size for kvec iter is
    > only limited by fc-&gt;max_read. For virtio-fs, max_read is UINT_MAX, so
    > fuse_direct_io() doesn&#x27;t split the 10MB buffer. It saves the address and
    > the size of the 10MB-sized buffer in out_args[0] of a fuse request and
    > passes the fuse request to virtio_fs_wake_pending_and_unlock().
    > 4) virtio_fs_wake_pending_and_unlock() uses virtio_fs_enqueue_req() to
    > queue the request. Because virtiofs need DMA-able address, so
    > virtio_fs_enqueue_req() uses kmalloc() to allocate a bounce buffer for
    > all fuse args, copies these args into the bounce buffer and passed the
    > physical address of the bounce buffer to virtiofsd. The total length of
    > these fuse args for the passed fuse request is about 10MB, so
    > copy_args_to_argbuf() invokes kmalloc() with a 10MB size parameter and
    > it triggers the warning in __alloc_pages():
    > if (WARN_ON_ONCE_GFP(order &gt; MAX_PAGE_ORDER, gfp))
    > return NULL;
    > 5) virtio_fs_enqueue_req() will retry the memory allocation in a
    > kworker, but it won&#x27;t help, because kmalloc() will always return NULL
    > due to the abnormal size and finit_module() will hang forever.
    > A feasible solution is to limit the value of max_read for virtio-fs, so
    > the length passed to kmalloc() will be limited. However it will affect
    > the maximal read size for normal read. And for virtio-fs write initiated
    > from kernel, it has the similar problem but now there is no way to limit
    > fc-&gt;max_write in kernel.
    > So instead of limiting both the values of max_read and max_write in
    > kernel, introducing use_pages_for_kvec_io in fuse_conn and setting it as
    > true in virtiofs. When use_pages_for_kvec_io is enabled, fuse will use
    > pages instead of pointer to pass the KVEC_IO data.
    > After switching to pages for KVEC_IO data, these pages will be used for
    > DMA through virtio-fs. If these pages are backed by vmalloc(),
    > {flush|invalidate}_kernel_vmap_range() are necessary to flush or
    > invalidate the cache before the DMA operation. So add two new fields in
    > fuse_args_pages to record the base address of vmalloc area and the
    > condition indicating whether invalidation is needed. Perform the flush
    > in fuse_get_user_pages() for write operations and the invalidation in
    > fuse_release_user_pages() for read operations.
    > It may seem necessary to introduce another field in fuse_conn to
    > indicate that these KVEC_IO pages are used for DMA, However, considering
    > that virtio-fs is currently the only user of use_pages_for_kvec_io, just
    > reuse use_pages_for_kvec_io to indicate that these pages will be used
    > for DMA.
    > Fixes: a62a8ef9d97d (&quot;virtio-fs: add virtiofs filesystem&quot;)
    > Signed-off-by: Hou Tao &lt;houtao1@huawei.com&gt;
    > Tested-by: Jingbo Xu &lt;jefflexu@linux.alibaba.com&gt;
    > Signed-off-by: Miklos Szeredi &lt;mszeredi@redhat.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ PCI: cpqphp: Fix PCIBIOS_* return value confusion (@Ilpo Järvinen in [2249f3d8296dfa3](https://github.com/sophgo/linux-riscv/commit/2249f3d8296dfa3) at 2024-12-05 13:02:21)
    > [ Upstream commit e2226dbc4a4919d9c8bd9293299b532090bdf020 ]
    > Code in and related to PCI_RefinedAccessConfig() has three types of return
    > type confusion:
    > - PCI_RefinedAccessConfig() tests pci_bus_read_config_dword() return value
    > against -1.
    > - PCI_RefinedAccessConfig() returns both -1 and PCIBIOS_* return codes.
    > - Callers of PCI_RefinedAccessConfig() only test for -1.
    > Make PCI_RefinedAccessConfig() return PCIBIOS_* codes consistently and
    > adapt callers accordingly.
    > Fixes: 1da177e4c3f4 (&quot;Linux-2.6.12-rc2&quot;)
    > Link: https://lore.kernel.org/r/20241022091140.3504-2-ilpo.jarvinen@linux.intel.com
    > Signed-off-by: Ilpo Järvinen &lt;ilpo.jarvinen@linux.intel.com&gt;
    > Signed-off-by: Bjorn Helgaas &lt;bhelgaas@google.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ f2fs: fix to account dirty data in __get_secs_required() (@Chao Yu in [e812871c068cc0f](https://github.com/sophgo/linux-riscv/commit/e812871c068cc0f) at 2024-12-05 13:02:20)
    > [ Upstream commit 1acd73edbbfef2c3c5b43cba4006a7797eca7050 ]
    > It will trigger system panic w/ testcase in [1]:
    > ------------[ cut here ]------------
    > kernel BUG at fs/f2fs/segment.c:2752!
    > RIP: 0010:new_curseg+0xc81/0x2110
    > Call Trace:
    > f2fs_allocate_data_block+0x1c91/0x4540
    > do_write_page+0x163/0xdf0
    > f2fs_outplace_write_data+0x1aa/0x340
    > f2fs_do_write_data_page+0x797/0x2280
    > f2fs_write_single_data_page+0x16cd/0x2190
    > f2fs_write_cache_pages+0x994/0x1c80
    > f2fs_write_data_pages+0x9cc/0xea0
    > do_writepages+0x194/0x7a0
    > filemap_fdatawrite_wbc+0x12b/0x1a0
    > __filemap_fdatawrite_range+0xbb/0xf0
    > file_write_and_wait_range+0xa1/0x110
    > f2fs_do_sync_file+0x26f/0x1c50
    > f2fs_sync_file+0x12b/0x1d0
    > vfs_fsync_range+0xfa/0x230
    > do_fsync+0x3d/0x80
    > __x64_sys_fsync+0x37/0x50
    > x64_sys_call+0x1e88/0x20d0
    > do_syscall_64+0x4b/0x110
    > entry_SYSCALL_64_after_hwframe+0x76/0x7e
    > The root cause is if checkpoint_disabling and lfs_mode are both on,
    > it will trigger OPU for all overwritten data, it may cost more free
    > segment than expected, so f2fs must account those data correctly to
    > calculate cosumed free segments later, and return ENOSPC earlier to
    > avoid run out of free segment during block allocation.
    > [1] https://lore.kernel.org/fstests/20241015025106.3203676-1-chao@kernel.org/
    > Fixes: 4354994f097d (&quot;f2fs: checkpoint disabling&quot;)
    > Cc: Daniel Rosenberg &lt;drosen@google.com&gt;
    > Signed-off-by: Chao Yu &lt;chao@kernel.org&gt;
    > Signed-off-by: Jaegeuk Kim &lt;jaegeuk@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ rust: kernel: fix THIS_MODULE header path in ThisModule doc comment (@Yutaro Ohno in [b26e36b3e2cbca4](https://github.com/sophgo/linux-riscv/commit/b26e36b3e2cbca4) at 2024-12-05 13:02:20)
    > [ Upstream commit 8b55dc8610acf816a66373be53ca6e3bbe2d313a ]
    > The doc comment for &#x60;ThisModule&#x60; incorrectly states the C header file
    > for &#x60;THIS_MODULE&#x60; as &#x60;include/linux/export.h&#x60;, while the correct path is
    > &#x60;include/linux/init.h&#x60;. This is because &#x60;THIS_MODULE&#x60; was moved in
    > commit 5b20755b7780 (&quot;init: move THIS_MODULE from &lt;linux/export.h&gt; to
    > &lt;linux/init.h&gt;&quot;).
    > Update the doc comment for &#x60;ThisModule&#x60; to reflect the correct header
    > file path for &#x60;THIS_MODULE&#x60;.
    > Fixes: 5b20755b7780 (&quot;init: move THIS_MODULE from &lt;linux/export.h&gt; to &lt;linux/init.h&gt;&quot;)
    > Signed-off-by: Yutaro Ohno &lt;yutaro.ono.418@gmail.com&gt;
    > Reviewed-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;
    > Link: https://lore.kernel.org/r/ZxXDZwxWgoEiIYkj@ohnotp
    > Signed-off-by: Miguel Ojeda &lt;ojeda@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ perf dso: Fix symtab_type for kmod compression (@Veronika Molnarova in [aca794f729f8edb](https://github.com/sophgo/linux-riscv/commit/aca794f729f8edb) at 2024-12-05 13:02:20)
    > [ Upstream commit 05a62936e6b14c005db3b0c9c7d8b93d825dd9ca ]
    > During the rework of the dso structure in patch ee756ef7491eafd an
    > increment was forgotten for the symtab_type in case the data for
    > the kernel module are compressed. This affects the probing of the
    > kernel modules, which fails if the data are not already cached.
    > Increment the value of the symtab_type to its compressed variant so the
    > data could be recovered successfully.
    > Fixes: ee756ef7491eafd7 (&quot;perf dso: Add reference count checking and accessor functions&quot;)
    > Signed-off-by: Veronika Molnarova &lt;vmolnaro@redhat.com&gt;
    > Acked-by: Michael Petlan &lt;mpetlan@redhat.com&gt;
    > Acked-by: Namhyung Kim &lt;namhyung@kernel.org&gt;
    > Tested-by: Michael Petlan &lt;mpetlan@redhat.com&gt;
    > Link: https://lore.kernel.org/r/20241010144836.16424-1-vmolnaro@redhat.com
    > Signed-off-by: Namhyung Kim &lt;namhyung@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ perf probe: Fix libdw memory leak (@Ian Rogers in [aa2e3dcf7c198e9](https://github.com/sophgo/linux-riscv/commit/aa2e3dcf7c198e9) at 2024-12-05 13:02:20)
    > [ Upstream commit 4585038b8e186252141ef86e9f0d8e97f11dce8d ]
    > Add missing dwarf_cfi_end to free memory associated with probe_finder
    > cfi_eh which is allocated and owned via a call to
    > dwarf_getcfi_elf. Confusingly cfi_dbg shouldn&#x27;t be freed as its memory
    > is owned by the passed in debuginfo struct. Add comments to highlight
    > this.
    > This addresses leak sanitizer issues seen in:
    > tools/perf/tests/shell/test_uprobe_from_different_cu.sh
    > Fixes: 270bde1e76f4 (&quot;perf probe: Search both .eh_frame and .debug_frame sections for probe location&quot;)
    > Signed-off-by: Ian Rogers &lt;irogers@google.com&gt;
    > Cc: David S. Miller &lt;davem@davemloft.net&gt;
    > Cc: Steinar H. Gunderson &lt;sesse@google.com&gt;
    > Cc: Alexander Lobakin &lt;aleksander.lobakin@intel.com&gt;
    > Cc: Masami Hiramatsu (Google) &lt;mhiramat@kernel.org&gt;
    > Cc: Kajol Jain &lt;kjain@linux.ibm.com&gt;
    > Cc: Athira Rajeev &lt;atrajeev@linux.vnet.ibm.com&gt;
    > Cc: Hemant Kumar &lt;hemant@linux.vnet.ibm.com&gt;
    > Link: https://lore.kernel.org/r/20241016235622.52166-3-irogers@google.com
    > Signed-off-by: Namhyung Kim &lt;namhyung@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ perf probe: Correct demangled symbols in C++ program (@Leo Yan in [8fbfda15513b63f](https://github.com/sophgo/linux-riscv/commit/8fbfda15513b63f) at 2024-12-05 13:02:20)
    > [ Upstream commit 314909f13cc12d47c468602c37dace512d225eeb ]
    > An issue can be observed when probe C++ demangled symbol with steps:
    > # nm test_cpp_mangle | grep print_data
    > 0000000000000c94 t _GLOBAL__sub_I__Z10print_datai
    > 0000000000000afc T _Z10print_datai
    > 0000000000000b38 T _Z10print_dataR5Point
    > # perf probe -x /home/niayan01/test_cpp_mangle -F --demangle
    > ...
    > print_data(Point&amp;)
    > print_data(int)
    > ...
    > # perf --debug verbose&#x3D;3 probe -x test_cpp_mangle --add &quot;test&#x3D;print_data(int)&quot;
    > probe-definition(0): test&#x3D;print_data(int)
    > symbol:print_data(int) file:(null) line:0 offset:0 return:0 lazy:(null)
    > 0 arguments
    > Open Debuginfo file: /home/niayan01/test_cpp_mangle
    > Try to find probe point from debuginfo.
    > Symbol print_data(int) address found : afc
    > Matched function: print_data [2ccf]
    > Probe point found: print_data+0
    > Found 1 probe_trace_events.
    > Opening /sys/kernel/tracing//uprobe_events write&#x3D;1
    > Opening /sys/kernel/tracing//README write&#x3D;0
    > Writing event: p:probe_test_cpp_mangle/test /home/niayan01/test_cpp_mangle:0xb38
    > ...
    > When tried to probe symbol &quot;print_data(int)&quot;, the log shows:
    > Symbol print_data(int) address found : afc
    > The found address is 0xafc - which is right with verifying the output
    > result from nm. Afterwards when write event, the command uses offset
    > 0xb38 in the last log, which is a wrong address.
    > The dwarf_diename() gets a common function name, in above case, it
    > returns string &quot;print_data&quot;. As a result, the tool parses the offset
    > based on the common name. This leads to probe at the wrong symbol
    > &quot;print_data(Point&amp;)&quot;.
    > To fix the issue, use the die_get_linkage_name() function to retrieve
    > the distinct linkage name - this is the mangled name for the C++ case.
    > Based on this unique name, the tool can get a correct offset for
    > probing. Based on DWARF doc, it is possible the linkage name is missed
    > in the DIE, it rolls back to use dwarf_diename().
    > After:
    > # perf --debug verbose&#x3D;3 probe -x test_cpp_mangle --add &quot;test&#x3D;print_data(int)&quot;
    > probe-definition(0): test&#x3D;print_data(int)
    > symbol:print_data(int) file:(null) line:0 offset:0 return:0 lazy:(null)
    > 0 arguments
    > Open Debuginfo file: /home/niayan01/test_cpp_mangle
    > Try to find probe point from debuginfo.
    > Symbol print_data(int) address found : afc
    > Matched function: print_data [2d06]
    > Probe point found: print_data+0
    > Found 1 probe_trace_events.
    > Opening /sys/kernel/tracing//uprobe_events write&#x3D;1
    > Opening /sys/kernel/tracing//README write&#x3D;0
    > Writing event: p:probe_test_cpp_mangle/test /home/niayan01/test_cpp_mangle:0xafc
    > Added new event:
    > probe_test_cpp_mangle:test (on print_data(int) in /home/niayan01/test_cpp_mangle)
    > You can now use it in all perf tools, such as:
    > perf record -e probe_test_cpp_mangle:test -aR sleep 1
    > # perf --debug verbose&#x3D;3 probe -x test_cpp_mangle --add &quot;test2&#x3D;print_data(Point&amp;)&quot;
    > probe-definition(0): test2&#x3D;print_data(Point&amp;)
    > symbol:print_data(Point&amp;) file:(null) line:0 offset:0 return:0 lazy:(null)
    > 0 arguments
    > Open Debuginfo file: /home/niayan01/test_cpp_mangle
    > Try to find probe point from debuginfo.
    > Symbol print_data(Point&amp;) address found : b38
    > Matched function: print_data [2ccf]
    > Probe point found: print_data+0
    > Found 1 probe_trace_events.
    > Opening /sys/kernel/tracing//uprobe_events write&#x3D;1
    > Parsing probe_events: p:probe_test_cpp_mangle/test /home/niayan01/test_cpp_mangle:0x0000000000000afc
    > Group:probe_test_cpp_mangle Event:test probe:p
    > Opening /sys/kernel/tracing//README write&#x3D;0
    > Writing event: p:probe_test_cpp_mangle/test2 /home/niayan01/test_cpp_mangle:0xb38
    > Added new event:
    > probe_test_cpp_mangle:test2 (on print_data(Point&amp;) in /home/niayan01/test_cpp_mangle)
    > You can now use it in all perf tools, such as:
    > perf record -e probe_test_cpp_mangle:test2 -aR sleep 1
    > Fixes: fb1587d869a3 (&quot;perf probe: List probes with line number and file name&quot;)
    > Signed-off-by: Leo Yan &lt;leo.yan@arm.com&gt;
    > Acked-by: Masami Hiramatsu (Google) &lt;mhiramat@kernel.org&gt;
    > Link: https://lore.kernel.org/r/20241012141432.877894-1-leo.yan@arm.com
    > Signed-off-by: Namhyung Kim &lt;namhyung@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ perf disasm: Fix capstone memory leak (@Ian Rogers in [51dfd5c18133056](https://github.com/sophgo/linux-riscv/commit/51dfd5c18133056) at 2024-12-05 13:02:20)
    > [ Upstream commit 1280f012e06e1555de47e3c3a9be898d8cbda5fb ]
    > The insn argument passed to cs_disasm needs freeing. To support
    > accurately having count, add an additional free_count variable.
    > Fixes: c5d60de1813a (&quot;perf annotate: Add support to use libcapstone in powerpc&quot;)
    > Signed-off-by: Ian Rogers &lt;irogers@google.com&gt;
    > Reviewed-by: James Clark &lt;james.clark@linaro.org&gt;
    > Cc: David S. Miller &lt;davem@davemloft.net&gt;
    > Cc: Steinar H. Gunderson &lt;sesse@google.com&gt;
    > Cc: Alexander Lobakin &lt;aleksander.lobakin@intel.com&gt;
    > Cc: Masami Hiramatsu (Google) &lt;mhiramat@kernel.org&gt;
    > Cc: Kajol Jain &lt;kjain@linux.ibm.com&gt;
    > Cc: Athira Rajeev &lt;atrajeev@linux.vnet.ibm.com&gt;
    > Cc: Hemant Kumar &lt;hemant@linux.vnet.ibm.com&gt;
    > Link: https://lore.kernel.org/r/20241016235622.52166-2-irogers@google.com
    > Signed-off-by: Namhyung Kim &lt;namhyung@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ mailbox, remoteproc: k3-m4+: fix compile testing (@Arnd Bergmann in [3afa3958897189f](https://github.com/sophgo/linux-riscv/commit/3afa3958897189f) at 2024-12-05 13:02:20)
    > [ Upstream commit 9c12b96ee244b9679629ac430c375a720bfec04b ]
    > The k3-m4 remoteproc driver was merged with incorrect dependencies.
    > Despite multiple people trying to fix this, the version 6.12-rc2
    > remains broken and causes a build failure with CONFIG_TI_SCI_PROTOCOL&#x3D;m
    > when the driver is built-in.
    > arm-linux-gnueabi-ld: drivers/remoteproc/ti_k3_m4_remoteproc.o: in function &#x60;k3_m4_rproc_probe&#x27;:
    > ti_k3_m4_remoteproc.c:(.text.k3_m4_rproc_probe+0x76): undefined reference to &#x60;devm_ti_sci_get_by_phandle&#x27;
    > Fix the dependency again to make it work in all configurations.
    > The &#x27;select OMAP2PLUS_MBOX&#x27; no longer matches what the other drivers
    > dependencies. The link failure can be avoided with a simple &#x27;depends
    > do, so turn that into the same &#x27;depends&#x27; to ensure we get no circular
    > on TI_SCI_PROTOCOL&#x27;, but the extra COMPILE_TEST alternative is what
    > we use elsehwere. On the other hand, building for OMAP2PLUS makes
    > no sense since the hardware only exists on K3.
    > Fixes: ebcf9008a895 (&quot;remoteproc: k3-m4: Add a remoteproc driver for M4F subsystem&quot;)
    > Fixes: ba0c0cb56f22 (&quot;remoteproc: k3-m4: use the proper dependencies&quot;)
    > Fixes: 54595f2807d2 (&quot;mailbox, remoteproc: omap2+: fix compile testing&quot;)
    > Signed-off-by: Arnd Bergmann &lt;arnd@arndb.de&gt;
    > Link: https://lore.kernel.org/r/20241007132441.2732215-1-arnd@kernel.org
    > Signed-off-by: Mathieu Poirier &lt;mathieu.poirier@linaro.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ rust: rbtree: fix &#x60;SAFETY&#x60; comments that should be &#x60;# Safety&#x60; sections (@Miguel Ojeda in [ccd14e0f6d436ac](https://github.com/sophgo/linux-riscv/commit/ccd14e0f6d436ac) at 2024-12-05 13:02:19)
    > [ Upstream commit 8333ff4d0799aafbe4275cddcbaf45e545e4efba ]
    > The tag &#x60;SAFETY&#x60; is used for safety comments, i.e. &#x60;// SAFETY&#x60;, while a
    > &#x60;Safety&#x60; section is used for safety preconditions in code documentation,
    > i.e. &#x60;/// # Safety&#x60;.
    > Fix the three instances recently added in &#x60;rbtree&#x60; that Clippy would
    > have normally caught in a public item, so that we can enable checking
    > of private items in one of the following commits.
    > Fixes: 98c14e40e07a (&quot;rust: rbtree: add cursor&quot;)
    > Reviewed-by: Trevor Gross &lt;tmgross@umich.edu&gt;
    > Reviewed-by: Alice Ryhl &lt;aliceryhl@google.com&gt;
    > Tested-by: Gary Guo &lt;gary@garyguo.net&gt;
    > Reviewed-by: Gary Guo &lt;gary@garyguo.net&gt;
    > Link: https://lore.kernel.org/r/20240904204347.168520-14-ojeda@kernel.org
    > Signed-off-by: Miguel Ojeda &lt;ojeda@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ f2fs: compress: fix inconsistent update of i_blocks in release_compress_blocks and reserve_compress_blocks (@Qi Han in [a26ace3c6efe3da](https://github.com/sophgo/linux-riscv/commit/a26ace3c6efe3da) at 2024-12-05 13:02:19)
    > [ Upstream commit 26413ce18e85de3dda2cd3d72c3c3e8ab8f4f996 ]
    > After release a file and subsequently reserve it, the FSCK flag is set
    > when the file is deleted, as shown in the following backtrace:
    > F2FS-fs (dm-48): Inconsistent i_blocks, ino:401231, iblocks:1448, sectors:1472
    > fs_rec_info_write_type+0x58/0x274
    > f2fs_rec_info_write+0x1c/0x2c
    > set_sbi_flag+0x74/0x98
    > dec_valid_block_count+0x150/0x190
    > f2fs_truncate_data_blocks_range+0x2d4/0x3cc
    > f2fs_do_truncate_blocks+0x2fc/0x5f0
    > f2fs_truncate_blocks+0x68/0x100
    > f2fs_truncate+0x80/0x128
    > f2fs_evict_inode+0x1a4/0x794
    > evict+0xd4/0x280
    > iput+0x238/0x284
    > do_unlinkat+0x1ac/0x298
    > __arm64_sys_unlinkat+0x48/0x68
    > invoke_syscall+0x58/0x11c
    > For clusters of the following type, i_blocks are decremented by 1 and
    > i_compr_blocks are incremented by 7 in release_compress_blocks, while
    > updates to i_blocks and i_compr_blocks are skipped in reserve_compress_blocks.
    > raw node:
    > D D D D D D D D
    > after compress:
    > C D D D D D D D
    > after reserve:
    > C D D D D D D D
    > Let&#x27;s update i_blocks and i_compr_blocks properly in reserve_compress_blocks.
    > Fixes: eb8fbaa53374 (&quot;f2fs: compress: fix to check unreleased compressed cluster&quot;)
    > Signed-off-by: Qi Han &lt;hanqi@vivo.com&gt;
    > Reviewed-by: Chao Yu &lt;chao@kernel.org&gt;
    > Signed-off-by: Jaegeuk Kim &lt;jaegeuk@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ f2fs: fix null-ptr-deref in f2fs_submit_page_bio() (@Ye Bin in [9e11b1d5fda972f](https://github.com/sophgo/linux-riscv/commit/9e11b1d5fda972f) at 2024-12-05 13:02:19)
    > [ Upstream commit b7d0a97b28083084ebdd8e5c6bccd12e6ec18faa ]
    > There&#x27;s issue as follows when concurrently installing the f2fs.ko
    > module and mounting the f2fs file system:
    > KASAN: null-ptr-deref in range [0x0000000000000020-0x0000000000000027]
    > RIP: 0010:__bio_alloc+0x2fb/0x6c0 [f2fs]
    > Call Trace:
    > &lt;TASK&gt;
    > f2fs_submit_page_bio+0x126/0x8b0 [f2fs]
    > __get_meta_page+0x1d4/0x920 [f2fs]
    > get_checkpoint_version.constprop.0+0x2b/0x3c0 [f2fs]
    > validate_checkpoint+0xac/0x290 [f2fs]
    > f2fs_get_valid_checkpoint+0x207/0x950 [f2fs]
    > f2fs_fill_super+0x1007/0x39b0 [f2fs]
    > mount_bdev+0x183/0x250
    > legacy_get_tree+0xf4/0x1e0
    > vfs_get_tree+0x88/0x340
    > do_new_mount+0x283/0x5e0
    > path_mount+0x2b2/0x15b0
    > __x64_sys_mount+0x1fe/0x270
    > do_syscall_64+0x5f/0x170
    > entry_SYSCALL_64_after_hwframe+0x76/0x7e
    > Above issue happens as the biset of the f2fs file system is not
    > initialized before register &quot;f2fs_fs_type&quot;.
    > To address above issue just register &quot;f2fs_fs_type&quot; at the last in
    > init_f2fs_fs(). Ensure that all f2fs file system resources are
    > initialized.
    > Fixes: f543805fcd60 (&quot;f2fs: introduce private bioset&quot;)
    > Signed-off-by: Ye Bin &lt;yebin10@huawei.com&gt;
    > Reviewed-by: Chao Yu &lt;chao@kernel.org&gt;
    > Signed-off-by: Jaegeuk Kim &lt;jaegeuk@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ perf trace: Keep exited threads for summary (@Michael Petlan in [936d5663a537fe1](https://github.com/sophgo/linux-riscv/commit/936d5663a537fe1) at 2024-12-05 13:02:19)
    > [ Upstream commit d29d92df410e2fb523f640478b18f70c1823e55e ]
    > Since 9ffa6c7512ca (&quot;perf machine thread: Remove exited threads by
    > default&quot;) perf cleans exited threads up, but as said, sometimes they
    > are necessary to be kept. The mentioned commit does not cover all the
    > cases, we also need the information to construct the summary table in
    > perf-trace.
    > Before:
    > # perf trace -s true
    > Summary of events:
    > After:
    > # perf trace -s -- true
    > Summary of events:
    > true (383382), 64 events, 91.4%
    > syscall            calls  errors  total       min       avg       max       stddev
    > (msec)    (msec)    (msec)    (msec)        (%)
    > --------------- --------  ------ -------- --------- --------- ---------     ------
    > mmap                   8      0     0.150     0.013     0.019     0.031     11.90%
    > mprotect               3      0     0.045     0.014     0.015     0.017      6.47%
    > openat                 2      0     0.014     0.006     0.007     0.007      9.73%
    > munmap                 1      0     0.009     0.009     0.009     0.009      0.00%
    > access                 1      1     0.009     0.009     0.009     0.009      0.00%
    > pread64                4      0     0.006     0.001     0.001     0.002      4.53%
    > fstat                  2      0     0.005     0.001     0.002     0.003     37.59%
    > arch_prctl             2      1     0.003     0.001     0.002     0.002     25.91%
    > read                   1      0     0.003     0.003     0.003     0.003      0.00%
    > close                  2      0     0.003     0.001     0.001     0.001      3.86%
    > brk                    1      0     0.002     0.002     0.002     0.002      0.00%
    > rseq                   1      0     0.001     0.001     0.001     0.001      0.00%
    > prlimit64              1      0     0.001     0.001     0.001     0.001      0.00%
    > set_robust_list        1      0     0.001     0.001     0.001     0.001      0.00%
    > set_tid_address        1      0     0.001     0.001     0.001     0.001      0.00%
    > execve                 1      0     0.000     0.000     0.000     0.000      0.00%
    > [namhyung: simplified the condition]
    > Fixes: 9ffa6c7512ca (&quot;perf machine thread: Remove exited threads by default&quot;)
    > Reported-by: Veronika Molnarova &lt;vmolnaro@redhat.com&gt;
    > Signed-off-by: Michael Petlan &lt;mpetlan@redhat.com&gt;
    > Link: https://lore.kernel.org/r/20240927151926.399474-1-mpetlan@redhat.com
    > Signed-off-by: Namhyung Kim &lt;namhyung@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ perf test attr: Add back missing topdown events (@Veronika Molnarova in [4683233e97c0d5a](https://github.com/sophgo/linux-riscv/commit/4683233e97c0d5a) at 2024-12-05 13:02:19)
    > [ Upstream commit 6bff76af9635411214ca44ea38fc2781e78064b6 ]
    > With the patch 0b6c5371c03c &quot;Add missing topdown metrics events&quot; eight
    > topdown metric events with numbers ranging from 0x8000 to 0x8700 were
    > added to the test since they were added as &#x27;perf stat&#x27; default events.
    > Later the patch 951efb9976ce &quot;Update no event/metric expectations&quot; kept
    > only 4 of those events(0x8000-0x8300).
    > Currently, the topdown events with numbers 0x8400 to 0x8700 are missing
    > from the list of expected events resulting in a failure. Add back the
    > missing topdown events.
    > Fixes: 951efb9976ce (&quot;perf test attr: Update no event/metric expectations&quot;)
    > Signed-off-by: Veronika Molnarova &lt;vmolnaro@redhat.com&gt;
    > Tested-by: Ian Rogers &lt;irogers@google.com&gt;
    > Cc: mpetlan@redhat.com
    > Link: https://lore.kernel.org/r/20240311081611.7835-1-vmolnaro@redhat.com
    > Signed-off-by: Namhyung Kim &lt;namhyung@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ perf stat: Fix affinity memory leaks on error path (@Ian Rogers in [17f36fc1bd9835b](https://github.com/sophgo/linux-riscv/commit/17f36fc1bd9835b) at 2024-12-05 13:02:19)
    > [ Upstream commit 7f6ccb70e465bd8c9cf8973aee1c01224e4bdb3c ]
    > Missed cleanup when an error occurs.
    > Fixes: 49de179577e7 (&quot;perf stat: No need to setup affinities when starting a workload&quot;)
    > Signed-off-by: Ian Rogers &lt;irogers@google.com&gt;
    > Link: https://lore.kernel.org/r/20241001052327.7052-2-irogers@google.com
    > Signed-off-by: Namhyung Kim &lt;namhyung@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ PCI: Fix reset_method_store() memory leak (@Todd Kjos in [fe6fae61f3b9931](https://github.com/sophgo/linux-riscv/commit/fe6fae61f3b9931) at 2024-12-05 13:02:18)
    > [ Upstream commit 2985b1844f3f3447f2d938eff1ef6762592065a5 ]
    > In reset_method_store(), a string is allocated via kstrndup() and assigned
    > to the local &quot;options&quot;. options is then used in with strsep() to find
    > spaces:
    > while ((name &#x3D; strsep(&amp;options, &quot; &quot;)) !&#x3D; NULL) {
    > If there are no remaining spaces, then options is set to NULL by strsep(),
    > so the subsequent kfree(options) doesn&#x27;t free the memory allocated via
    > kstrndup().
    > Fix by using a separate tmp_options to iterate with strsep() so options is
    > preserved.
    > Link: https://lore.kernel.org/r/20241001231147.3583649-1-tkjos@google.com
    > Fixes: d88f521da3ef (&quot;PCI: Allow userspace to query and set device reset mechanism&quot;)
    > Signed-off-by: Todd Kjos &lt;tkjos@google.com&gt;
    > Signed-off-by: Bjorn Helgaas &lt;bhelgaas@google.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ perf jevents: Don&#x27;t stop at the first matched pmu when searching a events table (@Kan Liang in [9042456a80245a4](https://github.com/sophgo/linux-riscv/commit/9042456a80245a4) at 2024-12-05 13:02:18)
    > [ Upstream commit 8d7f85e323ea402005fa83ddbdf5d00292d77098 ]
    > The &quot;perf all PMU test&quot; fails on a Coffee Lake machine.
    > The failure is caused by the below change in the commit e2641db83f18
    > (&quot;perf vendor events: Add/update skylake events/metrics&quot;).
    > +    {
    > +        &quot;BriefDescription&quot;: &quot;This 48-bit fixed counter counts the UCLK cycles&quot;,
    > +        &quot;Counter&quot;: &quot;FIXED&quot;,
    > +        &quot;EventCode&quot;: &quot;0xff&quot;,
    > +        &quot;EventName&quot;: &quot;UNC_CLOCK.SOCKET&quot;,
    > +        &quot;PerPkg&quot;: &quot;1&quot;,
    > +        &quot;PublicDescription&quot;: &quot;This 48-bit fixed counter counts the UCLK cycles.&quot;,
    > +        &quot;Unit&quot;: &quot;cbox_0&quot;
    > }
    > The other cbox events have the unit name &quot;CBOX&quot;, while the fixed counter
    > has a unit name &quot;cbox_0&quot;. So the events_table will maintain separate
    > entries for cbox and cbox_0.
    > The perf_pmus__print_pmu_events() calculates the total number of events,
    > allocate an aliases buffer, store all the events into the buffer, sort,
    > and print all the aliases one by one.
    > The problem is that the calculated total number of events doesn&#x27;t match
    > the stored events in the aliases buffer.
    > The perf_pmu__num_events() is used to calculate the number of events. It
    > invokes the pmu_events_table__num_events() to go through the entire
    > events_table to find all events. Because of the
    > pmu_uncore_alias_match(), the suffix of uncore PMU will be ignored. So
    > the events for cbox and cbox_0 are all counted.
    > When storing events into the aliases buffer, the
    > perf_pmu__for_each_event() only process the events for cbox.
    > Since a bigger buffer was allocated, the last entry are all 0.
    > When printing all the aliases, null will be outputted, and trigger the
    > failure.
    > The mismatch was introduced from the commit e3edd6cf6399 (&quot;perf
    > pmu-events: Reduce processed events by passing PMU&quot;). The
    > pmu_events_table__for_each_event() stops immediately once a pmu is set.
    > But for uncore, especially this case, the method is wrong and mismatch
    > what perf does in the perf_pmu__num_events().
    > With the patch,
    > $ perf list pmu | grep -A 1 clock.socket
    > unc_clock.socket
    > [This 48-bit fixed counter counts the UCLK cycles. Unit: uncore_cbox_0
    > $ perf test &quot;perf all PMU test&quot;
    > 107: perf all PMU test                                               : Ok
    > Reported-by: kernel test robot &lt;oliver.sang@intel.com&gt;
    > Closes: https://lore.kernel.org/all/202407101021.2c8baddb-oliver.sang@intel.com/
    > Fixes: e3edd6cf6399 (&quot;perf pmu-events: Reduce processed events by passing PMU&quot;)
    > Signed-off-by: Kan Liang &lt;kan.liang@linux.intel.com&gt;
    > Reviewed-by: Ian Rogers &lt;irogers@google.com&gt;
    > Cc: Sandipan Das &lt;sandipan.das@amd.com&gt;
    > Cc: Benjamin Gray &lt;bgray@linux.ibm.com&gt;
    > Cc: Xu Yang &lt;xu.yang_2@nxp.com&gt;
    > Cc: John Garry &lt;john.g.garry@oracle.com&gt;
    > Link: https://lore.kernel.org/r/20241001021431.814811-1-irogers@google.com
    > Signed-off-by: Namhyung Kim &lt;namhyung@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ gfs2: Fix unlinked inode cleanup (@Andreas Gruenbacher in [6752b6cc10a4d05](https://github.com/sophgo/linux-riscv/commit/6752b6cc10a4d05) at 2024-12-05 13:02:18)
    > [ Upstream commit 7c6f714d88475ceae5342264858a641eafa19632 ]
    > Before commit f0e56edc2ec7 (&quot;gfs2: Split the two kinds of glock &quot;delete&quot;
    > work&quot;), function delete_work_func() was used to trigger the eviction of
    > in-memory inodes from remote as well as deleting unlinked inodes at a
    > later point.  These two kinds of work were then split into two kinds of
    > work, and the two places in the code were deferred deletion of inodes is
    > required accidentally ended up queuing the wrong kind of work.  This
    > caused unlinked inodes to be left behind, which could in the worst case
    > fill up filesystems and require a filesystem check to recover.
    > Fix that by queuing the right kind of work in try_rgrp_unlink() and
    > gfs2_drop_inode().
    > Fixes: f0e56edc2ec7 (&quot;gfs2: Split the two kinds of glock &quot;delete&quot; work&quot;)
    > Signed-off-by: Andreas Gruenbacher &lt;agruenba@redhat.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ perf mem: Fix printing PERF_MEM_LVLNUM_{L2_MHB|MSC} (@Thomas Falcon in [554b47a920ce9f1](https://github.com/sophgo/linux-riscv/commit/554b47a920ce9f1) at 2024-12-05 13:02:18)
    > [ Upstream commit 4f23fc34cc68812c68c3a3dec15e26e87565f430 ]
    > With commit 8ec9497d3ef34 (&quot;tools/include: Sync uapi/linux/perf.h
    > with the kernel sources&quot;), &#x27;perf mem report&#x27; gives an incorrect memory
    > access string.
    > ...
    > 0.02%	1	3644	L5 hit	[.] 0x0000000000009b0e	mlc	[.] 0x00007fce43f59480
    > ...
    > This occurs because, if no entry exists in mem_lvlnum, perf_mem__lvl_scnprintf
    > will default to &#x27;L%d, lvl&#x27;, which in this case for PERF_MEM_LVLNUM_L2_MHB is 0x05.
    > Add entries for PERF_MEM_LVLNUM_L2_MHB and PERF_MEM_LVLNUM_MSC to mem_lvlnum,
    > so that the correct strings are printed.
    > ...
    > 0.02%	1	3644	L2 MHB hit	[.] 0x0000000000009b0e	mlc	[.] 0x00007fce43f59480
    > ...
    > Fixes: 8ec9497d3ef34 (&quot;tools/include: Sync uapi/linux/perf.h with the kernel sources&quot;)
    > Suggested-by: Kan Liang &lt;kan.liang@linux.intel.com&gt;
    > Signed-off-by: Thomas Falcon &lt;thomas.falcon@intel.com&gt;
    > Reviewed-by: Leo Yan &lt;leo.yan@arm.com&gt;
    > Link: https://lore.kernel.org/r/20240926144040.77897-1-thomas.falcon@intel.com
    > Signed-off-by: Namhyung Kim &lt;namhyung@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ perf stat: Close cork_fd when create_perf_stat_counter() failed (@Levi Yun in [39c38ff97c7d867](https://github.com/sophgo/linux-riscv/commit/39c38ff97c7d867) at 2024-12-05 13:02:18)
    > [ Upstream commit e880a70f8046df0dd9089fa60dcb866a2cc69194 ]
    > When create_perf_stat_counter() failed, it doesn&#x27;t close workload.cork_fd
    > open in evlist__prepare_workload(). This could make too many open file
    > error while __run_perf_stat() repeats.
    > Introduce evlist__cancel_workload to close workload.cork_fd and
    > wait workload.child_pid until exit to clear child process
    > when create_perf_stat_counter() is failed.
    > Signed-off-by: Levi Yun &lt;yeoreum.yun@arm.com&gt;
    > Reviewed-by: James Clark &lt;james.clark@linaro.org&gt;
    > Reviewed-by: Andi Kleen &lt;ak@linux.intel.com&gt;
    > Cc: nd@arm.com
    > Cc: howardchu95@gmail.com
    > Link: https://lore.kernel.org/r/20240925132022.2650180-2-yeoreum.yun@arm.com
    > Signed-off-by: Namhyung Kim &lt;namhyung@kernel.org&gt;
    > Stable-dep-of: 7f6ccb70e465 (&quot;perf stat: Fix affinity memory leaks on error path&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ gfs2: Allow immediate GLF_VERIFY_DELETE work (@Andreas Gruenbacher in [2a10074b46a33ca](https://github.com/sophgo/linux-riscv/commit/2a10074b46a33ca) at 2024-12-05 13:02:18)
    > [ Upstream commit 160bc9555d8654464cbbd7bb1f6687048471d2f6 ]
    > Add an argument to gfs2_queue_verify_delete() that allows it to queue
    > GLF_VERIFY_DELETE work for immediate execution.  This is used in the
    > next patch.
    > Signed-off-by: Andreas Gruenbacher &lt;agruenba@redhat.com&gt;
    > Stable-dep-of: 7c6f714d8847 (&quot;gfs2: Fix unlinked inode cleanup&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ dt-bindings: PCI: mediatek-gen3: Allow exact number of clocks only (@Fei Shao in [18259d272b4bade](https://github.com/sophgo/linux-riscv/commit/18259d272b4bade) at 2024-12-05 13:02:18)
    > [ Upstream commit 5efa23224bf573d4bceb51bc646dd67b6ccb83b5 ]
    > In MediaTek PCIe gen3 bindings, &quot;clocks&quot; accepts a range of 1-6 clocks
    > across all SoCs. But in practice, each SoC requires a particular number of
    > clocks as defined in &quot;clock-names&quot;, and the length of &quot;clocks&quot; and
    > &quot;clock-names&quot; can be inconsistent with current bindings.
    > For example:
    > - MT8188, MT8192 and MT8195 all require 6 clocks, while the bindings
    > accept 4-6 clocks.
    > - MT7986 requires 4 clocks, while the bindings accept 4-6 clocks.
    > Update minItems and maxItems properties for individual SoCs as needed to
    > only accept the correct number of clocks.
    > Fixes: c6abd0eadec6 (&quot;dt-bindings: PCI: mediatek-gen3: Add support for Airoha EN7581&quot;)
    > Link: https://lore.kernel.org/r/20240925110044.3678055-3-fshao@chromium.org
    > Signed-off-by: Fei Shao &lt;fshao@chromium.org&gt;
    > Signed-off-by: Bjorn Helgaas &lt;bhelgaas@google.com&gt;
    > Reviewed-by: Krzysztof Kozlowski &lt;krzk@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ mailbox: arm_mhuv2: clean up loop in get_irq_chan_comb() (@Dan Carpenter in [f32869876e9915c](https://github.com/sophgo/linux-riscv/commit/f32869876e9915c) at 2024-12-05 13:02:17)
    > [ Upstream commit 192a16a3430ca459c4e986f3d10758c4d6b1aa29 ]
    > Both the inner and outer loops in this code use the &quot;i&quot; iterator.
    > The inner loop should really use a different iterator.
    > It doesn&#x27;t affect things in practice because the data comes from the
    > device tree.  The &quot;protocol&quot; and &quot;windows&quot; variables are going to be
    > zero.  That means we&#x27;re always going to hit the &quot;return &amp;chans[channel];&quot;
    > statement and we&#x27;re not going to want to iterate through the outer
    > loop again.
    > Still it&#x27;s worth fixing this for future use cases.
    > Fixes: 5a6338cce9f4 (&quot;mailbox: arm_mhuv2: Add driver&quot;)
    > Signed-off-by: Dan Carpenter &lt;dan.carpenter@linaro.org&gt;
    > Acked-by: Viresh Kumar &lt;viresh.kumar@linaro.org&gt;
    > Signed-off-by: Jassi Brar &lt;jassisinghbrar@gmail.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ perf cs-etm: Don&#x27;t flush when packet_queue fills up (@James Clark in [c16d9f1fc8dd306](https://github.com/sophgo/linux-riscv/commit/c16d9f1fc8dd306) at 2024-12-05 13:02:17)
    > [ Upstream commit 5afd032961e8465808c4bc385c06e7676fbe1951 ]
    > cs_etm__flush(), like cs_etm__sample() is an operation that generates a
    > sample and then swaps the current with the previous packet. Calling
    > flush after processing the queues results in two swaps which corrupts
    > the next sample. Therefore it wasn&#x27;t appropriate to call flush here so
    > remove it.
    > Flushing is still done on a discontinuity to explicitly clear the last
    > branch buffer, but when the packet_queue fills up before reaching a
    > timestamp, that&#x27;s not a discontinuity and the call to
    > cs_etm__process_traceid_queue() already generated samples and drained
    > the buffers correctly.
    > This is visible by looking for a branch that has the same target as the
    > previous branch and the following source is before the address of the
    > last target, which is impossible as execution would have had to have
    > gone backwards:
    > ffff800080849d40 _find_next_and_bit+0x78 &#x3D;&gt; ffff80008011cadc update_sg_lb_stats+0x94
    > (packet_queue fills here before a timestamp, resulting in a flush and
    > branch target ffff80008011cadc is duplicated.)
    > ffff80008011cb1c update_sg_lb_stats+0xd4 &#x3D;&gt; ffff80008011cadc update_sg_lb_stats+0x94
    > ffff8000801117c4 cpu_util+0x24 &#x3D;&gt; ffff8000801117d4 cpu_util+0x34
    > After removing the flush the correct branch target is used for the
    > second sample, and ffff8000801117c4 is no longer before the previous
    > address:
    > ffff800080849d40 _find_next_and_bit+0x78 &#x3D;&gt; ffff80008011cadc update_sg_lb_stats+0x94
    > ffff80008011cb1c update_sg_lb_stats+0xd4 &#x3D;&gt; ffff8000801117a0 cpu_util+0x0
    > ffff8000801117c4 cpu_util+0x24 &#x3D;&gt; ffff8000801117d4 cpu_util+0x34
    > Make sure that a final branch stack is output at the end of the trace
    > by calling cs_etm__end_block(). This is already done for both the
    > timeless decode paths.
    > Fixes: 21fe8dc1191a (&quot;perf cs-etm: Add support for CPU-wide trace scenarios&quot;)
    > Reported-by: Ganapatrao Kulkarni &lt;gankulkarni@os.amperecomputing.com&gt;
    > Closes: https://lore.kernel.org/all/20240719092619.274730-1-gankulkarni@os.amperecomputing.com/
    > Reviewed-by: Leo Yan &lt;leo.yan@arm.com&gt;
    > Signed-off-by: James Clark &lt;james.clark@linaro.org&gt;
    > Tested-by: Ganapatrao Kulkarni &lt;gankulkarni@os.amperecomputing.com&gt;
    > Cc: Ben Gainey &lt;ben.gainey@arm.com&gt;
    > Cc: Suzuki K Poulose &lt;suzuki.poulose@arm.com&gt;
    > Cc: Will Deacon &lt;will@kernel.org&gt;
    > Cc: Mathieu Poirier &lt;mathieu.poirier@linaro.org&gt;
    > Cc: Mike Leach &lt;mike.leach@linaro.org&gt;
    > Cc: Ruidong Tian &lt;tianruidong@linux.alibaba.com&gt;
    > Cc: Benjamin Gray &lt;bgray@linux.ibm.com&gt;
    > Cc: linux-arm-kernel@lists.infradead.org
    > Cc: coresight@lists.linaro.org
    > Cc: John Garry &lt;john.g.garry@oracle.com&gt;
    > Cc: scclevenger@os.amperecomputing.com
    > Link: https://lore.kernel.org/r/20240916135743.1490403-2-james.clark@linaro.org
    > Signed-off-by: Namhyung Kim &lt;namhyung@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ mailbox: mtk-cmdq: fix wrong use of sizeof in cmdq_get_clocks() (@Yang Yingliang in [a9c7cb960fc6e05](https://github.com/sophgo/linux-riscv/commit/a9c7cb960fc6e05) at 2024-12-05 13:02:17)
    > [ Upstream commit 271ee263cc8771982809185007181ca10346fe73 ]
    > It should be size of the struct clk_bulk_data, not data pointer pass to
    > devm_kcalloc().
    > Fixes: aa1609f571ca (&quot;mailbox: mtk-cmdq: Dynamically allocate clk_bulk_data structure&quot;)
    > Signed-off-by: Yang Yingliang &lt;yangyingliang@huawei.com&gt;
    > Signed-off-by: Jassi Brar &lt;jassisinghbrar@gmail.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ rtla/timerlat: Do not set params-&gt;user_workload with -U (@Tomas Glozar in [a484490e04d8c7a](https://github.com/sophgo/linux-riscv/commit/a484490e04d8c7a) at 2024-12-05 13:02:17)
    > [ Upstream commit fcbc60d7dc4b125c8de130aa1512e5d20726c06e ]
    > Since commit fb9e90a67ee9 (&quot;rtla/timerlat: Make user-space threads
    > the default&quot;), rtla-timerlat has been defaulting to
    > params-&gt;user_workload if neither that or params-&gt;kernel_workload is set.
    > This has unintentionally made -U, which sets only params-&gt;user_hist/top
    > but not params-&gt;user_workload, to behave like -u unless -k is set,
    > preventing the user from running a custom workload.
    > Example:
    > $ rtla timerlat hist -U -c 0 &amp;
    > [1] 7413
    > $ python sample/timerlat_load.py 0
    > Error opening timerlat fd, did you run timerlat -U?
    > $ ps | grep timerlatu
    > 7415 pts/4    00:00:00 timerlatu/0
    > Fix the issue by checking for params-&gt;user_top/hist instead of
    > params-&gt;user_workload when setting default thread mode.
    > Link: https://lore.kernel.org/20241021123140.14652-1-tglozar@redhat.com
    > Fixes: fb9e90a67ee9 (&quot;rtla/timerlat: Make user-space threads the default&quot;)
    > Signed-off-by: Tomas Glozar &lt;tglozar@redhat.com&gt;
    > Signed-off-by: Steven Rostedt (Google) &lt;rostedt@goodmis.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ x86: fix off-by-one in access_ok() (@David Laight in [964b522a253883c](https://github.com/sophgo/linux-riscv/commit/964b522a253883c) at 2024-12-05 13:02:17)
    > [ Upstream commit 573f45a9f9a47fed4c7957609689b772121b33d7 ]
    > When the size isn&#x27;t a small constant, __access_ok() will call
    > valid_user_address() with the address after the last byte of the user
    > buffer.
    > It is valid for a buffer to end with the last valid user address so
    > valid_user_address() must allow accesses to the base of the guard page.
    > [ This introduces an off-by-one in the other direction for the plain
    > non-sized accesses, but since we have that guard region that is a
    > whole page, those checks &quot;allowing&quot; accesses to that guard region
    > don&#x27;t really matter. The access will fault anyway, whether to the
    > guard page or if the address has been masked to all ones - Linus ]
    > Fixes: 86e6b1547b3d0 (&quot;x86: fix user address masking non-canonical speculation issue&quot;)
    > Signed-off-by: David Laight &lt;david.laight@aculab.com&gt;
    > Signed-off-by: Linus Torvalds &lt;torvalds@linux-foundation.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ gfs2: Rename GLF_VERIFY_EVICT to GLF_VERIFY_DELETE (@Andreas Gruenbacher in [85b6cc14de7e281](https://github.com/sophgo/linux-riscv/commit/85b6cc14de7e281) at 2024-12-05 13:02:17)
    > [ Upstream commit 820ce8ed53ce2111aa5171f7349f289d7e9d0693 ]
    > Rename the GLF_VERIFY_EVICT flag to GLF_VERIFY_DELETE: that flag
    > indicates that we want to delete an inode / verify that it has been
    > deleted.
    > To match, rename gfs2_queue_verify_evict() to
    > gfs2_queue_verify_delete().
    > Signed-off-by: Andreas Gruenbacher &lt;agruenba@redhat.com&gt;
    > Stable-dep-of: 7c6f714d8847 (&quot;gfs2: Fix unlinked inode cleanup&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ smb: cached directories can be more than root file handle (@Paul Aurich in [32b32340f74216c](https://github.com/sophgo/linux-riscv/commit/32b32340f74216c) at 2024-12-05 13:02:17)
    > [ Upstream commit 128630e1dbec8074c7707aad107299169047e68f ]
    > Update this log message since cached fids may represent things other
    > than the root of a mount.
    > Fixes: e4029e072673 (&quot;cifs: find and use the dentry for cached non-root directories also&quot;)
    > Signed-off-by: Paul Aurich &lt;paul@darkrain42.org&gt;
    > Reviewed-by: Bharath SM &lt;bharathsm@microsoft.com&gt;
    > Signed-off-by: Steve French &lt;stfrench@microsoft.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ clk: clk-axi-clkgen: make sure to enable the AXI bus clock (@Nuno Sa in [bbf55f9a4ae46ee](https://github.com/sophgo/linux-riscv/commit/bbf55f9a4ae46ee) at 2024-12-05 13:02:16)
    > [ Upstream commit c64ef7e4851d1a9abbb7f7833e4936973ac5ba79 ]
    > In order to access the registers of the HW, we need to make sure that
    > the AXI bus clock is enabled. Hence let&#x27;s increase the number of clocks
    > by one.
    > In order to keep backward compatibility and make sure old DTs still work
    > we check if clock-names is available or not. If it is, then we can
    > disambiguate between really having the AXI clock or a parent clock and
    > so we can enable the bus clock. If not, we fallback to what was done
    > before and don&#x27;t explicitly enable the AXI bus clock.
    > Note that if clock-names is given, the axi clock must be the last one in
    > the phandle array (also enforced in the DT bindings) so that we can reuse
    > as much code as possible.
    > Fixes: 0e646c52cf0e (&quot;clk: Add axi-clkgen driver&quot;)
    > Signed-off-by: Nuno Sa &lt;nuno.sa@analog.com&gt;
    > Link: https://lore.kernel.org/r/20241029-axi-clkgen-fix-axiclk-v2-2-bc5e0733ad76@analog.com
    > Signed-off-by: Stephen Boyd &lt;sboyd@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ zram: fix NULL pointer in comp_algorithm_show() (@Liu Shixin in [843d366ff197086](https://github.com/sophgo/linux-riscv/commit/843d366ff197086) at 2024-12-05 13:02:16)
    > [ Upstream commit f364cdeb38938f9d03061682b8ff3779dd1730e5 ]
    > LTP reported a NULL pointer dereference as followed:
    > CPU: 7 UID: 0 PID: 5995 Comm: cat Kdump: loaded Not tainted 6.12.0-rc6+ #3
    > Hardware name: QEMU KVM Virtual Machine, BIOS 0.0.0 02/06/2015
    > pstate: 40400005 (nZcv daif +PAN -UAO -TCO -DIT -SSBS BTYPE&#x3D;--)
    > pc : __pi_strcmp+0x24/0x140
    > lr : zcomp_available_show+0x60/0x100 [zram]
    > sp : ffff800088b93b90
    > x29: ffff800088b93b90 x28: 0000000000000001 x27: 0000000000400cc0
    > x26: 0000000000000ffe x25: ffff80007b3e2388 x24: 0000000000000000
    > x23: ffff80007b3e2390 x22: ffff0004041a9000 x21: ffff80007b3e2900
    > x20: 0000000000000000 x19: 0000000000000000 x18: 0000000000000000
    > x17: 0000000000000000 x16: 0000000000000000 x15: 0000000000000000
    > x14: 0000000000000000 x13: 0000000000000000 x12: 0000000000000000
    > x11: 0000000000000000 x10: ffff80007b3e2900 x9 : ffff80007b3cb280
    > x8 : 0101010101010101 x7 : 0000000000000000 x6 : 0000000000000000
    > x5 : 0000000000000040 x4 : 0000000000000000 x3 : 00656c722d6f7a6c
    > x2 : 0000000000000000 x1 : ffff80007b3e2900 x0 : 0000000000000000
    > Call trace:
    > __pi_strcmp+0x24/0x140
    > comp_algorithm_show+0x40/0x70 [zram]
    > dev_attr_show+0x28/0x80
    > sysfs_kf_seq_show+0x90/0x140
    > kernfs_seq_show+0x34/0x48
    > seq_read_iter+0x1d4/0x4e8
    > kernfs_fop_read_iter+0x40/0x58
    > new_sync_read+0x9c/0x168
    > vfs_read+0x1a8/0x1f8
    > ksys_read+0x74/0x108
    > __arm64_sys_read+0x24/0x38
    > invoke_syscall+0x50/0x120
    > el0_svc_common.constprop.0+0xc8/0xf0
    > do_el0_svc+0x24/0x38
    > el0_svc+0x38/0x138
    > el0t_64_sync_handler+0xc0/0xc8
    > el0t_64_sync+0x188/0x190
    > The zram-&gt;comp_algs[ZRAM_PRIMARY_COMP] can be NULL in zram_add() if
    > comp_algorithm_set() has not been called.  User can access the zram device
    > by sysfs after device_add_disk(), so there is a time window to trigger the
    > NULL pointer dereference.  Move it ahead device_add_disk() to make sure
    > when user can access the zram device, it is ready.  comp_algorithm_set()
    > is protected by zram-&gt;init_lock in other places and no such problem.
    > Link: https://lkml.kernel.org/r/20241108100147.3776123-1-liushixin2@huawei.com
    > Fixes: 7ac07a26dea7 (&quot;zram: preparation for multi-zcomp support&quot;)
    > Signed-off-by: Liu Shixin &lt;liushixin2@huawei.com&gt;
    > Reviewed-by: Sergey Senozhatsky &lt;senozhatsky@chromium.org&gt;
    > Cc: Jens Axboe &lt;axboe@kernel.dk&gt;
    > Cc: Minchan Kim &lt;minchan@kernel.org&gt;
    > Signed-off-by: Andrew Morton &lt;akpm@linux-foundation.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ zram: permit only one post-processing operation at a time (@Sergey Senozhatsky in [68b4cf88d4649b1](https://github.com/sophgo/linux-riscv/commit/68b4cf88d4649b1) at 2024-12-05 13:02:16)
    > [ Upstream commit 58652f2b6d21f2874c9f060165ec7e03e8b1fc71 ]
    > Both recompress and writeback soon will unlock slots during processing,
    > which makes things too complex wrt possible race-conditions.  We still
    > want to clear PP_SLOT in slot_free, because this is how we figure out that
    > slot that was selected for post-processing has been released under us and
    > when we start post-processing we check if slot still has PP_SLOT set.  At
    > the same time, theoretically, we can have something like this:
    > CPU0			    CPU1
    > recompress
    > scan slots
    > set PP_SLOT
    > unlock slot
    > slot_free
    > clear PP_SLOT
    > allocate PP_SLOT
    > writeback
    > scan slots
    > set PP_SLOT
    > unlock slot
    > select PP-slot
    > test PP_SLOT
    > So recompress will not detect that slot has been re-used and re-selected
    > for concurrent writeback post-processing.
    > Make sure that we only permit on post-processing operation at a time.  So
    > now recompress and writeback post-processing don&#x27;t race against each
    > other, we only need to handle slot re-use (slot_free and write), which is
    > handled individually by each pp operation.
    > Having recompress and writeback competing for the same slots is not
    > exactly good anyway (can&#x27;t imagine anyone doing that).
    > Link: https://lkml.kernel.org/r/20240917021020.883356-3-senozhatsky@chromium.org
    > Signed-off-by: Sergey Senozhatsky &lt;senozhatsky@chromium.org&gt;
    > Cc: Minchan Kim &lt;minchan@kernel.org&gt;
    > Signed-off-by: Andrew Morton &lt;akpm@linux-foundation.org&gt;
    > Stable-dep-of: f364cdeb3893 (&quot;zram: fix NULL pointer in comp_algorithm_show()&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ dt-bindings: clock: axi-clkgen: include AXI clk (@Nuno Sa in [5618b644d731d61](https://github.com/sophgo/linux-riscv/commit/5618b644d731d61) at 2024-12-05 13:02:16)
    > [ Upstream commit 47f3f5a82a31527e027929c5cec3dd1ef5ef30f5 ]
    > In order to access the registers of the HW, we need to make sure that
    > the AXI bus clock is enabled. Hence let&#x27;s increase the number of clocks
    > by one and add clock-names to differentiate between parent clocks and
    > the bus clock.
    > Fixes: 0e646c52cf0e (&quot;clk: Add axi-clkgen driver&quot;)
    > Signed-off-by: Nuno Sa &lt;nuno.sa@analog.com&gt;
    > Link: https://lore.kernel.org/r/20241029-axi-clkgen-fix-axiclk-v2-1-bc5e0733ad76@analog.com
    > Reviewed-by: Conor Dooley &lt;conor.dooley@microchip.com&gt;
    > Signed-off-by: Stephen Boyd &lt;sboyd@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ RDMA/bnxt_re: Correct the sequence of device suspend (@Kalesh AP in [4a8390f96b85a0a](https://github.com/sophgo/linux-riscv/commit/4a8390f96b85a0a) at 2024-12-05 13:02:16)
    > [ Upstream commit 68b3bca2df00f0a63f0aa2db2b2adc795665229e ]
    > When in fatal error condition, mark device as detached first
    > and then complete all pending HWRM commands as firmware is not
    > going to process them and eventually time out. Move the device
    > to error only if suspend is called when device is in Fatal state.
    > Also, remove some outdated comments. Remove the stop_irq call
    > which is no longer required.
    > Fixes: cc5b9b48d447 (&quot;RDMA/bnxt_re: Recover the device when FW error is detected&quot;)
    > Signed-off-by: Kalesh AP &lt;kalesh-anakkur.purayil@broadcom.com&gt;
    > Signed-off-by: Selvin Xavier &lt;selvin.xavier@broadcom.com&gt;
    > Link: https://patch.msgid.link/1731660464-27838-4-git-send-email-selvin.xavier@broadcom.com
    > Signed-off-by: Leon Romanovsky &lt;leon@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ arm64: dts: qcom: sc8180x: Add a SoC-specific compatible to cpufreq-hw (@Konrad Dybcio in [49c70ccea34275c](https://github.com/sophgo/linux-riscv/commit/49c70ccea34275c) at 2024-12-05 13:02:16)
    > [ Upstream commit 5df30684415d5a902f23862ab5bbed2a2df7fbf1 ]
    > Comply with bindings guidelines and get rid of errors such as:
    > cpufreq@18323000: compatible: &#x27;oneOf&#x27; conditional failed, one must be fixed:
    > [&#x27;qcom,cpufreq-hw&#x27;] is too short
    > Fixes: 8575f197b077 (&quot;arm64: dts: qcom: Introduce the SC8180x platform&quot;)
    > Signed-off-by: Konrad Dybcio &lt;konrad.dybcio@oss.qualcomm.com&gt;
    > Reviewed-by: Dmitry Baryshkov &lt;dmitry.baryshkov@linaro.org&gt;
    > Signed-off-by: Viresh Kumar &lt;viresh.kumar@linaro.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ pinctrl: k210: Undef K210_PC_DEFAULT (@zhang jiao in [115fbb4218b0c86](https://github.com/sophgo/linux-riscv/commit/115fbb4218b0c86) at 2024-12-05 13:02:16)
    > [ Upstream commit 7e86490c5dee5c41a55f32d0dc34269e200e6909 ]
    > When the temporary macro K210_PC_DEFAULT is not needed anymore,
    > use its name in the #undef statement instead of
    > the incorrect &quot;DEFAULT&quot; name.
    > Fixes: d4c34d09ab03 (&quot;pinctrl: Add RISC-V Canaan Kendryte K210 FPIOA driver&quot;)
    > Signed-off-by: zhang jiao &lt;zhangjiao2@cmss.chinamobile.com&gt;
    > Reviewed-by: Damien Le Moal &lt;dlemoal@kernel.org&gt;
    > Link: https://lore.kernel.org/20241113071201.5440-1-zhangjiao2@cmss.chinamobile.com
    > Signed-off-by: Linus Walleij &lt;linus.walleij@linaro.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ clk: ralink: mtmips: fix clocks probe order in oldest ralink SoCs (@Sergio Paracuellos in [e29306c0e1ae4b4](https://github.com/sophgo/linux-riscv/commit/e29306c0e1ae4b4) at 2024-12-05 13:02:15)
    > [ Upstream commit d34db686a3d74bd564bfce2ada15011c556269fc ]
    > Base clocks are the first in being probed and are real dependencies of the
    > rest of fixed, factor and peripheral clocks. For old ralink SoCs RT2880,
    > RT305x and RT3883 &#x27;xtal&#x27; must be defined first since in any other case,
    > when fixed clocks are probed they are delayed until &#x27;xtal&#x27; is probed so the
    > following warning appears:
    > WARNING: CPU: 0 PID: 0 at drivers/clk/ralink/clk-mtmips.c:499 rt3883_bus_recalc_rate+0x98/0x138
    > Modules linked in:
    > CPU: 0 PID: 0 Comm: swapper Not tainted 6.6.43 #0
    > Stack : 805e58d0 00000000 00000004 8004f950 00000000 00000004 00000000 00000000
    > 80669c54 80830000 80700000 805ae570 80670068 00000001 80669bf8 00000000
    > 00000000 00000000 805ae570 80669b38 00000020 804db7dc 00000000 00000000
    > 203a6d6d 80669b78 80669e48 70617773 00000000 805ae570 00000000 00000009
    > 00000000 00000001 00000004 00000001 00000000 00000000 83fe43b0 00000000
    > ...
    > Call Trace:
    > [&lt;800065d0&gt;] show_stack+0x64/0xf4
    > [&lt;804bca14&gt;] dump_stack_lvl+0x38/0x60
    > [&lt;800218ac&gt;] __warn+0x94/0xe4
    > [&lt;8002195c&gt;] warn_slowpath_fmt+0x60/0x94
    > [&lt;80259ff8&gt;] rt3883_bus_recalc_rate+0x98/0x138
    > [&lt;80254530&gt;] __clk_register+0x568/0x688
    > [&lt;80254838&gt;] of_clk_hw_register+0x18/0x2c
    > [&lt;8070b910&gt;] rt2880_clk_of_clk_init_driver+0x18c/0x594
    > [&lt;8070b628&gt;] of_clk_init+0x1c0/0x23c
    > [&lt;806fc448&gt;] plat_time_init+0x58/0x18c
    > [&lt;806fdaf0&gt;] time_init+0x10/0x6c
    > [&lt;806f9bc4&gt;] start_kernel+0x458/0x67c
    > ---[ end trace 0000000000000000 ]---
    > When this driver was mainlined we could not find any active users of old
    > ralink SoCs so we cannot perform any real tests for them. Now, one user
    > of a Belkin f9k1109 version 1 device which uses RT3883 SoC appeared and
    > reported some issues in openWRT:
    > - https://github.com/openwrt/openwrt/issues/16054
    > Thus, define a &#x27;rt2880_xtal_recalc_rate()&#x27; just returning the expected
    > frequency 40Mhz and use it along the old ralink SoCs to have a correct
    > boot trace with no warnings and a working clock plan from the beggining.
    > Fixes: 6f3b15586eef (&quot;clk: ralink: add clock and reset driver for MTMIPS SoCs&quot;)
    > Signed-off-by: Sergio Paracuellos &lt;sergio.paracuellos@gmail.com&gt;
    > Link: https://lore.kernel.org/r/20240910044024.120009-3-sergio.paracuellos@gmail.com
    > Signed-off-by: Stephen Boyd &lt;sboyd@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ clk: en7523: remove REG_PCIE*_{MEM,MEM_MASK} configuration (@Lorenzo Bianconi in [b89b545f6f129de](https://github.com/sophgo/linux-riscv/commit/b89b545f6f129de) at 2024-12-05 13:02:15)
    > [ Upstream commit c31d1cdd7bff1d2c13d435bb9d0c76bfaa332097 ]
    > REG_PCIE*_MEM and REG_PCIE*_MEM_MASK regs (PBUS_CSR memory region) are not
    > part of the scu block on the EN7581 SoC and they are used to select the
    > PCIE ports on the PBUS, so remove this configuration from the clock driver
    > and set these registers in the PCIE host driver instead.
    > This patch does not introduce any backward incompatibility since the dts
    > for EN7581 SoC is not upstream yet.
    > Signed-off-by: Lorenzo Bianconi &lt;lorenzo@kernel.org&gt;
    > Link: https://lore.kernel.org/r/20241112-clk-en7581-syscon-v2-2-8ada5e394ae4@kernel.org
    > Signed-off-by: Stephen Boyd &lt;sboyd@kernel.org&gt;
    > Stable-dep-of: f98eded9e9ab (&quot;clk: en7523: fix estimation of fixed rate for EN7581&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ clk: en7523: move clock_register in hw_init callback (@Lorenzo Bianconi in [b36a59fb492b7c8](https://github.com/sophgo/linux-riscv/commit/b36a59fb492b7c8) at 2024-12-05 13:02:15)
    > [ Upstream commit b8bdfc666bc5f58caf46e67b615132fccbaca3d4 ]
    > Move en7523_register_clocks routine in hw_init callback.
    > Introduce en7523_clk_hw_init callback for EN7523 SoC.
    > This is a preliminary patch to differentiate IO mapped region between
    > EN7523 and EN7581 SoCs in order to access chip-scu IO region
    > &lt;0x1fa20000 0x384&gt; on EN7581 SoC as syscon device since it contains
    > miscellaneous registers needed by multiple devices (clock, pinctrl ..).
    > Signed-off-by: Lorenzo Bianconi &lt;lorenzo@kernel.org&gt;
    > Link: https://lore.kernel.org/r/20241112-clk-en7581-syscon-v2-3-8ada5e394ae4@kernel.org
    > Signed-off-by: Stephen Boyd &lt;sboyd@kernel.org&gt;
    > Stable-dep-of: f98eded9e9ab (&quot;clk: en7523: fix estimation of fixed rate for EN7581&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ clk: en7523: fix estimation of fixed rate for EN7581 (@Lorenzo Bianconi in [a98051eedcc3c06](https://github.com/sophgo/linux-riscv/commit/a98051eedcc3c06) at 2024-12-05 13:02:15)
    > [ Upstream commit f98eded9e9ab048c88ff59c5523e703a6ced5523 ]
    > Introduce en7581_base_clks array in order to define per-SoC fixed-rate
    > clock parameters and fix wrong parameters for emi, npu and crypto EN7581
    > clocks
    > Fixes: 66bc47326ce2 (&quot;clk: en7523: Add EN7581 support&quot;)
    > Signed-off-by: Lorenzo Bianconi &lt;lorenzo@kernel.org&gt;
    > Link: https://lore.kernel.org/r/20241112-clk-en7581-syscon-v2-5-8ada5e394ae4@kernel.org
    > Signed-off-by: Stephen Boyd &lt;sboyd@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ clk: en7523: introduce chip_scu regmap (@Lorenzo Bianconi in [a4bbce81052a3f5](https://github.com/sophgo/linux-riscv/commit/a4bbce81052a3f5) at 2024-12-05 13:02:15)
    > [ Upstream commit f72fc22038dd544fa4d39c06e8c81c09c0041ed4 ]
    > Introduce chip_scu regmap pointer since EN7581 SoC will access chip-scu
    > memory area via a syscon node. Remove first memory region mapping
    > for EN7581 SoC. This patch does not introduce any backward incompatibility
    > since the dts for EN7581 SoC is not upstream yet.
    > Signed-off-by: Lorenzo Bianconi &lt;lorenzo@kernel.org&gt;
    > Link: https://lore.kernel.org/r/20241112-clk-en7581-syscon-v2-4-8ada5e394ae4@kernel.org
    > Signed-off-by: Stephen Boyd &lt;sboyd@kernel.org&gt;
    > Stable-dep-of: f98eded9e9ab (&quot;clk: en7523: fix estimation of fixed rate for EN7581&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ clk: clk-apple-nco: Add NULL check in applnco_probe (@Charles Han in [534e02f83889cce](https://github.com/sophgo/linux-riscv/commit/534e02f83889cce) at 2024-12-05 13:02:15)
    > [ Upstream commit 969c765e2b508cca9099d246c010a1e48dcfd089 ]
    > Add NULL check in applnco_probe, to handle kernel NULL pointer
    > dereference error.
    > Fixes: 6641057d5dba (&quot;clk: clk-apple-nco: Add driver for Apple NCO&quot;)
    > Signed-off-by: Charles Han &lt;hanchunchao@inspur.com&gt;
    > Link: https://lore.kernel.org/r/20241114072820.3071-1-hanchunchao@inspur.com
    > Reviewed-by: Martin Povišer &lt;povik+lin@cutebit.org&gt;
    > Signed-off-by: Stephen Boyd &lt;sboyd@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ clk: ralink: mtmips: fix clock plan for Ralink SoC RT3883 (@Sergio Paracuellos in [17d3309201f1a97](https://github.com/sophgo/linux-riscv/commit/17d3309201f1a97) at 2024-12-05 13:02:15)
    > [ Upstream commit 33239152305567b3e9bf052f71fd4baecd626341 ]
    > Clock plan for Ralink SoC RT3883 needs an extra &#x27;periph&#x27; clock to properly
    > set some peripherals that has this clock as their parent. When this driver
    > was mainlined we could not find any active users of this SoC so we cannot
    > perform any real tests for it. Now, one user of a Belkin f9k1109 version 1
    > device which uses this SoC appear and reported some issues in openWRT:
    > - https://github.com/openwrt/openwrt/issues/16054
    > The peripherals that are wrong are &#x27;uart&#x27;, &#x27;i2c&#x27;, &#x27;i2s&#x27; and &#x27;uartlite&#x27; which
    > has a not defined &#x27;periph&#x27; clock as parent. Hence, introduce it to have a
    > properly working clock plan for this SoC.
    > Fixes: 6f3b15586eef (&quot;clk: ralink: add clock and reset driver for MTMIPS SoCs&quot;)
    > Signed-off-by: Sergio Paracuellos &lt;sergio.paracuellos@gmail.com&gt;
    > Link: https://lore.kernel.org/r/20240910044024.120009-2-sergio.paracuellos@gmail.com
    > Signed-off-by: Stephen Boyd &lt;sboyd@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ RDMA/hns: Fix different dgids mapping to the same dip_idx (@Feng Fang in [f48084857b9e3d7](https://github.com/sophgo/linux-riscv/commit/f48084857b9e3d7) at 2024-12-05 13:02:14)
    > [ Upstream commit faa62440a5772b40bb7d78bf9e29556a82ecf153 ]
    > DIP algorithm requires a one-to-one mapping between dgid and dip_idx.
    > Currently a queue &#x27;spare_idx&#x27; is used to store QPN of QPs that use
    > DIP algorithm. For a new dgid, use a QPN from spare_idx as dip_idx.
    > This method lacks a mechanism for deduplicating QPN, which may result
    > in different dgids sharing the same dip_idx and break the one-to-one
    > mapping requirement.
    > This patch replaces spare_idx with xarray and introduces a refcnt of
    > a dip_idx to indicate the number of QPs that using this dip_idx.
    > The state machine for dip_idx management is implemented as:
    > The entry at an index in xarray is empty -- This indicates that the
    > corresponding dip_idx hasn&#x27;t been created.
    > The entry at an index in xarray is not empty but with 0 refcnt --
    > This indicates that the corresponding dip_idx has been created but
    > not used as dip_idx yet.
    > The entry at an index in xarray is not empty and with non-0 refcnt --
    > This indicates that the corresponding dip_idx is being used by refcnt
    > number of DIP QPs.
    > Fixes: eb653eda1e91 (&quot;RDMA/hns: Bugfix for incorrect association between dip_idx and dgid&quot;)
    > Fixes: f91696f2f053 (&quot;RDMA/hns: Support congestion control type selection according to the FW&quot;)
    > Signed-off-by: Feng Fang &lt;fangfeng4@huawei.com&gt;
    > Signed-off-by: Junxian Huang &lt;huangjunxian6@hisilicon.com&gt;
    > Link: https://patch.msgid.link/20241112055553.3681129-1-huangjunxian6@hisilicon.com
    > Signed-off-by: Leon Romanovsky &lt;leon@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ fbdev: sh7760fb: Fix a possible memory leak in sh7760fb_alloc_mem() (@Zhen Lei in [bad37309c8b8bf1](https://github.com/sophgo/linux-riscv/commit/bad37309c8b8bf1) at 2024-12-05 13:02:14)
    > [ Upstream commit f89d17ae2ac42931be2a0153fecbf8533280c927 ]
    > When information such as info-&gt;screen_base is not ready, calling
    > sh7760fb_free_mem() does not release memory correctly. Call
    > dma_free_coherent() instead.
    > Fixes: 4a25e41831ee (&quot;video: sh7760fb: SH7760/SH7763 LCDC framebuffer driver&quot;)
    > Signed-off-by: Zhen Lei &lt;thunder.leizhen@huawei.com&gt;
    > Reviewed-by: Dmitry Baryshkov &lt;dmitry.baryshkov@linaro.org&gt;
    > Signed-off-by: Helge Deller &lt;deller@gmx.de&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ KVM: PPC: Book3S HV: Fix kmv -&gt; kvm typo (@Kajol Jain in [ac8f0486370400f](https://github.com/sophgo/linux-riscv/commit/ac8f0486370400f) at 2024-12-05 13:02:14)
    > [ Upstream commit 590d2f9347f7974d7954400e5d937672fd844a8b ]
    > Fix typo in the following kvm function names from:
    > kmvhv_counters_tracepoint_regfunc -&gt; kvmhv_counters_tracepoint_regfunc
    > kmvhv_counters_tracepoint_unregfunc -&gt; kvmhv_counters_tracepoint_unregfunc
    > Fixes: e1f288d2f9c6 (&quot;KVM: PPC: Book3S HV nestedv2: Add support for reading VPA counters for pseries guests&quot;)
    > Reported-by: Madhavan Srinivasan &lt;maddy@linux.ibm.com&gt;
    > Reviewed-by: Ritesh Harjani (IBM) &lt;ritesh.list@gmail.com&gt;
    > Reviewed-by: Amit Machhiwal &lt;amachhiw@linux.ibm.com&gt;
    > Signed-off-by: Kajol Jain &lt;kjain@linux.ibm.com&gt;
    > Signed-off-by: Michael Ellerman &lt;mpe@ellerman.id.au&gt;
    > Link: https://patch.msgid.link/20241114085020.1147912-1-kjain@linux.ibm.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ RDMA/mlx5: Move events notifier registration to be after device registration (@Patrisious Haddad in [6b0acf6a94c31ef](https://github.com/sophgo/linux-riscv/commit/6b0acf6a94c31ef) at 2024-12-05 13:02:14)
    > [ Upstream commit ede132a5cf559f3ab35a4c28bac4f4a6c20334d8 ]
    > Move pkey change work initialization and cleanup from device resources
    > stage to notifier stage, since this is the stage which handles this work
    > events.
    > Fix a race between the device deregistration and pkey change work by moving
    > MLX5_IB_STAGE_DEVICE_NOTIFIER to be after MLX5_IB_STAGE_IB_REG in order to
    > ensure that the notifier is deregistered before the device during cleanup.
    > Which ensures there are no works that are being executed after the
    > device has already unregistered which can cause the panic below.
    > BUG: kernel NULL pointer dereference, address: 0000000000000000
    > PGD 0 P4D 0
    > Oops: 0000 [#1] PREEMPT SMP PTI
    > CPU: 1 PID: 630071 Comm: kworker/1:2 Kdump: loaded Tainted: G W OE --------- --- 5.14.0-162.6.1.el9_1.x86_64 #1
    > Hardware name: Microsoft Corporation Virtual Machine/Virtual Machine, BIOS 090008 02/27/2023
    > Workqueue: events pkey_change_handler [mlx5_ib]
    > RIP: 0010:setup_qp+0x38/0x1f0 [mlx5_ib]
    > Code: ee 41 54 45 31 e4 55 89 f5 53 48 89 fb 48 83 ec 20 8b 77 08 65 48 8b 04 25 28 00 00 00 48 89 44 24 18 48 8b 07 48 8d 4c 24 16 &lt;4c&gt; 8b 38 49 8b 87 80 0b 00 00 4c 89 ff 48 8b 80 08 05 00 00 8b 40
    > RSP: 0018:ffffbcc54068be20 EFLAGS: 00010282
    > RAX: 0000000000000000 RBX: ffff954054494128 RCX: ffffbcc54068be36
    > RDX: ffff954004934000 RSI: 0000000000000001 RDI: ffff954054494128
    > RBP: 0000000000000023 R08: ffff954001be2c20 R09: 0000000000000001
    > R10: ffff954001be2c20 R11: ffff9540260133c0 R12: 0000000000000000
    > R13: 0000000000000023 R14: 0000000000000000 R15: ffff9540ffcb0905
    > FS: 0000000000000000(0000) GS:ffff9540ffc80000(0000) knlGS:0000000000000000
    > CS: 0010 DS: 0000 ES: 0000 CR0: 0000000080050033
    > CR2: 0000000000000000 CR3: 000000010625c001 CR4: 00000000003706e0
    > DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
    > DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
    > Call Trace:
    > mlx5_ib_gsi_pkey_change+0x20/0x40 [mlx5_ib]
    > process_one_work+0x1e8/0x3c0
    > worker_thread+0x50/0x3b0
    > ? rescuer_thread+0x380/0x380
    > kthread+0x149/0x170
    > ? set_kthread_struct+0x50/0x50
    > ret_from_fork+0x22/0x30
    > Modules linked in: rdma_ucm(OE) rdma_cm(OE) iw_cm(OE) ib_ipoib(OE) ib_cm(OE) ib_umad(OE) mlx5_ib(OE) mlx5_fwctl(OE) fwctl(OE) ib_uverbs(OE) mlx5_core(OE) mlxdevm(OE) ib_core(OE) mlx_compat(OE) psample mlxfw(OE) tls knem(OE) netconsole nfsv3 nfs_acl nfs lockd grace fscache netfs qrtr rfkill sunrpc intel_rapl_msr intel_rapl_common rapl hv_balloon hv_utils i2c_piix4 pcspkr joydev fuse ext4 mbcache jbd2 sr_mod sd_mod cdrom t10_pi sg ata_generic pci_hyperv pci_hyperv_intf hyperv_drm drm_shmem_helper drm_kms_helper hv_storvsc syscopyarea hv_netvsc sysfillrect sysimgblt hid_hyperv fb_sys_fops scsi_transport_fc hyperv_keyboard drm ata_piix crct10dif_pclmul crc32_pclmul crc32c_intel libata ghash_clmulni_intel hv_vmbus serio_raw [last unloaded: ib_core]
    > CR2: 0000000000000000
    > ---[ end trace f6f8be4eae12f7bc ]---
    > Fixes: 7722f47e71e5 (&quot;IB/mlx5: Create GSI transmission QPs when P_Key table is changed&quot;)
    > Signed-off-by: Patrisious Haddad &lt;phaddad@nvidia.com&gt;
    > Reviewed-by: Michael Guralnik &lt;michaelgur@nvidia.com&gt;
    > Link: https://patch.msgid.link/d271ceeff0c08431b3cbbbb3e2d416f09b6d1621.1731496944.git.leon@kernel.org
    > Signed-off-by: Leon Romanovsky &lt;leon@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ powerpc/sstep: make emulate_vsx_load and emulate_vsx_store static (@Michal Suchanek in [607324864d903a2](https://github.com/sophgo/linux-riscv/commit/607324864d903a2) at 2024-12-05 13:02:14)
    > [ Upstream commit a26c4dbb3d9c1821cb0fc11cb2dbc32d5bf3463b ]
    > These functions are not used outside of sstep.c
    > Fixes: 350779a29f11 (&quot;powerpc: Handle most loads and stores in instruction emulation code&quot;)
    > Signed-off-by: Michal Suchanek &lt;msuchanek@suse.de&gt;
    > Signed-off-by: Michael Ellerman &lt;mpe@ellerman.id.au&gt;
    > Link: https://patch.msgid.link/20241001130356.14664-1-msuchanek@suse.de
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ powerpc/kexec: Fix return of uninitialized variable (@Zhang Zekun in [55fdcd1f4aaafd8](https://github.com/sophgo/linux-riscv/commit/55fdcd1f4aaafd8) at 2024-12-05 13:02:14)
    > [ Upstream commit 83b5a407fbb73e6965adfb4bd0a803724bf87f96 ]
    > of_property_read_u64() can fail and leave the variable uninitialized,
    > which will then be used. Return error if reading the property failed.
    > Fixes: 2e6bd221d96f (&quot;powerpc/kexec_file: Enable early kernel OPAL calls&quot;)
    > Signed-off-by: Zhang Zekun &lt;zhangzekun11@huawei.com&gt;
    > Signed-off-by: Michael Ellerman &lt;mpe@ellerman.id.au&gt;
    > Link: https://patch.msgid.link/20240930075628.125138-1-zhangzekun11@huawei.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ dax: delete a stale directory pmem (@Harshit Mogalapalli in [ec19b155e0f7dc1](https://github.com/sophgo/linux-riscv/commit/ec19b155e0f7dc1) at 2024-12-05 13:02:13)
    > [ Upstream commit b8e6d7ce50673c39514921ac61f7af00bbb58b87 ]
    > After commit: 83762cb5c7c4 (&quot;dax: Kill DEV_DAX_PMEM_COMPAT&quot;) the pmem/
    > directory is not needed anymore and Makefile changes were made
    > accordingly in this commit, but there is a Makefile and pmem.c in pmem/
    > which are now stale and pmem.c is empty, remove them.
    > Fixes: 83762cb5c7c4 (&quot;dax: Kill DEV_DAX_PMEM_COMPAT&quot;)
    > Suggested-by: Vegard Nossum &lt;vegard.nossum@oracle.com&gt;
    > Signed-off-by: Harshit Mogalapalli &lt;harshit.m.mogalapalli@oracle.com&gt;
    > Reviewed-by: Dan Williams &lt;dan.j.williams@intel.com&gt;
    > Reviewed-by: Ira Weiny &lt;ira.weiny@intel.com&gt;
    > Link: https://patch.msgid.link/20241017101144.1654085-1-harshit.m.mogalapalli@oracle.com
    > Signed-off-by: Ira Weiny &lt;ira.weiny@intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ocfs2: fix uninitialized value in ocfs2_file_read_iter() (@Dmitry Antipov in [dc78efe556fed16](https://github.com/sophgo/linux-riscv/commit/dc78efe556fed16) at 2024-12-05 13:02:13)
    > [ Upstream commit adc77b19f62d7e80f98400b2fca9d700d2afdd6f ]
    > Syzbot has reported the following KMSAN splat:
    > BUG: KMSAN: uninit-value in ocfs2_file_read_iter+0x9a4/0xf80
    > ocfs2_file_read_iter+0x9a4/0xf80
    > __io_read+0x8d4/0x20f0
    > io_read+0x3e/0xf0
    > io_issue_sqe+0x42b/0x22c0
    > io_wq_submit_work+0xaf9/0xdc0
    > io_worker_handle_work+0xd13/0x2110
    > io_wq_worker+0x447/0x1410
    > ret_from_fork+0x6f/0x90
    > ret_from_fork_asm+0x1a/0x30
    > Uninit was created at:
    > __alloc_pages_noprof+0x9a7/0xe00
    > alloc_pages_mpol_noprof+0x299/0x990
    > alloc_pages_noprof+0x1bf/0x1e0
    > allocate_slab+0x33a/0x1250
    > ___slab_alloc+0x12ef/0x35e0
    > kmem_cache_alloc_bulk_noprof+0x486/0x1330
    > __io_alloc_req_refill+0x84/0x560
    > io_submit_sqes+0x172f/0x2f30
    > __se_sys_io_uring_enter+0x406/0x41c0
    > __x64_sys_io_uring_enter+0x11f/0x1a0
    > x64_sys_call+0x2b54/0x3ba0
    > do_syscall_64+0xcd/0x1e0
    > entry_SYSCALL_64_after_hwframe+0x77/0x7f
    > Since an instance of &#x27;struct kiocb&#x27; may be passed from the block layer
    > with &#x27;private&#x27; field uninitialized, introduce &#x27;ocfs2_iocb_init_rw_locked()&#x27;
    > and use it from where &#x27;ocfs2_dio_end_io()&#x27; might take care, i.e. in
    > &#x27;ocfs2_file_read_iter()&#x27; and &#x27;ocfs2_file_write_iter()&#x27;.
    > Link: https://lkml.kernel.org/r/20241029091736.1501946-1-dmantipov@yandex.ru
    > Fixes: 7cdfc3a1c397 (&quot;ocfs2: Remember rw lock level during direct io&quot;)
    > Signed-off-by: Dmitry Antipov &lt;dmantipov@yandex.ru&gt;
    > Reported-by: syzbot+a73e253cca4f0230a5a5@syzkaller.appspotmail.com
    > Closes: https://syzkaller.appspot.com/bug?extid&#x3D;a73e253cca4f0230a5a5
    > Cc: Mark Fasheh &lt;mark@fasheh.com&gt;
    > Cc: Joel Becker &lt;jlbec@evilplan.org&gt;
    > Cc: Junxiao Bi &lt;junxiao.bi@oracle.com&gt;
    > Cc: Joseph Qi &lt;jiangqi903@gmail.com&gt;
    > Cc: Changwei Ge &lt;gechangwei@live.cn&gt;
    > Cc: Jun Piao &lt;piaojun@huawei.com&gt;
    > Signed-off-by: Andrew Morton &lt;akpm@linux-foundation.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ iommu/tegra241-cmdqv: Fix alignment failure at max_n_shift (@Nicolin Chen in [85a1d70b86dbcb8](https://github.com/sophgo/linux-riscv/commit/85a1d70b86dbcb8) at 2024-12-05 13:02:13)
    > [ Upstream commit a3799717b881aa0f4e722afb70e7b8ba84ae4f36 ]
    > When configuring a kernel with PAGE_SIZE&#x3D;4KB, depending on its setting of
    > CONFIG_CMA_ALIGNMENT, VCMDQ_LOG2SIZE_MAX&#x3D;19 could fail the alignment test
    > and trigger a WARN_ON:
    > WARNING: at drivers/iommu/arm/arm-smmu-v3/arm-smmu-v3.c:3646
    > Call trace:
    > arm_smmu_init_one_queue+0x15c/0x210
    > tegra241_cmdqv_init_structures+0x114/0x338
    > arm_smmu_device_probe+0xb48/0x1d90
    > Fix it by capping max_n_shift to CMDQ_MAX_SZ_SHIFT as SMMUv3 CMDQ does.
    > Fixes: 918eb5c856f6 (&quot;iommu/arm-smmu-v3: Add in-kernel support for NVIDIA Tegra241 (Grace) CMDQV&quot;)
    > Signed-off-by: Nicolin Chen &lt;nicolinc@nvidia.com&gt;
    > Link: https://lore.kernel.org/r/20241111030226.1940737-1-nicolinc@nvidia.com
    > Signed-off-by: Will Deacon &lt;will@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ zram: ZRAM_DEF_COMP should depend on ZRAM (@Geert Uytterhoeven in [856ea7ef0bba013](https://github.com/sophgo/linux-riscv/commit/856ea7ef0bba013) at 2024-12-05 13:02:13)
    > [ Upstream commit 9f3310ccc71efff041fed3f8be5ad19b0feab30b ]
    > When Compressed RAM block device support is disabled, the
    > CONFIG_ZRAM_DEF_COMP symbol still ends up in the generated config file:
    > CONFIG_ZRAM_DEF_COMP&#x3D;&quot;unset-value&quot;
    > While this causes no real harm, avoid polluting the config file by
    > adding a dependency on ZRAM.
    > Link: https://lkml.kernel.org/r/64e05bad68a9bd5cc322efd114a04d25de525940.1730807319.git.geert@linux-m68k.org
    > Fixes: 917a59e81c34 (&quot;zram: introduce custom comp backends API&quot;)
    > Signed-off-by: Geert Uytterhoeven &lt;geert@linux-m68k.org&gt;
    > Reviewed-by: Sergey Senozhatsky &lt;senozhatsky@chromium.org&gt;
    > Cc: Jens Axboe &lt;axboe@kernel.dk&gt;
    > Cc: Minchan Kim &lt;minchan@kernel.org&gt;
    > Signed-off-by: Andrew Morton &lt;akpm@linux-foundation.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ kunit: skb: use &quot;gfp&quot; variable instead of hardcoding GFP_KERNEL (@Dan Carpenter in [673f503cfe82ba9](https://github.com/sophgo/linux-riscv/commit/673f503cfe82ba9) at 2024-12-05 13:02:13)
    > [ Upstream commit fd0a5afb5455b4561bfc6dfb0c4b2d8226f9ccfe ]
    > The intent here was clearly to use the gfp variable flags instead of
    > hardcoding GFP_KERNEL.  All the callers pass GFP_KERNEL as the gfp
    > flags so this doesn&#x27;t affect runtime.
    > Fixes: b3231d353a51 (&quot;kunit: add a convenience allocation wrapper for SKBs&quot;)
    > Signed-off-by: Dan Carpenter &lt;dan.carpenter@linaro.org&gt;
    > Reviewed-by: David Gow &lt;davidgow@google.com&gt;
    > Reviewed-by: Kuan-Wei Chiu &lt;visitorckw@gmail.com&gt;
    > Signed-off-by: Shuah Khan &lt;skhan@linuxfoundation.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ KVM: PPC: Book3S HV: Stop using vc-&gt;dpdes for nested KVM guests (@Gautam Menghani in [6438feb93338a98](https://github.com/sophgo/linux-riscv/commit/6438feb93338a98) at 2024-12-05 13:02:13)
    > [ Upstream commit 0d3c6b28896f9889c8864dab469e0343a0ad1c0c ]
    > commit 6398326b9ba1 (&quot;KVM: PPC: Book3S HV P9: Stop using vc-&gt;dpdes&quot;)
    > introduced an optimization to use only vcpu-&gt;doorbell_request for SMT
    > emulation for Power9 and above guests, but the code for nested guests
    > still relies on the old way of handling doorbells, due to which an L2
    > guest (see [1]) cannot be booted with XICS with SMT&gt;1. The command to
    > repro this issue is:
    > // To be run in L1
    > qemu-system-ppc64 \
    > -drive file&#x3D;rhel.qcow2,format&#x3D;qcow2 \
    > -m 20G \
    > -smp 8,cores&#x3D;1,threads&#x3D;8 \
    > -cpu  host \
    > -nographic \
    > -machine pseries,ic-mode&#x3D;xics -accel kvm
    > Fix the plumbing to utilize vcpu-&gt;doorbell_request instead of vcore-&gt;dpdes
    > for nested KVM guests on P9 and above.
    > [1] Terminology
    > 1. L0 : PowerNV linux running with HV privileges
    > 2. L1 : Pseries KVM guest running on top of L0
    > 2. L2 : Nested KVM guest running on top of L1
    > Fixes: 6398326b9ba1 (&quot;KVM: PPC: Book3S HV P9: Stop using vc-&gt;dpdes&quot;)
    > Signed-off-by: Gautam Menghani &lt;gautam@linux.ibm.com&gt;
    > Signed-off-by: Michael Ellerman &lt;mpe@ellerman.id.au&gt;
    > Link: https://patch.msgid.link/20241109063301.105289-3-gautam@linux.ibm.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ KVM: PPC: Book3S HV: Avoid returning to nested hypervisor on pending doorbells (@Gautam Menghani in [5c1adda2d5e97ac](https://github.com/sophgo/linux-riscv/commit/5c1adda2d5e97ac) at 2024-12-05 13:02:13)
    > [ Upstream commit 26686db69917399fa30e3b3135360771e90f83ec ]
    > Commit 6398326b9ba1 (&quot;KVM: PPC: Book3S HV P9: Stop using vc-&gt;dpdes&quot;)
    > dropped the use of vcore-&gt;dpdes for msgsndp / SMT emulation. Prior to that
    > commit, the below code at L1 level (see [1] for terminology) was
    > responsible for setting vc-&gt;dpdes for the respective L2 vCPU:
    > if (!nested) {
    > kvmppc_core_prepare_to_enter(vcpu);
    > if (vcpu-&gt;arch.doorbell_request) {
    > vc-&gt;dpdes &#x3D; 1;
    > smp_wmb();
    > vcpu-&gt;arch.doorbell_request &#x3D; 0;
    > }
    > L1 then sent vc-&gt;dpdes to L0 via kvmhv_save_hv_regs(), and while
    > servicing H_ENTER_NESTED at L0, the below condition at L0 level made sure
    > to abort and go back to L1 if vcpu-&gt;arch.doorbell_request &#x3D; 1 so that L1
    > sets vc-&gt;dpdes as per above if condition:
    > } else if (vcpu-&gt;arch.pending_exceptions ||
    > vcpu-&gt;arch.doorbell_request ||
    > xive_interrupt_pending(vcpu)) {
    > vcpu-&gt;arch.ret &#x3D; RESUME_HOST;
    > goto out;
    > }
    > This worked fine since vcpu-&gt;arch.doorbell_request was used more like a
    > flag and vc-&gt;dpdes was used to pass around the doorbell state. But after
    > Commit 6398326b9ba1 (&quot;KVM: PPC: Book3S HV P9: Stop using vc-&gt;dpdes&quot;),
    > vcpu-&gt;arch.doorbell_request is the only variable used to pass around
    > doorbell state.
    > With the plumbing for handling doorbells for nested guests updated to use
    > vcpu-&gt;arch.doorbell_request over vc-&gt;dpdes, the above &quot;else if&quot; stops
    > doorbells from working correctly as L0 aborts execution of L2 and
    > instead goes back to L1.
    > Remove vcpu-&gt;arch.doorbell_request from the above &quot;else if&quot; condition as
    > it is no longer needed for L0 to correctly handle the doorbell status
    > while running L2.
    > [1] Terminology
    > 1. L0 : PowerNV linux running with HV privileges
    > 2. L1 : Pseries KVM guest running on top of L0
    > 2. L2 : Nested KVM guest running on top of L1
    > Fixes: 6398326b9ba1 (&quot;KVM: PPC: Book3S HV P9: Stop using vc-&gt;dpdes&quot;)
    > Signed-off-by: Gautam Menghani &lt;gautam@linux.ibm.com&gt;
    > Signed-off-by: Michael Ellerman &lt;mpe@ellerman.id.au&gt;
    > Link: https://patch.msgid.link/20241109063301.105289-4-gautam@linux.ibm.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ cpufreq: CPPC: Fix wrong return value in cppc_get_cpu_power() (@Jinjie Ruan in [fc514b27c0890e8](https://github.com/sophgo/linux-riscv/commit/fc514b27c0890e8) at 2024-12-05 13:02:12)
    > [ Upstream commit b51eb0874d8170028434fbd259e80b78ed9b8eca ]
    > cppc_get_cpu_power() return 0 if the policy is NULL. Then in
    > em_create_perf_table(), the later zero check for power is not valid
    > as power is uninitialized. As Quentin pointed out, kernel energy model
    > core check the return value of active_power() first, so if the callback
    > failed it should tell the core. So return -EINVAL to fix it.
    > Fixes: a78e72075642 (&quot;cpufreq: CPPC: Fix possible null-ptr-deref for cpufreq_cpu_get_raw()&quot;)
    > Signed-off-by: Jinjie Ruan &lt;ruanjinjie@huawei.com&gt;
    > Suggested-by: Quentin Perret &lt;qperret@google.com&gt;
    > Signed-off-by: Viresh Kumar &lt;viresh.kumar@linaro.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ kasan: move checks to do_strncpy_from_user (@Sabyrzhan Tasbolatov in [e691826a3d076ab](https://github.com/sophgo/linux-riscv/commit/e691826a3d076ab) at 2024-12-05 13:02:12)
    > [ Upstream commit ae193dd79398970ee760e0c8129ac42ef8f5c6ff ]
    > Patch series &quot;kasan: migrate the last module test to kunit&quot;, v4.
    > copy_user_test() is the last KUnit-incompatible test with
    > CONFIG_KASAN_MODULE_TEST requirement, which we are going to migrate to
    > KUnit framework and delete the former test and Kconfig as well.
    > In this patch series:
    > - [1/3] move kasan_check_write() and check_object_size() to
    > do_strncpy_from_user() to cover with KASAN checks with
    > multiple conditions	in strncpy_from_user().
    > - [2/3] migrated copy_user_test() to KUnit, where we can also test
    > strncpy_from_user() due to [1/4].
    > KUnits have been tested on:
    > - x86_64 with CONFIG_KASAN_GENERIC. Passed
    > - arm64 with CONFIG_KASAN_SW_TAGS. 1 fail. See [1]
    > - arm64 with CONFIG_KASAN_HW_TAGS. 1 fail. See [1]
    > [1] https://lore.kernel.org/linux-mm/CACzwLxj21h7nCcS2-KA_q7ybe+5pxH0uCDwu64q_9pPsydneWQ@mail.gmail.com/
    > - [3/3] delete CONFIG_KASAN_MODULE_TEST and documentation occurrences.
    > This patch (of 3):
    > Since in the commit 2865baf54077(&quot;x86: support user address masking
    > instead of non-speculative conditional&quot;) do_strncpy_from_user() is called
    > from multiple places, we should sanitize the kernel *dst memory and size
    > which were done in strncpy_from_user() previously.
    > Link: https://lkml.kernel.org/r/20241016131802.3115788-1-snovitoll@gmail.com
    > Link: https://lkml.kernel.org/r/20241016131802.3115788-2-snovitoll@gmail.com
    > Fixes: 2865baf54077 (&quot;x86: support user address masking instead of non-speculative conditional&quot;)
    > Signed-off-by: Sabyrzhan Tasbolatov &lt;snovitoll@gmail.com&gt;
    > Reviewed-by: Andrey Konovalov &lt;andreyknvl@gmail.com&gt;
    > Cc: Alexander Potapenko &lt;glider@google.com&gt;
    > Cc: Alex Shi &lt;alexs@kernel.org&gt;
    > Cc: Andrey Ryabinin &lt;ryabinin.a.a@gmail.com&gt;
    > Cc: Dmitry Vyukov &lt;dvyukov@google.com&gt;
    > Cc: Hu Haowen &lt;2023002089@link.tyut.edu.cn&gt;
    > Cc: Jonathan Corbet &lt;corbet@lwn.net&gt;
    > Cc: Marco Elver &lt;elver@google.com&gt;
    > Cc: Vincenzo Frascino &lt;vincenzo.frascino@arm.com&gt;
    > Cc: Yanteng Si &lt;siyanteng@loongson.cn&gt;
    > Signed-off-by: Andrew Morton &lt;akpm@linux-foundation.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ RDMA/hns: Fix out-of-order issue of requester when setting FENCE (@Junxian Huang in [c1bc29681508537](https://github.com/sophgo/linux-riscv/commit/c1bc29681508537) at 2024-12-05 13:02:12)
    > [ Upstream commit 5dbcb1c1900f45182b5651c89257c272f1f3ead7 ]
    > The FENCE indicator in hns WQE doesn&#x27;t ensure that response data from
    > a previous Read/Atomic operation has been written to the requester&#x27;s
    > memory before the subsequent Send/Write operation is processed. This
    > may result in the subsequent Send/Write operation accessing the original
    > data in memory instead of the expected response data.
    > Unlike FENCE, the SO (Strong Order) indicator blocks the subsequent
    > operation until the previous response data is written to memory and a
    > bresp is returned. Set the SO indicator instead of FENCE to maintain
    > strict order.
    > Fixes: 9a4435375cd1 (&quot;IB/hns: Add driver files for hns RoCE driver&quot;)
    > Signed-off-by: Junxian Huang &lt;huangjunxian6@hisilicon.com&gt;
    > Link: https://patch.msgid.link/20241108075743.2652258-2-huangjunxian6@hisilicon.com
    > Signed-off-by: Leon Romanovsky &lt;leon@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ RDMA/hns: Fix NULL pointer derefernce in hns_roce_map_mr_sg() (@Junxian Huang in [8c269bb2cc666ca](https://github.com/sophgo/linux-riscv/commit/8c269bb2cc666ca) at 2024-12-05 13:02:12)
    > [ Upstream commit 6b526d17eed850352d880b93b9bf20b93006bd92 ]
    > ib_map_mr_sg() allows ULPs to specify NULL as the sg_offset argument.
    > The driver needs to check whether it is a NULL pointer before
    > dereferencing it.
    > Fixes: d387d4b54eb8 (&quot;RDMA/hns: Fix missing pagesize and alignment check in FRMR&quot;)
    > Signed-off-by: Junxian Huang &lt;huangjunxian6@hisilicon.com&gt;
    > Link: https://patch.msgid.link/20241108075743.2652258-3-huangjunxian6@hisilicon.com
    > Signed-off-by: Leon Romanovsky &lt;leon@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ cpufreq: loongson3: Check for error code from devm_mutex_init() call (@Andy Shevchenko in [4f6672f0d2a58a8](https://github.com/sophgo/linux-riscv/commit/4f6672f0d2a58a8) at 2024-12-05 13:02:12)
    > [ Upstream commit db01e46689e9a986ca6b5d2f41b57d7a81551a4f ]
    > Even if it&#x27;s not critical, the avoidance of checking the error code
    > from devm_mutex_init() call today diminishes the point of using devm
    > variant of it. Tomorrow it may even leak something. Add the missed
    > check.
    > Fixes: ccf51454145b (&quot;cpufreq: Add Loongson-3 CPUFreq driver support&quot;)
    > Signed-off-by: Andy Shevchenko &lt;andriy.shevchenko@linux.intel.com&gt;
    > Signed-off-by: Viresh Kumar &lt;viresh.kumar@linaro.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ fadump: reserve param area if below boot_mem_top (@Sourabh Jain in [361a7f8e019943c](https://github.com/sophgo/linux-riscv/commit/361a7f8e019943c) at 2024-12-05 13:02:12)
    > [ Upstream commit fb90dca828b6070709093934c6dec56489a2d91d ]
    > The param area is a memory region where the kernel places additional
    > command-line arguments for fadump kernel. Currently, the param memory
    > area is reserved in fadump kernel if it is above boot_mem_top. However,
    > it should be reserved if it is below boot_mem_top because the fadump
    > kernel already reserves memory from boot_mem_top to the end of DRAM.
    > Currently, there is no impact from not reserving param memory if it is
    > below boot_mem_top, as it is not used after the early boot phase of the
    > fadump kernel. However, if this changes in the future, it could lead to
    > issues in the fadump kernel.
    > Fixes: 3416c9daa6b1 (&quot;powerpc/fadump: pass additional parameters when fadump is active&quot;)
    > Acked-by: Hari Bathini &lt;hbathini@linux.ibm.com&gt;
    > Signed-off-by: Sourabh Jain &lt;sourabhjain@linux.ibm.com&gt;
    > Signed-off-by: Michael Ellerman &lt;mpe@ellerman.id.au&gt;
    > Link: https://patch.msgid.link/20241107055817.489795-2-sourabhjain@linux.ibm.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ cpufreq: CPPC: Fix wrong return value in cppc_get_cpu_cost() (@Jinjie Ruan in [32005acffc63dce](https://github.com/sophgo/linux-riscv/commit/32005acffc63dce) at 2024-12-05 13:02:12)
    > [ Upstream commit be392aa80f1e5b0b65ccc2a540b9304fefcfe3d8 ]
    > cppc_get_cpu_cost() return 0 if the policy is NULL. Then in
    > em_compute_costs(), the later zero check for cost is not valid
    > as cost is uninitialized. As Quentin pointed out, kernel energy model
    > core check the return value of get_cost() first, so if the callback
    > failed it should tell the core. Return -EINVAL to fix it.
    > Fixes: 1a1374bb8c59 (&quot;cpufreq: CPPC: Fix possible null-ptr-deref for cppc_get_cpu_cost()&quot;)
    > Reported-by: Dan Carpenter &lt;dan.carpenter@linaro.org&gt;
    > Closes: https://lore.kernel.org/all/c4765377-7830-44c2-84fa-706b6e304e10@stanley.mountain/
    > Signed-off-by: Jinjie Ruan &lt;ruanjinjie@huawei.com&gt;
    > Suggested-by: Quentin Perret &lt;qperret@google.com&gt;
    > Signed-off-by: Viresh Kumar &lt;viresh.kumar@linaro.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ x86/tdx: Rename tdx_parse_tdinfo() to tdx_setup() (@Kirill A. Shutemov in [d9ec26acca8fa63](https://github.com/sophgo/linux-riscv/commit/d9ec26acca8fa63) at 2024-12-05 13:02:11)
    > [ Upstream commit b064043d9565786b385f85e6436ca5716bbd5552 ]
    > Rename tdx_parse_tdinfo() to tdx_setup() and move setting NOTIFY_ENABLES
    > there.
    > The function will be extended to adjust TD configuration.
    > Signed-off-by: Kirill A. Shutemov &lt;kirill.shutemov@linux.intel.com&gt;
    > Signed-off-by: Dave Hansen &lt;dave.hansen@linux.intel.com&gt;
    > Reviewed-by: Kuppuswamy Sathyanarayanan &lt;sathyanarayanan.kuppuswamy@linux.intel.com&gt;
    > Reviewed-by: Kai Huang &lt;kai.huang@intel.com&gt;
    > Link: https://lore.kernel.org/all/20241104103803.195705-3-kirill.shutemov%40linux.intel.com
    > Stable-dep-of: f65aa0ad79fc (&quot;x86/tdx: Dynamically disable SEPT violations from causing #VEs&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ x86/tdx: Introduce wrappers to read and write TD metadata (@Kirill A. Shutemov in [d1be0ab47a66190](https://github.com/sophgo/linux-riscv/commit/d1be0ab47a66190) at 2024-12-05 13:02:11)
    > [ Upstream commit 5081e8fadb809253c911b349b01d87c5b4e3fec5 ]
    > The TDG_VM_WR TDCALL is used to ask the TDX module to change some
    > TD-specific VM configuration. There is currently only one user in the
    > kernel of this TDCALL leaf.  More will be added shortly.
    > Refactor to make way for more users of TDG_VM_WR who will need to modify
    > other TD configuration values.
    > Add a wrapper for the TDG_VM_RD TDCALL that requests TD-specific
    > metadata from the TDX module. There are currently no users for
    > TDG_VM_RD. Mark it as __maybe_unused until the first user appears.
    > This is preparation for enumeration and enabling optional TD features.
    > Signed-off-by: Kirill A. Shutemov &lt;kirill.shutemov@linux.intel.com&gt;
    > Signed-off-by: Dave Hansen &lt;dave.hansen@linux.intel.com&gt;
    > Reviewed-by: Kai Huang &lt;kai.huang@intel.com&gt;
    > Reviewed-by: Kuppuswamy Sathyanarayanan &lt;sathyanarayanan.kuppuswamy@linux.intel.com&gt;
    > Link: https://lore.kernel.org/all/20241104103803.195705-2-kirill.shutemov%40linux.intel.com
    > Stable-dep-of: f65aa0ad79fc (&quot;x86/tdx: Dynamically disable SEPT violations from causing #VEs&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ scsi: qedf: Fix a possible memory leak in qedf_alloc_and_init_sb() (@Zhen Lei in [78a169dc69fbdaf](https://github.com/sophgo/linux-riscv/commit/78a169dc69fbdaf) at 2024-12-05 13:02:11)
    > [ Upstream commit c62c30429db3eb4ced35c7fcf6f04a61ce3a01bb ]
    > Hook &quot;qed_ops-&gt;common-&gt;sb_init &#x3D; qed_sb_init&quot; does not release the DMA
    > memory sb_virt when it fails. Add dma_free_coherent() to free it. This
    > is the same way as qedr_alloc_mem_sb() and qede_alloc_mem_sb().
    > Fixes: 61d8658b4a43 (&quot;scsi: qedf: Add QLogic FastLinQ offload FCoE driver framework.&quot;)
    > Signed-off-by: Zhen Lei &lt;thunder.leizhen@huawei.com&gt;
    > Link: https://lore.kernel.org/r/20241026125711.484-2-thunder.leizhen@huawei.com
    > Signed-off-by: Martin K. Petersen &lt;martin.petersen@oracle.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ scsi: sg: Enable runtime power management (@Bart Van Assche in [7182f411ee0b9c8](https://github.com/sophgo/linux-riscv/commit/7182f411ee0b9c8) at 2024-12-05 13:02:11)
    > [ Upstream commit 4045de893f691f75193c606aec440c365cf7a7be ]
    > In 2010, runtime power management support was implemented in the SCSI
    > core.  The description of patch &quot;[SCSI] implement runtime Power
    > Management&quot; mentions that the sg driver is skipped but not why. This
    > patch enables runtime power management even if an instance of the sg
    > driver is held open.  Enabling runtime PM for the sg driver is safe
    > because all interactions of the sg driver with the SCSI device pass
    > through the block layer (blk_execute_rq_nowait()) and the block layer
    > already supports runtime PM.
    > Cc: Alan Stern &lt;stern@rowland.harvard.edu&gt;
    > Cc: Douglas Gilbert &lt;dgilbert@interlog.com&gt;
    > Fixes: bc4f24014de5 (&quot;[SCSI] implement runtime Power Management&quot;)
    > Signed-off-by: Bart Van Assche &lt;bvanassche@acm.org&gt;
    > Link: https://lore.kernel.org/r/20241030220310.1373569-1-bvanassche@acm.org
    > Acked-by: Alan Stern &lt;stern@rowland.harvard.edu&gt;
    > Signed-off-by: Martin K. Petersen &lt;martin.petersen@oracle.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ powerpc/fadump: allocate memory for additional parameters early (@Hari Bathini in [561482826a7af22](https://github.com/sophgo/linux-riscv/commit/561482826a7af22) at 2024-12-05 13:02:11)
    > [ Upstream commit f4892c68ecc1cf45e41a78820dd2eebccc945b66 ]
    > Memory for passing additional parameters to fadump capture kernel
    > is allocated during subsys_initcall level, using memblock. But
    > as slab is already available by this time, allocation happens via
    > the buddy allocator. This may work for radix MMU but is likely to
    > fail in most cases for hash MMU as hash MMU needs this memory in
    > the first memory block for it to be accessible in real mode in the
    > capture kernel (second boot). So, allocate memory for additional
    > parameters area as soon as MMU mode is obvious.
    > Fixes: 683eab94da75 (&quot;powerpc/fadump: setup additional parameters for dump capture kernel&quot;)
    > Reported-by: Venkat Rao Bagalkote &lt;venkat88@linux.vnet.ibm.com&gt;
    > Closes: https://lore.kernel.org/lkml/a70e4064-a040-447b-8556-1fd02f19383d@linux.vnet.ibm.com/T/#u
    > Signed-off-by: Hari Bathini &lt;hbathini@linux.ibm.com&gt;
    > Signed-off-by: Sourabh Jain &lt;sourabhjain@linux.ibm.com&gt;
    > Tested-by: Venkat Rao Bagalkote &lt;venkat88@linux.vnet.ibm.com&gt;
    > Signed-off-by: Michael Ellerman &lt;mpe@ellerman.id.au&gt;
    > Link: https://patch.msgid.link/20241107055817.489795-1-sourabhjain@linux.ibm.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ scsi: qedi: Fix a possible memory leak in qedi_alloc_and_init_sb() (@Zhen Lei in [20b775cf274cfbf](https://github.com/sophgo/linux-riscv/commit/20b775cf274cfbf) at 2024-12-05 13:02:11)
    > [ Upstream commit 95bbdca4999bc59a72ebab01663d421d6ce5775d ]
    > Hook &quot;qedi_ops-&gt;common-&gt;sb_init &#x3D; qed_sb_init&quot; does not release the DMA
    > memory sb_virt when it fails. Add dma_free_coherent() to free it. This
    > is the same way as qedr_alloc_mem_sb() and qede_alloc_mem_sb().
    > Fixes: ace7f46ba5fd (&quot;scsi: qedi: Add QLogic FastLinQ offload iSCSI driver framework.&quot;)
    > Signed-off-by: Zhen Lei &lt;thunder.leizhen@huawei.com&gt;
    > Link: https://lore.kernel.org/r/20241026125711.484-3-thunder.leizhen@huawei.com
    > Signed-off-by: Martin K. Petersen &lt;martin.petersen@oracle.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ x86/tdx: Dynamically disable SEPT violations from causing #VEs (@Kirill A. Shutemov in [14ddfc24bfcf618](https://github.com/sophgo/linux-riscv/commit/14ddfc24bfcf618) at 2024-12-05 13:02:11)
    > [ Upstream commit f65aa0ad79fca4ace921da0701644f020129043d ]
    > Memory access #VEs are hard for Linux to handle in contexts like the
    > entry code or NMIs.  But other OSes need them for functionality.
    > There&#x27;s a static (pre-guest-boot) way for a VMM to choose one or the
    > other.  But VMMs don&#x27;t always know which OS they are booting, so they
    > choose to deliver those #VEs so the &quot;other&quot; OSes will work.  That,
    > unfortunately has left us in the lurch and exposed to these
    > hard-to-handle #VEs.
    > The TDX module has introduced a new feature. Even if the static
    > configuration is set to &quot;send nasty #VEs&quot;, the kernel can dynamically
    > request that they be disabled. Once they are disabled, access to private
    > memory that is not in the Mapped state in the Secure-EPT (SEPT) will
    > result in an exit to the VMM rather than injecting a #VE.
    > Check if the feature is available and disable SEPT #VE if possible.
    > If the TD is allowed to disable/enable SEPT #VEs, the ATTR_SEPT_VE_DISABLE
    > attribute is no longer reliable. It reflects the initial state of the
    > control for the TD, but it will not be updated if someone (e.g. bootloader)
    > changes it before the kernel starts. Kernel must check TDCS_TD_CTLS bit to
    > determine if SEPT #VEs are enabled or disabled.
    > [ dhansen: remove &#x27;return&#x27; at end of function ]
    > Fixes: 373e715e31bf (&quot;x86/tdx: Panic on bad configs that #VE on &quot;private&quot; memory access&quot;)
    > Signed-off-by: Kirill A. Shutemov &lt;kirill.shutemov@linux.intel.com&gt;
    > Signed-off-by: Dave Hansen &lt;dave.hansen@linux.intel.com&gt;
    > Acked-by: Kai Huang &lt;kai.huang@intel.com&gt;
    > Link: https://lore.kernel.org/all/20241104103803.195705-4-kirill.shutemov%40linux.intel.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ mfd: rt5033: Fix missing regmap_del_irq_chip() (@Zhang Changzhong in [f6b239238c1efd1](https://github.com/sophgo/linux-riscv/commit/f6b239238c1efd1) at 2024-12-05 13:02:10)
    > [ Upstream commit d256d612f47529ed0b332298e2d5ea981a4dd5b8 ]
    > Fix missing call to regmap_del_irq_chip() in error handling path by
    > using devm_regmap_add_irq_chip().
    > Fixes: 0b271258544b (&quot;mfd: rt5033: Add Richtek RT5033 driver core.&quot;)
    > Signed-off-by: Zhang Changzhong &lt;zhangchangzhong@huawei.com&gt;
    > Link: https://lore.kernel.org/r/1730302867-8391-1-git-send-email-zhangchangzhong@huawei.com
    > Signed-off-by: Lee Jones &lt;lee@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ leds: max5970: Fix unreleased fwnode_handle in probe function (@Javier Carrasco in [de60d39e08aa2a3](https://github.com/sophgo/linux-riscv/commit/de60d39e08aa2a3) at 2024-12-05 13:02:10)
    > [ Upstream commit 02f58f97419c828f58e30f24f54395ac9be159c0 ]
    > An object initialized via device_get_named_child_node() requires calls
    > to fwnode_handle_put() when it is no longer required to avoid leaking
    > memory.
    > Add the automatic cleanup facility for &#x27;led_node&#x27; to ensure that
    > fwnode_handle_put() is called in all execution paths.
    > Fixes: 736214b4b02a (&quot;leds: max5970: Add support for max5970&quot;)
    > Signed-off-by: Javier Carrasco &lt;javier.carrasco.cruz@gmail.com&gt;
    > Link: https://lore.kernel.org/r/20241031-max5970-of_node_put-v2-1-0ffe1f1d3bc9@gmail.com
    > Signed-off-by: Lee Jones &lt;lee@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ fs/proc/kcore.c: fix coccinelle reported ERROR instances (@Mirsad Todorovac in [c3cbeab93b76ea1](https://github.com/sophgo/linux-riscv/commit/c3cbeab93b76ea1) at 2024-12-05 13:02:10)
    > [ Upstream commit 82e33f249f1126cf3c5f39a31b850d485ac33bc3 ]
    > Coccinelle complains about the nested reuse of the pointer &#x60;iter&#x27; with
    > different pointer type:
    > ./fs/proc/kcore.c:515:26-30: ERROR: invalid reference to the index variable of the iterator on line 499
    > ./fs/proc/kcore.c:534:23-27: ERROR: invalid reference to the index variable of the iterator on line 499
    > ./fs/proc/kcore.c:550:40-44: ERROR: invalid reference to the index variable of the iterator on line 499
    > ./fs/proc/kcore.c:568:27-31: ERROR: invalid reference to the index variable of the iterator on line 499
    > ./fs/proc/kcore.c:581:28-32: ERROR: invalid reference to the index variable of the iterator on line 499
    > ./fs/proc/kcore.c:599:27-31: ERROR: invalid reference to the index variable of the iterator on line 499
    > ./fs/proc/kcore.c:607:38-42: ERROR: invalid reference to the index variable of the iterator on line 499
    > ./fs/proc/kcore.c:614:26-30: ERROR: invalid reference to the index variable of the iterator on line 499
    > Replacing &#x60;struct kcore_list *iter&#x27; with &#x60;struct kcore_list *tmp&#x27; doesn&#x27;t change the
    > scope and the functionality is the same and coccinelle seems happy.
    > NOTE: There was an issue with using &#x60;struct kcore_list *pos&#x27; as the nested iterator.
    > The build did not work!
    > [akpm@linux-foundation.org: s/tmp/pos/]
    > Link: https://lkml.kernel.org/r/20241029054651.86356-2-mtodorovac69@gmail.com
    > Link: https://lore.kernel.org/all/CAHk-&#x3D;wgRr_D8CB-D9Kg-c&#x3D;EHreAsk5SqXPwr9Y7k9sA6cWXJ6w@mail.gmail.com/ [1]
    > Link: https://lkml.kernel.org/r/20220331223700.902556-1-jakobkoschel@gmail.com
    > Fixes: 04d168c6d42d (&quot;fs/proc/kcore.c: remove check of list iterator against head past the loop body&quot;)
    > Signed-off-by: Jakob Koschel &lt;jakobkoschel@gmail.com&gt;
    > Signed-off-by: Mirsad Todorovac &lt;mtodorovac69@gmail.com&gt;
    > Cc: Mike Rapoport &lt;rppt@kernel.org&gt;
    > Cc: David Hildenbrand &lt;david@redhat.com&gt;
    > Cc: Oscar Salvador &lt;osalvador@suse.de&gt;
    > Cc: &quot;Brian Johannesmeyer&quot; &lt;bjohannesmeyer@gmail.com&gt;
    > Cc: Cristiano Giuffrida &lt;c.giuffrida@vu.nl&gt;
    > Cc: &quot;Bos, H.J.&quot; &lt;h.j.bos@vu.nl&gt;
    > Cc: Alexey Dobriyan &lt;adobriyan@gmail.com&gt;
    > Cc: Andrew Morton &lt;akpm@linux-foundation.org&gt;
    > Cc: Yang Li &lt;yang.lee@linux.alibaba.com&gt;
    > Cc: Baoquan He &lt;bhe@redhat.com&gt;
    > Cc: Hari Bathini &lt;hbathini@linux.ibm.com&gt;
    > Cc: Yan Zhen &lt;yanzhen@vivo.com&gt;
    > Cc: Alexander Gordeev &lt;agordeev@linux.ibm.com&gt;
    > Signed-off-by: Andrew Morton &lt;akpm@linux-foundation.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ scsi: bfa: Fix use-after-free in bfad_im_module_exit() (@Ye Bin in [a2b5035ab0e368e](https://github.com/sophgo/linux-riscv/commit/a2b5035ab0e368e) at 2024-12-05 13:02:10)
    > [ Upstream commit 178b8f38932d635e90f5f0e9af1986c6f4a89271 ]
    > BUG: KASAN: slab-use-after-free in __lock_acquire+0x2aca/0x3a20
    > Read of size 8 at addr ffff8881082d80c8 by task modprobe/25303
    > Call Trace:
    > &lt;TASK&gt;
    > dump_stack_lvl+0x95/0xe0
    > print_report+0xcb/0x620
    > kasan_report+0xbd/0xf0
    > __lock_acquire+0x2aca/0x3a20
    > lock_acquire+0x19b/0x520
    > _raw_spin_lock+0x2b/0x40
    > attribute_container_unregister+0x30/0x160
    > fc_release_transport+0x19/0x90 [scsi_transport_fc]
    > bfad_im_module_exit+0x23/0x60 [bfa]
    > bfad_init+0xdb/0xff0 [bfa]
    > do_one_initcall+0xdc/0x550
    > do_init_module+0x22d/0x6b0
    > load_module+0x4e96/0x5ff0
    > init_module_from_file+0xcd/0x130
    > idempotent_init_module+0x330/0x620
    > __x64_sys_finit_module+0xb3/0x110
    > do_syscall_64+0xc1/0x1d0
    > entry_SYSCALL_64_after_hwframe+0x77/0x7f
    > &lt;/TASK&gt;
    > Allocated by task 25303:
    > kasan_save_stack+0x24/0x50
    > kasan_save_track+0x14/0x30
    > __kasan_kmalloc+0x7f/0x90
    > fc_attach_transport+0x4f/0x4740 [scsi_transport_fc]
    > bfad_im_module_init+0x17/0x80 [bfa]
    > bfad_init+0x23/0xff0 [bfa]
    > do_one_initcall+0xdc/0x550
    > do_init_module+0x22d/0x6b0
    > load_module+0x4e96/0x5ff0
    > init_module_from_file+0xcd/0x130
    > idempotent_init_module+0x330/0x620
    > __x64_sys_finit_module+0xb3/0x110
    > do_syscall_64+0xc1/0x1d0
    > entry_SYSCALL_64_after_hwframe+0x77/0x7f
    > Freed by task 25303:
    > kasan_save_stack+0x24/0x50
    > kasan_save_track+0x14/0x30
    > kasan_save_free_info+0x3b/0x60
    > __kasan_slab_free+0x38/0x50
    > kfree+0x212/0x480
    > bfad_im_module_init+0x7e/0x80 [bfa]
    > bfad_init+0x23/0xff0 [bfa]
    > do_one_initcall+0xdc/0x550
    > do_init_module+0x22d/0x6b0
    > load_module+0x4e96/0x5ff0
    > init_module_from_file+0xcd/0x130
    > idempotent_init_module+0x330/0x620
    > __x64_sys_finit_module+0xb3/0x110
    > do_syscall_64+0xc1/0x1d0
    > entry_SYSCALL_64_after_hwframe+0x77/0x7f
    > Above issue happens as follows:
    > bfad_init
    > error &#x3D; bfad_im_module_init()
    > fc_release_transport(bfad_im_scsi_transport_template);
    > if (error)
    > goto ext;
    > ext:
    > bfad_im_module_exit();
    > fc_release_transport(bfad_im_scsi_transport_template);
    > --&gt; Trigger double release
    > Don&#x27;t call bfad_im_module_exit() if bfad_im_module_init() failed.
    > Fixes: 7725ccfda597 (&quot;[SCSI] bfa: Brocade BFA FC SCSI driver&quot;)
    > Signed-off-by: Ye Bin &lt;yebin10@huawei.com&gt;
    > Link: https://lore.kernel.org/r/20241023011809.63466-1-yebin@huaweicloud.com
    > Signed-off-by: Martin K. Petersen &lt;martin.petersen@oracle.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ scsi: target: Fix incorrect function name in pscsi_create_type_disk() (@Baolin Liu in [a26feee1aea6478](https://github.com/sophgo/linux-riscv/commit/a26feee1aea6478) at 2024-12-05 13:02:10)
    > [ Upstream commit da5aeca99dd0b6c7bf6679382756ea6bda195f72 ]
    > In pr_err(), bdev_open_by_path() should be renamed to
    > bdev_file_open_by_path()
    > Fixes: 034f0cf8fdf9 (&quot;target: port block device access to file&quot;)
    > Signed-off-by: Baolin Liu &lt;liubaolin@kylinos.cn&gt;
    > Link: https://lore.kernel.org/r/20241030021800.234980-1-liubaolin12138@163.com
    > Signed-off-by: Martin K. Petersen &lt;martin.petersen@oracle.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ scsi: fusion: Remove unused variable &#x27;rc&#x27; (@Zeng Heng in [85cb213c840e698](https://github.com/sophgo/linux-riscv/commit/85cb213c840e698) at 2024-12-05 13:02:10)
    > [ Upstream commit bd65694223f7ad11c790ab63ad1af87a771192ee ]
    > The return value of scsi_device_reprobe() is currently ignored in
    > _scsih_reprobe_lun(). Fixing the calling code to deal with the potential
    > error is non-trivial, so for now just WARN_ON().
    > The handling of scsi_device_reprobe()&#x27;s return value refers to
    > _scsih_reprobe_lun() and the following link:
    > https://lore.kernel.org/all/094fdbf57487af4f395238c0525b2a560c8f68f0.1469766027.git.calvinowens@fb.com/
    > Fixes: f99be43b3024 (&quot;[SCSI] fusion: power pc and miscellaneous bug fixs&quot;)
    > Signed-off-by: Zeng Heng &lt;zengheng4@huawei.com&gt;
    > Link: https://lore.kernel.org/r/20241024084417.154655-1-zengheng4@huawei.com
    > Signed-off-by: Martin K. Petersen &lt;martin.petersen@oracle.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ leds: ktd2692: Set missing timing properties (@Raymond Hackley in [4b1d0ed978f40b8](https://github.com/sophgo/linux-riscv/commit/4b1d0ed978f40b8) at 2024-12-05 13:02:10)
    > [ Upstream commit 95c65546f03f888481eda98b499947252e1f3b20 ]
    > props.timing is not set after commit b5a8c50e5c18 (&quot;leds: ktd2692: Convert
    > to use ExpressWire library&quot;). Set it with ktd2692_timing.
    > Fixes: b5a8c50e5c18 (&quot;leds: ktd2692: Convert to use ExpressWire library&quot;)
    > Signed-off-by: Raymond Hackley &lt;raymondhackley@protonmail.com&gt;
    > Acked-by: Duje Mihanović &lt;duje.mihanovic@skole.hr&gt;
    > Link: https://lore.kernel.org/r/20241103083505.49648-1-raymondhackley@protonmail.com
    > Signed-off-by: Lee Jones &lt;lee@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ clk: imx: fracn-gppll: fix pll power up (@Peng Fan in [9294e07ddb900f3](https://github.com/sophgo/linux-riscv/commit/9294e07ddb900f3) at 2024-12-05 13:02:09)
    > [ Upstream commit ff4279618f0aec350b0fb41b2b35841324fbd96e ]
    > To i.MX93 which features dual Cortex-A55 cores and DSU, when using
    > writel_relaxed to write value to PLL registers, the value might be
    > buffered. To make sure the value has been written into the hardware,
    > using readl to read back the register could achieve the goal.
    > current PLL power up flow can be simplified as below:
    > 1. writel_relaxed to set the PLL POWERUP bit;
    > 2. readl_poll_timeout to check the PLL lock bit:
    > a). timeout &#x3D; ktime_add_us(ktime_get(), timeout_us);
    > b). readl the pll the lock reg;
    > c). check if the pll lock bit ready
    > d). check if timeout
    > But in some corner cases, both the write in step 1 and read in
    > step 2 will be blocked by other bus transaction in the SoC for a
    > long time, saying the value into real hardware is just before step b).
    > That means the timeout counting has begins for quite sometime since
    > step a), but value still not written into real hardware until bus
    > released just at a point before step b).
    > Then there maybe chances that the pll lock bit is not ready
    > when readl done but the timeout happens. readl_poll_timeout will
    > err return due to timeout. To avoid such unexpected failure,
    > read back the reg to make sure the write has been done in HW
    > reg.
    > So use readl after writel_relaxed to fix the issue.
    > Since we are here, to avoid udelay to run before writel_relaxed, use
    > readl before udelay.
    > Fixes: 1b26cb8a77a4 (&quot;clk: imx: support fracn gppll&quot;)
    > Co-developed-by: Jacky Bai &lt;ping.bai@nxp.com&gt;
    > Signed-off-by: Jacky Bai &lt;ping.bai@nxp.com&gt;
    > Signed-off-by: Peng Fan &lt;peng.fan@nxp.com&gt;
    > Reviewed-by: Abel Vesa &lt;abel.vesa@linaro.org&gt;
    > Link: https://lore.kernel.org/r/20241027-imx-clk-v1-v3-3-89152574d1d7@nxp.com
    > Signed-off-by: Abel Vesa &lt;abel.vesa@linaro.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ checkpatch: always parse orig_commit in fixes tag (@Tamir Duberstein in [87e17b13d24e35d](https://github.com/sophgo/linux-riscv/commit/87e17b13d24e35d) at 2024-12-05 13:02:09)
    > [ Upstream commit 2f07b652384969f5d0b317e1daa5f2eb967bc73d ]
    > Do not require the presence of &#x60;$balanced_parens&#x60; to get the commit SHA;
    > this allows a &#x60;Fixes: deadbeef&#x60; tag to get a correct suggestion rather
    > than a suggestion containing a reference to HEAD.
    > Given this patch:
    > : From: Tamir Duberstein &lt;tamird@gmail.com&gt;
    > : Subject: Test patch
    > : Date: Fri, 25 Oct 2024 19:30:51 -0400
    > :
    > : This is a test patch.
    > :
    > : Fixes: bd17e036b495
    > : Signed-off-by: Tamir Duberstein &lt;tamird@gmail.com&gt;
    > : --- /dev/null
    > : +++ b/new-file
    > : @@ -0,0 +1 @@
    > : +Test.
    > Before:
    > WARNING: Please use correct Fixes: style &#x27;Fixes: &lt;12 chars of sha1&gt; (&quot;&lt;title line&gt;&quot;)&#x27; - ie: &#x27;Fixes: c10a7d25e68f (&quot;Test patch&quot;)&#x27;
    > After:
    > WARNING: Please use correct Fixes: style &#x27;Fixes: &lt;12 chars of sha1&gt; (&quot;&lt;title line&gt;&quot;)&#x27; - ie: &#x27;Fixes: bd17e036b495 (&quot;checkpatch: warn for non-standard fixes tag style&quot;)&#x27;
    > The prior behavior incorrectly suggested the patch&#x27;s own SHA and title
    > line rather than the referenced commit&#x27;s.  This fixes that.
    > Ironically this:
    > Fixes: bd17e036b495 (&quot;checkpatch: warn for non-standard fixes tag style&quot;)
    > Signed-off-by: Tamir Duberstein &lt;tamird@gmail.com&gt;
    > Cc: Andy Whitcroft &lt;apw@canonical.com&gt;
    > Cc: Dwaipayan Ray &lt;dwaipayanray1@gmail.com&gt;
    > Cc: Joe Perches &lt;joe@perches.com&gt;
    > Cc: Louis Peens &lt;louis.peens@corigine.com&gt;
    > Cc: Lukas Bulwahn &lt;lukas.bulwahn@gmail.com&gt;
    > Cc: Niklas Söderlund &lt;niklas.soderlund+renesas@ragnatech.se&gt;
    > Cc: Philippe Schenker &lt;philippe.schenker@toradex.com&gt;
    > Cc: Simon Horman &lt;horms@kernel.org&gt;
    > Signed-off-by: Andrew Morton &lt;akpm@linux-foundation.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ clk: imx: clk-scu: fix clk enable state save and restore (@Dong Aisheng in [5656eb9aa1c04ff](https://github.com/sophgo/linux-riscv/commit/5656eb9aa1c04ff) at 2024-12-05 13:02:09)
    > [ Upstream commit e81361f6cf9bf4a1848b0813bc4becb2250870b8 ]
    > The scu clk_ops only inplements prepare() and unprepare() callback.
    > Saving the clock state during suspend by checking clk_hw_is_enabled()
    > is not safe as it&#x27;s possible that some device drivers may only
    > disable the clocks without unprepare. Then the state retention will not
    > work for such clocks.
    > Fixing it by checking clk_hw_is_prepared() which is more reasonable
    > and safe.
    > Fixes: d0409631f466 (&quot;clk: imx: scu: add suspend/resume support&quot;)
    > Reviewed-by: Peng Fan &lt;peng.fan@nxp.com&gt;
    > Tested-by: Carlos Song &lt;carlos.song@nxp.com&gt;
    > Signed-off-by: Dong Aisheng &lt;aisheng.dong@nxp.com&gt;
    > Link: https://lore.kernel.org/r/20241027-imx-clk-v1-v3-4-89152574d1d7@nxp.com
    > Signed-off-by: Abel Vesa &lt;abel.vesa@linaro.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ clk: imx: imx8-acm: Fix return value check in clk_imx_acm_attach_pm_domains() (@Yang Yingliang in [53d70449d5e6108](https://github.com/sophgo/linux-riscv/commit/53d70449d5e6108) at 2024-12-05 13:02:09)
    > [ Upstream commit 81a206d736c19139d3863b79e7174f9e98b45499 ]
    > If device_link_add() fails, it returns NULL pointer not ERR_PTR(),
    > replace IS_ERR() with NULL pointer check, and return -EINVAL.
    > Fixes: d3a0946d7ac9 (&quot;clk: imx: imx8: add audio clock mux driver&quot;)
    > Signed-off-by: Yang Yingliang &lt;yangyingliang@huawei.com&gt;
    > Reviewed-by: Peng Fan &lt;peng.fan@nxp.com&gt;
    > Reviewed-by: Abel Vesa &lt;abel.vesa@linaro.org&gt;
    > Link: https://lore.kernel.org/r/20241026112452.1523-1-yangyingliang@huaweicloud.com
    > Signed-off-by: Abel Vesa &lt;abel.vesa@linaro.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ iommu/vt-d: Fix checks and print in dmar_fault_dump_ptes() (@Zhenzhong Duan in [1c0e321244de5e4](https://github.com/sophgo/linux-riscv/commit/1c0e321244de5e4) at 2024-12-05 13:02:09)
    > [ Upstream commit 6ceb93f952f6ca34823ce3650c902c31b8385b40 ]
    > There are some issues in dmar_fault_dump_ptes():
    > 1. return value of phys_to_virt() is used for checking if an entry is
    > present.
    > 2. dump is confusing, e.g., &quot;pasid table entry is not present&quot;, confusing
    > by unpresent pasid table vs. unpresent pasid table entry. Current code
    > means the former.
    > 3. pgtable_walk() is called without checking if page table is present.
    > Fix 1 by checking present bit of an entry before dump a lower level entry.
    > Fix 2 by removing &quot;entry&quot; string, e.g., &quot;pasid table is not present&quot;.
    > Fix 3 by checking page table present before walk.
    > Take issue 3 for example, before fix:
    > [  442.240357] DMAR: pasid dir entry: 0x000000012c83e001
    > [  442.246661] DMAR: pasid table entry[0]: 0x0000000000000000
    > [  442.253429] DMAR: pasid table entry[1]: 0x0000000000000000
    > [  442.260203] DMAR: pasid table entry[2]: 0x0000000000000000
    > [  442.266969] DMAR: pasid table entry[3]: 0x0000000000000000
    > [  442.273733] DMAR: pasid table entry[4]: 0x0000000000000000
    > [  442.280479] DMAR: pasid table entry[5]: 0x0000000000000000
    > [  442.287234] DMAR: pasid table entry[6]: 0x0000000000000000
    > [  442.293989] DMAR: pasid table entry[7]: 0x0000000000000000
    > [  442.300742] DMAR: PTE not present at level 2
    > After fix:
    > ...
    > [  357.241214] DMAR: pasid table entry[6]: 0x0000000000000000
    > [  357.248022] DMAR: pasid table entry[7]: 0x0000000000000000
    > [  357.254824] DMAR: scalable mode page table is not present
    > Fixes: 914ff7719e8a (&quot;iommu/vt-d: Dump DMAR translation structure when DMA fault occurs&quot;)
    > Signed-off-by: Zhenzhong Duan &lt;zhenzhong.duan@intel.com&gt;
    > Link: https://lore.kernel.org/r/20241024092146.715063-2-zhenzhong.duan@intel.com
    > Signed-off-by: Lu Baolu &lt;baolu.lu@linux.intel.com&gt;
    > Signed-off-by: Joerg Roedel &lt;jroedel@suse.de&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ iommu/vt-d: Fix checks and print in pgtable_walk() (@Zhenzhong Duan in [0d780cda1431448](https://github.com/sophgo/linux-riscv/commit/0d780cda1431448) at 2024-12-05 13:02:09)
    > [ Upstream commit f1645676f25d2c846798f0233c3a953efd62aafb ]
    > There are some issues in pgtable_walk():
    > 1. Super page is dumped as non-present page
    > 2. dma_pte_superpage() should not check against leaf page table entries
    > 3. Pointer pte is never NULL so checking it is meaningless
    > 4. When an entry is not present, it still makes sense to dump the entry
    > content.
    > Fix 1,2 by checking dma_pte_superpage()&#x27;s returned value after level check.
    > Fix 3 by removing pte check.
    > Fix 4 by checking present bit after printing.
    > By this chance, change to print &quot;page table not present&quot; instead of &quot;PTE
    > not present&quot; to be clearer.
    > Fixes: 914ff7719e8a (&quot;iommu/vt-d: Dump DMAR translation structure when DMA fault occurs&quot;)
    > Signed-off-by: Zhenzhong Duan &lt;zhenzhong.duan@intel.com&gt;
    > Link: https://lore.kernel.org/r/20241024092146.715063-3-zhenzhong.duan@intel.com
    > Signed-off-by: Lu Baolu &lt;baolu.lu@linux.intel.com&gt;
    > Signed-off-by: Joerg Roedel &lt;jroedel@suse.de&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ riscv: kvm: Fix out-of-bounds array access (@Björn Töpel in [b1af648f0d61066](https://github.com/sophgo/linux-riscv/commit/b1af648f0d61066) at 2024-12-05 13:02:08)
    > [ Upstream commit 332fa4a802b16ccb727199da685294f85f9880cb ]
    > In kvm_riscv_vcpu_sbi_init() the entry-&gt;ext_idx can contain an
    > out-of-bound index. This is used as a special marker for the base
    > extensions, that cannot be disabled. However, when traversing the
    > extensions, that special marker is not checked prior indexing the
    > array.
    > Add an out-of-bounds check to the function.
    > Fixes: 56d8a385b605 (&quot;RISC-V: KVM: Allow some SBI extensions to be disabled by default&quot;)
    > Signed-off-by: Björn Töpel &lt;bjorn@rivosinc.com&gt;
    > Reviewed-by: Anup Patel &lt;anup@brainfault.org&gt;
    > Link: https://lore.kernel.org/r/20241104191503.74725-1-bjorn@kernel.org
    > Signed-off-by: Anup Patel &lt;anup@brainfault.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ RDMA/mlx5: Ensure active slave attachment to the bond IB device (@Chiara Meiohas in [a372f93549158b9](https://github.com/sophgo/linux-riscv/commit/a372f93549158b9) at 2024-12-05 13:02:08)
    > [ Upstream commit 0bd2c61df95321e1ec123017cd8657360d15a24e ]
    > Fix a race condition when creating a lag bond in active backup
    > mode where after the bond creation the backup slave was
    > attached to the IB device, instead of the active slave.
    > This caused stale entries in the GID table, as the gid updating
    > mechanism relies on ib_device_get_netdev(), which would return
    > the backup slave.
    > Send an MLX5_DRIVER_EVENT_ACTIVE_BACKUP_LAG_CHANGE_LOWERSTATE
    > event when activating the lag, additionally to when modifying
    > the lag. This ensures that eventually the active netdevice is
    > stored in the bond IB device.
    > When handling this event remove the GIDs of the previously
    > attached netdevice in this port and rescan the GIDs of the
    > newly attached netdevice.
    > This ensures that eventually the active slave netdevice is
    > correctly stored in the IB device port. While there might be
    > a brief moment where the backup slave GIDs appear in the GID
    > table, it will eventually stabilize with the correct GIDs
    > (of the bond and the active slave).
    > Fixes: 8d159eb2117b (&quot;RDMA/mlx5: Use IB set_netdev and get_netdev functions&quot;)
    > Signed-off-by: Chiara Meiohas &lt;cmeiohas@nvidia.com&gt;
    > Link: https://patch.msgid.link/91fc2cb24f63add266a528c1c702668a80416d9f.1730381292.git.leon@kernel.org
    > Signed-off-by: Leon Romanovsky &lt;leon@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ clk: imx: fracn-gppll: correct PLL initialization flow (@Peng Fan in [913b160dfb23a3f](https://github.com/sophgo/linux-riscv/commit/913b160dfb23a3f) at 2024-12-05 13:02:08)
    > [ Upstream commit 557be501c38e1864b948fc6ccdf4b035d610a2ea ]
    > Per i.MX93 Reference Mannual 22.4 Initialization information
    > 1. Program appropriate value of DIV[ODIV], DIV[RDIV] and DIV[MFI]
    > as per Integer mode.
    > 2. Wait for 5 μs.
    > 3. Program the following field in CTRL register.
    > Set CTRL[POWERUP] to 1&#x27;b1 to enable PLL block.
    > 4. Poll PLL_STATUS[PLL_LOCK] register, and wait till PLL_STATUS[PLL_LOCK]
    > is 1&#x27;b1 and pll_lock output signal is 1&#x27;b1.
    > 5. Set CTRL[CLKMUX_EN] to 1&#x27;b1 to enable PLL output clock.
    > So move the CLKMUX_EN operation after PLL locked.
    > Fixes: 1b26cb8a77a4 (&quot;clk: imx: support fracn gppll&quot;)
    > Co-developed-by: Jacky Bai &lt;ping.bai@nxp.com&gt;
    > Signed-off-by: Jacky Bai &lt;ping.bai@nxp.com&gt;
    > Signed-off-by: Peng Fan &lt;peng.fan@nxp.com&gt;
    > Reviewed-by: Abel Vesa &lt;abel.vesa@linaro.org&gt;
    > Link: https://lore.kernel.org/r/20241027-imx-clk-v1-v3-2-89152574d1d7@nxp.com
    > Signed-off-by: Abel Vesa &lt;abel.vesa@linaro.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ RISC-V: KVM: Fix APLIC in_clrip and clripnum write emulation (@Yong-Xuan Wang in [63b7418a3a748c6](https://github.com/sophgo/linux-riscv/commit/63b7418a3a748c6) at 2024-12-05 13:02:08)
    > [ Upstream commit 60821fb4dd7345e5662094accf0a52845306de8c ]
    > In the section &quot;4.7 Precise effects on interrupt-pending bits&quot;
    > of the RISC-V AIA specification defines that:
    > &quot;If the source mode is Level1 or Level0 and the interrupt domain
    > is configured in MSI delivery mode (domaincfg.DM &#x3D; 1):
    > The pending bit is cleared whenever the rectified input value is
    > low, when the interrupt is forwarded by MSI, or by a relevant
    > write to an in_clrip register or to clripnum.&quot;
    > Update the aplic_write_pending() to match the spec.
    > Fixes: d8dd9f113e16 (&quot;RISC-V: KVM: Fix APLIC setipnum_le/be write emulation&quot;)
    > Signed-off-by: Yong-Xuan Wang &lt;yongxuan.wang@sifive.com&gt;
    > Reviewed-by: Vincent Chen &lt;vincent.chen@sifive.com&gt;
    > Reviewed-by: Anup Patel &lt;anup@brainfault.org&gt;
    > Link: https://lore.kernel.org/r/20241029085542.30541-1-yongxuan.wang@sifive.com
    > Signed-off-by: Anup Patel &lt;anup@brainfault.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ clk: imx: lpcg-scu: SW workaround for errata (e10858) (@Peng Fan in [5766e62eac01d9b](https://github.com/sophgo/linux-riscv/commit/5766e62eac01d9b) at 2024-12-05 13:02:08)
    > [ Upstream commit 5ee063fac85656bea9cfe3570af147ba1701ba18 ]
    > Back-to-back LPCG writes can be ignored by the LPCG register due to
    > a HW bug. The writes need to be separated by at least 4 cycles of
    > the gated clock. See https://www.nxp.com.cn/docs/en/errata/IMX8_1N94W.pdf
    > The workaround is implemented as follows:
    > 1. For clocks running greater than or equal to 24MHz, a read
    > followed by the write will provide sufficient delay.
    > 2. For clocks running below 24MHz, add a delay of 4 clock cylces
    > after the write to the LPCG register.
    > Fixes: 2f77296d3df9 (&quot;clk: imx: add lpcg clock support&quot;)
    > Signed-off-by: Peng Fan &lt;peng.fan@nxp.com&gt;
    > Reviewed-by: Abel Vesa &lt;abel.vesa@linaro.org&gt;
    > Link: https://lore.kernel.org/r/20241027-imx-clk-v1-v3-1-89152574d1d7@nxp.com
    > Signed-off-by: Abel Vesa &lt;abel.vesa@linaro.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ RDMA/core: Implement RoCE GID port rescan and export delete function (@Chiara Meiohas in [3a03f5f2e05cf30](https://github.com/sophgo/linux-riscv/commit/3a03f5f2e05cf30) at 2024-12-05 13:02:08)
    > [ Upstream commit af7a35bf6c36a77624d3abe46b3830b7c2a5f20c ]
    > rdma_roce_rescan_port() scans all network devices in
    > the system and adds the gids if relevant to the RoCE device
    > port. When not in bonding mode it adds the GIDs of the
    > netdevice in this port. When in bonding mode it adds the
    > GIDs of both the port&#x27;s netdevice and the bond master
    > netdevice.
    > Export roce_del_all_netdev_gids(), which  removes all GIDs
    > associated with a specific netdevice for a given port.
    > Signed-off-by: Chiara Meiohas &lt;cmeiohas@nvidia.com&gt;
    > Link: https://patch.msgid.link/674d498da4637a1503ff1367e28bd09ff942fd5e.1730381292.git.leon@kernel.org
    > Signed-off-by: Leon Romanovsky &lt;leon@kernel.org&gt;
    > Stable-dep-of: 0bd2c61df953 (&quot;RDMA/mlx5: Ensure active slave attachment to the bond IB device&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ RDMA/mlx5: Call dev_put() after the blocking notifier (@Chiara Meiohas in [344f598db1fc607](https://github.com/sophgo/linux-riscv/commit/344f598db1fc607) at 2024-12-05 13:02:08)
    > [ Upstream commit 6d9c7b272966f13ebbf39687620f395d97f4d15d ]
    > Move dev_put() call to occur directly after the blocking
    > notifier, instead of within the event handler.
    > Fixes: 8d159eb2117b (&quot;RDMA/mlx5: Use IB set_netdev and get_netdev functions&quot;)
    > Signed-off-by: Chiara Meiohas &lt;cmeiohas@nvidia.com&gt;
    > Link: https://patch.msgid.link/342ff94b3dcbb07da1c7dab862a73933d604b717.1730381292.git.leon@kernel.org
    > Signed-off-by: Leon Romanovsky &lt;leon@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ RDMA/hns: Fix cpu stuck caused by printings during reset (@wenglianfa in [e2e64f9c42c717b](https://github.com/sophgo/linux-riscv/commit/e2e64f9c42c717b) at 2024-12-05 13:02:07)
    > [ Upstream commit 323275ac2ff15b2b7b3eac391ae5d8c5a3c3a999 ]
    > During reset, cmd to destroy resources such as qp, cq, and mr may fail,
    > and error logs will be printed. When a large number of resources are
    > destroyed, there will be lots of printings, and it may lead to a cpu
    > stuck.
    > Delete some unnecessary printings and replace other printing functions
    > in these paths with the ratelimited version.
    > Fixes: 9a4435375cd1 (&quot;IB/hns: Add driver files for hns RoCE driver&quot;)
    > Fixes: c7bcb13442e1 (&quot;RDMA/hns: Add SRQ support for hip08 kernel mode&quot;)
    > Fixes: 70f92521584f (&quot;RDMA/hns: Use the reserved loopback QPs to free MR before destroying MPT&quot;)
    > Fixes: 926a01dc000d (&quot;RDMA/hns: Add QP operations support for hip08 SoC&quot;)
    > Signed-off-by: wenglianfa &lt;wenglianfa@huawei.com&gt;
    > Signed-off-by: Junxian Huang &lt;huangjunxian6@hisilicon.com&gt;
    > Link: https://patch.msgid.link/20241024124000.2931869-6-huangjunxian6@hisilicon.com
    > Signed-off-by: Leon Romanovsky &lt;leon@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ RDMA/rxe: Fix the qp flush warnings in req (@Zhu Yanjun in [cc341b5d761a8a1](https://github.com/sophgo/linux-riscv/commit/cc341b5d761a8a1) at 2024-12-05 13:02:07)
    > [ Upstream commit ea4c990fa9e19ffef0648e40c566b94ba5ab31be ]
    > When the qp is in error state, the status of WQEs in the queue should be
    > set to error. Or else the following will appear.
    > [  920.617269] WARNING: CPU: 1 PID: 21 at drivers/infiniband/sw/rxe/rxe_comp.c:756 rxe_completer+0x989/0xcc0 [rdma_rxe]
    > [  920.617744] Modules linked in: rnbd_client(O) rtrs_client(O) rtrs_core(O) rdma_ucm rdma_cm iw_cm ib_cm crc32_generic rdma_rxe ip6_udp_tunnel udp_tunnel ib_uverbs ib_core loop brd null_blk ipv6
    > [  920.618516] CPU: 1 PID: 21 Comm: ksoftirqd/1 Tainted: G           O       6.1.113-storage+ #65
    > [  920.618986] Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
    > [  920.619396] RIP: 0010:rxe_completer+0x989/0xcc0 [rdma_rxe]
    > [  920.619658] Code: 0f b6 84 24 3a 02 00 00 41 89 84 24 44 04 00 00 e9 2a f7 ff ff 39 ca bb 03 00 00 00 b8 0e 00 00 00 48 0f 45 d8 e9 15 f7 ff ff &lt;0f&gt; 0b e9 cb f8 ff ff 41 bf f5 ff ff ff e9 08 f8 ff ff 49 8d bc 24
    > [  920.620482] RSP: 0018:ffff97b7c00bbc38 EFLAGS: 00010246
    > [  920.620817] RAX: 0000000000000000 RBX: 000000000000000c RCX: 0000000000000008
    > [  920.621183] RDX: ffff960dc396ebc0 RSI: 0000000000005400 RDI: ffff960dc4e2fbac
    > [  920.621548] RBP: 0000000000000000 R08: 0000000000000001 R09: ffffffffac406450
    > [  920.621884] R10: ffffffffac4060c0 R11: 0000000000000001 R12: ffff960dc4e2f800
    > [  920.622254] R13: ffff960dc4e2f928 R14: ffff97b7c029c580 R15: 0000000000000000
    > [  920.622609] FS:  0000000000000000(0000) GS:ffff960ef7d00000(0000) knlGS:0000000000000000
    > [  920.622979] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
    > [  920.623245] CR2: 00007fa056965e90 CR3: 00000001107f1000 CR4: 00000000000006e0
    > [  920.623680] Call Trace:
    > [  920.623815]  &lt;TASK&gt;
    > [  920.623933]  ? __warn+0x79/0xc0
    > [  920.624116]  ? rxe_completer+0x989/0xcc0 [rdma_rxe]
    > [  920.624356]  ? report_bug+0xfb/0x150
    > [  920.624594]  ? handle_bug+0x3c/0x60
    > [  920.624796]  ? exc_invalid_op+0x14/0x70
    > [  920.624976]  ? asm_exc_invalid_op+0x16/0x20
    > [  920.625203]  ? rxe_completer+0x989/0xcc0 [rdma_rxe]
    > [  920.625474]  ? rxe_completer+0x329/0xcc0 [rdma_rxe]
    > [  920.625749]  rxe_do_task+0x80/0x110 [rdma_rxe]
    > [  920.626037]  rxe_requester+0x625/0xde0 [rdma_rxe]
    > [  920.626310]  ? rxe_cq_post+0xe2/0x180 [rdma_rxe]
    > [  920.626583]  ? do_complete+0x18d/0x220 [rdma_rxe]
    > [  920.626812]  ? rxe_completer+0x1a3/0xcc0 [rdma_rxe]
    > [  920.627050]  rxe_do_task+0x80/0x110 [rdma_rxe]
    > [  920.627285]  tasklet_action_common.constprop.0+0xa4/0x120
    > [  920.627522]  handle_softirqs+0xc2/0x250
    > [  920.627728]  ? sort_range+0x20/0x20
    > [  920.627942]  run_ksoftirqd+0x1f/0x30
    > [  920.628158]  smpboot_thread_fn+0xc7/0x1b0
    > [  920.628334]  kthread+0xd6/0x100
    > [  920.628504]  ? kthread_complete_and_exit+0x20/0x20
    > [  920.628709]  ret_from_fork+0x1f/0x30
    > [  920.628892]  &lt;/TASK&gt;
    > Fixes: ae720bdb703b (&quot;RDMA/rxe: Generate error completion for error requester QP state&quot;)
    > Signed-off-by: Zhu Yanjun &lt;yanjun.zhu@linux.dev&gt;
    > Link: https://patch.msgid.link/20241025152036.121417-1-yanjun.zhu@linux.dev
    > Signed-off-by: Leon Romanovsky &lt;leon@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ RDMA/rxe: Set queue pair cur_qp_state when being queried (@Liu Jian in [b2265efbd80e5c4](https://github.com/sophgo/linux-riscv/commit/b2265efbd80e5c4) at 2024-12-05 13:02:07)
    > [ Upstream commit 775e6d3c8fda41083b16c26d05163fd69f029a62 ]
    > Same with commit e375b9c92985 (&quot;RDMA/cxgb4: Set queue pair state when
    > being queried&quot;). The API for ib_query_qp requires the driver to set
    > cur_qp_state on return, add the missing set.
    > Fixes: 8700e3e7c485 (&quot;Soft RoCE driver&quot;)
    > Signed-off-by: Liu Jian &lt;liujian56@huawei.com&gt;
    > Link: https://patch.msgid.link/20241031092019.2138467-1-liujian56@huawei.com
    > Reviewed-by: Zhu Yanjun &lt;yanjun.zhu@linux.dev&gt;
    > Signed-off-by: Leon Romanovsky &lt;leon@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ RDMA/hns: Use dev_* printings in hem code instead of ibdev_* (@Junxian Huang in [84676c47bef18d1](https://github.com/sophgo/linux-riscv/commit/84676c47bef18d1) at 2024-12-05 13:02:07)
    > [ Upstream commit d81fb6511abf18591befaa5f4a972ffc838690ec ]
    > The hem code is executed before ib_dev is registered, so use dev_*
    > printing instead of ibdev_* to avoid log like this:
    > (null): set HEM address to HW failed!
    > Fixes: 2f49de21f3e9 (&quot;RDMA/hns: Optimize mhop get flow for multi-hop addressing&quot;)
    > Signed-off-by: Junxian Huang &lt;huangjunxian6@hisilicon.com&gt;
    > Link: https://patch.msgid.link/20241024124000.2931869-5-huangjunxian6@hisilicon.com
    > Signed-off-by: Leon Romanovsky &lt;leon@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ clk: sunxi-ng: d1: Fix PLL_AUDIO0 preset (@Andre Przywara in [711f20918a840b8](https://github.com/sophgo/linux-riscv/commit/711f20918a840b8) at 2024-12-05 13:02:07)
    > [ Upstream commit e0f253a52ccee3cf3eb987e99756e20c68a1aac9 ]
    > To work around a limitation in our clock modelling, we try to force two
    > bits in the AUDIO0 PLL to 0, in the CCU probe routine.
    > However the ~ operator only applies to the first expression, and does
    > not cover the second bit, so we end up clearing only bit 1.
    > Group the bit-ORing with parentheses, to make it both clearer to read
    > and actually correct.
    > Fixes: 35b97bb94111 (&quot;clk: sunxi-ng: Add support for the D1 SoC clocks&quot;)
    > Signed-off-by: Andre Przywara &lt;andre.przywara@arm.com&gt;
    > Link: https://patch.msgid.link/20241001105016.1068558-1-andre.przywara@arm.com
    > Signed-off-by: Chen-Yu Tsai &lt;wens@csie.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ clk: renesas: rzg2l: Fix FOUTPOSTDIV clk (@Biju Das in [3feab8bcde10069](https://github.com/sophgo/linux-riscv/commit/3feab8bcde10069) at 2024-12-05 13:02:07)
    > [ Upstream commit dabf72b85f298970e86891b5218459c17b57b26a ]
    > While computing foutpostdiv_rate, the value of params-&gt;pl5_fracin
    > is discarded, which results in the wrong refresh rate. Fix the formula
    > for computing foutpostdiv_rate.
    > Fixes: 1561380ee72f (&quot;clk: renesas: rzg2l: Add FOUTPOSTDIV clk support&quot;)
    > Signed-off-by: Hien Huynh &lt;hien.huynh.px@renesas.com&gt;
    > Signed-off-by: Biju Das &lt;biju.das.jz@bp.renesas.com&gt;
    > Reviewed-by: Geert Uytterhoeven &lt;geert+renesas@glider.be&gt;
    > Link: https://lore.kernel.org/20241024134236.315289-1-biju.das.jz@bp.renesas.com
    > Signed-off-by: Geert Uytterhoeven &lt;geert+renesas@glider.be&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ RDMA/bnxt_re: Check cqe flags to know imm_data vs inv_irkey (@Kashyap Desai in [2d4e490375dfee9](https://github.com/sophgo/linux-riscv/commit/2d4e490375dfee9) at 2024-12-05 13:02:07)
    > [ Upstream commit 808ca6de989c598bc5af1ae0ad971a66077efac0 ]
    > Invalidate rkey is cpu endian and immediate data is in big endian format.
    > Both immediate data and invalidate the remote key returned by
    > HW is in little endian format.
    > While handling the commit in fixes tag, the difference between
    > immediate data and invalidate rkey endianness was not considered.
    > Without changes of this patch, Kernel ULP was failing while processing
    > inv_rkey.
    > dmesg log snippet -
    > nvme nvme0: Bogus remote invalidation for rkey 0x2000019Fix in this patch
    > Do endianness conversion based on completion queue entry flag.
    > Also, the HW completions are already converted to host endianness in
    > bnxt_qplib_cq_process_res_rc and bnxt_qplib_cq_process_res_ud and there
    > is no need to convert it again in bnxt_re_poll_cq. Modified the union to
    > hold the correct data type.
    > Fixes: 95b087f87b78 (&quot;bnxt_re: Fix imm_data endianness&quot;)
    > Signed-off-by: Kashyap Desai &lt;kashyap.desai@broadcom.com&gt;
    > Signed-off-by: Selvin Xavier &lt;selvin.xavier@broadcom.com&gt;
    > Link: https://patch.msgid.link/1730110014-20755-1-git-send-email-selvin.xavier@broadcom.com
    > Signed-off-by: Leon Romanovsky &lt;leon@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ iommu/amd/pgtbl_v2: Take protection domain lock before invalidating TLB (@Vasant Hegde in [e72d62a340489a1](https://github.com/sophgo/linux-riscv/commit/e72d62a340489a1) at 2024-12-05 13:02:06)
    > [ Upstream commit 016991606aa01c4d92e6941be636c0c897aa05c7 ]
    > Commit c7fc12354be0 (&quot;iommu/amd/pgtbl_v2: Invalidate updated page ranges
    > only&quot;) missed to take domain lock before calling
    > amd_iommu_domain_flush_pages(). Fix this by taking protection domain
    > lock before calling TLB invalidation function.
    > Fixes: c7fc12354be0 (&quot;iommu/amd/pgtbl_v2: Invalidate updated page ranges only&quot;)
    > Signed-off-by: Vasant Hegde &lt;vasant.hegde@amd.com&gt;
    > Reviewed-by: Jason Gunthorpe &lt;jgg@nvidia.com&gt;
    > Link: https://lore.kernel.org/r/20241030063556.6104-2-vasant.hegde@amd.com
    > Signed-off-by: Joerg Roedel &lt;jroedel@suse.de&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ cpufreq: CPPC: Fix possible null-ptr-deref for cppc_get_cpu_cost() (@Jinjie Ruan in [6be57617a38b3f3](https://github.com/sophgo/linux-riscv/commit/6be57617a38b3f3) at 2024-12-05 13:02:06)
    > [ Upstream commit 1a1374bb8c5926674973d849feed500bc61ad535 ]
    > cpufreq_cpu_get_raw() may return NULL if the cpu is not in
    > policy-&gt;cpus cpu mask and it will cause null pointer dereference,
    > so check NULL for cppc_get_cpu_cost().
    > Fixes: 740fcdc2c20e (&quot;cpufreq: CPPC: Register EM based on efficiency class information&quot;)
    > Signed-off-by: Jinjie Ruan &lt;ruanjinjie@huawei.com&gt;
    > Signed-off-by: Viresh Kumar &lt;viresh.kumar@linaro.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ cpufreq: CPPC: Fix possible null-ptr-deref for cpufreq_cpu_get_raw() (@Jinjie Ruan in [65fe2f7fdafe269](https://github.com/sophgo/linux-riscv/commit/65fe2f7fdafe269) at 2024-12-05 13:02:06)
    > [ Upstream commit a78e7207564258db6e373e86294a85f9d646d35a ]
    > cpufreq_cpu_get_raw() may return NULL if the cpu is not in
    > policy-&gt;cpus cpu mask and it will cause null pointer dereference.
    > Fixes: 740fcdc2c20e (&quot;cpufreq: CPPC: Register EM based on efficiency class information&quot;)
    > Signed-off-by: Jinjie Ruan &lt;ruanjinjie@huawei.com&gt;
    > Signed-off-by: Viresh Kumar &lt;viresh.kumar@linaro.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ RDMA/hns: Fix an AEQE overflow error caused by untimely update of eq_db_ci (@wenglianfa in [657c7fe24b1c986](https://github.com/sophgo/linux-riscv/commit/657c7fe24b1c986) at 2024-12-05 13:02:06)
    > [ Upstream commit 571e4ab8a45e530623ab129803f090a844dd3fe9 ]
    > eq_db_ci is updated only after all AEQEs are processed in the AEQ
    > interrupt handler, which is not timely enough and may result in
    > AEQ overflow. Two optimization methods are proposed:
    > 1. Set an upper limit for AEQE processing.
    > 2. Move time-consuming operations such as printings to the bottom
    > half of the interrupt.
    > cmd events and flush_cqe events are still fully processed in the top half
    > to ensure timely handling.
    > Fixes: a5073d6054f7 (&quot;RDMA/hns: Add eq support of hip08&quot;)
    > Signed-off-by: wenglianfa &lt;wenglianfa@huawei.com&gt;
    > Signed-off-by: Junxian Huang &lt;huangjunxian6@hisilicon.com&gt;
    > Link: https://patch.msgid.link/20241024124000.2931869-2-huangjunxian6@hisilicon.com
    > Signed-off-by: Leon Romanovsky &lt;leon@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ powerpc/pseries: Fix dtl_access_lock to be a rw_semaphore (@Michael Ellerman in [525e18f1ba7c2b0](https://github.com/sophgo/linux-riscv/commit/525e18f1ba7c2b0) at 2024-12-05 13:02:06)
    > [ Upstream commit cadae3a45d23aa4f6485938a67cbc47aaaa25e38 ]
    > The dtl_access_lock needs to be a rw_sempahore, a sleeping lock, because
    > the code calls kmalloc() while holding it, which can sleep:
    > # echo 1 &gt; /proc/powerpc/vcpudispatch_stats
    > BUG: sleeping function called from invalid context at include/linux/sched/mm.h:337
    > in_atomic(): 1, irqs_disabled(): 0, non_block: 0, pid: 199, name: sh
    > preempt_count: 1, expected: 0
    > 3 locks held by sh/199:
    > #0: c00000000a0743f8 (sb_writers#3){.+.+}-{0:0}, at: vfs_write+0x324/0x438
    > #1: c0000000028c7058 (dtl_enable_mutex){+.+.}-{3:3}, at: vcpudispatch_stats_write+0xd4/0x5f4
    > #2: c0000000028c70b8 (dtl_access_lock){+.+.}-{2:2}, at: vcpudispatch_stats_write+0x220/0x5f4
    > CPU: 0 PID: 199 Comm: sh Not tainted 6.10.0-rc4 #152
    > Hardware name: IBM pSeries (emulated by qemu) POWER9 (raw) 0x4e1202 0xf000005 of:SLOF,HEAD hv:linux,kvm pSeries
    > Call Trace:
    > dump_stack_lvl+0x130/0x148 (unreliable)
    > __might_resched+0x174/0x410
    > kmem_cache_alloc_noprof+0x340/0x3d0
    > alloc_dtl_buffers+0x124/0x1ac
    > vcpudispatch_stats_write+0x2a8/0x5f4
    > proc_reg_write+0xf4/0x150
    > vfs_write+0xfc/0x438
    > ksys_write+0x88/0x148
    > system_call_exception+0x1c4/0x5a0
    > system_call_common+0xf4/0x258
    > Fixes: 06220d78f24a (&quot;powerpc/pseries: Introduce rwlock to gatekeep DTLB usage&quot;)
    > Tested-by: Kajol Jain &lt;kjain@linux.ibm.com&gt;
    > Reviewed-by: Nysal Jan K.A &lt;nysal@linux.ibm.com&gt;
    > Reviewed-by: Kajol Jain &lt;kjain@linux.ibm.com&gt;
    > Signed-off-by: Michael Ellerman &lt;mpe@ellerman.id.au&gt;
    > Link: https://patch.msgid.link/20240819122401.513203-1-mpe@ellerman.id.au
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ RDMA/hns: Modify debugfs name (@Yuyu Li in [4997f0cccb46d21](https://github.com/sophgo/linux-riscv/commit/4997f0cccb46d21) at 2024-12-05 13:02:06)
    > [ Upstream commit 370a9351bf84afc5a56a3f02ba3805bbfcb53c32 ]
    > The sub-directory of hns_roce debugfs is named after the device&#x27;s
    > kernel name currently, but it will be inconvenient to use when
    > the device is renamed.
    > Modify the name to pci name as users can always easily find the
    > correspondence between an RDMA device and its pci name.
    > Fixes: eb7854d63db5 (&quot;RDMA/hns: Support SW stats with debugfs&quot;)
    > Signed-off-by: Yuyu Li &lt;liyuyu6@huawei.com&gt;
    > Signed-off-by: Junxian Huang &lt;huangjunxian6@hisilicon.com&gt;
    > Link: https://patch.msgid.link/20241024124000.2931869-4-huangjunxian6@hisilicon.com
    > Signed-off-by: Leon Romanovsky &lt;leon@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ RDMA/hns: Fix flush cqe error when racing with destroy qp (@wenglianfa in [15e199c5f6c18e1](https://github.com/sophgo/linux-riscv/commit/15e199c5f6c18e1) at 2024-12-05 13:02:06)
    > [ Upstream commit 377a2097705b915325a67e4d44f9f2844e567809 ]
    > QP needs to be modified to IB_QPS_ERROR to trigger HW flush cqe. But
    > when this process races with destroy qp, the destroy-qp process may
    > modify the QP to IB_QPS_RESET first. In this case flush cqe will fail
    > since it is invalid to modify qp from IB_QPS_RESET to IB_QPS_ERROR.
    > Add lock and bit flag to make sure pending flush cqe work is completed
    > first and no more new works will be added.
    > Fixes: ffd541d45726 (&quot;RDMA/hns: Add the workqueue framework for flush cqe handler&quot;)
    > Signed-off-by: wenglianfa &lt;wenglianfa@huawei.com&gt;
    > Signed-off-by: Junxian Huang &lt;huangjunxian6@hisilicon.com&gt;
    > Link: https://patch.msgid.link/20241024124000.2931869-3-huangjunxian6@hisilicon.com
    > Reviewed-by: Zhu Yanjun &lt;yanjun.zhu@linux.dev&gt;
    > Signed-off-by: Leon Romanovsky &lt;leon@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ mtd: rawnand: atmel: Fix possible memory leak (@Miquel Raynal in [8ac19ec818c548c](https://github.com/sophgo/linux-riscv/commit/8ac19ec818c548c) at 2024-12-05 13:02:05)
    > [ Upstream commit 6d734f1bfc336aaea91313a5632f2f197608fadd ]
    > The pmecc &quot;user&quot; structure is allocated in atmel_pmecc_create_user() and
    > was supposed to be freed with atmel_pmecc_destroy_user(), but this other
    > helper is never called. One solution would be to find the proper
    > location to call the destructor, but the trend today is to switch to
    > device managed allocations, which in this case fits pretty well.
    > Replace kzalloc() by devm_kzalloc() and drop the destructor entirely.
    > Reported-by: &quot;Dr. David Alan Gilbert&quot; &lt;linux@treblig.org&gt;
    > Closes: https://lore.kernel.org/all/ZvmIvRJCf6VhHvpo@gallifrey/
    > Fixes: f88fc122cc34 (&quot;mtd: nand: Cleanup/rework the atmel_nand driver&quot;)
    > Signed-off-by: Miquel Raynal &lt;miquel.raynal@bootlin.com&gt;
    > Link: https://lore.kernel.org/linux-mtd/20241001203149.387655-1-miquel.raynal@bootlin.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ mtd: spi-nor: spansion: Use nor-&gt;addr_nbytes in octal DTR mode in RD_ANY_REG_OP (@Takahiro Kuwano in [81af1f63e944260](https://github.com/sophgo/linux-riscv/commit/81af1f63e944260) at 2024-12-05 13:02:05)
    > [ Upstream commit b61c35e3404557779ec427c077f7a9f057bb053d ]
    > In octal DTR mode, RD_ANY_REG_OP needs to use 4-byte address regardless
    > of flash&#x27;s internal address mode. Use nor-&gt;addr_nbytes which is set to 4
    > during setup.
    > Fixes: eff9604390d6 (&quot;mtd: spi-nor: spansion: add octal DTR support in RD_ANY_REG_OP&quot;)
    > Signed-off-by: Takahiro Kuwano &lt;Takahiro.Kuwano@infineon.com&gt;
    > Link: https://lore.kernel.org/r/20241016000837.17951-1-Takahiro.Kuwano@infineon.com
    > Signed-off-by: Tudor Ambarus &lt;tudor.ambarus@linaro.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ iommu/tegra241-cmdqv: Staticize cmdqv_debugfs_dir (@Nicolin Chen in [3d9b1d58c95c36a](https://github.com/sophgo/linux-riscv/commit/3d9b1d58c95c36a) at 2024-12-05 13:02:05)
    > [ Upstream commit 89edbe88db2857880b08ce363a2695eec657f51b ]
    > Fix a sparse warning.
    > Fixes: 918eb5c856f6 (&quot;iommu/arm-smmu-v3: Add in-kernel support for NVIDIA Tegra241 (Grace) CMDQV&quot;)
    > Reported-by: kernel test robot &lt;lkp@intel.com&gt;
    > Closes: https://lore.kernel.org/oe-kbuild-all/202410172003.bRQEReTc-lkp@intel.com/
    > Signed-off-by: Nicolin Chen &lt;nicolinc@nvidia.com&gt;
    > Reviewed-by: Jason Gunthorpe &lt;jgg@nvidia.com&gt;
    > Link: https://lore.kernel.org/r/20241021230847.811218-1-nicolinc@nvidia.com
    > Signed-off-by: Will Deacon &lt;will@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ clk: Allow kunit tests to run without OF_OVERLAY enabled (@Stephen Boyd in [24d7b074da8fc8e](https://github.com/sophgo/linux-riscv/commit/24d7b074da8fc8e) at 2024-12-05 13:02:05)
    > [ Upstream commit 94e6fdd028a12ff2abe7d915f8b6bbdb923cc04d ]
    > Some configurations want to enable CONFIG_KUNIT without enabling
    > CONFIG_OF_OVERLAY. The kunit overlay code already skips if
    > CONFIG_OF_OVERLAY isn&#x27;t enabled, so these selects here aren&#x27;t really
    > doing anything besides making it easier to run the tests without them
    > skipping. Remove the select and move the config setting to the
    > drivers/clk/.kunitconfig file so that the clk tests can be run with or
    > without CONFIG_OF_OVERLAY set to test either behavior.
    > Fixes: 5776526beb95 (&quot;clk: Add KUnit tests for clk fixed rate basic type&quot;)
    > Fixes: 274aff8711b2 (&quot;clk: Add KUnit tests for clks registered with struct clk_parent_data&quot;)
    > Signed-off-by: Stephen Boyd &lt;sboyd@kernel.org&gt;
    > Link: https://lore.kernel.org/r/20241016212738.897691-1-sboyd@kernel.org
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ powerpc/mm/fault: Fix kfence page fault reporting (@Ritesh Harjani (IBM) in [15f78d2c3d14526](https://github.com/sophgo/linux-riscv/commit/15f78d2c3d14526) at 2024-12-05 13:02:05)
    > [ Upstream commit 06dbbb4d5f7126b6307ab807cbf04ecfc459b933 ]
    > copy_from_kernel_nofault() can be called when doing read of /proc/kcore.
    > /proc/kcore can have some unmapped kfence objects which when read via
    > copy_from_kernel_nofault() can cause page faults. Since *_nofault()
    > functions define their own fixup table for handling fault, use that
    > instead of asking kfence to handle such faults.
    > Hence we search the exception tables for the nip which generated the
    > fault. If there is an entry then we let the fixup table handler handle the
    > page fault by returning an error from within ___do_page_fault().
    > This can be easily triggered if someone tries to do dd from /proc/kcore.
    > eg. dd if&#x3D;/proc/kcore of&#x3D;/dev/null bs&#x3D;1M
    > Some example false negatives:
    > &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;
    > BUG: KFENCE: invalid read in copy_from_kernel_nofault+0x9c/0x1a0
    > Invalid read at 0xc0000000fdff0000:
    > copy_from_kernel_nofault+0x9c/0x1a0
    > 0xc00000000665f950
    > read_kcore_iter+0x57c/0xa04
    > proc_reg_read_iter+0xe4/0x16c
    > vfs_read+0x320/0x3ec
    > ksys_read+0x90/0x154
    > system_call_exception+0x120/0x310
    > system_call_vectored_common+0x15c/0x2ec
    > BUG: KFENCE: use-after-free read in copy_from_kernel_nofault+0x9c/0x1a0
    > Use-after-free read at 0xc0000000fe050000 (in kfence-#2):
    > copy_from_kernel_nofault+0x9c/0x1a0
    > 0xc00000000665f950
    > read_kcore_iter+0x57c/0xa04
    > proc_reg_read_iter+0xe4/0x16c
    > vfs_read+0x320/0x3ec
    > ksys_read+0x90/0x154
    > system_call_exception+0x120/0x310
    > system_call_vectored_common+0x15c/0x2ec
    > Fixes: 90cbac0e995d (&quot;powerpc: Enable KFENCE for PPC32&quot;)
    > Suggested-by: Christophe Leroy &lt;christophe.leroy@csgroup.eu&gt;
    > Reported-by: Disha Goel &lt;disgoel@linux.ibm.com&gt;
    > Signed-off-by: Ritesh Harjani (IBM) &lt;ritesh.list@gmail.com&gt;
    > Reviewed-by: Christophe Leroy &lt;christophe.leroy@csgroup.eu&gt;
    > Signed-off-by: Michael Ellerman &lt;mpe@ellerman.id.au&gt;
    > Link: https://patch.msgid.link/a411788081d50e3b136c6270471e35aba3dfafa3.1729271995.git.ritesh.list@gmail.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ clk: sophgo: avoid integer overflow in sg2042_pll_recalc_rate() (@Zichen Xie in [094c8bbc46eb086](https://github.com/sophgo/linux-riscv/commit/094c8bbc46eb086) at 2024-12-05 13:02:05)
    > [ Upstream commit 00f8f70a0e8c6601861628be26270a0b6f4bbb34 ]
    > This was found by a static analyzer.
    > There may be a potential integer overflow issue in
    > sg2042_pll_recalc_rate(). numerator is defined as u64 while
    > parent_rate is defined as unsigned long and ctrl_table.fbdiv
    > is defined as unsigned int. On 32-bit machine, the result of
    > the calculation will be limited to &quot;u32&quot; without correct casting.
    > Integer overflow may occur on high-performance systems.
    > Fixes: 48cf7e01386e (&quot;clk: sophgo: Add SG2042 clock driver&quot;)
    > Signed-off-by: Zichen Xie &lt;zichenxie0106@gmail.com&gt;
    > Reviewed-by: Chen Wang &lt;unicorn_wang@outlook.com&gt;
    > Link: https://lore.kernel.org/r/20241023145146.13130-1-zichenxie0106@gmail.com
    > Reviewed-by: Dan Carpenter &lt;dan.carpenter@linaro.org&gt;
    > Signed-off-by: Stephen Boyd &lt;sboyd@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ mfd: intel_soc_pmic_bxtwc: Use IRQ domain for PMIC devices (@Andy Shevchenko in [b3d45c19bcffb9a](https://github.com/sophgo/linux-riscv/commit/b3d45c19bcffb9a) at 2024-12-05 13:02:04)
    > [ Upstream commit 0350d783ab888cb1cb48ced36cc28b372723f1a4 ]
    > While design wise the idea of converting the driver to use
    > the hierarchy of the IRQ chips is correct, the implementation
    > has (inherited) flaws. This was unveiled when platform_get_irq()
    > had started WARN() on IRQ 0 that is supposed to be a Linux
    > IRQ number (also known as vIRQ).
    > Rework the driver to respect IRQ domain when creating each MFD
    > device separately, as the domain is not the same for all of them.
    > Fixes: 57129044f504 (&quot;mfd: intel_soc_pmic_bxtwc: Use chained IRQs for second level IRQ chips&quot;)
    > Tested-by: Zhang Ning &lt;zhangn1985@outlook.com&gt;
    > Signed-off-by: Andy Shevchenko &lt;andriy.shevchenko@linux.intel.com&gt;
    > Link: https://lore.kernel.org/r/20241005193029.1929139-4-andriy.shevchenko@linux.intel.com
    > Signed-off-by: Lee Jones &lt;lee@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ cpufreq: loongson2: Unregister platform_driver on failure (@Yuan Can in [ab1588d2a364bef](https://github.com/sophgo/linux-riscv/commit/ab1588d2a364bef) at 2024-12-05 13:02:04)
    > [ Upstream commit 5f856d71ccdf89b4bac0ff70ebb0bb582e7f7f18 ]
    > When cpufreq_register_driver() returns error, the cpufreq_init() returns
    > without unregister platform_driver, fix by add missing
    > platform_driver_unregister() when cpufreq_register_driver() failed.
    > Fixes: f8ede0f700f5 (&quot;MIPS: Loongson 2F: Add CPU frequency scaling support&quot;)
    > Signed-off-by: Yuan Can &lt;yuancan@huawei.com&gt;
    > Signed-off-by: Viresh Kumar &lt;viresh.kumar@linaro.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ mtd: hyperbus: rpc-if: Add missing MODULE_DEVICE_TABLE (@Biju Das in [a9d27c6a178b6f4](https://github.com/sophgo/linux-riscv/commit/a9d27c6a178b6f4) at 2024-12-05 13:02:04)
    > [ Upstream commit 7d189579a287d5c568db623c5fc2344cce98a887 ]
    > The rpc-if-hyperflash driver can be compiled as a module, but lacks
    > MODULE_DEVICE_TABLE() and will therefore not be loaded automatically.
    > Fix this.
    > Fixes: 5de15b610f78 (&quot;mtd: hyperbus: add Renesas RPC-IF driver&quot;)
    > Signed-off-by: Biju Das &lt;biju.das.jz@bp.renesas.com&gt;
    > Reviewed-by: Geert Uytterhoeven &lt;geert+renesas@glider.be&gt;
    > Reviewed-by: Vignesh Raghavendra &lt;vigneshr@ti.com&gt;
    > Signed-off-by: Miquel Raynal &lt;miquel.raynal@bootlin.com&gt;
    > Link: https://lore.kernel.org/linux-mtd/20240731080846.257139-1-biju.das.jz@bp.renesas.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ mfd: intel_soc_pmic_bxtwc: Fix IRQ domain names duplication (@Andy Shevchenko in [a1e75a6ee63cb3c](https://github.com/sophgo/linux-riscv/commit/a1e75a6ee63cb3c) at 2024-12-05 13:02:04)
    > [ Upstream commit 3727c0b4ff6ba0e61203544b4c831f7f8899753b ]
    > For all of the devices regmap IRQ may try to created the folder
    > with the same name which is impossible and fails with:
    > debugfs: File &#x27;\_SB.IPC1.PMIC&#x27; in directory &#x27;domains&#x27; already present!
    > Add domain_suffix to all of the IRQ chips driver registers to solve
    > the issue.
    > Fixes: 39d047c0b1c8 (&quot;mfd: add Intel Broxton Whiskey Cove PMIC driver&quot;)
    > Fixes: 957ae5098185 (&quot;platform/x86: Add Whiskey Cove PMIC TMU support&quot;)
    > Fixes: 57129044f504 (&quot;mfd: intel_soc_pmic_bxtwc: Use chained IRQs for second level IRQ chips&quot;)
    > Depends-on: dde286ee5770 (&quot;regmap: Allow setting IRQ domain name suffix&quot;)
    > Signed-off-by: Andy Shevchenko &lt;andriy.shevchenko@linux.intel.com&gt;
    > Link: https://lore.kernel.org/r/20241005193029.1929139-5-andriy.shevchenko@linux.intel.com
    > Signed-off-by: Lee Jones &lt;lee@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ powerpc/fadump: Refactor and prepare fadump_cma_init for late init (@Ritesh Harjani (IBM) in [7528e270fa9973f](https://github.com/sophgo/linux-riscv/commit/7528e270fa9973f) at 2024-12-05 13:02:04)
    > [ Upstream commit adfaec30ffaceecd565e06adae367aa944acc3c9 ]
    > We anyway don&#x27;t use any return values from fadump_cma_init(). Since
    > fadump_reserve_mem() from where fadump_cma_init() gets called today,
    > already has the required checks.
    > This patch makes this function return type as void. Let&#x27;s also handle
    > extra cases like return if fadump_supported is false or dump_active, so
    > that in later patches we can call fadump_cma_init() separately from
    > setup_arch().
    > Acked-by: Hari Bathini &lt;hbathini@linux.ibm.com&gt;
    > Reviewed-by: Madhavan Srinivasan &lt;maddy@linux.ibm.com&gt;
    > Signed-off-by: Ritesh Harjani (IBM) &lt;ritesh.list@gmail.com&gt;
    > Signed-off-by: Michael Ellerman &lt;mpe@ellerman.id.au&gt;
    > Link: https://patch.msgid.link/a2afc3d6481a87a305e89cfc4a3f3d2a0b8ceab3.1729146153.git.ritesh.list@gmail.com
    > Stable-dep-of: 05b94cae1c47 (&quot;powerpc/fadump: Move fadump_cma_init to setup_arch() after initmem_init()&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ powerpc/fadump: Move fadump_cma_init to setup_arch() after initmem_init() (@Ritesh Harjani (IBM) in [7351c5a6507b440](https://github.com/sophgo/linux-riscv/commit/7351c5a6507b440) at 2024-12-05 13:02:04)
    > [ Upstream commit 05b94cae1c47f94588c3e7096963c1007c4d9c1d ]
    > During early init CMA_MIN_ALIGNMENT_BYTES can be PAGE_SIZE,
    > since pageblock_order is still zero and it gets initialized
    > later during initmem_init() e.g.
    > setup_arch() -&gt; initmem_init() -&gt; sparse_init() -&gt; set_pageblock_order()
    > One such use case where this causes issue is -
    > early_setup() -&gt; early_init_devtree() -&gt; fadump_reserve_mem() -&gt; fadump_cma_init()
    > This causes CMA memory alignment check to be bypassed in
    > cma_init_reserved_mem(). Then later cma_activate_area() can hit
    > a VM_BUG_ON_PAGE(pfn &amp; ((1 &lt;&lt; order) - 1)) if the reserved memory
    > area was not pageblock_order aligned.
    > Fix it by moving the fadump_cma_init() after initmem_init(),
    > where other such cma reservations also gets called.
    > &lt;stack trace&gt;
    > &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;
    > page: refcount:0 mapcount:0 mapping:0000000000000000 index:0x0 pfn:0x10010
    > flags: 0x13ffff800000000(node&#x3D;1|zone&#x3D;0|lastcpupid&#x3D;0x7ffff) CMA
    > raw: 013ffff800000000 5deadbeef0000100 5deadbeef0000122 0000000000000000
    > raw: 0000000000000000 0000000000000000 00000000ffffffff 0000000000000000
    > page dumped because: VM_BUG_ON_PAGE(pfn &amp; ((1 &lt;&lt; order) - 1))
    > ------------[ cut here ]------------
    > kernel BUG at mm/page_alloc.c:778!
    > Call Trace:
    > __free_one_page+0x57c/0x7b0 (unreliable)
    > free_pcppages_bulk+0x1a8/0x2c8
    > free_unref_page_commit+0x3d4/0x4e4
    > free_unref_page+0x458/0x6d0
    > init_cma_reserved_pageblock+0x114/0x198
    > cma_init_reserved_areas+0x270/0x3e0
    > do_one_initcall+0x80/0x2f8
    > kernel_init_freeable+0x33c/0x530
    > kernel_init+0x34/0x26c
    > ret_from_kernel_user_thread+0x14/0x1c
    > Fixes: 11ac3e87ce09 (&quot;mm: cma: use pageblock_order as the single alignment&quot;)
    > Suggested-by: David Hildenbrand &lt;david@redhat.com&gt;
    > Reported-by: Sachin P Bappalige &lt;sachinpb@linux.ibm.com&gt;
    > Acked-by: Hari Bathini &lt;hbathini@linux.ibm.com&gt;
    > Reviewed-by: Madhavan Srinivasan &lt;maddy@linux.ibm.com&gt;
    > Signed-off-by: Ritesh Harjani (IBM) &lt;ritesh.list@gmail.com&gt;
    > Signed-off-by: Michael Ellerman &lt;mpe@ellerman.id.au&gt;
    > Link: https://patch.msgid.link/3ae208e48c0d9cefe53d2dc4f593388067405b7d.1729146153.git.ritesh.list@gmail.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ mfd: intel_soc_pmic_bxtwc: Use IRQ domain for TMU device (@Andy Shevchenko in [5bc6d0da4a32fe3](https://github.com/sophgo/linux-riscv/commit/5bc6d0da4a32fe3) at 2024-12-05 13:02:04)
    > [ Upstream commit 9b79d59e6b2b515eb9a22bc469ef7b8f0904fc73 ]
    > While design wise the idea of converting the driver to use
    > the hierarchy of the IRQ chips is correct, the implementation
    > has (inherited) flaws. This was unveiled when platform_get_irq()
    > had started WARN() on IRQ 0 that is supposed to be a Linux
    > IRQ number (also known as vIRQ).
    > Rework the driver to respect IRQ domain when creating each MFD
    > device separately, as the domain is not the same for all of them.
    > Fixes: 957ae5098185 (&quot;platform/x86: Add Whiskey Cove PMIC TMU support&quot;)
    > Fixes: 57129044f504 (&quot;mfd: intel_soc_pmic_bxtwc: Use chained IRQs for second level IRQ chips&quot;)
    > Reported-by: Zhang Ning &lt;zhangn1985@outlook.com&gt;
    > Closes: https://lore.kernel.org/r/TY2PR01MB3322FEDCDC048B7D3794F922CDBA2@TY2PR01MB3322.jpnprd01.prod.outlook.com
    > Tested-by: Zhang Ning &lt;zhangn1985@outlook.com&gt;
    > Acked-by: Hans de Goede &lt;hdegoede@redhat.com&gt;
    > Signed-off-by: Andy Shevchenko &lt;andriy.shevchenko@linux.intel.com&gt;
    > Link: https://lore.kernel.org/r/20241005193029.1929139-3-andriy.shevchenko@linux.intel.com
    > Signed-off-by: Lee Jones &lt;lee@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ iommu/s390: Implement blocking domain (@Matthew Rosato in [bd89d94f3ea6fda](https://github.com/sophgo/linux-riscv/commit/bd89d94f3ea6fda) at 2024-12-05 13:02:03)
    > [ Upstream commit ecda483339a5151e3ca30d6b82691ef6f1d17912 ]
    > This fixes a crash when surprise hot-unplugging a PCI device. This crash
    > happens because during hot-unplug __iommu_group_set_domain_nofail()
    > attaching the default domain fails when the platform no longer
    > recognizes the device as it has already been removed and we end up with
    > a NULL domain pointer and UAF. This is exactly the case referred to in
    > the second comment in __iommu_device_set_domain() and just as stated
    > there if we can instead attach the blocking domain the UAF is prevented
    > as this can handle the already removed device. Implement the blocking
    > domain to use this handling.  With this change, the crash is fixed but
    > we still hit a warning attempting to change DMA ownership on a blocked
    > device.
    > Fixes: c76c067e488c (&quot;s390/pci: Use dma-iommu layer&quot;)
    > Co-developed-by: Niklas Schnelle &lt;schnelle@linux.ibm.com&gt;
    > Signed-off-by: Niklas Schnelle &lt;schnelle@linux.ibm.com&gt;
    > Signed-off-by: Matthew Rosato &lt;mjrosato@linux.ibm.com&gt;
    > Reviewed-by: Niklas Schnelle &lt;schnelle@linux.ibm.com&gt;
    > Reviewed-by: Jason Gunthorpe &lt;jgg@nvidia.com&gt;
    > Link: https://lore.kernel.org/r/20240910211516.137933-1-mjrosato@linux.ibm.com
    > Signed-off-by: Joerg Roedel &lt;jroedel@suse.de&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ mfd: tps65010: Use IRQF_NO_AUTOEN flag in request_irq() to fix race (@Jinjie Ruan in [a20ae042bddfdfb](https://github.com/sophgo/linux-riscv/commit/a20ae042bddfdfb) at 2024-12-05 13:02:03)
    > [ Upstream commit 2174f9a8c9db50f74df769edd5a4ab822c73b6d2 ]
    > As the comment said, disable_irq() after request_irq() still has a
    > time gap in which interrupts can come. request_irq() with IRQF_NO_AUTOEN
    > flag will disable IRQ auto-enable when request IRQ.
    > Fixes: 72cd799544f2 (&quot;[PATCH] I2C: add i2c driver for TPS6501x&quot;)
    > Signed-off-by: Jinjie Ruan &lt;ruanjinjie@huawei.com&gt;
    > Link: https://lore.kernel.org/r/20240912031530.2211654-1-ruanjinjie@huawei.com
    > Signed-off-by: Lee Jones &lt;lee@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ powerpc/vdso: Flag VDSO64 entry points as functions (@Christophe Leroy in [93e640975c0cdc4](https://github.com/sophgo/linux-riscv/commit/93e640975c0cdc4) at 2024-12-05 13:02:03)
    > [ Upstream commit 0161bd38c24312853ed5ae9a425a1c41c4ac674a ]
    > On powerpc64 as shown below by readelf, vDSO functions symbols have
    > type NOTYPE.
    > $ powerpc64-linux-gnu-readelf -a arch/powerpc/kernel/vdso/vdso64.so.dbg
    > ELF Header:
    > Magic:   7f 45 4c 46 02 02 01 00 00 00 00 00 00 00 00 00
    > Class:                             ELF64
    > Data:                              2&#x27;s complement, big endian
    > Version:                           1 (current)
    > OS/ABI:                            UNIX - System V
    > ABI Version:                       0
    > Type:                              DYN (Shared object file)
    > Machine:                           PowerPC64
    > Version:                           0x1
    > ...
    > Symbol table &#x27;.dynsym&#x27; contains 12 entries:
    > Num:    Value          Size Type    Bind   Vis      Ndx Name
    > ...
    > 1: 0000000000000524    84 NOTYPE  GLOBAL DEFAULT    8 __[...]@@LINUX_2.6.15
    > ...
    > 4: 0000000000000000     0 OBJECT  GLOBAL DEFAULT  ABS LINUX_2.6.15
    > 5: 00000000000006c0    48 NOTYPE  GLOBAL DEFAULT    8 __[...]@@LINUX_2.6.15
    > Symbol table &#x27;.symtab&#x27; contains 56 entries:
    > Num:    Value          Size Type    Bind   Vis      Ndx Name
    > ...
    > 45: 0000000000000000     0 OBJECT  GLOBAL DEFAULT  ABS LINUX_2.6.15
    > 46: 00000000000006c0    48 NOTYPE  GLOBAL DEFAULT    8 __kernel_getcpu
    > 47: 0000000000000524    84 NOTYPE  GLOBAL DEFAULT    8 __kernel_clock_getres
    > To overcome that, commit ba83b3239e65 (&quot;selftests: vDSO: fix vDSO
    > symbols lookup for powerpc64&quot;) was applied to have selftests also
    > look for NOTYPE symbols, but the correct fix should be to flag VDSO
    > entry points as functions.
    > The original commit that brought VDSO support into powerpc/64 has the
    > following explanation:
    > Note that the symbols exposed by the vDSO aren&#x27;t &quot;normal&quot; function symbols, apps
    > can&#x27;t be expected to link against them directly, the vDSO&#x27;s are both seen
    > as if they were linked at 0 and the symbols just contain offsets to the
    > various functions.  This is done on purpose to avoid a relocation step
    > (ppc64 functions normally have descriptors with abs addresses in them).
    > When glibc uses those functions, it&#x27;s expected to use it&#x27;s own trampolines
    > that know how to reach them.
    > The descriptors it&#x27;s talking about are the OPD function descriptors
    > used on ABI v1 (big endian). But it would be more correct for a text
    > symbol to have type function, even if there&#x27;s no function descriptor
    > for it.
    > glibc has a special case already for handling the VDSO symbols which
    > creates a fake opd pointing at the kernel symbol. So changing the VDSO
    > symbol type to function shouldn&#x27;t affect that.
    > For ABI v2, there is no function descriptors and VDSO functions can
    > safely have function type.
    > So lets flag VDSO entry points as functions and revert the
    > selftest change.
    > Link: https://github.com/mpe/linux-fullhistory/commit/5f2dd691b62da9d9cc54b938f8b29c22c93cb805
    > Fixes: ba83b3239e65 (&quot;selftests: vDSO: fix vDSO symbols lookup for powerpc64&quot;)
    > Signed-off-by: Christophe Leroy &lt;christophe.leroy@csgroup.eu&gt;
    > Reviewed-By: Segher Boessenkool &lt;segher@kernel.crashing.org&gt;
    > Signed-off-by: Michael Ellerman &lt;mpe@ellerman.id.au&gt;
    > Link: https://patch.msgid.link/b6ad2f1ee9887af3ca5ecade2a56f4acda517a85.1728512263.git.christophe.leroy@csgroup.eu
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ clk: qcom: videocc-sm8550: depend on either gcc-sm8550 or gcc-sm8650 (@Jonathan Marek in [89dc91e58e44ec2](https://github.com/sophgo/linux-riscv/commit/89dc91e58e44ec2) at 2024-12-05 13:02:03)
    > [ Upstream commit aab8d53711346d5569261aec9702b7579eecf1ab ]
    > This driver is compatible with both sm8550 and sm8650, fix the Kconfig
    > entry to reflect that.
    > Fixes: da1f361c887c (&quot;clk: qcom: videocc-sm8550: Add SM8650 video clock controller&quot;)
    > Signed-off-by: Jonathan Marek &lt;jonathan@marek.ca&gt;
    > Reviewed-by: Dmitry Baryshkov &lt;dmitry.baryshkov@linaro.org&gt;
    > Reviewed-by: Neil Armstrong &lt;neil.armstrong@linaro.org&gt;
    > Link: https://lore.kernel.org/r/20241005144047.2226-1-jonathan@marek.ca
    > Signed-off-by: Bjorn Andersson &lt;andersson@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ mfd: intel_soc_pmic_bxtwc: Use IRQ domain for USB Type-C device (@Andy Shevchenko in [87a07a5b0b296e4](https://github.com/sophgo/linux-riscv/commit/87a07a5b0b296e4) at 2024-12-05 13:02:03)
    > [ Upstream commit 686fb77712a4bc94b76a0c5ae74c60118b7a0d79 ]
    > While design wise the idea of converting the driver to use
    > the hierarchy of the IRQ chips is correct, the implementation
    > has (inherited) flaws. This was unveiled when platform_get_irq()
    > had started WARN() on IRQ 0 that is supposed to be a Linux
    > IRQ number (also known as vIRQ).
    > Rework the driver to respect IRQ domain when creating each MFD
    > device separately, as the domain is not the same for all of them.
    > Fixes: 9c6235c86332 (&quot;mfd: intel_soc_pmic_bxtwc: Add bxt_wcove_usbc device&quot;)
    > Fixes: d2061f9cc32d (&quot;usb: typec: add driver for Intel Whiskey Cove PMIC USB Type-C PHY&quot;)
    > Fixes: 57129044f504 (&quot;mfd: intel_soc_pmic_bxtwc: Use chained IRQs for second level IRQ chips&quot;)
    > Reported-by: Zhang Ning &lt;zhangn1985@outlook.com&gt;
    > Closes: https://lore.kernel.org/r/TY2PR01MB3322FEDCDC048B7D3794F922CDBA2@TY2PR01MB3322.jpnprd01.prod.outlook.com
    > Tested-by: Zhang Ning &lt;zhangn1985@outlook.com&gt;
    > Signed-off-by: Andy Shevchenko &lt;andriy.shevchenko@linux.intel.com&gt;
    > Acked-by: Greg Kroah-Hartman &lt;gregkh@linuxfoundation.org&gt;
    > Link: https://lore.kernel.org/r/20241005193029.1929139-2-andriy.shevchenko@linux.intel.com
    > Signed-off-by: Lee Jones &lt;lee@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ mfd: da9052-spi: Change read-mask to write-mask (@Marcus Folkesson in [691333e2987dd69](https://github.com/sophgo/linux-riscv/commit/691333e2987dd69) at 2024-12-05 13:02:03)
    > [ Upstream commit 2e3378f6c79a1b3f7855ded1ef306ea4406352ed ]
    > Driver has mixed up the R/W bit.
    > The LSB bit is set on write rather than read.
    > Change it to avoid nasty things to happen.
    > Fixes: e9e9d3973594 (&quot;mfd: da9052: Avoid setting read_flag_mask for da9052-i2c driver&quot;)
    > Signed-off-by: Marcus Folkesson &lt;marcus.folkesson@gmail.com&gt;
    > Link: https://lore.kernel.org/r/20240925-da9052-v2-1-f243e4505b07@gmail.com
    > Signed-off-by: Lee Jones &lt;lee@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ scsi: hisi_sas: Enable all PHYs that are not disabled by user during controller reset (@Yihang Li in [4affee82b993528](https://github.com/sophgo/linux-riscv/commit/4affee82b993528) at 2024-12-05 13:02:03)
    > [ Upstream commit 08a07dc71d7fc6f58c35c4fc0bcede2811c5aa4c ]
    > For the controller reset operation(such as FLR or clear nexus ha in SCSI
    > EH), we will disable all PHYs and then enable PHY based on the
    > hisi_hba-&gt;phy_state obtained in hisi_sas_controller_reset_prepare(). If
    > the device is removed before controller reset or the PHY is not attached
    > to any device in directly attached scenario, the corresponding bit of
    > phy_state is not set. After controller reset done, the PHY is disabled.
    > The device cannot be identified even if user reconnect the disk.
    > Therefore, for PHYs that are not disabled by user, hisi_sas_phy_enable()
    > needs to be executed even if the corresponding bit of phy_state is not
    > set.
    > Fixes: 89954f024c3a (&quot;scsi: hisi_sas: Ensure all enabled PHYs up during controller reset&quot;)
    > Signed-off-by: Yihang Li &lt;liyihang9@huawei.com&gt;
    > Link: https://lore.kernel.org/r/20241008021822.2617339-5-liyihang9@huawei.com
    > Reviewed-by: Xiang Chen &lt;chenxiang66@hisilicon.com&gt;
    > Signed-off-by: Martin K. Petersen &lt;martin.petersen@oracle.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ pinctrl: zynqmp: drop excess struct member description (@Bartosz Golaszewski in [fc1791092321020](https://github.com/sophgo/linux-riscv/commit/fc1791092321020) at 2024-12-05 13:02:02)
    > [ Upstream commit 2a85fc7044987d751f27d7f1e4423eebbcecc2c6 ]
    > The &#x27;node&#x27; member has never been part of this structure so drop its
    > description.
    > Fixes: 8b242ca700f8 (&quot;pinctrl: Add Xilinx ZynqMP pinctrl driver support&quot;)
    > Signed-off-by: Bartosz Golaszewski &lt;bartosz.golaszewski@linaro.org&gt;
    > Link: https://lore.kernel.org/20241010080432.7781-1-brgl@bgdev.pl
    > Signed-off-by: Linus Walleij &lt;linus.walleij@linaro.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ trace/trace_event_perf: remove duplicate samples on the first tracepoint event (@Levi Yun in [b746a3afa2ab52c](https://github.com/sophgo/linux-riscv/commit/b746a3afa2ab52c) at 2024-12-05 13:02:02)
    > [ Upstream commit afe5960dc208fe069ddaaeb0994d857b24ac19d1 ]
    > When a tracepoint event is created with attr.freq &#x3D; 1,
    > &#x27;hwc-&gt;period_left&#x27; is not initialized correctly. As a result,
    > in the perf_swevent_overflow() function, when the first time the event occurs,
    > it calculates the event overflow and the perf_swevent_set_period() returns 3,
    > this leads to the event are recorded for three duplicate times.
    > Step to reproduce:
    > 1. Enable the tracepoint event &amp; starting tracing
    > $ echo 1 &gt; /sys/kernel/tracing/events/module/module_free
    > $ echo 1 &gt; /sys/kernel/tracing/tracing_on
    > 2. Record with perf
    > $ perf record -a --strict-freq -F 1 -e &quot;module:module_free&quot;
    > 3. Trigger module_free event.
    > $ modprobe -i sunrpc
    > $ modprobe -r sunrpc
    > Result:
    > - Trace pipe result:
    > $ cat trace_pipe
    > modprobe-174509  [003] .....  6504.868896: module_free: sunrpc
    > - perf sample:
    > modprobe  174509 [003]  6504.868980: module:module_free: sunrpc
    > modprobe  174509 [003]  6504.868980: module:module_free: sunrpc
    > modprobe  174509 [003]  6504.868980: module:module_free: sunrpc
    > By setting period_left via perf_swevent_set_period() as other sw_event did,
    > This problem could be solved.
    > After patch:
    > - Trace pipe result:
    > $ cat trace_pipe
    > modprobe 1153096 [068] 613468.867774: module:module_free: xfs
    > - perf sample
    > modprobe 1153096 [068] 613468.867794: module:module_free: xfs
    > Link: https://lore.kernel.org/20240913021347.595330-1-yeoreum.yun@arm.com
    > Fixes: bd2b5b12849a (&quot;perf_counter: More aggressive frequency adjustment&quot;)
    > Signed-off-by: Levi Yun &lt;yeoreum.yun@arm.com&gt;
    > Acked-by: Namhyung Kim &lt;namhyung@kernel.org&gt;
    > Signed-off-by: Steven Rostedt (Google) &lt;rostedt@goodmis.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ clk: mediatek: drop two dead config options (@Lukas Bulwahn in [b1b31b3705ef033](https://github.com/sophgo/linux-riscv/commit/b1b31b3705ef033) at 2024-12-05 13:02:02)
    > [ Upstream commit 98619dc3cecc2b3943d6abe1db235c868dc72f8d ]
    > Commit 0f471d31e5e8 (&quot;clk: mediatek: Split MT8195 clock drivers and allow
    > module build&quot;) adds a number of new COMMON_CLK_MT8195_* config options.
    > Among those, the config options COMMON_CLK_MT8195_AUDSYS and
    > COMMON_CLK_MT8195_MSDC have no reference in the source tree and are not
    > used in the Makefile to include a specific file.
    > Drop the dead config options COMMON_CLK_MT8195_AUDSYS and
    > COMMON_CLK_MT8195_MSDC.
    > Fixes: 0f471d31e5e8 (&quot;clk: mediatek: Split MT8195 clock drivers and allow module build&quot;)
    > Signed-off-by: Lukas Bulwahn &lt;lukas.bulwahn@redhat.com&gt;
    > Link: https://lore.kernel.org/r/20240927092232.386511-1-lukas.bulwahn@redhat.com
    > Reviewed-by: AngeloGioacchino Del Regno &lt;angelogioacchino.delregno@collabora.com&gt;
    > Signed-off-by: Stephen Boyd &lt;sboyd@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ RDMA/core: Provide rdma_user_mmap_disassociate() to disassociate mmap pages (@Chengchang Tang in [86092a4e46d161d](https://github.com/sophgo/linux-riscv/commit/86092a4e46d161d) at 2024-12-05 13:02:02)
    > [ Upstream commit 51976c6cd786151b6a1bdf8b8b3334beac0ba99c ]
    > Provide a new api rdma_user_mmap_disassociate() for drivers to
    > disassociate mmap pages for a device.
    > Since drivers can now disassociate mmaps by calling this api,
    > introduce a new disassociation_lock to specifically prevent
    > races between this disassociation process and new mmaps. And
    > thus the old hw_destroy_rwsem is not needed in this api.
    > Signed-off-by: Chengchang Tang &lt;tangchengchang@huawei.com&gt;
    > Signed-off-by: Junxian Huang &lt;huangjunxian6@hisilicon.com&gt;
    > Link: https://patch.msgid.link/20240927103323.1897094-2-huangjunxian6@hisilicon.com
    > Signed-off-by: Leon Romanovsky &lt;leon@kernel.org&gt;
    > Stable-dep-of: 615b94746a54 (&quot;RDMA/hns: Disassociate mmap pages for all uctx when HW is being reset&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ RDMA/hns: Disassociate mmap pages for all uctx when HW is being reset (@Chengchang Tang in [7d9616110b5e38d](https://github.com/sophgo/linux-riscv/commit/7d9616110b5e38d) at 2024-12-05 13:02:02)
    > [ Upstream commit 615b94746a54702af923b28bd8a629f4ac0ff0d8 ]
    > When HW is being reset, userspace should not ring doorbell otherwise
    > it may lead to abnormal consequence such as RAS.
    > Disassociate mmap pages for all uctx to prevent userspace from ringing
    > doorbell to HW. Since all resources will be destroyed during HW reset,
    > no new mmap is allowed after HW reset is completed.
    > Fixes: 9a4435375cd1 (&quot;IB/hns: Add driver files for hns RoCE driver&quot;)
    > Signed-off-by: Chengchang Tang &lt;tangchengchang@huawei.com&gt;
    > Signed-off-by: Junxian Huang &lt;huangjunxian6@hisilicon.com&gt;
    > Link: https://patch.msgid.link/20240927103323.1897094-3-huangjunxian6@hisilicon.com
    > Signed-off-by: Leon Romanovsky &lt;leon@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ pinctrl: renesas: rzg2l: Fix missing return in rzg2l_pinctrl_register() (@Biju Das in [399bc8b6d0fe986](https://github.com/sophgo/linux-riscv/commit/399bc8b6d0fe986) at 2024-12-05 13:02:02)
    > [ Upstream commit 1737715a4c2c08f207c94cc1f3af3c5945318d29 ]
    > Fix the missing return statement in the error path of
    > rzg2l_pinctrl_register().
    > Fixes: f73f63b24491fa43 (&quot;pinctrl: renesas: rzg2l: Use dev_err_probe()&quot;)
    > Reported-by: Nobuhiro Iwamatsu &lt;nobuhiro1.iwamatsu@toshiba.co.jp&gt;
    > Closes: https://lore.kernel.org/all/OS0PR01MB638837327E5487B71D88A70392712@OS0PR01MB6388.jpnprd01.prod.outlook.com/
    > Signed-off-by: Biju Das &lt;biju.das.jz@bp.renesas.com&gt;
    > Reviewed-by: Geert Uytterhoeven &lt;geert+renesas@glider.be&gt;
    > Link: https://lore.kernel.org/20241003082550.33341-1-biju.das.jz@bp.renesas.com
    > Signed-off-by: Geert Uytterhoeven &lt;geert+renesas@glider.be&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ pinctrl: renesas: Select PINCTRL_RZG2L for RZ/V2H(P) SoC (@Lad Prabhakar in [16f2ef1e4882d21](https://github.com/sophgo/linux-riscv/commit/16f2ef1e4882d21) at 2024-12-05 13:02:02)
    > [ Upstream commit 5dcde519a067ac5c85c273e550dde1873e2199bf ]
    > Add explicit selection of the PINCTRL_RZG2L config option for the
    > RZ/V2H(P) (R9A09G057) SoC, ensuring pin control driver is enabled
    > for this SoC.
    > Fixes: 9bd95ac86e70 (&quot;pinctrl: renesas: rzg2l: Add support for RZ/V2H SoC&quot;)
    > Reported-by: Biju Das &lt;biju.das.jz@bp.renesas.com&gt;
    > Signed-off-by: Lad Prabhakar &lt;prabhakar.mahadev-lad.rj@bp.renesas.com&gt;
    > Reviewed-by: Geert Uytterhoeven &lt;geert+renesas@glider.be&gt;
    > Link: https://lore.kernel.org/20241010132726.702658-1-prabhakar.mahadev-lad.rj@bp.renesas.com
    > Signed-off-by: Geert Uytterhoeven &lt;geert+renesas@glider.be&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ net: txgbe: fix null pointer to pcs (@Jiawen Wu in [fc1ed75f381f78e](https://github.com/sophgo/linux-riscv/commit/fc1ed75f381f78e) at 2024-12-05 13:02:01)
    > [ Upstream commit 2160428bcb20f2f70a72ee84aba91a1264dc4ff3 ]
    > For 1000BASE-X or SGMII interface mode, the PCS also need to be selected.
    > Only return null pointer when there is a copper NIC with external PHY.
    > Fixes: 02b2a6f91b90 (&quot;net: txgbe: support copper NIC with external PHY&quot;)
    > Signed-off-by: Jiawen Wu &lt;jiawenwu@trustnetic.com&gt;
    > Link: https://patch.msgid.link/20241115073508.1130046-1-jiawenwu@trustnetic.com
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ bpf: fix recursive lock when verdict program return SK_PASS (@Jiayuan Chen in [f84c5ef6ca23cc2](https://github.com/sophgo/linux-riscv/commit/f84c5ef6ca23cc2) at 2024-12-05 13:02:01)
    > [ Upstream commit 8ca2a1eeadf09862190b2810697702d803ceef2d ]
    > When the stream_verdict program returns SK_PASS, it places the received skb
    > into its own receive queue, but a recursive lock eventually occurs, leading
    > to an operating system deadlock. This issue has been present since v6.9.
    > &#x27;&#x27;&#x27;
    > sk_psock_strp_data_ready
    > write_lock_bh(&amp;sk-&gt;sk_callback_lock)
    > strp_data_ready
    > strp_read_sock
    > read_sock -&gt; tcp_read_sock
    > strp_recv
    > cb.rcv_msg -&gt; sk_psock_strp_read
    > # now stream_verdict return SK_PASS without peer sock assign
    > __SK_PASS &#x3D; sk_psock_map_verd(SK_PASS, NULL)
    > sk_psock_verdict_apply
    > sk_psock_skb_ingress_self
    > sk_psock_skb_ingress_enqueue
    > sk_psock_data_ready
    > read_lock_bh(&amp;sk-&gt;sk_callback_lock) &lt;&#x3D; dead lock
    > &#x27;&#x27;&#x27;
    > This topic has been discussed before, but it has not been fixed.
    > Previous discussion:
    > https://lore.kernel.org/all/6684a5864ec86_403d20898@john.notmuch
    > Fixes: 6648e613226e (&quot;bpf, skmsg: Fix NULL pointer dereference in sk_psock_skb_ingress_enqueue&quot;)
    > Reported-by: Vincent Whitchurch &lt;vincent.whitchurch@datadoghq.com&gt;
    > Signed-off-by: Jiayuan Chen &lt;mrpre@163.com&gt;
    > Signed-off-by: John Fastabend &lt;john.fastabend@gmail.com&gt;
    > Acked-by: Martin KaFai Lau &lt;martin.lau@kernel.org&gt;
    > Link: https://patch.msgid.link/20241118030910.36230-2-mrpre@163.com
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ unicode: Fix utf8_load() error path (@André Almeida in [89933f8ab3b4cad](https://github.com/sophgo/linux-riscv/commit/89933f8ab3b4cad) at 2024-12-05 13:02:01)
    > [ Upstream commit 156bb2c569cd869583c593d27a5bd69e7b2a4264 ]
    > utf8_load() requests the symbol &quot;utf8_data_table&quot; and then checks if the
    > requested UTF-8 version is supported. If it&#x27;s unsupported, it tries to
    > put the data table using symbol_put(). If an unsupported version is
    > requested, symbol_put() fails like this:
    > kernel BUG at kernel/module/main.c:786!
    > RIP: 0010:__symbol_put+0x93/0xb0
    > Call Trace:
    > &lt;TASK&gt;
    > ? __die_body.cold+0x19/0x27
    > ? die+0x2e/0x50
    > ? do_trap+0xca/0x110
    > ? do_error_trap+0x65/0x80
    > ? __symbol_put+0x93/0xb0
    > ? exc_invalid_op+0x51/0x70
    > ? __symbol_put+0x93/0xb0
    > ? asm_exc_invalid_op+0x1a/0x20
    > ? __pfx_cmp_name+0x10/0x10
    > ? __symbol_put+0x93/0xb0
    > ? __symbol_put+0x62/0xb0
    > utf8_load+0xf8/0x150
    > That happens because symbol_put() expects the unique string that
    > identify the symbol, instead of a pointer to the loaded symbol. Fix that
    > by using such string.
    > Fixes: 2b3d04787012 (&quot;unicode: Add utf8-data module&quot;)
    > Signed-off-by: André Almeida &lt;andrealmeid@igalia.com&gt;
    > Reviewed-by: Theodore Ts&#x27;o &lt;tytso@mit.edu&gt;
    > Link: https://lore.kernel.org/r/20240902225511.757831-2-andrealmeid@igalia.com
    > Signed-off-by: Gabriel Krisman Bertazi &lt;krisman@suse.de&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ netpoll: Use rcu_access_pointer() in netpoll_poll_lock (@Breno Leitao in [6b8b9d9b06fba7f](https://github.com/sophgo/linux-riscv/commit/6b8b9d9b06fba7f) at 2024-12-05 13:02:01)
    > [ Upstream commit a57d5a72f8dec7db8a79d0016fb0a3bdecc82b56 ]
    > The ndev-&gt;npinfo pointer in netpoll_poll_lock() is RCU-protected but is
    > being accessed directly for a NULL check. While no RCU read lock is held
    > in this context, we should still use proper RCU primitives for
    > consistency and correctness.
    > Replace the direct NULL check with rcu_access_pointer(), which is the
    > appropriate primitive when only checking for NULL without dereferencing
    > the pointer. This function provides the necessary ordering guarantees
    > without requiring RCU read-side protection.
    > Fixes: bea3348eef27 (&quot;[NET]: Make NAPI polling independent of struct net_device objects.&quot;)
    > Signed-off-by: Breno Leitao &lt;leitao@debian.org&gt;
    > Reviewed-by: Michal Kubiak &lt;michal.kubiak@intel.com&gt;
    > Link: https://patch.msgid.link/20241118-netpoll_rcu-v1-2-a1888dcb4a02@debian.org
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ wireguard: selftests: load nf_conntrack if not present (@Hangbin Liu in [3a5c24528a16386](https://github.com/sophgo/linux-riscv/commit/3a5c24528a16386) at 2024-12-05 13:02:01)
    > [ Upstream commit 0290abc9860917f1ee8b58309c2bbd740a39ee8e ]
    > Some distros may not load nf_conntrack by default, which will cause
    > subsequent nf_conntrack sets to fail. Load this module if it is not
    > already loaded.
    > Fixes: e7096c131e51 (&quot;net: WireGuard secure network tunnel&quot;)
    > Signed-off-by: Hangbin Liu &lt;liuhangbin@gmail.com&gt;
    > Reviewed-by: Simon Horman &lt;horms@kernel.org&gt;
    > [ Jason: add [[ -e ... ]] check so this works in the qemu harness. ]
    > Signed-off-by: Jason A. Donenfeld &lt;Jason@zx2c4.com&gt;
    > Link: https://patch.msgid.link/20241117212030.629159-4-Jason@zx2c4.com
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ cppc_cpufreq: Use desired perf if feedback ctrs are 0 or unchanged (@Jie Zhan in [12b63e2260f5715](https://github.com/sophgo/linux-riscv/commit/12b63e2260f5715) at 2024-12-05 13:02:01)
    > [ Upstream commit c47195631960b626058c335aec31f186fa854f97 ]
    > The CPPC performance feedback counters could be 0 or unchanged when the
    > target cpu is in a low-power idle state, e.g. power-gated or clock-gated.
    > When the counters are 0, cppc_cpufreq_get_rate() returns 0 KHz, which makes
    > cpufreq_online() get a false error and fail to generate a cpufreq policy.
    > When the counters are unchanged, the existing cppc_perf_from_fbctrs()
    > returns a cached desired perf, but some platforms may update the real
    > frequency back to the desired perf reg.
    > For the above cases in cppc_cpufreq_get_rate(), get the latest desired perf
    > from the CPPC reg to reflect the frequency because some platforms may
    > update the actual frequency back there; if failed, use the cached desired
    > perf.
    > Fixes: 6a4fec4f6d30 (&quot;cpufreq: cppc: cppc_cpufreq_get_rate() returns zero in all error cases.&quot;)
    > Signed-off-by: Jie Zhan &lt;zhanjie9@hisilicon.com&gt;
    > Reviewed-by: Zeng Heng &lt;zengheng4@huawei.com&gt;
    > Reviewed-by: Ionela Voinescu &lt;ionela.voinescu@arm.com&gt;
    > Reviewed-by: Huisong Li &lt;lihuisong@huawei.com&gt;
    > Signed-off-by: Viresh Kumar &lt;viresh.kumar@linaro.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ dlm: fix dlm_recover_members refcount on error (@Alexander Aring in [fb2ec564887af1f](https://github.com/sophgo/linux-riscv/commit/fb2ec564887af1f) at 2024-12-05 13:02:00)
    > [ Upstream commit 200b977ebbc313a59174ba971006a231b3533dc5 ]
    > If dlm_recover_members() fails we don&#x27;t drop the references of the
    > previous created root_list that holds and keep all rsbs alive during the
    > recovery. It might be not an unlikely event because ping_members() could
    > run into an -EINTR if another recovery progress was triggered again.
    > Fixes: 3a747f4a2ee8 (&quot;dlm: move rsb root_list to ls_recover() stack&quot;)
    > Signed-off-by: Alexander Aring &lt;aahringo@redhat.com&gt;
    > Signed-off-by: David Teigland &lt;teigland@redhat.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ erofs: handle NONHEAD !delta[1] lclusters gracefully (@Gao Xiang in [daaf68fef4b2ff9](https://github.com/sophgo/linux-riscv/commit/daaf68fef4b2ff9) at 2024-12-05 13:02:00)
    > [ Upstream commit 0bc8061ffc733a0a246b8689b2d32a3e9204f43c ]
    > syzbot reported a WARNING in iomap_iter_done:
    > iomap_fiemap+0x73b/0x9b0 fs/iomap/fiemap.c:80
    > ioctl_fiemap fs/ioctl.c:220 [inline]
    > Generally, NONHEAD lclusters won&#x27;t have delta[1]&#x3D;&#x3D;0, except for crafted
    > images and filesystems created by pre-1.0 mkfs versions.
    > Previously, it would immediately bail out if delta[1]&#x3D;&#x3D;0, which led to
    > inadequate decompressed lengths (thus FIEMAP is impacted).  Treat it as
    > delta[1]&#x3D;1 to work around these legacy mkfs versions.
    > &#x60;lclusterbits &gt; 14&#x60; is illegal for compact indexes, error out too.
    > Reported-by: syzbot+6c0b301317aa0156f9eb@syzkaller.appspotmail.com
    > Closes: https://lore.kernel.org/r/67373c0c.050a0220.2a2fcc.0079.GAE@google.com
    > Tested-by: syzbot+6c0b301317aa0156f9eb@syzkaller.appspotmail.com
    > Fixes: d95ae5e25326 (&quot;erofs: add support for the full decompressed length&quot;)
    > Fixes: 001b8ccd0650 (&quot;erofs: fix compact 4B support for 16k block size&quot;)
    > Signed-off-by: Gao Xiang &lt;hsiangkao@linux.alibaba.com&gt;
    > Link: https://lore.kernel.org/r/20241115173651.3339514-1-hsiangkao@linux.alibaba.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ xsk: Free skb when TX metadata options are invalid (@Felix Maurer in [d5d346deb65efa8](https://github.com/sophgo/linux-riscv/commit/d5d346deb65efa8) at 2024-12-05 13:02:00)
    > [ Upstream commit 0c0d0f42ffa6ac94cd79893b7ed419c15e1b45de ]
    > When a new skb is allocated for transmitting an xsk descriptor, i.e., for
    > every non-multibuf descriptor or the first frag of a multibuf descriptor,
    > but the descriptor is later found to have invalid options set for the TX
    > metadata, the new skb is never freed. This can leak skbs until the send
    > buffer is full which makes sending more packets impossible.
    > Fix this by freeing the skb in the error path if we are currently dealing
    > with the first frag, i.e., an skb allocated in this iteration of
    > xsk_build_skb.
    > Fixes: 48eb03dd2630 (&quot;xsk: Add TX timestamp and TX checksum offload support&quot;)
    > Reported-by: Michal Schmidt &lt;mschmidt@redhat.com&gt;
    > Signed-off-by: Felix Maurer &lt;fmaurer@redhat.com&gt;
    > Reviewed-by: Toke Høiland-Jørgensen &lt;toke@redhat.com&gt;
    > Acked-by: Stanislav Fomichev &lt;sdf@fomichev.me&gt;
    > Acked-by: Martin KaFai Lau &lt;martin.lau@kernel.org&gt;
    > Link: https://patch.msgid.link/edb9b00fb19e680dff5a3350cd7581c5927975a8.1731581697.git.fmaurer@redhat.com
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ eth: fbnic: don&#x27;t disable the PCI device twice (@Jakub Kicinski in [785f57787f73a76](https://github.com/sophgo/linux-riscv/commit/785f57787f73a76) at 2024-12-05 13:02:00)
    > [ Upstream commit 62e9c00ea868ceb71156c517747dc69316c25bf1 ]
    > We use pcim_enable_device(), there is no need to call pci_disable_device().
    > Fixes: 546dd90be979 (&quot;eth: fbnic: Add scaffolding for Meta&#x27;s NIC driver&quot;)
    > Reviewed-by: Simon Horman &lt;horms@kernel.org&gt;
    > Link: https://patch.msgid.link/20241115014809.754860-1-kuba@kernel.org
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ erofs: fix blksize &lt; PAGE_SIZE for file-backed mounts (@Hongzhen Luo in [679d8537e574824](https://github.com/sophgo/linux-riscv/commit/679d8537e574824) at 2024-12-05 13:02:00)
    > [ Upstream commit bae0854160939a64a092516ff1b2f221402b843b ]
    > Adjust sb-&gt;s_blocksize{,_bits} directly for file-backed
    > mounts when the fs block size is smaller than PAGE_SIZE.
    > Previously, EROFS used sb_set_blocksize(), which caused
    > a panic if bdev-backed mounts is not used.
    > Fixes: fb176750266a (&quot;erofs: add file-backed mount support&quot;)
    > Signed-off-by: Hongzhen Luo &lt;hongzhen@linux.alibaba.com&gt;
    > Link: https://lore.kernel.org/r/20241015103836.3757438-1-hongzhen@linux.alibaba.com
    > Signed-off-by: Gao Xiang &lt;hsiangkao@linux.alibaba.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ erofs: fix file-backed mounts over FUSE (@Gao Xiang in [5036f2f024cac40](https://github.com/sophgo/linux-riscv/commit/5036f2f024cac40) at 2024-12-05 13:02:00)
    > [ Upstream commit 3a23787ca8756920d65fda39f41353a4be1d1642 ]
    > syzbot reported a null-ptr-deref in fuse_read_args_fill:
    > fuse_read_folio+0xb0/0x100 fs/fuse/file.c:905
    > filemap_read_folio+0xc6/0x2a0 mm/filemap.c:2367
    > do_read_cache_folio+0x263/0x5c0 mm/filemap.c:3825
    > read_mapping_folio include/linux/pagemap.h:1011 [inline]
    > erofs_bread+0x34d/0x7e0 fs/erofs/data.c:41
    > erofs_read_superblock fs/erofs/super.c:281 [inline]
    > erofs_fc_fill_super+0x2b9/0x2500 fs/erofs/super.c:625
    > Unlike most filesystems, some network filesystems and FUSE need
    > unavoidable valid &#x60;file&#x60; pointers for their read I/Os [1].
    > Anyway, those use cases need to be supported too.
    > [1] https://docs.kernel.org/filesystems/vfs.html
    > Reported-by: syzbot+0b1279812c46e48bb0c1@syzkaller.appspotmail.com
    > Closes: https://lore.kernel.org/r/6727bbdf.050a0220.3c8d68.0a7e.GAE@google.com
    > Fixes: fb176750266a (&quot;erofs: add file-backed mount support&quot;)
    > Tested-by: syzbot+0b1279812c46e48bb0c1@syzkaller.appspotmail.com
    > Signed-off-by: Gao Xiang &lt;hsiangkao@linux.alibaba.com&gt;
    > Link: https://lore.kernel.org/r/20241114234905.1873723-1-hsiangkao@linux.alibaba.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ net: txgbe: remove GPIO interrupt controller (@Jiawen Wu in [40e16ba152d0968](https://github.com/sophgo/linux-riscv/commit/40e16ba152d0968) at 2024-12-05 13:02:00)
    > [ Upstream commit e867ed3ac8aa50945170723a450b5c068a56339a ]
    > Since the GPIO interrupt controller is always not working properly, we need
    > to constantly add workaround to cope with hardware deficiencies. So just
    > remove GPIO interrupt controller, and let the SFP driver poll the GPIO
    > status.
    > Fixes: b4a2496c17ed (&quot;net: txgbe: fix GPIO interrupt blocking&quot;)
    > Signed-off-by: Jiawen Wu &lt;jiawenwu@trustnetic.com&gt;
    > Link: https://patch.msgid.link/20241115071527.1129458-1-jiawenwu@trustnetic.com
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ Bluetooth: ISO: Use kref to track lifetime of iso_conn (@Luiz Augusto von Dentz in [a58d0f5dac322e1](https://github.com/sophgo/linux-riscv/commit/a58d0f5dac322e1) at 2024-12-05 13:01:59)
    > [ Upstream commit dc26097bdb864a0d5955b9a25e43376ffc1af99b ]
    > This make use of kref to keep track of reference of iso_conn which
    > allows better tracking of its lifetime with usage of things like
    > kref_get_unless_zero in a similar way as used in l2cap_chan.
    > In addition to it remove call to iso_sock_set_timer on iso_sock_disconn
    > since at that point it is useless to set a timer as the sk will be freed
    > there is nothing to be done in iso_sock_timeout.
    > Fixes: ccf74f2390d6 (&quot;Bluetooth: Add BTPROTO_ISO socket type&quot;)
    > Signed-off-by: Luiz Augusto von Dentz &lt;luiz.von.dentz@intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ Bluetooth: ISO: Do not emit LE BIG Create Sync if previous is pending (@Iulia Tanasescu in [91d19383b7ed035](https://github.com/sophgo/linux-riscv/commit/91d19383b7ed035) at 2024-12-05 13:01:59)
    > [ Upstream commit 42ecf1947135110ea08abeaca39741636f9a2285 ]
    > The Bluetooth Core spec does not allow a LE BIG Create sync command to be
    > sent to Controller if another one is pending (Vol 4, Part E, page 2586).
    > In order to avoid this issue, the HCI_CONN_CREATE_BIG_SYNC was added
    > to mark that the LE BIG Create Sync command has been sent for a hcon.
    > Once the BIG Sync Established event is received, the hcon flag is
    > erased and the next pending hcon is handled.
    > Signed-off-by: Iulia Tanasescu &lt;iulia.tanasescu@nxp.com&gt;
    > Signed-off-by: Luiz Augusto von Dentz &lt;luiz.von.dentz@intel.com&gt;
    > Stable-dep-of: 07a9342b94a9 (&quot;Bluetooth: ISO: Send BIG Create Sync via hci_sync&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ Bluetooth: fix use-after-free in device_for_each_child() (@Dmitry Antipov in [7b277bd569bb6a2](https://github.com/sophgo/linux-riscv/commit/7b277bd569bb6a2) at 2024-12-05 13:01:59)
    > [ Upstream commit 27aabf27fd014ae037cc179c61b0bee7cff55b3d ]
    > Syzbot has reported the following KASAN splat:
    > BUG: KASAN: slab-use-after-free in device_for_each_child+0x18f/0x1a0
    > Read of size 8 at addr ffff88801f605308 by task kbnepd bnep0/4980
    > CPU: 0 UID: 0 PID: 4980 Comm: kbnepd bnep0 Not tainted 6.12.0-rc4-00161-gae90f6a6170d #1
    > Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.16.3-2.fc40 04/01/2014
    > Call Trace:
    > &lt;TASK&gt;
    > dump_stack_lvl+0x100/0x190
    > ? device_for_each_child+0x18f/0x1a0
    > print_report+0x13a/0x4cb
    > ? __virt_addr_valid+0x5e/0x590
    > ? __phys_addr+0xc6/0x150
    > ? device_for_each_child+0x18f/0x1a0
    > kasan_report+0xda/0x110
    > ? device_for_each_child+0x18f/0x1a0
    > ? __pfx_dev_memalloc_noio+0x10/0x10
    > device_for_each_child+0x18f/0x1a0
    > ? __pfx_device_for_each_child+0x10/0x10
    > pm_runtime_set_memalloc_noio+0xf2/0x180
    > netdev_unregister_kobject+0x1ed/0x270
    > unregister_netdevice_many_notify+0x123c/0x1d80
    > ? __mutex_trylock_common+0xde/0x250
    > ? __pfx_unregister_netdevice_many_notify+0x10/0x10
    > ? trace_contention_end+0xe6/0x140
    > ? __mutex_lock+0x4e7/0x8f0
    > ? __pfx_lock_acquire.part.0+0x10/0x10
    > ? rcu_is_watching+0x12/0xc0
    > ? unregister_netdev+0x12/0x30
    > unregister_netdevice_queue+0x30d/0x3f0
    > ? __pfx_unregister_netdevice_queue+0x10/0x10
    > ? __pfx_down_write+0x10/0x10
    > unregister_netdev+0x1c/0x30
    > bnep_session+0x1fb3/0x2ab0
    > ? __pfx_bnep_session+0x10/0x10
    > ? __pfx_lock_release+0x10/0x10
    > ? __pfx_woken_wake_function+0x10/0x10
    > ? __kthread_parkme+0x132/0x200
    > ? __pfx_bnep_session+0x10/0x10
    > ? kthread+0x13a/0x370
    > ? __pfx_bnep_session+0x10/0x10
    > kthread+0x2b7/0x370
    > ? __pfx_kthread+0x10/0x10
    > ret_from_fork+0x48/0x80
    > ? __pfx_kthread+0x10/0x10
    > ret_from_fork_asm+0x1a/0x30
    > &lt;/TASK&gt;
    > Allocated by task 4974:
    > kasan_save_stack+0x30/0x50
    > kasan_save_track+0x14/0x30
    > __kasan_kmalloc+0xaa/0xb0
    > __kmalloc_noprof+0x1d1/0x440
    > hci_alloc_dev_priv+0x1d/0x2820
    > __vhci_create_device+0xef/0x7d0
    > vhci_write+0x2c7/0x480
    > vfs_write+0x6a0/0xfc0
    > ksys_write+0x12f/0x260
    > do_syscall_64+0xc7/0x250
    > entry_SYSCALL_64_after_hwframe+0x77/0x7f
    > Freed by task 4979:
    > kasan_save_stack+0x30/0x50
    > kasan_save_track+0x14/0x30
    > kasan_save_free_info+0x3b/0x60
    > __kasan_slab_free+0x4f/0x70
    > kfree+0x141/0x490
    > hci_release_dev+0x4d9/0x600
    > bt_host_release+0x6a/0xb0
    > device_release+0xa4/0x240
    > kobject_put+0x1ec/0x5a0
    > put_device+0x1f/0x30
    > vhci_release+0x81/0xf0
    > __fput+0x3f6/0xb30
    > task_work_run+0x151/0x250
    > do_exit+0xa79/0x2c30
    > do_group_exit+0xd5/0x2a0
    > get_signal+0x1fcd/0x2210
    > arch_do_signal_or_restart+0x93/0x780
    > syscall_exit_to_user_mode+0x140/0x290
    > do_syscall_64+0xd4/0x250
    > entry_SYSCALL_64_after_hwframe+0x77/0x7f
    > In &#x27;hci_conn_del_sysfs()&#x27;, &#x27;device_unregister()&#x27; may be called when
    > an underlying (kobject) reference counter is greater than 1. This
    > means that reparenting (happened when the device is actually freed)
    > is delayed and, during that delay, parent controller device (hciX)
    > may be deleted. Since the latter may create a dangling pointer to
    > freed parent, avoid that scenario by reparenting to NULL explicitly.
    > Reported-by: syzbot+6cf5652d3df49fae2e3f@syzkaller.appspotmail.com
    > Tested-by: syzbot+6cf5652d3df49fae2e3f@syzkaller.appspotmail.com
    > Closes: https://syzkaller.appspot.com/bug?extid&#x3D;6cf5652d3df49fae2e3f
    > Fixes: a85fb91e3d72 (&quot;Bluetooth: Fix double free in hci_conn_cleanup&quot;)
    > Signed-off-by: Dmitry Antipov &lt;dmantipov@yandex.ru&gt;
    > Signed-off-by: Luiz Augusto von Dentz &lt;luiz.von.dentz@intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ Bluetooth: ISO: Do not emit LE PA Create Sync if previous is pending (@Iulia Tanasescu in [67ead8f86af4950](https://github.com/sophgo/linux-riscv/commit/67ead8f86af4950) at 2024-12-05 13:01:59)
    > [ Upstream commit 4a5e0ba68676b3a77298cf646cd2b39c94fbd2f5 ]
    > The Bluetooth Core spec does not allow a LE PA Create sync command to be
    > sent to Controller if another one is pending (Vol 4, Part E, page 2493).
    > In order to avoid this issue, the HCI_CONN_CREATE_PA_SYNC was added
    > to mark that the LE PA Create Sync command has been sent for a hcon.
    > Once the PA Sync Established event is received, the hcon flag is
    > erased and the next pending hcon is handled.
    > Signed-off-by: Iulia Tanasescu &lt;iulia.tanasescu@nxp.com&gt;
    > Signed-off-by: Luiz Augusto von Dentz &lt;luiz.von.dentz@intel.com&gt;
    > Stable-dep-of: 07a9342b94a9 (&quot;Bluetooth: ISO: Send BIG Create Sync via hci_sync&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ Bluetooth: btbcm: fix missing of_node_put() in btbcm_get_board_name() (@Javier Carrasco in [3397001cfa8d736](https://github.com/sophgo/linux-riscv/commit/3397001cfa8d736) at 2024-12-05 13:01:59)
    > [ Upstream commit e42eec0f182ac0605e658145f6fe3b6a7c256c45 ]
    > of_find_node_by_path() returns a pointer to a device_node with its
    > refcount incremented, and a call to of_node_put() is required to
    > decrement the refcount again and avoid leaking the resource.
    > If &#x27;of_property_read_string_index(root, &quot;compatible&quot;, 0, &amp;tmp)&#x27; fails,
    > the function returns without calling of_node_put(root) before doing so.
    > The automatic cleanup attribute can be used by means of the __free()
    > macro to automatically call of_node_put() when the variable goes out of
    > scope, fixing the issue and also accounting for new error paths.
    > Fixes: 63fac3343b99 (&quot;Bluetooth: btbcm: Support per-board firmware variants&quot;)
    > Signed-off-by: Javier Carrasco &lt;javier.carrasco.cruz@gmail.com&gt;
    > Signed-off-by: Luiz Augusto von Dentz &lt;luiz.von.dentz@intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ Bluetooth: ISO: Send BIG Create Sync via hci_sync (@Iulia Tanasescu in [1360e5b6ce63d63](https://github.com/sophgo/linux-riscv/commit/1360e5b6ce63d63) at 2024-12-05 13:01:59)
    > [ Upstream commit 07a9342b94a91b306ed1cf6aa8254aea210764c9 ]
    > Before issuing the LE BIG Create Sync command, an available BIG handle
    > is chosen by iterating through the conn_hash list and finding the first
    > unused value.
    > If a BIG is terminated, the associated hcons are removed from the list
    > and the LE BIG Terminate Sync command is sent via hci_sync queue.
    > However, a new LE BIG Create sync command might be issued via
    > hci_send_cmd, before the previous BIG sync was terminated. This
    > can cause the same BIG handle to be reused and the LE BIG Create Sync
    > to fail with Command Disallowed.
    > &lt; HCI Command: LE Broadcast Isochronous Group Create Sync (0x08|0x006b)
    > BIG Handle: 0x00
    > BIG Sync Handle: 0x0002
    > Encryption: Unencrypted (0x00)
    > Broadcast Code[16]: 00000000000000000000000000000000
    > Maximum Number Subevents: 0x00
    > Timeout: 20000 ms (0x07d0)
    > Number of BIS: 1
    > BIS ID: 0x01
    > &gt; HCI Event: Command Status (0x0f) plen 4
    > LE Broadcast Isochronous Group Create Sync (0x08|0x006b) ncmd 1
    > Status: Command Disallowed (0x0c)
    > &lt; HCI Command: LE Broadcast Isochronous Group Terminate Sync (0x08|0x006c)
    > BIG Handle: 0x00
    > This commit fixes the ordering of the LE BIG Create Sync/LE BIG Terminate
    > Sync commands, to make sure that either the previous BIG sync is
    > terminated before reusing the handle, or that a new handle is chosen
    > for a new sync.
    > Fixes: eca0ae4aea66 (&quot;Bluetooth: Add initial implementation of BIS connections&quot;)
    > Signed-off-by: Iulia Tanasescu &lt;iulia.tanasescu@nxp.com&gt;
    > Signed-off-by: Luiz Augusto von Dentz &lt;luiz.von.dentz@intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ Bluetooth: btmtk: adjust the position to init iso data anchor (@Chris Lu in [1219c211ccd061c](https://github.com/sophgo/linux-riscv/commit/1219c211ccd061c) at 2024-12-05 13:01:59)
    > [ Upstream commit 61c5a3def90ac729a538e5ca5ff7f461cff72776 ]
    > MediaTek iso data anchor init should be moved to where MediaTek
    > claims iso data interface.
    > If there is an unexpected BT usb disconnect during setup flow,
    > it will cause a NULL pointer crash issue when releasing iso
    > anchor since the anchor wasn&#x27;t been init yet. Adjust the position
    > to do iso data anchor init.
    > [   17.137991] pc : usb_kill_anchored_urbs+0x60/0x168
    > [   17.137998] lr : usb_kill_anchored_urbs+0x44/0x168
    > [   17.137999] sp : ffffffc0890cb5f0
    > [   17.138000] x29: ffffffc0890cb5f0 x28: ffffff80bb6c2e80
    > [   17.144081] gpio gpiochip0: registered chardev handle for 1 lines
    > [   17.148421]  x27: 0000000000000000
    > [   17.148422] x26: ffffffd301ff4298 x25: 0000000000000003 x24: 00000000000000f0
    > [   17.148424] x23: 0000000000000000 x22: 00000000ffffffff x21: 0000000000000001
    > [   17.148425] x20: ffffffffffffffd8 x19: ffffff80c0f25560 x18: 0000000000000000
    > [   17.148427] x17: ffffffd33864e408 x16: ffffffd33808f7c8 x15: 0000000000200000
    > [   17.232789] x14: e0cd73cf80ffffff x13: 50f2137c0a0338c9 x12: 0000000000000001
    > [   17.239912] x11: 0000000080150011 x10: 0000000000000002 x9 : 0000000000000001
    > [   17.247035] x8 : 0000000000000000 x7 : 0000000000008080 x6 : 8080000000000000
    > [   17.254158] x5 : ffffffd33808ebc0 x4 : fffffffe033dcf20 x3 : 0000000080150011
    > [   17.261281] x2 : ffffff8087a91400 x1 : 0000000000000000 x0 : ffffff80c0f25588
    > [   17.268404] Call trace:
    > [   17.270841]  usb_kill_anchored_urbs+0x60/0x168
    > [   17.275274]  btusb_mtk_release_iso_intf+0x2c/0xd8 [btusb (HASH:5afe 6)]
    > [   17.284226]  btusb_mtk_disconnect+0x14/0x28 [btusb (HASH:5afe 6)]
    > [   17.292652]  btusb_disconnect+0x70/0x140 [btusb (HASH:5afe 6)]
    > [   17.300818]  usb_unbind_interface+0xc4/0x240
    > [   17.305079]  device_release_driver_internal+0x18c/0x258
    > [   17.310296]  device_release_driver+0x1c/0x30
    > [   17.314557]  bus_remove_device+0x140/0x160
    > [   17.318643]  device_del+0x1c0/0x330
    > [   17.322121]  usb_disable_device+0x80/0x180
    > [   17.326207]  usb_disconnect+0xec/0x300
    > [   17.329948]  hub_quiesce+0x80/0xd0
    > [   17.333339]  hub_disconnect+0x44/0x190
    > [   17.337078]  usb_unbind_interface+0xc4/0x240
    > [   17.341337]  device_release_driver_internal+0x18c/0x258
    > [   17.346551]  device_release_driver+0x1c/0x30
    > [   17.350810]  usb_driver_release_interface+0x70/0x88
    > [   17.355677]  proc_ioctl+0x13c/0x228
    > [   17.359157]  proc_ioctl_default+0x50/0x80
    > [   17.363155]  usbdev_ioctl+0x830/0xd08
    > [   17.366808]  __arm64_sys_ioctl+0x94/0xd0
    > [   17.370723]  invoke_syscall+0x6c/0xf8
    > [   17.374377]  el0_svc_common+0x84/0xe0
    > [   17.378030]  do_el0_svc+0x20/0x30
    > [   17.381334]  el0_svc+0x34/0x60
    > [   17.384382]  el0t_64_sync_handler+0x88/0xf0
    > [   17.388554]  el0t_64_sync+0x180/0x188
    > [   17.392208] Code: f9400677 f100a2f4 54fffea0 d503201f (b8350288)
    > [   17.398289] ---[ end trace 0000000000000000 ]---
    > Fixes: ceac1cb0259d (&quot;Bluetooth: btusb: mediatek: add ISO data transmission functions&quot;)
    > Signed-off-by: Chris Lu &lt;chris.lu@mediatek.com&gt;
    > Signed-off-by: Luiz Augusto von Dentz &lt;luiz.von.dentz@intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ selftests: netfilter: Fix missing return values in conntrack_dump_flush (@guanjing in [f11520f9ddbc0db](https://github.com/sophgo/linux-riscv/commit/f11520f9ddbc0db) at 2024-12-05 13:01:58)
    > [ Upstream commit 041bd1e4f2d82859690cd8b41c35f0f9404c3770 ]
    > Fix the bug of some functions were missing return values.
    > Fixes: eff3c558bb7e (&quot;netfilter: ctnetlink: support filtering by zone&quot;)
    > Signed-off-by: Guan Jing &lt;guanjing@cmss.chinamobile.com&gt;
    > Signed-off-by: Pablo Neira Ayuso &lt;pablo@netfilter.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ Bluetooth: btintel_pcie: Add handshake between driver and firmware (@Kiran K in [c670ebfd82585f7](https://github.com/sophgo/linux-riscv/commit/c670ebfd82585f7) at 2024-12-05 13:01:58)
    > [ Upstream commit 05c200c8f0295c9c91beeb3ee0552331c1f8adbe ]
    > The following handshake mechanism needs be followed after firmware
    > download is completed to bring the firmware to running state.
    > After firmware fragments of Operational image are downloaded and
    > secure sends result of the image succeeds,
    > 1. Driver sends HCI Intel reset with boot option #1 to switch FW image.
    > 2. FW sends Alive GP[0] MSIx
    > 3. Driver enables data path (doorbell 0x460 for RBDs, etc...)
    > 4. Driver gets Bootup event from firmware
    > 5. Driver performs D0 entry to device (WRITE to IPC_Sleep_Control &#x3D;0x0)
    > 6. FW sends Alive GP[0] MSIx
    > 7. Device host interface is fully set for BT protocol stack operation.
    > 8. Driver may optionally get debug event with ID 0x97 which can be dropped
    > For Intermediate loadger image, all the above steps are applicable
    > expcept #5 and #6.
    > On HCI_OP_RESET, firmware raises alive interrupt. Driver needs to wait
    > for it before passing control over to bluetooth stack.
    > Co-developed-by: Devegowda Chandrashekar &lt;chandrashekar.devegowda@intel.com&gt;
    > Signed-off-by: Devegowda Chandrashekar &lt;chandrashekar.devegowda@intel.com&gt;
    > Signed-off-by: Kiran K &lt;kiran.k@intel.com&gt;
    > Signed-off-by: Luiz Augusto von Dentz &lt;luiz.von.dentz@intel.com&gt;
    > Stable-dep-of: 510e8380b038 (&quot;Bluetooth: btintel: Do no pass vendor events to stack&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ALSA: caiaq: Use snd_card_free_when_closed() at disconnection (@Takashi Iwai in [a3f9314752dbb6f](https://github.com/sophgo/linux-riscv/commit/a3f9314752dbb6f) at 2024-12-05 13:01:58)
    > [ Upstream commit b04dcbb7f7b1908806b7dc22671cdbe78ff2b82c ]
    > The USB disconnect callback is supposed to be short and not too-long
    > waiting.  OTOH, the current code uses snd_card_free() at
    > disconnection, but this waits for the close of all used fds, hence it
    > can take long.  It eventually blocks the upper layer USB ioctls, which
    > may trigger a soft lockup.
    > An easy workaround is to replace snd_card_free() with
    > snd_card_free_when_closed().  This variant returns immediately while
    > the release of resources is done asynchronously by the card device
    > release at the last close.
    > This patch also splits the code to the disconnect and the free phases;
    > the former is called immediately at the USB disconnect callback while
    > the latter is called from the card destructor.
    > Fixes: 523f1dce3743 (&quot;[ALSA] Add Native Instrument usb audio device support&quot;)
    > Signed-off-by: Takashi Iwai &lt;tiwai@suse.de&gt;
    > Link: https://patch.msgid.link/20241113111042.15058-5-tiwai@suse.de
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ALSA: us122l: Use snd_card_free_when_closed() at disconnection (@Takashi Iwai in [9d5c530e4d70f64](https://github.com/sophgo/linux-riscv/commit/9d5c530e4d70f64) at 2024-12-05 13:01:58)
    > [ Upstream commit b7df09bb348016943f56b09dcaafe221e3f73947 ]
    > The USB disconnect callback is supposed to be short and not too-long
    > waiting.  OTOH, the current code uses snd_card_free() at
    > disconnection, but this waits for the close of all used fds, hence it
    > can take long.  It eventually blocks the upper layer USB ioctls, which
    > may trigger a soft lockup.
    > An easy workaround is to replace snd_card_free() with
    > snd_card_free_when_closed().  This variant returns immediately while
    > the release of resources is done asynchronously by the card device
    > release at the last close.
    > The loop of us122l-&gt;mmap_count check is dropped as well.  The check is
    > useless for the asynchronous operation with *_when_closed().
    > Fixes: 030a07e44129 (&quot;ALSA: Add USB US122L driver&quot;)
    > Signed-off-by: Takashi Iwai &lt;tiwai@suse.de&gt;
    > Link: https://patch.msgid.link/20241113111042.15058-3-tiwai@suse.de
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ Bluetooth: btintel: Do no pass vendor events to stack (@Kiran K in [90fe2941f54e025](https://github.com/sophgo/linux-riscv/commit/90fe2941f54e025) at 2024-12-05 13:01:58)
    > [ Upstream commit 510e8380b0382ee3b070748656b00f83c9a5bf80 ]
    > During firmware download, vendor specific events like boot up and
    > secure send result are generated. These events can be safely processed at
    > the driver level. Passing on these events to stack prints unnecessary
    > log as below.
    > Bluetooth: hci0: Malformed MSFT vendor event: 0x02
    > Fixes: 3368aa357f3b (&quot;Bluetooth: msft: Handle MSFT Monitor Device Event&quot;)
    > Signed-off-by: Kiran K &lt;kiran.k@intel.com&gt;
    > Signed-off-by: Luiz Augusto von Dentz &lt;luiz.von.dentz@intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ALSA: 6fire: Release resources at card release (@Takashi Iwai in [57860a80f03f9dc](https://github.com/sophgo/linux-riscv/commit/57860a80f03f9dc) at 2024-12-05 13:01:58)
    > [ Upstream commit a0810c3d6dd2d29a9b92604d682eacd2902ce947 ]
    > The current 6fire code tries to release the resources right after the
    > call of usb6fire_chip_abort().  But at this moment, the card object
    > might be still in use (as we&#x27;re calling snd_card_free_when_closed()).
    > For avoid potential UAFs, move the release of resources to the card&#x27;s
    > private_free instead of the manual call of usb6fire_chip_destroy() at
    > the USB disconnect callback.
    > Fixes: c6d43ba816d1 (&quot;ALSA: usb/6fire - Driver for TerraTec DMX 6Fire USB&quot;)
    > Signed-off-by: Takashi Iwai &lt;tiwai@suse.de&gt;
    > Link: https://patch.msgid.link/20241113111042.15058-6-tiwai@suse.de
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ i2c: dev: Fix memory leak when underlying adapter does not support I2C (@Igor Pylypiv in [5556876be9ec466](https://github.com/sophgo/linux-riscv/commit/5556876be9ec466) at 2024-12-05 13:01:58)
    > [ Upstream commit 48730a9d04ffccda541602d722d1ff81920a85d8 ]
    > Early return in i2cdev_ioctl_rdwr() failed to free the memory allocated
    > by the caller. Move freeing the memory to the function where it has been
    > allocated to prevent similar leaks in the future.
    > Fixes: 97ca843f6ad3 (&quot;i2c: dev: Check for I2C_FUNC_I2C before calling i2c_transfer&quot;)
    > Signed-off-by: Igor Pylypiv &lt;ipylypiv@google.com&gt;
    > [wsa: replaced &#x27;&#x3D;&#x3D; NULL&#x27; with &#x27;!&#x27;]
    > Signed-off-by: Wolfram Sang &lt;wsa+renesas@sang-engineering.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ALSA: usx2y: Use snd_card_free_when_closed() at disconnection (@Takashi Iwai in [e869642a77a9b3b](https://github.com/sophgo/linux-riscv/commit/e869642a77a9b3b) at 2024-12-05 13:01:57)
    > [ Upstream commit dafb28f02be407e07a6f679e922a626592b481b0 ]
    > The USB disconnect callback is supposed to be short and not too-long
    > waiting.  OTOH, the current code uses snd_card_free() at
    > disconnection, but this waits for the close of all used fds, hence it
    > can take long.  It eventually blocks the upper layer USB ioctls, which
    > may trigger a soft lockup.
    > An easy workaround is to replace snd_card_free() with
    > snd_card_free_when_closed().  This variant returns immediately while
    > the release of resources is done asynchronously by the card device
    > release at the last close.
    > Fixes: 230cd5e24853 (&quot;[ALSA] prevent oops &amp; dead keyboard on usb unplugging while the device is be ing used&quot;)
    > Reported-by: syzbot+73582d08864d8268b6fd@syzkaller.appspotmail.com
    > Closes: https://syzkaller.appspot.com/bug?extid&#x3D;73582d08864d8268b6fd
    > Signed-off-by: Takashi Iwai &lt;tiwai@suse.de&gt;
    > Link: https://patch.msgid.link/20241113111042.15058-2-tiwai@suse.de
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ bpf: Use function pointers count as struct_ops links count (@Xu Kuohai in [9c44c06123e5bf9](https://github.com/sophgo/linux-riscv/commit/9c44c06123e5bf9) at 2024-12-05 13:01:57)
    > [ Upstream commit 821a3fa32bbe3bc0fa23b3189325d3720a49a24c ]
    > Only function pointers in a struct_ops structure can be linked to bpf
    > progs, so set the links count to the function pointers count, instead
    > of the total members count in the structure.
    > Suggested-by: Martin KaFai Lau &lt;martin.lau@linux.dev&gt;
    > Signed-off-by: Xu Kuohai &lt;xukuohai@huawei.com&gt;
    > Link: https://lore.kernel.org/r/20241112145849.3436772-3-xukuohai@huaweicloud.com
    > Signed-off-by: Alexei Starovoitov &lt;ast@kernel.org&gt;
    > Stable-dep-of: 7c8ce4ffb684 (&quot;bpf: Add kernel symbol for struct_ops trampoline&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ Revert &quot;wifi: iwlegacy: do not skip frames with bad FCS&quot; (@Kalle Valo in [6271eab4945ca65](https://github.com/sophgo/linux-riscv/commit/6271eab4945ca65) at 2024-12-05 13:01:57)
    > [ Upstream commit 11597043d74809daf5d14256b96d6781749b3f82 ]
    > This reverts commit 02b682d54598f61cbb7dbb14d98ec1801112b878.
    > Alf reports that this commit causes the connection to eventually die on
    > iwl4965. The reason is that rx_status.flag is zeroed after
    > RX_FLAG_FAILED_FCS_CRC is set and mac80211 doesn&#x27;t know the received frame is
    > corrupted.
    > Fixes: 02b682d54598 (&quot;wifi: iwlegacy: do not skip frames with bad FCS&quot;)
    > Reported-by: Alf Marius &lt;post@alfmarius.net&gt;
    > Closes: https://lore.kernel.org/r/60f752e8-787e-44a8-92ae-48bdfc9b43e7@app.fastmail.com/
    > Signed-off-by: Kalle Valo &lt;kvalo@kernel.org&gt;
    > Link: https://patch.msgid.link/20241112142419.1023743-1-kvalo@kernel.org
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ selftests/bpf: skip the timer_lockup test for single-CPU nodes (@Viktor Malik in [5d1c6381fade614](https://github.com/sophgo/linux-riscv/commit/5d1c6381fade614) at 2024-12-05 13:01:57)
    > [ Upstream commit 937a1c29a287e8f48c4cea714c76a13e14d989ac ]
    > The timer_lockup test needs 2 CPUs to work, on single-CPU nodes it fails
    > to set thread affinity to CPU 1 since it doesn&#x27;t exist:
    > # ./test_progs -t timer_lockup
    > test_timer_lockup:PASS:timer_lockup__open_and_load 0 nsec
    > test_timer_lockup:PASS:pthread_create thread1 0 nsec
    > test_timer_lockup:PASS:pthread_create thread2 0 nsec
    > timer_lockup_thread:PASS:cpu affinity 0 nsec
    > timer_lockup_thread:FAIL:cpu affinity unexpected error: 22 (errno 0)
    > test_timer_lockup:PASS: 0 nsec
    > #406     timer_lockup:FAIL
    > Skip the test if only 1 CPU is available.
    > Signed-off-by: Viktor Malik &lt;vmalik@redhat.com&gt;
    > Fixes: 50bd5a0c658d1 (&quot;selftests/bpf: Add timer lockup selftest&quot;)
    > Tested-by: Philo Lu &lt;lulie@linux.alibaba.com&gt;
    > Acked-by: Kumar Kartikeya Dwivedi &lt;memxor@gmail.com&gt;
    > Link: https://lore.kernel.org/r/20241107115231.75200-1-vmalik@redhat.com
    > Signed-off-by: Alexei Starovoitov &lt;ast@kernel.org&gt;
    > Signed-off-by: Andrii Nakryiko &lt;andrii@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ bpf: Add kernel symbol for struct_ops trampoline (@Xu Kuohai in [449b1a71788af14](https://github.com/sophgo/linux-riscv/commit/449b1a71788af14) at 2024-12-05 13:01:57)
    > [ Upstream commit 7c8ce4ffb684676039b1ff9ff81c126794e8d88e ]
    > Without kernel symbols for struct_ops trampoline, the unwinder may
    > produce unexpected stacktraces.
    > For example, the x86 ORC and FP unwinders check if an IP is in kernel
    > text by verifying the presence of the IP&#x27;s kernel symbol. When a
    > struct_ops trampoline address is encountered, the unwinder stops due
    > to the absence of symbol, resulting in an incomplete stacktrace that
    > consists only of direct and indirect child functions called from the
    > trampoline.
    > The arm64 unwinder is another example. While the arm64 unwinder can
    > proceed across a struct_ops trampoline address, the corresponding
    > symbol name is displayed as &quot;unknown&quot;, which is confusing.
    > Thus, add kernel symbol for struct_ops trampoline. The name is
    > bpf__&lt;struct_ops_name&gt;_&lt;member_name&gt;, where &lt;struct_ops_name&gt; is the
    > type name of the struct_ops, and &lt;member_name&gt; is the name of
    > the member that the trampoline is linked to.
    > Below is a comparison of stacktraces captured on x86 by perf record,
    > before and after this patch.
    > Before:
    > ffffffff8116545d __lock_acquire+0xad ([kernel.kallsyms])
    > ffffffff81167fcc lock_acquire+0xcc ([kernel.kallsyms])
    > ffffffff813088f4 __bpf_prog_enter+0x34 ([kernel.kallsyms])
    > After:
    > ffffffff811656bd __lock_acquire+0x30d ([kernel.kallsyms])
    > ffffffff81167fcc lock_acquire+0xcc ([kernel.kallsyms])
    > ffffffff81309024 __bpf_prog_enter+0x34 ([kernel.kallsyms])
    > ffffffffc000d7e9 bpf__tcp_congestion_ops_cong_avoid+0x3e ([kernel.kallsyms])
    > ffffffff81f250a5 tcp_ack+0x10d5 ([kernel.kallsyms])
    > ffffffff81f27c66 tcp_rcv_established+0x3b6 ([kernel.kallsyms])
    > ffffffff81f3ad03 tcp_v4_do_rcv+0x193 ([kernel.kallsyms])
    > ffffffff81d65a18 __release_sock+0xd8 ([kernel.kallsyms])
    > ffffffff81d65af4 release_sock+0x34 ([kernel.kallsyms])
    > ffffffff81f15c4b tcp_sendmsg+0x3b ([kernel.kallsyms])
    > ffffffff81f663d7 inet_sendmsg+0x47 ([kernel.kallsyms])
    > ffffffff81d5ab40 sock_write_iter+0x160 ([kernel.kallsyms])
    > ffffffff8149c67b vfs_write+0x3fb ([kernel.kallsyms])
    > ffffffff8149caf6 ksys_write+0xc6 ([kernel.kallsyms])
    > ffffffff8149cb5d __x64_sys_write+0x1d ([kernel.kallsyms])
    > ffffffff81009200 x64_sys_call+0x1d30 ([kernel.kallsyms])
    > ffffffff82232d28 do_syscall_64+0x68 ([kernel.kallsyms])
    > ffffffff8240012f entry_SYSCALL_64_after_hwframe+0x76 ([kernel.kallsyms])
    > Fixes: 85d33df357b6 (&quot;bpf: Introduce BPF_MAP_TYPE_STRUCT_OPS&quot;)
    > Signed-off-by: Xu Kuohai &lt;xukuohai@huawei.com&gt;
    > Acked-by: Yonghong Song &lt;yonghong.song@linux.dev&gt;
    > Link: https://lore.kernel.org/r/20241112145849.3436772-4-xukuohai@huaweicloud.com
    > Signed-off-by: Alexei Starovoitov &lt;ast@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ipv6: Fix soft lockups in fib6_select_path under high next hop churn (@Omid Ehtemam-Haghighi in [34a949e7a0869df](https://github.com/sophgo/linux-riscv/commit/34a949e7a0869df) at 2024-12-05 13:01:57)
    > [ Upstream commit d9ccb18f83ea2bb654289b6ecf014fd267cc988b ]
    > Soft lockups have been observed on a cluster of Linux-based edge routers
    > located in a highly dynamic environment. Using the &#x60;bird&#x60; service, these
    > routers continuously update BGP-advertised routes due to frequently
    > changing nexthop destinations, while also managing significant IPv6
    > traffic. The lockups occur during the traversal of the multipath
    > circular linked-list in the &#x60;fib6_select_path&#x60; function, particularly
    > while iterating through the siblings in the list. The issue typically
    > arises when the nodes of the linked list are unexpectedly deleted
    > concurrently on a different core—indicated by their &#x27;next&#x27; and
    > &#x27;previous&#x27; elements pointing back to the node itself and their reference
    > count dropping to zero. This results in an infinite loop, leading to a
    > soft lockup that triggers a system panic via the watchdog timer.
    > Apply RCU primitives in the problematic code sections to resolve the
    > issue. Where necessary, update the references to fib6_siblings to
    > annotate or use the RCU APIs.
    > Include a test script that reproduces the issue. The script
    > periodically updates the routing table while generating a heavy load
    > of outgoing IPv6 traffic through multiple iperf3 clients. It
    > consistently induces infinite soft lockups within a couple of minutes.
    > Kernel log:
    > 0 [ffffbd13003e8d30] machine_kexec at ffffffff8ceaf3eb
    > 1 [ffffbd13003e8d90] __crash_kexec at ffffffff8d0120e3
    > 2 [ffffbd13003e8e58] panic at ffffffff8cef65d4
    > 3 [ffffbd13003e8ed8] watchdog_timer_fn at ffffffff8d05cb03
    > 4 [ffffbd13003e8f08] __hrtimer_run_queues at ffffffff8cfec62f
    > 5 [ffffbd13003e8f70] hrtimer_interrupt at ffffffff8cfed756
    > 6 [ffffbd13003e8fd0] __sysvec_apic_timer_interrupt at ffffffff8cea01af
    > 7 [ffffbd13003e8ff0] sysvec_apic_timer_interrupt at ffffffff8df1b83d
    > -- &lt;IRQ stack&gt; --
    > 8 [ffffbd13003d3708] asm_sysvec_apic_timer_interrupt at ffffffff8e000ecb
    > [exception RIP: fib6_select_path+299]
    > RIP: ffffffff8ddafe7b  RSP: ffffbd13003d37b8  RFLAGS: 00000287
    > RAX: ffff975850b43600  RBX: ffff975850b40200  RCX: 0000000000000000
    > RDX: 000000003fffffff  RSI: 0000000051d383e4  RDI: ffff975850b43618
    > RBP: ffffbd13003d3800   R8: 0000000000000000   R9: ffff975850b40200
    > R10: 0000000000000000  R11: 0000000000000000  R12: ffffbd13003d3830
    > R13: ffff975850b436a8  R14: ffff975850b43600  R15: 0000000000000007
    > ORIG_RAX: ffffffffffffffff  CS: 0010  SS: 0018
    > 9 [ffffbd13003d3808] ip6_pol_route at ffffffff8ddb030c
    > 10 [ffffbd13003d3888] ip6_pol_route_input at ffffffff8ddb068c
    > 11 [ffffbd13003d3898] fib6_rule_lookup at ffffffff8ddf02b5
    > 12 [ffffbd13003d3928] ip6_route_input at ffffffff8ddb0f47
    > 13 [ffffbd13003d3a18] ip6_rcv_finish_core.constprop.0 at ffffffff8dd950d0
    > 14 [ffffbd13003d3a30] ip6_list_rcv_finish.constprop.0 at ffffffff8dd96274
    > 15 [ffffbd13003d3a98] ip6_sublist_rcv at ffffffff8dd96474
    > 16 [ffffbd13003d3af8] ipv6_list_rcv at ffffffff8dd96615
    > 17 [ffffbd13003d3b60] __netif_receive_skb_list_core at ffffffff8dc16fec
    > 18 [ffffbd13003d3be0] netif_receive_skb_list_internal at ffffffff8dc176b3
    > 19 [ffffbd13003d3c50] napi_gro_receive at ffffffff8dc565b9
    > 20 [ffffbd13003d3c80] ice_receive_skb at ffffffffc087e4f5 [ice]
    > 21 [ffffbd13003d3c90] ice_clean_rx_irq at ffffffffc0881b80 [ice]
    > 22 [ffffbd13003d3d20] ice_napi_poll at ffffffffc088232f [ice]
    > 23 [ffffbd13003d3d80] __napi_poll at ffffffff8dc18000
    > 24 [ffffbd13003d3db8] net_rx_action at ffffffff8dc18581
    > 25 [ffffbd13003d3e40] __do_softirq at ffffffff8df352e9
    > 26 [ffffbd13003d3eb0] run_ksoftirqd at ffffffff8ceffe47
    > 27 [ffffbd13003d3ec0] smpboot_thread_fn at ffffffff8cf36a30
    > 28 [ffffbd13003d3ee8] kthread at ffffffff8cf2b39f
    > 29 [ffffbd13003d3f28] ret_from_fork at ffffffff8ce5fa64
    > 30 [ffffbd13003d3f50] ret_from_fork_asm at ffffffff8ce03cbb
    > Fixes: 66f5d6ce53e6 (&quot;ipv6: replace rwlock with rcu and spinlock in fib6_table&quot;)
    > Reported-by: Adrian Oliver &lt;kernel@aoliver.ca&gt;
    > Signed-off-by: Omid Ehtemam-Haghighi &lt;omid.ehtemamhaghighi@menlosecurity.com&gt;
    > Cc: Shuah Khan &lt;shuah@kernel.org&gt;
    > Cc: Ido Schimmel &lt;idosch@idosch.org&gt;
    > Cc: Kuniyuki Iwashima &lt;kuniyu@amazon.com&gt;
    > Cc: Simon Horman &lt;horms@kernel.org&gt;
    > Reviewed-by: David Ahern &lt;dsahern@kernel.org&gt;
    > Link: https://patch.msgid.link/20241106010236.1239299-1-omid.ehtemamhaghighi@menlosecurity.com
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ net: rfkill: gpio: Add check for clk_enable() (@Mingwei Zheng in [20be8d4bfafb0fa](https://github.com/sophgo/linux-riscv/commit/20be8d4bfafb0fa) at 2024-12-05 13:01:57)
    > [ Upstream commit 8251e7621b25ccdb689f1dd9553b8789e3745ea1 ]
    > Add check for the return value of clk_enable() to catch the potential
    > error.
    > Fixes: 7176ba23f8b5 (&quot;net: rfkill: add generic gpio rfkill driver&quot;)
    > Signed-off-by: Mingwei Zheng &lt;zmw12306@gmail.com&gt;
    > Signed-off-by: Jiasheng Jiang &lt;jiashengjiangcool@gmail.com&gt;
    > Link: https://patch.msgid.link/20241108195341.1853080-1-zmw12306@gmail.com
    > Signed-off-by: Johannes Berg &lt;johannes.berg@intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/amdkfd: Fix wrong usage of INIT_WORK() (@Yuan Can in [fa6813b1109cf76](https://github.com/sophgo/linux-riscv/commit/fa6813b1109cf76) at 2024-12-05 13:01:56)
    > [ Upstream commit 21cae8debc6a1d243f64fa82cd1b41cb612b5c61 ]
    > In kfd_procfs_show(), the sdma_activity_work_handler is a local variable
    > and the sdma_activity_work_handler.sdma_activity_work should initialize
    > with INIT_WORK_ONSTACK() instead of INIT_WORK().
    > Fixes: 32cb59f31362 (&quot;drm/amdkfd: Track SDMA utilization per process&quot;)
    > Signed-off-by: Yuan Can &lt;yuancan@huawei.com&gt;
    > Signed-off-by: Felix Kuehling &lt;felix.kuehling@amd.com&gt;
    > Reviewed-by: Felix Kuehling &lt;felix.kuehling@amd.com&gt;
    > Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ bpf: Force uprobe bpf program to always return 0 (@Jiri Olsa in [9ff1b95ccd88492](https://github.com/sophgo/linux-riscv/commit/9ff1b95ccd88492) at 2024-12-05 13:01:56)
    > [ Upstream commit f505005bc7426f4309880da94cfbfc37efa225bd ]
    > As suggested by Andrii make uprobe multi bpf programs to always return 0,
    > so they can&#x27;t force uprobe removal.
    > Keeping the int return type for uprobe_prog_run, because it will be used
    > in following session changes.
    > Fixes: 89ae89f53d20 (&quot;bpf: Add multi uprobe link&quot;)
    > Suggested-by: Andrii Nakryiko &lt;andrii@kernel.org&gt;
    > Signed-off-by: Jiri Olsa &lt;jolsa@kernel.org&gt;
    > Signed-off-by: Andrii Nakryiko &lt;andrii@kernel.org&gt;
    > Acked-by: Andrii Nakryiko &lt;andrii@kernel.org&gt;
    > Link: https://lore.kernel.org/bpf/20241108134544.480660-3-jolsa@kernel.org
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ wifi: iwlwifi: mvm: tell iwlmei when we finished suspending (@Emmanuel Grumbach in [65bb123d39bc91a](https://github.com/sophgo/linux-riscv/commit/65bb123d39bc91a) at 2024-12-05 13:01:56)
    > [ Upstream commit d1a54ec21b8e7bca59141ff1ac6ce73e07d744f2 ]
    > Since we no longer shut down the device in suspend, we also no longer
    > call iwl_mvm_mei_device_state() and this is a problem because iwlmei
    > expects this to be called when it runs its own suspend sequence. It
    > checks mei-&gt;device_down in iwl_mei_remove() which is called upon
    > suspend.
    > Fix this by telling iwlmei when we&#x27;re done accessing the device.
    > When we&#x27;ll wake up, the device should be untouched if CSME didn&#x27;t use it
    > during the suspend time. If CSME used it, we&#x27;ll notice it through the
    > CSR_FUNC_SCRATCH register.
    > Fixes: e8bb19c1d590 (&quot;wifi: iwlwifi: support fast resume&quot;)
    > Signed-off-by: Emmanuel Grumbach &lt;emmanuel.grumbach@intel.com&gt;
    > Signed-off-by: Miri Korenblit &lt;miriam.rachel.korenblit@intel.com&gt;
    > Link: https://patch.msgid.link/20241028135215.525287b90af2.Ibf183824471ea5580d9276d104444e53191e6900@changeid
    > Signed-off-by: Johannes Berg &lt;johannes.berg@intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/amdgpu: Fix map/unmap queue logic (@Lijo Lazar in [4a1db2a301749c1](https://github.com/sophgo/linux-riscv/commit/4a1db2a301749c1) at 2024-12-05 13:01:56)
    > [ Upstream commit fa31798582882740f2b13d19e1bd43b4ef918e2f ]
    > In current logic, it calls ring_alloc followed by a ring_test. ring_test
    > in turn will call another ring_alloc. This is illegal usage as a
    > ring_alloc is expected to be closed properly with a ring_commit. Change
    > to commit the map/unmap queue packet first followed by a ring_test. Add a
    > comment about the usage of ring_test.
    > Also, reorder the current pre-condition checks of job hang or kiq ring
    > scheduler not ready. Without them being met, it is not useful to attempt
    > ring or memory allocations.
    > Fixes tag refers to the original patch which introduced this issue which
    > then got carried over into newer code.
    > Signed-off-by: Lijo Lazar &lt;lijo.lazar@amd.com&gt;
    > Reviewed-by: Le Ma &lt;le.ma@amd.com&gt;
    > Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Fixes: 6c10b5cc4eaa (&quot;drm/amdgpu: Remove duplicate code in gfx_v8_0.c&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ bpf: Allow return values 0 and 1 for kprobe session (@Jiri Olsa in [36ede57f0c51f12](https://github.com/sophgo/linux-riscv/commit/36ede57f0c51f12) at 2024-12-05 13:01:56)
    > [ Upstream commit 17c4b65a24938c6dd79496cce5df15f70d9c253c ]
    > The kprobe session program can return only 0 or 1,
    > instruct verifier to check for that.
    > Fixes: 535a3692ba72 (&quot;bpf: Add support for kprobe session attach&quot;)
    > Signed-off-by: Jiri Olsa &lt;jolsa@kernel.org&gt;
    > Signed-off-by: Andrii Nakryiko &lt;andrii@kernel.org&gt;
    > Acked-by: Andrii Nakryiko &lt;andrii@kernel.org&gt;
    > Link: https://lore.kernel.org/bpf/20241108134544.480660-2-jolsa@kernel.org
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/amdgpu: fix ACA bank count boundary check error (@Yang Wang in [27eaeebd6c1c9d6](https://github.com/sophgo/linux-riscv/commit/27eaeebd6c1c9d6) at 2024-12-05 13:01:56)
    > [ Upstream commit 2bb7dced1c2f8c0e705cc74840f776406db492c3 ]
    > fix ACA bank count boundary check error.
    > Fixes: f5e4cc8461c4 (&quot;drm/amdgpu: implement RAS ACA driver framework&quot;)
    > Signed-off-by: Yang Wang &lt;kevinyang.wang@amd.com&gt;
    > Reviewed-by: Tao Zhou &lt;tao.zhou1@amd.com&gt;
    > Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ wifi: cfg80211: Remove the Medium Synchronization Delay validity check (@Lingbo Kong in [ee22f520cc66092](https://github.com/sophgo/linux-riscv/commit/ee22f520cc66092) at 2024-12-05 13:01:55)
    > [ Upstream commit b4ebb58cb9a4b1b5cb5278b09d6afdcd71b2a6b4 ]
    > Currently, when the driver attempts to connect to an AP MLD with multiple
    > APs, the cfg80211_mlme_check_mlo_compat() function requires the Medium
    > Synchronization Delay values from different APs of the same AP MLD to be
    > equal, which may result in connection failures.
    > This is because when the driver receives a multi-link probe response from
    > an AP MLD with multiple APs, cfg80211 updates the Elements for each AP
    > based on the multi-link probe response. If the Medium Synchronization Delay
    > is set in the multi-link probe response, the Elements for each AP belonging
    > to the same AP MLD will have the Medium Synchronization Delay set
    > simultaneously. If non-multi-link probe responses are received from
    > different APs of the same MLD AP, cfg80211 will still update the Elements
    > based on the non-multi-link probe response. Since the non-multi-link probe
    > response does not set the Medium Synchronization Delay
    > (IEEE 802.11be-2024-35.3.4.4), if the Elements from a non-multi-link probe
    > response overwrite those from a multi-link probe response that has set the
    > Medium Synchronization Delay, the Medium Synchronization Delay values for
    > APs belonging to the same AP MLD will not be equal. This discrepancy causes
    > the cfg80211_mlme_check_mlo_compat() function to fail, leading to
    > connection failures. Commit ccb964b4ab16
    > (&quot;wifi: cfg80211: validate MLO connections better&quot;) did not take this into
    > account.
    > To address this issue, remove this validity check.
    > Fixes: ccb964b4ab16 (&quot;wifi: cfg80211: validate MLO connections better&quot;)
    > Signed-off-by: Lingbo Kong &lt;quic_lingbok@quicinc.com&gt;
    > Link: https://patch.msgid.link/20241031134223.970-1-quic_lingbok@quicinc.com
    > Signed-off-by: Johannes Berg &lt;johannes.berg@intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ selftests: net: really check for bg process completion (@Paolo Abeni in [d1c7578c5b0648d](https://github.com/sophgo/linux-riscv/commit/d1c7578c5b0648d) at 2024-12-05 13:01:55)
    > [ Upstream commit 52ed077aa6336dbef83a2d6d21c52d1706fb7f16 ]
    > A recent refactor transformed the check for process completion
    > in a true statement, due to a typo.
    > As a result, the relevant test-case is unable to catch the
    > regression it was supposed to detect.
    > Restore the correct condition.
    > Fixes: 691bb4e49c98 (&quot;selftests: net: avoid just another constant wait&quot;)
    > Signed-off-by: Paolo Abeni &lt;pabeni@redhat.com&gt;
    > Reviewed-by: David Ahern &lt;dsahern@kernel.org&gt;
    > Link: https://patch.msgid.link/0e6f213811f8e93a235307e683af8225cc6277ae.1730828007.git.pabeni@redhat.com
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ wifi: iwlwifi: allow fast resume on ax200 (@Emmanuel Grumbach in [b9fc91a80dc71bc](https://github.com/sophgo/linux-riscv/commit/b9fc91a80dc71bc) at 2024-12-05 13:01:55)
    > [ Upstream commit e53ebc72054efca12e0329d69342e3daf7250a5a ]
    > This feature can be used on ax200 as well. It&#x27;ll avoid to restart the
    > firmware upon suspend / resume flow. Doing so also avoids releasing and
    > re-allocating all the device related memory which makes the memory&#x27;s
    > subsystem task easier.
    > Signed-off-by: Emmanuel Grumbach &lt;emmanuel.grumbach@intel.com&gt;
    > Signed-off-by: Miri Korenblit &lt;miriam.rachel.korenblit@intel.com&gt;
    > Link: https://patch.msgid.link/20241028135215.514efe0ce4c7.I60061277526302a75cadbba10452e94c54763f13@changeid
    > Signed-off-by: Johannes Berg &lt;johannes.berg@intel.com&gt;
    > Stable-dep-of: d1a54ec21b8e (&quot;wifi: iwlwifi: mvm: tell iwlmei when we finished suspending&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ bpf, sockmap: Several fixes to bpf_msg_pop_data (@Zijian Zhang in [275a9f3ef8fabb0](https://github.com/sophgo/linux-riscv/commit/275a9f3ef8fabb0) at 2024-12-05 13:01:55)
    > [ Upstream commit 5d609ba262475db450ba69b8e8a557bd768ac07a ]
    > Several fixes to bpf_msg_pop_data,
    > 1. In sk_msg_shift_left, we should put_page
    > 2. if (len &#x3D;&#x3D; 0), return early is better
    > 3. pop the entire sk_msg (last &#x3D;&#x3D; msg-&gt;sg.size) should be supported
    > 4. Fix for the value of variable &quot;a&quot;
    > 5. In sk_msg_shift_left, after shifting, i has already pointed to the next
    > element. Addtional sk_msg_iter_var_next may result in BUG.
    > Fixes: 7246d8ed4dcc (&quot;bpf: helper to pop data from messages&quot;)
    > Signed-off-by: Zijian Zhang &lt;zijianzhang@bytedance.com&gt;
    > Reviewed-by: John Fastabend &lt;john.fastabend@gmail.com&gt;
    > Link: https://lore.kernel.org/r/20241106222520.527076-8-zijianzhang@bytedance.com
    > Signed-off-by: Martin KaFai Lau &lt;martin.lau@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ipv6: release nexthop on device removal (@Paolo Abeni in [0e4c6faaef8a24b](https://github.com/sophgo/linux-riscv/commit/0e4c6faaef8a24b) at 2024-12-05 13:01:55)
    > [ Upstream commit eb02688c5c45c3e7af7e71f036a7144f5639cbfe ]
    > The CI is hitting some aperiodic hangup at device removal time in the
    > pmtu.sh self-test:
    > unregister_netdevice: waiting for veth_A-R1 to become free. Usage count &#x3D; 6
    > ref_tracker: veth_A-R1@ffff888013df15d8 has 1/5 users at
    > dst_init+0x84/0x4a0
    > dst_alloc+0x97/0x150
    > ip6_dst_alloc+0x23/0x90
    > ip6_rt_pcpu_alloc+0x1e6/0x520
    > ip6_pol_route+0x56f/0x840
    > fib6_rule_lookup+0x334/0x630
    > ip6_route_output_flags+0x259/0x480
    > ip6_dst_lookup_tail.constprop.0+0x5c2/0x940
    > ip6_dst_lookup_flow+0x88/0x190
    > udp_tunnel6_dst_lookup+0x2a7/0x4c0
    > vxlan_xmit_one+0xbde/0x4a50 [vxlan]
    > vxlan_xmit+0x9ad/0xf20 [vxlan]
    > dev_hard_start_xmit+0x10e/0x360
    > __dev_queue_xmit+0xf95/0x18c0
    > arp_solicit+0x4a2/0xe00
    > neigh_probe+0xaa/0xf0
    > While the first suspect is the dst_cache, explicitly tracking the dst
    > owing the last device reference via probes proved such dst is held by
    > the nexthop in the originating fib6_info.
    > Similar to commit f5b51fe804ec (&quot;ipv6: route: purge exception on
    > removal&quot;), we need to explicitly release the originating fib info when
    > disconnecting a to-be-removed device from a live ipv6 dst: move the
    > fib6_info cleanup into ip6_dst_ifdown().
    > Tested running:
    > ./pmtu.sh cleanup_ipv6_exception
    > in a tight loop for more than 400 iterations with no spat, running an
    > unpatched kernel  I observed a splat every ~10 iterations.
    > Fixes: f88d8ea67fbd (&quot;ipv6: Plumb support for nexthop object in a fib6_info&quot;)
    > Signed-off-by: Paolo Abeni &lt;pabeni@redhat.com&gt;
    > Reviewed-by: Eric Dumazet &lt;edumazet@google.com&gt;
    > Reviewed-by: David Ahern &lt;dsahern@kernel.org&gt;
    > Link: https://patch.msgid.link/604c45c188c609b732286b47ac2a451a40f6cf6d.1730828007.git.pabeni@redhat.com
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ bpf, sockmap: Fix sk_msg_reset_curr (@Zijian Zhang in [08baa3f0a1af543](https://github.com/sophgo/linux-riscv/commit/08baa3f0a1af543) at 2024-12-05 13:01:55)
    > [ Upstream commit 955afd57dc4bf7e8c620a0a9e3af3c881c2c6dff ]
    > Found in the test_txmsg_pull in test_sockmap,
    > &#x60;&#x60;&#x60;
    > txmsg_cork &#x3D; 512; // corking is importrant here
    > opt-&gt;iov_length &#x3D; 3;
    > opt-&gt;iov_count &#x3D; 1;
    > opt-&gt;rate &#x3D; 512; // sendmsg will be invoked 512 times
    > &#x60;&#x60;&#x60;
    > The first sendmsg will send an sk_msg with size 3, and bpf_msg_pull_data
    > will be invoked the first time. sk_msg_reset_curr will reset the copybreak
    > from 3 to 0. In the second sendmsg, since we are in the stage of corking,
    > psock-&gt;cork will be reused in func sk_msg_alloc. msg-&gt;sg.copybreak is 0
    > now, the second msg will overwrite the first msg. As a result, we could
    > not pass the data integrity test.
    > The same problem happens in push and pop test. Thus, fix sk_msg_reset_curr
    > to restore the correct copybreak.
    > Fixes: bb9aefde5bba (&quot;bpf: sockmap, updating the sg structure should also update curr&quot;)
    > Signed-off-by: Zijian Zhang &lt;zijianzhang@bytedance.com&gt;
    > Link: https://lore.kernel.org/r/20241106222520.527076-9-zijianzhang@bytedance.com
    > Signed-off-by: Martin KaFai Lau &lt;martin.lau@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ bpf, sockmap: Several fixes to bpf_msg_push_data (@Zijian Zhang in [ce06c450acb5d94](https://github.com/sophgo/linux-riscv/commit/ce06c450acb5d94) at 2024-12-05 13:01:54)
    > [ Upstream commit 15ab0548e3107665c34579ae523b2b6e7c22082a ]
    > Several fixes to bpf_msg_push_data,
    > 1. test_sockmap has tests where bpf_msg_push_data is invoked to push some
    > data at the end of a message, but -EINVAL is returned. In this case, in
    > bpf_msg_push_data, after the first loop, i will be set to msg-&gt;sg.end, add
    > the logic to handle it.
    > 2. In the code block of &quot;if (start - offset)&quot;, it&#x27;s possible that &quot;i&quot;
    > points to the last of sk_msg_elem. In this case, &quot;sk_msg_iter_next(msg,
    > end)&quot; might still be called twice, another invoking is in &quot;if (!copy)&quot;
    > code block, but actually only one is needed. Add the logic to handle it,
    > and reconstruct the code to make the logic more clear.
    > Fixes: 6fff607e2f14 (&quot;bpf: sk_msg program helper bpf_msg_push_data&quot;)
    > Signed-off-by: Zijian Zhang &lt;zijianzhang@bytedance.com&gt;
    > Link: https://lore.kernel.org/r/20241106222520.527076-7-zijianzhang@bytedance.com
    > Signed-off-by: Martin KaFai Lau &lt;martin.lau@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ selftests/bpf: Add push/pop checking for msg_verify_data in test_sockmap (@Zijian Zhang in [c70dd5ab146364a](https://github.com/sophgo/linux-riscv/commit/c70dd5ab146364a) at 2024-12-05 13:01:54)
    > [ Upstream commit 862087c3d36219ed44569666eb263efc97f00c9a ]
    > Add push/pop checking for msg_verify_data in test_sockmap, except for
    > pop/push with cork tests, in these tests the logic will be different.
    > 1. With corking, pop/push might not be invoked in each sendmsg, it makes
    > the layout of the received data difficult
    > 2. It makes it hard to calculate the total_bytes in the recvmsg
    > Temporarily skip the data integrity test for these cases now, added a TODO
    > Fixes: ee9b352ce465 (&quot;selftests/bpf: Fix msg_verify_data in test_sockmap&quot;)
    > Signed-off-by: Zijian Zhang &lt;zijianzhang@bytedance.com&gt;
    > Reviewed-by: John Fastabend &lt;john.fastabend@gmail.com&gt;
    > Link: https://lore.kernel.org/r/20241106222520.527076-5-zijianzhang@bytedance.com
    > Signed-off-by: Martin KaFai Lau &lt;martin.lau@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/panthor: Fix OPP refcnt leaks in devfreq initialisation (@Adrián Larumbe in [63b2cc960261932](https://github.com/sophgo/linux-riscv/commit/63b2cc960261932) at 2024-12-05 13:01:54)
    > [ Upstream commit 21c23e4b64e360d74d31b480f0572c2add0e8558 ]
    > Rearrange lookup of recommended OPP for the Mali GPU device and its refcnt
    > decremental to make sure no OPP object leaks happen in the error path.
    > Signed-off-by: Adrián Larumbe &lt;adrian.larumbe@collabora.com&gt;
    > Fixes: fac9b22df4b1 (&quot;drm/panthor: Add the devfreq logical block&quot;)
    > Reviewed-by: Steven Price &lt;steven.price@arm.com&gt;
    > Reviewed-by: Liviu Dudau &lt;liviu.dudau@arm.com&gt;
    > Signed-off-by: Steven Price &lt;steven.price@arm.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20241105205458.1318989-2-adrian.larumbe@collabora.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ selftests/bpf: Add txmsg_pass to pull/push/pop in test_sockmap (@Zijian Zhang in [4d8521d0806108a](https://github.com/sophgo/linux-riscv/commit/4d8521d0806108a) at 2024-12-05 13:01:54)
    > [ Upstream commit 66c54c20408d994be34be2c070fba08472f69eee ]
    > Add txmsg_pass to test_txmsg_pull/push/pop. If txmsg_pass is missing,
    > tx_prog will be NULL, and no program will be attached to the sockmap.
    > As a result, pull/push/pop are never invoked.
    > Fixes: 328aa08a081b (&quot;bpf: Selftests, break down test_sockmap into subtests&quot;)
    > Signed-off-by: Zijian Zhang &lt;zijianzhang@bytedance.com&gt;
    > Reviewed-by: John Fastabend &lt;john.fastabend@gmail.com&gt;
    > Link: https://lore.kernel.org/r/20241106222520.527076-2-zijianzhang@bytedance.com
    > Signed-off-by: Martin KaFai Lau &lt;martin.lau@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ selftests/bpf: Fix total_bytes in msg_loop_rx in test_sockmap (@Zijian Zhang in [4c3825d468ac6c2](https://github.com/sophgo/linux-riscv/commit/4c3825d468ac6c2) at 2024-12-05 13:01:54)
    > [ Upstream commit 523dffccbadea0cfd65f1ff04944b864c558c4a8 ]
    > total_bytes in msg_loop_rx should also take push into account, otherwise
    > total_bytes will be a smaller value, which makes the msg_loop_rx end early.
    > Besides, total_bytes has already taken pop into account, so we don&#x27;t need
    > to subtract some bytes from iov_buf in sendmsg_test. The additional
    > subtraction may make total_bytes a negative number, and msg_loop_rx will
    > just end without checking anything.
    > Fixes: 18d4e900a450 (&quot;bpf: Selftests, improve test_sockmap total bytes counter&quot;)
    > Fixes: d69672147faa (&quot;selftests, bpf: Add one test for sockmap with strparser&quot;)
    > Signed-off-by: Zijian Zhang &lt;zijianzhang@bytedance.com&gt;
    > Reviewed-by: John Fastabend &lt;john.fastabend@gmail.com&gt;
    > Link: https://lore.kernel.org/r/20241106222520.527076-4-zijianzhang@bytedance.com
    > Signed-off-by: Martin KaFai Lau &lt;martin.lau@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ isofs: avoid memory leak in iocharset (@Hao Ge in [0fbab266ca80003](https://github.com/sophgo/linux-riscv/commit/0fbab266ca80003) at 2024-12-05 13:01:54)
    > [ Upstream commit 0b5bbeee4de616a268db77e2f40f19ab010a367b ]
    > A memleak was found as below:
    > unreferenced object 0xffff0000d10164d8 (size 8):
    > comm &quot;pool-udisksd&quot;, pid 108217, jiffies 4295408555
    > hex dump (first 8 bytes):
    > 75 74 66 38 00 cc cc cc                          utf8....
    > backtrace (crc de430d31):
    > [&lt;ffff800081046e6c&gt;] kmemleak_alloc+0xb8/0xc8
    > [&lt;ffff8000803e6c3c&gt;] __kmalloc_node_track_caller_noprof+0x380/0x474
    > [&lt;ffff800080363b74&gt;] kstrdup+0x70/0xfc
    > [&lt;ffff80007bb3c6a4&gt;] isofs_parse_param+0x228/0x2c0 [isofs]
    > [&lt;ffff8000804d7f68&gt;] vfs_parse_fs_param+0xf4/0x164
    > [&lt;ffff8000804d8064&gt;] vfs_parse_fs_string+0x8c/0xd4
    > [&lt;ffff8000804d815c&gt;] vfs_parse_monolithic_sep+0xb0/0xfc
    > [&lt;ffff8000804d81d8&gt;] generic_parse_monolithic+0x30/0x3c
    > [&lt;ffff8000804d8bfc&gt;] parse_monolithic_mount_data+0x40/0x4c
    > [&lt;ffff8000804b6a64&gt;] path_mount+0x6c4/0x9ec
    > [&lt;ffff8000804b6e38&gt;] do_mount+0xac/0xc4
    > [&lt;ffff8000804b7494&gt;] __arm64_sys_mount+0x16c/0x2b0
    > [&lt;ffff80008002b8dc&gt;] invoke_syscall+0x7c/0x104
    > [&lt;ffff80008002ba44&gt;] el0_svc_common.constprop.1+0xe0/0x104
    > [&lt;ffff80008002ba94&gt;] do_el0_svc+0x2c/0x38
    > [&lt;ffff800081041108&gt;] el0_svc+0x3c/0x1b8
    > The opt-&gt;iocharset is freed inside the isofs_fill_super function,
    > But there may be situations where it&#x27;s not possible to
    > enter this function.
    > For example, in the get_tree_bdev_flags function,when
    > encountering the situation where &quot;Can&#x27;t mount, would change RO state,&quot;
    > In such a case, isofs_fill_super will not have the opportunity
    > to be called,which means that opt-&gt;iocharset will not have the chance
    > to be freed,ultimately leading to a memory leak.
    > Let&#x27;s move the memory freeing of opt-&gt;iocharset into
    > isofs_free_fc function.
    > Fixes: 1b17a46c9243 (&quot;isofs: convert isofs to use the new mount API&quot;)
    > Signed-off-by: Hao Ge &lt;gehao@kylinos.cn&gt;
    > Reviewed-by: Eric Sandeen &lt;sandeen@redhat.com&gt;
    > Signed-off-by: Jan Kara &lt;jack@suse.cz&gt;
    > Link: https://patch.msgid.link/20241106082841.51773-1-hao.ge@linux.dev
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ selftests/bpf: Fix SENDPAGE data logic in test_sockmap (@Zijian Zhang in [0545f66337b8696](https://github.com/sophgo/linux-riscv/commit/0545f66337b8696) at 2024-12-05 13:01:54)
    > [ Upstream commit 4095031463d4e99b534d2cd82035a417295764ae ]
    > In the SENDPAGE test, &quot;opt-&gt;iov_length * cnt&quot; size of data will be sent
    > cnt times by sendfile.
    > 1. In push/pop tests, they will be invoked cnt times, for the simplicity of
    > msg_verify_data, change chunk_sz to iov_length
    > 2. Change iov_length in test_send_large from 1024 to 8192. We have pop test
    > where txmsg_start_pop is 4096. 4096 &gt; 1024, an error will be returned.
    > Fixes: 328aa08a081b (&quot;bpf: Selftests, break down test_sockmap into subtests&quot;)
    > Signed-off-by: Zijian Zhang &lt;zijianzhang@bytedance.com&gt;
    > Reviewed-by: John Fastabend &lt;john.fastabend@gmail.com&gt;
    > Link: https://lore.kernel.org/r/20241106222520.527076-3-zijianzhang@bytedance.com
    > Signed-off-by: Martin KaFai Lau &lt;martin.lau@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/panthor: introduce job cycle and timestamp accounting (@Adrián Larumbe in [ed0515a9d077a37](https://github.com/sophgo/linux-riscv/commit/ed0515a9d077a37) at 2024-12-05 13:01:53)
    > [ Upstream commit f8ff51a4708451763e6cfa36cc83dea8513d3318 ]
    > Enable calculations of job submission times in clock cycles and wall
    > time. This is done by expanding the boilerplate command stream when running
    > a job to include instructions that compute said times right before and
    > after a user CS.
    > A separate kernel BO is created per queue to store those values. Jobs can
    > access their sampled data through an index different from that of the
    > queue&#x27;s ringbuffer. The reason for this is saving memory on the profiling
    > information kernel BO, since the amount of simultaneous profiled jobs we
    > can write into the queue&#x27;s ringbuffer might be much smaller than for
    > regular jobs, as the former take more CSF instructions.
    > This commit is done in preparation for enabling DRM fdinfo support in the
    > Panthor driver, which depends on the numbers calculated herein.
    > A profile mode mask has been added that will in a future commit allow UM to
    > toggle performance metric sampling behaviour, which is disabled by default
    > to save power. When a ringbuffer CS is constructed, timestamp and cycling
    > sampling instructions are added depending on the enabled flags in the
    > profiling mask.
    > A helper was provided that calculates the number of instructions for a
    > given set of enablement mask, and these are passed as the number of credits
    > when initialising a DRM scheduler job.
    > Signed-off-by: Adrián Larumbe &lt;adrian.larumbe@collabora.com&gt;
    > Reviewed-by: Boris Brezillon &lt;boris.brezillon@collabora.com&gt;
    > Reviewed-by: Liviu Dudau &lt;liviu.dudau@arm.com&gt;
    > Reviewed-by: Steven Price &lt;steven.price@arm.com&gt;
    > Signed-off-by: Boris Brezillon &lt;boris.brezillon@collabora.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20240923230912.2207320-2-adrian.larumbe@collabora.com
    > Stable-dep-of: 21c23e4b64e3 (&quot;drm/panthor: Fix OPP refcnt leaks in devfreq initialisation&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ netlink: typographical error in nlmsg_type constants definition (@Maurice Lambert in [bc235847686b1e5](https://github.com/sophgo/linux-riscv/commit/bc235847686b1e5) at 2024-12-05 13:01:53)
    > [ Upstream commit 84bfbfbbd32aee136afea4b6bf82581dce79c305 ]
    > This commit fix a typographical error in netlink nlmsg_type constants definition in the include/uapi/linux/rtnetlink.h at line 177. The definition is RTM_NEWNVLAN RTM_NEWVLAN instead of RTM_NEWVLAN RTM_NEWVLAN.
    > Signed-off-by: Maurice Lambert &lt;mauricelambert434@gmail.com&gt;
    > Fixes: 8dcea187088b (&quot;net: bridge: vlan: add rtm definitions and dump support&quot;)
    > Link: https://patch.msgid.link/20241103223950.230300-1-mauricelambert434@gmail.com
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ wifi: rtw89: coex: check NULL return of kmalloc in btc_fw_set_monreg() (@Pei Xiao in [64db1a42d983070](https://github.com/sophgo/linux-riscv/commit/64db1a42d983070) at 2024-12-05 13:01:53)
    > [ Upstream commit 81df5ed446b448bdc327b7c7f0b50121fc1f4aa2 ]
    > kmalloc may fail, return value might be NULL and will cause
    > NULL pointer dereference. Add check NULL return of kmalloc in
    > btc_fw_set_monreg().
    > Signed-off-by: Pei Xiao &lt;xiaopei01@kylinos.cn&gt;
    > Fixes: b952cb0a6e2d (&quot;wifi: rtw89: coex: Add register monitor report v7 format&quot;)
    > Signed-off-by: Ping-Ke Shih &lt;pkshih@realtek.com&gt;
    > Link: https://patch.msgid.link/516a91f3997534f708af43c7592cbafdd53dd599.1730253508.git.xiaopei01@kylinos.cn
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ netfilter: nf_tables: must hold rcu read lock while iterating object type list (@Florian Westphal in [47b2ea9940bf510](https://github.com/sophgo/linux-riscv/commit/47b2ea9940bf510) at 2024-12-05 13:01:53)
    > [ Upstream commit cddc04275f95ca3b18da5c0fb111705ac173af89 ]
    > Update of stateful object triggers:
    > WARNING: suspicious RCU usage
    > net/netfilter/nf_tables_api.c:7759 RCU-list traversed in non-reader section!!
    > other info that might help us debug this:
    > rcu_scheduler_active &#x3D; 2, debug_locks &#x3D; 1
    > 1 lock held by nft/3060:
    > #0: ffff88810f0578c8 (&amp;nft_net-&gt;commit_mutex){+.+.}-{4:4}, [..]
    > ... but this list is not protected by the transaction mutex but the
    > nfnl nftables subsystem mutex.
    > Switch to nft_obj_type_get which will acquire rcu read lock,
    > bump refcount, and returns the result.
    > v3: Dan Carpenter points out nft_obj_type_get returns error pointer, not
    > NULL, on error.
    > Fixes: dad3bdeef45f (&quot;netfilter: nf_tables: fix memory leak during stateful obj update&quot;).
    > Signed-off-by: Florian Westphal &lt;fw@strlen.de&gt;
    > Signed-off-by: Pablo Neira Ayuso &lt;pablo@netfilter.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/panfrost: Add missing OPP table refcnt decremental (@Adrián Larumbe in [1af049b86908707](https://github.com/sophgo/linux-riscv/commit/1af049b86908707) at 2024-12-05 13:01:53)
    > [ Upstream commit 043e8afebf6c19abde9da1ac3d5cbf8b7ac8393f ]
    > Commit f11b0417eec2 (&quot;drm/panfrost: Add fdinfo support GPU load metrics&quot;)
    > retrieves the OPP for the maximum device clock frequency, but forgets to
    > keep the reference count balanced by putting the returned OPP object. This
    > eventually leads to an OPP core warning when removing the device.
    > Fix it by putting OPP objects as many times as they&#x27;re retrieved.
    > Also remove an unnecessary whitespace.
    > Signed-off-by: Adrián Larumbe &lt;adrian.larumbe@collabora.com&gt;
    > Fixes: f11b0417eec2 (&quot;drm/panfrost: Add fdinfo support GPU load metrics&quot;)
    > Reviewed-by: Steven Price &lt;steven.price@arm.com&gt;
    > Reviewed-by: Liviu Dudau &lt;liviu.dudau@arm.com&gt;
    > Signed-off-by: Steven Price &lt;steven.price@arm.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20241105205458.1318989-1-adrian.larumbe@collabora.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/panthor: record current and maximum device clock frequencies (@Adrián Larumbe in [1679d70d0a2a1b4](https://github.com/sophgo/linux-riscv/commit/1679d70d0a2a1b4) at 2024-12-05 13:01:53)
    > [ Upstream commit 37591ae11f89cdfc0a647945a589468642a44c17 ]
    > In order to support UM in calculating rates of GPU utilisation, the current
    > operating and maximum GPU clock frequencies must be recorded during device
    > initialisation, and also during OPP state transitions.
    > Signed-off-by: Adrián Larumbe &lt;adrian.larumbe@collabora.com&gt;
    > Reviewed-by: Steven Price &lt;steven.price@arm.com&gt;
    > Reviewed-by: Boris Brezillon &lt;boris.brezillon@collabora.com&gt;
    > Signed-off-by: Boris Brezillon &lt;boris.brezillon@collabora.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20240923230912.2207320-3-adrian.larumbe@collabora.com
    > Stable-dep-of: 21c23e4b64e3 (&quot;drm/panthor: Fix OPP refcnt leaks in devfreq initialisation&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ netfilter: nf_tables: must hold rcu read lock while iterating expression type list (@Florian Westphal in [f9028bc35cca1a6](https://github.com/sophgo/linux-riscv/commit/f9028bc35cca1a6) at 2024-12-05 13:01:52)
    > [ Upstream commit ee666a541ed957937454d50afa4757924508cd74 ]
    > nft shell tests trigger:
    > WARNING: suspicious RCU usage
    > net/netfilter/nf_tables_api.c:3125 RCU-list traversed in non-reader section!!
    > 1 lock held by nft/2068:
    > #0: ffff888106c6f8c8 (&amp;nft_net-&gt;commit_mutex){+.+.}-{4:4}, at: nf_tables_valid_genid+0x3c/0xf0
    > But the transaction mutex doesn&#x27;t protect this list, the nfnl subsystem
    > mutex would, but we can&#x27;t acquire it here without risk of ABBA
    > deadlocks.
    > Acquire the rcu read lock to avoid this issue.
    > v3: add a comment that explains the -&gt;inner_ops check implies
    > expression is builtin and lack of a module owner reference is ok.
    > Fixes: 3a07327d10a0 (&quot;netfilter: nft_inner: support for inner tunnel header matching&quot;)
    > Signed-off-by: Florian Westphal &lt;fw@strlen.de&gt;
    > Signed-off-by: Pablo Neira Ayuso &lt;pablo@netfilter.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/amdgpu: Fix the memory allocation issue in amdgpu_discovery_get_nps_info() (@Li Huafei in [e8f1dbaa0437eba](https://github.com/sophgo/linux-riscv/commit/e8f1dbaa0437eba) at 2024-12-05 13:01:52)
    > [ Upstream commit a1144da794adedb9447437c57d69add56494309d ]
    > Fix two issues with memory allocation in amdgpu_discovery_get_nps_info()
    > for mem_ranges:
    > - Add a check for allocation failure to avoid dereferencing a null
    > pointer.
    > - As suggested by Christophe, use kvcalloc() for memory allocation,
    > which checks for multiplication overflow.
    > Additionally, assign the output parameters nps_type and range_cnt after
    > the kvcalloc() call to prevent modifying the output parameters in case
    > of an error return.
    > Fixes: b194d21b9bcc (&quot;drm/amdgpu: Use NPS ranges from discovery table&quot;)
    > Suggested-by: Christophe JAILLET &lt;christophe.jaillet@wanadoo.fr&gt;
    > Reviewed-by: Lijo Lazar &lt;lijo.lazar@amd.com&gt;
    > Signed-off-by: Li Huafei &lt;lihuafei1@huawei.com&gt;
    > Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm: use ATOMIC64_INIT() for atomic64_t (@Jonathan Gray in [e883c475c4e3094](https://github.com/sophgo/linux-riscv/commit/e883c475c4e3094) at 2024-12-05 13:01:52)
    > [ Upstream commit 9877bb2775d020fb7000af5ca989331d09d0e372 ]
    > use ATOMIC64_INIT() not ATOMIC_INIT() for atomic64_t
    > Fixes: 3f09a0cd4ea3 (&quot;drm: Add common fdinfo helper&quot;)
    > Signed-off-by: Jonathan Gray &lt;jsg@jsg.id.au&gt;
    > Reviewed-by: Jani Nikula &lt;jani.nikula@intel.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20240111023045.50013-1-jsg@jsg.id.au
    > Signed-off-by: Jani Nikula &lt;jani.nikula@intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/amdkfd: Use dynamic allocation for CU occupancy array in &#x27;kfd_get_cu_occupancy()&#x27; (@Srinivasan Shanmugam in [6d9f07196389f35](https://github.com/sophgo/linux-riscv/commit/6d9f07196389f35) at 2024-12-05 13:01:52)
    > [ Upstream commit 922f0e00017b09d9d47e3efac008c8b20ed546a0 ]
    > The &#x60;kfd_get_cu_occupancy&#x60; function previously declared a large
    > &#x60;cu_occupancy&#x60; array as a local variable, which could lead to stack
    > overflows due to excessive stack usage. This commit replaces the static
    > array allocation with dynamic memory allocation using &#x60;kcalloc&#x60;,
    > thereby reducing the stack size.
    > This change avoids the risk of stack overflows in kernel space,  in
    > scenarios where &#x60;AMDGPU_MAX_QUEUES&#x60; is large. The  allocated memory is
    > freed using &#x60;kfree&#x60; before the function returns  to prevent memory
    > leaks.
    > Fixes the below with gcc W&#x3D;1:
    > drivers/gpu/drm/amd/amdgpu/../amdkfd/kfd_process.c: In function ‘kfd_get_cu_occupancy’:
    > drivers/gpu/drm/amd/amdgpu/../amdkfd/kfd_process.c:322:1: warning: the frame size of 1056 bytes is larger than 1024 bytes [-Wframe-larger-than&#x3D;]
    > 322 | }
    > | ^
    > Fixes: 6ae9e1aba97e (&quot;drm/amdkfd: Update logic for CU occupancy calculations&quot;)
    > Cc: Harish Kasiviswanathan &lt;Harish.Kasiviswanathan@amd.com&gt;
    > Cc: Felix Kuehling &lt;felix.kuehling@amd.com&gt;
    > Cc: Christian König &lt;christian.koenig@amd.com&gt;
    > Cc: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Signed-off-by: Srinivasan Shanmugam &lt;srinivasan.shanmugam@amd.com&gt;
    > Suggested-by: Mukul Joshi &lt;mukul.joshi@amd.com&gt;
    > Reviewed-by: Mukul Joshi &lt;mukul.joshi@amd.com&gt;
    > Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ bpf: Mark raw_tp arguments with PTR_MAYBE_NULL (@Kumar Kartikeya Dwivedi in [3634d4a31082056](https://github.com/sophgo/linux-riscv/commit/3634d4a31082056) at 2024-12-05 13:01:52)
    > [ Upstream commit cb4158ce8ec8a5bb528cc1693356a5eb8058094d ]
    > Arguments to a raw tracepoint are tagged as trusted, which carries the
    > semantics that the pointer will be non-NULL.  However, in certain cases,
    > a raw tracepoint argument may end up being NULL. More context about this
    > issue is available in [0].
    > Thus, there is a discrepancy between the reality, that raw_tp arguments
    > can actually be NULL, and the verifier&#x27;s knowledge, that they are never
    > NULL, causing explicit NULL checks to be deleted, and accesses to such
    > pointers potentially crashing the kernel.
    > To fix this, mark raw_tp arguments as PTR_MAYBE_NULL, and then special
    > case the dereference and pointer arithmetic to permit it, and allow
    > passing them into helpers/kfuncs; these exceptions are made for raw_tp
    > programs only. Ensure that we don&#x27;t do this when ref_obj_id &gt; 0, as in
    > that case this is an acquired object and doesn&#x27;t need such adjustment.
    > The reason we do mask_raw_tp_trusted_reg logic is because other will
    > recheck in places whether the register is a trusted_reg, and then
    > consider our register as untrusted when detecting the presence of the
    > PTR_MAYBE_NULL flag.
    > To allow safe dereference, we enable PROBE_MEM marking when we see loads
    > into trusted pointers with PTR_MAYBE_NULL.
    > While trusted raw_tp arguments can also be passed into helpers or kfuncs
    > where such broken assumption may cause issues, a future patch set will
    > tackle their case separately, as PTR_TO_BTF_ID (without PTR_TRUSTED) can
    > already be passed into helpers and causes similar problems. Thus, they
    > are left alone for now.
    > It is possible that these checks also permit passing non-raw_tp args
    > that are trusted PTR_TO_BTF_ID with null marking. In such a case,
    > allowing dereference when pointer is NULL expands allowed behavior, so
    > won&#x27;t regress existing programs, and the case of passing these into
    > helpers is the same as above and will be dealt with later.
    > Also update the failure case in tp_btf_nullable selftest to capture the
    > new behavior, as the verifier will no longer cause an error when
    > directly dereference a raw tracepoint argument marked as __nullable.
    > [0]: https://lore.kernel.org/bpf/ZrCZS6nisraEqehw@jlelli-thinkpadt14gen4.remote.csb
    > Reviewed-by: Jiri Olsa &lt;jolsa@kernel.org&gt;
    > Reported-by: Juri Lelli &lt;juri.lelli@redhat.com&gt;
    > Tested-by: Juri Lelli &lt;juri.lelli@redhat.com&gt;
    > Fixes: 3f00c5239344 (&quot;bpf: Allow trusted pointers to be passed to KF_TRUSTED_ARGS kfuncs&quot;)
    > Signed-off-by: Kumar Kartikeya Dwivedi &lt;memxor@gmail.com&gt;
    > Link: https://lore.kernel.org/r/20241104171959.2938862-2-memxor@gmail.com
    > Signed-off-by: Alexei Starovoitov &lt;ast@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ netfilter: nf_tables: avoid false-positive lockdep splat on rule deletion (@Florian Westphal in [30ebd4c17ac3049](https://github.com/sophgo/linux-riscv/commit/30ebd4c17ac3049) at 2024-12-05 13:01:52)
    > [ Upstream commit 9adbb4198bf6cf3634032871118a7052aeaa573f ]
    > On rule delete we get:
    > WARNING: suspicious RCU usage
    > net/netfilter/nf_tables_api.c:3420 RCU-list traversed in non-reader section!!
    > 1 lock held by iptables/134:
    > #0: ffff888008c4fcc8 (&amp;nft_net-&gt;commit_mutex){+.+.}-{3:3}, at: nf_tables_valid_genid (include/linux/jiffies.h:101) nf_tables
    > Code is fine, no other CPU can change the list because we&#x27;re holding
    > transaction mutex.
    > Pass the needed lockdep annotation to the iterator and fix
    > two comments for functions that are no longer restricted to rcu-only
    > context.
    > This is enough to resolve rule delete, but there are several other
    > missing annotations, added in followup-patches.
    > Fixes: 28875945ba98 (&quot;rcu: Add support for consolidated-RCU reader checking&quot;)
    > Reported-by: Matthieu Baerts &lt;matttbe@kernel.org&gt;
    > Tested-by: Matthieu Baerts &lt;matttbe@kernel.org&gt;
    > Closes: https://lore.kernel.org/netfilter-devel/da27f17f-3145-47af-ad0f-7fd2a823623e@kernel.org/
    > Signed-off-by: Florian Westphal &lt;fw@strlen.de&gt;
    > Signed-off-by: Pablo Neira Ayuso &lt;pablo@netfilter.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/vkms: Drop unnecessary call to drm_crtc_cleanup() (@José Expósito in [0ae2555a34679bc](https://github.com/sophgo/linux-riscv/commit/0ae2555a34679bc) at 2024-12-05 13:01:52)
    > [ Upstream commit 1d43dddd7c38ea1aa93f78f7ee10087afb0a561f ]
    > CRTC creation uses drmm_crtc_init_with_planes(), which automatically
    > handles cleanup. However, an unnecessary call to drm_crtc_cleanup() is
    > still present in the vkms_output_init() error path.
    > Fixes: 99cc528ebe92 (&quot;drm/vkms: Use drmm_crtc_init_with_planes()&quot;)
    > Signed-off-by: José Expósito &lt;jose.exposito89@gmail.com&gt;
    > Reviewed-by: Maíra Canal &lt;mcanal@igalia.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20241031183835.3633-1-jose.exposito89@gmail.com
    > Acked-by: Louis Chauvet &lt;louis.chauvet@bootlin.com&gt;
    > Signed-off-by: Louis Chauvet &lt;louis.chauvet@bootlin.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ bpf, bpftool: Fix incorrect disasm pc (@Leon Hwang in [caf27ed9ea739a0](https://github.com/sophgo/linux-riscv/commit/caf27ed9ea739a0) at 2024-12-05 13:01:51)
    > [ Upstream commit 4d99e509c161f8610de125202c648fa4acd00541 ]
    > This patch addresses the bpftool issue &quot;Wrong callq address displayed&quot;[0].
    > The issue stemmed from an incorrect program counter (PC) value used during
    > disassembly with LLVM or libbfd.
    > For LLVM: The PC argument must represent the actual address in the kernel
    > to compute the correct relative address.
    > For libbfd: The relative address can be adjusted by adding func_ksym within
    > the custom info-&gt;print_address_func to yield the correct address.
    > Links:
    > [0] https://github.com/libbpf/bpftool/issues/109
    > Changes:
    > v2 -&gt; v3:
    > Address comment from Quentin:
    > Remove the typedef.
    > v1 -&gt; v2:
    > Fix the broken libbfd disassembler.
    > Fixes: e1947c750ffe (&quot;bpftool: Refactor disassembler for JIT-ed programs&quot;)
    > Signed-off-by: Leon Hwang &lt;leon.hwang@linux.dev&gt;
    > Signed-off-by: Andrii Nakryiko &lt;andrii@kernel.org&gt;
    > Tested-by: Quentin Monnet &lt;qmo@kernel.org&gt;
    > Reviewed-by: Quentin Monnet &lt;qmo@kernel.org&gt;
    > Acked-by: Yonghong Song &lt;yonghong.song@linux.dev&gt;
    > Link: https://lore.kernel.org/bpf/20241031152844.68817-1-leon.hwang@linux.dev
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ bpf: Tighten tail call checks for lingering locks, RCU, preempt_disable (@Kumar Kartikeya Dwivedi in [aa51be3fa9e0982](https://github.com/sophgo/linux-riscv/commit/aa51be3fa9e0982) at 2024-12-05 13:01:51)
    > [ Upstream commit 46f7ed32f7a873d6675ea72e1d6317df41a55f81 ]
    > There are three situations when a program logically exits and transfers
    > control to the kernel or another program: bpf_throw, BPF_EXIT, and tail
    > calls. The former two check for any lingering locks and references, but
    > tail calls currently do not. Expand the checks to check for spin locks,
    > RCU read sections and preempt disabled sections.
    > Spin locks are indirectly preventing tail calls as function calls are
    > disallowed, but the checks for preemption and RCU are more relaxed,
    > hence ensure tail calls are prevented in their presence.
    > Fixes: 9bb00b2895cb (&quot;bpf: Add kfunc bpf_rcu_read_lock/unlock()&quot;)
    > Fixes: fc7566ad0a82 (&quot;bpf: Introduce bpf_preempt_[disable,enable] kfuncs&quot;)
    > Signed-off-by: Kumar Kartikeya Dwivedi &lt;memxor@gmail.com&gt;
    > Link: https://lore.kernel.org/r/20241103225940.1408302-2-memxor@gmail.com
    > Signed-off-by: Alexei Starovoitov &lt;ast@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm: xlnx: zynqmp_disp: layer may be null while releasing (@Steffen Dirkwinkel in [9218be402aeb199](https://github.com/sophgo/linux-riscv/commit/9218be402aeb199) at 2024-12-05 13:01:51)
    > [ Upstream commit 223842c7702b52846b1c5aef8aca7474ec1fd29b ]
    > layer-&gt;info can be null if we have an error on the first layer in
    > zynqmp_disp_create_layers
    > Fixes: 1836fd5ed98d (&quot;drm: xlnx: zynqmp_dpsub: Minimize usage of global flag&quot;)
    > Signed-off-by: Steffen Dirkwinkel &lt;s.dirkwinkel@beckhoff.com&gt;
    > Signed-off-by: Tomi Valkeinen &lt;tomi.valkeinen@ideasonboard.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20241028133941.54264-1-lists@steffen.cc
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ wifi: cw1200: Fix potential NULL dereference (@Linus Walleij in [67c914f2d64b284](https://github.com/sophgo/linux-riscv/commit/67c914f2d64b284) at 2024-12-05 13:01:51)
    > [ Upstream commit 2b94751626a6d49bbe42a19cc1503bd391016bd5 ]
    > A recent refactoring was identified by static analysis to
    > cause a potential NULL dereference, fix this!
    > Reported-by: kernel test robot &lt;lkp@intel.com&gt;
    > Reported-by: Dan Carpenter &lt;dan.carpenter@linaro.org&gt;
    > Closes: https://lore.kernel.org/r/202410121505.nyghqEkK-lkp@intel.com/
    > Fixes: 2719a9e7156c (&quot;wifi: cw1200: Convert to GPIO descriptors&quot;)
    > Signed-off-by: Linus Walleij &lt;linus.walleij@linaro.org&gt;
    > Signed-off-by: Kalle Valo &lt;kvalo@kernel.org&gt;
    > Link: https://patch.msgid.link/20241028-cw1200-fix-v1-1-e092b6558d1e@linaro.org
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ wifi: wfx: Fix error handling in wfx_core_init() (@Yuan Can in [214fc7bf37c5f4f](https://github.com/sophgo/linux-riscv/commit/214fc7bf37c5f4f) at 2024-12-05 13:01:51)
    > [ Upstream commit 3b88a9876779b55478a4dde867e73f7a100ffa23 ]
    > The wfx_core_init() returns without checking the retval from
    > sdio_register_driver().
    > If the sdio_register_driver() failed, the module failed to install,
    > leaving the wfx_spi_driver not unregistered.
    > Fixes: a7a91ca5a23d (&quot;staging: wfx: add infrastructure for new driver&quot;)
    > Signed-off-by: Yuan Can &lt;yuancan@huawei.com&gt;
    > Reviewed-by: Jérôme Pouiller &lt;jerome.pouiller@silabs.com&gt;
    > Signed-off-by: Kalle Valo &lt;kvalo@kernel.org&gt;
    > Link: https://patch.msgid.link/20241022090453.84679-1-yuancan@huawei.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/msm/dpu: cast crtc_clk calculation to u64 in _dpu_core_perf_calc_clk() (@Zichen Xie in [1b278db3884ce39](https://github.com/sophgo/linux-riscv/commit/1b278db3884ce39) at 2024-12-05 13:01:51)
    > [ Upstream commit 20c7b42d9dbd048019bfe0af39229e3014007a98 ]
    > There may be a potential integer overflow issue in
    > _dpu_core_perf_calc_clk(). crtc_clk is defined as u64, while
    > mode-&gt;vtotal, mode-&gt;hdisplay, and drm_mode_vrefresh(mode) are defined as
    > a smaller data type. The result of the calculation will be limited to
    > &quot;int&quot; in this case without correct casting. In screen with high
    > resolution and high refresh rate, integer overflow may happen.
    > So, we recommend adding an extra cast to prevent potential
    > integer overflow.
    > Fixes: c33b7c0389e1 (&quot;drm/msm/dpu: add support for clk and bw scaling for display&quot;)
    > Signed-off-by: Zichen Xie &lt;zichenxie0106@gmail.com&gt;
    > Reviewed-by: Abhinav Kumar &lt;quic_abhinavk@quicinc.com&gt;
    > Patchwork: https://patchwork.freedesktop.org/patch/622206/
    > Link: https://lore.kernel.org/r/20241029194209.23684-1-zichenxie0106@gmail.com
    > Signed-off-by: Dmitry Baryshkov &lt;dmitry.baryshkov@linaro.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/etnaviv: Request pages from DMA32 zone on addressing_limited (@Xiaolei Wang in [b18d12a05f6bea9](https://github.com/sophgo/linux-riscv/commit/b18d12a05f6bea9) at 2024-12-05 13:01:50)
    > [ Upstream commit 13c96ac9a3f0f1c7ba1ff0656ea508e7fa065e7e ]
    > Remove __GFP_HIGHMEM when requesting a page from DMA32 zone,
    > and since all vivante GPUs in the system will share the same
    > DMA constraints, move the check of whether to get a page from
    > DMA32 to etnaviv_bind().
    > Fixes: b72af445cd38 (&quot;drm/etnaviv: request pages from DMA32 zone when needed&quot;)
    > Suggested-by: Sui Jingfeng &lt;sui.jingfeng@linux.dev&gt;
    > Signed-off-by: Xiaolei Wang &lt;xiaolei.wang@windriver.com&gt;
    > Reviewed-by: Christian Gmeiner &lt;cgmeiner@igalia.com&gt;
    > Signed-off-by: Lucas Stach &lt;l.stach@pengutronix.de&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm: zynqmp_kms: Unplug DRM device before removal (@Sean Anderson in [692f52aedccbf79](https://github.com/sophgo/linux-riscv/commit/692f52aedccbf79) at 2024-12-05 13:01:50)
    > [ Upstream commit 2e07c88914fc5289c21820b1aa94f058feb38197 ]
    > Prevent userspace accesses to the DRM device from causing
    > use-after-frees by unplugging the device before we remove it. This
    > causes any further userspace accesses to result in an error without
    > further calls into this driver&#x27;s internals.
    > Fixes: d76271d22694 (&quot;drm: xlnx: DRM/KMS driver for Xilinx ZynqMP DisplayPort Subsystem&quot;)
    > Closes: https://lore.kernel.org/dri-devel/4d8f4c9b-2efb-4774-9a37-2f257f79b2c9@linux.dev/
    > Signed-off-by: Sean Anderson &lt;sean.anderson@linux.dev&gt;
    > Signed-off-by: Tomi Valkeinen &lt;tomi.valkeinen@ideasonboard.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20240809193600.3360015-2-sean.anderson@linux.dev
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/etnaviv: hold GPU lock across perfmon sampling (@Lucas Stach in [581e5313b6d8473](https://github.com/sophgo/linux-riscv/commit/581e5313b6d8473) at 2024-12-05 13:01:50)
    > [ Upstream commit 37dc4737447a7667f8e9ec790dac251da057eb27 ]
    > The perfmon sampling mutates shared GPU state (e.g. VIVS_HI_CLOCK_CONTROL
    > to select the pipe for the perf counter reads). To avoid clashing with
    > other functions mutating the same state (e.g. etnaviv_gpu_update_clock)
    > the perfmon sampling needs to hold the GPU lock.
    > Fixes: 68dc0b295dcb (&quot;drm/etnaviv: use &#x27;sync points&#x27; for performance monitor requests&quot;)
    > Reviewed-by: Christian Gmeiner &lt;cgmeiner@igalia.com&gt;
    > Signed-off-by: Lucas Stach &lt;l.stach@pengutronix.de&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/xe/hdcp: Fix gsc structure check in fw check status (@Suraj Kandpal in [2dd496f6ed3c07b](https://github.com/sophgo/linux-riscv/commit/2dd496f6ed3c07b) at 2024-12-05 13:01:50)
    > [ Upstream commit 182a32bcc223203c57761889fac7fa2dbb34684b ]
    > Fix the condition for gsc structure validity in
    > gsc_cs_status_check(). It needs to be an OR and not an AND
    > condition
    > Fixes: b4224f6bae38 (&quot;drm/xe/hdcp: Check GSC structure validity&quot;)
    > Signed-off-by: Suraj Kandpal &lt;suraj.kandpal@intel.com&gt;
    > Reviewed-by: Matt Roper &lt;matthew.d.roper@intel.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20241025160834.8785-1-suraj.kandpal@intel.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/nouveau/gr/gf100: Fix missing unlock in gf100_gr_chan_new() (@Li Huafei in [24b1df744ef444f](https://github.com/sophgo/linux-riscv/commit/24b1df744ef444f) at 2024-12-05 13:01:50)
    > [ Upstream commit a2f599046c671d6b46d93aed95b37241ce4504cf ]
    > When the call to gf100_grctx_generate() fails, unlock gr-&gt;fecs.mutex
    > before returning the error.
    > Fixes smatch warning:
    > drivers/gpu/drm/nouveau/nvkm/engine/gr/gf100.c:480 gf100_gr_chan_new() warn: inconsistent returns &#x27;&amp;gr-&gt;fecs.mutex&#x27;.
    > Fixes: ca081fff6ecc (&quot;drm/nouveau/gr/gf100-: generate golden context during first object alloc&quot;)
    > Signed-off-by: Li Huafei &lt;lihuafei1@huawei.com&gt;
    > Reviewed-by: Lyude Paul &lt;lyude@redhat.com&gt;
    > Signed-off-by: Lyude Paul &lt;lyude@redhat.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20241026173844.2392679-1-lihuafei1@huawei.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/amd/display: Increase idle worker HPD detection time (@Roman Li in [0f8d9ba3754c21b](https://github.com/sophgo/linux-riscv/commit/0f8d9ba3754c21b) at 2024-12-05 13:01:50)
    > [ Upstream commit 60612f75992d96955fb7154468c58d5d168cf1ab ]
    > [Why]
    > Idle worker thread waits HPD_DETECTION_TIME for HPD processing complete.
    > Some displays require longer time for that.
    > [How]
    > Increase HPD_DETECTION_TIME to 100ms.
    > Reviewed-by: Sun peng Li &lt;sunpeng.li@amd.com&gt;
    > Signed-off-by: Roman Li &lt;Roman.Li@amd.com&gt;
    > Tested-by: Daniel Wheeler &lt;daniel.wheeler@amd.com&gt;
    > Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Stable-dep-of: a88b19b13fb4 (&quot;drm/amd/display: Reduce HPD Detection Interval for IPS&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/amd/display: Reduce HPD Detection Interval for IPS (@Fangzhi Zuo in [047e2eb614cd9ca](https://github.com/sophgo/linux-riscv/commit/047e2eb614cd9ca) at 2024-12-05 13:01:50)
    > [ Upstream commit a88b19b13fb41a3fa03ec67b5f57cc267fbfb160 ]
    > Fix DP Compliance test 4.2.1.3, 4.2.2.8, 4.3.1.12, 4.3.1.13
    > when IPS enabled.
    > Original HPD detection interval is set to 5s which violates DP
    > compliance.
    > Reduce the interval parameter, such that link training can be
    > finished within 5 seconds.
    > Fixes: afca033f10d3 (&quot;drm/amd/display: Add periodic detection for IPS&quot;)
    > Reviewed-by: Roman Li &lt;roman.li@amd.com&gt;
    > Signed-off-by: Fangzhi Zuo &lt;Jerry.Zuo@amd.com&gt;
    > Signed-off-by: Tom Chung &lt;chiahsuan.chung@amd.com&gt;
    > Tested-by: Daniel Wheeler &lt;daniel.wheeler@amd.com&gt;
    > Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/msm/gpu: Check the status of registration to PM QoS (@Lukasz Luba in [cdf517cf86ed6d0](https://github.com/sophgo/linux-riscv/commit/cdf517cf86ed6d0) at 2024-12-05 13:01:49)
    > [ Upstream commit 8f32ddd87e499ba6d2dc74ce30b6932baf1e1fc3 ]
    > There is a need to check the returned value of the registration function.
    > In case of returned error, print that and stop the init process.
    > Fixes: 7c0ffcd40b16 (&quot;drm/msm/gpu: Respect PM QoS constraints&quot;)
    > Signed-off-by: Lukasz Luba &lt;lukasz.luba@arm.com&gt;
    > Patchwork: https://patchwork.freedesktop.org/patch/620336/
    > Signed-off-by: Rob Clark &lt;robdclark@chromium.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ wifi: rtw89: Fix TX fail with A2DP after scanning (@Po-Hao Huang in [b229a6d87a65d46](https://github.com/sophgo/linux-riscv/commit/b229a6d87a65d46) at 2024-12-05 13:01:49)
    > [ Upstream commit f16c40acd31901ad0ba2554b60e0e2b0c7b59cde ]
    > There might be some racing between BT and WiFi after scan. Since
    > one of the TX related register will be modified by both FW and
    > rtw89_set_channel() in driver, which could cause Tx fail. Reorder
    > the calling sequence to only notify coexistence mechanism after
    > rtw89_set_channel() is called, so that there are no concurrent
    > operations.
    > Fixes: 5f499ce69b8d (&quot;wifi: rtw89: pause/proceed MCC for ROC and HW scan&quot;)
    > Signed-off-by: Po-Hao Huang &lt;phhuang@realtek.com&gt;
    > Signed-off-by: Ping-Ke Shih &lt;pkshih@realtek.com&gt;
    > Link: https://patch.msgid.link/20241021063219.22613-1-pkshih@realtek.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/panfrost: Remove unused id_mask from struct panfrost_model (@Steven Price in [8361609dda6ff33](https://github.com/sophgo/linux-riscv/commit/8361609dda6ff33) at 2024-12-05 13:01:49)
    > [ Upstream commit 581d1f8248550f2b67847e6d84f29fbe3751ea0a ]
    > The id_mask field of struct panfrost_model has never been used.
    > Fixes: f3ba91228e8e (&quot;drm/panfrost: Add initial panfrost driver&quot;)
    > Signed-off-by: Steven Price &lt;steven.price@arm.com&gt;
    > Reviewed-by: Boris Brezillon &lt;boris.brezillon@collabora.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20241025140008.385081-1-steven.price@arm.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ wifi: rtw89: unlock on error path in rtw89_ops_unassign_vif_chanctx() (@Dan Carpenter in [4f5dea02e8fb10c](https://github.com/sophgo/linux-riscv/commit/4f5dea02e8fb10c) at 2024-12-05 13:01:49)
    > [ Upstream commit ac4f4e5a203927e555107db6e781e85f241720e1 ]
    > We need to call mutex_unlock() on this error path.
    > Fixes: aad0394e7a02 (&quot;wifi: rtw89: tweak driver architecture for impending MLO support&quot;)
    > Signed-off-by: Dan Carpenter &lt;dan.carpenter@linaro.org&gt;
    > Reviewed-by: Zong-Zhe Yang &lt;kevin_yang@realtek.com&gt;
    > Signed-off-by: Ping-Ke Shih &lt;pkshih@realtek.com&gt;
    > Link: https://patch.msgid.link/8683a712-ffc2-466b-8382-0b264719f8ef@stanley.mountain
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ bpf, arm64: Remove garbage frame for struct_ops trampoline (@Xu Kuohai in [4d8621151bb3bbd](https://github.com/sophgo/linux-riscv/commit/4d8621151bb3bbd) at 2024-12-05 13:01:49)
    > [ Upstream commit 87cb58aebdf7005661a07e9fd5a900f924d48c75 ]
    > The callsite layout for arm64 fentry is:
    > mov x9, lr
    > nop
    > When a bpf prog is attached, the nop instruction is patched to a call
    > to bpf trampoline:
    > mov x9, lr
    > bl &lt;bpf trampoline&gt;
    > So two return addresses are passed to bpf trampoline: the return address
    > for the traced function/prog, stored in x9, and the return address for
    > the bpf trampoline itself, stored in lr. To obtain a full and accurate
    > call stack, the bpf trampoline constructs two fake function frames using
    > x9 and lr.
    > However, struct_ops progs are invoked directly as function callbacks,
    > meaning that x9 is not set as it is in the fentry callsite. In this case,
    > the frame constructed using x9 is garbage. The following stack trace for
    > struct_ops, captured by perf sampling, illustrates this issue, where
    > tcp_ack+0x404 is a garbage frame:
    > ffffffc0801a04b4 bpf_prog_50992e55a0f655a9_bpf_cubic_cong_avoid+0x98 (bpf_prog_50992e55a0f655a9_bpf_cubic_cong_avoid)
    > ffffffc0801a228c [unknown] ([kernel.kallsyms]) // bpf trampoline
    > ffffffd08d362590 tcp_ack+0x798 ([kernel.kallsyms]) // caller for bpf trampoline
    > ffffffd08d3621fc tcp_ack+0x404 ([kernel.kallsyms]) // garbage frame
    > ffffffd08d36452c tcp_rcv_established+0x4ac ([kernel.kallsyms])
    > ffffffd08d375c58 tcp_v4_do_rcv+0x1f0 ([kernel.kallsyms])
    > ffffffd08d378630 tcp_v4_rcv+0xeb8 ([kernel.kallsyms])
    > To fix it, construct only one frame using lr for struct_ops.
    > The above stack trace also indicates that there is no kernel symbol for
    > struct_ops bpf trampoline. This will be addressed in a follow-up patch.
    > Fixes: efc9909fdce0 (&quot;bpf, arm64: Add bpf trampoline for arm64&quot;)
    > Signed-off-by: Xu Kuohai &lt;xukuohai@huawei.com&gt;
    > Acked-by: Puranjay Mohan &lt;puranjay@kernel.org&gt;
    > Tested-by: Puranjay Mohan &lt;puranjay@kernel.org&gt;
    > Link: https://lore.kernel.org/r/20241025085220.533949-1-xukuohai@huaweicloud.com
    > Signed-off-by: Alexei Starovoitov &lt;ast@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/msm/adreno: Use IRQF_NO_AUTOEN flag in request_irq() (@Jinjie Ruan in [3b98bad37ae882b](https://github.com/sophgo/linux-riscv/commit/3b98bad37ae882b) at 2024-12-05 13:01:49)
    > [ Upstream commit 394679f322649d06fea3c646ba65f5a0887f52c3 ]
    > disable_irq() after request_irq() still has a time gap in which
    > interrupts can come. request_irq() with IRQF_NO_AUTOEN flag will
    > disable IRQ auto-enable when request IRQ.
    > Fixes: 4b565ca5a2cb (&quot;drm/msm: Add A6XX device support&quot;)
    > Reviewed-by: Dmitry Baryshkov &lt;dmitry.baryshkov@linaro.org&gt;
    > Signed-off-by: Jinjie Ruan &lt;ruanjinjie@huawei.com&gt;
    > Patchwork: https://patchwork.freedesktop.org/patch/614075/
    > Signed-off-by: Rob Clark &lt;robdclark@chromium.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ wifi: rtw89: read bss_conf corresponding to the link (@Zong-Zhe Yang in [ce9107560efdb3d](https://github.com/sophgo/linux-riscv/commit/ce9107560efdb3d) at 2024-12-05 13:01:48)
    > [ Upstream commit 89bac818bbd2ccced29d4b888ba1a4cf3e1ede4e ]
    > Tweak code to not always access vif-&gt;bss_conf directly. Instead,
    > according to link_id, read target bss_conf from vif-&gt;link_conf[].
    > For now, rtwvif_link-&gt;link_id keeps 0. When driver starts to
    > support MLO, the link_id will be assigned.
    > Signed-off-by: Zong-Zhe Yang &lt;kevin_yang@realtek.com&gt;
    > Signed-off-by: Ping-Ke Shih &lt;pkshih@realtek.com&gt;
    > Link: https://patch.msgid.link/20240916053158.47350-4-pkshih@realtek.com
    > Stable-dep-of: f16c40acd319 (&quot;wifi: rtw89: Fix TX fail with A2DP after scanning&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ wifi: rtw89: rename rtw89_sta to rtw89_sta_link ahead for MLO (@Zong-Zhe Yang in [c798a038be1f14c](https://github.com/sophgo/linux-riscv/commit/c798a038be1f14c) at 2024-12-05 13:01:48)
    > [ Upstream commit 9ee282193440527a20c9b40d47db8abaa73ecd49 ]
    > This is an intermediate version that is separated from subsequent major
    > MLO changes, so some functions&#x27; namings are not really determined here.
    > e.g. struct rtw89_sta_link *sta_to_rtwsta_safe(struct ieee80211_sta *sta)
    > No logic is changed.
    > Signed-off-by: Zong-Zhe Yang &lt;kevin_yang@realtek.com&gt;
    > Signed-off-by: Ping-Ke Shih &lt;pkshih@realtek.com&gt;
    > Link: https://patch.msgid.link/20240916053158.47350-3-pkshih@realtek.com
    > Stable-dep-of: f16c40acd319 (&quot;wifi: rtw89: Fix TX fail with A2DP after scanning&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ wifi: rtw89: read link_sta corresponding to the link (@Zong-Zhe Yang in [c2f46b65f30157b](https://github.com/sophgo/linux-riscv/commit/c2f46b65f30157b) at 2024-12-05 13:01:48)
    > [ Upstream commit 04911c0fe874bb44e8ee0f5896a5a10c37a14cf2 ]
    > Tweak code to not always access sta-&gt;deflink directly. Instead,
    > according to link_id, read target link_sta from sta-&gt;link[].
    > For now, rtwsta_link-&gt;link_id keeps 0. When driver starts to
    > support MLO, the link_id will be assigned.
    > Signed-off-by: Zong-Zhe Yang &lt;kevin_yang@realtek.com&gt;
    > Signed-off-by: Ping-Ke Shih &lt;pkshih@realtek.com&gt;
    > Link: https://patch.msgid.link/20240916053158.47350-5-pkshih@realtek.com
    > Stable-dep-of: f16c40acd319 (&quot;wifi: rtw89: Fix TX fail with A2DP after scanning&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ wifi: rtw89: refactor VIF related func ahead for MLO (@Zong-Zhe Yang in [58fa793363b6ebc](https://github.com/sophgo/linux-riscv/commit/58fa793363b6ebc) at 2024-12-05 13:01:48)
    > [ Upstream commit 26d460e13f84426fa7dd2c0c369676034c206161 ]
    > Refactor VIF related functions, e.g. add/remove/assoc/mapping
    > to separate most link stuffs into sub-functions for MLO reuse.
    > Signed-off-by: Zong-Zhe Yang &lt;kevin_yang@realtek.com&gt;
    > Signed-off-by: Ping-Ke Shih &lt;pkshih@realtek.com&gt;
    > Link: https://patch.msgid.link/20240916053158.47350-6-pkshih@realtek.com
    > Stable-dep-of: f16c40acd319 (&quot;wifi: rtw89: Fix TX fail with A2DP after scanning&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ wifi: rtw89: refactor STA related func ahead for MLO (@Zong-Zhe Yang in [556a34a660684d6](https://github.com/sophgo/linux-riscv/commit/556a34a660684d6) at 2024-12-05 13:01:48)
    > [ Upstream commit 72e9457c1954dc39a7059bd6d6346b60a24aa55e ]
    > Refactor STA related functions, e.g. add/assoc/disassoc/disconnect/remove
    > to separate most link stuffs into sub-functions for MLO reuse.
    > Signed-off-by: Zong-Zhe Yang &lt;kevin_yang@realtek.com&gt;
    > Signed-off-by: Ping-Ke Shih &lt;pkshih@realtek.com&gt;
    > Link: https://patch.msgid.link/20240916053158.47350-7-pkshih@realtek.com
    > Stable-dep-of: f16c40acd319 (&quot;wifi: rtw89: Fix TX fail with A2DP after scanning&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ wifi: rtw89: tweak driver architecture for impending MLO support (@Zong-Zhe Yang in [1e32011108aa707](https://github.com/sophgo/linux-riscv/commit/1e32011108aa707) at 2024-12-05 13:01:48)
    > [ Upstream commit aad0394e7a02fe933159be79d9d4595d2ad089dd ]
    > The drv_priv hooked to mac80211 become as below.
    > (drv_priv)             (instance-0)
    > +---------------+       +-----------+          +----------------+
    > | ieee80211_vif | &lt;---&gt; | rtw89_vif | -------&gt; | rtw89_vif_link |
    > +---------------+       +-----------+    |     +----------------+
    > |
    > |       (instance-1)
    > |     +----------------+
    > +---&gt; | rtw89_vif_link |
    > +----------------+
    > (drv_priv)             (instance-0)
    > +---------------+       +-----------+          +----------------+
    > | ieee80211_sta | &lt;---&gt; | rtw89_sta | -------&gt; | rtw89_sta_link |
    > +---------------+       +-----------+    |     +----------------+
    > |
    > |       (instance-1)
    > |     +----------------+
    > +---&gt; | rtw89_sta_link |
    > +----------------+
    > The relation bewteen mac80211 link_id and our link instance is like below.
    > |\
    > (link_id)       | \
    > 0  -------- |  |
    > 1  -------- |  | ------ instance-0 (link_id: X) -&gt; work on HW band 0
    > 2  -------- |  |
    > ...         |  | ------ instance-1 (link_id: Y) -&gt; work on HW band 1
    > 14 -------- |  |
    > | /
    > |/
    > N.B. For cases of non-MLD connection, we set our link instance-0
    > active with link_id 0. So, our code flow can be compatible between
    > non-MLD connection and MLD connection.
    > Based on above, we tweak entire driver architecture first. But, we don&#x27;t
    > dynamically enable multiple links here. That will be handled separately.
    > Most of the things changed here are changing flows to iterate all active
    > links and read bss_conf/link_sta data according to target link. And, for
    > cases of scan, ROC, WOW, we use instance-0 to deal with the request.
    > There are some things listed below, which work for now but need to extend
    > before multiple active links.
    > 1. tx path
    > select suitable link instance among multiple active links
    > 2. rx path
    > determine rx link by PPDU instead of always link instance-0
    > 3. CAM
    > apply MLD pairwise key to any active links dynamically
    > Besides, PS code cannot easily work along with tweaking architecture. With
    > supporting MLO flag (currently false), we disable PS first and will fix it
    > by another commit in the following.
    > Signed-off-by: Zong-Zhe Yang &lt;kevin_yang@realtek.com&gt;
    > Signed-off-by: Ping-Ke Shih &lt;pkshih@realtek.com&gt;
    > Link: https://patch.msgid.link/20240916053158.47350-8-pkshih@realtek.com
    > Stable-dep-of: f16c40acd319 (&quot;wifi: rtw89: Fix TX fail with A2DP after scanning&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ octeontx2-pf: handle otx2_mbox_get_rsp errors in otx2_dmac_flt.c (@Dipendra Khadka in [fc595472fbad965](https://github.com/sophgo/linux-riscv/commit/fc595472fbad965) at 2024-12-05 13:01:47)
    > [ Upstream commit f5b942e6c54b13246ee49d42dcfb71b7f29e3c64 ]
    > Add error pointer checks after calling otx2_mbox_get_rsp().
    > Fixes: 79d2be385e9e (&quot;octeontx2-pf: offload DMAC filters to CGX/RPM block&quot;)
    > Fixes: fa5e0ccb8f3a (&quot;octeontx2-pf: Add support for exact match table.&quot;)
    > Signed-off-by: Dipendra Khadka &lt;kdipendra88@gmail.com&gt;
    > Reviewed-by: Simon Horman &lt;horms@kernel.org&gt;
    > Signed-off-by: Andrew Lunn &lt;andrew@lunn.ch&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ libbpf: move global data mmap()&#x27;ing into bpf_object__load() (@Andrii Nakryiko in [957647353ee248c](https://github.com/sophgo/linux-riscv/commit/957647353ee248c) at 2024-12-05 13:01:47)
    > [ Upstream commit 137978f422516a128326df55c0ba23605f925e21 ]
    > Since BPF skeleton inception libbpf has been doing mmap()&#x27;ing of global
    > data ARRAY maps in bpf_object__load_skeleton() API, which is used by
    > code generated .skel.h files (i.e., by BPF skeletons only).
    > This is wrong because if BPF object is loaded through generic
    > bpf_object__load() API, global data maps won&#x27;t be re-mmap()&#x27;ed after
    > load step, and memory pointers returned from bpf_map__initial_value()
    > would be wrong and won&#x27;t reflect the actual memory shared between BPF
    > program and user space.
    > bpf_map__initial_value() return result is rarely used after load, so
    > this went unnoticed for a really long time, until bpftrace project
    > attempted to load BPF object through generic bpf_object__load() API and
    > then used BPF subskeleton instantiated from such bpf_object. It turned
    > out that .data/.rodata/.bss data updates through such subskeleton was
    > &quot;blackholed&quot;, all because libbpf wouldn&#x27;t re-mmap() those maps during
    > bpf_object__load() phase.
    > Long story short, this step should be done by libbpf regardless of BPF
    > skeleton usage, right after BPF map is created in the kernel. This patch
    > moves this functionality into bpf_object__populate_internal_map() to
    > achieve this. And bpf_object__load_skeleton() is now simple and almost
    > trivial, only propagating these mmap()&#x27;ed pointers into user-supplied
    > skeleton structs.
    > We also do trivial adjustments to error reporting inside
    > bpf_object__populate_internal_map() for consistency with the rest of
    > libbpf&#x27;s map-handling code.
    > Reported-by: Alastair Robertson &lt;ajor@meta.com&gt;
    > Reported-by: Jonathan Wiepert &lt;jwiepert@meta.com&gt;
    > Fixes: d66562fba1ce (&quot;libbpf: Add BPF object skeleton support&quot;)
    > Signed-off-by: Andrii Nakryiko &lt;andrii@kernel.org&gt;
    > Link: https://lore.kernel.org/r/20241023043908.3834423-3-andrii@kernel.org
    > Signed-off-by: Alexei Starovoitov &lt;ast@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ octeontx2-pf: handle otx2_mbox_get_rsp errors in otx2_dcbnl.c (@Dipendra Khadka in [6ee6cf42dc52304](https://github.com/sophgo/linux-riscv/commit/6ee6cf42dc52304) at 2024-12-05 13:01:47)
    > [ Upstream commit 69297b0d3369488af259e3a7cf53d69157938ea1 ]
    > Add error pointer check after calling otx2_mbox_get_rsp().
    > Fixes: 8e67558177f8 (&quot;octeontx2-pf: PFC config support with DCBx&quot;)
    > Signed-off-by: Dipendra Khadka &lt;kdipendra88@gmail.com&gt;
    > Reviewed-by: Simon Horman &lt;horms@kernel.org&gt;
    > Signed-off-by: Andrew Lunn &lt;andrew@lunn.ch&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ octeontx2-pf: handle otx2_mbox_get_rsp errors in cn10k.c (@Dipendra Khadka in [54abcec092616a4](https://github.com/sophgo/linux-riscv/commit/54abcec092616a4) at 2024-12-05 13:01:47)
    > [ Upstream commit ac9183023b6a9c09467516abd8aab04f9a2f9564 ]
    > Add error pointer check after calling otx2_mbox_get_rsp().
    > Fixes: 2ca89a2c3752 (&quot;octeontx2-pf: TC_MATCHALL ingress ratelimiting offload&quot;)
    > Signed-off-by: Dipendra Khadka &lt;kdipendra88@gmail.com&gt;
    > Reviewed-by: Simon Horman &lt;horms@kernel.org&gt;
    > Signed-off-by: Andrew Lunn &lt;andrew@lunn.ch&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ wifi: rtw89: rename rtw89_vif to rtw89_vif_link ahead for MLO (@Zong-Zhe Yang in [4a888e3132e5dbc](https://github.com/sophgo/linux-riscv/commit/4a888e3132e5dbc) at 2024-12-05 13:01:47)
    > [ Upstream commit 2f7dae17c48cd1d5616f11d22b3de675db7ab40d ]
    > This is an intermediate version that is separated from subsequent major
    > MLO changes, so some functions&#x27; namings are not really determined here.
    > e.g. struct rtw89_vif_link *vif_to_rtwvif_safe(struct ieee80211_vif *vif)
    > No logic is changed.
    > Signed-off-by: Zong-Zhe Yang &lt;kevin_yang@realtek.com&gt;
    > Signed-off-by: Ping-Ke Shih &lt;pkshih@realtek.com&gt;
    > Link: https://patch.msgid.link/20240916053158.47350-2-pkshih@realtek.com
    > Stable-dep-of: f16c40acd319 (&quot;wifi: rtw89: Fix TX fail with A2DP after scanning&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ selftests/bpf: fix test_spin_lock_fail.c&#x27;s global vars usage (@Andrii Nakryiko in [25a589cfc9421c6](https://github.com/sophgo/linux-riscv/commit/25a589cfc9421c6) at 2024-12-05 13:01:47)
    > [ Upstream commit 1b2bfc29695d273492c3dd8512775261f3272686 ]
    > Global variables of special types (like &#x60;struct bpf_spin_lock&#x60;) make
    > underlying ARRAY maps non-mmapable. To make this work with libbpf&#x27;s
    > mmaping logic, application is expected to declare such special variables
    > as static, so libbpf doesn&#x27;t even attempt to mmap() such ARRAYs.
    > test_spin_lock_fail.c didn&#x27;t follow this rule, but given it relied on
    > this test to trigger failures, this went unnoticed, as we never got to
    > the step of mmap()&#x27;ing these ARRAY maps.
    > It is fragile and relies on specific sequence of libbpf steps, which are
    > an internal implementation details.
    > Fix the test by marking lockA and lockB as static.
    > Fixes: c48748aea4f8 (&quot;selftests/bpf: Add failure test cases for spin lock pairing&quot;)
    > Signed-off-by: Andrii Nakryiko &lt;andrii@kernel.org&gt;
    > Link: https://lore.kernel.org/r/20241023043908.3834423-2-andrii@kernel.org
    > Signed-off-by: Alexei Starovoitov &lt;ast@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ octeontx2-pf: handle otx2_mbox_get_rsp errors in otx2_flows.c (@Dipendra Khadka in [e5e60f17d2462ef](https://github.com/sophgo/linux-riscv/commit/e5e60f17d2462ef) at 2024-12-05 13:01:46)
    > [ Upstream commit bd3110bc102ab6292656b8118be819faa0de8dd0 ]
    > Adding error pointer check after calling otx2_mbox_get_rsp().
    > Fixes: 9917060fc30a (&quot;octeontx2-pf: Cleanup flow rule management&quot;)
    > Fixes: f0a1913f8a6f (&quot;octeontx2-pf: Add support for ethtool ntuple filters&quot;)
    > Fixes: 674b3e164238 (&quot;octeontx2-pf: Add additional checks while configuring ucast/bcast/mcast rules&quot;)
    > Signed-off-by: Dipendra Khadka &lt;kdipendra88@gmail.com&gt;
    > Reviewed-by: Simon Horman &lt;horms@kernel.org&gt;
    > Signed-off-by: Andrew Lunn &lt;andrew@lunn.ch&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ octeontx2-pf: handle otx2_mbox_get_rsp errors in otx2_common.c (@Dipendra Khadka in [d4d5139d280f583](https://github.com/sophgo/linux-riscv/commit/d4d5139d280f583) at 2024-12-05 13:01:46)
    > [ Upstream commit 0fbc7a5027c6f7f2c785adae3dcec22b2f2b69b3 ]
    > Add error pointer check after calling otx2_mbox_get_rsp().
    > Fixes: ab58a416c93f (&quot;octeontx2-pf: cn10k: Get max mtu supported from admin function&quot;)
    > Signed-off-by: Dipendra Khadka &lt;kdipendra88@gmail.com&gt;
    > Reviewed-by: Simon Horman &lt;horms@kernel.org&gt;
    > Signed-off-by: Andrew Lunn &lt;andrew@lunn.ch&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/msm/dpu: on SDM845 move DSPP_3 to LM_5 block (@Dmitry Baryshkov in [bce5003d0b1a235](https://github.com/sophgo/linux-riscv/commit/bce5003d0b1a235) at 2024-12-05 13:01:46)
    > [ Upstream commit 768a272d5357269b17b4b06dd8647e21bdc0ca3c ]
    > On the SDM845 platform the DSPP_3 is used by the LM_5. Correct
    > corresponding entries in the sdm845_lm array.
    > Fixes: c72375172194 (&quot;drm/msm/dpu/catalog: define DSPP blocks found on sdm845&quot;)
    > Signed-off-by: Dmitry Baryshkov &lt;dmitry.baryshkov@linaro.org&gt;
    > Reviewed-by: Abhinav Kumar &lt;quic_abhinavk@quicinc.com&gt;
    > Patchwork: https://patchwork.freedesktop.org/patch/612584/
    > Link: https://lore.kernel.org/r/20240905-dpu-fix-sdm845-catalog-v1-1-3363d03998bd@linaro.org
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/msm/dpu: drop LM_3 / LM_4 on SDM845 (@Dmitry Baryshkov in [acc0c699fc95887](https://github.com/sophgo/linux-riscv/commit/acc0c699fc95887) at 2024-12-05 13:01:46)
    > [ Upstream commit d39271061d67c6fcbe8f361c532b493069232cf8 ]
    > On the SDM845 platform ther are no LM_3 and LM_4 blocks. Drop them from
    > the SDM845 catalog.
    > Fixes: 25fdd5933e4c (&quot;drm/msm: Add SDM845 DPU support&quot;)
    > Signed-off-by: Dmitry Baryshkov &lt;dmitry.baryshkov@linaro.org&gt;
    > Reviewed-by: Abhinav Kumar &lt;quic_abhinavk@quicinc.com&gt;
    > Patchwork: https://patchwork.freedesktop.org/patch/612586/
    > Link: https://lore.kernel.org/r/20240905-dpu-fix-sdm845-catalog-v1-2-3363d03998bd@linaro.org
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm: panel: nv3052c: correct spi_device_id for RG35XX panel (@Ryan Walklin in [ac32ee9f1cd3ce7](https://github.com/sophgo/linux-riscv/commit/ac32ee9f1cd3ce7) at 2024-12-05 13:01:46)
    > [ Upstream commit 45608a3eb4902f32010a8328c0a01ccda4b38c9b ]
    > The Anbernic RG35XX devices use an SPI LCD panel from an unknown OEM,
    > with an NV3052C driver chip.
    > As discussed previously, the integrating vendor and device name are
    > preferred instead of the OEM serial. A previous patch corrected the
    > device tree binding and of_device_id in the NV3052C driver, however the
    > spi_device_id also needs correction.
    > Correct the spi_device_id for the RG35XX panel.
    > Signed-off-by: Ryan Walklin &lt;ryan@testtoast.com&gt;
    > Fixes: 76dce2a96c0f (&quot;drm: panel: nv3052c: Correct WL-355608-A8 panel compatible&quot;)
    > Reviewed-by: Neil Armstrong &lt;neil.armstrong@linaro.org&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20241020083836.175733-1-ryan@testtoast.com
    > [DB: corrected the Fixes tag]
    > Signed-off-by: Dmitry Baryshkov &lt;dmitry.baryshkov@linaro.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/msm/dpu: drop LM_3 / LM_4 on MSM8998 (@Dmitry Baryshkov in [a4e15dd9aae606b](https://github.com/sophgo/linux-riscv/commit/a4e15dd9aae606b) at 2024-12-05 13:01:46)
    > [ Upstream commit c59afe50773d5c972f6684f9bbd9a2ddb2fb92fa ]
    > On the MSM8998 platform ther are no LM_3 and LM_4 blocks. Drop them from
    > the MSM8998 catalog.
    > Fixes: 94391a14fc27 (&quot;drm/msm/dpu1: Add MSM8998 to hw catalog&quot;)
    > Reported-by: Abhinav Kumar &lt;quic_abhinavk@quicinc.com&gt;
    > Signed-off-by: Dmitry Baryshkov &lt;dmitry.baryshkov@linaro.org&gt;
    > Reviewed-by: Abhinav Kumar &lt;quic_abhinavk@quicinc.com&gt;
    > Patchwork: https://patchwork.freedesktop.org/patch/612585/
    > Link: https://lore.kernel.org/r/20240905-dpu-fix-sdm845-catalog-v1-3-3363d03998bd@linaro.org
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ octeontx2-pf: handle otx2_mbox_get_rsp errors in otx2_ethtool.c (@Dipendra Khadka in [2db2194727b1f49](https://github.com/sophgo/linux-riscv/commit/2db2194727b1f49) at 2024-12-05 13:01:46)
    > [ Upstream commit e26f8eac6bb20b20fdb8f7dc695711ebce4c7c5c ]
    > Add error pointer check after calling otx2_mbox_get_rsp().
    > Fixes: 75f36270990c (&quot;octeontx2-pf: Support to enable/disable pause frames via ethtool&quot;)
    > Fixes: d0cf9503e908 (&quot;octeontx2-pf: ethtool fec mode support&quot;)
    > Signed-off-by: Dipendra Khadka &lt;kdipendra88@gmail.com&gt;
    > Reviewed-by: Simon Horman &lt;horms@kernel.org&gt;
    > Signed-off-by: Andrew Lunn &lt;andrew@lunn.ch&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ selftests/bpf: Fix msg_verify_data in test_sockmap (@Zijian Zhang in [fd60aedcce241de](https://github.com/sophgo/linux-riscv/commit/fd60aedcce241de) at 2024-12-05 13:01:45)
    > [ Upstream commit ee9b352ce4650ffc0d8ca0ac373d7c009c7e561e ]
    > Function msg_verify_data should have context of bytes_cnt and k instead of
    > assuming they are zero. Otherwise, test_sockmap with data integrity test
    > will report some errors. I also fix the logic related to size and index j
    > 1/ 6  sockmap::txmsg test passthrough:FAIL
    > 2/ 6  sockmap::txmsg test redirect:FAIL
    > 7/12  sockmap::txmsg test apply:FAIL
    > 10/11  sockmap::txmsg test push_data:FAIL
    > 11/17  sockmap::txmsg test pull-data:FAIL
    > 12/ 9  sockmap::txmsg test pop-data:FAIL
    > 13/ 1  sockmap::txmsg test push/pop data:FAIL
    > ...
    > Pass: 24 Fail: 52
    > After applying this patch, some of the errors are solved, but for push,
    > pull and pop, we may need more fixes to msg_verify_data, added a TODO
    > 10/11  sockmap::txmsg test push_data:FAIL
    > 11/17  sockmap::txmsg test pull-data:FAIL
    > 12/ 9  sockmap::txmsg test pop-data:FAIL
    > ...
    > Pass: 37 Fail: 15
    > Besides, added a custom errno EDATAINTEGRITY for msg_verify_data, we
    > shall not ignore the error in txmsg_cork case.
    > Fixes: 753fb2ee0934 (&quot;bpf: sockmap, add msg_peek tests to test_sockmap&quot;)
    > Fixes: 16edddfe3c5d (&quot;selftests/bpf: test_sockmap, check test failure&quot;)
    > Acked-by: John Fastabend &lt;john.fastabend@gmail.com&gt;
    > Signed-off-by: Zijian Zhang &lt;zijianzhang@bytedance.com&gt;
    > Link: https://lore.kernel.org/r/20241012203731.1248619-2-zijianzhang@bytedance.com
    > Signed-off-by: Martin KaFai Lau &lt;martin.lau@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ wifi: mwifiex: Fix memcpy() field-spanning write warning in mwifiex_config_scan() (@Alper Nebi Yasak in [d7774910c5583e6](https://github.com/sophgo/linux-riscv/commit/d7774910c5583e6) at 2024-12-05 13:01:45)
    > [ Upstream commit d241a139c2e9f8a479f25c75ebd5391e6a448500 ]
    > Replace one-element array with a flexible-array member in &#x60;struct
    > mwifiex_ie_types_wildcard_ssid_params&#x60; to fix the following warning
    > on a MT8173 Chromebook (mt8173-elm-hana):
    > [  356.775250] ------------[ cut here ]------------
    > [  356.784543] memcpy: detected field-spanning write (size 6) of single field &quot;wildcard_ssid_tlv-&gt;ssid&quot; at drivers/net/wireless/marvell/mwifiex/scan.c:904 (size 1)
    > [  356.813403] WARNING: CPU: 3 PID: 742 at drivers/net/wireless/marvell/mwifiex/scan.c:904 mwifiex_scan_networks+0x4fc/0xf28 [mwifiex]
    > The &quot;(size 6)&quot; above is exactly the length of the SSID of the network
    > this device was connected to. The source of the warning looks like:
    > ssid_len &#x3D; user_scan_in-&gt;ssid_list[i].ssid_len;
    > [...]
    > memcpy(wildcard_ssid_tlv-&gt;ssid,
    > user_scan_in-&gt;ssid_list[i].ssid, ssid_len);
    > There is a #define WILDCARD_SSID_TLV_MAX_SIZE that uses sizeof() on this
    > struct, but it already didn&#x27;t account for the size of the one-element
    > array, so it doesn&#x27;t need to be changed.
    > Fixes: 5e6e3a92b9a4 (&quot;wireless: mwifiex: initial commit for Marvell mwifiex driver&quot;)
    > Signed-off-by: Alper Nebi Yasak &lt;alpernebiyasak@gmail.com&gt;
    > Acked-by: Brian Norris &lt;briannorris@chromium.org&gt;
    > Signed-off-by: Kalle Valo &lt;kvalo@kernel.org&gt;
    > Link: https://patch.msgid.link/20241007222301.24154-1-alpernebiyasak@gmail.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/panic: Select ZLIB_DEFLATE for DRM_PANIC_SCREEN_QR_CODE (@Miguel Ojeda in [874b95398bd702c](https://github.com/sophgo/linux-riscv/commit/874b95398bd702c) at 2024-12-05 13:01:45)
    > [ Upstream commit 2ad84af4cff9121827d3dd35e293478bdb0b58bb ]
    > Under &#x60;CONFIG_DRM_PANIC_SCREEN_QR_CODE&#x3D;y&#x60;, zlib is used:
    > ld.lld: error: undefined symbol: zlib_deflate_workspacesize
    > &gt;&gt;&gt; referenced by drm_panic.c
    > &gt;&gt;&gt;               drivers/gpu/drm/drm_panic.o:(drm_panic_qr_init) in archive vmlinux.a
    > Thus select &#x60;CONFIG_ZLIB_DEFLATE&#x60;.
    > Fixes: cb5164ac43d0 (&quot;drm/panic: Add a QR code panic screen&quot;)
    > Signed-off-by: Miguel Ojeda &lt;ojeda@kernel.org&gt;
    > Reviewed-by: Jocelyn Falempe &lt;jfalempe@redhat.com&gt;
    > Signed-off-by: Jocelyn Falempe &lt;jfalempe@redhat.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20241003230734.653717-1-ojeda@kernel.org
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ wifi: wilc1000: Set MAC after operation mode (@Marek Vasut in [6f2648838ce1a9f](https://github.com/sophgo/linux-riscv/commit/6f2648838ce1a9f) at 2024-12-05 13:01:45)
    > [ Upstream commit 29dd3e48b9bd88bf65a1e760126fa18d1def7b30 ]
    > It seems it is necessary to set WILC MAC address after operation mode,
    > otherwise the MAC address of the WILC MAC is reset back to what is in
    > nvmem. This causes a failure to associate with AP after the WILC MAC
    > address was overridden by userspace.
    > Test case:
    > &quot;
    > ap$ cat &lt;&lt; EOF &gt; hostap.conf
    > interface&#x3D;wlan0
    > ssid&#x3D;ssid
    > hw_mode&#x3D;g
    > channel&#x3D;6
    > wpa&#x3D;2
    > wpa_passphrase&#x3D;pass
    > wpa_key_mgmt&#x3D;WPA-PSK
    > EOF
    > ap$ hostapd -d hostap.conf
    > ap$ ifconfig wlan0 10.0.0.1
    > &quot;
    > &quot;
    > sta$ ifconfig wlan0 hw ether 00:11:22:33:44:55
    > sta$ wpa_supplicant -i wlan0 -c &lt;(wpa_passphrase ssid pass)
    > sta$ ifconfig wlan0 10.0.0.2
    > sta$ ping 10.0.0.1 # fails without this patch
    > &quot;
    > AP still indicates SA with original MAC address from nvmem without this patch:
    > &quot;
    > nl80211: RX frame da&#x3D;ff:ff:ff:ff:ff:ff sa&#x3D;60:01:23:45:67:89 bssid&#x3D;ff:ff:ff:ff:ff:ff ...
    > ^^^^^^^^^^^^^^^^^
    > &quot;
    > Fixes: 83d9b54ee5d4 (&quot;wifi: wilc1000: read MAC address from fuse at probe&quot;)
    > Tested-by: Alexis Lothoré &lt;alexis.lothore@bootlin.com&gt;
    > Signed-off-by: Marek Vasut &lt;marex@denx.de&gt;
    > Signed-off-by: Kalle Valo &lt;kvalo@kernel.org&gt;
    > Link: https://patch.msgid.link/20241003132504.52233-1-marex@denx.de
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ selftests/bpf: Fix txmsg_redir of test_txmsg_pull in test_sockmap (@Zijian Zhang in [285ea632bf15aef](https://github.com/sophgo/linux-riscv/commit/285ea632bf15aef) at 2024-12-05 13:01:45)
    > [ Upstream commit b29e231d66303c12b7b8ac3ac2a057df06b161e8 ]
    > txmsg_redir in &quot;Test pull + redirect&quot; case of test_txmsg_pull should be
    > 1 instead of 0.
    > Fixes: 328aa08a081b (&quot;bpf: Selftests, break down test_sockmap into subtests&quot;)
    > Acked-by: John Fastabend &lt;john.fastabend@gmail.com&gt;
    > Signed-off-by: Zijian Zhang &lt;zijianzhang@bytedance.com&gt;
    > Link: https://lore.kernel.org/r/20241012203731.1248619-3-zijianzhang@bytedance.com
    > Signed-off-by: Martin KaFai Lau &lt;martin.lau@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm: fsl-dcu: enable PIXCLK on LS1021A (@Matthias Schiffer in [18f684962c0053a](https://github.com/sophgo/linux-riscv/commit/18f684962c0053a) at 2024-12-05 13:01:45)
    > [ Upstream commit ffcde9e44d3e18fde3d18bfff8d9318935413bfd ]
    > The PIXCLK needs to be enabled in SCFG before accessing certain DCU
    > registers, or the access will hang. For simplicity, the PIXCLK is enabled
    > unconditionally, resulting in increased power consumption.
    > Signed-off-by: Matthias Schiffer &lt;matthias.schiffer@tq-group.com&gt;
    > Signed-off-by: Alexander Stein &lt;alexander.stein@ew.tq-group.com&gt;
    > Fixes: 109eee2f2a18 (&quot;drm/layerscape: Add Freescale DCU DRM driver&quot;)
    > Acked-by: Dmitry Baryshkov &lt;dmitry.baryshkov@linaro.org&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20240926055552.1632448-2-alexander.stein@ew.tq-group.com
    > Signed-off-by: Dmitry Baryshkov &lt;dmitry.baryshkov@linaro.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ wifi: mwifiex: add missing locking for cfg80211 calls (@Sascha Hauer in [0ec726b65946712](https://github.com/sophgo/linux-riscv/commit/0ec726b65946712) at 2024-12-05 13:01:45)
    > [ Upstream commit 0d7c2194f17c764df0354af13551cc6f92ef5a44 ]
    > cfg80211_rx_assoc_resp() and cfg80211_rx_mlme_mgmt() need to be called
    > with the wiphy locked, so lock it before calling these functions.
    > Fixes: 36995892c271 (&quot;wifi: mwifiex: add host mlme for client mode&quot;)
    > Reviewed-by: Francesco Dolcini &lt;francesco.dolcini@toradex.com&gt;
    > Signed-off-by: Sascha Hauer &lt;s.hauer@pengutronix.de&gt;
    > Acked-by: Brian Norris &lt;briannorris@chromium.org&gt;
    > Signed-off-by: Kalle Valo &lt;kvalo@kernel.org&gt;
    > Link: https://patch.msgid.link/20240918-mwifiex-cleanup-1-v2-1-2d0597187d3c@pengutronix.de
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ libbpf: never interpret subprogs in .text as entry programs (@Andrii Nakryiko in [f6d78cb715282ec](https://github.com/sophgo/linux-riscv/commit/f6d78cb715282ec) at 2024-12-05 13:01:44)
    > [ Upstream commit db089c9158c1d535a36dfc010e5db37fccea2561 ]
    > Libbpf pre-1.0 had a legacy logic of allowing singular non-annotated
    > (i.e., not having explicit SEC() annotation) function to be treated as
    > sole entry BPF program (unless there were other explicit entry
    > programs).
    > This behavior was dropped during libbpf 1.0 transition period (unless
    > LIBBPF_STRICT_SEC_NAME flag was unset in libbpf_mode). When 1.0 was
    > released and all the legacy behavior was removed, the bug slipped
    > through leaving this legacy behavior around.
    > Fix this for good, as it actually causes very confusing behavior if BPF
    > object file only has subprograms, but no entry programs.
    > Fixes: bd054102a8c7 (&quot;libbpf: enforce strict libbpf 1.0 behaviors&quot;)
    > Signed-off-by: Andrii Nakryiko &lt;andrii@kernel.org&gt;
    > Link: https://lore.kernel.org/r/20241010211731.4121837-1-andrii@kernel.org
    > Signed-off-by: Alexei Starovoitov &lt;ast@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/bridge: tc358767: Fix link properties discovery (@Tomi Valkeinen in [b72b2a7f007cb10](https://github.com/sophgo/linux-riscv/commit/b72b2a7f007cb10) at 2024-12-05 13:01:44)
    > [ Upstream commit 2d343723c7e1f9f6d64f721f07cfdfc2993758d1 ]
    > When a display controller driver uses DRM_BRIDGE_ATTACH_NO_CONNECTOR,
    > tc358767 will behave properly and skip the creation of the connector.
    > However, tc_get_display_props(), which is used to find out about the DP
    > monitor and link, is only called from two places: .atomic_enable() and
    > tc_connector_get_modes(). The latter is only used when tc358767 creates
    > its own connector, i.e. when DRM_BRIDGE_ATTACH_NO_CONNECTOR is _not_
    > set.
    > Thus, the driver never finds out the link properties before get_edid()
    > is called. With num_lanes of 0 and link_rate of 0 there are not many
    > valid modes...
    > Fix this by adding tc_get_display_props() call at the beginning of
    > get_edid(), so that we have up to date information before looking at the
    > modes.
    > Reported-by: Jan Kiszka &lt;jan.kiszka@siemens.com&gt;
    > Closes: https://lore.kernel.org/all/24282420-b4dd-45b3-bb1c-fc37fe4a8205@siemens.com/
    > Fixes: de5e6c027ae6 (&quot;drm/bridge: tc358767: add drm_panel_bridge support&quot;)
    > Reviewed-by: Aradhya Bhatia &lt;a-bhatia1@ti.com&gt;
    > Tested-by: Jan Kiszka &lt;jan.kiszka@siemens.com&gt;
    > Signed-off-by: Tomi Valkeinen &lt;tomi.valkeinen@ideasonboard.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20231108-tc358767-v2-2-25c5f70a2159@ideasonboard.com
    > Signed-off-by: Dmitry Baryshkov &lt;dmitry.baryshkov@linaro.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ libbpf: fix sym_is_subprog() logic for weak global subprogs (@Andrii Nakryiko in [a7662f65f482d0a](https://github.com/sophgo/linux-riscv/commit/a7662f65f482d0a) at 2024-12-05 13:01:44)
    > [ Upstream commit 4073213488be542f563eb4b2457ab4cbcfc2b738 ]
    > sym_is_subprog() is incorrectly rejecting relocations against *weak*
    > global subprogs. Fix that by realizing that STB_WEAK is also a global
    > function.
    > While it seems like verifier doesn&#x27;t support taking an address of
    > non-static subprog right now, it&#x27;s still best to fix support for it on
    > libbpf side, otherwise users will get a very confusing error during BPF
    > skeleton generation or static linking due to misinterpreted relocation:
    > libbpf: prog &#x27;handle_tp&#x27;: bad map relo against &#x27;foo&#x27; in section &#x27;.text&#x27;
    > Error: failed to open BPF object file: Relocation failed
    > It&#x27;s clearly not a map relocation, but is treated and reported as such
    > without this fix.
    > Fixes: 53eddb5e04ac (&quot;libbpf: Support subprog address relocation&quot;)
    > Signed-off-by: Andrii Nakryiko &lt;andrii@kernel.org&gt;
    > Link: https://lore.kernel.org/r/20241009011554.880168-1-andrii@kernel.org
    > Signed-off-by: Alexei Starovoitov &lt;ast@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ASoC: rt722-sdca: Remove logically deadcode in rt722-sdca.c (@Everest K.C in [465dd97498d29e7](https://github.com/sophgo/linux-riscv/commit/465dd97498d29e7) at 2024-12-05 13:01:44)
    > [ Upstream commit 22206e569fb54bf9c95db9a0138a7485ba9e13bc ]
    > As the same condition was checked in inner and outer if statements.
    > The code never reaches the inner else statement.
    > Fix this by removing the logically dead inner else statement.
    > Fixes: 7f5d6036ca00 (&quot;ASoC: rt722-sdca: Add RT722 SDCA driver&quot;)
    > Reported-by: Shuah Khan &lt;skhan@linuxfoundation.org&gt;
    > Closes: https://lore.kernel.org/all/e44527e8-b7c6-4712-97a6-d54f02ad2dc9@linuxfoundation.org/
    > Signed-off-by: Everest K.C. &lt;everestkc@everestkc.com.np&gt;
    > Reviewed-by: Shuah Khan &lt;skhan@linuxfoundation.org&gt;
    > Link: https://patch.msgid.link/20241010175755.5278-1-everestkc@everestkc.com.np
    > Signed-off-by: Mark Brown &lt;broonie@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ accel/ivpu: Prevent recovery invocation during probe and resume (@Karol Wachowski in [362ef76020ea621](https://github.com/sophgo/linux-riscv/commit/362ef76020ea621) at 2024-12-05 13:01:44)
    > [ Upstream commit 5eaa497411197c41b0813d61ba3fbd6267049082 ]
    > Refactor IPC send and receive functions to allow correct
    > handling of operations that should not trigger a recovery process.
    > Expose ivpu_send_receive_internal(), which is now utilized by the D0i3
    > entry, DCT initialization, and HWS initialization functions.
    > These functions have been modified to return error codes gracefully,
    > rather than initiating recovery.
    > The updated functions are invoked within ivpu_probe() and ivpu_resume(),
    > ensuring that any errors encountered during these stages result in a proper
    > teardown or shutdown sequence. The previous approach of triggering recovery
    > within these functions could lead to a race condition, potentially causing
    > undefined behavior and kernel crashes due to null pointer dereferences.
    > Fixes: 45e45362e095 (&quot;accel/ivpu: Introduce ivpu_ipc_send_receive_active()&quot;)
    > Signed-off-by: Karol Wachowski &lt;karol.wachowski@intel.com&gt;
    > Reviewed-by: Jacek Lawrynowicz &lt;jacek.lawrynowicz@linux.intel.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20240930195322.461209-23-jacek.lawrynowicz@linux.intel.com
    > Signed-off-by: Jacek Lawrynowicz &lt;jacek.lawrynowicz@linux.intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ netdevsim: copy addresses for both in and out paths (@Hangbin Liu in [0ecc56b34f32cbf](https://github.com/sophgo/linux-riscv/commit/0ecc56b34f32cbf) at 2024-12-05 13:01:44)
    > [ Upstream commit 2cf567f421dbfe7e53b7e5ddee9400da10efb75d ]
    > The current code only copies the address for the in path, leaving the out
    > path address set to 0. This patch corrects the issue by copying the addresses
    > for both the in and out paths. Before this patch:
    > # cat /sys/kernel/debug/netdevsim/netdevsim0/ports/0/ipsec
    > SA count&#x3D;2 tx&#x3D;20
    > sa[0] tx ipaddr&#x3D;0.0.0.0
    > sa[0]    spi&#x3D;0x00000100 proto&#x3D;0x32 salt&#x3D;0x0adecc3a crypt&#x3D;1
    > sa[0]    key&#x3D;0x3167608a ca4f1397 43565909 941fa627
    > sa[1] rx ipaddr&#x3D;192.168.0.1
    > sa[1]    spi&#x3D;0x00000101 proto&#x3D;0x32 salt&#x3D;0x0adecc3a crypt&#x3D;1
    > sa[1]    key&#x3D;0x3167608a ca4f1397 43565909 941fa627
    > After this patch:
    > &#x3D; cat /sys/kernel/debug/netdevsim/netdevsim0/ports/0/ipsec
    > SA count&#x3D;2 tx&#x3D;20
    > sa[0] tx ipaddr&#x3D;192.168.0.2
    > sa[0]    spi&#x3D;0x00000100 proto&#x3D;0x32 salt&#x3D;0x0adecc3a crypt&#x3D;1
    > sa[0]    key&#x3D;0x3167608a ca4f1397 43565909 941fa627
    > sa[1] rx ipaddr&#x3D;192.168.0.1
    > sa[1]    spi&#x3D;0x00000101 proto&#x3D;0x32 salt&#x3D;0x0adecc3a crypt&#x3D;1
    > sa[1]    key&#x3D;0x3167608a ca4f1397 43565909 941fa627
    > Fixes: 7699353da875 (&quot;netdevsim: add ipsec offload testing&quot;)
    > Reviewed-by: Simon Horman &lt;horms@kernel.org&gt;
    > Signed-off-by: Hangbin Liu &lt;liuhangbin@gmail.com&gt;
    > Link: https://patch.msgid.link/20241010040027.21440-3-liuhangbin@gmail.com
    > Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/vc4: hdmi: Increase audio MAI fifo dreq threshold (@Dom Cobley in [c17a6e97f225a94](https://github.com/sophgo/linux-riscv/commit/c17a6e97f225a94) at 2024-12-05 13:01:43)
    > [ Upstream commit 59f8b2b7fb8e460881d21c7d5b32604993973879 ]
    > Now we wait for write responses and have a burst
    > size of 4, we can set the fifo threshold much higher.
    > Set it to 28 (of the 32 entry size) to keep fifo
    > fuller and reduce chance of underflow.
    > Signed-off-by: Dom Cobley &lt;popcornmix@gmail.com&gt;
    > Reviewed-by: Maxime Ripard &lt;mripard@kernel.org&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20240621152055.4180873-8-dave.stevenson@raspberrypi.com
    > Signed-off-by: Dave Stevenson &lt;dave.stevenson@raspberrypi.com&gt;
    > Stable-dep-of: cf1c87d978d4 (&quot;drm/vc4: Match drm_dev_enter and exit calls in vc4_hvs_lut_load&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/vc4: Match drm_dev_enter and exit calls in vc4_hvs_lut_load (@Dave Stevenson in [ba98ae3706a05df](https://github.com/sophgo/linux-riscv/commit/ba98ae3706a05df) at 2024-12-05 13:01:43)
    > [ Upstream commit cf1c87d978d47339a39bfa7a6133ecd3f8f87525 ]
    > Commit 52efe364d196 (&quot;drm/vc4: hvs: Don&#x27;t write gamma luts on 2711&quot;)
    > added a return path to vc4_hvs_lut_load that had called
    > drm_dev_enter, but not drm_dev_exit.
    > Ensure we call drm_dev_exit.
    > Fixes: 52efe364d196 (&quot;drm/vc4: hvs: Don&#x27;t write gamma luts on 2711&quot;)
    > Reported-by: Marek Szyprowski &lt;m.szyprowski@samsung.com&gt;
    > Closes: https://lore.kernel.org/dri-devel/37051126-3921-4afe-a936-5f828bff5752@samsung.com/
    > Tested-by: Marek Szyprowski &lt;m.szyprowski@samsung.com&gt;
    > Reviewed-by: Maíra Canal &lt;mcanal@igalia.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20241008-drm-vc4-fixes-v1-1-9d0396ca9f42@raspberrypi.com
    > Signed-off-by: Dave Stevenson &lt;dave.stevenson@raspberrypi.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/vc4: Match drm_dev_enter and exit calls in vc4_hvs_atomic_flush (@Dave Stevenson in [9b432bbf76ed8cf](https://github.com/sophgo/linux-riscv/commit/9b432bbf76ed8cf) at 2024-12-05 13:01:43)
    > [ Upstream commit 6b0bd1b02ea24b10522c92b2503981970b26d1a2 ]
    > Commit 92c17d16476c (&quot;drm/vc4: hvs: Ignore atomic_flush if we&#x27;re disabled&quot;)
    > added a path which returned early without having called drm_dev_exit.
    > Ensure all paths call drm_dev_exit.
    > Fixes: 92c17d16476c (&quot;drm/vc4: hvs: Ignore atomic_flush if we&#x27;re disabled&quot;)
    > Tested-by: Marek Szyprowski &lt;m.szyprowski@samsung.com&gt;
    > Reviewed-by: Maíra Canal &lt;mcanal@igalia.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20241008-drm-vc4-fixes-v1-2-9d0396ca9f42@raspberrypi.com
    > Signed-off-by: Dave Stevenson &lt;dave.stevenson@raspberrypi.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/vc4: Introduce generation number enum (@Maxime Ripard in [9550b15fbe5ce64](https://github.com/sophgo/linux-riscv/commit/9550b15fbe5ce64) at 2024-12-05 13:01:43)
    > [ Upstream commit 24c5ed3ddf27313b248900455b0312bd7a9d3554 ]
    > With the introduction of the BCM2712 support, we will get yet another
    > generation of display engine to support.
    > The binary check of whether it&#x27;s VC5 or not thus doesn&#x27;t work anymore,
    > especially since some parts of the driver will have changed with BCM2711,
    > and some others with BCM2712.
    > Let&#x27;s introduce an enum to store the generation the driver is running
    > on, which should provide more flexibility.
    > Signed-off-by: Maxime Ripard &lt;mripard@kernel.org&gt;
    > Reviewed-by: Maxime Ripard &lt;mripard@kernel.org&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20240621152055.4180873-21-dave.stevenson@raspberrypi.com
    > Signed-off-by: Dave Stevenson &lt;dave.stevenson@raspberrypi.com&gt;
    > Stable-dep-of: cf1c87d978d4 (&quot;drm/vc4: Match drm_dev_enter and exit calls in vc4_hvs_lut_load&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/vc4: Correct generation check in vc4_hvs_lut_load (@Dave Stevenson in [65b8d71d26b6efe](https://github.com/sophgo/linux-riscv/commit/65b8d71d26b6efe) at 2024-12-05 13:01:43)
    > [ Upstream commit 42aa18d1c3e7762bcebd89a5857ed7774e669d92 ]
    > Commit 24c5ed3ddf27 (&quot;drm/vc4: Introduce generation number enum&quot;)
    > incorrectly swapped a check of hvs-&gt;vc4-&gt;is_vc5 to
    > hvs-&gt;vc4-&gt;gen &#x3D;&#x3D; VC4_GEN_4 in vc4_hvs_lut_load, hence breaking
    > loading the gamma look up table on Pi0-3.
    > Correct that conditional.
    > Fixes: 24c5ed3ddf27 (&quot;drm/vc4: Introduce generation number enum&quot;)
    > Reported-by: Marek Szyprowski &lt;m.szyprowski@samsung.com&gt;
    > Closes: https://lore.kernel.org/dri-devel/37051126-3921-4afe-a936-5f828bff5752@samsung.com/
    > Tested-by: Marek Szyprowski &lt;m.szyprowski@samsung.com&gt;
    > Reviewed-by: Maíra Canal &lt;mcanal@igalia.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20241008-drm-vc4-fixes-v1-3-9d0396ca9f42@raspberrypi.com
    > Signed-off-by: Dave Stevenson &lt;dave.stevenson@raspberrypi.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ice: consistently use q_idx in ice_vc_cfg_qs_msg() (@Jacob Keller in [3a3ad9f6ea052eb](https://github.com/sophgo/linux-riscv/commit/3a3ad9f6ea052eb) at 2024-12-05 13:01:43)
    > [ Upstream commit a884c304e18a40e1c7a6525a9274e64c2c061c3f ]
    > The ice_vc_cfg_qs_msg() function is used to configure VF queues in response
    > to a VIRTCHNL_OP_CONFIG_VSI_QUEUES command.
    > The virtchnl command contains an array of queue pair data for configuring
    > Tx and Rx queues. This data includes a queue ID. When configuring the
    > queues, the driver generally uses this queue ID to determine which Tx and
    > Rx ring to program. However, a handful of places use the index into the
    > queue pair data from the VF. While most VF implementations appear to send
    > this data in order, it is not mandated by the virtchnl and it is not
    > verified that the queue pair data comes in order.
    > Fix the driver to consistently use the q_idx field instead of the &#x27;i&#x27;
    > iterator value when accessing the rings. For the Rx case, introduce a local
    > ring variable to keep lines short.
    > Fixes: 7ad15440acf8 (&quot;ice: Refactor VIRTCHNL_OP_CONFIG_VSI_QUEUES handling&quot;)
    > Signed-off-by: Jacob Keller &lt;jacob.e.keller@intel.com&gt;
    > Tested-by: Rafal Romanowski &lt;rafal.romanowski@intel.com&gt;
    > Signed-off-by: Tony Nguyen &lt;anthony.l.nguyen@intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ wifi: cfg80211: check radio iface combination for multi radio per wiphy (@Karthikeyan Periyasamy in [33d5685a97d7c74](https://github.com/sophgo/linux-riscv/commit/33d5685a97d7c74) at 2024-12-05 13:01:43)
    > [ Upstream commit bd9813d13be439851a7ff3e6372e53caa6e387a6 ]
    > Currently, wiphy_verify_combinations() fails for the multi-radio per wiphy
    > due to the condition check on new global interface combination that DFS
    > only works on one channel. In a multi-radio scenario, new global interface
    > combination encompasses the capabilities of all radio combinations, so it
    > supports more than one channel with DFS. For multi-radio per wiphy,
    > interface combination verification needs to be performed for radio specific
    > interface combinations. This is necessary as the new global interface
    > combination combines the capabilities of all radio combinations.
    > Fixes: a01b1e9f9955 (&quot;wifi: mac80211: add support for DFS with multiple radios&quot;)
    > Signed-off-by: Karthikeyan Periyasamy &lt;quic_periyasa@quicinc.com&gt;
    > Link: https://patch.msgid.link/20240917140239.886083-1-quic_periyasa@quicinc.com
    > Signed-off-by: Johannes Berg &lt;johannes.berg@intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ selftests/bpf: add missing header include for htons (@Alexis Lothoré (eBPF Foundation) in [d110ef3171f6368](https://github.com/sophgo/linux-riscv/commit/d110ef3171f6368) at 2024-12-05 13:01:42)
    > [ Upstream commit bc9b3fb827fceec4e05564d6e668280f4470ab5b ]
    > Including the network_helpers.h header in tests can lead to the following
    > build error:
    > ./network_helpers.h: In function ‘csum_tcpudp_magic’:
    > ./network_helpers.h:116:14: error: implicit declaration of function \
    > ‘htons’ [-Werror&#x3D;implicit-function-declaration]
    > 116 |         s +&#x3D; htons(proto + len);
    > The error is avoided in many cases thanks to some other headers included
    > earlier and bringing in arpa/inet.h (ie: test_progs.h).
    > Make sure that test_progs build success does not depend on header ordering
    > by adding the missing header include in network_helpers.h
    > Fixes: f6642de0c3e9 (&quot;selftests/bpf: Add csum helpers&quot;)
    > Signed-off-by: Alexis Lothoré (eBPF Foundation) &lt;alexis.lothore@bootlin.com&gt;
    > Link: https://lore.kernel.org/r/20241008-network_helpers_fix-v1-1-2c2ae03df7ef@bootlin.com
    > Signed-off-by: Martin KaFai Lau &lt;martin.lau@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ selftests: bpf: Add missing per-arch include path (@Björn Töpel in [9151d80ea7f170b](https://github.com/sophgo/linux-riscv/commit/9151d80ea7f170b) at 2024-12-05 13:01:42)
    > [ Upstream commit 19090f0306f1748980596c6c71f1c4b128639cff ]
    > The prog_tests programs do not include the per-arch tools include
    > path, e.g. tools/arch/riscv/include. Some architectures depend those
    > files to build properly.
    > Include tools/arch/$(SUBARCH)/include in the selftests bpf build.
    > Fixes: 6d74d178fe6e (&quot;tools: Add riscv barrier implementation&quot;)
    > Signed-off-by: Björn Töpel &lt;bjorn@rivosinc.com&gt;
    > Signed-off-by: Andrii Nakryiko &lt;andrii@kernel.org&gt;
    > Link: https://lore.kernel.org/bpf/20240927131355.350918-2-bjorn@kernel.org
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ selftests/bpf: Fix backtrace printing for selftests crashes (@Eduard Zingerman in [6fcd4977c08f756](https://github.com/sophgo/linux-riscv/commit/6fcd4977c08f756) at 2024-12-05 13:01:42)
    > [ Upstream commit 5bf1557e3d6a69113649d831276ea2f97585fc33 ]
    > test_progs uses glibc specific functions backtrace() and
    > backtrace_symbols_fd() to print backtrace in case of SIGSEGV.
    > Recent commit (see fixes) updated test_progs.c to define stub versions
    > of the same functions with attriubte &quot;weak&quot; in order to allow linking
    > test_progs against musl libc. Unfortunately this broke the backtrace
    > handling for glibc builds.
    > As it turns out, glibc defines backtrace() and backtrace_symbols_fd()
    > as weak:
    > $ llvm-readelf --symbols /lib64/libc.so.6 \
    > | grep -P &#x27;( backtrace_symbols_fd| backtrace)$&#x27;
    > 4910: 0000000000126b40   161 FUNC    WEAK   DEFAULT    16 backtrace
    > 6843: 0000000000126f90   852 FUNC    WEAK   DEFAULT    16 backtrace_symbols_fd
    > So does test_progs:
    > $ llvm-readelf --symbols test_progs \
    > | grep -P &#x27;( backtrace_symbols_fd| backtrace)$&#x27;
    > 2891: 00000000006ad190    15 FUNC    WEAK   DEFAULT    13 backtrace
    > 11215: 00000000006ad1a0    41 FUNC    WEAK   DEFAULT    13 backtrace_symbols_fd
    > In such situation dynamic linker is not obliged to favour glibc
    > implementation over the one defined in test_progs.
    > Compiling with the following simple modification to test_progs.c
    > demonstrates the issue:
    > $ git diff
    > ...
    > \--- a/tools/testing/selftests/bpf/test_progs.c
    > \+++ b/tools/testing/selftests/bpf/test_progs.c
    > \@@ -1817,6 +1817,7 @@ int main(int argc, char **argv)
    > if (err)
    > return err;
    > +       *(int *)0xdeadbeef  &#x3D; 42;
    > err &#x3D; cd_flavor_subdir(argv[0]);
    > if (err)
    > return err;
    > $ ./test_progs
    > [0]: Caught signal #11!
    > Stack trace:
    > &lt;backtrace not supported&gt;
    > Segmentation fault (core dumped)
    > Resolve this by hiding stub definitions behind __GLIBC__ macro check
    > instead of using &quot;weak&quot; attribute.
    > Fixes: c9a83e76b5a9 (&quot;selftests/bpf: Fix compile if backtrace support missing in libc&quot;)
    > Signed-off-by: Eduard Zingerman &lt;eddyz87@gmail.com&gt;
    > Signed-off-by: Andrii Nakryiko &lt;andrii@kernel.org&gt;
    > Tested-by: Tony Ambardar &lt;tony.ambardar@gmail.com&gt;
    > Reviewed-by: Tony Ambardar &lt;tony.ambardar@gmail.com&gt;
    > Acked-by: Daniel Xu &lt;dxu@dxuuu.xyz&gt;
    > Link: https://lore.kernel.org/bpf/20241003210307.3847907-1-eddyz87@gmail.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ wifi: ath11k: Fix CE offset address calculation for WCN6750 in SSR (@Balaji Pothunoori in [566400b9ba275da](https://github.com/sophgo/linux-riscv/commit/566400b9ba275da) at 2024-12-05 13:01:42)
    > [ Upstream commit 4c57ec6c4bb9979b42ae7fa7273fc2d4a361d576 ]
    > Currently, mem_ce and mem iomem addresses are used to calculate the
    > CE offset address. mem_ce is initialized with mem address, and for
    > targets where ce_remap is needed, mem_ce is remapped to a new address
    > space during AHB probe.
    > For targets such as WCN6750 in which CE address space is same as WCSS
    > address space (i.e. &quot;ce_remap&quot; hw_param is set to false), mem_ce and
    > mem iomem addresses are same. In the initial SRNG setup for such targets,
    > the CE offset address and hence CE register base addresses are
    > calculated correctly in ath11k_hal_srng_init() as both mem and mem_ce
    > are initialized with same iomem address.
    > Later, after the firmware download, mem is initialized with BAR address
    > received in qmi_wlanfw_device_info_resp_msg_v01 QMI message, while mem_ce
    > is not updated.
    > After initial setup success, during Subsystem Restart (SSR), as part
    > of reinitialization, ath11k_hal_srng_init() will be called again,
    > and CE offset address will be calculated incorrectly this time as mem_ce
    > address was not updated. Due to the incorrect CE offset address,
    > APPS accesses an invalid CE register address which leads to improper
    > behavior in firmware after SSR is triggered.
    > To fix the above issue, update mem_ce to mem iomem address in
    > ath11k_qmi_request_device_info() for targets which do not support
    > ce_remap feature.
    > Signed-off-by: Balaji Pothunoori &lt;quic_bpothuno@quicinc.com&gt;
    > Fixes: b42b3678c91f (&quot;wifi: ath11k: remap ce register space for IPQ5018&quot;)
    > Link: https://patch.msgid.link/20240927095825.22317-1-quic_bpothuno@quicinc.com
    > Signed-off-by: Jeff Johnson &lt;quic_jjohnson@quicinc.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ wifi: ath12k: fix one more memcpy size error (@Arnd Bergmann in [2245bb1ba9c0023](https://github.com/sophgo/linux-riscv/commit/2245bb1ba9c0023) at 2024-12-05 13:01:42)
    > [ Upstream commit 19c23eb61fa4c802e6e0aaf74d6f7dcbe99f0ba3 ]
    > A previous patch addressed a fortified-memcpy warning on older compilers,
    > but there is still a warning on gcc-14 in some configurations:
    > In file included from include/linux/string.h:390,
    > from drivers/net/wireless/ath/ath12k/wow.c:7:
    > drivers/net/wireless/ath/ath12k/wow.c: In function &#x27;ath12k_wow_convert_8023_to_80211.isra&#x27;:
    > include/linux/fortify-string.h:114:33: error: &#x27;__builtin_memcpy&#x27; accessing 18446744073709551610 or more bytes at offsets 0 and 0 overlaps 9223372036854775797 bytes at offset -9223372036854775803 [-Werror&#x3D;restrict]
    > include/linux/fortify-string.h:679:26: note: in expansion of macro &#x27;__fortify_memcpy_chk&#x27;
    > 679 | #define memcpy(p, q, s)  __fortify_memcpy_chk(p, q, s,                  \
    > |                          ^~~~~~~~~~~~~~~~~~~~
    > drivers/net/wireless/ath/ath12k/wow.c:199:25: note: in expansion of macro &#x27;memcpy&#x27;
    > 199 |                         memcpy(pat + a3_ofs - pkt_ofs,
    > |                         ^~~~~~
    > Address this the same way as the other two, using size_add().
    > Fixes: b49991d83bba (&quot;wifi: ath12k: fix build vs old compiler&quot;)
    > Fixes: 4a3c212eee0e (&quot;wifi: ath12k: add basic WoW functionalities&quot;)
    > Signed-off-by: Arnd Bergmann &lt;arnd@arndb.de&gt;
    > Acked-by: Kalle Valo &lt;kvalo@kernel.org&gt;
    > Link: https://patch.msgid.link/20241004095420.637091-1-arnd@kernel.org
    > Signed-off-by: Jeff Johnson &lt;quic_jjohnson@quicinc.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ libbpf: Add missing per-arch include path (@Björn Töpel in [1fcc87ec9d53b3b](https://github.com/sophgo/linux-riscv/commit/1fcc87ec9d53b3b) at 2024-12-05 13:01:42)
    > [ Upstream commit 710fbca820c721cdd60fa8c5bbe9deb4c0788aae ]
    > libbpf does not include the per-arch tools include path, e.g.
    > tools/arch/riscv/include. Some architectures depend those files to
    > build properly.
    > Include tools/arch/$(SUBARCH)/include in the libbpf build.
    > Fixes: 6d74d178fe6e (&quot;tools: Add riscv barrier implementation&quot;)
    > Signed-off-by: Björn Töpel &lt;bjorn@rivosinc.com&gt;
    > Signed-off-by: Andrii Nakryiko &lt;andrii@kernel.org&gt;
    > Link: https://lore.kernel.org/bpf/20240927131355.350918-1-bjorn@kernel.org
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ bpf: Fix the xdp_adjust_tail sample prog issue (@Yuan Chen in [0ec52d8451b2b70](https://github.com/sophgo/linux-riscv/commit/0ec52d8451b2b70) at 2024-12-05 13:01:42)
    > [ Upstream commit 4236f114a3ffbbfd217436c08852e94cae372f57 ]
    > During the xdp_adjust_tail test, probabilistic failure occurs and SKB package
    > is discarded by the kernel. After checking the issues by tracking SKB package,
    > it is identified that they were caused by checksum errors. Refer to checksum
    > of the arch/arm64/include/asm/checksum.h for fixing.
    > v2: Based on Alexei Starovoitov&#x27;s suggestions, it is necessary to keep the code
    > implementation consistent.
    > Fixes: c6ffd1ff7856 (bpf: add bpf_xdp_adjust_tail sample prog)
    > Signed-off-by: Yuan Chen &lt;chenyuan@kylinos.cn&gt;
    > Signed-off-by: Andrii Nakryiko &lt;andrii@kernel.org&gt;
    > Link: https://lore.kernel.org/bpf/20240930024115.52841-1-chenyuan_fl@163.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/amd/display: fix a memleak issue when driver is removed (@Aurabindo Pillai in [5860c637513036a](https://github.com/sophgo/linux-riscv/commit/5860c637513036a) at 2024-12-05 13:01:41)
    > [ Upstream commit d4f36e5fd800de7db74c1c4e62baf24a091a5ff6 ]
    > Running &quot;modprobe amdgpu&quot; the second time (followed by a modprobe -r
    > amdgpu) causes a call trace like:
    > [  845.212163] Memory manager not clean during takedown.
    > [  845.212170] WARNING: CPU: 4 PID: 2481 at drivers/gpu/drm/drm_mm.c:999 drm_mm_takedown+0x2b/0x40
    > [  845.212177] Modules linked in: amdgpu(OE-) amddrm_ttm_helper(OE) amddrm_buddy(OE) amdxcp(OE) amd_sched(OE) drm_exec drm_suballoc_helper drm_display_helper i2c_algo_bit amdttm(OE) amdkcl(OE) cec rc_core sunrpc qrtr intel_rapl_msr intel_rapl_common snd_hda_codec_hdmi edac_mce_amd snd_hda_intel snd_intel_dspcfg snd_intel_sdw_acpi snd_usb_audio snd_hda_codec snd_usbmidi_lib kvm_amd snd_hda_core snd_ump mc snd_hwdep kvm snd_pcm snd_seq_midi snd_seq_midi_event irqbypass crct10dif_pclmul snd_rawmidi polyval_clmulni polyval_generic ghash_clmulni_intel sha256_ssse3 sha1_ssse3 snd_seq aesni_intel crypto_simd snd_seq_device cryptd snd_timer mfd_aaeon asus_nb_wmi eeepc_wmi joydev asus_wmi snd ledtrig_audio sparse_keymap ccp wmi_bmof input_leds k10temp i2c_piix4 platform_profile rapl soundcore gpio_amdpt mac_hid binfmt_misc msr parport_pc ppdev lp parport efi_pstore nfnetlink dmi_sysfs ip_tables x_tables autofs4 hid_logitech_hidpp hid_logitech_dj hid_generic usbhid hid ahci xhci_pci igc crc32_pclmul libahci xhci_pci_renesas video
    > [  845.212284]  wmi [last unloaded: amddrm_ttm_helper(OE)]
    > [  845.212290] CPU: 4 PID: 2481 Comm: modprobe Tainted: G        W  OE      6.8.0-31-generic #31-Ubuntu
    > [  845.212296] RIP: 0010:drm_mm_takedown+0x2b/0x40
    > [  845.212300] Code: 1f 44 00 00 48 8b 47 38 48 83 c7 38 48 39 f8 75 09 31 c0 31 ff e9 90 2e 86 00 55 48 c7 c7 d0 f6 8e 8a 48 89 e5 e8 f5 db 45 ff &lt;0f&gt; 0b 5d 31 c0 31 ff e9 74 2e 86 00 66 0f 1f 84 00 00 00 00 00 90
    > [  845.212302] RSP: 0018:ffffb11302127ae0 EFLAGS: 00010246
    > [  845.212305] RAX: 0000000000000000 RBX: ffff92aa5020fc08 RCX: 0000000000000000
    > [  845.212307] RDX: 0000000000000000 RSI: 0000000000000000 RDI: 0000000000000000
    > [  845.212309] RBP: ffffb11302127ae0 R08: 0000000000000000 R09: 0000000000000000
    > [  845.212310] R10: 0000000000000000 R11: 0000000000000000 R12: 0000000000000004
    > [  845.212312] R13: ffff92aa50200000 R14: ffff92aa5020fb10 R15: ffff92aa5020faa0
    > [  845.212313] FS:  0000707dd7c7c080(0000) GS:ffff92b93de00000(0000) knlGS:0000000000000000
    > [  845.212316] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
    > [  845.212318] CR2: 00007d48b0aee200 CR3: 0000000115a58000 CR4: 0000000000f50ef0
    > [  845.212320] PKRU: 55555554
    > [  845.212321] Call Trace:
    > [  845.212323]  &lt;TASK&gt;
    > [  845.212328]  ? show_regs+0x6d/0x80
    > [  845.212333]  ? __warn+0x89/0x160
    > [  845.212339]  ? drm_mm_takedown+0x2b/0x40
    > [  845.212344]  ? report_bug+0x17e/0x1b0
    > [  845.212350]  ? handle_bug+0x51/0xa0
    > [  845.212355]  ? exc_invalid_op+0x18/0x80
    > [  845.212359]  ? asm_exc_invalid_op+0x1b/0x20
    > [  845.212366]  ? drm_mm_takedown+0x2b/0x40
    > [  845.212371]  amdgpu_gtt_mgr_fini+0xa9/0x130 [amdgpu]
    > [  845.212645]  amdgpu_ttm_fini+0x264/0x340 [amdgpu]
    > [  845.212770]  amdgpu_bo_fini+0x2e/0xc0 [amdgpu]
    > [  845.212894]  gmc_v12_0_sw_fini+0x2a/0x40 [amdgpu]
    > [  845.213036]  amdgpu_device_fini_sw+0x11a/0x590 [amdgpu]
    > [  845.213159]  amdgpu_driver_release_kms+0x16/0x40 [amdgpu]
    > [  845.213302]  devm_drm_dev_init_release+0x5e/0x90
    > [  845.213305]  devm_action_release+0x12/0x30
    > [  845.213308]  release_nodes+0x42/0xd0
    > [  845.213311]  devres_release_all+0x97/0xe0
    > [  845.213314]  device_unbind_cleanup+0x12/0x80
    > [  845.213317]  device_release_driver_internal+0x230/0x270
    > [  845.213319]  ? srso_alias_return_thunk+0x5/0xfbef5
    > This is caused by lost memory during early init phase. First time driver
    > is removed, memory is freed but when second time the driver is inserted,
    > VBIOS dmub is not active, since the PSP policy is to retain the driver
    > loaded version on subsequent warm boots. Hence, communication with VBIOS
    > DMUB fails.
    > Fix this by aborting further communication with vbios dmub and release
    > the memory immediately.
    > Fixes: f59549c7e705 (&quot;drm/amd/display: free bo used for dmub bounding box&quot;)
    > Reviewed-by: Rodrigo Siqueira &lt;rodrigo.siqueira@amd.com&gt;
    > Signed-off-by: Aurabindo Pillai &lt;aurabindo.pillai@amd.com&gt;
    > Signed-off-by: Rodrigo Siqueira &lt;rodrigo.siqueira@amd.com&gt;
    > Tested-by: Daniel Wheeler &lt;daniel.wheeler@amd.com&gt;
    > Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ASoC: amd: acp: fix for inconsistent indenting (@Vijendar Mukunda in [3c56866f841c2d0](https://github.com/sophgo/linux-riscv/commit/3c56866f841c2d0) at 2024-12-05 13:01:41)
    > [ Upstream commit 914219d74931211e719907e0eed03d8133f8b1b7 ]
    > Fix below Smatch static checker warning:
    > sound/soc/amd/acp/acp-sdw-sof-mach.c:365 sof_card_dai_links_create()
    > warn: inconsistent indenting
    > Reported-by: Dan Carpenter &lt;dan.carpenter@linaro.org&gt;
    > Closes: https://lore.kernel.org/all/a201e871-375e-43eb-960d-5c048956c2ff@amd.com/T/
    > Fixes: 6d8348ddc56e (&quot;ASoC: amd: acp: refactor SoundWire machine driver code&quot;)
    > Signed-off-by: Vijendar Mukunda &lt;Vijendar.Mukunda@amd.com&gt;
    > Link: https://patch.msgid.link/20241007085321.3991149-2-Vijendar.Mukunda@amd.com
    > Signed-off-by: Mark Brown &lt;broonie@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ wifi: ath12k: fix use-after-free in ath12k_dp_cc_cleanup() (@Rameshkumar Sundaram in [35be5018a2a4d1b](https://github.com/sophgo/linux-riscv/commit/35be5018a2a4d1b) at 2024-12-05 13:01:41)
    > [ Upstream commit bdb281103373fd80eb5c91cede1e115ba270b4e9 ]
    > During ath12k module removal, in ath12k_core_deinit(),
    > ath12k_mac_destroy() un-registers ah-&gt;hw from mac80211 and frees
    > the ah-&gt;hw as well as all the ar&#x27;s in it. After this
    > ath12k_core_soc_destroy()-&gt; ath12k_dp_free()-&gt; ath12k_dp_cc_cleanup()
    > tries to access one of the freed ar&#x27;s from pending skb.
    > This is because during mac destroy, driver failed to flush few
    > data packets, which were accessed later in ath12k_dp_cc_cleanup()
    > and freed, but using ar from the packet led to this use-after-free.
    > BUG: KASAN: use-after-free in ath12k_dp_cc_cleanup.part.0+0x5e2/0xd40 [ath12k]
    > Write of size 4 at addr ffff888150bd3514 by task modprobe/8926
    > CPU: 0 UID: 0 PID: 8926 Comm: modprobe Not tainted
    > 6.11.0-rc2-wt-ath+ #1746
    > Hardware name: Intel(R) Client Systems NUC8i7HVK/NUC8i7HVB, BIOS
    > HNKBLi70.86A.0067.2021.0528.1339 05/28/2021
    > Call Trace:
    > &lt;TASK&gt;
    > dump_stack_lvl+0x7d/0xe0
    > print_address_description.constprop.0+0x33/0x3a0
    > print_report+0xb5/0x260
    > ? kasan_addr_to_slab+0x24/0x80
    > kasan_report+0xd8/0x110
    > ? ath12k_dp_cc_cleanup.part.0+0x5e2/0xd40 [ath12k]
    > ? ath12k_dp_cc_cleanup.part.0+0x5e2/0xd40 [ath12k]
    > kasan_check_range+0xf3/0x1a0
    > __kasan_check_write+0x14/0x20
    > ath12k_dp_cc_cleanup.part.0+0x5e2/0xd40 [ath12k]
    > ath12k_dp_free+0x178/0x420 [ath12k]
    > ath12k_core_stop+0x176/0x200 [ath12k]
    > ath12k_core_deinit+0x13f/0x210 [ath12k]
    > ath12k_pci_remove+0xad/0x1c0 [ath12k]
    > pci_device_remove+0x9b/0x1b0
    > device_remove+0xbf/0x150
    > device_release_driver_internal+0x3c3/0x580
    > ? __kasan_check_read+0x11/0x20
    > driver_detach+0xc4/0x190
    > bus_remove_driver+0x130/0x2a0
    > driver_unregister+0x68/0x90
    > pci_unregister_driver+0x24/0x240
    > ? find_module_all+0x13e/0x1e0
    > ath12k_pci_exit+0x10/0x20 [ath12k]
    > __do_sys_delete_module+0x32c/0x580
    > ? module_flags+0x2f0/0x2f0
    > ? kmem_cache_free+0xf0/0x410
    > ? __fput+0x56f/0xab0
    > ? __fput+0x56f/0xab0
    > ? debug_smp_processor_id+0x17/0x20
    > __x64_sys_delete_module+0x4f/0x70
    > x64_sys_call+0x522/0x9f0
    > do_syscall_64+0x64/0x130
    > entry_SYSCALL_64_after_hwframe+0x4b/0x53
    > RIP: 0033:0x7f8182c6ac8b
    > Commit 24de1b7b231c (&quot;wifi: ath12k: fix flush failure in recovery
    > scenarios&quot;) added the change to decrement the pending packets count
    > in case of recovery which make sense as ah-&gt;hw as well all
    > ar&#x27;s in it are intact during recovery, but during core deinit there
    > is no use in decrementing packets count or waking up the empty waitq
    > as the module is going to be removed also ar&#x27;s from pending skb&#x27;s
    > can&#x27;t be used and the packets should just be released back.
    > To fix this, avoid accessing ar from skb-&gt;cb when driver is being
    > unregistered.
    > Tested-on: QCN9274 hw2.0 PCI WLAN.WBE.1.1.1-00214-QCAHKSWPL_SILICONZ-1
    > Tested-on: WCN7850 hw2.0 PCI WLAN.HMT.1.0.c5-00481-QCAHMTSWPL_V1.0_V2.0_SILICONZ-3
    > Fixes: 24de1b7b231c (&quot;wifi: ath12k: fix flush failure in recovery scenarios&quot;)
    > Signed-off-by: Rameshkumar Sundaram &lt;quic_ramess@quicinc.com&gt;
    > Acked-by: Jeff Johnson &lt;quic_jjohnson@quicinc.com&gt;
    > Link: https://patch.msgid.link/20241001092652.3134334-1-quic_ramess@quicinc.com
    > Signed-off-by: Jeff Johnson &lt;quic_jjohnson@quicinc.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ dlm: fix swapped args sb_flags vs sb_status (@Alexander Aring in [345942202ba0a06](https://github.com/sophgo/linux-riscv/commit/345942202ba0a06) at 2024-12-05 13:01:41)
    > [ Upstream commit 6d59f2fbfb18965f76ebcff40ab38da717cde798 ]
    > The arguments got swapped by commit 986ae3c2a8df (&quot;dlm: fix race between
    > final callback and remove&quot;) fixing this now.
    > Fixes: 986ae3c2a8df (&quot;dlm: fix race between final callback and remove&quot;)
    > Signed-off-by: Alexander Aring &lt;aahringo@redhat.com&gt;
    > Signed-off-by: David Teigland &lt;teigland@redhat.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ wifi: rtl8xxxu: Perform update_beacon_work when beaconing is enabled (@Martin Kaistra in [2aa9f94ad2b305d](https://github.com/sophgo/linux-riscv/commit/2aa9f94ad2b305d) at 2024-12-05 13:01:41)
    > [ Upstream commit d7063ed6758c62e00a2f56467ded85a021fac67a ]
    > In STA+AP concurrent mode, performing a scan operation on one vif
    > temporarily stops beacons on the other. When the scan is completed,
    > beacons are enabled again with BSS_CHANGED_BEACON_ENABLED.
    > We can observe that no beacons are being sent when just
    > rtl8xxxu_start_tx_beacon() is being called.
    > Thus, also perform update_beacon_work in order to restore beaconing.
    > Fixes: cde8848cad0b (&quot;wifi: rtl8xxxu: Add beacon functions&quot;)
    > Signed-off-by: Martin Kaistra &lt;martin.kaistra@linutronix.de&gt;
    > Signed-off-by: Ping-Ke Shih &lt;pkshih@realtek.com&gt;
    > Link: https://patch.msgid.link/20240930084955.455241-1-martin.kaistra@linutronix.de
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ASoC: amd: acp: fix for cpu dai index logic (@Vijendar Mukunda in [13231df707a70ab](https://github.com/sophgo/linux-riscv/commit/13231df707a70ab) at 2024-12-05 13:01:41)
    > [ Upstream commit 7ce8e4d380d68f34edc96c7efcf95b1476e7f033 ]
    > Multi link aggregation is not supported for acp6.3 platform.
    > Below combinations are supported.
    > - one sdw BE DAI &lt;---&gt; one-cpu DAI &lt;---&gt; one-codec DAI
    > - one sdw BE DAI  &lt;---&gt; one-cpu DAI &lt;---&gt; multi-codec DAIs
    > As Single cpu dai is going to be created, In create_sdw_dailink() function
    > cpu dai index won&#x27;t be incremented.
    > Refactor cpu dai index logic to fix below smatch static checker warning.
    > sound/soc/amd/acp/acp-sdw-sof-mach.c:157 create_sdw_dailink()
    > warn: iterator &#x27;i&#x27; not incremented.
    > Reported-by: Dan Carpenter &lt;dan.carpenter@linaro.org&gt;
    > Closes: https://lore.kernel.org/all/a201e871-375e-43eb-960d-5c048956c2ff@amd.com/T/
    > Fixes: 6d8348ddc56e (&quot;ASoC: amd: acp: refactor SoundWire machine driver code&quot;)
    > Signed-off-by: Vijendar Mukunda &lt;Vijendar.Mukunda@amd.com&gt;
    > Link: https://patch.msgid.link/20241007085321.3991149-3-Vijendar.Mukunda@amd.com
    > Signed-off-by: Mark Brown &lt;broonie@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ASoC: fsl-asoc-card: Add missing handling of {hp,mic}-dt-gpios (@Geert Uytterhoeven in [fb09049c51e4fc2](https://github.com/sophgo/linux-riscv/commit/fb09049c51e4fc2) at 2024-12-05 13:01:40)
    > [ Upstream commit cfd1054c65eefec30972416a83eb62920bc1ff8d ]
    > The DT bindings deprecated the &quot;hp-det-gpio&quot; and &quot;mic-det-gpio&quot;
    > properties in favor of &quot;hp-det-gpios&quot; and &quot;mic-det-gpios&quot;, but the
    > driver was never updated to support the latter.
    > Even before, there existed users of &quot;hp-det-gpios&quot; and &quot;mic-det-gpios&quot;.
    > While this may have been handled fine by the ASoC core, this was missed
    > by the Freescale-specific part.
    > Fixes: 4189b54220e5af15 (&quot;ASoC: dt-bindings: fsl-asoc-card: convert to YAML&quot;)
    > Fixes: 40ba2eda0a7b727f (&quot;arm64: dts: imx8mm-nitrogen-r2: add audio&quot;)
    > Signed-off-by: Geert Uytterhoeven &lt;geert+renesas@glider.be&gt;
    > Reviewed-by: Krzysztof Kozlowski &lt;krzk@kernel.org&gt;
    > Link: https://patch.msgid.link/dbcb5bfea005a468ec6dc38374fe6d02bc693c22.1727438777.git.geert+renesas@glider.be
    > Signed-off-by: Mark Brown &lt;broonie@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ libbpf: Fix output .symtab byte-order during linking (@Tony Ambardar in [d0125c0c83494f9](https://github.com/sophgo/linux-riscv/commit/d0125c0c83494f9) at 2024-12-05 13:01:40)
    > [ Upstream commit f896b4a5399e97af0b451fcf04754ed316935674 ]
    > Object linking output data uses the default ELF_T_BYTE type for &#x27;.symtab&#x27;
    > section data, which disables any libelf-based translation. Explicitly set
    > the ELF_T_SYM type for output to restore libelf&#x27;s byte-order conversion,
    > noting that input &#x27;.symtab&#x27; data is already correctly translated.
    > Fixes: faf6ed321cf6 (&quot;libbpf: Add BPF static linker APIs&quot;)
    > Signed-off-by: Tony Ambardar &lt;tony.ambardar@gmail.com&gt;
    > Signed-off-by: Andrii Nakryiko &lt;andrii@kernel.org&gt;
    > Link: https://lore.kernel.org/bpf/87868bfeccf3f51aec61260073f8778e9077050a.1726475448.git.tony.ambardar@gmail.com
    > Signed-off-by: Alexei Starovoitov &lt;ast@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/bridge: it6505: Drop EDID cache on bridge power off (@Pin-yen Lin in [aaf32aee8843e9b](https://github.com/sophgo/linux-riscv/commit/aaf32aee8843e9b) at 2024-12-05 13:01:40)
    > [ Upstream commit 574c558ddb68591c9a4b7a95e45e935ab22c0fc6 ]
    > The bridge might miss the display change events when it&#x27;s powered off.
    > This happens when a user changes the external monitor when the system
    > is suspended and the embedded controller doesn&#x27;t not wake AP up.
    > It&#x27;s also observed that one DP-to-HDMI bridge doesn&#x27;t work correctly
    > when there is no EDID read after it is powered on.
    > Drop the cache to force an EDID read after system resume to fix this.
    > Fixes: 11feaef69d0c (&quot;drm/bridge: it6505: Add caching for EDID&quot;)
    > Signed-off-by: Pin-yen Lin &lt;treapking@chromium.org&gt;
    > Reviewed-by: Dmitry Baryshkov &lt;dmitry.baryshkov@linaro.org&gt;
    > Reviewed-by: Douglas Anderson &lt;dianders@chromium.org&gt;
    > Signed-off-by: Douglas Anderson &lt;dianders@chromium.org&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20240926092931.3870342-3-treapking@chromium.org
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/amdgpu/gfx9: Add Cleaner Shader Deinitialization in gfx_v9_0 Module (@Srinivasan Shanmugam in [720c0376b3d29cb](https://github.com/sophgo/linux-riscv/commit/720c0376b3d29cb) at 2024-12-05 13:01:40)
    > [ Upstream commit e47cb9d2533200d49dd5364d4a148119492f8a3d ]
    > This commit addresses an omission in the previous patch related to the
    > cleaner shader support for GFX9 hardware. Specifically, it adds the
    > necessary deinitialization code for the cleaner shader in the
    > gfx_v9_0_sw_fini function.
    > The added line amdgpu_gfx_cleaner_shader_sw_fini(adev); ensures that any
    > allocated resources for the cleaner shader are freed correctly, avoiding
    > potential memory leaks and ensuring that the GPU state is clean for the
    > next initialization sequence.
    > Cc: Christian König &lt;christian.koenig@amd.com&gt;
    > Cc: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Fixes: c2e70d307f44 (&quot;drm/amdgpu/gfx9: Implement cleaner shader support for GFX9 hardware&quot;)
    > Signed-off-by: Srinivasan Shanmugam &lt;srinivasan.shanmugam@amd.com&gt;
    > Acked-by: Christian König &lt;christian.koenig@amd.com&gt;
    > Acked-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ selftests/bpf: Fix uprobe_multi compilation error (@Alan Maguire in [60d59c1e6ca547c](https://github.com/sophgo/linux-riscv/commit/60d59c1e6ca547c) at 2024-12-05 13:01:40)
    > [ Upstream commit c27d8235ba97139d7a085367ff57773902eb3fc5 ]
    > When building selftests, the following was seen:
    > uprobe_multi.c: In function ‘trigger_uprobe’:
    > uprobe_multi.c:108:40: error: ‘MADV_PAGEOUT’ undeclared (first use in this function)
    > 108 |                 madvise(addr, page_sz, MADV_PAGEOUT);
    > |                                        ^~~~~~~~~~~~
    > uprobe_multi.c:108:40: note: each undeclared identifier is reported only once for each function it appears in
    > make: *** [Makefile:850: bpf-next/tools/testing/selftests/bpf/uprobe_multi] Error 1
    > ...even with updated UAPI headers. It seems the above value is
    > defined in UAPI &lt;linux/mman.h&gt; but including that file triggers
    > other redefinition errors.  Simplest solution is to add a
    > guarded definition, as was done for MADV_POPULATE_READ.
    > Fixes: 3c217a182018 (&quot;selftests/bpf: add build ID tests&quot;)
    > Signed-off-by: Alan Maguire &lt;alan.maguire@oracle.com&gt;
    > Signed-off-by: Andrii Nakryiko &lt;andrii@kernel.org&gt;
    > Acked-by: Eduard Zingerman &lt;eddyz87@gmail.com&gt;
    > Link: https://lore.kernel.org/bpf/20240926144948.172090-1-alan.maguire@oracle.com
    > Signed-off-by: Alexei Starovoitov &lt;ast@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ libbpf: Fix expected_attach_type set handling in program load callback (@Tao Chen in [1c9e26b24f84254](https://github.com/sophgo/linux-riscv/commit/1c9e26b24f84254) at 2024-12-05 13:01:40)
    > [ Upstream commit a400d08b3014a4f4e939366bb6fd769b9caff4c9 ]
    > Referenced commit broke the logic of resetting expected_attach_type to
    > zero for allowed program types if kernel doesn&#x27;t yet support such field.
    > We do need to overwrite and preserve expected_attach_type for
    > multi-uprobe though, but that can be done explicitly in
    > libbpf_prepare_prog_load().
    > Fixes: 5902da6d8a52 (&quot;libbpf: Add uprobe multi link support to bpf_program__attach_usdt&quot;)
    > Suggested-by: Jiri Olsa &lt;jolsa@kernel.org&gt;
    > Signed-off-by: Tao Chen &lt;chen.dylane@gmail.com&gt;
    > Signed-off-by: Andrii Nakryiko &lt;andrii@kernel.org&gt;
    > Link: https://lore.kernel.org/bpf/20240925153012.212866-1-chen.dylane@gmail.com
    > Signed-off-by: Alexei Starovoitov &lt;ast@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/bridge: anx7625: Drop EDID cache on bridge power off (@Pin-yen Lin in [04973f051b82810](https://github.com/sophgo/linux-riscv/commit/04973f051b82810) at 2024-12-05 13:01:40)
    > [ Upstream commit 00ae002116a14c2e6a342c4c9ae080cdbb9b4b21 ]
    > The bridge might miss the display change events when it&#x27;s powered off.
    > This happens when a user changes the external monitor when the system
    > is suspended and the embedded controller doesn&#x27;t not wake AP up.
    > It&#x27;s also observed that one DP-to-HDMI bridge doesn&#x27;t work correctly
    > when there is no EDID read after it is powered on.
    > Drop the cache to force an EDID read after system resume to fix this.
    > Fixes: 8bdfc5dae4e3 (&quot;drm/bridge: anx7625: Add anx7625 MIPI DSI/DPI to DP&quot;)
    > Signed-off-by: Pin-yen Lin &lt;treapking@chromium.org&gt;
    > Reviewed-by: Dmitry Baryshkov &lt;dmitry.baryshkov@linaro.org&gt;
    > Reviewed-by: Douglas Anderson &lt;dianders@chromium.org&gt;
    > Signed-off-by: Douglas Anderson &lt;dianders@chromium.org&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20240926092931.3870342-2-treapking@chromium.org
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ wifi: ath10k: fix invalid VHT parameters in supported_vht_mcs_rate_nss2 (@Baochen Qiang in [f007119e1524bc9](https://github.com/sophgo/linux-riscv/commit/f007119e1524bc9) at 2024-12-05 13:01:39)
    > [ Upstream commit 52db16ec5bae7bd027804265b968259d1a6c3970 ]
    > In supported_vht_mcs_rate_nss2, the rate for MCS9 &amp; VHT20 is defined as
    > {1560, 1733}, this does not align with firmware&#x27;s definition and therefore
    > fails the verification in ath10k_mac_get_rate_flags_vht():
    > invalid vht params rate 1730 100kbps nss 2 mcs 9
    > and:
    > invalid vht params rate 1920 100kbps nss 2 mcs 9
    > Change it to {1730,  1920} to align with firmware to fix the issue.
    > Since ath10k_hw_params::supports_peer_stats_info is enabled only for
    > QCA6174, this change does not affect other chips.
    > Tested-on: QCA6174 hw3.2 PCI WLAN.RM.4.4.1-00309-QCARMSWPZ-1
    > Fixes: 3344b99d69ab (&quot;ath10k: add bitrate parse for peer stats info&quot;)
    > Reported-by: Paul Menzel &lt;pmenzel@molgen.mpg.de&gt;
    > Closes: https://lore.kernel.org/lkml/fba24cd3-4a1e-4072-8585-8402272788ff@molgen.mpg.de/
    > Signed-off-by: Baochen Qiang &lt;quic_bqiang@quicinc.com&gt;
    > Acked-by: Jeff Johnson &lt;quic_jjohnson@quicinc.com&gt;
    > Tested-by: Paul Menzel &lt;pmenzel@molgen.mpg.de&gt; # Dell XPS 13 9360
    > Signed-off-by: Kalle Valo &lt;quic_kvalo@quicinc.com&gt;
    > Link: https://patch.msgid.link/20240711020344.98040-3-quic_bqiang@quicinc.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ wifi: ath10k: fix invalid VHT parameters in supported_vht_mcs_rate_nss1 (@Baochen Qiang in [cc94c7e214d46bf](https://github.com/sophgo/linux-riscv/commit/cc94c7e214d46bf) at 2024-12-05 13:01:39)
    > [ Upstream commit d50886b27850447d90c0cd40c725238097909d1e ]
    > In supported_vht_mcs_rate_nss1, the rate for MCS9 &amp; VHT20 is defined as
    > {780,  867}, this does not align with firmware&#x27;s definition and therefore
    > fails the verification in ath10k_mac_get_rate_flags_vht():
    > invalid vht params rate 960 100kbps nss 1 mcs 9
    > Change it to {865,  960} to align with firmware, so this issue could be
    > fixed.
    > Since ath10k_hw_params::supports_peer_stats_info is enabled only for
    > QCA6174, this change does not affect other chips.
    > Tested-on: QCA6174 hw3.2 PCI WLAN.RM.4.4.1-00309-QCARMSWPZ-1
    > Fixes: 3344b99d69ab (&quot;ath10k: add bitrate parse for peer stats info&quot;)
    > Reported-by: Paul Menzel &lt;pmenzel@molgen.mpg.de&gt;
    > Closes: https://lore.kernel.org/lkml/fba24cd3-4a1e-4072-8585-8402272788ff@molgen.mpg.de/
    > Signed-off-by: Baochen Qiang &lt;quic_bqiang@quicinc.com&gt;
    > Acked-by: Jeff Johnson &lt;quic_jjohnson@quicinc.com&gt;
    > Signed-off-by: Kalle Valo &lt;quic_kvalo@quicinc.com&gt;
    > Link: https://patch.msgid.link/20240711020344.98040-2-quic_bqiang@quicinc.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ASoC: dt-bindings: mt6359: Update generic node name and dmic-mode (@Macpaul Lin in [b14bf849001e574](https://github.com/sophgo/linux-riscv/commit/b14bf849001e574) at 2024-12-05 13:01:39)
    > [ Upstream commit 4649cbd97fdae5069e9a71cd7669b62b90e03669 ]
    > Some fix and updates in the following items:
    > 1. examples:
    > Update generic node name to &#x27;audio-codec&#x27; to comply with the
    > coming change in &#x27;mt6359.dtsi&#x27;. This change is necessary to fix the
    > dtbs_check error:
    > pmic: &#x27;mt6359codec&#x27; does not match any of the regexes: &#x27;pinctrl-[0-9]+&#x27;
    > 2. mediatek,dmic-mode:
    > After inspecting the .dts and .dtsi files using &#x27;mt6359-codec&#x27;, it was
    > discovered that the definitions of &#x27;two wires&#x27; and &#x27;one wire&#x27; are
    > inverted compared to the DT schema.
    > For example, the following boards using MT6359 PMIC:
    > - mt8192-asurada.dtsi
    > - mt8195-cherry.dtsi
    > These boards use the same definitions of &#x27;dmic-mode&#x27; as other boards
    > using MT6358 PMIC. The meaning of &#x27;0&#x27; or &#x27;1&#x27; has been noted as comments
    > in the device trees.
    > Upon examining the code in [1] and [2], it was confirmed that the
    > definitions of &#x27;dmic-mode&#x27; are consistent between &quot;MT6359 PMIC&quot; and
    > &quot;MT6358 PMIC&quot;. Therefore, the DT Schema should be correct as is.
    > References:
    > [1] https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/sound/soc/codecs/mt6358.c#n1875
    > [2] https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/sound/soc/codecs/mt6359.c#L1515
    > Fixes: 539237d1c609 (&quot;dt-bindings: mediatek: mt6359: add codec document&quot;)
    > Signed-off-by: Jiaxin Yu &lt;jiaxin.yu@mediatek.com&gt;
    > Signed-off-by: Macpaul Lin &lt;macpaul.lin@mediatek.com&gt;
    > Reviewed-by: AngeloGioacchino Del Regno &lt;angelogioacchino.delregno@collabora.com&gt;
    > Link: https://patch.msgid.link/20240930075451.14196-1-macpaul.lin@mediatek.com
    > Signed-off-by: Mark Brown &lt;broonie@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ wifi: ath12k: Skip Rx TID cleanup for self peer (@Ramya Gnanasekar in [a052483d495a4dc](https://github.com/sophgo/linux-riscv/commit/a052483d495a4dc) at 2024-12-05 13:01:39)
    > [ Upstream commit 1a0c640ce1cdcde3eb131a0c1e70ca1ed7cf27cb ]
    > During peer create, dp setup for the peer is done where Rx TID is
    > updated for all the TIDs. Peer object for self peer will not go through
    > dp setup.
    > When core halts, dp cleanup is done for all the peers. While cleanup,
    > rx_tid::ab is accessed which causes below stack trace for self peer.
    > WARNING: CPU: 6 PID: 12297 at drivers/net/wireless/ath/ath12k/dp_rx.c:851
    > Call Trace:
    > __warn+0x7b/0x1a0
    > ath12k_dp_rx_frags_cleanup+0xd2/0xe0 [ath12k]
    > report_bug+0x10b/0x200
    > handle_bug+0x3f/0x70
    > exc_invalid_op+0x13/0x60
    > asm_exc_invalid_op+0x16/0x20
    > ath12k_dp_rx_frags_cleanup+0xd2/0xe0 [ath12k]
    > ath12k_dp_rx_frags_cleanup+0xca/0xe0 [ath12k]
    > ath12k_dp_rx_peer_tid_cleanup+0x39/0xa0 [ath12k]
    > ath12k_mac_peer_cleanup_all+0x61/0x100 [ath12k]
    > ath12k_core_halt+0x3b/0x100 [ath12k]
    > ath12k_core_reset+0x494/0x4c0 [ath12k]
    > sta object in peer will be updated when remote peer is created. Hence
    > use peer::sta to detect the self peer and skip the cleanup.
    > Tested-on: QCN9274 hw2.0 PCI WLAN.WBE.1.0.1-00029-QCAHKSWPL_SILICONZ-1
    > Tested-on: WCN7850 hw2.0 PCI WLAN.HMT.1.0.c5-00481-QCAHMTSWPL_V1.0_V2.0_SILICONZ-3
    > Fixes: d889913205cf (&quot;wifi: ath12k: driver for Qualcomm Wi-Fi 7 devices&quot;)
    > Signed-off-by: Ramya Gnanasekar &lt;quic_rgnanase@quicinc.com&gt;
    > Acked-by: Jeff Johnson &lt;quic_jjohnson@quicinc.com&gt;
    > Signed-off-by: Kalle Valo &lt;quic_kvalo@quicinc.com&gt;
    > Link: https://patch.msgid.link/20240905042851.2282306-1-quic_rgnanase@quicinc.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/amdgpu: Fix JPEG v4.0.3 register write (@Lijo Lazar in [7bfbf1a381d8fcb](https://github.com/sophgo/linux-riscv/commit/7bfbf1a381d8fcb) at 2024-12-05 13:01:39)
    > [ Upstream commit 8c50bf9beb889fd2bdcbf95b27a5d101eede51fc ]
    > EXTERNAL_REG_INTERNAL_OFFSET/EXTERNAL_REG_WRITE_ADDR should be used in
    > pairs. If an external register shouldn&#x27;t be written, both packets
    > shouldn&#x27;t be sent.
    > Fixes: a78b48146972 (&quot;drm/amdgpu: Skip PCTL0_MMHUB_DEEPSLEEP_IB write in jpegv4.0.3 under SRIOV&quot;)
    > Signed-off-by: Lijo Lazar &lt;lijo.lazar@amd.com&gt;
    > Acked-by: Leo Liu &lt;leo.liu@amd.com&gt;
    > Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ASoC: fsl_micfil: fix regmap_write_bits usage (@Shengjiu Wang in [3e404103265ed35](https://github.com/sophgo/linux-riscv/commit/3e404103265ed35) at 2024-12-05 13:01:39)
    > [ Upstream commit 06df673d20230afb0e383e39235a4fa8b9a62464 ]
    > The last parameter 1 means BIT(0), which should be the
    > correct BIT(X).
    > Fixes: 47a70e6fc9a8 (&quot;ASoC: Add MICFIL SoC Digital Audio Interface driver.&quot;)
    > Signed-off-by: Shengjiu Wang &lt;shengjiu.wang@nxp.com&gt;
    > Reviewed-by: Daniel Baluta &lt;daniel.baluta@nxp.com&gt;
    > Link: https://patch.msgid.link/1727424031-19551-2-git-send-email-shengjiu.wang@nxp.com
    > Signed-off-by: Mark Brown &lt;broonie@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ dt-bindings: vendor-prefixes: Add NeoFidelity, Inc (@Igor Prusov in [1dc5781cf53899b](https://github.com/sophgo/linux-riscv/commit/1dc5781cf53899b) at 2024-12-05 13:01:39)
    > [ Upstream commit 5d9e6d6fc1b98c8c22d110ee931b3b233d43cd13 ]
    > Add vendor prefix for NeoFidelity, Inc
    > Signed-off-by: Igor Prusov &lt;ivprusov@salutedevices.com&gt;
    > Acked-by: Krzysztof Kozlowski &lt;krzysztof.kozlowski@linaro.org&gt;
    > Link: https://patch.msgid.link/20240925-ntp-amps-8918-8835-v3-1-e2459a8191a6@salutedevices.com
    > Signed-off-by: Mark Brown &lt;broonie@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ udmabuf: fix vmap_udmabuf error page set (@Huan Yang in [f0e546e525a6aa9](https://github.com/sophgo/linux-riscv/commit/f0e546e525a6aa9) at 2024-12-05 13:01:38)
    > [ Upstream commit 18d7de823b7150344d242c3677e65d68c5271b04 ]
    > Currently vmap_udmabuf set page&#x27;s array by each folio.
    > But, ubuf-&gt;folios is only contain&#x27;s the folio&#x27;s head page.
    > That mean we repeatedly mapped the folio head page to the vmalloc area.
    > Due to udmabuf can use hugetlb, if HVO enabled, tail page may not exist,
    > so, we can&#x27;t use page array to map, instead, use pfn array.
    > By this, we removed page usage in udmabuf totally.
    > Fixes: 5e72b2b41a21 (&quot;udmabuf: convert udmabuf driver to use folios&quot;)
    > Suggested-by: Vivek Kasireddy &lt;vivek.kasireddy@intel.com&gt;
    > Signed-off-by: Huan Yang &lt;link@vivo.com&gt;
    > Acked-by: Vivek Kasireddy &lt;vivek.kasireddy@intel.com&gt;
    > Signed-off-by: Vivek Kasireddy &lt;vivek.kasireddy@intel.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20240918025238.2957823-4-link@vivo.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/v3d: Flush the MMU before we supply more memory to the binner (@Maíra Canal in [86ab3d85b227b60](https://github.com/sophgo/linux-riscv/commit/86ab3d85b227b60) at 2024-12-05 13:01:38)
    > [ Upstream commit d2fb8811108b2c1285c56f4fba4fff8fe3525593 ]
    > We must ensure that the MMU is flushed before we supply more memory to
    > the binner, otherwise we might end up with invalid MMU accesses by the
    > GPU.
    > Fixes: 57692c94dcbe (&quot;drm/v3d: Introduce a new DRM driver for Broadcom V3D V3.x+&quot;)
    > Signed-off-by: Maíra Canal &lt;mcanal@igalia.com&gt;
    > Reviewed-by: Iago Toral Quiroga &lt;itoral@igalia.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20240923141348.2422499-3-mcanal@igalia.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/imx/ipuv3: Use IRQF_NO_AUTOEN flag in request_irq() (@Jinjie Ruan in [7b720723e925b1c](https://github.com/sophgo/linux-riscv/commit/7b720723e925b1c) at 2024-12-05 13:01:38)
    > [ Upstream commit 40004709a3d3b07041a473a163ca911ef04ab8bd ]
    > disable_irq() after request_irq() still has a time gap in which
    > interrupts can come. request_irq() with IRQF_NO_AUTOEN flag will
    > disable IRQ auto-enable when request IRQ.
    > Fixes: 47b1be5c0f4e (&quot;staging: imx/drm: request irq only after adding the crtc&quot;)
    > Reviewed-by: Dmitry Baryshkov &lt;dmitry.baryshkov@linaro.org&gt;
    > Signed-off-by: Jinjie Ruan &lt;ruanjinjie@huawei.com&gt;
    > Reviewed-by: Philipp Zabel &lt;p.zabel@pengutronix.de&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20240912083020.3720233-4-ruanjinjie@huawei.com
    > Signed-off-by: Dmitry Baryshkov &lt;dmitry.baryshkov@linaro.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/imx/dcss: Use IRQF_NO_AUTOEN flag in request_irq() (@Jinjie Ruan in [58f40749783071a](https://github.com/sophgo/linux-riscv/commit/58f40749783071a) at 2024-12-05 13:01:38)
    > [ Upstream commit 1af01e14db7e0b45ae502d822776a58c86688763 ]
    > disable_irq() after request_irq() still has a time gap in which
    > interrupts can come. request_irq() with IRQF_NO_AUTOEN flag will
    > disable IRQ auto-enable when request IRQ.
    > Fixes: 9021c317b770 (&quot;drm/imx: Add initial support for DCSS on iMX8MQ&quot;)
    > Signed-off-by: Jinjie Ruan &lt;ruanjinjie@huawei.com&gt;
    > Reviewed-by: Laurentiu Palcu &lt;laurentiu.palcu@oss.nxp.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20240912083020.3720233-2-ruanjinjie@huawei.com
    > [DB: fixed the subject]
    > Signed-off-by: Dmitry Baryshkov &lt;dmitry.baryshkov@linaro.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/v3d: Address race-condition in MMU flush (@Maíra Canal in [482ac8a1c87fad1](https://github.com/sophgo/linux-riscv/commit/482ac8a1c87fad1) at 2024-12-05 13:01:38)
    > [ Upstream commit cf1becb7f996a0a23ea2c270cf6bb0911ec3ca1a ]
    > We must first flush the MMU cache and then, flush the TLB, not the other
    > way around. Currently, we can see a race condition between the MMU cache
    > and the TLB when running multiple rendering processes at the same time.
    > This is evidenced by MMU errors triggered by the IRQ.
    > Fix the MMU flush order by flushing the MMU cache and then the TLB.
    > Also, in order to address the race condition, wait for the MMU cache flush
    > to finish before starting the TLB flush.
    > Fixes: 57692c94dcbe (&quot;drm/v3d: Introduce a new DRM driver for Broadcom V3D V3.x+&quot;)
    > Signed-off-by: Maíra Canal &lt;mcanal@igalia.com&gt;
    > Reviewed-by: Iago Toral Quiroga &lt;itoral@igalia.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20240923141348.2422499-2-mcanal@igalia.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/panel: nt35510: Make new commands optional (@Linus Walleij in [1b6418c807ed342](https://github.com/sophgo/linux-riscv/commit/1b6418c807ed342) at 2024-12-05 13:01:38)
    > [ Upstream commit 2418aa8516b26c5e332a1a8c216d4d620f965a56 ]
    > The commit introducing the Frida display started to write the
    > SETVCMOFF registers unconditionally, and some (not all!) Hydis
    > display seem to be affected by ghosting after the commit.
    > Make SETVCMOFF optional and only send these commands on the
    > Frida display for now.
    > Reported-by: Stefan Hansson &lt;newbyte@postmarketos.org&gt;
    > Fixes: 219a1f49094f (&quot;drm/panel: nt35510: support FRIDA FRD400B25025-A-CTK&quot;)
    > Acked-by: Jessica Zhang &lt;quic_jesszhan@quicinc.com&gt;
    > Tested-by: Stefan Hansson &lt;newbyte@postmarketos.org&gt;
    > Signed-off-by: Linus Walleij &lt;linus.walleij@linaro.org&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20240908-fix-nt35510-v2-1-d4834b9cdb9b@linaro.org
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/omap: Fix locking in omap_gem_new_dmabuf() (@Tomi Valkeinen in [fd8488e27120780](https://github.com/sophgo/linux-riscv/commit/fd8488e27120780) at 2024-12-05 13:01:37)
    > [ Upstream commit e6a1c4037227539373c8cf484ace83833e2ad6a2 ]
    > omap_gem_new_dmabuf() creates the new gem object, and then takes and
    > holds the omap_obj-&gt;lock for the rest of the function. This has two
    > issues:
    > - omap_gem_free_object(), which is called in the error paths, also takes
    > the same lock, leading to deadlock
    > - Even if the above wouldn&#x27;t happen, in the error cases
    > omap_gem_new_dmabuf() still unlocks omap_obj-&gt;lock, even after the
    > omap_obj has already been freed.
    > Furthermore, I don&#x27;t think there&#x27;s any reason to take the lock at all,
    > as the object was just created and not yet shared with anyone else.
    > To fix all this, drop taking the lock.
    > Fixes: 3cbd0c587b12 (&quot;drm/omap: gem: Replace struct_mutex usage with omap_obj private lock&quot;)
    > Reported-by: Dan Carpenter &lt;dan.carpenter@linaro.org&gt;
    > Closes: https://lore.kernel.org/all/511b99d7-aade-4f92-bd3e-63163a13d617@stanley.mountain/
    > Reviewed-by: Sebastian Reichel &lt;sebastian.reichel@collabora.com&gt;
    > Signed-off-by: Tomi Valkeinen &lt;tomi.valkeinen@ideasonboard.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20240806-omapdrm-misc-fixes-v1-3-15d31aea0831@ideasonboard.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/v3d: Appease lockdep while updating GPU stats (@Tvrtko Ursulin in [ec6de20f2e7e899](https://github.com/sophgo/linux-riscv/commit/ec6de20f2e7e899) at 2024-12-05 13:01:37)
    > [ Upstream commit 06c3c406850e5495bb56ccf624d0c9477e1ba901 ]
    > Lockdep thinks our seqcount_t usage is unsafe because the update path can
    > be both from irq and worker context:
    > [ ] &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;
    > [ ] WARNING: inconsistent lock state
    > [ ] 6.10.3-v8-16k-numa #159 Tainted: G        WC
    > [ ] --------------------------------
    > [ ] inconsistent {HARDIRQ-ON-W} -&gt; {IN-HARDIRQ-W} usage.
    > [ ] swapper/0/0 [HC1[1]:SC0[0]:HE0:SE1] takes:
    > [ ] ffff80003d7c08d0 (&amp;v3d_priv-&gt;stats[i].lock){?.+.}-{0:0}, at: v3d_irq+0xc8/0x660 [v3d]
    > [ ] {HARDIRQ-ON-W} state was registered at:
    > [ ]   lock_acquire+0x1f8/0x328
    > [ ]   v3d_job_start_stats.isra.0+0xd8/0x218 [v3d]
    > [ ]   v3d_bin_job_run+0x23c/0x388 [v3d]
    > [ ]   drm_sched_run_job_work+0x520/0x6d0 [gpu_sched]
    > [ ]   process_one_work+0x62c/0xb48
    > [ ]   worker_thread+0x468/0x5b0
    > [ ]   kthread+0x1c4/0x1e0
    > [ ]   ret_from_fork+0x10/0x20
    > [ ] irq event stamp: 337094
    > [ ] hardirqs last  enabled at (337093): [&lt;ffffc0008144ce7c&gt;] default_idle_call+0x11c/0x140
    > [ ] hardirqs last disabled at (337094): [&lt;ffffc0008144a354&gt;] el1_interrupt+0x24/0x58
    > [ ] softirqs last  enabled at (337082): [&lt;ffffc00080061d90&gt;] handle_softirqs+0x4e0/0x538
    > [ ] softirqs last disabled at (337073): [&lt;ffffc00080010364&gt;] __do_softirq+0x1c/0x28
    > [ ]
    > other info that might help us debug this:
    > [ ]  Possible unsafe locking scenario:
    > [ ]        CPU0
    > [ ]        ----
    > [ ]   lock(&amp;v3d_priv-&gt;stats[i].lock);
    > [ ]   &lt;Interrupt&gt;
    > [ ]     lock(&amp;v3d_priv-&gt;stats[i].lock);
    > [ ]
    > ** DEADLOCK ***
    > [ ] no locks held by swapper/0/0.
    > [ ]
    > stack backtrace:
    > [ ] CPU: 0 PID: 0 Comm: swapper/0 Tainted: G        WC         6.10.3-v8-16k-numa #159
    > [ ] Hardware name: Raspberry Pi 5 Model B Rev 1.0 (DT)
    > [ ] Call trace:
    > [ ]  dump_backtrace+0x170/0x1b8
    > [ ]  show_stack+0x20/0x38
    > [ ]  dump_stack_lvl+0xb4/0xd0
    > [ ]  dump_stack+0x18/0x28
    > [ ]  print_usage_bug+0x3cc/0x3f0
    > [ ]  mark_lock+0x4d0/0x968
    > [ ]  __lock_acquire+0x784/0x18c8
    > [ ]  lock_acquire+0x1f8/0x328
    > [ ]  v3d_job_update_stats+0xec/0x2e0 [v3d]
    > [ ]  v3d_irq+0xc8/0x660 [v3d]
    > [ ]  __handle_irq_event_percpu+0x1f8/0x488
    > [ ]  handle_irq_event+0x88/0x128
    > [ ]  handle_fasteoi_irq+0x298/0x408
    > [ ]  generic_handle_domain_irq+0x50/0x78
    > But it is a false positive because all the queue-stats pairs have their
    > own lock and jobs are also one at a time.
    > Nevertheless we can appease lockdep by disabling local interrupts to make
    > it see lock usage is consistent.
    > Cc: Maíra Canal &lt;mcanal@igalia.com&gt;
    > Fixes: 6abe93b621ab (&quot;drm/v3d: Fix race-condition between sysfs/fdinfo and interrupt handler&quot;)
    > Signed-off-by: Tvrtko Ursulin &lt;tvrtko.ursulin@igalia.com&gt;
    > Signed-off-by: Maíra Canal &lt;mcanal@igalia.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20240813102505.80512-2-tursulin@igalia.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/omap: Fix possible NULL dereference (@Tomi Valkeinen in [dfb49eabedc21bb](https://github.com/sophgo/linux-riscv/commit/dfb49eabedc21bb) at 2024-12-05 13:01:37)
    > [ Upstream commit a88fee2d67d9b78c24630a987a88ccf886b2498b ]
    > smatch reports:
    > drivers/gpu/drm/omapdrm/dss/base.c:176 omapdss_device_disconnect() error: we previously assumed &#x27;src&#x27; could be null (see line 169)
    > This code is mostly from a time when omapdrm had its own display device
    > model. I can&#x27;t honestly remember the details, and I don&#x27;t think it&#x27;s
    > worth digging in deeply into that for a legacy driver.
    > However, it looks like we only call omapdss_device_disconnect() and
    > omapdss_device_connect() with NULL as the src parameter. We can thus
    > drop the src parameter from both functions, and fix the smatch warning.
    > I don&#x27;t think omapdss_device_disconnect() ever gets NULL for the dst
    > parameter (if it did, we&#x27;d crash soon after returning from the
    > function), but I have kept the !dst check, just in case, but I added a
    > WARN_ON() there.
    > Also, if the dst parameter can be NULL, we can&#x27;t always get the struct
    > dss_device pointer from dst-&gt;dss (which is only used for a debug print).
    > To make sure we can&#x27;t hit that issue, do it similarly to the
    > omapdss_device_connect() function: add &#x27;struct dss_device *dss&#x27; as the
    > first parameter, so that we always have it regardless of the dst.
    > Fixes: 79107f274b2f (&quot;drm/omap: Add support for drm_bridge&quot;)
    > Reviewed-by: Sebastian Reichel &lt;sebastian.reichel@collabora.com&gt;
    > Signed-off-by: Tomi Valkeinen &lt;tomi.valkeinen@ideasonboard.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20240806-omapdrm-misc-fixes-v1-1-15d31aea0831@ideasonboard.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ wifi: ath9k: add range check for conn_rsp_epid in htc_connect_service() (@Jeongjun Park in [bc981179ab5d1a2](https://github.com/sophgo/linux-riscv/commit/bc981179ab5d1a2) at 2024-12-05 13:01:37)
    > [ Upstream commit 8619593634cbdf5abf43f5714df49b04e4ef09ab ]
    > I found the following bug in my fuzzer:
    > UBSAN: array-index-out-of-bounds in drivers/net/wireless/ath/ath9k/htc_hst.c:26:51
    > index 255 is out of range for type &#x27;htc_endpoint [22]&#x27;
    > CPU: 0 UID: 0 PID: 8 Comm: kworker/0:0 Not tainted 6.11.0-rc6-dirty #14
    > Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
    > Workqueue: events request_firmware_work_func
    > Call Trace:
    > &lt;TASK&gt;
    > dump_stack_lvl+0x180/0x1b0
    > __ubsan_handle_out_of_bounds+0xd4/0x130
    > htc_issue_send.constprop.0+0x20c/0x230
    > ? _raw_spin_unlock_irqrestore+0x3c/0x70
    > ath9k_wmi_cmd+0x41d/0x610
    > ? mark_held_locks+0x9f/0xe0
    > ...
    > Since this bug has been confirmed to be caused by insufficient verification
    > of conn_rsp_epid, I think it would be appropriate to add a range check for
    > conn_rsp_epid to htc_connect_service() to prevent the bug from occurring.
    > Fixes: fb9987d0f748 (&quot;ath9k_htc: Support for AR9271 chipset.&quot;)
    > Signed-off-by: Jeongjun Park &lt;aha310510@gmail.com&gt;
    > Acked-by: Toke Høiland-Jørgensen &lt;toke@toke.dk&gt;
    > Signed-off-by: Kalle Valo &lt;quic_kvalo@quicinc.com&gt;
    > Link: https://patch.msgid.link/20240909103855.68006-1-aha310510@gmail.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ wifi: mwifiex: Use IRQF_NO_AUTOEN flag in request_irq() (@Jinjie Ruan in [aded1c7748791a9](https://github.com/sophgo/linux-riscv/commit/aded1c7748791a9) at 2024-12-05 13:01:37)
    > [ Upstream commit 9a98dd48b6d834d7a3fe5e8e7b8c3a1d006f9685 ]
    > disable_irq() after request_irq() still has a time gap in which
    > interrupts can come. request_irq() with IRQF_NO_AUTOEN flag will
    > disable IRQ auto-enable when request IRQ.
    > Fixes: 853402a00823 (&quot;mwifiex: Enable WoWLAN for both sdio and pcie&quot;)
    > Signed-off-by: Jinjie Ruan &lt;ruanjinjie@huawei.com&gt;
    > Acked-by: Brian Norris &lt;briannorris@chromium.org&gt;
    > Signed-off-by: Kalle Valo &lt;kvalo@kernel.org&gt;
    > Link: https://patch.msgid.link/20240910124314.698896-3-ruanjinjie@huawei.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ udmabuf: change folios array from kmalloc to kvmalloc (@Huan Yang in [85bb72397cb6364](https://github.com/sophgo/linux-riscv/commit/85bb72397cb6364) at 2024-12-05 13:01:37)
    > [ Upstream commit 1c0844c6184e658064e14c4335885785ad3bf84b ]
    > When PAGE_SIZE 4096, MAX_PAGE_ORDER 10, 64bit machine,
    > page_alloc only support 4MB.
    > If above this, trigger this warn and return NULL.
    > udmabuf can change size limit, if change it to 3072(3GB), and then alloc
    > 3GB udmabuf, will fail create.
    > [ 4080.876581] ------------[ cut here ]------------
    > [ 4080.876843] WARNING: CPU: 3 PID: 2015 at mm/page_alloc.c:4556 __alloc_pages+0x2c8/0x350
    > [ 4080.878839] RIP: 0010:__alloc_pages+0x2c8/0x350
    > [ 4080.879470] Call Trace:
    > [ 4080.879473]  &lt;TASK&gt;
    > [ 4080.879473]  ? __alloc_pages+0x2c8/0x350
    > [ 4080.879475]  ? __warn.cold+0x8e/0xe8
    > [ 4080.880647]  ? __alloc_pages+0x2c8/0x350
    > [ 4080.880909]  ? report_bug+0xff/0x140
    > [ 4080.881175]  ? handle_bug+0x3c/0x80
    > [ 4080.881556]  ? exc_invalid_op+0x17/0x70
    > [ 4080.881559]  ? asm_exc_invalid_op+0x1a/0x20
    > [ 4080.882077]  ? udmabuf_create+0x131/0x400
    > Because MAX_PAGE_ORDER, kmalloc can max alloc 4096 * (1 &lt;&lt; 10), 4MB
    > memory, each array entry is pointer(8byte), so can save 524288 pages(2GB).
    > Further more, costly order(order 3) may not be guaranteed that it can be
    > applied for, due to fragmentation.
    > This patch change udmabuf array use kvmalloc_array, this can fallback
    > alloc into vmalloc, which can guarantee allocation for any size and does
    > not affect the performance of kmalloc allocations.
    > Signed-off-by: Huan Yang &lt;link@vivo.com&gt;
    > Acked-by: Christian König &lt;christian.koenig@amd.com&gt;
    > Acked-by: Vivek Kasireddy &lt;vivek.kasireddy@intel.com&gt;
    > Signed-off-by: Vivek Kasireddy &lt;vivek.kasireddy@intel.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20240918025238.2957823-3-link@vivo.com
    > Stable-dep-of: 18d7de823b71 (&quot;udmabuf: fix vmap_udmabuf error page set&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ wifi: p54: Use IRQF_NO_AUTOEN flag in request_irq() (@Jinjie Ruan in [5051b6447d2343b](https://github.com/sophgo/linux-riscv/commit/5051b6447d2343b) at 2024-12-05 13:01:37)
    > [ Upstream commit bcd1371bd85e560ccc9159b7747f94bfe43b77a6 ]
    > disable_irq() after request_irq() still has a time gap in which
    > interrupts can come. request_irq() with IRQF_NO_AUTOEN flag will
    > disable IRQ auto-enable when request IRQ.
    > Fixes: cd8d3d321285 (&quot;p54spi: p54spi driver&quot;)
    > Signed-off-by: Jinjie Ruan &lt;ruanjinjie@huawei.com&gt;
    > Signed-off-by: Kalle Valo &lt;kvalo@kernel.org&gt;
    > Link: https://patch.msgid.link/20240910124314.698896-2-ruanjinjie@huawei.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/mm: Mark drm_mm_interval_tree*() functions with __maybe_unused (@Andy Shevchenko in [f9aaa841ac1d036](https://github.com/sophgo/linux-riscv/commit/f9aaa841ac1d036) at 2024-12-05 13:01:36)
    > [ Upstream commit 53bd7c1c0077db533472ae32799157758302ef48 ]
    > The INTERVAL_TREE_DEFINE() uncoditionally provides a bunch of helper
    > functions which in some cases may be not used. This, in particular,
    > prevents kernel builds with clang, &#x60;make W&#x3D;1&#x60; and CONFIG_WERROR&#x3D;y:
    > .../drm/drm_mm.c:152:1: error: unused function &#x27;drm_mm_interval_tree_insert&#x27; [-Werror,-Wunused-function]
    > 152 | INTERVAL_TREE_DEFINE(struct drm_mm_node, rb,
    > | ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    > 153 |                      u64, __subtree_last,
    > |                      ~~~~~~~~~~~~~~~~~~~~
    > 154 |                      START, LAST, static inline, drm_mm_interval_tree)
    > |                      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    > Fix this by marking drm_mm_interval_tree*() functions with __maybe_unused.
    > See also commit 6863f5643dd7 (&quot;kbuild: allow Clang to find unused static
    > inline functions for W&#x3D;1 build&quot;).
    > Fixes: 202b52b7fbf7 (&quot;drm: Track drm_mm nodes with an interval tree&quot;)
    > Signed-off-by: Andy Shevchenko &lt;andriy.shevchenko@linux.intel.com&gt;
    > Reviewed-by: Jani Nikula &lt;jani.nikula@intel.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20240829154640.1120050-1-andriy.shevchenko@linux.intel.com
    > Signed-off-by: Jani Nikula &lt;jani.nikula@intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/vc4: hvs: Fix dlist debug not resetting the next entry pointer (@Dave Stevenson in [ea2363251dc5476](https://github.com/sophgo/linux-riscv/commit/ea2363251dc5476) at 2024-12-05 13:01:36)
    > [ Upstream commit 6d5f76e0544b04ec5bdd2a09c19d90aeeb2cd479 ]
    > The debug function to display the dlists didn&#x27;t reset next_entry_start
    > when starting each display, so resulting in not stopping the
    > list at the correct place.
    > Fixes: c6dac00340fc (&quot;drm/vc4: hvs: Add debugfs node that dumps the current display lists&quot;)
    > Reviewed-by: Maxime Ripard &lt;mripard@kernel.org&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20240621152055.4180873-18-dave.stevenson@raspberrypi.com
    > Signed-off-by: Dave Stevenson &lt;dave.stevenson@raspberrypi.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/vc4: hvs: Remove incorrect limit from hvs_dlist debugfs function (@Dave Stevenson in [e9e836ddad74fe4](https://github.com/sophgo/linux-riscv/commit/e9e836ddad74fe4) at 2024-12-05 13:01:36)
    > [ Upstream commit d285bb622ebdfaa84f51df3a1abccb87036157ea ]
    > The debugfs function to dump dlists aborted at 256 bytes,
    > when actually the dlist memory is generally significantly
    > larger but varies based on SoC.
    > We already have the correct limit in __vc4_hvs_alloc, so
    > store it for use in the debugfs dlist function.
    > Fixes: c6dac00340fc (&quot;drm/vc4: hvs: Add debugfs node that dumps the current display lists&quot;)
    > Reviewed-by: Maxime Ripard &lt;mripard@kernel.org&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20240621152055.4180873-19-dave.stevenson@raspberrypi.com
    > Signed-off-by: Dave Stevenson &lt;dave.stevenson@raspberrypi.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/vc4: hvs: Correct logic on stopping an HVS channel (@Dave Stevenson in [c68b874c06249f2](https://github.com/sophgo/linux-riscv/commit/c68b874c06249f2) at 2024-12-05 13:01:36)
    > [ Upstream commit 7ab6512e7942889c0962588355cb92424a690be6 ]
    > When factoring out __vc4_hvs_stop_channel, the logic got inverted from
    > if (condition)
    > // stop channel
    > to
    > if (condition)
    > goto out
    > //stop channel
    > out:
    > and also changed the exact register writes used to stop the channel.
    > Correct the logic so that the channel is actually stopped, and revert
    > to the original register writes.
    > Fixes: 6d01a106b4c8 (&quot;drm/vc4: crtc: Move HVS init and close to a function&quot;)
    > Reviewed-by: Maxime Ripard &lt;mripard@kernel.org&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20240621152055.4180873-32-dave.stevenson@raspberrypi.com
    > Signed-off-by: Dave Stevenson &lt;dave.stevenson@raspberrypi.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/vc4: hvs: Don&#x27;t write gamma luts on 2711 (@Dave Stevenson in [8d4cd940d592455](https://github.com/sophgo/linux-riscv/commit/8d4cd940d592455) at 2024-12-05 13:01:36)
    > [ Upstream commit 52efe364d1968ee3e3ed45eb44eb924b63635315 ]
    > The gamma block has changed in 2711, therefore writing the lut
    > in vc4_hvs_lut_load is incorrect.
    > Whilst the gamma property isn&#x27;t created for 2711, it is called
    > from vc4_hvs_init_channel, so abort if attempted.
    > Fixes: c54619b0bfb3 (&quot;drm/vc4: Add support for the BCM2711 HVS5&quot;)
    > Reviewed-by: Maxime Ripard &lt;mripard@kernel.org&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20240621152055.4180873-15-dave.stevenson@raspberrypi.com
    > Signed-off-by: Dave Stevenson &lt;dave.stevenson@raspberrypi.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/vc4: hdmi: Avoid hang with debug registers when suspended (@Dom Cobley in [74f21be9990a42d](https://github.com/sophgo/linux-riscv/commit/74f21be9990a42d) at 2024-12-05 13:01:36)
    > [ Upstream commit 223ee2567a55e4f80315c768d2969e6a3b9fb23d ]
    > Trying to read /sys/kernel/debug/dri/1/hdmi1_regs
    > when the hdmi is disconnected results in a fatal system hang.
    > This is due to the pm suspend code disabling the dvp clock.
    > That is just a gate of the 108MHz clock in DVP_HT_RPI_MISC_CONFIG,
    > which results in accesses hanging AXI bus.
    > Protect against this.
    > Fixes: 25eb441d55d4 (&quot;drm/vc4: hdmi: Add all the vc5 HDMI registers into the debugfs dumps&quot;)
    > Signed-off-by: Dom Cobley &lt;popcornmix@gmail.com&gt;
    > Reviewed-by: Maxime Ripard &lt;mripard@kernel.org&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20240621152055.4180873-17-dave.stevenson@raspberrypi.com
    > Signed-off-by: Dave Stevenson &lt;dave.stevenson@raspberrypi.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/imagination: Use pvr_vm_context_get() (@Matt Coster in [54b2f90ad1f519e](https://github.com/sophgo/linux-riscv/commit/54b2f90ad1f519e) at 2024-12-05 13:01:36)
    > [ Upstream commit eb4accc5234525e2cb2b720187ccaf6db99b705f ]
    > I missed this open-coded kref_get() while trying to debug a refcount
    > bug, so let&#x27;s use the helper function here to avoid that waste of time
    > again in the future.
    > Fixes: ff5f643de0bf (&quot;drm/imagination: Add GEM and VM related code&quot;)
    > Reviewed-by: Frank Binns &lt;frank.binns@imgtec.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/8616641d-6005-4b25-bc0a-0b53985a0e08@imgtec.com
    > Signed-off-by: Matt Coster &lt;matt.coster@imgtec.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/imagination: Convert to use time_before macro (@Chen Yufan in [d968f2c052f46f6](https://github.com/sophgo/linux-riscv/commit/d968f2c052f46f6) at 2024-12-05 13:01:35)
    > [ Upstream commit 7a5115ba1d691bd14db91d2fcc3ce0b056574ce9 ]
    > Use time_*() macros instead of using jiffies directly to handle overflow
    > issues.
    > Fixes: cc1aeedb98ad (&quot;drm/imagination: Implement firmware infrastructure and META FW support&quot;)
    > Signed-off-by: Chen Yufan &lt;chenyufan@vivo.com&gt;
    > Reviewed-by: Matt Coster &lt;matt.coster@imgtec.com&gt;
    > Link: https://patchwork.freedesktop.org/patch/msgid/20240823093925.9599-1-chenyufan@vivo.com
    > Signed-off-by: Matt Coster &lt;matt.coster@imgtec.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ arm64: dts: rockchip: correct analog audio name on Indiedroid Nova (@Chris Morgan in [d14e16fccd82b12](https://github.com/sophgo/linux-riscv/commit/d14e16fccd82b12) at 2024-12-05 13:01:35)
    > [ Upstream commit 42d85557527266804579bc5d20c101d93f6be3c6 ]
    > Correct the audio name for the Indiedroid Nova from
    > rockchip,es8388-codec to rockchip,es8388. This name change corrects a
    > kernel log error of &quot;ASoC: driver name too long &#x27;rockchip,es8388-codec&#x27;
    > -&gt; &#x27;rockchip_es8388&#x27;&quot;.
    > Fixes: 3900160e164b (&quot;arm64: dts: rockchip: Add Indiedroid Nova board&quot;)
    > Signed-off-by: Chris Morgan &lt;macromorgan@hotmail.com&gt;
    > Link: https://lore.kernel.org/r/20241031150505.967909-2-macroalpha82@gmail.com
    > Signed-off-by: Heiko Stuebner &lt;heiko@sntech.de&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ platform/x86: panasonic-laptop: Return errno correctly in show callback (@Yao Zi in [b52718d0d30cb6a](https://github.com/sophgo/linux-riscv/commit/b52718d0d30cb6a) at 2024-12-05 13:01:35)
    > [ Upstream commit 5c7bebc1a3f0661db558d60e14dde27fc216d9dc ]
    > When an error occurs in sysfs show callback, we should return the errno
    > directly instead of formatting it as the result, which produces
    > meaningless output and doesn&#x27;t inform the userspace of the error.
    > Fixes: 468f96bfa3a0 (&quot;platform/x86: panasonic-laptop: Add support for battery charging threshold (eco mode)&quot;)
    > Fixes: d5a81d8e864b (&quot;platform/x86: panasonic-laptop: Add support for optical driver power in Y and W series&quot;)
    > Signed-off-by: Yao Zi &lt;ziyao@disroot.org&gt;
    > Reviewed-by: Hans de Goede &lt;hdegoede@redhat.com&gt;
    > Link: https://lore.kernel.org/r/20241118064637.61832-3-ziyao@disroot.org
    > Reviewed-by: Ilpo Järvinen &lt;ilpo.jarvinen@linux.intel.com&gt;
    > Signed-off-by: Ilpo Järvinen &lt;ilpo.jarvinen@linux.intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ sched_ext: scx_bpf_dispatch_from_dsq_set_*() are allowed from unlocked context (@Tejun Heo in [acf588f9b6fb560](https://github.com/sophgo/linux-riscv/commit/acf588f9b6fb560) at 2024-12-05 13:01:35)
    > [ Upstream commit 72b85bf6a7f6f6c38c39a1e5b04bc1da1bf5016e ]
    > 4c30f5ce4f7a (&quot;sched_ext: Implement scx_bpf_dispatch[_vtime]_from_dsq()&quot;)
    > added four kfuncs for dispatching while iterating. They are allowed from the
    > dispatch and unlocked contexts but two of the kfuncs were only added in the
    > dispatch section. Add missing declarations in the unlocked section.
    > Signed-off-by: Tejun Heo &lt;tj@kernel.org&gt;
    > Fixes: 4c30f5ce4f7a (&quot;sched_ext: Implement scx_bpf_dispatch[_vtime]_from_dsq()&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ platform/x86/intel/pmt: allow user offset for PMT callbacks (@Michael J. Ruhl in [73521f185552376](https://github.com/sophgo/linux-riscv/commit/73521f185552376) at 2024-12-05 13:01:35)
    > [ Upstream commit 0c32840763b1579c923b4216c18bb756ca4ba473 ]
    > Usage of the telem sysfs file allows for partial reads at an offset.
    > The current callback method returns the buffer starting from offset 0
    > only.
    > Include the requested offset in the callback and update the necessary
    > address calculations with the offset.
    > Note: offset addition is moved from the caller to the local usage. For
    > non-callback usage this is unchanged behavior.
    > Fixes: e92affc74cd8 (&quot;platform/x86/intel/vsec: Add PMT read callbacks&quot;)
    > Reviewed-by: Andy Shevchenko &lt;andriy.shevchenko@linux.intel.com&gt;
    > Signed-off-by: Michael J. Ruhl &lt;michael.j.ruhl@intel.com&gt;
    > Link: https://lore.kernel.org/r/20241114130358.2467787-2-michael.j.ruhl@intel.com
    > Reviewed-by: Ilpo Järvinen &lt;ilpo.jarvinen@linux.intel.com&gt;
    > Signed-off-by: Ilpo Järvinen &lt;ilpo.jarvinen@linux.intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ HID: hyperv: streamline driver probe to avoid devres issues (@Vitaly Kuznetsov in [3d48d0fbaaa74a0](https://github.com/sophgo/linux-riscv/commit/3d48d0fbaaa74a0) at 2024-12-05 13:01:35)
    > [ Upstream commit 66ef47faa90d838cda131fe1f7776456cc3b59f2 ]
    > It was found that unloading &#x27;hid_hyperv&#x27; module results in a devres
    > complaint:
    > ...
    > hv_vmbus: unregistering driver hid_hyperv
    > ------------[ cut here ]------------
    > WARNING: CPU: 2 PID: 3983 at drivers/base/devres.c:691 devres_release_group+0x1f2/0x2c0
    > ...
    > Call Trace:
    > &lt;TASK&gt;
    > ? devres_release_group+0x1f2/0x2c0
    > ? __warn+0xd1/0x1c0
    > ? devres_release_group+0x1f2/0x2c0
    > ? report_bug+0x32a/0x3c0
    > ? handle_bug+0x53/0xa0
    > ? exc_invalid_op+0x18/0x50
    > ? asm_exc_invalid_op+0x1a/0x20
    > ? devres_release_group+0x1f2/0x2c0
    > ? devres_release_group+0x90/0x2c0
    > ? rcu_is_watching+0x15/0xb0
    > ? __pfx_devres_release_group+0x10/0x10
    > hid_device_remove+0xf5/0x220
    > device_release_driver_internal+0x371/0x540
    > ? klist_put+0xf3/0x170
    > bus_remove_device+0x1f1/0x3f0
    > device_del+0x33f/0x8c0
    > ? __pfx_device_del+0x10/0x10
    > ? cleanup_srcu_struct+0x337/0x500
    > hid_destroy_device+0xc8/0x130
    > mousevsc_remove+0xd2/0x1d0 [hid_hyperv]
    > device_release_driver_internal+0x371/0x540
    > driver_detach+0xc5/0x180
    > bus_remove_driver+0x11e/0x2a0
    > ? __mutex_unlock_slowpath+0x160/0x5e0
    > vmbus_driver_unregister+0x62/0x2b0 [hv_vmbus]
    > ...
    > And the issue seems to be that the corresponding devres group is not
    > allocated. Normally, devres_open_group() is called from
    > __hid_device_probe() but Hyper-V HID driver overrides &#x27;hid_dev-&gt;driver&#x27;
    > with &#x27;mousevsc_hid_driver&#x27; stub and basically re-implements
    > __hid_device_probe() by calling hid_parse() and hid_hw_start() but not
    > devres_open_group(). hid_device_probe() does not call __hid_device_probe()
    > for it. Later, when the driver is removed, hid_device_remove() calls
    > devres_release_group() as it doesn&#x27;t check whether hdev-&gt;driver was
    > initially overridden or not.
    > The issue seems to be related to the commit 62c68e7cee33 (&quot;HID: ensure
    > timely release of driver-allocated resources&quot;) but the commit itself seems
    > to be correct.
    > Fix the issue by dropping the &#x27;hid_dev-&gt;driver&#x27; override and using
    > hid_register_driver()/hid_unregister_driver() instead. Alternatively, it
    > would have been possible to rely on the default handling but
    > HID_CONNECT_DEFAULT implies HID_CONNECT_HIDRAW and it doesn&#x27;t seem to work
    > for mousevsc as-is.
    > Fixes: 62c68e7cee33 (&quot;HID: ensure timely release of driver-allocated resources&quot;)
    > Suggested-by: Michael Kelley &lt;mhklinux@outlook.com&gt;
    > Signed-off-by: Vitaly Kuznetsov &lt;vkuznets@redhat.com&gt;
    > Reviewed-by: Michael Kelley &lt;mhklinux@outlook.com&gt;
    > Tested-by: Saurabh Sengar &lt;ssengar@linux.microsoft.com&gt;
    > Signed-off-by: Jiri Kosina &lt;jkosina@suse.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ platform/x86: asus-wmi: Fix inconsistent use of thermal policies (@Armin Wolf in [1c00bb70f3ad03d](https://github.com/sophgo/linux-riscv/commit/1c00bb70f3ad03d) at 2024-12-05 13:01:35)
    > [ Upstream commit 895085ec3f2ed7a26389943729e2904df1f88dc0 ]
    > When changing the thermal policy using the platform profile API,
    > a Vivobook thermal policy is stored in throttle_thermal_policy_mode.
    > However everywhere else a normal thermal policy is stored inside this
    > variable, potentially confusing the platform profile.
    > Fix this by always storing normal thermal policy values inside
    > throttle_thermal_policy_mode and only do the conversion when writing
    > the thermal policy to hardware. This also fixes the order in which
    > throttle_thermal_policy_switch_next() steps through the thermal modes
    > on Vivobook machines.
    > Tested-by: Casey G Bowman &lt;casey.g.bowman@intel.com&gt;
    > Fixes: bcbfcebda2cb (&quot;platform/x86: asus-wmi: add support for vivobook fan profiles&quot;)
    > Signed-off-by: Armin Wolf &lt;W_Armin@gmx.de&gt;
    > Reviewed-by: Hans de Goede &lt;hdegoede@redhat.com&gt;
    > Link: https://lore.kernel.org/r/20241107003811.615574-2-W_Armin@gmx.de
    > Reviewed-by: Ilpo Järvinen &lt;ilpo.jarvinen@linux.intel.com&gt;
    > Signed-off-by: Ilpo Järvinen &lt;ilpo.jarvinen@linux.intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ pwm: Assume a disabled PWM to emit a constant inactive output (@Uwe Kleine-König in [e3692460675bfe0](https://github.com/sophgo/linux-riscv/commit/e3692460675bfe0) at 2024-12-05 13:01:34)
    > [ Upstream commit b2eaa1170e45dc18eb09dcc9abafbe9a7502e960 ]
    > Some PWM hardwares (e.g. MC33XS2410) cannot implement a zero duty cycle
    > but can instead disable the hardware which also results in a constant
    > inactive output.
    > There are some checks (enabled with CONFIG_PWM_DEBUG) to help
    > implementing a driver without violating the normal rounding rules. Make
    > them less strict to let above described hardware pass without warning.
    > Reported-by: Dimitri Fedrau &lt;dima.fedrau@gmail.com&gt;
    > Link: https://lore.kernel.org/r/20241103205215.GA509903@debian
    > Fixes: 3ad1f3a33286 (&quot;pwm: Implement some checks for lowlevel drivers&quot;)
    > Signed-off-by: Uwe Kleine-König &lt;u.kleine-koenig@baylibre.com&gt;
    > Reviewed-by: Dimitri Fedrau &lt;dima.fedrau@gmail.com&gt;
    > Tested-by: Dimitri Fedrau &lt;dima.fedrau@gmail.com&gt;
    > Link: https://lore.kernel.org/r/20241105153521.1001864-2-u.kleine-koenig@baylibre.com
    > Signed-off-by: Uwe Kleine-König &lt;ukleinek@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ media: ipu6: Fix DMA and physical address debugging messages for 32-bit (@Sakari Ailus in [b0cd515202cb31c](https://github.com/sophgo/linux-riscv/commit/b0cd515202cb31c) at 2024-12-05 13:01:34)
    > [ Upstream commit 199c204bcc732ec18dbaec2b9d6445addbd376ea ]
    > Fix printing DMA and physical address printing on 32-bit platforms, by
    > using correct types. Also cast DMA_BIT_MASK() result to dma_addr_t to make
    > Clang happy.
    > Signed-off-by: Sakari Ailus &lt;sakari.ailus@linux.intel.com&gt;
    > Reviewed-by: Bingbu Cao &lt;bingbu.cao@intel.com&gt;
    > Signed-off-by: Hans Verkuil &lt;hverkuil@xs4all.nl&gt;
    > Stable-dep-of: daabc5c64703 (&quot;media: ipu6: not override the dma_ops of device in driver&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ firmware: arm_scpi: Check the DVFS OPP count returned by the firmware (@Luo Qiu in [9beaff47bcea5ee](https://github.com/sophgo/linux-riscv/commit/9beaff47bcea5ee) at 2024-12-05 13:01:34)
    > [ Upstream commit 109aa654f85c5141e813b2cd1bd36d90be678407 ]
    > Fix a kernel crash with the below call trace when the SCPI firmware
    > returns OPP count of zero.
    > dvfs_info.opp_count may be zero on some platforms during the reboot
    > test, and the kernel will crash after dereferencing the pointer to
    > kcalloc(info-&gt;count, sizeof(*opp), GFP_KERNEL).
    > |  Unable to handle kernel NULL pointer dereference at virtual address 0000000000000028
    > |  Mem abort info:
    > |    ESR &#x3D; 0x96000004
    > |    Exception class &#x3D; DABT (current EL), IL &#x3D; 32 bits
    > |    SET &#x3D; 0, FnV &#x3D; 0
    > |    EA &#x3D; 0, S1PTW &#x3D; 0
    > |  Data abort info:
    > |    ISV &#x3D; 0, ISS &#x3D; 0x00000004
    > |    CM &#x3D; 0, WnR &#x3D; 0
    > |  user pgtable: 4k pages, 48-bit VAs, pgdp &#x3D; 00000000faefa08c
    > |  [0000000000000028] pgd&#x3D;0000000000000000
    > |  Internal error: Oops: 96000004 [#1] SMP
    > |  scpi-hwmon: probe of PHYT000D:00 failed with error -110
    > |  Process systemd-udevd (pid: 1701, stack limit &#x3D; 0x00000000aaede86c)
    > |  CPU: 2 PID: 1701 Comm: systemd-udevd Not tainted 4.19.90+ #1
    > |  Hardware name: PHYTIUM LTD Phytium FT2000/4/Phytium FT2000/4, BIOS
    > |  pstate: 60000005 (nZCv daif -PAN -UAO)
    > |  pc : scpi_dvfs_recalc_rate+0x40/0x58 [clk_scpi]
    > |  lr : clk_register+0x438/0x720
    > |  Call trace:
    > |   scpi_dvfs_recalc_rate+0x40/0x58 [clk_scpi]
    > |   devm_clk_hw_register+0x50/0xa0
    > |   scpi_clk_ops_init.isra.2+0xa0/0x138 [clk_scpi]
    > |   scpi_clocks_probe+0x528/0x70c [clk_scpi]
    > |   platform_drv_probe+0x58/0xa8
    > |   really_probe+0x260/0x3d0
    > |   driver_probe_device+0x12c/0x148
    > |   device_driver_attach+0x74/0x98
    > |   __driver_attach+0xb4/0xe8
    > |   bus_for_each_dev+0x88/0xe0
    > |   driver_attach+0x30/0x40
    > |   bus_add_driver+0x178/0x2b0
    > |   driver_register+0x64/0x118
    > |   __platform_driver_register+0x54/0x60
    > |   scpi_clocks_driver_init+0x24/0x1000 [clk_scpi]
    > |   do_one_initcall+0x54/0x220
    > |   do_init_module+0x54/0x1c8
    > |   load_module+0x14a4/0x1668
    > |   __se_sys_finit_module+0xf8/0x110
    > |   __arm64_sys_finit_module+0x24/0x30
    > |   el0_svc_common+0x78/0x170
    > |   el0_svc_handler+0x38/0x78
    > |   el0_svc+0x8/0x340
    > |  Code: 937d7c00 a94153f3 a8c27bfd f9400421 (b8606820)
    > |  ---[ end trace 06feb22469d89fa8 ]---
    > |  Kernel panic - not syncing: Fatal exception
    > |  SMP: stopping secondary CPUs
    > |  Kernel Offset: disabled
    > |  CPU features: 0x10,a0002008
    > |  Memory Limit: none
    > Fixes: 8cb7cf56c9fe (&quot;firmware: add support for ARM System Control and Power Interface(SCPI) protocol&quot;)
    > Signed-off-by: Luo Qiu &lt;luoqiu@kylinsec.com.cn&gt;
    > Message-Id: &lt;55A2F7A784391686+20241101032115.275977-1-luoqiu@kylinsec.com.cn&gt;
    > Signed-off-by: Sudeep Holla &lt;sudeep.holla@arm.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ media: ipu6: not override the dma_ops of device in driver (@Bingbu Cao in [6ac269abab9ca5a](https://github.com/sophgo/linux-riscv/commit/6ac269abab9ca5a) at 2024-12-05 13:01:34)
    > [ Upstream commit daabc5c64703432c4a8798421a3588c2c142c51b ]
    > DMA ops are a helper for architectures and not for drivers to override the
    > DMA implementation. Driver should not override the DMA implementation.
    > This patch removes the dma_ops override from auxiliary device and adds
    > driver-internal helpers that use the actual DMA mapping APIs.
    > Fixes: 9163d83573e4 (&quot;media: intel/ipu6: add IPU6 DMA mapping API and MMU table&quot;)
    > Signed-off-by: Bingbu Cao &lt;bingbu.cao@intel.com&gt;
    > Reviewed-by: Christoph Hellwig &lt;hch@lst.de&gt;
    > [Sakari Ailus: Fix the commit message a little.]
    > Signed-off-by: Sakari Ailus &lt;sakari.ailus@linux.intel.com&gt;
    > Signed-off-by: Hans Verkuil &lt;hverkuil@xs4all.nl&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ media: ipu6: remove architecture DMA ops dependency in Kconfig (@Bingbu Cao in [11b0543efe54357](https://github.com/sophgo/linux-riscv/commit/11b0543efe54357) at 2024-12-05 13:01:34)
    > [ Upstream commit c8e9120c2065868d97e9e94bceee777e5db08c3e ]
    > IPU6 driver doesn&#x27;t override the dma_ops of device now, it doesn&#x27;t
    > depends on the ARCH_HAS_DMA_OPS, so remove the dependency in Kconfig.
    > Fixes: de6c85bf918e (&quot;dma-mapping: clearly mark DMA ops as an architecture feature&quot;)
    > Signed-off-by: Bingbu Cao &lt;bingbu.cao@intel.com&gt;
    > Signed-off-by: Sakari Ailus &lt;sakari.ailus@linux.intel.com&gt;
    > Signed-off-by: Hans Verkuil &lt;hverkuil@xs4all.nl&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ media: atomisp: Add check for rgby_data memory allocation failure (@Li Huafei in [0c25ab93f2878ca](https://github.com/sophgo/linux-riscv/commit/0c25ab93f2878ca) at 2024-12-05 13:01:34)
    > [ Upstream commit ed61c59139509f76d3592683c90dc3fdc6e23cd6 ]
    > In ia_css_3a_statistics_allocate(), there is no check on the allocation
    > result of the rgby_data memory. If rgby_data is not successfully
    > allocated, it may trigger the assert(host_stats-&gt;rgby_data) assertion in
    > ia_css_s3a_hmem_decode(). Adding a check to fix this potential issue.
    > Fixes: a49d25364dfb (&quot;staging/atomisp: Add support for the Intel IPU v2&quot;)
    > Signed-off-by: Li Huafei &lt;lihuafei1@huawei.com&gt;
    > Reviewed-by: Andy Shevchenko &lt;andy@kernel.org&gt;
    > Link: https://lore.kernel.org/r/20241104145051.3088231-1-lihuafei1@huawei.com
    > Reviewed-by: Hans de Goede &lt;hdegoede@redhat.com&gt;
    > Signed-off-by: Hans de Goede &lt;hdegoede@redhat.com&gt;
    > Signed-off-by: Mauro Carvalho Chehab &lt;mchehab+huawei@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ selftests/resctrl: Print accurate buffer size as part of MBM results (@Reinette Chatre in [ba66932b5ff3a87](https://github.com/sophgo/linux-riscv/commit/ba66932b5ff3a87) at 2024-12-05 13:01:33)
    > [ Upstream commit 1b4840395f08e9723a15fea42c2d31090e8375f3 ]
    > By default the MBM test uses the &quot;fill_buf&quot; benchmark to keep reading
    > from a buffer with size DEFAULT_SPAN while measuring memory bandwidth.
    > User space can provide an alternate benchmark or amend the size of
    > the buffer &quot;fill_buf&quot; should use.
    > Analysis of the MBM measurements do not require that a buffer be used
    > and thus do not require knowing the size of the buffer if it was used
    > during testing. Even so, the buffer size is printed as informational
    > as part of the MBM test results. What is printed as buffer size is
    > hardcoded as DEFAULT_SPAN, even if the test relied on another benchmark
    > (that may or may not use a buffer) or if user space amended the buffer
    > size.
    > Ensure that accurate buffer size is printed when using &quot;fill_buf&quot;
    > benchmark and omit the buffer size information if another benchmark
    > is used.
    > Fixes: ecdbb911f22d (&quot;selftests/resctrl: Add MBM test&quot;)
    > Signed-off-by: Reinette Chatre &lt;reinette.chatre@intel.com&gt;
    > Reviewed-by: Ilpo Järvinen &lt;ilpo.jarvinen@linux.intel.com&gt;
    > Signed-off-by: Shuah Khan &lt;skhan@linuxfoundation.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ arm64: dts: imx8mn-tqma8mqnl-mba8mx-usbot: fix coexistence of output-low and output-high in GPIO (@Frank Li in [a519bc053245c22](https://github.com/sophgo/linux-riscv/commit/a519bc053245c22) at 2024-12-05 13:01:33)
    > [ Upstream commit c771d311b1901cd4679c8fc7f89a882fe07cf4a0 ]
    > Fix the issue where both &#x27;output-low&#x27; and &#x27;output-high&#x27; exist under GPIO
    > hog nodes  (rst_usb_hub_hog and sel_usb_hub_hog) when applying device
    > tree overlays. Since /delete-property/ is not supported in the overlays,
    > setting &#x27;output-low&#x27; results in both properties being present. The
    > workaround is to disable these hogs and create new ones with &#x27;output-low&#x27;
    > as needed.
    > Fix below CHECK_DTBS warning:
    > arch/arm64/boot/dts/freescale/imx8mn-tqma8mqnl-mba8mx-usbotg.dtb: sel-usb-hub-hog:
    > {&#x27;output-low&#x27;: True, &#x27;gpio-hog&#x27;: True, &#x27;gpios&#x27;: [[1, 0]], &#x27;output-high&#x27;: True, &#x27;phandle&#x27;: 108, &#x27;$nodename&#x27;: [&#x27;sel-usb-hub-hog&#x27;]}
    > is valid under each of {&#x27;required&#x27;: [&#x27;output-low&#x27;]}, {&#x27;required&#x27;: [&#x27;output-high&#x27;]
    > Fixes: 3f6fc30abebc (&quot;arm64: dts: imx8mn: tqma8mqnl-mba8mx: Add USB DR overlay&quot;)
    > Signed-off-by: Frank Li &lt;Frank.Li@nxp.com&gt;
    > Reviewed-by: Alexander Stein &lt;alexander.stein@ew.tq-group.com&gt;
    > Signed-off-by: Shawn Guo &lt;shawnguo@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ selftests/resctrl: Fix memory overflow due to unhandled wraparound (@Reinette Chatre in [9d46744f7773f13](https://github.com/sophgo/linux-riscv/commit/9d46744f7773f13) at 2024-12-05 13:01:33)
    > [ Upstream commit caf02626b2bf164a02c808240f19dbf97aced664 ]
    > alloc_buffer() allocates and initializes (with random data) a
    > buffer of requested size. The initialization starts from the beginning
    > of the allocated buffer and incrementally assigns sizeof(uint64_t) random
    > data to each cache line. The initialization uses the size of the
    > buffer to control the initialization flow, decrementing the amount of
    > buffer needing to be initialized after each iteration.
    > The size of the buffer is stored in an unsigned (size_t) variable s64
    > and the test &quot;s64 &gt; 0&quot; is used to decide if initialization is complete.
    > The problem is that decrementing the buffer size may wrap around
    > if the buffer size is not divisible by &quot;CL_SIZE / sizeof(uint64_t)&quot;
    > resulting in the &quot;s64 &gt; 0&quot; test being true and memory beyond the buffer
    > &quot;initialized&quot;.
    > Use a signed value for the buffer size to support all buffer sizes.
    > Fixes: a2561b12fe39 (&quot;selftests/resctrl: Add built in benchmark&quot;)
    > Signed-off-by: Reinette Chatre &lt;reinette.chatre@intel.com&gt;
    > Reviewed-by: Ilpo Järvinen &lt;ilpo.jarvinen@linux.intel.com&gt;
    > Signed-off-by: Shuah Khan &lt;skhan@linuxfoundation.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ arm64: dts: mediatek: mt8183-kukui-jacuzzi: Fix DP bridge supply names (@Chen-Yu Tsai in [7e2baa88ee0220f](https://github.com/sophgo/linux-riscv/commit/7e2baa88ee0220f) at 2024-12-05 13:01:33)
    > [ Upstream commit c4e8cf13f1740037483565d5b802764e2426515b ]
    > Some of the regulator supplies for the MIPI-DPI-to-DP bridge and their
    > associated nodes are incorrectly named. In particular, the 1.0V supply
    > was modeled as a 1.2V supply.
    > Fix all the incorrect names, and also fix the voltage of the 1.0V
    > regulator.
    > Fixes: cabc71b08eb5 (&quot;arm64: dts: mt8183: Add kukui-jacuzzi-damu board&quot;)
    > Signed-off-by: Chen-Yu Tsai &lt;wenst@chromium.org&gt;
    > Link: https://lore.kernel.org/r/20241030070224.1006331-3-wenst@chromium.org
    > Signed-off-by: AngeloGioacchino Del Regno &lt;angelogioacchino.delregno@collabora.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ arm64: dts: mediatek: mt6358: fix dtbs_check error (@Macpaul Lin in [6b4f3098bb449cc](https://github.com/sophgo/linux-riscv/commit/6b4f3098bb449cc) at 2024-12-05 13:01:33)
    > [ Upstream commit 76ab2ae0ab9ebb2d70e6ee8a9f59911621192c37 ]
    > Fix DTBS check errors for &#x27;mt6358codec&#x27; and &#x27;mt6358regulator&#x27;:
    > Error message is:
    > pmic: &#x27;mt6358codec&#x27; and &#x27;mt6358regulator&#x27; does not match any of the
    > regexes: &#x27;pinctrl-[0-9]+&#x27;.
    > Rename these two device node to generic &#x27;audio-codec&#x27; and &#x27;regulators&#x27;.
    > Fixes: 9f8872221674 (&quot;arm64: dts: mt6358: add PMIC MT6358 related nodes&quot;)
    > Signed-off-by: Macpaul Lin &lt;macpaul.lin@mediatek.com&gt;
    > Link: https://lore.kernel.org/r/20241029064647.13370-1-macpaul.lin@mediatek.com
    > Signed-off-by: AngeloGioacchino Del Regno &lt;angelogioacchino.delregno@collabora.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ selftests/resctrl: Protect against array overrun during iMC config parsing (@Reinette Chatre in [5dc9ab15203c8ae](https://github.com/sophgo/linux-riscv/commit/5dc9ab15203c8ae) at 2024-12-05 13:01:33)
    > [ Upstream commit 48ed4e799e8fbebae838dca404a8527763d41191 ]
    > The MBM and MBA tests need to discover the event and umask with which to
    > configure the performance event used to measure read memory bandwidth.
    > This is done by parsing the
    > /sys/bus/event_source/devices/uncore_imc_&lt;imc instance&gt;/events/cas_count_read
    > file for each iMC instance that contains the formatted
    > output: &quot;event&#x3D;&lt;event&gt;,umask&#x3D;&lt;umask&gt;&quot;
    > Parsing of cas_count_read contents is done by initializing an array of
    > MAX_TOKENS elements with tokens (deliminated by &quot;&#x3D;,&quot;) from this file.
    > Remove the unnecessary append of a delimiter to the string needing to be
    > parsed. Per the strtok() man page: &quot;delimiter bytes at the start or end of
    > the string are ignored&quot;. This has no impact on the token placement within
    > the array.
    > After initialization, the actual event and umask is determined by
    > parsing the tokens directly following the &quot;event&quot; and &quot;umask&quot; tokens
    > respectively.
    > Iterating through the array up to index &quot;i &lt; MAX_TOKENS&quot; but then
    > accessing index &quot;i + 1&quot; risks array overrun during the final iteration.
    > Avoid array overrun by ensuring that the index used within for
    > loop will always be valid.
    > Fixes: 1d3f08687d76 (&quot;selftests/resctrl: Read memory bandwidth from perf IMC counter and from resctrl file system&quot;)
    > Signed-off-by: Reinette Chatre &lt;reinette.chatre@intel.com&gt;
    > Reviewed-by: Ilpo Järvinen &lt;ilpo.jarvinen@linux.intel.com&gt;
    > Signed-off-by: Shuah Khan &lt;skhan@linuxfoundation.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ arm64: dts: mediatek: mt8183-kukui-jacuzzi: Add supplies for fixed regulators (@Chen-Yu Tsai in [3231a7667f528ca](https://github.com/sophgo/linux-riscv/commit/3231a7667f528ca) at 2024-12-05 13:01:33)
    > [ Upstream commit aaecb1da58a72bfbd2c35d4aadc43caa02f11862 ]
    > When the fixed regulators for the LCD panel and DP bridge were added,
    > their supplies were not modeled in. These, except for the 1.0V supply,
    > are just load switches, and need and have a supply.
    > Add the supplies for each of the fixed regulators.
    > Fixes: cabc71b08eb5 (&quot;arm64: dts: mt8183: Add kukui-jacuzzi-damu board&quot;)
    > Signed-off-by: Chen-Yu Tsai &lt;wenst@chromium.org&gt;
    > Link: https://lore.kernel.org/r/20241030070224.1006331-4-wenst@chromium.org
    > Signed-off-by: AngeloGioacchino Del Regno &lt;angelogioacchino.delregno@collabora.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ dt-bindings: cache: qcom,llcc: Fix X1E80100 reg entries (@Abel Vesa in [dfdd0e8ff65dfc4](https://github.com/sophgo/linux-riscv/commit/dfdd0e8ff65dfc4) at 2024-12-05 13:01:32)
    > [ Upstream commit f9759e2b57049f9c4ea8d7254ba6afcf6eb10cd6 ]
    > Document the missing Broadcast_AND region for x1e80100.
    > Fixes: e9ceb595c2d3 (&quot;dt-bindings: cache: qcom,llcc: Add X1E80100 compatible&quot;)
    > Reported-by: kernel test robot &lt;lkp@intel.com&gt;
    > Closes: https://lore.kernel.org/oe-kbuild-all/202410181235.L7MF7z48-lkp@intel.com/
    > Signed-off-by: Abel Vesa &lt;abel.vesa@linaro.org&gt;
    > Reviewed-by: Krzysztof Kozlowski &lt;krzysztof.kozlowski@linaro.org&gt;
    > Link: https://lore.kernel.org/r/20241018-qcom-llcc-bindings-reg-ranges-fix-v1-1-88693cb7723b@linaro.org
    > Signed-off-by: Rob Herring (Arm) &lt;robh@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ spi: tegra210-quad: Avoid shift-out-of-bounds (@Breno Leitao in [d586e8ca7ec5834](https://github.com/sophgo/linux-riscv/commit/d586e8ca7ec5834) at 2024-12-05 13:01:32)
    > [ Upstream commit f399051ec1ff02e74ae5c2517aed2cc486fd005b ]
    > A shift-out-of-bounds issue was identified by UBSAN in the
    > tegra_qspi_fill_tx_fifo_from_client_txbuf() function.
    > UBSAN: shift-out-of-bounds in drivers/spi/spi-tegra210-quad.c:345:27
    > shift exponent 32 is too large for 32-bit type &#x27;u32&#x27; (aka &#x27;unsigned int&#x27;)
    > Call trace:
    > tegra_qspi_start_cpu_based_transfer
    > The problem arises when shifting the contents of tx_buf left by 8 times
    > the value of i, which can exceed 4 and result in an exponent larger than
    > 32 bits.
    > Resolve this by restrict the value of i to be less than 4, preventing
    > the shift operation from overflowing.
    > Signed-off-by: Breno Leitao &lt;leitao@debian.org&gt;
    > Fixes: 921fc1838fb0 (&quot;spi: tegra210-quad: Add support for Tegra210 QSPI controller&quot;)
    > Link: https://patch.msgid.link/20241004125400.1791089-1-leitao@debian.org
    > Signed-off-by: Mark Brown &lt;broonie@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ pmdomain: ti-sci: Add missing of_node_put() for args.np (@Zhang Zekun in [bb3e2f2c66e9d46](https://github.com/sophgo/linux-riscv/commit/bb3e2f2c66e9d46) at 2024-12-05 13:01:32)
    > [ Upstream commit afc2331ef81657493c074592c409dac7c3cb8ccc ]
    > of_parse_phandle_with_args() needs to call of_node_put() to decrement
    > the refcount of args.np. So, Add the missing of_node_put() in the loop.
    > Fixes: efa5c01cd7ee (&quot;soc: ti: ti_sci_pm_domains: switch to use multiple genpds instead of one&quot;)
    > Signed-off-by: Zhang Zekun &lt;zhangzekun11@huawei.com&gt;
    > Reviewed-by: Dhruva Gole &lt;d-gole@ti.com&gt;
    > Message-ID: &lt;20241024030442.119506-2-zhangzekun11@huawei.com&gt;
    > Signed-off-by: Ulf Hansson &lt;ulf.hansson@linaro.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ of/fdt: add dt_phys arg to early_init_dt_scan and early_init_dt_verify (@Usama Arif in [b5f599af75a50aa](https://github.com/sophgo/linux-riscv/commit/b5f599af75a50aa) at 2024-12-05 13:01:32)
    > [ Upstream commit b2473a359763e27567993e7d8f37de82f57a0829 ]
    > __pa() is only intended to be used for linear map addresses and using
    > it for initial_boot_params which is in fixmap for arm64 will give an
    > incorrect value. Hence save the physical address when it is known at
    > boot time when calling early_init_dt_scan for arm64 and use it at kexec
    > time instead of converting the virtual address using __pa().
    > Note that arm64 doesn&#x27;t need the FDT region reserved in the DT as the
    > kernel explicitly reserves the passed in FDT. Therefore, only a debug
    > warning is fixed with this change.
    > Reported-by: Breno Leitao &lt;leitao@debian.org&gt;
    > Suggested-by: Mark Rutland &lt;mark.rutland@arm.com&gt;
    > Signed-off-by: Usama Arif &lt;usamaarif642@gmail.com&gt;
    > Fixes: ac10be5cdbfa (&quot;arm64: Use common of_kexec_alloc_and_setup_fdt()&quot;)
    > Link: https://lore.kernel.org/r/20241023171426.452688-1-usamaarif642@gmail.com
    > Signed-off-by: Rob Herring (Arm) &lt;robh@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ regmap: irq: Set lockdep class for hierarchical IRQ domains (@Andy Shevchenko in [a5b7bc2747cfe2a](https://github.com/sophgo/linux-riscv/commit/a5b7bc2747cfe2a) at 2024-12-05 13:01:32)
    > [ Upstream commit 953e549471cabc9d4980f1da2e9fa79f4c23da06 ]
    > Lockdep gives a false positive splat as it can&#x27;t distinguish the lock
    > which is taken by different IRQ descriptors from different IRQ chips
    > that are organized in a way of a hierarchy:
    > &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;
    > WARNING: possible circular locking dependency detected
    > 6.12.0-rc5-next-20241101-00148-g9fabf8160b53 #562 Tainted: G        W
    > ------------------------------------------------------
    > modprobe/141 is trying to acquire lock:
    > ffff899446947868 (intel_soc_pmic_bxtwc:502:(&amp;bxtwc_regmap_config)-&gt;lock){+.+.}-{4:4}, at: regmap_update_bits_base+0x33/0x90
    > but task is already holding lock:
    > ffff899446947c68 (&amp;d-&gt;lock){+.+.}-{4:4}, at: __setup_irq+0x682/0x790
    > which lock already depends on the new lock.
    > -&gt; #3 (&amp;d-&gt;lock){+.+.}-{4:4}:
    > -&gt; #2 (&amp;desc-&gt;request_mutex){+.+.}-{4:4}:
    > -&gt; #1 (ipclock){+.+.}-{4:4}:
    > -&gt; #0 (intel_soc_pmic_bxtwc:502:(&amp;bxtwc_regmap_config)-&gt;lock){+.+.}-{4:4}:
    > Chain exists of:
    > intel_soc_pmic_bxtwc:502:(&amp;bxtwc_regmap_config)-&gt;lock --&gt; &amp;desc-&gt;request_mutex --&gt; &amp;d-&gt;lock
    > Possible unsafe locking scenario:
    > CPU0                    CPU1
    > ----                    ----
    > lock(&amp;d-&gt;lock);
    > lock(&amp;desc-&gt;request_mutex);
    > lock(&amp;d-&gt;lock);
    > lock(intel_soc_pmic_bxtwc:502:(&amp;bxtwc_regmap_config)-&gt;lock);
    > ** DEADLOCK ***
    > 3 locks held by modprobe/141:
    > #0: ffff8994419368f8 (&amp;dev-&gt;mutex){....}-{4:4}, at: __driver_attach+0xf6/0x250
    > #1: ffff89944690b250 (&amp;desc-&gt;request_mutex){+.+.}-{4:4}, at: __setup_irq+0x1a2/0x790
    > #2: ffff899446947c68 (&amp;d-&gt;lock){+.+.}-{4:4}, at: __setup_irq+0x682/0x790
    > Set a lockdep class when we map the IRQ so that it doesn&#x27;t warn about
    > a lockdep bug that doesn&#x27;t exist.
    > Fixes: 4af8be67fd99 (&quot;regmap: Convert regmap_irq to use irq_domain&quot;)
    > Signed-off-by: Andy Shevchenko &lt;andriy.shevchenko@linux.intel.com&gt;
    > Link: https://patch.msgid.link/20241101165553.4055617-1-andriy.shevchenko@linux.intel.com
    > Signed-off-by: Mark Brown &lt;broonie@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ arm64: dts: renesas: hihope: Drop #sound-dai-cells (@Lad Prabhakar in [738dbefc537e535](https://github.com/sophgo/linux-riscv/commit/738dbefc537e535) at 2024-12-05 13:01:32)
    > [ Upstream commit 9cc926e3fab42dd292219796cfc94e41f4ab749d ]
    > &quot;#sound-dai-cells&quot; is required if the board is using &quot;simple-card&quot;.
    > However, the HiHope board uses &quot;audio-graph&quot;, thus remove the unneeded
    > &#x60;#sound-dai-cells&#x60;.
    > Commit 9e72606cd2db (&quot;arm64: dts: renesas: #sound-dai-cells is used when
    > simple-card&quot;) updated the comment regarding usage of &quot;#sound-dai-cells&quot;
    > in the SoC DTSI but missed to remove &quot;#sound-dai-cells&quot; from board DTS
    > files.
    > Fixes: 9e72606cd2db (&quot;arm64: dts: renesas: #sound-dai-cells is used when simple-card&quot;)
    > Signed-off-by: Lad Prabhakar &lt;prabhakar.mahadev-lad.rj@bp.renesas.com&gt;
    > Reviewed-by: Geert Uytterhoeven &lt;geert+renesas@glider.be&gt;
    > Acked-by: Kuninori Morimoto &lt;kuninori.morimoto.gx@renesas.com&gt;
    > Link: https://lore.kernel.org/20241010135332.710648-1-prabhakar.mahadev-lad.rj@bp.renesas.com
    > Signed-off-by: Geert Uytterhoeven &lt;geert+renesas@glider.be&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ spi: zynqmp-gqspi: Undo runtime PM changes at driver exit time​ (@Jinjie Ruan in [30d82ecfc036140](https://github.com/sophgo/linux-riscv/commit/30d82ecfc036140) at 2024-12-05 13:01:32)
    > [ Upstream commit 2219576883e709737f3100aa9ded84976be49bd7 ]
    > It&#x27;s important to undo pm_runtime_use_autosuspend() with
    > pm_runtime_dont_use_autosuspend() at driver exit time.
    > So, call pm_runtime_dont_use_autosuspend() at driver exit time
    > to fix it.
    > Fixes: 9e3a000362ae (&quot;spi: zynqmp: Add pm runtime support&quot;)
    > Signed-off-by: Jinjie Ruan &lt;ruanjinjie@huawei.com&gt;
    > Link: https://patch.msgid.link/20240920091135.2741574-1-ruanjinjie@huawei.com
    > Signed-off-by: Mark Brown &lt;broonie@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ arm64: dts: ti: k3-j7200: Fix clock ids for MCSPI instances (@Anurag Dutta in [b1ec66256c4da38](https://github.com/sophgo/linux-riscv/commit/b1ec66256c4da38) at 2024-12-05 13:01:31)
    > [ Upstream commit 3a47e381670f130870caef6e1155ac531b17b032 ]
    > The clock IDs for multiple MCSPI instances across wakeup as
    > well as main domain in J7200 are incorrect when compared with
    > documentation [1]. This results in kernel crashes when the said
    > instances are enabled. Fix the clock ids to their appropriate
    > values.
    > [1]https://software-dl.ti.com/tisci/esd/latest/5_soc_doc/j7200/clocks.html
    > Fixes: 8f6c475f4ca7 (&quot;arm64: dts: ti: k3-j7200: Add MCSPI nodes&quot;)
    > Signed-off-by: Anurag Dutta &lt;a-dutta@ti.com&gt;
    > Reviewed-by: Aniket Limaye &lt;a-limaye@ti.com&gt;
    > Link: https://lore.kernel.org/r/20241023104532.3438851-2-a-dutta@ti.com
    > Signed-off-by: Vignesh Raghavendra &lt;vigneshr@ti.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ arm64: dts: ti: k3-j721s2: Fix clock IDs for MCSPI instances (@Anurag Dutta in [af125e7f6dc3c0d](https://github.com/sophgo/linux-riscv/commit/af125e7f6dc3c0d) at 2024-12-05 13:01:31)
    > [ Upstream commit 891874f015e98f67ab2fda76f2e859921e136621 ]
    > The clock IDs for multiple MCSPI instances across wakeup domain
    > in J721s2 are incorrect when compared with documentation [1]. Fix the
    > clock IDs to their appropriate values.
    > [1]https://software-dl.ti.com/tisci/esd/latest/5_soc_doc/j721s2/clocks.html
    > Fixes: 04d7cb647b85 (&quot;arm64: dts: ti: k3-j721s2: Add MCSPI nodes&quot;)
    > Signed-off-by: Anurag Dutta &lt;a-dutta@ti.com&gt;
    > Link: https://lore.kernel.org/r/20241023104532.3438851-4-a-dutta@ti.com
    > Signed-off-by: Vignesh Raghavendra &lt;vigneshr@ti.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ARM: dts: cubieboard4: Fix DCDC5 regulator constraints (@Andre Przywara in [96e1ff3a7973250](https://github.com/sophgo/linux-riscv/commit/96e1ff3a7973250) at 2024-12-05 13:01:31)
    > [ Upstream commit dd36ad71ad65968f97630808bc8d605c929b128e ]
    > The DCDC5 voltage rail in the X-Powers AXP809 PMIC has a resolution of
    > 50mV, so the currently enforced limits of 1.475 and 1.525 volts cannot
    > be set, when the existing regulator value is beyond this range.
    > This will lead to the whole regulator driver to give up and fail
    > probing, which in turn will hang the system, as essential devices depend
    > on the PMIC.
    > In this case a bug in U-Boot set the voltage to 1.75V (meant for DCDC4),
    > and the AXP driver&#x27;s attempt to correct this lead to this error:
    > &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;
    > [    4.447653] axp20x-rsb sunxi-rsb-3a3: AXP20X driver loaded
    > [    4.450066] vcc-dram: Bringing 1750000uV into 1575000-1575000uV
    > [    4.460272] vcc-dram: failed to apply 1575000-1575000uV constraint: -EINVAL
    > [    4.474788] axp20x-regulator axp20x-regulator.0: Failed to register dcdc5
    > [    4.482276] axp20x-regulator axp20x-regulator.0: probe with driver axp20x-regulator failed with error -22
    > &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;
    > Set the limits to values that can be programmed, so any correction will
    > be successful.
    > Signed-off-by: Andre Przywara &lt;andre.przywara@arm.com&gt;
    > Fixes: 1e1dea72651b (&quot;ARM: dts: sun9i: cubieboard4: Add AXP809 PMIC device node and regulators&quot;)
    > Link: https://patch.msgid.link/20241007222916.19013-1-andre.przywara@arm.com
    > Signed-off-by: Chen-Yu Tsai &lt;wens@csie.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ arm64: dts: ti: k3-j721e: Fix clock IDs for MCSPI instances (@Anurag Dutta in [537640670505052](https://github.com/sophgo/linux-riscv/commit/537640670505052) at 2024-12-05 13:01:31)
    > [ Upstream commit ab09a68f3be04b2f9d1fc7cfc0e2225025cb9421 ]
    > The clock IDs for multiple MCSPI instances across wakeup domain
    > in J721e are incorrect when compared with documentation [1]. Fix
    > the clock ids to their appropriate values.
    > [1]https://software-dl.ti.com/tisci/esd/latest/5_soc_doc/j721e/clocks.html
    > Fixes: 76aa309f9fa7 (&quot;arm64: dts: ti: k3-j721e: Add MCSPI nodes&quot;)
    > Signed-off-by: Anurag Dutta &lt;a-dutta@ti.com&gt;
    > Link: https://lore.kernel.org/r/20241023104532.3438851-3-a-dutta@ti.com
    > Signed-off-by: Vignesh Raghavendra &lt;vigneshr@ti.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ watchdog: Add HAS_IOPORT dependency for SBC8360 and SBC7240 (@Niklas Schnelle in [449664da08183c5](https://github.com/sophgo/linux-riscv/commit/449664da08183c5) at 2024-12-05 13:01:31)
    > [ Upstream commit d4d3125a3452a54acca69050be67b87ee2900e77 ]
    > Both drivers use I/O port accesses without declaring a dependency on
    > CONFIG_HAS_IOPORT. For sbc8360_wdt this causes a compile error on UML
    > once inb()/outb() helpers become conditional.
    > For sbc7240_wdt this causes no such errors with UML because this driver
    > depends on both x86_32 and !UML. Nevertheless add HAS_IOPORT as
    > a dependency for both drivers to be explicit and drop the !UML
    > dependency for sbc7240_wdt as it is now redundant since UML implies no
    > HAS_IOPORT.
    > Fixes: 52df67b6b313 (&quot;watchdog: add HAS_IOPORT dependencies&quot;)
    > Signed-off-by: Niklas Schnelle &lt;schnelle@linux.ibm.com&gt;
    > Reviewed-by: Guenter Roeck &lt;linux@roeck-us.net&gt;
    > Signed-off-by: Arnd Bergmann &lt;arnd@arndb.de&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ arm64: dts: ti: k3-j7200: Fix register map for main domain pmx (@Jared McArthur in [3aff48c8dbf62b9](https://github.com/sophgo/linux-riscv/commit/3aff48c8dbf62b9) at 2024-12-05 13:01:31)
    > [ Upstream commit b7af8b4acb3e08c710cd48f098ce8cd07cf43a1e ]
    > Commit 0d0a0b441346 (&quot;arm64: dts: ti: k3-j7200: fix main pinmux
    > range&quot;) split the main_pmx0 into two nodes: main_pmx0 and main_pmx1
    > due to a non-addressable region, but incorrectly represented the
    > ranges. As a result, the memory map for the pinctrl is incorrect. Fix
    > this by introducing the correct ranges.
    > The ranges are taken from the J7200 TRM [1] (Table 5-695. CTRL_MMR0
    > Registers).
    > Padconfig starting addresses and ranges:
    > -  0 to 66: 0x11c000, 0x10c
    > -       68: 0x11c110, 0x004
    > - 71 to 73: 0x11c11c, 0x00c
    > - 89 to 90: 0x11c164, 0x008
    > The datasheet [2] doesn&#x27;t contain PADCONFIG63 (Table 6-106. Pin
    > Multiplexing), but the pin is necessary for enabling the MMC1 CLKLP
    > pad loopback and should be included in the pinmux register map.
    > Due to the change in pinmux node addresses, change the pinmux node for
    > the USB0_DRVVBUS pin to main_pmx2. The offset has not changed since the
    > new main_pmx2 node has the same base address and range as the original
    > main_pmx1 node. All other pinmuxing done within J7200 dts or dtso files
    > only uses main_pmx0 which has not changed.
    > [1] https://www.ti.com/lit/pdf/spruiu1
    > [2] https://www.ti.com/lit/gpn/dra821u
    > Fixes: 0d0a0b441346 (&quot;arm64: dts: ti: k3-j7200: fix main pinmux range&quot;)
    > Signed-off-by: Aniket Limaye &lt;a-limaye@ti.com&gt;
    > Signed-off-by: Jared McArthur &lt;j-mcarthur@ti.com&gt;
    > Reviewed-by: Vaishnav Achath &lt;vaishnav.a@ti.com&gt;
    > Link: https://lore.kernel.org/r/20240926102533.398139-1-a-limaye@ti.com
    > Signed-off-by: Vignesh Raghavendra &lt;vigneshr@ti.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ arm64: dts: qcom: x1e80100: Update C4/C5 residency/exit numbers (@Konrad Dybcio in [1b58bf18eabbd8e](https://github.com/sophgo/linux-riscv/commit/1b58bf18eabbd8e) at 2024-12-05 13:01:31)
    > [ Upstream commit 2e65616ef07fa4c72c3898b22e5bede7d468cf32 ]
    > Update the numbers based on the information found in the DSDT.
    > Fixes: af16b00578a7 (&quot;arm64: dts: qcom: Add base X1E80100 dtsi and the QCP dts&quot;)
    > Signed-off-by: Konrad Dybcio &lt;konrad.dybcio@linaro.org&gt;
    > Link: https://lore.kernel.org/r/20240716-topic-h_bits-v1-2-f6c5d3ff982c@linaro.org
    > Signed-off-by: Bjorn Andersson &lt;andersson@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ arm64: dts: mt8183: burnet: add i2c2&#x27;s i2c-scl-internal-delay-ns (@Daolong Zhu in [e866714e384cfc2](https://github.com/sophgo/linux-riscv/commit/e866714e384cfc2) at 2024-12-05 13:01:30)
    > [ Upstream commit 85af64983889c621e8868b744c8ca03bd5038c02 ]
    > Add i2c2&#x27;s i2c-scl-internal-delay-ns.
    > Fixes: dd6e3b06214f (&quot;arm64: dts: mt8183: Add kukui-jacuzzi-burnet board&quot;)
    > Reviewed-by: Matthias Brugger &lt;matthias.bgg@gmail.com&gt;
    > Reviewed-by: AngeloGioacchino Del Regno &lt;angelogioacchino.delregno@collabora.com&gt;
    > Signed-off-by: Daolong Zhu &lt;jg_daolongzhu@mediatek.corp-partner.google.com&gt;
    > Signed-off-by: Hsin-Te Yuan &lt;yuanhsinte@chromium.org&gt;
    > Link: https://lore.kernel.org/r/20241025-i2c-delay-v2-2-9be1bcaf35e0@chromium.org
    > Signed-off-by: AngeloGioacchino Del Regno &lt;angelogioacchino.delregno@collabora.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ arm64: dts: rockchip: Remove &#x27;enable-active-low&#x27; from two boards (@Heiko Stuebner in [a6e8478def15e5f](https://github.com/sophgo/linux-riscv/commit/a6e8478def15e5f) at 2024-12-05 13:01:30)
    > [ Upstream commit 4a9d7e6596f90631f21bca9cb46c6de05d8e86d4 ]
    > The &#x27;enable-active-low&#x27; property is not a valid, because it is the
    > default behaviour of the fixed regulator.
    > Only &#x27;enable-active-high&#x27; is valid, and when this property is absent
    > the fixed regulator will act as active low by default.
    > Both the rk3588-orange-pi-5 and the Wolfvision pf5 io expander overlay
    > smuggled those enable-active-low properties in, so remove them to
    > make dtbscheck happier.
    > Fixes: 28799a7734a0 (&quot;arm64: dts: rockchip: add wolfvision pf5 io expander board&quot;)
    > Cc: Michael Riesch &lt;michael.riesch@wolfvision.net&gt;
    > Fixes: b6bc755d806e (&quot;arm64: dts: rockchip: Add Orange Pi 5&quot;)
    > Cc: Muhammed Efe Cetin &lt;efectn@6tel.net&gt;
    > Reviewed-by: Michael Riesch &lt;michael.riesch@wolfvision.net&gt;
    > Reviewed-by: Dragan Simic &lt;dsimic@manjaro.org&gt;
    > Signed-off-by: Heiko Stuebner &lt;heiko@sntech.de&gt;
    > Link: https://lore.kernel.org/r/20241008203940.2573684-10-heiko@sntech.de
    > Signed-off-by: Heiko Stuebner &lt;heiko@sntech.de&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ pwm: imx27: Workaround of the pwm output bug when decrease the duty cycle (@Clark Wang in [4c5c54f4b2287bd](https://github.com/sophgo/linux-riscv/commit/4c5c54f4b2287bd) at 2024-12-05 13:01:30)
    > [ Upstream commit a25351e4c7740eb22561a3ee4ef17611c6f410b0 ]
    > Implement workaround for ERR051198
    > (https://www.nxp.com/docs/en/errata/IMX8MN_0N14Y.pdf)
    > PWM output may not function correctly if the FIFO is empty when a new SAR
    > value is programmed.
    > Description:
    > When the PWM FIFO is empty, a new value programmed to the PWM Sample
    > register (PWM_PWMSAR) will be directly applied even if the current timer
    > period has not expired. If the new SAMPLE value programmed in the
    > PWM_PWMSAR register is less than the previous value, and the PWM counter
    > register (PWM_PWMCNR) that contains the current COUNT value is greater
    > than the new programmed SAMPLE value, the current period will not flip
    > the level. This may result in an output pulse with a duty cycle of 100%.
    > Workaround:
    > Program the current SAMPLE value in the PWM_PWMSAR register before
    > updating the new duty cycle to the SAMPLE value in the PWM_PWMSAR
    > register. This will ensure that the new SAMPLE value is modified during
    > a non-empty FIFO, and can be successfully updated after the period
    > expires.
    > Write the old SAR value before updating the new duty cycle to SAR. This
    > avoids writing the new value into an empty FIFO.
    > This only resolves the issue when the PWM period is longer than 2us
    > (or &lt;500kHz) because write register is not quick enough when PWM period is
    > very short.
    > Reproduce steps:
    > cd /sys/class/pwm/pwmchip1/pwm0
    > echo 2000000000 &gt; period     # It is easy to observe by using long period
    > echo 1000000000 &gt; duty_cycle
    > echo 1 &gt; enable
    > echo       8000 &gt; duty_cycle # One full high pulse will be seen by scope
    > Fixes: 166091b1894d (&quot;[ARM] MXC: add pwm driver for i.MX SoCs&quot;)
    > Reviewed-by: Jun Li &lt;jun.li@nxp.com&gt;
    > Signed-off-by: Clark Wang &lt;xiaoning.wang@nxp.com&gt;
    > Signed-off-by: Frank Li &lt;Frank.Li@nxp.com&gt;
    > Link: https://lore.kernel.org/r/20241008194123.1943141-1-Frank.Li@nxp.com
    > Signed-off-by: Uwe Kleine-König &lt;ukleinek@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ arm64: dts: mt8183: cozmo: add i2c2&#x27;s i2c-scl-internal-delay-ns (@Daolong Zhu in [34b0854c9bc8011](https://github.com/sophgo/linux-riscv/commit/34b0854c9bc8011) at 2024-12-05 13:01:30)
    > [ Upstream commit bd0eb3b1f7aee698b86513edf10a50e2d0c7cb14 ]
    > Add i2c2&#x27;s i2c-scl-internal-delay-ns.
    > Fixes: 52e84f233459 (&quot;arm64: dts: mt8183: Add kukui-jacuzzi-cozmo board&quot;)
    > Reviewed-by: Matthias Brugger &lt;matthias.bgg@gmail.com&gt;
    > Reviewed-by: AngeloGioacchino Del Regno &lt;angelogioacchino.delregno@collabora.com&gt;
    > Signed-off-by: Daolong Zhu &lt;jg_daolongzhu@mediatek.corp-partner.google.com&gt;
    > Signed-off-by: Hsin-Te Yuan &lt;yuanhsinte@chromium.org&gt;
    > Link: https://lore.kernel.org/r/20241025-i2c-delay-v2-3-9be1bcaf35e0@chromium.org
    > Signed-off-by: AngeloGioacchino Del Regno &lt;angelogioacchino.delregno@collabora.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ arm64: dts: mt8183: Damu: add i2c2&#x27;s i2c-scl-internal-delay-ns (@Daolong Zhu in [0b943aa091c5538](https://github.com/sophgo/linux-riscv/commit/0b943aa091c5538) at 2024-12-05 13:01:30)
    > [ Upstream commit 6ff2d45f2121c698a57c959ae21885a048615908 ]
    > Add i2c2&#x27;s i2c-scl-internal-delay-ns.
    > Fixes: cabc71b08eb5 (&quot;arm64: dts: mt8183: Add kukui-jacuzzi-damu board&quot;)
    > Reviewed-by: Matthias Brugger &lt;matthias.bgg@gmail.com&gt;
    > Reviewed-by: AngeloGioacchino Del Regno &lt;angelogioacchino.delregno@collabora.com&gt;
    > Signed-off-by: Daolong Zhu &lt;jg_daolongzhu@mediatek.corp-partner.google.com&gt;
    > Signed-off-by: Hsin-Te Yuan &lt;yuanhsinte@chromium.org&gt;
    > Link: https://lore.kernel.org/r/20241025-i2c-delay-v2-4-9be1bcaf35e0@chromium.org
    > Signed-off-by: AngeloGioacchino Del Regno &lt;angelogioacchino.delregno@collabora.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ arm64: dts: mt8183: fennel: add i2c2&#x27;s i2c-scl-internal-delay-ns (@Daolong Zhu in [05d95a6863ce45b](https://github.com/sophgo/linux-riscv/commit/05d95a6863ce45b) at 2024-12-05 13:01:30)
    > [ Upstream commit c802db127dfb9602aaa9338e433c0553d34f1a9c ]
    > Add i2c2&#x27;s i2c-scl-internal-delay-ns.
    > Fixes: 6cd7fdc8c530 (&quot;arm64: dts: mt8183: Add kukui-jacuzzi-fennel board&quot;)
    > Reviewed-by: Matthias Brugger &lt;matthias.bgg@gmail.com&gt;
    > Reviewed-by: AngeloGioacchino Del Regno &lt;angelogioacchino.delregno@collabora.com&gt;
    > Signed-off-by: Daolong Zhu &lt;jg_daolongzhu@mediatek.corp-partner.google.com&gt;
    > Signed-off-by: Hsin-Te Yuan &lt;yuanhsinte@chromium.org&gt;
    > Reviewed-by:
    > Link: https://lore.kernel.org/r/20241025-i2c-delay-v2-1-9be1bcaf35e0@chromium.org
    > Signed-off-by: AngeloGioacchino Del Regno &lt;angelogioacchino.delregno@collabora.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ cgroup/bpf: only cgroup v2 can be attached by bpf programs (@Chen Ridong in [f390525e496920a](https://github.com/sophgo/linux-riscv/commit/f390525e496920a) at 2024-12-05 13:01:29)
    > [ Upstream commit 2190df6c91373fdec6db9fc07e427084f232f57e ]
    > Only cgroup v2 can be attached by bpf programs, so this patch introduces
    > that cgroup_bpf_inherit and cgroup_bpf_offline can only be called in
    > cgroup v2, and this can fix the memleak mentioned by commit 04f8ef5643bc
    > (&quot;cgroup: Fix memory leak caused by missing cgroup_bpf_offline&quot;), which
    > has been reverted.
    > Fixes: 2b0d3d3e4fcf (&quot;percpu_ref: reduce memory footprint of percpu_ref in fast path&quot;)
    > Fixes: 4bfc0bb2c60e (&quot;bpf: decouple the lifetime of cgroup_bpf from cgroup itself&quot;)
    > Link: https://lore.kernel.org/cgroups/aka2hk5jsel5zomucpwlxsej6iwnfw4qu5jkrmjhyfhesjlfdw@46zxhg5bdnr7/
    > Signed-off-by: Chen Ridong &lt;chenridong@huawei.com&gt;
    > Signed-off-by: Tejun Heo &lt;tj@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ Revert &quot;cgroup: Fix memory leak caused by missing cgroup_bpf_offline&quot; (@Chen Ridong in [dd6ade970de9378](https://github.com/sophgo/linux-riscv/commit/dd6ade970de9378) at 2024-12-05 13:01:29)
    > [ Upstream commit feb301c60970bd2a1310a53ce2d6e4375397a51b ]
    > This reverts commit 04f8ef5643bcd8bcde25dfdebef998aea480b2ba.
    > Only cgroup v2 can be attached by cgroup by BPF programs. Revert this
    > commit and cgroup_bpf_inherit and cgroup_bpf_offline won&#x27;t be called in
    > cgroup v1. The memory leak issue will be fixed with next patch.
    > Fixes: 04f8ef5643bc (&quot;cgroup: Fix memory leak caused by missing cgroup_bpf_offline&quot;)
    > Link: https://lore.kernel.org/cgroups/aka2hk5jsel5zomucpwlxsej6iwnfw4qu5jkrmjhyfhesjlfdw@46zxhg5bdnr7/
    > Signed-off-by: Chen Ridong &lt;chenridong@huawei.com&gt;
    > Signed-off-by: Tejun Heo &lt;tj@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ arm64: dts: mediatek: mt8195-cherry: Use correct audio codec DAI (@Fei Shao in [daaeba260710eec](https://github.com/sophgo/linux-riscv/commit/daaeba260710eec) at 2024-12-05 13:01:29)
    > [ Upstream commit 7d5794e6d964940e46286fadbe69a3245fa51e44 ]
    > The RT5682i and RT5682s drivers describe two DAIs: AIF1 supports both
    > playback and capture, while AIF2 supports capture only.
    > Cherry doesn&#x27;t specify which DAI to use. Although this doesn&#x27;t cause
    > real issues because AIF1 happens to be the first DAI, it should be
    > corrected:
    > codec@1a: #sound-dai-cells: 1 was expected
    > Update #sound-dai-cells to 1 and adjust DAI link usages accordingly.
    > Fixes: 87728e3ccf35 (&quot;arm64: dts: mediatek: mt8195-cherry: Specify sound DAI links and routing&quot;)
    > Signed-off-by: Fei Shao &lt;fshao@chromium.org&gt;
    > Link: https://lore.kernel.org/r/20241021114318.1358681-1-fshao@chromium.org
    > Signed-off-by: AngeloGioacchino Del Regno &lt;angelogioacchino.delregno@collabora.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ power: sequencing: make the QCom PMU pwrseq driver depend on CONFIG_OF (@Bartosz Golaszewski in [4acb04725201c5b](https://github.com/sophgo/linux-riscv/commit/4acb04725201c5b) at 2024-12-05 13:01:29)
    > [ Upstream commit f82bf3c5796e1630d553669fb451e6c9d4070512 ]
    > This driver uses various OF-specific functions and depends on phandle
    > parsing. There&#x27;s no reason to make it available to non-OF systems so add
    > a relevant dependency switch to its Kconfig entry.
    > Fixes: 2f1630f437df (&quot;power: pwrseq: add a driver for the PMU module on the QCom WCN chipsets&quot;)
    > Link: https://lore.kernel.org/r/20241004130449.51725-1-brgl@bgdev.pl
    > Signed-off-by: Bartosz Golaszewski &lt;bartosz.golaszewski@linaro.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ regulator: rk808: Restrict DVS GPIOs to the RK808 variant only (@Dragan Simic in [41cce1b2be76f3c](https://github.com/sophgo/linux-riscv/commit/41cce1b2be76f3c) at 2024-12-05 13:01:29)
    > [ Upstream commit 0d214f27c0e3d9694284c95bac1502c2d247355b ]
    > The rk808-regulator driver supports multiple PMIC variants from the Rockckip
    > RK80x and RK81x series, but the DVS GPIOs are supported on the RK808 variant
    > only, according to the DT bindings [1][2][3][4][5][6] and the datasheets for
    > the supported PMIC variants. [7][8][9][10][11][12]
    > Thus, change the probe path so the &quot;dvs-gpios&quot; property is checked for and
    > its value possibly used only when the handled PMIC variant is RK808.  There&#x27;s
    > no point in doing that on the other PMIC variants, because they don&#x27;t support
    > the DVS GPIOs, and it goes against the DT bindings to allow a possible out-
    > of-place &quot;dvs-gpios&quot; property to actually be handled in the driver.
    > This eliminates the following messages, emitted when the &quot;dvs-gpios&quot; property
    > isn&#x27;t found in the DT, from the kernel log on boards that actually don&#x27;t use
    > the RK808 variant, which may have provided a source of confusion:
    > rk808-regulator rk808-regulator.2.auto: there is no dvs0 gpio
    > rk808-regulator rk808-regulator.2.auto: there is no dvs1 gpio
    > Furthermore, demote these kernel messages to debug messages, because they are
    > useful during the board bringup phase only.  Emitting them afterwards, on the
    > boards that use the RK808 variant, but actually don&#x27;t use the DVS0/1 GPIOs,
    > clutters the kernel log a bit, while they provide no value and may actually
    > cause false impression that some PMIC-related issues are present.
    > [1] Documentation/devicetree/bindings/mfd/rockchip,rk805.yaml
    > [2] Documentation/devicetree/bindings/mfd/rockchip,rk806.yaml
    > [3] Documentation/devicetree/bindings/mfd/rockchip,rk808.yaml
    > [4] Documentation/devicetree/bindings/mfd/rockchip,rk816.yaml
    > [5] Documentation/devicetree/bindings/mfd/rockchip,rk817.yaml
    > [6] Documentation/devicetree/bindings/mfd/rockchip,rk818.yaml
    > [7] https://rockchip.fr/RK805%20datasheet%20V1.2.pdf
    > [8] https://wmsc.lcsc.com/wmsc/upload/file/pdf/v2/lcsc/2401261533_Rockchip-RK806-1_C5156483.pdf
    > [9] https://rockchip.fr/RK808%20datasheet%20V1.4.pdf
    > [10] https://rockchip.fr/RK816%20datasheet%20V1.3.pdf
    > [11] https://rockchip.fr/RK817%20datasheet%20V1.01.pdf
    > [12] https://rockchip.fr/RK818%20datasheet%20V1.0.pdf
    > Fixes: 11375293530b (&quot;regulator: rk808: Add regulator driver for RK818&quot;)
    > Reported-by: Diederik de Haas &lt;didi.debian@cknow.org&gt;
    > Signed-off-by: Dragan Simic &lt;dsimic@manjaro.org&gt;
    > Link: https://patch.msgid.link/9a415c59699e76fc7b88a2552520a4ca2538f44e.1728902488.git.dsimic@manjaro.org
    > Signed-off-by: Mark Brown &lt;broonie@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ arm64: tegra: p2180: Add mandatory compatible for WiFi node (@Tomasz Maciej Nowak in [156d76a7e6cd24d](https://github.com/sophgo/linux-riscv/commit/156d76a7e6cd24d) at 2024-12-05 13:01:29)
    > [ Upstream commit 2e57d3dc7bff60b9fb05eaaf4ebad87cd3651068 ]
    > The dtschema requires to specify common ancestor which all SDIO chips are
    > derived from, so add accordingly.
    > Fixes: a50d5dcd2815 (&quot;arm64: tegra: Wire up WiFi on Jetson TX1 module&quot;)
    > Reported-by: kernel test robot &lt;lkp@intel.com&gt;
    > Closes: https://lore.kernel.org/oe-kbuild-all/202409030438.8tumAnp1-lkp@intel.com
    > Signed-off-by: Tomasz Maciej Nowak &lt;tmn505@gmail.com&gt;
    > Signed-off-by: Thierry Reding &lt;treding@nvidia.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ arm64: dts: mediatek: mt8188: Fix USB3 PHY port default status (@Fei Shao in [03af5fddfa76795](https://github.com/sophgo/linux-riscv/commit/03af5fddfa76795) at 2024-12-05 13:01:29)
    > [ Upstream commit 6bb64877a41561bc78e0f4e9e04d524a0155d6aa ]
    > The T-PHY controller at 0x11e40000 controls two underlying USB2 and USB3
    > PHY ports. The USB3 port works normally just like the others, so there&#x27;s
    > no point in disabling it separately. Otherwise, board DTs would have to
    > enable both the T-PHY controller and one of its sub-nodes in particular,
    > which is slightly redundant and confusing.
    > Remove the status line in the u3port1 node, so it&#x27;s ready to be used
    > once the T-PHY controller is enabled.
    > Fixes: 9461e0caac9e (&quot;arm64: dts: Add MediaTek MT8188 dts and evaluation board and Makefile&quot;)
    > Signed-off-by: Fei Shao &lt;fshao@chromium.org&gt;
    > Link: https://lore.kernel.org/r/20241021081311.543625-1-fshao@chromium.org
    > Signed-off-by: AngeloGioacchino Del Regno &lt;angelogioacchino.delregno@collabora.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ arm64: dts: mediatek: mt8173-elm-hana: Add vdd-supply to second source trackpad (@Chen-Yu Tsai in [ea8d0beb579f583](https://github.com/sophgo/linux-riscv/commit/ea8d0beb579f583) at 2024-12-05 13:01:28)
    > [ Upstream commit f766fae08f6a2eaeb45d8d2c053724c91526835c ]
    > The Hana device has a second source option trackpad, but it is missing
    > its regulator supply. It only works because the regulator is marked as
    > always-on.
    > Add the regulator supply, but leave out the post-power-on delay. Instead,
    > document the post-power-on delay along with the reason for not adding
    > it in a comment.
    > Fixes: 689b937bedde (&quot;arm64: dts: mediatek: add mt8173 elm and hana board&quot;)
    > Signed-off-by: Chen-Yu Tsai &lt;wenst@chromium.org&gt;
    > Reviewed-by: AngeloGioacchino Del Regno &lt;angelogioacchino.delregno@collabora.com&gt;
    > Link: https://lore.kernel.org/r/20241018082001.1296963-1-wenst@chromium.org
    > Signed-off-by: AngeloGioacchino Del Regno &lt;angelogioacchino.delregno@collabora.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ gpio: sloppy-logic-analyzer remove reference to rcu_momentary_dyntick_idle() (@Srikar Dronamraju in [77a81f159ee4c7e](https://github.com/sophgo/linux-riscv/commit/77a81f159ee4c7e) at 2024-12-05 13:01:28)
    > [ Upstream commit a0b6594e411dcae0cc563f5157cf062e93603388 ]
    > There is one last reference to rcu_momentary_dyntick_idle() after
    > commit 32a9f26e5e26 (&quot;rcu: Rename rcu_momentary_dyntick_idle() into
    > rcu_momentary_eqs()&quot;)
    > Rename it for consistency.
    > Fixes: 32a9f26e5e26 (&quot;rcu: Rename rcu_momentary_dyntick_idle() into rcu_momentary_eqs()&quot;)
    > Signed-off-by: Srikar Dronamraju &lt;srikar@linux.ibm.com&gt;
    > Acked-by: Frederic Weisbecker &lt;frederic@kernel.org&gt;
    > Link: https://lore.kernel.org/r/20240925054619.568209-1-srikar@linux.ibm.com
    > Signed-off-by: Bartosz Golaszewski &lt;bartosz.golaszewski@linaro.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ arm64: dts: qcom: x1e80100: Resize GIC Redistributor register region (@Sibi Sankar in [417d6f3e3bab39a](https://github.com/sophgo/linux-riscv/commit/417d6f3e3bab39a) at 2024-12-05 13:01:28)
    > [ Upstream commit 9ed1a2b8784262e85ec300792a1a37ebd8473be2 ]
    > Resize the GICR register region as it currently seeps into the CPU Control
    > Processor mailbox RX region.
    > Fixes: af16b00578a7 (&quot;arm64: dts: qcom: Add base X1E80100 dtsi and the QCP dts&quot;)
    > Reviewed-by: Dmitry Baryshkov &lt;dmitry.baryshkov@linaro.org&gt;
    > Reviewed-by: Konrad Dybcio &lt;konrad.dybcio@linaro.org&gt;
    > Signed-off-by: Sibi Sankar &lt;quic_sibis@quicinc.com&gt;
    > Link: https://lore.kernel.org/r/20240612124056.39230-4-quic_sibis@quicinc.com
    > Signed-off-by: Bjorn Andersson &lt;andersson@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ arm64: dts: mt8183: kukui: Fix the address of eeprom at i2c4 (@Hsin-Te Yuan in [3ca1a4b7a6afb06](https://github.com/sophgo/linux-riscv/commit/3ca1a4b7a6afb06) at 2024-12-05 13:01:28)
    > [ Upstream commit edbde4923f208aa83abb48d4b2463299e5fc2586 ]
    > The address of eeprom should be 50.
    > Fixes: ff33d889567e (&quot;arm64: dts: mt8183: Add kukui kodama board&quot;)
    > Fixes: d1eaf77f2c66 (&quot;arm64: dts: mt8183: Add kukui kakadu board&quot;)
    > Signed-off-by: Hsin-Te Yuan &lt;yuanhsinte@chromium.org&gt;
    > Reviewed-by: Matthias Brugger &lt;matthias.bgg@gmail.com&gt;
    > Reviewed-by: AngeloGioacchino Del Regno &lt;angelogioacchino.delregno@collabora.com&gt;
    > Link: https://lore.kernel.org/r/20240909-eeprom-v1-2-1ed2bc5064f4@chromium.org
    > Signed-off-by: AngeloGioacchino Del Regno &lt;angelogioacchino.delregno@collabora.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ kernel-doc: allow object-like macros in ReST output (@Randy Dunlap in [2d62981c0115c89](https://github.com/sophgo/linux-riscv/commit/2d62981c0115c89) at 2024-12-05 13:01:28)
    > [ Upstream commit bb8fd09e2811e2386bb40b9f0d3c7dd6e7961a1e ]
    > output_function_rst() does not handle object-like macros. It presents
    > a trailing &quot;()&quot; while output_function_man() handles these macros
    > correctly.
    > Update output_function_rst() to handle object-like macros.
    > Don&#x27;t show the &quot;Parameters&quot; heading if there are no parameters.
    > For output_function_man(), don&#x27;t show the &quot;ARGUMENTS&quot; heading if there
    > are no parameters.
    > I have tested this quite a bit with my ad hoc test files for both ReST
    > and man format outputs. The generated output looks good.
    > Fixes: cbb4d3e6510b (&quot;scripts/kernel-doc: handle object-like macros&quot;)
    > Signed-off-by: Randy Dunlap &lt;rdunlap@infradead.org&gt;
    > Cc: Horia Geanta &lt;horia.geanta@freescale.com&gt;
    > Tested-by: Vlastimil Babka &lt;vbabka@suse.cz&gt;
    > Signed-off-by: Jonathan Corbet &lt;corbet@lwn.net&gt;
    > Link: https://lore.kernel.org/r/20241015181107.536894-1-rdunlap@infradead.org
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ arm64: dts: ti: k3-am62x-phyboard-lyra: Drop unnecessary McASP AFIFOs (@Nathan Morrisson in [081b2d2d9af1c7f](https://github.com/sophgo/linux-riscv/commit/081b2d2d9af1c7f) at 2024-12-05 13:01:28)
    > [ Upstream commit c33a0a02a29bde53a85407f86f332ac4bbc5ab87 ]
    > Drop the McASP AFIFOs for better audio latency. This adds back a
    > change that was lost while refactoring the device tree.
    > Fixes: 554dd562a5f2 (&quot;arm64: dts: ti: k3-am625-phyboard-lyra-rdk: Drop McASP AFIFOs&quot;)
    > Signed-off-by: Nathan Morrisson &lt;nmorrisson@phytec.com&gt;
    > Reviewed-by: Wadim Egorov &lt;w.egorov@phytec.de&gt;
    > Link: https://lore.kernel.org/r/20241002224754.2917895-1-nmorrisson@phytec.com
    > Signed-off-by: Vignesh Raghavendra &lt;vigneshr@ti.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ arm64: dts: mt8183: krane: Fix the address of eeprom at i2c4 (@Hsin-Te Yuan in [07a859dc92ee9d2](https://github.com/sophgo/linux-riscv/commit/07a859dc92ee9d2) at 2024-12-05 13:01:28)
    > [ Upstream commit e9c60c34948662b5d47573490ee538439b29e462 ]
    > The address of eeprom should be 50.
    > Fixes: cd894e274b74 (&quot;arm64: dts: mt8183: Add krane-sku176 board&quot;)
    > Signed-off-by: Hsin-Te Yuan &lt;yuanhsinte@chromium.org&gt;
    > Reviewed-by: AngeloGioacchino Del Regno &lt;angelogioacchino.delregno@collabora.com&gt;
    > Reviewed-by: Matthias Brugger &lt;matthias.bgg@gmail.com&gt;
    > Link: https://lore.kernel.org/r/20240909-eeprom-v1-1-1ed2bc5064f4@chromium.org
    > Signed-off-by: AngeloGioacchino Del Regno &lt;angelogioacchino.delregno@collabora.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ openrisc: Implement fixmap to fix earlycon (@Stafford Horne in [f93e5804f68cbea](https://github.com/sophgo/linux-riscv/commit/f93e5804f68cbea) at 2024-12-05 13:01:27)
    > [ Upstream commit 1037d186edfc551fa7ba2d4336e74e7575a07a65 ]
    > With commit 53c98e35dcbc (&quot;openrisc: mm: remove unneeded early ioremap
    > code&quot;) it was commented that early ioremap was not used in OpenRISC.  I
    > acked this but was wrong, earlycon was using it.  Earlycon setup now
    > fails with the below trace:
    > Kernel command line: earlycon
    > ------------[ cut here ]------------
    > WARNING: CPU: 0 PID: 0 at mm/ioremap.c:23
    > generic_ioremap_prot+0x118/0x130
    > Modules linked in:
    > CPU: 0 UID: 0 PID: 0 Comm: swapper Not tainted
    > 6.11.0-rc5-00001-gce02fd891c38-dirty #141
    > Call trace:
    > [&lt;(ptrval)&gt;] dump_stack_lvl+0x7c/0x9c
    > [&lt;(ptrval)&gt;] dump_stack+0x1c/0x2c
    > [&lt;(ptrval)&gt;] __warn+0xb4/0x108
    > [&lt;(ptrval)&gt;] ? generic_ioremap_prot+0x118/0x130
    > [&lt;(ptrval)&gt;] warn_slowpath_fmt+0x60/0x98
    > [&lt;(ptrval)&gt;] generic_ioremap_prot+0x118/0x130
    > [&lt;(ptrval)&gt;] ioremap_prot+0x20/0x30
    > [&lt;(ptrval)&gt;] of_setup_earlycon+0xd4/0x2e0
    > [&lt;(ptrval)&gt;] early_init_dt_scan_chosen_stdout+0x18c/0x1c8
    > [&lt;(ptrval)&gt;] param_setup_earlycon+0x3c/0x60
    > [&lt;(ptrval)&gt;] do_early_param+0xb0/0x118
    > [&lt;(ptrval)&gt;] parse_args+0x184/0x4b8
    > [&lt;(ptrval)&gt;] ? start_kernel+0x0/0x78c
    > [&lt;(ptrval)&gt;] parse_early_options+0x40/0x50
    > [&lt;(ptrval)&gt;] ? do_early_param+0x0/0x118
    > [&lt;(ptrval)&gt;] parse_early_param+0x48/0x68
    > [&lt;(ptrval)&gt;] ? start_kernel+0x318/0x78c
    > [&lt;(ptrval)&gt;] ? start_kernel+0x0/0x78c
    > ---[ end trace 0000000000000000 ]---
    > To fix this we could either implement early_ioremap again or implement
    > fixmap.  In this patch we choose the later option of implementing basic
    > fixmap support.
    > While fixing this we also remove the old FIX_IOREMAP slots that were
    > used by early ioremap code.  That code was also removed by commit
    > 53c98e35dcbc (&quot;openrisc: mm: remove unneeded early ioremap code&quot;) but
    > these definitions were not cleaned up.
    > Fixes: 53c98e35dcbc (&quot;openrisc: mm: remove unneeded early ioremap code&quot;)
    > Signed-off-by: Stafford Horne &lt;shorne@gmail.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ media: i2c: max96717: clean up on error in max96717_subdev_init() (@Dan Carpenter in [e20117a105d4174](https://github.com/sophgo/linux-riscv/commit/e20117a105d4174) at 2024-12-05 13:01:27)
    > [ Upstream commit d56786977ba11ed15b066495c1363889bcb1c3bb ]
    > Call v4l2_ctrl_handler_free() to clean up from v4l2_ctrl_handler_init().
    > Fixes: 19b5e5511ca4 (&quot;media: i2c: max96717: add test pattern ctrl&quot;)
    > Signed-off-by: Dan Carpenter &lt;dan.carpenter@linaro.org&gt;
    > Reviewed-by: Julien Massot &lt;julien.massot@collabora.com&gt;
    > Signed-off-by: Sakari Ailus &lt;sakari.ailus@linux.intel.com&gt;
    > Signed-off-by: Mauro Carvalho Chehab &lt;mchehab+huawei@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ media: i2c: ds90ub960: Fix missing return check on ub960_rxport_read call (@Colin Ian King in [c8798cc5e2fe853](https://github.com/sophgo/linux-riscv/commit/c8798cc5e2fe853) at 2024-12-05 13:01:27)
    > [ Upstream commit 24ad2d1f773a11f69eecec3ec37ea3d76f2e9e7d ]
    > The function ub960_rxport_read is being called and afterwards ret is
    > being checked for any failures, however ret is not being assigned to
    > the return of the function call. Fix this by assigning ret to the
    > return of the call which appears to be missing.
    > Fixes: afe267f2d368 (&quot;media: i2c: add DS90UB960 driver&quot;)
    > Signed-off-by: Colin Ian King &lt;colin.i.king@gmail.com&gt;
    > Reviewed-by: Tomi Valkeinen &lt;tomi.valkeinen@ideasonboard.com&gt;
    > Signed-off-by: Sakari Ailus &lt;sakari.ailus@linux.intel.com&gt;
    > Signed-off-by: Mauro Carvalho Chehab &lt;mchehab+huawei@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ efi/libstub: fix efi_parse_options() ignoring the default command line (@Jonathan Marek in [c365c1456ec97fe](https://github.com/sophgo/linux-riscv/commit/c365c1456ec97fe) at 2024-12-05 13:01:27)
    > [ Upstream commit aacfa0ef247b0130b7a98bb52378f8cd727a66ca ]
    > efi_convert_cmdline() always returns a size of at least 1 because it
    > counts the NUL terminator, so the &quot;cmdline_size &#x3D;&#x3D; 0&quot; condition is never
    > satisfied.
    > Change it to check if the string starts with a NUL character to get the
    > intended behavior: to use CONFIG_CMDLINE when load_options_size &#x3D;&#x3D; 0.
    > Fixes: 60f38de7a8d4 (&quot;efi/libstub: Unify command line param parsing&quot;)
    > Signed-off-by: Jonathan Marek &lt;jonathan@marek.ca&gt;
    > Signed-off-by: Ard Biesheuvel &lt;ardb@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ arm64: dts: qcom: x1e80100-vivobook-s15: Drop orientation-switch from USB SS[0-1] QMP PHYs (@Abel Vesa in [76f95446ad902ec](https://github.com/sophgo/linux-riscv/commit/76f95446ad902ec) at 2024-12-05 13:01:27)
    > [ Upstream commit 27344eb70c8fd60fe7c570e2e12f169ff89d2c47 ]
    > The orientation-switch is already set in the x1e80100 SoC dtsi,
    > so drop from Vivobook S15 dts.
    > Fixes: d0e2f8f62dff (&quot;arm64: dts: qcom: Add device tree for ASUS Vivobook S 15&quot;)
    > Signed-off-by: Abel Vesa &lt;abel.vesa@linaro.org&gt;
    > Link: https://lore.kernel.org/r/20241014-x1e80100-dts-drop-orientation-switch-v1-2-26afa6d4afd9@linaro.org
    > Signed-off-by: Bjorn Andersson &lt;andersson@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ tpm: fix signed/unsigned bug when checking event logs (@Gregory Price in [30e42ac0bddf237](https://github.com/sophgo/linux-riscv/commit/30e42ac0bddf237) at 2024-12-05 13:01:27)
    > [ Upstream commit e6d654e9f5a97742cfe794b1c4bb5d3fb2d25e98 ]
    > A prior bugfix that fixes a signed/unsigned error causes
    > another signed unsigned error.
    > A situation where log_tbl-&gt;size is invalid can cause the
    > size passed to memblock_reserve to become negative.
    > log_size from the main event log is an unsigned int, and
    > the code reduces to the following
    > u64 value &#x3D; (int)unsigned_value;
    > This results in sign extension, and the value sent to
    > memblock_reserve becomes effectively negative.
    > Fixes: be59d57f9806 (&quot;efi/tpm: Fix sanity check of unsigned tbl_size being less than zero&quot;)
    > Signed-off-by: Gregory Price &lt;gourry@gourry.net&gt;
    > Reviewed-by: Ilias Apalodimas &lt;ilias.apalodimas@linaro.org&gt;
    > Signed-off-by: Ard Biesheuvel &lt;ardb@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ media: i2c: vgxy61: Fix an error handling path in vgxy61_detect() (@Christophe JAILLET in [30357297dc8c246](https://github.com/sophgo/linux-riscv/commit/30357297dc8c246) at 2024-12-05 13:01:27)
    > [ Upstream commit 0d5c92cde4d38825eeadf5b4e1534350f80a9924 ]
    > If cci_read() fails, &#x27;st&#x27; is set to 0 in cci_read(), so we return success,
    > instead of the expected error code.
    > Fix it and return the expected error.
    > Fixes: 9a6d7f2ba2b9 (&quot;media: i2c: st-vgxy61: Convert to CCI register access helpers&quot;)
    > Signed-off-by: Christophe JAILLET &lt;christophe.jaillet@wanadoo.fr&gt;
    > Reviewed-by: Benjamin Mugnier &lt;benjamin.mugnier@foss.st.com&gt;
    > Signed-off-by: Sakari Ailus &lt;sakari.ailus@linux.intel.com&gt;
    > Signed-off-by: Mauro Carvalho Chehab &lt;mchehab+huawei@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ arm64: dts: qcom: x1e80100-slim7x: Drop orientation-switch from USB SS[0-1] QMP PHYs (@Abel Vesa in [f5c3f0223a1a558](https://github.com/sophgo/linux-riscv/commit/f5c3f0223a1a558) at 2024-12-05 13:01:26)
    > [ Upstream commit eb2dd93d03b16ed0e8b09311f8d35cc5a691a9b7 ]
    > The orientation-switch is already set in the x1e80100 SoC dtsi,
    > so drop from Slim 7X dts.
    > Fixes: 45247fe17db2 (&quot;arm64: dts: qcom: x1e80100: add Lenovo Thinkpad Yoga slim 7x devicetree&quot;)
    > Signed-off-by: Abel Vesa &lt;abel.vesa@linaro.org&gt;
    > Link: https://lore.kernel.org/r/20241014-x1e80100-dts-drop-orientation-switch-v1-1-26afa6d4afd9@linaro.org
    > Signed-off-by: Bjorn Andersson &lt;andersson@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ARM: dts: microchip: sam9x60: Add missing property atmel,usart-mode (@Andrei Simion in [5a23de8fcf50c6e](https://github.com/sophgo/linux-riscv/commit/5a23de8fcf50c6e) at 2024-12-05 13:01:26)
    > [ Upstream commit 2f9d013a0c6f1b9109ada5acb28ee26eefc77c03 ]
    > Add the atmel,usart-mode property to the UART nodes. This ensures
    > compliance with the atmel,at91-usart.yaml schema and resolves the errors
    > below:
    > serial@200: $nodename:0: &#x27;serial@200&#x27; does not match
    > &#x27;^spi(@.*|-([0-9]|[1-9][0-9]+))?$&#x27;
    > serial@200: atmel,use-dma-rx: False schema does not allow True
    > serial@200: atmel,use-dma-tx: False schema does not allow True
    > serial@200: atmel,fifo-size: False schema does not allow [[16]]
    > These errors indicate that the property
    > atmel,usart-mode &#x3D; &lt;AT91_USART_MODE_SERIAL&gt; is missing for
    > UART nodes 0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, and 12.
    > Fixes: 99c808335877 (&quot;ARM: dts: at91: sam9x60: Add missing flexcom definitions&quot;)
    > Acked-by: Nicolas Ferre &lt;nicolas.ferre@microchip.com&gt;
    > Signed-off-by: Andrei Simion &lt;andrei.simion@microchip.com&gt;
    > Link: https://lore.kernel.org/r/20240912093307.40488-1-andrei.simion@microchip.com
    > [claudiu.beznea: move the atmel,usart-mode close to vendor specific
    > properties to cope with DTS coding style]
    > Signed-off-by: Claudiu Beznea &lt;claudiu.beznea@tuxon.dev&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ scripts/kernel-doc: Do not track section counter across processed files (@Chen-Yu Tsai in [560a210128d313f](https://github.com/sophgo/linux-riscv/commit/560a210128d313f) at 2024-12-05 13:01:26)
    > [ Upstream commit be9264110e4e874622d588a75daf930539fdf6ea ]
    > The section counter tracks how many sections of kernel-doc were added.
    > The only real use of the counter value is to check if anything was
    > actually supposed to be output and give a warning is nothing is
    > available.
    > The current logic of remembering the initial value and then resetting
    > the value then when processing each file means that if a file has the
    > same number of sections as the previously processed one, a warning is
    > incorrectly given.
    > Fixes: 1da177e4c3f4 (&quot;Linux-2.6.12-rc2&quot;)
    > Signed-off-by: Chen-Yu Tsai &lt;wenst@chromium.org&gt;
    > Signed-off-by: Jonathan Corbet &lt;corbet@lwn.net&gt;
    > Link: https://lore.kernel.org/r/20241008082905.4005524-1-wenst@chromium.org
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ arm64: dts: qcom: sm6350: Fix GPU frequencies missing on some speedbins (@Luca Weiss in [51cb2eea12ae54b](https://github.com/sophgo/linux-riscv/commit/51cb2eea12ae54b) at 2024-12-05 13:01:26)
    > [ Upstream commit 600c499f8f5297c2c91e8146a8217f299e445ef6 ]
    > Make sure the GPU frequencies are marked as supported for the respective
    > speedbins according to downstream msm-4.19 kernel:
    > 850 MHz: Speedbins 0 + 180
    > 800 MHz: Speedbins 0 + 180 + 169
    > 650 MHz: Speedbins 0 + 180 + 169 + 138
    > 565 MHz: Speedbins 0 + 180 + 169 + 138 + 120
    > 430 MHz: Speedbins 0 + 180 + 169 + 138 + 120
    > 355 MHz: Speedbins 0 + 180 + 169 + 138 + 120
    > 253 MHz: Speedbins 0 + 180 + 169 + 138 + 120
    > Fixes: bd9b76750280 (&quot;arm64: dts: qcom: sm6350: Add GPU nodes&quot;)
    > Signed-off-by: Luca Weiss &lt;luca.weiss@fairphone.com&gt;
    > Link: https://lore.kernel.org/r/20241002-sm6350-gpu-speedbin-fix-v1-1-8a5d90c5097d@fairphone.com
    > Signed-off-by: Bjorn Andersson &lt;andersson@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ arm64: dts: qcom: sda660-ifc6560: fix l10a voltage ranges (@Dmitry Baryshkov in [4cd94fc2b1ec79f](https://github.com/sophgo/linux-riscv/commit/4cd94fc2b1ec79f) at 2024-12-05 13:01:26)
    > [ Upstream commit 1dd7d9d41dedf8d42e04c0f2febd4dbe5a062d4a ]
    > L10A, being a fixed regulator, should have min_voltage &#x3D; max_voltage,
    > otherwise fixed rulator fails to probe. Fix the max_voltage range to be
    > equal to minimum.
    > Fixes: 4edbcf264fe2 (&quot;arm64: dts: qcom: sda660-ifc6560: document missing USB PHY supplies&quot;)
    > Signed-off-by: Dmitry Baryshkov &lt;dmitry.baryshkov@linaro.org&gt;
    > Reviewed-by: Konrad Dybcio &lt;konradybcio@kernel.org&gt;
    > Link: https://lore.kernel.org/r/20240907-sdm660-wifi-v1-4-e316055142f8@linaro.org
    > Signed-off-by: Bjorn Andersson &lt;andersson@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ soc: qcom: geni-se: fix array underflow in geni_se_clk_tbl_get() (@Dan Carpenter in [351bb7f9ecb9d1f](https://github.com/sophgo/linux-riscv/commit/351bb7f9ecb9d1f) at 2024-12-05 13:01:26)
    > [ Upstream commit 78261cb08f06c93d362cab5c5034bf5899bc7552 ]
    > This loop is supposed to break if the frequency returned from
    > clk_round_rate() is the same as on the previous iteration.  However,
    > that check doesn&#x27;t make sense on the first iteration through the loop.
    > It leads to reading before the start of these-&gt;clk_perf_tbl[] array.
    > Fixes: eddac5af0654 (&quot;soc: qcom: Add GENI based QUP Wrapper driver&quot;)
    > Signed-off-by: Dan Carpenter &lt;dan.carpenter@linaro.org&gt;
    > Link: https://lore.kernel.org/r/8cd12678-f44a-4b16-a579-c8f11175ee8c@stanley.mountain
    > Signed-off-by: Bjorn Andersson &lt;andersson@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ mmc: mmc_spi: drop buggy snprintf() (@Bartosz Golaszewski in [05024c3e4949828](https://github.com/sophgo/linux-riscv/commit/05024c3e4949828) at 2024-12-05 13:01:26)
    > [ Upstream commit 328bda09cc91b3d93bc64f4a4dadc44313dd8140 ]
    > GCC 13 complains about the truncated output of snprintf():
    > drivers/mmc/host/mmc_spi.c: In function ‘mmc_spi_response_get’:
    > drivers/mmc/host/mmc_spi.c:227:64: error: ‘snprintf’ output may be truncated before the last format character [-Werror&#x3D;format-truncation&#x3D;]
    > 227 |         snprintf(tag, sizeof(tag), &quot;  ... CMD%d response SPI_%s&quot;,
    > |                                                                ^
    > drivers/mmc/host/mmc_spi.c:227:9: note: ‘snprintf’ output between 26 and 43 bytes into a destination of size 32
    > 227 |         snprintf(tag, sizeof(tag), &quot;  ... CMD%d response SPI_%s&quot;,
    > |         ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    > 228 |                 cmd-&gt;opcode, maptype(cmd));
    > Drop it and fold the string it generates into the only place where it&#x27;s
    > emitted - the dev_dbg() call at the end of the function.
    > Fixes: 15a0580ced08 (&quot;mmc_spi host driver&quot;)
    > Suggested-by: Christophe JAILLET &lt;christophe.jaillet@wanadoo.fr&gt;
    > Signed-off-by: Bartosz Golaszewski &lt;bartosz.golaszewski@linaro.org&gt;
    > Link: https://lore.kernel.org/r/20241008160134.69934-1-brgl@bgdev.pl
    > Signed-off-by: Ulf Hansson &lt;ulf.hansson@linaro.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ arm64: dts: mediatek: mt8183-kukui: Disable DPI display interface (@Alper Nebi Yasak in [c31f77d9985ed8c](https://github.com/sophgo/linux-riscv/commit/c31f77d9985ed8c) at 2024-12-05 13:01:25)
    > [ Upstream commit 377548f05bd0905db52a1d50e5b328b9b4eb049d ]
    > Commit 009d855a26fd (&quot;arm64: dts: mt8183: add dpi node to mt8183&quot;) adds
    > a device-tree node for the DPI display interface that feeds the external
    > display pipeline, to enable HDMI support on the Pumpkin board.
    > However, the external display is not fully described on Chrome devices,
    > blocked by further work on DP / USB-C muxing graph bindings. This
    > incomplete description currently breaks internal display at least on the
    > Cozmo board. The same issue was found and fixed on MT8186 devices with
    > commit 3079fb09ddac (&quot;arm64: dts: mediatek: mt8186-corsola: Disable DPI
    > display interface&quot;), but the MT8183 change wasn&#x27;t merged until then.
    > Disable the external display interface for the Kukui device family until
    > the necessary work is done, like in the MT8186 Corsola case.
    > Fixes: 009d855a26fd (&quot;arm64: dts: mt8183: add dpi node to mt8183&quot;)
    > Link: https://lore.kernel.org/linux-mediatek/20240821042836.2631815-1-wenst@chromium.org/
    > Signed-off-by: Alper Nebi Yasak &lt;alpernebiyasak@gmail.com&gt;
    > Reviewed-by: Pin-yen Lin &lt;treapking@chromium.org&gt;
    > Reviewed-by: AngeloGioacchino Del Regno &lt;angelogioacchino.delregno@collabora.com&gt;
    > Link: https://lore.kernel.org/r/20240916162956.267340-1-alpernebiyasak@gmail.com
    > Signed-off-by: AngeloGioacchino Del Regno &lt;angelogioacchino.delregno@collabora.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ arm64: dts: mediatek: mt8395-genio-1200-evk: Fix dtbs_check error for phy (@Macpaul Lin in [a878175b8c0ab8b](https://github.com/sophgo/linux-riscv/commit/a878175b8c0ab8b) at 2024-12-05 13:01:25)
    > [ Upstream commit 752804acea010959bb3a00c65acdf78086a8474c ]
    > The ethernet-phy node in mt8395-genio-1200-evk.dts was triggering a
    > dtbs_check error. The error message was:
    > eth-phy0@1: $nodename:0: &#x27;eth-phy0@1&#x27; does not match
    > &#x27;^ethernet-phy(@[a-f0-9]+)?$&#x27;
    > Fix this issue by replacing &#x27;eth-phy&#x27; node to generic &#x27;ethernet-phy&#x27;.
    > Fixes: f2b543a191b6 (&quot;arm64: dts: mediatek: add device-tree for Genio 1200 EVK board&quot;)
    > Signed-off-by: Macpaul Lin &lt;macpaul.lin@mediatek.com&gt;
    > Reviewed-by: AngeloGioacchino Del Regno &lt;angelogioacchino.delregno@collabora.com&gt;
    > Link: https://lore.kernel.org/r/20241002051620.2050-3-macpaul.lin@mediatek.com
    > Signed-off-by: AngeloGioacchino Del Regno &lt;angelogioacchino.delregno@collabora.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ arm64: dts: mt8183: Add port node to dpi node (@Pin-yen Lin in [993e83dc3217ef5](https://github.com/sophgo/linux-riscv/commit/993e83dc3217ef5) at 2024-12-05 13:01:25)
    > [ Upstream commit ec1a37b3cd0cf9a1bf88816a5342fb06e3316b34 ]
    > Add the port node to fix the binding schema check.
    > Fixes: 009d855a26fd (&quot;arm64: dts: mt8183: add dpi node to mt8183&quot;)
    > Signed-off-by: Pin-yen Lin &lt;treapking@chromium.org&gt;
    > Reported-by: kernel test robot &lt;lkp@intel.com&gt;
    > Closes: https://lore.kernel.org/oe-kbuild-all/202409110843.Hm5W9upr-lkp@intel.com/
    > Link: https://lore.kernel.org/r/20240912144430.3161717-3-treapking@chromium.org
    > Signed-off-by: AngeloGioacchino Del Regno &lt;angelogioacchino.delregno@collabora.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ soc: ti: smartreflex: Use IRQF_NO_AUTOEN flag in request_irq() (@Jinjie Ruan in [9744b4b5b28e358](https://github.com/sophgo/linux-riscv/commit/9744b4b5b28e358) at 2024-12-05 13:01:25)
    > [ Upstream commit 16a0a69244240cfa32c525c021c40f85e090557a ]
    > If request_irq() fails in sr_late_init(), there is no need to enable
    > the irq, and if it succeeds, disable_irq() after request_irq() still has
    > a time gap in which interrupts can come.
    > request_irq() with IRQF_NO_AUTOEN flag will disable IRQ auto-enable when
    > request IRQ.
    > Fixes: 1279ba5916f6 (&quot;OMAP3+: SR: disable interrupt by default&quot;)
    > Signed-off-by: Jinjie Ruan &lt;ruanjinjie@huawei.com&gt;
    > Link: https://lore.kernel.org/r/20240912034147.3014213-1-ruanjinjie@huawei.com
    > Signed-off-by: Kevin Hilman &lt;khilman@baylibre.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ arm64: dts: mt8195: Fix dtbs_check error for infracfg_ao node (@Macpaul Lin in [277f5b4ff2f8858](https://github.com/sophgo/linux-riscv/commit/277f5b4ff2f8858) at 2024-12-05 13:01:25)
    > [ Upstream commit c14ab45f5d458073248ddc62d31045d5d616806f ]
    > The infracfg_ao node in mt8195.dtsi was causing a dtbs_check error.
    > The error message was:
    > syscon@10001000: compatible: [&#x27;mediatek,mt8195-infracfg_ao&#x27;, &#x27;syscon&#x27;,
    > &#x27;simple-mfd&#x27;] is too long
    > To resolve this, remove &#x27;simple-mfd&#x27; from the &#x27;compatible&#x27; property of the
    > infracfg_ao node.
    > Fixes: 37f2582883be (&quot;arm64: dts: Add mediatek SoC mt8195 and evaluation board&quot;)
    > Signed-off-by: Macpaul Lin &lt;macpaul.lin@mediatek.com&gt;
    > Reviewed-by: AngeloGioacchino Del Regno &lt;angelogioacchino.delregno@collabora.com&gt;
    > Link: https://lore.kernel.org/r/20241002051620.2050-1-macpaul.lin@mediatek.com
    > Signed-off-by: AngeloGioacchino Del Regno &lt;angelogioacchino.delregno@collabora.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ arm64: dts: mt8195: Fix dtbs_check error for mutex node (@Macpaul Lin in [1022a7bcd3bd96d](https://github.com/sophgo/linux-riscv/commit/1022a7bcd3bd96d) at 2024-12-05 13:01:25)
    > [ Upstream commit 0fc557b539a1e11bdc5053a308b12d84ea754786 ]
    > The mutex node in mt8195.dtsi was triggering a dtbs_check error:
    > mutex@1c101000: &#x27;clock-names&#x27;, &#x27;reg-names&#x27; do not match any of the
    > regexes: &#x27;pinctrl-[0-9]+&#x27;
    > This seems no need by inspecting the DT schemas and other reference boards,
    > so drop &#x27;clock-names&#x27; and &#x27;reg-names&#x27; in mt8195.dtsi.
    > Fixes: 92d2c23dc269 (&quot;arm64: dts: mt8195: add display node for vdosys1&quot;)
    > Signed-off-by: Macpaul Lin &lt;macpaul.lin@mediatek.com&gt;
    > Reviewed-by: AngeloGioacchino Del Regno &lt;angelogioacchino.delregno@collabora.com&gt;
    > Link: https://lore.kernel.org/r/20241002051620.2050-4-macpaul.lin@mediatek.com
    > Signed-off-by: AngeloGioacchino Del Regno &lt;angelogioacchino.delregno@collabora.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ microblaze: Export xmb_manager functions (@Michal Simek in [b83990842aa041d](https://github.com/sophgo/linux-riscv/commit/b83990842aa041d) at 2024-12-05 13:01:24)
    > [ Upstream commit badf752b5e4b17d281f93f409d4718388ff912e6 ]
    > When TMR_MANAGER is enabled as module there is a need to export functions
    > which are present in architecture code.
    > It has been found by running:
    > make W&#x3D;1 C&#x3D;1 allmodconfig
    > sed -i -e &#x27;s/WERROR&#x3D;y/WERROR&#x3D;n/g&#x27; .config
    > make C&#x3D;1 W&#x3D;1
    > which errors out like this:
    > ERROR: modpost: &quot;xmb_manager_register&quot; [drivers/misc/xilinx_tmr_manager.ko] undefined!
    > ERROR: modpost: &quot;xmb_inject_err&quot; [drivers/misc/xilinx_tmr_inject.ko] undefined!
    > Fixes: a5e3aaa654c1 (&quot;microblaze: Add xmb_manager_register function&quot;)
    > Reported-by: Jeff Johnson &lt;quic_jjohnson@quicinc.com&gt;
    > Signed-off-by: Michal Simek &lt;michal.simek@amd.com&gt;
    > Link: https://lore.kernel.org/r/e322dbbbde0feef83f44304ea13249d365d1dc5f.1718799090.git.michal.simek@amd.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ arm64: dts: mediatek: mt8188: Fix wrong clock provider in MFG1 power domain (@Pablo Sun in [9b2f76d7b53f5b0](https://github.com/sophgo/linux-riscv/commit/9b2f76d7b53f5b0) at 2024-12-05 13:01:24)
    > [ Upstream commit 4007651c25553b10dbc6e7bff6b7abd2863c1702 ]
    > The clock index &quot;CLK_APMIXED_MFGPLL&quot; belongs to the &quot;apmixedsys&quot; provider,
    > so fix the index.
    > In addition, add a &quot;mfg1&quot; label so following commits could set
    > domain-supply for MFG1 power domain.
    > Fixes: eaf73e4224a3 (&quot;arm64: dts: mediatek: mt8188: Add support for SoC power domains&quot;)
    > Signed-off-by: Pablo Sun &lt;pablo.sun@mediatek.com&gt;
    > Reviewed-by: AngeloGioacchino Del Regno &lt;angelogioacchino.delregno@collabora.com&gt;
    > Link: https://lore.kernel.org/r/20241002022138.29241-2-pablo.sun@mediatek.com
    > Signed-off-by: AngeloGioacchino Del Regno &lt;angelogioacchino.delregno@collabora.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ regulator: qcom-smd: make smd_vreg_rpm static (@Min-Hua Chen in [7b6f8e75f144f6f](https://github.com/sophgo/linux-riscv/commit/7b6f8e75f144f6f) at 2024-12-05 13:01:24)
    > [ Upstream commit 18be43aca2c0ec475037923a8086d0a29fcc9d16 ]
    > Since smd_vreg_rpm is used only in
    > drivers/regulator/qcom_smd-regulator.c, make it static and fix the
    > following sparse warning:
    > drivers/regulator/qcom_smd-regulator.c:14:21: sparse: warning:
    > symbol &#x27;smd_vreg_rpm&#x27; was not declared. Should it be static?
    > No functional changes intended.
    > Fixes: 5df3b41bd6b5 (&quot;regulator: qcom_smd: Keep one rpm handle for all vregs&quot;)
    > Signed-off-by: Min-Hua Chen &lt;minhuadotchen@gmail.com&gt;
    > Reviewed-by: Dmitry Baryshkov &lt;dmitry.baryshkov@linaro.org&gt;
    > Link: https://patch.msgid.link/20240926231038.31916-1-minhuadotchen@gmail.com
    > Signed-off-by: Mark Brown &lt;broonie@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ spi: spi-fsl-lpspi: Use IRQF_NO_AUTOEN flag in request_irq() (@Jinjie Ruan in [65f51f5ad9fc29b](https://github.com/sophgo/linux-riscv/commit/65f51f5ad9fc29b) at 2024-12-05 13:01:24)
    > [ Upstream commit 003c7e01916c5e2af95add9b0cbda2e6163873e8 ]
    > disable_irq() after request_irq() still has a time gap in which
    > interrupts can come. request_irq() with IRQF_NO_AUTOEN flag will
    > disable IRQ auto-enable when request IRQ.
    > Fixes: 9728fb3ce117 (&quot;spi: lpspi: disable lpspi module irq in DMA mode&quot;)
    > Signed-off-by: Jinjie Ruan &lt;ruanjinjie@huawei.com&gt;
    > Link: https://patch.msgid.link/20240906022828.891812-1-ruanjinjie@huawei.com
    > Signed-off-by: Mark Brown &lt;broonie@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ arm64: dts: qcom: qcs6390-rb3gen2: use modem.mbn for modem DSP (@Dmitry Baryshkov in [64739107300963f](https://github.com/sophgo/linux-riscv/commit/64739107300963f) at 2024-12-05 13:01:24)
    > [ Upstream commit 6317aad0e1525f3e3609d9a0fea762a37799943a ]
    > Newer boards should always use squashed MBN firmware instead of split
    > MDT+bNN. Use qcom/qcs6490/modem.mbn as the firmware for the modem on
    > RB3gen2.
    > Fixes: ac6d35b9b74c (&quot;arm64: dts: qcom: qcs6490-rb3gen2: Enable various remoteprocs&quot;)
    > Signed-off-by: Dmitry Baryshkov &lt;dmitry.baryshkov@linaro.org&gt;
    > Reviewed-by: Konrad Dybcio &lt;konradybcio@kernel.org&gt;
    > Link: https://lore.kernel.org/r/20240907-rb3g2-fixes-v1-1-eb9da98e9f80@linaro.org
    > Signed-off-by: Bjorn Andersson &lt;andersson@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drivers: soc: xilinx: add the missing kfree in xlnx_add_cb_for_suspend() (@Gaosheng Cui in [584d420771e1ad2](https://github.com/sophgo/linux-riscv/commit/584d420771e1ad2) at 2024-12-05 13:01:24)
    > [ Upstream commit 44ed4f90a97ff6f339e50ac01db71544e0990efc ]
    > If we fail to allocate memory for cb_data by kmalloc, the memory
    > allocation for eve_data is never freed, add the missing kfree()
    > in the error handling path.
    > Fixes: 05e5ba40ea7a (&quot;driver: soc: xilinx: Add support of multiple callbacks for same event in event management driver&quot;)
    > Signed-off-by: Gaosheng Cui &lt;cuigaosheng1@huawei.com&gt;
    > Link: https://lore.kernel.org/r/20240706065155.452764-1-cuigaosheng1@huawei.com
    > Signed-off-by: Michal Simek &lt;michal.simek@amd.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ARM: dts: renesas: genmai: Fix partition size for QSPI NOR Flash (@Wolfram Sang in [35f9c48901c93ce](https://github.com/sophgo/linux-riscv/commit/35f9c48901c93ce) at 2024-12-05 13:01:24)
    > [ Upstream commit 48e17816c3effa3545e21cd4f7d5a00c55c17a18 ]
    > Second partition was too large, looks like two digits got mixed up.
    > Fixes:
    > mtd: partition &quot;user1&quot; extends beyond the end of device &quot;18000000.flash&quot; -- size truncated to 0x4000000
    > Fixes: 30e0a8cf886c (&quot;ARM: dts: renesas: genmai: Add FLASH nodes&quot;)
    > Signed-off-by: Wolfram Sang &lt;wsa+renesas@sang-engineering.com&gt;
    > Reviewed-by: Geert Uytterhoeven &lt;geert+renesas@glider.be&gt;
    > Link: https://lore.kernel.org/20240914182948.94031-2-wsa+renesas@sang-engineering.com
    > Signed-off-by: Geert Uytterhoeven &lt;geert+renesas@glider.be&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ clocksource/drivers:sp804: Make user selectable (@Mark Brown in [bcede8bb508d2dd](https://github.com/sophgo/linux-riscv/commit/bcede8bb508d2dd) at 2024-12-05 13:01:23)
    > [ Upstream commit 0309f714a0908e947af1c902cf6a330cb593e75e ]
    > The sp804 is currently only user selectable if COMPILE_TEST, this was
    > done by commit dfc82faad725 (&quot;clocksource/drivers/sp804: Add
    > COMPILE_TEST to CONFIG_ARM_TIMER_SP804&quot;) in order to avoid it being
    > spuriously offered on platforms that won&#x27;t have the hardware since it&#x27;s
    > generally only seen on Arm based platforms.  This config is overly
    > restrictive, while platforms that rely on the SP804 do select it in
    > their Kconfig there are others such as the Arm fast models which have a
    > SP804 available but currently unused by Linux.  Relax the dependency to
    > allow it to be user selectable on arm and arm64 to avoid surprises and
    > in case someone comes up with a use for extra timer hardware.
    > Fixes: dfc82faad725 (&quot;clocksource/drivers/sp804: Add COMPILE_TEST to CONFIG_ARM_TIMER_SP804&quot;)
    > Reported-by: Ross Burton &lt;ross.burton@arm.com&gt;
    > Reviewed-by: Sudeep Holla &lt;sudeep.holla@arm.com&gt;
    > Acked-by: Mark Rutland &lt;mark.rutland@arm.com&gt;
    > Signed-off-by: Mark Brown &lt;broonie@kernel.org&gt;
    > Link: https://lore.kernel.org/r/20241001-arm64-vexpress-sp804-v3-1-0a2d3f7883e4@kernel.org
    > Signed-off-by: Daniel Lezcano &lt;daniel.lezcano@linaro.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ locking/rt: Add sparse annotation PREEMPT_RT&#x27;s sleeping locks. (@Sebastian Andrzej Siewior in [92848c5f8057c96](https://github.com/sophgo/linux-riscv/commit/92848c5f8057c96) at 2024-12-05 13:01:23)
    > [ Upstream commit 52e0874fc16bd26e9ea1871e30ffb2c6dff187cf ]
    > The sleeping locks on PREEMPT_RT (rt_spin_lock() and friends) lack
    > sparse annotation. Therefore a missing spin_unlock() won&#x27;t be spotted by
    > sparse in a PREEMPT_RT build while it is noticed on a !PREEMPT_RT build.
    > Add the __acquires/__releases macros to the lock/ unlock functions. The
    > trylock functions already use the __cond_lock() wrapper.
    > Signed-off-by: Sebastian Andrzej Siewior &lt;bigeasy@linutronix.de&gt;
    > Signed-off-by: Thomas Gleixner &lt;tglx@linutronix.de&gt;
    > Link: https://lore.kernel.org/all/20240812104200.2239232-2-bigeasy@linutronix.de
    > Stable-dep-of: 5c2e7736e20d (&quot;rust: helpers: Avoid raw_spin_lock initialization for PREEMPT_RT&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ kcsan, seqlock: Fix incorrect assumption in read_seqbegin() (@Marco Elver in [8dbd7603e4b5bd3](https://github.com/sophgo/linux-riscv/commit/8dbd7603e4b5bd3) at 2024-12-05 13:01:23)
    > [ Upstream commit 183ec5f26b2fc97a4a9871865bfe9b33c41fddb2 ]
    > During testing of the preceding changes, I noticed that in some cases,
    > current-&gt;kcsan_ctx.in_flat_atomic remained true until task exit. This is
    > obviously wrong, because _all_ accesses for the given task will be
    > treated as atomic, resulting in false negatives i.e. missed data races.
    > Debugging led to fs/dcache.c, where we can see this usage of seqlock:
    > struct dentry *d_lookup(const struct dentry *parent, const struct qstr *name)
    > {
    > struct dentry *dentry;
    > unsigned seq;
    > do {
    > seq &#x3D; read_seqbegin(&amp;rename_lock);
    > dentry &#x3D; __d_lookup(parent, name);
    > if (dentry)
    > break;
    > } while (read_seqretry(&amp;rename_lock, seq));
    > [...]
    > As can be seen, read_seqretry() is never called if dentry !&#x3D; NULL;
    > consequently, current-&gt;kcsan_ctx.in_flat_atomic will never be reset to
    > false by read_seqretry().
    > Give up on the wrong assumption of &quot;assume closing read_seqretry()&quot;, and
    > rely on the already-present annotations in read_seqcount_begin/retry().
    > Fixes: 88ecd153be95 (&quot;seqlock, kcsan: Add annotations for KCSAN&quot;)
    > Signed-off-by: Marco Elver &lt;elver@google.com&gt;
    > Signed-off-by: Peter Zijlstra (Intel) &lt;peterz@infradead.org&gt;
    > Link: https://lore.kernel.org/r/20241104161910.780003-6-elver@google.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ clocksource/drivers/timer-ti-dm: Fix child node refcount handling (@Javier Carrasco in [3fc6fc23d07dec0](https://github.com/sophgo/linux-riscv/commit/3fc6fc23d07dec0) at 2024-12-05 13:01:23)
    > [ Upstream commit e5cfc0989d9a2849c51c720a16b90b2c061a1aeb ]
    > of_find_compatible_node() increments the node&#x27;s refcount, and it must be
    > decremented again with a call to of_node_put() when the pointer is no
    > longer required to avoid leaking the resource.
    > Instead of adding the missing calls to of_node_put() in all execution
    > paths, use the cleanup attribute for &#x27;arm_timer&#x27; by means of the
    > __free() macro, which automatically calls of_node_put() when the
    > variable goes out of scope.
    > Fixes: 25de4ce5ed02 (&quot;clocksource/drivers/timer-ti-dm: Handle dra7 timer wrap errata i940&quot;)
    > Signed-off-by: Javier Carrasco &lt;javier.carrasco.cruz@gmail.com&gt;
    > Link: https://lore.kernel.org/r/20241031-timer-ti-dm-systimer-of_node_put-v3-1-063ee822b73a@gmail.com
    > Signed-off-by: Daniel Lezcano &lt;daniel.lezcano@linaro.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ irqchip/riscv-aplic: Prevent crash when MSI domain is missing (@Samuel Holland in [285a07810ab3bce](https://github.com/sophgo/linux-riscv/commit/285a07810ab3bce) at 2024-12-05 13:01:23)
    > [ Upstream commit 1f181d1cda56c2fbe379c5ace1aa1fac6306669e ]
    > If the APLIC driver is probed before the IMSIC driver, the parent MSI
    > domain will be missing, which causes a NULL pointer dereference in
    > msi_create_device_irq_domain().
    > Avoid this by deferring probe until the parent MSI domain is available. Use
    > dev_err_probe() to avoid printing an error message when returning
    > -EPROBE_DEFER.
    > Fixes: ca8df97fe679 (&quot;irqchip/riscv-aplic: Add support for MSI-mode&quot;)
    > Signed-off-by: Samuel Holland &lt;samuel.holland@sifive.com&gt;
    > Signed-off-by: Thomas Gleixner &lt;tglx@linutronix.de&gt;
    > Link: https://lore.kernel.org/all/20241114200133.3069460-1-samuel.holland@sifive.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ sched/ext: Remove sched_fork() hack (@Thomas Gleixner in [09162013082267a](https://github.com/sophgo/linux-riscv/commit/09162013082267a) at 2024-12-05 13:01:23)
    > [ Upstream commit 0f0d1b8e5010bfe1feeb4d78d137e41946a5370d ]
    > Instead of solving the underlying problem of the double invocation of
    > __sched_fork() for idle tasks, sched-ext decided to hack around the issue
    > by partially clearing out the entity struct to preserve the already
    > enqueued node. A provided analysis and solution has been ignored for four
    > months.
    > Now that someone else has taken care of cleaning it up, remove the
    > disgusting hack and clear out the full structure. Remove the comment in the
    > structure declaration as well, as there is no requirement for @node being
    > the last element anymore.
    > Fixes: f0e1a0643a59 (&quot;sched_ext: Implement BPF extensible scheduler class&quot;)
    > Signed-off-by: Thomas Gleixner &lt;tglx@linutronix.de&gt;
    > Signed-off-by: Peter Zijlstra (Intel) &lt;peterz@infradead.org&gt;
    > Acked-by: Tejun Heo &lt;tj@kernel.org&gt;
    > Link: https://lore.kernel.org/r/87ldy82wkc.ffs@tglx
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ rust: helpers: Avoid raw_spin_lock initialization for PREEMPT_RT (@Eder Zulian in [00ccce23e159ed5](https://github.com/sophgo/linux-riscv/commit/00ccce23e159ed5) at 2024-12-05 13:01:23)
    > [ Upstream commit 5c2e7736e20d9b348a44cafbfa639fe2653fbc34 ]
    > When PREEMPT_RT&#x3D;y, spin locks are mapped to rt_mutex types, so using
    > spinlock_check() + __raw_spin_lock_init() to initialize spin locks is
    > incorrect, and would cause build errors.
    > Introduce __spin_lock_init() to initialize a spin lock with lockdep
    > rquired information for PREEMPT_RT builds, and use it in the Rust
    > helper.
    > Fixes: d2d6422f8bd1 (&quot;x86: Allow to enable PREEMPT_RT.&quot;)
    > Closes: https://lore.kernel.org/oe-kbuild-all/202409251238.vetlgXE9-lkp@intel.com/
    > Reported-by: kernel test robot &lt;lkp@intel.com&gt;
    > Signed-off-by: Eder Zulian &lt;ezulian@redhat.com&gt;
    > Signed-off-by: Peter Zijlstra (Intel) &lt;peterz@infradead.org&gt;
    > Reviewed-by: Boqun Feng &lt;boqun.feng@gmail.com&gt;
    > Tested-by: Boqun Feng &lt;boqun.feng@gmail.com&gt;
    > Link: https://lore.kernel.org/r/20241107163223.2092690-2-ezulian@redhat.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ locking/atomic/x86: Use ALT_OUTPUT_SP() for __alternative_atomic64() (@Uros Bizjak in [ebfadf019e85c71](https://github.com/sophgo/linux-riscv/commit/ebfadf019e85c71) at 2024-12-05 13:01:22)
    > [ Upstream commit 8b64db9733c2e4d30fd068d0b9dcef7b4424b035 ]
    > CONFIG_X86_CMPXCHG64 variant of x86_32 __alternative_atomic64()
    > macro uses CALL instruction inside asm statement. Use
    > ALT_OUTPUT_SP() macro to add required dependence on %esp register.
    > Fixes: 819165fb34b9 (&quot;x86: Adjust asm constraints in atomic64 wrappers&quot;)
    > Signed-off-by: Uros Bizjak &lt;ubizjak@gmail.com&gt;
    > Signed-off-by: Peter Zijlstra (Intel) &lt;peterz@infradead.org&gt;
    > Link: https://lkml.kernel.org/r/20241103160954.3329-1-ubizjak@gmail.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ time: Fix references to _msecs_to_jiffies() handling of values (@Miguel Ojeda in [b62a8825d3289c0](https://github.com/sophgo/linux-riscv/commit/b62a8825d3289c0) at 2024-12-05 13:01:22)
    > [ Upstream commit 92b043fd995a63a57aae29ff85a39b6f30cd440c ]
    > The details about the handling of the &quot;normal&quot; values were moved
    > to the _msecs_to_jiffies() helpers in commit ca42aaf0c861 (&quot;time:
    > Refactor msecs_to_jiffies&quot;). However, the same commit still mentioned
    > __msecs_to_jiffies() in the added documentation.
    > Thus point to _msecs_to_jiffies() instead.
    > Fixes: ca42aaf0c861 (&quot;time: Refactor msecs_to_jiffies&quot;)
    > Signed-off-by: Miguel Ojeda &lt;ojeda@kernel.org&gt;
    > Signed-off-by: Thomas Gleixner &lt;tglx@linutronix.de&gt;
    > Link: https://lore.kernel.org/all/20241025110141.157205-2-ojeda@kernel.org
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ kcsan, seqlock: Support seqcount_latch_t (@Marco Elver in [a694fc092838bea](https://github.com/sophgo/linux-riscv/commit/a694fc092838bea) at 2024-12-05 13:01:22)
    > [ Upstream commit 5c1806c41ce0a0110db5dd4c483cf2dc28b3ddf0 ]
    > While fuzzing an arm64 kernel, Alexander Potapenko reported:
    > | BUG: KCSAN: data-race in ktime_get_mono_fast_ns / timekeeping_update
    > |
    > | write to 0xffffffc082e74248 of 56 bytes by interrupt on cpu 0:
    > |  update_fast_timekeeper kernel/time/timekeeping.c:430 [inline]
    > |  timekeeping_update+0x1d8/0x2d8 kernel/time/timekeeping.c:768
    > |  timekeeping_advance+0x9e8/0xb78 kernel/time/timekeeping.c:2344
    > |  update_wall_time+0x18/0x38 kernel/time/timekeeping.c:2360
    > |  [...]
    > |
    > | read to 0xffffffc082e74258 of 8 bytes by task 5260 on cpu 1:
    > |  __ktime_get_fast_ns kernel/time/timekeeping.c:372 [inline]
    > |  ktime_get_mono_fast_ns+0x88/0x174 kernel/time/timekeeping.c:489
    > |  init_srcu_struct_fields+0x40c/0x530 kernel/rcu/srcutree.c:263
    > |  init_srcu_struct+0x14/0x20 kernel/rcu/srcutree.c:311
    > |  [...]
    > |
    > | value changed: 0x000002f875d33266 -&gt; 0x000002f877416866
    > |
    > | Reported by Kernel Concurrency Sanitizer on:
    > | CPU: 1 UID: 0 PID: 5260 Comm: syz.2.7483 Not tainted 6.12.0-rc3-dirty #78
    > This is a false positive data race between a seqcount latch writer and a reader
    > accessing stale data. Since its introduction, KCSAN has never understood the
    > seqcount_latch interface (due to being unannotated).
    > Unlike the regular seqlock interface, the seqcount_latch interface for latch
    > writers never has had a well-defined critical section, making it difficult to
    > teach tooling where the critical section starts and ends.
    > Introduce an instrumentable (non-raw) seqcount_latch interface, with
    > which we can clearly denote writer critical sections. This both helps
    > readability and tooling like KCSAN to understand when the writer is done
    > updating all latch copies.
    > Fixes: 88ecd153be95 (&quot;seqlock, kcsan: Add annotations for KCSAN&quot;)
    > Reported-by: Alexander Potapenko &lt;glider@google.com&gt;
    > Co-developed-by: &quot;Peter Zijlstra (Intel)&quot; &lt;peterz@infradead.org&gt;
    > Signed-off-by: &quot;Peter Zijlstra (Intel)&quot; &lt;peterz@infradead.org&gt;
    > Signed-off-by: Marco Elver &lt;elver@google.com&gt;
    > Signed-off-by: Peter Zijlstra (Intel) &lt;peterz@infradead.org&gt;
    > Link: https://lore.kernel.org/r/20241104161910.780003-4-elver@google.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ time: Partially revert cleanup on msecs_to_jiffies() documentation (@Miguel Ojeda in [5c3a9f6f7f23cd2](https://github.com/sophgo/linux-riscv/commit/5c3a9f6f7f23cd2) at 2024-12-05 13:01:22)
    > [ Upstream commit b05aefc1f5886c8aece650c9c1639c87b976191a ]
    > The documentation&#x27;s intention is to compare msecs_to_jiffies() (first
    > sentence) with __msecs_to_jiffies() (second sentence), which is what the
    > original documentation did. One of the cleanups in commit f3cb80804b82
    > (&quot;time: Fix various kernel-doc problems&quot;) may have thought the paragraph
    > was talking about the latter since that is what it is being documented.
    > Thus revert that part of the change.
    > Fixes: f3cb80804b82 (&quot;time: Fix various kernel-doc problems&quot;)
    > Signed-off-by: Miguel Ojeda &lt;ojeda@kernel.org&gt;
    > Signed-off-by: Thomas Gleixner &lt;tglx@linutronix.de&gt;
    > Link: https://lore.kernel.org/all/20241025110141.157205-1-ojeda@kernel.org
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ timers: Add missing READ_ONCE() in __run_timer_base() (@Thomas Gleixner in [1dfa6c520022b72](https://github.com/sophgo/linux-riscv/commit/1dfa6c520022b72) at 2024-12-05 13:01:22)
    > [ Upstream commit 1d4199cbbe95efaba51304cfd844bd0ccd224e61 ]
    > __run_timer_base() checks base::next_expiry without holding
    > base::lock. That can race with a remote CPU updating next_expiry under the
    > lock. This is an intentional and harmless data race, but lacks a
    > READ_ONCE(), so KCSAN complains about this.
    > Add the missing READ_ONCE(). All other places are covered already.
    > Fixes: 79f8b28e85f8 (&quot;timers: Annotate possible non critical data race of next_expiry&quot;)
    > Reported-by: kernel test robot &lt;oliver.sang@intel.com&gt;
    > Signed-off-by: Thomas Gleixner &lt;tglx@linutronix.de&gt;
    > Reviewed-by: Frederic Weisbecker &lt;frederic@kernel.org&gt;
    > Link: https://lore.kernel.org/all/87a5emyqk0.ffs@tglx
    > Closes: https://lore.kernel.org/oe-lkp/202410301205.ef8e9743-lkp@intel.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ locking/atomic/x86: Use ALT_OUTPUT_SP() for __arch_{,try_}cmpxchg64_emu() (@Uros Bizjak in [140a404a39ba129](https://github.com/sophgo/linux-riscv/commit/140a404a39ba129) at 2024-12-05 13:01:22)
    > [ Upstream commit 25cf4fbb596d730476afcc0fb87a9d708db14078 ]
    > x86_32 __arch_{,try_}cmpxchg64_emu()() macros use CALL instruction
    > inside asm statement. Use ALT_OUTPUT_SP() macro to add required
    > dependence on %esp register.
    > Fixes: 79e1dd05d1a2 (&quot;x86: Provide an alternative() based cmpxchg64()&quot;)
    > Signed-off-by: Uros Bizjak &lt;ubizjak@gmail.com&gt;
    > Signed-off-by: Peter Zijlstra (Intel) &lt;peterz@infradead.org&gt;
    > Link: https://lkml.kernel.org/r/20241103160954.3329-2-ubizjak@gmail.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ tools/lib/thermal: Make more generic the command encoding function (@Daniel Lezcano in [fe122921b15af88](https://github.com/sophgo/linux-riscv/commit/fe122921b15af88) at 2024-12-05 13:01:21)
    > [ Upstream commit 24b216b2d13568c703a76137ef54a2a9531a71d8 ]
    > The thermal netlink has been extended with more commands which require
    > an encoding with more information. The generic encoding function puts
    > the thermal zone id with the command name. It is the unique
    > parameters.
    > The next changes will provide more parameters to the command. Set the
    > scene for those new parameters by making the encoding function more
    > generic.
    > Signed-off-by: Daniel Lezcano &lt;daniel.lezcano@linaro.org&gt;
    > Reviewed-by: Lukasz Luba &lt;lukasz.luba@arm.com&gt;
    > Link: https://patch.msgid.link/20241022155147.463475-4-daniel.lezcano@linaro.org
    > Signed-off-by: Rafael J. Wysocki &lt;rafael.j.wysocki@intel.com&gt;
    > Stable-dep-of: 7569406e95f2 (&quot;thermal/lib: Fix memory leak on error in thermal_genl_auto()&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ rcuscale: Do a proper cleanup if kfree_scale_init() fails (@Uladzislau Rezki (Sony) in [e63f11b15db8e82](https://github.com/sophgo/linux-riscv/commit/e63f11b15db8e82) at 2024-12-05 13:01:21)
    > [ Upstream commit 812a1c3b9f7c36d9255f0d29d0a3d324e2f52321 ]
    > A static analyzer for C, Smatch, reports and triggers below
    > warnings:
    > kernel/rcu/rcuscale.c:1215 rcu_scale_init()
    > warn: inconsistent returns &#x27;global &amp;fullstop_mutex&#x27;.
    > The checker complains about, we do not unlock the &quot;fullstop_mutex&quot;
    > mutex, in case of hitting below error path:
    > &lt;snip&gt;
    > ...
    > if (WARN_ON_ONCE(jiffies_at_lazy_cb - jif_start &lt; 2 * HZ)) {
    > pr_alert(&quot;ERROR: call_rcu() CBs are not being lazy as expected!\n&quot;);
    > WARN_ON_ONCE(1);
    > return -1;
    > ^^^^^^^^^^
    > ...
    > &lt;snip&gt;
    > it happens because &quot;-1&quot; is returned right away instead of
    > doing a proper unwinding.
    > Fix it by jumping to &quot;unwind&quot; label instead of returning -1.
    > Reported-by: Dan Carpenter &lt;dan.carpenter@linaro.org&gt;
    > Reviewed-by: Paul E. McKenney &lt;paulmck@kernel.org&gt;
    > Reviewed-by: Neeraj Upadhyay &lt;Neeraj.Upadhyay@amd.com&gt;
    > Closes: https://lore.kernel.org/rcu/ZxfTrHuEGtgnOYWp@pc636/T/
    > Fixes: 084e04fff160 (&quot;rcuscale: Add laziness and kfree tests&quot;)
    > Signed-off-by: Uladzislau Rezki (Sony) &lt;urezki@gmail.com&gt;
    > Signed-off-by: Frederic Weisbecker &lt;frederic@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ thermal/lib: Fix memory leak on error in thermal_genl_auto() (@Daniel Lezcano in [ad3dad3f152e922](https://github.com/sophgo/linux-riscv/commit/ad3dad3f152e922) at 2024-12-05 13:01:21)
    > [ Upstream commit 7569406e95f2353070d88ebc88e8c13698542317 ]
    > The function thermal_genl_auto() does not free the allocated message
    > in the error path. Fix that by putting a out label and jump to it
    > which will free the message instead of directly returning an error.
    > Fixes: 47c4b0de080a (&quot;tools/lib/thermal: Add a thermal library&quot;)
    > Reported-by: Lukasz Luba &lt;lukasz.luba@arm.com&gt;
    > Signed-off-by: Daniel Lezcano &lt;daniel.lezcano@linaro.org&gt;
    > Reviewed-by: Lukasz Luba &lt;lukasz.luba@arm.com&gt;
    > Link: https://patch.msgid.link/20241024105938.1095358-1-daniel.lezcano@linaro.org
    > [ rjw: Fixed up the !msg error path, added Fixes tag ]
    > Signed-off-by: Rafael J. Wysocki &lt;rafael.j.wysocki@intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ crypto: cavium - Fix an error handling path in cpt_ucode_load_fw() (@Christophe JAILLET in [96de23233f3ee0a](https://github.com/sophgo/linux-riscv/commit/96de23233f3ee0a) at 2024-12-05 13:01:21)
    > [ Upstream commit 572b7cf08403b6c67dfe0dc3e0f2efb42443254f ]
    > If do_cpt_init() fails, a previous dma_alloc_coherent() call needs to be
    > undone.
    > Add the needed dma_free_coherent() before returning.
    > Fixes: 9e2c7d99941d (&quot;crypto: cavium - Add Support for Octeon-tx CPT Engine&quot;)
    > Signed-off-by: Christophe JAILLET &lt;christophe.jaillet@wanadoo.fr&gt;
    > Signed-off-by: Herbert Xu &lt;herbert@gondor.apana.org.au&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ cleanup: Remove address space of returned pointer (@Uros Bizjak in [94f4e7b0eb15679](https://github.com/sophgo/linux-riscv/commit/94f4e7b0eb15679) at 2024-12-05 13:01:21)
    > [ Upstream commit f730fd535fc51573f982fad629f2fc6b4a0cde2f ]
    > Guard functions in local_lock.h are defined using DEFINE_GUARD() and
    > DEFINE_LOCK_GUARD_1() macros having lock type defined as pointer in
    > the percpu address space. The functions, defined by these macros
    > return value in generic address space, causing:
    > cleanup.h:157:18: error: return from pointer to non-enclosed address space
    > and
    > cleanup.h:214:18: error: return from pointer to non-enclosed address space
    > when strict percpu checks are enabled.
    > Add explicit casts to remove address space of the returned pointer.
    > Found by GCC&#x27;s named address space checks.
    > Fixes: e4ab322fbaaa (&quot;cleanup: Add conditional guard support&quot;)
    > Signed-off-by: Uros Bizjak &lt;ubizjak@gmail.com&gt;
    > Signed-off-by: Peter Zijlstra (Intel) &lt;peterz@infradead.org&gt;
    > Link: https://lkml.kernel.org/r/20240819074124.143565-1-ubizjak@gmail.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ Revert &quot;scripts/faddr2line: Check only two symbols when calculating symbol size&quot; (@Carlos Llamas in [3773d35c7fb07bf](https://github.com/sophgo/linux-riscv/commit/3773d35c7fb07bf) at 2024-12-05 13:01:21)
    > [ Upstream commit 56ac7bd2c58a4e93d19f0ccb181035d075b315d3 ]
    > This reverts commit c02904f05ff805d6c0631634d5751ebd338f75ec.
    > Such commit assumed that only two symbols are relevant for the symbol
    > size calculation. However, this can lead to an incorrect symbol size
    > calculation when there are mapping symbols emitted by readelf.
    > For instance, when feeding &#x27;update_irq_load_avg+0x1c/0x1c4&#x27;, faddr2line
    > might need to process the following readelf lines:
    > 784284: ffffffc0081cca30   428 FUNC    GLOBAL DEFAULT     2 update_irq_load_avg
    > 87319: ffffffc0081ccb0c     0 NOTYPE  LOCAL  DEFAULT     2 $x.62522
    > 87321: ffffffc0081ccbdc     0 NOTYPE  LOCAL  DEFAULT     2 $x.62524
    > 87323: ffffffc0081ccbe0     0 NOTYPE  LOCAL  DEFAULT     2 $x.62526
    > 87325: ffffffc0081ccbe4     0 NOTYPE  LOCAL  DEFAULT     2 $x.62528
    > 87327: ffffffc0081ccbe8     0 NOTYPE  LOCAL  DEFAULT     2 $x.62530
    > 87329: ffffffc0081ccbec     0 NOTYPE  LOCAL  DEFAULT     2 $x.62532
    > 87331: ffffffc0081ccbf0     0 NOTYPE  LOCAL  DEFAULT     2 $x.62534
    > 87332: ffffffc0081ccbf4     0 NOTYPE  LOCAL  DEFAULT     2 $x.62535
    > 783403: ffffffc0081ccbf4   424 FUNC    GLOBAL DEFAULT     2 sched_pelt_multiplier
    > The symbol size of &#x27;update_irq_load_avg&#x27; should be calculated with the
    > address of &#x27;sched_pelt_multiplier&#x27;, after skipping the mapping symbols
    > seen in between. However, the offending commit cuts the list short and
    > faddr2line incorrectly assumes &#x27;update_irq_load_avg&#x27; is the last symbol
    > in the section, resulting in:
    > $ scripts/faddr2line vmlinux update_irq_load_avg+0x1c/0x1c4
    > skipping update_irq_load_avg address at 0xffffffc0081cca4c due to size mismatch (0x1c4 !&#x3D; 0x3ff9a59988)
    > no match for update_irq_load_avg+0x1c/0x1c4
    > After reverting the commit the issue is resolved:
    > $ scripts/faddr2line vmlinux update_irq_load_avg+0x1c/0x1c4
    > update_irq_load_avg+0x1c/0x1c4:
    > cpu_of at kernel/sched/sched.h:1109
    > (inlined by) update_irq_load_avg at kernel/sched/pelt.c:481
    > Fixes: c02904f05ff8 (&quot;scripts/faddr2line: Check only two symbols when calculating symbol size&quot;)
    > Signed-off-by: Carlos Llamas &lt;cmllamas@google.com&gt;
    > Acked-by: Will Deacon &lt;will@kernel.org&gt;
    > Acked-by: Brian Johannesmeyer &lt;bjohannesmeyer@gmail.com&gt;
    > Signed-off-by: Josh Poimboeuf &lt;jpoimboe@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ x86/unwind/orc: Fix unwind for newly forked tasks (@Zheng Yejian in [13ac2e6e6d884cf](https://github.com/sophgo/linux-riscv/commit/13ac2e6e6d884cf) at 2024-12-05 13:01:21)
    > [ Upstream commit 3bf19a0fb690022ec22ce87a5afeb1030cbcb56c ]
    > When arch_stack_walk_reliable() is called to unwind for newly forked
    > tasks, the return value is negative which means the call stack is
    > unreliable. This obviously does not meet expectations.
    > The root cause is that after commit 3aec4ecb3d1f (&quot;x86: Rewrite
    > ret_from_fork() in C&quot;), the &#x27;ret_addr&#x27; of newly forked task is changed
    > to &#x27;ret_from_fork_asm&#x27; (see copy_thread()), then at the start of the
    > unwind, it is incorrectly interprets not as a &quot;signal&quot; one because
    > &#x27;ret_from_fork&#x27; is still used to determine the initial &quot;signal&quot; (see
    > __unwind_start()). Then the address gets incorrectly decremented in the
    > call to orc_find() (see unwind_next_frame()) and resulting in the
    > incorrect ORC data.
    > To fix it, check &#x27;ret_from_fork_asm&#x27; rather than &#x27;ret_from_fork&#x27; in
    > __unwind_start().
    > Fixes: 3aec4ecb3d1f (&quot;x86: Rewrite ret_from_fork() in C&quot;)
    > Signed-off-by: Zheng Yejian &lt;zhengyejian@huaweicloud.com&gt;
    > Signed-off-by: Josh Poimboeuf &lt;jpoimboe@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ACPI: CPPC: Fix _CPC register setting issue (@Lifeng Zheng in [f7fc13f783d779e](https://github.com/sophgo/linux-riscv/commit/f7fc13f783d779e) at 2024-12-05 13:01:20)
    > [ Upstream commit 2388b266c9fcc7c9169ba85c7f9ebe325b7622d7 ]
    > Since commit 60949b7b8054 (&quot;ACPI: CPPC: Fix MASK_VAL() usage&quot;), _CPC
    > registers cannot be changed from 1 to 0.
    > It turns out that there is an extra OR after MASK_VAL_WRITE(), which
    > has already ORed prev_val with the register mask.
    > Remove the extra OR to fix the problem.
    > Fixes: 60949b7b8054 (&quot;ACPI: CPPC: Fix MASK_VAL() usage&quot;)
    > Signed-off-by: Lifeng Zheng &lt;zhenglifeng1@huawei.com&gt;
    > Link: https://patch.msgid.link/20241113103309.761031-1-zhenglifeng1@huawei.com
    > [ rjw: Subject and changelog edits ]
    > Signed-off-by: Rafael J. Wysocki &lt;rafael.j.wysocki@intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ hwmon: (nct6775-core) Fix overflows seen when writing limit attributes (@Pei Xiao in [dfa8bedfffcae87](https://github.com/sophgo/linux-riscv/commit/dfa8bedfffcae87) at 2024-12-05 13:01:20)
    > [ Upstream commit 57ee12b6c514146c19b6a159013b48727a012960 ]
    > DIV_ROUND_CLOSEST() after kstrtoul() results in an overflow if a large
    > number such as 18446744073709551615 is provided by the user.
    > Fix it by reordering clamp_val() and DIV_ROUND_CLOSEST() operations.
    > Signed-off-by: Pei Xiao &lt;xiaopei01@kylinos.cn&gt;
    > Fixes: c3963bc0a0cf (&quot;hwmon: (nct6775) Split core and platform driver&quot;)
    > Message-ID: &lt;7d5084cea33f7c0fd0578c59adfff71f93de94d9.1731375425.git.xiaopei01@kylinos.cn&gt;
    > Signed-off-by: Guenter Roeck &lt;linux@roeck-us.net&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ crypto: bcm - add error check in the ahash_hmac_init function (@Chen Ridong in [bba9e38c5ad41d0](https://github.com/sophgo/linux-riscv/commit/bba9e38c5ad41d0) at 2024-12-05 13:01:20)
    > [ Upstream commit 19630cf57233e845b6ac57c9c969a4888925467b ]
    > The ahash_init functions may return fails. The ahash_hmac_init should
    > not return ok when ahash_init returns error. For an example, ahash_init
    > will return -ENOMEM when allocation memory is error.
    > Fixes: 9d12ba86f818 (&quot;crypto: brcm - Add Broadcom SPU driver&quot;)
    > Signed-off-by: Chen Ridong &lt;chenridong@huawei.com&gt;
    > Signed-off-by: Herbert Xu &lt;herbert@gondor.apana.org.au&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ hwmon: (pmbus/core) clear faults after setting smbalert mask (@Jerome Brunet in [7458e82c84f0470](https://github.com/sophgo/linux-riscv/commit/7458e82c84f0470) at 2024-12-05 13:01:20)
    > [ Upstream commit 509c3a362675bc995771df74d545548f98e37621 ]
    > pmbus_write_smbalert_mask() ignores the errors if the chip can&#x27;t set
    > smbalert mask the standard way. It is not necessarily a problem for the irq
    > support if the chip is otherwise properly setup but it may leave an
    > uncleared fault behind.
    > pmbus_core will pick the fault on the next register_check(). The register
    > check will fails regardless of the actual register support by the chip.
    > This leads to missing attributes or debugfs entries for chips that should
    > provide them.
    > We cannot rely on register_check() as PMBUS_SMBALERT_MASK may be read-only.
    > Unconditionally clear the page fault after setting PMBUS_SMBALERT_MASK to
    > avoid the problem.
    > Suggested-by: Guenter Roeck &lt;linux@roeck-us.net&gt;
    > Fixes: 221819ca4c36 (&quot;hwmon: (pmbus/core) Add interrupt support&quot;)
    > Signed-off-by: Jerome Brunet &lt;jbrunet@baylibre.com&gt;
    > Message-ID: &lt;20241105-tps25990-v4-5-0e312ac70b62@baylibre.com&gt;
    > Signed-off-by: Guenter Roeck &lt;linux@roeck-us.net&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ thermal: testing: Use DEFINE_FREE() and __free() to simplify code (@Rafael J. Wysocki in [6bb065a874bac74](https://github.com/sophgo/linux-riscv/commit/6bb065a874bac74) at 2024-12-05 13:01:20)
    > [ Upstream commit 1c426fd09ca85fb77f120f7933e39eb9df99a39a ]
    > Use DEFINE_FREE() to define a __free function for dropping thermal
    > zone template reference counters and use it along with __free() to
    > simplify code in some places.
    > No intentional functional impact.
    > Signed-off-by: Rafael J. Wysocki &lt;rafael.j.wysocki@intel.com&gt;
    > Link: https://patch.msgid.link/4628747.LvFx2qVVIh@rjwysocki.net
    > [ rjw: Add variable initialization to address compiler warning ]
    > Signed-off-by: Rafael J. Wysocki &lt;rafael.j.wysocki@intel.com&gt;
    > Stable-dep-of: 0104dcdaad3a (&quot;thermal: testing: Initialize some variables annoteded with _free()&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ thermal: testing: Initialize some variables annoteded with _free() (@Rafael J. Wysocki in [526c132124a62be](https://github.com/sophgo/linux-riscv/commit/526c132124a62be) at 2024-12-05 13:01:20)
    > [ Upstream commit 0104dcdaad3a7afd141e79a5fb817a92ada910ac ]
    > Variables annotated with __free() need to be initialized if the function
    > can return before they get updated for the first time or the attempt to
    > free the memory pointed to by them upon function return may crash the
    > kernel.
    > Fix this issue in some places in the thermal testing code.
    > Fixes: f6a034f2df42 (&quot;thermal: Introduce a debugfs-based testing facility&quot;)
    > Reported-by: Dan Carpenter &lt;dan.carpenter@linaro.org&gt;
    > Signed-off-by: Rafael J. Wysocki &lt;rafael.j.wysocki@intel.com&gt;
    > Link: https://patch.msgid.link/12576267.O9o76ZdvQC@rjwysocki.net
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ crypto: caam - add error check to caam_rsa_set_priv_key_form (@Chen Ridong in [2eb0211de50c842](https://github.com/sophgo/linux-riscv/commit/2eb0211de50c842) at 2024-12-05 13:01:20)
    > [ Upstream commit b64140c74e954f1db6eae5548ca3a1f41b6fad79 ]
    > The caam_rsa_set_priv_key_form did not check for memory allocation errors.
    > Add the checks to the caam_rsa_set_priv_key_form functions.
    > Fixes: 52e26d77b8b3 (&quot;crypto: caam - add support for RSA key form 2&quot;)
    > Signed-off-by: Chen Ridong &lt;chenridong@huawei.com&gt;
    > Reviewed-by: Gaurav Jain &lt;gaurav.jain@nxp.com&gt;
    > Reviewed-by: Horia Geantă &lt;horia.geanta@nxp.com&gt;
    > Signed-off-by: Herbert Xu &lt;herbert@gondor.apana.org.au&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ rcu/srcutiny: don&#x27;t return before reenabling preemption (@Michal Schmidt in [fc5e1ad3bba522e](https://github.com/sophgo/linux-riscv/commit/fc5e1ad3bba522e) at 2024-12-05 13:01:19)
    > [ Upstream commit 0ea3acbc804c2d5a165442cdf9c0526f4d324888 ]
    > Code after the return statement is dead. Enable preemption before
    > returning from srcu_drive_gp().
    > This will be important when/if PREEMPT_AUTO (lazy resched) gets merged.
    > Fixes: 65b4a59557f6 (&quot;srcu: Make Tiny SRCU explicitly disable preemption&quot;)
    > Reviewed-by: Paul E. McKenney &lt;paulmck@kernel.org&gt;
    > Signed-off-by: Michal Schmidt &lt;mschmidt@redhat.com&gt;
    > Reviewed-by: Neeraj Upadhyay &lt;Neeraj.Upadhyay@amd.com&gt;
    > Signed-off-by: Frederic Weisbecker &lt;frederic@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ sched/cpufreq: Ensure sd is rebuilt for EAS check (@Christian Loehle in [bffbf66b636303f](https://github.com/sophgo/linux-riscv/commit/bffbf66b636303f) at 2024-12-05 13:01:19)
    > [ Upstream commit 70d8b6485b0bcd135b6699fc4252d2272818d1fb ]
    > Ensure sugov_eas_rebuild_sd() is always called when sugov_init()
    > succeeds. The out goto initialized sugov without forcing the rebuild.
    > Previously the missing call to sugov_eas_rebuild_sd() could lead to EAS
    > not being enabled on boot when it should have been, because it requires
    > all policies to be controlled by schedutil while they might not have
    > been initialized yet.
    > Fixes: e7a1b32e43b1 (&quot;cpufreq: Rebuild sched-domains when removing cpufreq driver&quot;)
    > Signed-off-by: Christian Loehle &lt;christian.loehle@arm.com&gt;
    > Link: https://patch.msgid.link/35e572d9-1152-406a-9e34-2525f7548af9@arm.com
    > Signed-off-by: Rafael J. Wysocki &lt;rafael.j.wysocki@intel.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ crypto: qat - Fix missing destroy_workqueue in adf_init_aer() (@Wang Hai in [612d6f84717b2af](https://github.com/sophgo/linux-riscv/commit/612d6f84717b2af) at 2024-12-05 13:01:19)
    > [ Upstream commit d8920a722a8cec625267c09ed40af8fd433d7f9a ]
    > The adf_init_aer() won&#x27;t destroy device_reset_wq when alloc_workqueue()
    > for device_sriov_wq failed. Add destroy_workqueue for device_reset_wq to
    > fix this issue.
    > Fixes: 4469f9b23468 (&quot;crypto: qat - re-enable sriov after pf reset&quot;)
    > Signed-off-by: Wang Hai &lt;wanghai38@huawei.com&gt;
    > Signed-off-by: Herbert Xu &lt;herbert@gondor.apana.org.au&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ doc: rcu: update printed dynticks counter bits (@Baruch Siach in [5f4a7cfdd8c17da](https://github.com/sophgo/linux-riscv/commit/5f4a7cfdd8c17da) at 2024-12-05 13:01:19)
    > [ Upstream commit 4a09e358922381f9b258e863bcd9c910584203b9 ]
    > The stall warning prints 16 bits since commit 171476775d32
    > (&quot;context_tracking: Convert state to atomic_t&quot;).
    > Fixes: 171476775d32 (&quot;context_tracking: Convert state to atomic_t&quot;)
    > Signed-off-by: Baruch Siach &lt;baruch@tkos.co.il&gt;
    > Reviewed-by: &quot;Paul E. McKenney&quot; &lt;paulmck@kernel.org&gt;
    > Signed-off-by: Neeraj Upadhyay &lt;neeraj.upadhyay@kernel.org&gt;
    > Signed-off-by: Frederic Weisbecker &lt;frederic@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ rcu/kvfree: Fix data-race in __mod_timer / kvfree_call_rcu (@Uladzislau Rezki (Sony) in [5ced426d97ce842](https://github.com/sophgo/linux-riscv/commit/5ced426d97ce842) at 2024-12-05 13:01:19)
    > [ Upstream commit a23da88c6c80e41e0503e0b481a22c9eea63f263 ]
    > KCSAN reports a data race when access the krcp-&gt;monitor_work.timer.expires
    > variable in the schedule_delayed_monitor_work() function:
    > &lt;snip&gt;
    > BUG: KCSAN: data-race in __mod_timer / kvfree_call_rcu
    > read to 0xffff888237d1cce8 of 8 bytes by task 10149 on cpu 1:
    > schedule_delayed_monitor_work kernel/rcu/tree.c:3520 [inline]
    > kvfree_call_rcu+0x3b8/0x510 kernel/rcu/tree.c:3839
    > trie_update_elem+0x47c/0x620 kernel/bpf/lpm_trie.c:441
    > bpf_map_update_value+0x324/0x350 kernel/bpf/syscall.c:203
    > generic_map_update_batch+0x401/0x520 kernel/bpf/syscall.c:1849
    > bpf_map_do_batch+0x28c/0x3f0 kernel/bpf/syscall.c:5143
    > __sys_bpf+0x2e5/0x7a0
    > __do_sys_bpf kernel/bpf/syscall.c:5741 [inline]
    > __se_sys_bpf kernel/bpf/syscall.c:5739 [inline]
    > __x64_sys_bpf+0x43/0x50 kernel/bpf/syscall.c:5739
    > x64_sys_call+0x2625/0x2d60 arch/x86/include/generated/asm/syscalls_64.h:322
    > do_syscall_x64 arch/x86/entry/common.c:52 [inline]
    > do_syscall_64+0xc9/0x1c0 arch/x86/entry/common.c:83
    > entry_SYSCALL_64_after_hwframe+0x77/0x7f
    > write to 0xffff888237d1cce8 of 8 bytes by task 56 on cpu 0:
    > __mod_timer+0x578/0x7f0 kernel/time/timer.c:1173
    > add_timer_global+0x51/0x70 kernel/time/timer.c:1330
    > __queue_delayed_work+0x127/0x1a0 kernel/workqueue.c:2523
    > queue_delayed_work_on+0xdf/0x190 kernel/workqueue.c:2552
    > queue_delayed_work include/linux/workqueue.h:677 [inline]
    > schedule_delayed_monitor_work kernel/rcu/tree.c:3525 [inline]
    > kfree_rcu_monitor+0x5e8/0x660 kernel/rcu/tree.c:3643
    > process_one_work kernel/workqueue.c:3229 [inline]
    > process_scheduled_works+0x483/0x9a0 kernel/workqueue.c:3310
    > worker_thread+0x51d/0x6f0 kernel/workqueue.c:3391
    > kthread+0x1d1/0x210 kernel/kthread.c:389
    > ret_from_fork+0x4b/0x60 arch/x86/kernel/process.c:147
    > ret_from_fork_asm+0x1a/0x30 arch/x86/entry/entry_64.S:244
    > Reported by Kernel Concurrency Sanitizer on:
    > CPU: 0 UID: 0 PID: 56 Comm: kworker/u8:4 Not tainted 6.12.0-rc2-syzkaller-00050-g5b7c893ed5ed #0
    > Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 09/13/2024
    > Workqueue: events_unbound kfree_rcu_monitor
    > &lt;snip&gt;
    > kfree_rcu_monitor() rearms the work if a &quot;krcp&quot; has to be still
    > offloaded and this is done without holding krcp-&gt;lock, whereas
    > the kvfree_call_rcu() holds it.
    > Fix it by acquiring the &quot;krcp-&gt;lock&quot; for kfree_rcu_monitor() so
    > both functions do not race anymore.
    > Reported-by: syzbot+061d370693bdd99f9d34@syzkaller.appspotmail.com
    > Link: https://lore.kernel.org/lkml/ZxZ68KmHDQYU0yfD@pc636/T/
    > Fixes: 8fc5494ad5fa (&quot;rcu/kvfree: Move need_offload_krc() out of krcp-&gt;lock&quot;)
    > Signed-off-by: Uladzislau Rezki (Sony) &lt;urezki@gmail.com&gt;
    > Reviewed-by: Neeraj Upadhyay &lt;Neeraj.Upadhyay@amd.com&gt;
    > Signed-off-by: Frederic Weisbecker &lt;frederic@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ crypto: inside-secure - Fix the return value of safexcel_xcbcmac_cra_init() (@Li Huafei in [494eb595a79a17e](https://github.com/sophgo/linux-riscv/commit/494eb595a79a17e) at 2024-12-05 13:01:19)
    > [ Upstream commit a10549fcce2913be7dc581562ffd8ea35653853e ]
    > The commit 320406cb60b6 (&quot;crypto: inside-secure - Replace generic aes
    > with libaes&quot;) replaced crypto_alloc_cipher() with kmalloc(), but did not
    > modify the handling of the return value. When kmalloc() returns NULL,
    > PTR_ERR_OR_ZERO(NULL) returns 0, but in fact, the memory allocation has
    > failed, and -ENOMEM should be returned.
    > Fixes: 320406cb60b6 (&quot;crypto: inside-secure - Replace generic aes with libaes&quot;)
    > Signed-off-by: Li Huafei &lt;lihuafei1@huawei.com&gt;
    > Acked-by: Antoine Tenart &lt;atenart@kernel.org&gt;
    > Signed-off-by: Herbert Xu &lt;herbert@gondor.apana.org.au&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ rcu/nocb: Fix missed RCU barrier on deoffloading (@Zqiang in [224b62028959858](https://github.com/sophgo/linux-riscv/commit/224b62028959858) at 2024-12-05 13:01:19)
    > [ Upstream commit 2996980e20b7a54a1869df15b3445374b850b155 ]
    > Currently, running rcutorture test with torture_type&#x3D;rcu fwd_progress&#x3D;8
    > n_barrier_cbs&#x3D;8 nocbs_nthreads&#x3D;8 nocbs_toggle&#x3D;100 onoff_interval&#x3D;60
    > test_boost&#x3D;2, will trigger the following warning:
    > WARNING: CPU: 19 PID: 100 at kernel/rcu/tree_nocb.h:1061 rcu_nocb_rdp_deoffload+0x292/0x2a0
    > RIP: 0010:rcu_nocb_rdp_deoffload+0x292/0x2a0
    > Call Trace:
    > &lt;TASK&gt;
    > ? __warn+0x7e/0x120
    > ? rcu_nocb_rdp_deoffload+0x292/0x2a0
    > ? report_bug+0x18e/0x1a0
    > ? handle_bug+0x3d/0x70
    > ? exc_invalid_op+0x18/0x70
    > ? asm_exc_invalid_op+0x1a/0x20
    > ? rcu_nocb_rdp_deoffload+0x292/0x2a0
    > rcu_nocb_cpu_deoffload+0x70/0xa0
    > rcu_nocb_toggle+0x136/0x1c0
    > ? __pfx_rcu_nocb_toggle+0x10/0x10
    > kthread+0xd1/0x100
    > ? __pfx_kthread+0x10/0x10
    > ret_from_fork+0x2f/0x50
    > ? __pfx_kthread+0x10/0x10
    > ret_from_fork_asm+0x1a/0x30
    > &lt;/TASK&gt;
    > CPU0                               CPU2                          CPU3
    > //rcu_nocb_toggle             //nocb_cb_wait                   //rcutorture
    > // deoffload CPU1             // process CPU1&#x27;s rdp
    > rcu_barrier()
    > rcu_segcblist_entrain()
    > rcu_segcblist_add_len(1);
    > // len &#x3D;&#x3D; 2
    > // enqueue barrier
    > // callback to CPU1&#x27;s
    > // rdp-&gt;cblist
    > rcu_do_batch()
    > // invoke CPU1&#x27;s rdp-&gt;cblist
    > // callback
    > rcu_barrier_callback()
    > rcu_barrier()
    > mutex_lock(&amp;rcu_state.barrier_mutex);
    > // still see len &#x3D;&#x3D; 2
    > // enqueue barrier callback
    > // to CPU1&#x27;s rdp-&gt;cblist
    > rcu_segcblist_entrain()
    > rcu_segcblist_add_len(1);
    > // len &#x3D;&#x3D; 3
    > // decrement len
    > rcu_segcblist_add_len(-2);
    > kthread_parkme()
    > // CPU1&#x27;s rdp-&gt;cblist len &#x3D;&#x3D; 1
    > // Warn because there is
    > // still a pending barrier
    > // trigger warning
    > WARN_ON_ONCE(rcu_segcblist_n_cbs(&amp;rdp-&gt;cblist));
    > cpus_read_unlock();
    > // wait CPU1 to comes online and
    > // invoke barrier callback on
    > // CPU1 rdp&#x27;s-&gt;cblist
    > wait_for_completion(&amp;rcu_state.barrier_completion);
    > // deoffload CPU4
    > cpus_read_lock()
    > rcu_barrier()
    > mutex_lock(&amp;rcu_state.barrier_mutex);
    > // block on barrier_mutex
    > // wait rcu_barrier() on
    > // CPU3 to unlock barrier_mutex
    > // but CPU3 unlock barrier_mutex
    > // need to wait CPU1 comes online
    > // when CPU1 going online will block on cpus_write_lock
    > The above scenario will not only trigger a WARN_ON_ONCE(), but also
    > trigger a deadlock.
    > Thanks to nocb locking, a second racing rcu_barrier() on an offline CPU
    > will either observe the decremented callback counter down to 0 and spare
    > the callback enqueue, or rcuo will observe the new callback and keep
    > rdp-&gt;nocb_cb_sleep to false.
    > Therefore check rdp-&gt;nocb_cb_sleep before parking to make sure no
    > further rcu_barrier() is waiting on the rdp.
    > Fixes: 1fcb932c8b5c (&quot;rcu/nocb: Simplify (de-)offloading state machine&quot;)
    > Suggested-by: Frederic Weisbecker &lt;frederic@kernel.org&gt;
    > Signed-off-by: Zqiang &lt;qiang.zhang1211@gmail.com&gt;
    > Reviewed-by: Neeraj Upadhyay &lt;Neeraj.Upadhyay@amd.com&gt;
    > Signed-off-by: Frederic Weisbecker &lt;frederic@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ EDAC/igen6: Avoid segmentation fault on module unload (@Orange Kao in [db60326f2c47b07](https://github.com/sophgo/linux-riscv/commit/db60326f2c47b07) at 2024-12-05 13:01:18)
    > [ Upstream commit fefaae90398d38a1100ccd73b46ab55ff4610fba ]
    > The segmentation fault happens because:
    > During modprobe:
    > 1. In igen6_probe(), igen6_pvt will be allocated with kzalloc()
    > 2. In igen6_register_mci(), mci-&gt;pvt_info will point to
    > &amp;igen6_pvt-&gt;imc[mc]
    > During rmmod:
    > 1. In mci_release() in edac_mc.c, it will kfree(mci-&gt;pvt_info)
    > 2. In igen6_remove(), it will kfree(igen6_pvt);
    > Fix this issue by setting mci-&gt;pvt_info to NULL to avoid the double
    > kfree.
    > Fixes: 10590a9d4f23 (&quot;EDAC/igen6: Add EDAC driver for Intel client SoCs using IBECC&quot;)
    > Closes: https://bugzilla.kernel.org/show_bug.cgi?id&#x3D;219360
    > Signed-off-by: Orange Kao &lt;orange@aiven.io&gt;
    > Signed-off-by: Tony Luck &lt;tony.luck@intel.com&gt;
    > Link: https://lore.kernel.org/r/20241104124237.124109-2-orange@aiven.io
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ amd-pstate: Set min_perf to nominal_perf for active mode performance gov (@Gautham R. Shenoy in [d193e3cbb02b58b](https://github.com/sophgo/linux-riscv/commit/d193e3cbb02b58b) at 2024-12-05 13:01:18)
    > [ Upstream commit 0c411b39e4f4ce8861301fa201cb4f817751311e ]
    > The amd-pstate driver sets CPPC_REQ.min_perf to CPPC_REQ.max_perf when
    > in active mode with performance governor. Typically CPPC_REQ.max_perf
    > is set to CPPC.highest_perf. This causes frequency throttling on
    > power-limited platforms which causes performance regressions on
    > certain classes of workloads.
    > Hence, set the CPPC_REQ.min_perf to the CPPC.nominal_perf or
    > CPPC_REQ.max_perf, whichever is lower of the two.
    > Fixes: ffa5096a7c33 (&quot;cpufreq: amd-pstate: implement Pstate EPP support for the AMD processors&quot;)
    > Signed-off-by: Gautham R. Shenoy &lt;gautham.shenoy@amd.com&gt;
    > Reviewed-by: Mario Limonciello &lt;mario.limonciello@amd.com&gt;
    > Link: https://lore.kernel.org/r/20241021101836.9047-2-gautham.shenoy@amd.com
    > Signed-off-by: Mario Limonciello &lt;mario.limonciello@amd.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ crypto: pcrypt - Call crypto layer directly when padata_do_parallel() return -EBUSY (@Yi Yang in [7ddab756f2de5b7](https://github.com/sophgo/linux-riscv/commit/7ddab756f2de5b7) at 2024-12-05 13:01:18)
    > [ Upstream commit 662f2f13e66d3883b9238b0b96b17886179e60e2 ]
    > Since commit 8f4f68e788c3 (&quot;crypto: pcrypt - Fix hungtask for
    > PADATA_RESET&quot;), the pcrypt encryption and decryption operations return
    > -EAGAIN when the CPU goes online or offline. In alg_test(), a WARN is
    > generated when pcrypt_aead_decrypt() or pcrypt_aead_encrypt() returns
    > -EAGAIN, the unnecessary panic will occur when panic_on_warn set 1.
    > Fix this issue by calling crypto layer directly without parallelization
    > in that case.
    > Fixes: 8f4f68e788c3 (&quot;crypto: pcrypt - Fix hungtask for PADATA_RESET&quot;)
    > Signed-off-by: Yi Yang &lt;yiyang13@huawei.com&gt;
    > Signed-off-by: Herbert Xu &lt;herbert@gondor.apana.org.au&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ cpufreq/amd-pstate: Don&#x27;t update CPPC request in amd_pstate_cpu_boost_update() (@Mario Limonciello in [50f0ec2f88a7990](https://github.com/sophgo/linux-riscv/commit/50f0ec2f88a7990) at 2024-12-05 13:01:18)
    > [ Upstream commit 67c08d303e0a1a5665b3f198037c9fae2d808090 ]
    > When boost is changed the CPPC value is changed in amd_pstate_cpu_boost_update()
    > but then changed again when refresh_frequency_limits() and all it&#x27;s callbacks
    > occur.  The first is a pointless write, so instead just update the limits for
    > the policy and let the policy refresh anchor everything properly.
    > Fixes: c8c68c38b56f (&quot;cpufreq: amd-pstate: initialize core precision boost state&quot;)
    > Reviewed-by: Gautham R. Shenoy &lt;gautham.shenoy@amd.com&gt;
    > Reviewed-by: Perry Yuan &lt;perry.yuan@amd.com&gt;
    > Tested-by: Dhananjay Ugwekar &lt;dhananjay.ugwekar@amd.com&gt;
    > Link: https://lore.kernel.org/r/20241012174519.897-2-mario.limonciello@amd.com
    > Signed-off-by: Mario Limonciello &lt;mario.limonciello@amd.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ crypto: cavium - Fix the if condition to exit loop after timeout (@Everest K.C in [3b2e23eaed1ec5b](https://github.com/sophgo/linux-riscv/commit/3b2e23eaed1ec5b) at 2024-12-05 13:01:18)
    > [ Upstream commit 53d91ca76b6c426c546542a44c78507b42008c9e ]
    > The while loop breaks in the first run because of incorrect
    > if condition. It also causes the statements after the if to
    > appear dead.
    > Fix this by changing the condition from if(timeout--) to
    > if(!timeout--).
    > This bug was reported by Coverity Scan.
    > Report:
    > CID 1600859: (#1 of 1): Logically dead code (DEADCODE)
    > dead_error_line: Execution cannot reach this statement: udelay(30UL);
    > Fixes: 9e2c7d99941d (&quot;crypto: cavium - Add Support for Octeon-tx CPT Engine&quot;)
    > Signed-off-by: Everest K.C. &lt;everestkc@everestkc.com.np&gt;
    > Signed-off-by: Herbert Xu &lt;herbert@gondor.apana.org.au&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ crypto: hisilicon/qm - disable same error report before resetting (@Weili Qian in [13de0dec38f855e](https://github.com/sophgo/linux-riscv/commit/13de0dec38f855e) at 2024-12-05 13:01:18)
    > [ Upstream commit c418ba6baca3ae10ffaf47b0803d2a9e6bf1af96 ]
    > If an error indicating that the device needs to be reset is reported,
    > disable the error reporting before device reset is complete,
    > enable the error reporting after the reset is complete to prevent
    > the same error from being reported repeatedly.
    > Fixes: eaebf4c3b103 (&quot;crypto: hisilicon - Unify hardware error init/uninit into QM&quot;)
    > Signed-off-by: Weili Qian &lt;qianweili@huawei.com&gt;
    > Signed-off-by: Herbert Xu &lt;herbert@gondor.apana.org.au&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ thermal: core: Represent suspend-related thermal zone flags as bits (@Rafael J. Wysocki in [f52dc3c757f0ea6](https://github.com/sophgo/linux-riscv/commit/f52dc3c757f0ea6) at 2024-12-05 13:01:17)
    > [ Upstream commit 26c9ab8090cda1eb3d42f491cc32d227404897da ]
    > Instead of using two separate fields in struct thermal_zone_device for
    > representing flags related to thermal zone suspend, represent them
    > explicitly as bits in one u8 &quot;state&quot; field.
    > Subsequently, that field will be used for addressing race conditions
    > related to thermal zone initialization and exit.
    > No intentional functional impact.
    > Signed-off-by: Rafael J. Wysocki &lt;rafael.j.wysocki@intel.com&gt;
    > Link: https://patch.msgid.link/7733910.EvYhyI6sBW@rjwysocki.net
    > Reviewed-by: Lukasz Luba &lt;lukasz.luba@arm.com&gt;
    > Stable-dep-of: 7837fa8115e0 (&quot;thermal: core: Mark thermal zones as initializing to start with&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ EDAC/skx_common: Differentiate memory error sources (@Qiuxu Zhuo in [b51babf88c39ccc](https://github.com/sophgo/linux-riscv/commit/b51babf88c39ccc) at 2024-12-05 13:01:17)
    > [ Upstream commit 2397f795735219caa9c2fe61e7bcdd0652e670d3 ]
    > The current skx_common determines whether the memory error source is the
    > near memory of the 2LM system and then retrieves the decoded error results
    > from the ADXL components (near-memory vs. far-memory) accordingly.
    > However, some memory controllers may have limitations in correctly
    > reporting the memory error source, leading to the retrieval of incorrect
    > decoded parts from the ADXL.
    > To address these limitations, instead of simply determining whether the
    > memory error is from the near memory of the 2LM system, it is necessary to
    > distinguish the memory error source details as follows:
    > Memory error from the near memory of the 2LM system.
    > Memory error from the far memory of the 2LM system.
    > Memory error from the 1LM system.
    > Not a memory error.
    > This will enable the i10nm_edac driver to take appropriate actions for
    > those memory controllers that have limitations in reporting the memory
    > error source.
    > Fixes: ba987eaaabf9 (&quot;EDAC/i10nm: Add Intel Granite Rapids server support&quot;)
    > Signed-off-by: Qiuxu Zhuo &lt;qiuxu.zhuo@intel.com&gt;
    > Signed-off-by: Tony Luck &lt;tony.luck@intel.com&gt;
    > Tested-by: Diego Garcia Rodriguez &lt;diego.garcia.rodriguez@intel.com&gt;
    > Link: https://lore.kernel.org/r/20241015072236.24543-2-qiuxu.zhuo@intel.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ EDAC/{skx_common,i10nm}: Fix incorrect far-memory error source indicator (@Qiuxu Zhuo in [a69ef9c0d461de7](https://github.com/sophgo/linux-riscv/commit/a69ef9c0d461de7) at 2024-12-05 13:01:17)
    > [ Upstream commit a36667037a0c0e36c59407f8ae636295390239a5 ]
    > The Granite Rapids CPUs with Flat2LM memory configurations may
    > mistakenly report near-memory errors as far-memory errors, resulting
    > in the invalid decoded ADXL results:
    > EDAC skx: Bad imc -1
    > Fix this incorrect far-memory error source indicator by prefetching the
    > decoded far-memory controller ID, and adjust the error source indicator
    > to near-memory if the far-memory controller ID is invalid.
    > Fixes: ba987eaaabf9 (&quot;EDAC/i10nm: Add Intel Granite Rapids server support&quot;)
    > Signed-off-by: Qiuxu Zhuo &lt;qiuxu.zhuo@intel.com&gt;
    > Signed-off-by: Tony Luck &lt;tony.luck@intel.com&gt;
    > Tested-by: Diego Garcia Rodriguez &lt;diego.garcia.rodriguez@intel.com&gt;
    > Link: https://lore.kernel.org/r/20241015072236.24543-3-qiuxu.zhuo@intel.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ thermal: core: Rearrange PM notification code (@Rafael J. Wysocki in [933ef9360a69137](https://github.com/sophgo/linux-riscv/commit/933ef9360a69137) at 2024-12-05 13:01:17)
    > [ Upstream commit 7ddca5885718c2683d75689aa065c9a3bb317e5a ]
    > Move the code run for each thermal zone by the thermal PM notify
    > handler to separate functions.
    > This will help to make some subsequent changes look somewhat more
    > straightforward, among other things.
    > No intentional functional impact.
    > Signed-off-by: Rafael J. Wysocki &lt;rafael.j.wysocki@intel.com&gt;
    > Link: https://patch.msgid.link/2299090.iZASKD2KPV@rjwysocki.net
    > Reviewed-by: Lukasz Luba &lt;lukasz.luba@arm.com&gt;
    > Stable-dep-of: 7837fa8115e0 (&quot;thermal: core: Mark thermal zones as initializing to start with&quot;)
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ thermal: core: Fix race between zone registration and system suspend (@Rafael J. Wysocki in [79cb9952e1129af](https://github.com/sophgo/linux-riscv/commit/79cb9952e1129af) at 2024-12-05 13:01:17)
    > [ Upstream commit cdf771ab476bd9acb0948f3088a277d5c3cacc6b ]
    > If the registration of a thermal zone takes place at the time when
    > system suspend is started, thermal_pm_notify() can run before the new
    > thermal zone is added to thermal_tz_list and its &quot;suspended&quot; flag will
    > not be set.  Consequently, if __thermal_zone_device_update() is called
    > for that thermal zone, it will not return early as expected which may
    > cause some destructive interference with the system suspend or resume
    > flow to occur.
    > To avoid that, make thermal_zone_init_complete() introduced previously
    > set the &quot;suspended&quot; flag for new thermal zones if it runs during system
    > suspend or resume.
    > Fixes: 4e814173a8c4 (&quot;thermal: core: Fix thermal zone suspend-resume synchronization&quot;)
    > Signed-off-by: Rafael J. Wysocki &lt;rafael.j.wysocki@intel.com&gt;
    > Link: https://patch.msgid.link/8490245.NyiUUSuA9g@rjwysocki.net
    > Reviewed-by: Lukasz Luba &lt;lukasz.luba@arm.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ thermal: core: Mark thermal zones as initializing to start with (@Rafael J. Wysocki in [39a5ad6b633bd5a](https://github.com/sophgo/linux-riscv/commit/39a5ad6b633bd5a) at 2024-12-05 13:01:17)
    > [ Upstream commit 7837fa8115e0273d3cfbd3d17b3f7b7291ceac08 ]
    > After thermal_zone_device_register_with_trips() has called
    > device_register() and it has registered the new thermal zone device
    > with the driver core, user space may access its sysfs attributes and,
    > among other things, it may enable the thermal zone before it is ready.
    > To address this, introduce a new thermal zone state flag for
    > initialization and set it before calling device_register() in
    > thermal_zone_device_register_with_trips().  This causes
    > __thermal_zone_device_update() to return early until the new flag
    > is cleared.
    > To clear it when the thermal zone is ready, introduce a new
    > function called thermal_zone_init_complete() that will also invoke
    > __thermal_zone_device_update() after clearing that flag (both under the
    > thernal zone lock) and make thermal_zone_device_register_with_trips()
    > call the new function instead of checking need_update and calling
    > thermal_zone_device_update() when it is set.
    > After this change, if user space enables the thermal zone prematurely,
    > __thermal_zone_device_update() will return early for it until
    > thermal_zone_init_complete() is called.  In turn, if the thermal zone
    > is not enabled by user space before thermal_zone_init_complete() is
    > called, the __thermal_zone_device_update() call in it will return early
    > because the thermal zone has not been enabled yet, but that function
    > will be invoked again by thermal_zone_device_set_mode() when the thermal
    > zone is enabled and it will not return early this time.
    > The checking of need_update is not necessary any more because the
    > __thermal_zone_device_update() calls potentially triggered by cooling
    > device binding take place before calling thermal_zone_init_complete(),
    > so they all will return early, which means that
    > thermal_zone_init_complete() must call __thermal_zone_device_update()
    > in case the thermal zone is enabled prematurely by user space.
    > Fixes: 203d3d4aa482 (&quot;the generic thermal sysfs driver&quot;)
    > Signed-off-by: Rafael J. Wysocki &lt;rafael.j.wysocki@intel.com&gt;
    > Link: https://patch.msgid.link/9360231.CDJkKcVGEf@rjwysocki.net
    > Reviewed-by: Lukasz Luba &lt;lukasz.luba@arm.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ EDAC/fsl_ddr: Fix bad bit shift operations (@Priyanka Singh in [1324bdc892fa1ab](https://github.com/sophgo/linux-riscv/commit/1324bdc892fa1ab) at 2024-12-05 13:01:17)
    > [ Upstream commit 9ec22ac4fe766c6abba845290d5139a3fbe0153b ]
    > Fix undefined behavior caused by left-shifting a negative value in the
    > expression:
    > cap_high ^ (1 &lt;&lt; (bad_data_bit - 32))
    > The variable bad_data_bit ranges from 0 to 63. When it is less than 32,
    > bad_data_bit - 32 becomes negative, and left-shifting by a negative
    > value in C is undefined behavior.
    > Fix this by combining cap_high and cap_low into a 64-bit variable.
    > [ bp: Massage commit message, simplify error bits handling. ]
    > Fixes: ea2eb9a8b620 (&quot;EDAC, fsl-ddr: Separate FSL DDR driver from MPC85xx&quot;)
    > Signed-off-by: Priyanka Singh &lt;priyanka.singh@nxp.com&gt;
    > Signed-off-by: Li Yang &lt;leoyang.li@nxp.com&gt;
    > Signed-off-by: Frank Li &lt;Frank.Li@nxp.com&gt;
    > Signed-off-by: Borislav Petkov (AMD) &lt;bp@alien8.de&gt;
    > Link: https://lore.kernel.org/r/20241016-imx95_edac-v3-3-86ae6fc2756a@nxp.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ thermal: core: Initialize thermal zones before registering them (@Rafael J. Wysocki in [d01d9005fbf59e3](https://github.com/sophgo/linux-riscv/commit/d01d9005fbf59e3) at 2024-12-05 13:01:16)
    > [ Upstream commit 662f920f7e390db5d1a6792a2b0ffa59b6c962fc ]
    > Since user space can start interacting with a new thermal zone as soon
    > as device_register() called by thermal_zone_device_register_with_trips()
    > returns, it is better to initialize the thermal zone before calling
    > device_register() on it.
    > Fixes: d0df264fbd3c (&quot;thermal/core: Remove pointless thermal_zone_device_reset() function&quot;)
    > Signed-off-by: Rafael J. Wysocki &lt;rafael.j.wysocki@intel.com&gt;
    > Link: https://patch.msgid.link/3336146.44csPzL39Z@rjwysocki.net
    > Reviewed-by: Lukasz Luba &lt;lukasz.luba@arm.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ crypto: qat/qat_420xx - fix off by one in uof_get_name() (@Dan Carpenter in [91eef1ad75f03d3](https://github.com/sophgo/linux-riscv/commit/91eef1ad75f03d3) at 2024-12-05 13:01:16)
    > [ Upstream commit 93a11608fb3720e1bc2b19a2649ac2b49cca1921 ]
    > This is called from uof_get_name_420xx() where &quot;num_objs&quot; is the
    > ARRAY_SIZE() of fw_objs[].  The &gt; needs to be &gt;&#x3D; to prevent an out of
    > bounds access.
    > Fixes: fcf60f4bcf54 (&quot;crypto: qat - add support for 420xx devices&quot;)
    > Signed-off-by: Dan Carpenter &lt;dan.carpenter@linaro.org&gt;
    > Acked-by: Giovanni Cabiddu &lt;giovanni.cabiddu@intel.com&gt;
    > Signed-off-by: Herbert Xu &lt;herbert@gondor.apana.org.au&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ firmware: google: Unregister driver_info on failure (@Yuan Can in [8d8404774465e9b](https://github.com/sophgo/linux-riscv/commit/8d8404774465e9b) at 2024-12-05 13:01:16)
    > [ Upstream commit 32b0901e141f6d4cf49d820b53eb09b88b1f72f7 ]
    > When platform_device_register_full() returns error, the gsmi_init() returns
    > without unregister gsmi_driver_info, fix by add missing
    > platform_driver_unregister() when platform_device_register_full() failed.
    > Fixes: 8942b2d5094b (&quot;gsmi: Add GSMI commands to log S0ix info&quot;)
    > Signed-off-by: Yuan Can &lt;yuancan@huawei.com&gt;
    > Acked-by: Brian Norris &lt;briannorris@chromium.org&gt;
    > Link: https://lore.kernel.org/r/20241015131344.20272-1-yuancan@huawei.com
    > Signed-off-by: Tzung-Bi Shih &lt;tzungbi@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ crypto: qat/qat_4xxx - fix off by one in uof_get_name() (@Dan Carpenter in [700852528fc5295](https://github.com/sophgo/linux-riscv/commit/700852528fc5295) at 2024-12-05 13:01:16)
    > [ Upstream commit 475b5098043eef6e72751aadeab687992a5b63d1 ]
    > The fw_objs[] array has &quot;num_objs&quot; elements so the &gt; needs to be &gt;&#x3D; to
    > prevent an out of bounds read.
    > Fixes: 10484c647af6 (&quot;crypto: qat - refactor fw config logic for 4xxx&quot;)
    > Signed-off-by: Dan Carpenter &lt;dan.carpenter@linaro.org&gt;
    > Acked-by: Giovanni Cabiddu &lt;giovanni.cabiddu@intel.com&gt;
    > Signed-off-by: Herbert Xu &lt;herbert@gondor.apana.org.au&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ crypto: qat - remove check after debugfs_create_dir() (@Cabiddu, Giovanni in [4bfd7e1f9f3baf0](https://github.com/sophgo/linux-riscv/commit/4bfd7e1f9f3baf0) at 2024-12-05 13:01:16)
    > [ Upstream commit 23717055a79981daf7fafa09a4b0d7566f8384aa ]
    > The debugfs functions are guaranteed to return a valid error code
    > instead of NULL upon failure. Consequently, the driver can directly
    > propagate any error returned without additional checks.
    > Remove the unnecessary &#x60;if&#x60; statement after debugfs_create_dir(). If
    > this function fails, the error code is stored in accel_dev-&gt;debugfs_dir
    > and utilized in subsequent debugfs calls.
    > Additionally, since accel_dev-&gt;debugfs_dir is assured to be non-NULL,
    > remove the superfluous NULL pointer checks within the adf_dbgfs_add()
    > and adf_dbgfs_rm().
    > Fixes: 9260db6640a6 (&quot;crypto: qat - move dbgfs init to separate file&quot;)
    > Signed-off-by: Giovanni Cabiddu &lt;giovanni.cabiddu@intel.com&gt;
    > Signed-off-by: Herbert Xu &lt;herbert@gondor.apana.org.au&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ crypto: qat - remove faulty arbiter config reset (@Ahsan Atta in [24d1a4125679112](https://github.com/sophgo/linux-riscv/commit/24d1a4125679112) at 2024-12-05 13:01:16)
    > [ Upstream commit 70199359902f1c7187dcb28a1be679a7081de7cc ]
    > Resetting the service arbiter config can cause potential issues
    > related to response ordering and ring flow control check in the
    > event of AER or device hang. This is because it results in changing
    > the default response ring size from 32 bytes to 16 bytes. The service
    > arbiter config reset also disables response ring flow control check.
    > Thus, by removing this reset we can prevent the service arbiter from
    > being configured inappropriately, which leads to undesired device
    > behaviour in the event of errors.
    > Fixes: 7afa232e76ce (&quot;crypto: qat - Intel(R) QAT DH895xcc accelerator&quot;)
    > Signed-off-by: Ahsan Atta &lt;ahsan.atta@intel.com&gt;
    > Reviewed-by: Giovanni Cabiddu &lt;giovanni.cabiddu@intel.com&gt;
    > Signed-off-by: Herbert Xu &lt;herbert@gondor.apana.org.au&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ EDAC/bluefield: Fix potential integer overflow (@David Thompson in [000930193fe5eb7](https://github.com/sophgo/linux-riscv/commit/000930193fe5eb7) at 2024-12-05 13:01:16)
    > [ Upstream commit 1fe774a93b46bb029b8f6fa9d1f25affa53f06c6 ]
    > The 64-bit argument for the &quot;get DIMM info&quot; SMC call consists of mem_ctrl_idx
    > left-shifted 16 bits and OR-ed with DIMM index.  With mem_ctrl_idx defined as
    > 32-bits wide the left-shift operation truncates the upper 16 bits of
    > information during the calculation of the SMC argument.
    > The mem_ctrl_idx stack variable must be defined as 64-bits wide to prevent any
    > potential integer overflow, i.e. loss of data from upper 16 bits.
    > Fixes: 82413e562ea6 (&quot;EDAC, mellanox: Add ECC support for BlueField DDR4&quot;)
    > Signed-off-by: David Thompson &lt;davthompson@nvidia.com&gt;
    > Signed-off-by: Borislav Petkov (AMD) &lt;bp@alien8.de&gt;
    > Reviewed-by: Shravan Kumar Ramani &lt;shravankr@nvidia.com&gt;
    > Link: https://lore.kernel.org/r/20240930151056.10158-1-davthompson@nvidia.com
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ hfsplus: don&#x27;t query the device logical block size multiple times (@Thadeu Lima de Souza Cascardo in [bfeecda050aa937](https://github.com/sophgo/linux-riscv/commit/bfeecda050aa937) at 2024-12-05 13:01:15)
    > [ Upstream commit 1c82587cb57687de3f18ab4b98a8850c789bedcf ]
    > Devices block sizes may change. One of these cases is a loop device by
    > using ioctl LOOP_SET_BLOCK_SIZE.
    > While this may cause other issues like IO being rejected, in the case of
    > hfsplus, it will allocate a block by using that size and potentially write
    > out-of-bounds when hfsplus_read_wrapper calls hfsplus_submit_bio and the
    > latter function reads a different io_size.
    > Using a new min_io_size initally set to sb_min_blocksize works for the
    > purposes of the original fix, since it will be set to the max between
    > HFSPLUS_SECTOR_SIZE and the first seen logical block size. We still use the
    > max between HFSPLUS_SECTOR_SIZE and min_io_size in case the latter is not
    > initialized.
    > Tested by mounting an hfsplus filesystem with loop block sizes 512, 1024
    > and 4096.
    > The produced KASAN report before the fix looks like this:
    > [  419.944641] &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;
    > [  419.945655] BUG: KASAN: slab-use-after-free in hfsplus_read_wrapper+0x659/0xa0a
    > [  419.946703] Read of size 2 at addr ffff88800721fc00 by task repro/10678
    > [  419.947612]
    > [  419.947846] CPU: 0 UID: 0 PID: 10678 Comm: repro Not tainted 6.12.0-rc5-00008-gdf56e0f2f3ca #84
    > [  419.949007] Hardware name: QEMU Standard PC (Q35 + ICH9, 2009), BIOS 1.15.0-1 04/01/2014
    > [  419.950035] Call Trace:
    > [  419.950384]  &lt;TASK&gt;
    > [  419.950676]  dump_stack_lvl+0x57/0x78
    > [  419.951212]  ? hfsplus_read_wrapper+0x659/0xa0a
    > [  419.951830]  print_report+0x14c/0x49e
    > [  419.952361]  ? __virt_addr_valid+0x267/0x278
    > [  419.952979]  ? kmem_cache_debug_flags+0xc/0x1d
    > [  419.953561]  ? hfsplus_read_wrapper+0x659/0xa0a
    > [  419.954231]  kasan_report+0x89/0xb0
    > [  419.954748]  ? hfsplus_read_wrapper+0x659/0xa0a
    > [  419.955367]  hfsplus_read_wrapper+0x659/0xa0a
    > [  419.955948]  ? __pfx_hfsplus_read_wrapper+0x10/0x10
    > [  419.956618]  ? do_raw_spin_unlock+0x59/0x1a9
    > [  419.957214]  ? _raw_spin_unlock+0x1a/0x2e
    > [  419.957772]  hfsplus_fill_super+0x348/0x1590
    > [  419.958355]  ? hlock_class+0x4c/0x109
    > [  419.958867]  ? __pfx_hfsplus_fill_super+0x10/0x10
    > [  419.959499]  ? __pfx_string+0x10/0x10
    > [  419.960006]  ? lock_acquire+0x3e2/0x454
    > [  419.960532]  ? bdev_name.constprop.0+0xce/0x243
    > [  419.961129]  ? __pfx_bdev_name.constprop.0+0x10/0x10
    > [  419.961799]  ? pointer+0x3f0/0x62f
    > [  419.962277]  ? __pfx_pointer+0x10/0x10
    > [  419.962761]  ? vsnprintf+0x6c4/0xfba
    > [  419.963178]  ? __pfx_vsnprintf+0x10/0x10
    > [  419.963621]  ? setup_bdev_super+0x376/0x3b3
    > [  419.964029]  ? snprintf+0x9d/0xd2
    > [  419.964344]  ? __pfx_snprintf+0x10/0x10
    > [  419.964675]  ? lock_acquired+0x45c/0x5e9
    > [  419.965016]  ? set_blocksize+0x139/0x1c1
    > [  419.965381]  ? sb_set_blocksize+0x6d/0xae
    > [  419.965742]  ? __pfx_hfsplus_fill_super+0x10/0x10
    > [  419.966179]  mount_bdev+0x12f/0x1bf
    > [  419.966512]  ? __pfx_mount_bdev+0x10/0x10
    > [  419.966886]  ? vfs_parse_fs_string+0xce/0x111
    > [  419.967293]  ? __pfx_vfs_parse_fs_string+0x10/0x10
    > [  419.967702]  ? __pfx_hfsplus_mount+0x10/0x10
    > [  419.968073]  legacy_get_tree+0x104/0x178
    > [  419.968414]  vfs_get_tree+0x86/0x296
    > [  419.968751]  path_mount+0xba3/0xd0b
    > [  419.969157]  ? __pfx_path_mount+0x10/0x10
    > [  419.969594]  ? kmem_cache_free+0x1e2/0x260
    > [  419.970311]  do_mount+0x99/0xe0
    > [  419.970630]  ? __pfx_do_mount+0x10/0x10
    > [  419.971008]  __do_sys_mount+0x199/0x1c9
    > [  419.971397]  do_syscall_64+0xd0/0x135
    > [  419.971761]  entry_SYSCALL_64_after_hwframe+0x76/0x7e
    > [  419.972233] RIP: 0033:0x7c3cb812972e
    > [  419.972564] Code: 48 8b 0d f5 46 0d 00 f7 d8 64 89 01 48 83 c8 ff c3 66 2e 0f 1f 84 00 00 00 00 00 90 f3 0f 1e fa 49 89 ca b8 a5 00 00 00 0f 05 &lt;48&gt; 3d 01 f0 ff ff 73 01 c3 48 8b 0d c2 46 0d 00 f7 d8 64 89 01 48
    > [  419.974371] RSP: 002b:00007ffe30632548 EFLAGS: 00000286 ORIG_RAX: 00000000000000a5
    > [  419.975048] RAX: ffffffffffffffda RBX: 00007ffe306328d8 RCX: 00007c3cb812972e
    > [  419.975701] RDX: 0000000020000000 RSI: 0000000020000c80 RDI: 00007ffe306325d0
    > [  419.976363] RBP: 00007ffe30632720 R08: 00007ffe30632610 R09: 0000000000000000
    > [  419.977034] R10: 0000000000200008 R11: 0000000000000286 R12: 0000000000000000
    > [  419.977713] R13: 00007ffe306328e8 R14: 00005a0eb298bc68 R15: 00007c3cb8356000
    > [  419.978375]  &lt;/TASK&gt;
    > [  419.978589]
    > Fixes: 6596528e391a (&quot;hfsplus: ensure bio requests are not smaller than the hardware sectors&quot;)
    > Signed-off-by: Thadeu Lima de Souza Cascardo &lt;cascardo@igalia.com&gt;
    > Link: https://lore.kernel.org/r/20241107114109.839253-1-cascardo@igalia.com
    > Signed-off-by: Christian Brauner &lt;brauner@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ crypto: caam - Fix the pointer passed to caam_qi_shutdown() (@Christophe JAILLET in [ad39df0898d3f46](https://github.com/sophgo/linux-riscv/commit/ad39df0898d3f46) at 2024-12-05 13:01:15)
    > [ Upstream commit ad980b04f51f7fb503530bd1cb328ba5e75a250e ]
    > The type of the last parameter given to devm_add_action_or_reset() is
    > &quot;struct caam_drv_private *&quot;, but in caam_qi_shutdown(), it is casted to
    > &quot;struct device *&quot;.
    > Pass the correct parameter to devm_add_action_or_reset() so that the
    > resources are released as expected.
    > Fixes: f414de2e2fff (&quot;crypto: caam - use devres to de-initialize QI&quot;)
    > Signed-off-by: Christophe JAILLET &lt;christophe.jaillet@wanadoo.fr&gt;
    > Signed-off-by: Herbert Xu &lt;herbert@gondor.apana.org.au&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ nvme-pci: reverse request order in nvme_queue_rqs (@Christoph Hellwig in [9abae592439cbf4](https://github.com/sophgo/linux-riscv/commit/9abae592439cbf4) at 2024-12-05 13:01:15)
    > [ Upstream commit beadf0088501d9dcf2454b05d90d5d31ea3ba55f ]
    > blk_mq_flush_plug_list submits requests in the reverse order that they
    > were submitted, which leads to a rather suboptimal I/O pattern especially
    > in rotational devices.  Fix this by rewriting nvme_queue_rqs so that it
    > always pops the requests from the passed in request list, and then adds
    > them to the head of a local submit list.  This actually simplifies the
    > code a bit as it removes the complicated list splicing, at the cost of
    > extra updates of the rq_next pointer.  As that should be cache hot
    > anyway it should be an easy price to pay.
    > Fixes: d62cbcf62f2f (&quot;nvme: add support for mq_ops-&gt;queue_rqs()&quot;)
    > Signed-off-by: Christoph Hellwig &lt;hch@lst.de&gt;
    > Link: https://lore.kernel.org/r/20241113152050.157179-2-hch@lst.de
    > Signed-off-by: Jens Axboe &lt;axboe@kernel.dk&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ crypto: mxs-dcp - Fix AES-CBC with hardware-bound keys (@Tomas Paukrt in [91170f0e90c1f14](https://github.com/sophgo/linux-riscv/commit/91170f0e90c1f14) at 2024-12-05 13:01:15)
    > [ Upstream commit 0dbb6854ca14933e194e8e46c894ca7bff95d0f3 ]
    > Fix passing an initialization vector in the payload field which
    > is necessary for AES in CBC mode even with hardware-bound keys.
    > Fixes: 3d16af0b4cfa (&quot;crypto: mxs-dcp: Add support for hardware-bound keys&quot;)
    > Signed-off-by: Tomas Paukrt &lt;tomaspaukrt@email.cz&gt;
    > Signed-off-by: Herbert Xu &lt;herbert@gondor.apana.org.au&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ext4: fix race in buffer_head read fault injection (@Long Li in [61832ee7fa2fbd5](https://github.com/sophgo/linux-riscv/commit/61832ee7fa2fbd5) at 2024-12-05 13:01:15)
    > [ Upstream commit 2f3d93e210b9c2866c8b3662adae427d5bf511ec ]
    > When I enabled ext4 debug for fault injection testing, I encountered the
    > following warning:
    > EXT4-fs error (device sda): ext4_read_inode_bitmap:201: comm fsstress:
    > Cannot read inode bitmap - block_group &#x3D; 8, inode_bitmap &#x3D; 1051
    > WARNING: CPU: 0 PID: 511 at fs/buffer.c:1181 mark_buffer_dirty+0x1b3/0x1d0
    > The root cause of the issue lies in the improper implementation of ext4&#x27;s
    > buffer_head read fault injection. The actual completion of buffer_head
    > read and the buffer_head fault injection are not atomic, which can lead
    > to the uptodate flag being cleared on normally used buffer_heads in race
    > conditions.
    > [CPU0]           [CPU1]         [CPU2]
    > ext4_read_inode_bitmap
    > ext4_read_bh()
    > &lt;bh read complete&gt;
    > ext4_read_inode_bitmap
    > if (buffer_uptodate(bh))
    > return bh
    > jbd2_journal_commit_transaction
    > __jbd2_journal_refile_buffer
    > __jbd2_journal_unfile_buffer
    > __jbd2_journal_temp_unlink_buffer
    > ext4_simulate_fail_bh()
    > clear_buffer_uptodate
    > mark_buffer_dirty
    > &lt;report warning&gt;
    > WARN_ON_ONCE(!buffer_uptodate(bh))
    > The best approach would be to perform fault injection in the IO completion
    > callback function, rather than after IO completion. However, the IO
    > completion callback function cannot get the fault injection code in sb.
    > Fix it by passing the result of fault injection into the bh read function,
    > we simulate faults within the bh read function itself. This requires adding
    > an extra parameter to the bh read functions that need fault injection.
    > Fixes: 46f870d690fe (&quot;ext4: simulate various I/O and checksum errors when reading metadata&quot;)
    > Signed-off-by: Long Li &lt;leo.lilong@huawei.com&gt;
    > Link: https://patch.msgid.link/20240906091746.510163-1-leo.lilong@huawei.com
    > Signed-off-by: Theodore Ts&#x27;o &lt;tytso@mit.edu&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ virtio_blk: reverse request order in virtio_queue_rqs (@Christoph Hellwig in [475404eac59d082](https://github.com/sophgo/linux-riscv/commit/475404eac59d082) at 2024-12-05 13:01:15)
    > [ Upstream commit 7f212e997edbb7a2cb85cef2ac14265dfaf88717 ]
    > blk_mq_flush_plug_list submits requests in the reverse order that they
    > were submitted, which leads to a rather suboptimal I/O pattern
    > especially in rotational devices. Fix this by rewriting virtio_queue_rqs
    > so that it always pops the requests from the passed in request list, and
    > then adds them to the head of a local submit list. This actually
    > simplifies the code a bit as it removes the complicated list splicing,
    > at the cost of extra updates of the rq_next pointer. As that should be
    > cache hot anyway it should be an easy price to pay.
    > Fixes: 0e9911fa768f (&quot;virtio-blk: support mq_ops-&gt;queue_rqs()&quot;)
    > Signed-off-by: Christoph Hellwig &lt;hch@lst.de&gt;
    > Link: https://lore.kernel.org/r/20241113152050.157179-3-hch@lst.de
    > Signed-off-by: Jens Axboe &lt;axboe@kernel.dk&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ cachefiles: Fix NULL pointer dereference in object-&gt;file (@Zizhi Wo in [9582c7664103c90](https://github.com/sophgo/linux-riscv/commit/9582c7664103c90) at 2024-12-05 13:01:14)
    > [ Upstream commit 31ad74b20227ce6b40910ff78b1c604e42975cf1 ]
    > At present, the object-&gt;file has the NULL pointer dereference problem in
    > ondemand-mode. The root cause is that the allocated fd and object-&gt;file
    > lifetime are inconsistent, and the user-space invocation to anon_fd uses
    > object-&gt;file. Following is the process that triggers the issue:
    > [write fd]				[umount]
    > cachefiles_ondemand_fd_write_iter
    > fscache_cookie_state_machine
    > cachefiles_withdraw_cookie
    > if (!file) return -ENOBUFS
    > cachefiles_clean_up_object
    > cachefiles_unmark_inode_in_use
    > fput(object-&gt;file)
    > object-&gt;file &#x3D; NULL
    > // file NULL pointer dereference!
    > __cachefiles_write(..., file, ...)
    > Fix this issue by add an additional reference count to the object-&gt;file
    > before write/llseek, and decrement after it finished.
    > Fixes: c8383054506c (&quot;cachefiles: notify the user daemon when looking up cookie&quot;)
    > Signed-off-by: Zizhi Wo &lt;wozizhi@huawei.com&gt;
    > Link: https://lore.kernel.org/r/20241107110649.3980193-5-wozizhi@huawei.com
    > Reviewed-by: David Howells &lt;dhowells@redhat.com&gt;
    > Signed-off-by: Christian Brauner &lt;brauner@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ cachefiles: Fix incorrect length return value in cachefiles_ondemand_fd_write_iter() (@Zizhi Wo in [914eb2b99424999](https://github.com/sophgo/linux-riscv/commit/914eb2b99424999) at 2024-12-05 13:01:14)
    > [ Upstream commit 10c35abd35aa62c9aac56898ae0c63b4d7d115e5 ]
    > cachefiles_ondemand_fd_write_iter() function first aligns &quot;pos&quot; and &quot;len&quot;
    > to block boundaries. When calling __cachefiles_write(), the aligned &quot;pos&quot;
    > is passed in, but &quot;len&quot; is the original unaligned value(iter-&gt;count).
    > Additionally, the returned length of the write operation is the modified
    > &quot;len&quot; aligned by block size, which is unreasonable.
    > The alignment of &quot;pos&quot; and &quot;len&quot; is intended only to check whether the
    > cache has enough space. But the modified len should not be used as the
    > return value of cachefiles_ondemand_fd_write_iter() because the length we
    > passed to __cachefiles_write() is the previous &quot;len&quot;. Doing so would result
    > in a mismatch in the data written on-demand. For example, if the length of
    > the user state passed in is not aligned to the block size (the preread
    > scene/DIO writes only need 512 alignment/Fault injection), the length of
    > the write will differ from the actual length of the return.
    > To solve this issue, since the __cachefiles_prepare_write() modifies the
    > size of &quot;len&quot;, we pass &quot;aligned_len&quot; to __cachefiles_prepare_write() to
    > calculate the free blocks and use the original &quot;len&quot; as the return value of
    > cachefiles_ondemand_fd_write_iter().
    > Fixes: c8383054506c (&quot;cachefiles: notify the user daemon when looking up cookie&quot;)
    > Signed-off-by: Zizhi Wo &lt;wozizhi@huawei.com&gt;
    > Link: https://lore.kernel.org/r/20241107110649.3980193-2-wozizhi@huawei.com
    > Reviewed-by: David Howells &lt;dhowells@redhat.com&gt;
    > Signed-off-by: Christian Brauner &lt;brauner@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ netfs/fscache: Add a memory barrier for FSCACHE_VOLUME_CREATING (@Zizhi Wo in [8cc1df3113cb71a](https://github.com/sophgo/linux-riscv/commit/8cc1df3113cb71a) at 2024-12-05 13:01:14)
    > [ Upstream commit 22f9400a6f3560629478e0a64247b8fcc811a24d ]
    > In fscache_create_volume(), there is a missing memory barrier between the
    > bit-clearing operation and the wake-up operation. This may cause a
    > situation where, after a wake-up, the bit-clearing operation hasn&#x27;t been
    > detected yet, leading to an indefinite wait. The triggering process is as
    > follows:
    > [cookie1]                [cookie2]                  [volume_work]
    > fscache_perform_lookup
    > fscache_create_volume
    > fscache_perform_lookup
    > fscache_create_volume
    > fscache_create_volume_work
    > cachefiles_acquire_volume
    > clear_and_wake_up_bit
    > test_and_set_bit
    > test_and_set_bit
    > goto maybe_wait
    > goto no_wait
    > In the above process, cookie1 and cookie2 has the same volume. When cookie1
    > enters the -no_wait- process, it will clear the bit and wake up the waiting
    > process. If a barrier is missing, it may cause cookie2 to remain in the
    > -wait- process indefinitely.
    > In commit 3288666c7256 (&quot;fscache: Use clear_and_wake_up_bit() in
    > fscache_create_volume_work()&quot;), barriers were added to similar operations
    > in fscache_create_volume_work(), but fscache_create_volume() was missed.
    > By combining the clear and wake operations into clear_and_wake_up_bit() to
    > fix this issue.
    > Fixes: bfa22da3ed65 (&quot;fscache: Provide and use cache methods to lookup/create/free a volume&quot;)
    > Signed-off-by: Zizhi Wo &lt;wozizhi@huawei.com&gt;
    > Link: https://lore.kernel.org/r/20241107110649.3980193-6-wozizhi@huawei.com
    > Acked-by: David Howells &lt;dhowells@redhat.com&gt;
    > Signed-off-by: Christian Brauner &lt;brauner@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ block: fix bio_split_rw_at to take zone_write_granularity into account (@Christoph Hellwig in [731d5bdc7426e99](https://github.com/sophgo/linux-riscv/commit/731d5bdc7426e99) at 2024-12-05 13:01:14)
    > [ Upstream commit 7ecd2cd4fae3e8410c0a6620f3a83dcdbb254f02 ]
    > Otherwise it can create unaligned writes on zoned devices.
    > Fixes: a805a4fa4fa3 (&quot;block: introduce zone_write_granularity limit&quot;)
    > Signed-off-by: Christoph Hellwig &lt;hch@lst.de&gt;
    > Reviewed-by: Damien Le Moal &lt;dlemoal@kernel.org&gt;
    > Reviewed-by: Johannes Thumshirn &lt;johannes.thumshirn@wdc.com&gt;
    > Link: https://lore.kernel.org/r/20241104062647.91160-3-hch@lst.de
    > Signed-off-by: Jens Axboe &lt;axboe@kernel.dk&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ block: take chunk_sectors into account in bio_split_write_zeroes (@Christoph Hellwig in [7044259018f2ac7](https://github.com/sophgo/linux-riscv/commit/7044259018f2ac7) at 2024-12-05 13:01:14)
    > [ Upstream commit 60dc5ea6bcfd078b71419640d49afa649acf9450 ]
    > For zoned devices, write zeroes must be split at the zone boundary
    > which is represented as chunk_sectors.  For other uses like the
    > internally RAIDed NVMe devices it is probably at least useful.
    > Enhance get_max_io_size to know about write zeroes and use it in
    > bio_split_write_zeroes.  Also add a comment about the seemingly
    > nonsensical zero max_write_zeroes limit.
    > Fixes: 885fa13f6559 (&quot;block: implement splitting of REQ_OP_WRITE_ZEROES bios&quot;)
    > Signed-off-by: Christoph Hellwig &lt;hch@lst.de&gt;
    > Reviewed-by: Damien Le Moal &lt;dlemoal@kernel.org&gt;
    > Link: https://lore.kernel.org/r/20241104062647.91160-2-hch@lst.de
    > Signed-off-by: Jens Axboe &lt;axboe@kernel.dk&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ cachefiles: Fix missing pos updates in cachefiles_ondemand_fd_write_iter() (@Zizhi Wo in [5a8a58911f5a5a5](https://github.com/sophgo/linux-riscv/commit/5a8a58911f5a5a5) at 2024-12-05 13:01:14)
    > [ Upstream commit 56f4856b425a30e1d8b3e41e6cde8bfba90ba5f8 ]
    > In the erofs on-demand loading scenario, read and write operations are
    > usually delivered through &quot;off&quot; and &quot;len&quot; contained in read req in user
    > mode. Naturally, pwrite is used to specify a specific offset to complete
    > write operations.
    > However, if the write(not pwrite) syscall is called multiple times in the
    > read-ahead scenario, we need to manually update ki_pos after each write
    > operation to update file-&gt;f_pos.
    > This step is currently missing from the cachefiles_ondemand_fd_write_iter
    > function, added to address this issue.
    > Fixes: c8383054506c (&quot;cachefiles: notify the user daemon when looking up cookie&quot;)
    > Signed-off-by: Zizhi Wo &lt;wozizhi@huawei.com&gt;
    > Link: https://lore.kernel.org/r/20241107110649.3980193-3-wozizhi@huawei.com
    > Acked-by: David Howells &lt;dhowells@redhat.com&gt;
    > Signed-off-by: Christian Brauner &lt;brauner@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ s390/syscalls: Avoid creation of arch/arch/ directory (@Masahiro Yamada in [4d09ee086304755](https://github.com/sophgo/linux-riscv/commit/4d09ee086304755) at 2024-12-05 13:01:14)
    > [ Upstream commit 0708967e2d56e370231fd07defa0d69f9ad125e8 ]
    > Building the kernel with ARCH&#x3D;s390 creates a weird arch/arch/ directory.
    > $ find arch/arch
    > arch/arch
    > arch/arch/s390
    > arch/arch/s390/include
    > arch/arch/s390/include/generated
    > arch/arch/s390/include/generated/asm
    > arch/arch/s390/include/generated/uapi
    > arch/arch/s390/include/generated/uapi/asm
    > The root cause is &#x27;targets&#x27; in arch/s390/kernel/syscalls/Makefile,
    > where the relative path is incorrect.
    > Strictly speaking, &#x27;targets&#x27; was not necessary in the first place
    > because this Makefile uses &#x27;filechk&#x27; instead of &#x27;if_changed&#x27;.
    > However, this commit keeps it, as it will be useful when converting
    > &#x27;filechk&#x27; to &#x27;if_changed&#x27; later.
    > Fixes: 5c75824d915e (&quot;s390/syscalls: add Makefile to generate system call header files&quot;)
    > Signed-off-by: Masahiro Yamada &lt;masahiroy@kernel.org&gt;
    > Link: https://lore.kernel.org/r/20241111134603.2063226-1-masahiroy@kernel.org
    > Signed-off-by: Heiko Carstens &lt;hca@linux.ibm.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ m68k: mvme147: Fix SCSI controller IRQ numbers (@Daniel Palmer in [d1d2be41ed1b884](https://github.com/sophgo/linux-riscv/commit/d1d2be41ed1b884) at 2024-12-05 13:01:13)
    > [ Upstream commit 47bc874427382018fa2e3e982480e156271eee70 ]
    > Sometime long ago the m68k IRQ code was refactored and the interrupt
    > numbers for SCSI controller on this board ended up wrong, and it hasn&#x27;t
    > worked since.
    > The PCC adds 0x40 to the vector for its interrupts so they end up in
    > the user interrupt range. Hence, the kernel number should be the kernel
    > offset for user interrupt range + the PCC interrupt number.
    > Fixes: 200a3d352cd5 (&quot;[PATCH] m68k: convert VME irq code&quot;)
    > Signed-off-by: Daniel Palmer &lt;daniel@0x0f.com&gt;
    > Reviewed-by: Finn Thain &lt;fthain@linux-m68k.org&gt;
    > Reviewed-by: Geert Uytterhoeven &lt;geert@linux-m68k.org&gt;
    > Link: https://lore.kernel.org/0e7636a21a0274eea35bfd5d874459d5078e97cc.1727926187.git.fthain@linux-m68k.org
    > Signed-off-by: Geert Uytterhoeven &lt;geert@linux-m68k.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ kselftest/arm64: Fix encoding for SVE B16B16 test (@Mark Brown in [ca16ec00cd004fe](https://github.com/sophgo/linux-riscv/commit/ca16ec00cd004fe) at 2024-12-05 13:01:13)
    > [ Upstream commit 69c0d824779843b51ca2339b2163db4d3b40c54c ]
    > The test for SVE_B16B16 had a cut&#x27;n&#x27;paste of a SME instruction, fix it with
    > a relevant SVE instruction.
    > Fixes: 44d10c27bd75 (&quot;kselftest/arm64: Add 2023 DPISA hwcap test coverage&quot;)
    > Signed-off-by: Mark Brown &lt;broonie@kernel.org&gt;
    > Link: https://lore.kernel.org/r/20241028-arm64-b16b16-test-v1-1-59a4a7449bdf@kernel.org
    > Signed-off-by: Catalin Marinas &lt;catalin.marinas@arm.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ acpi/arm64: Adjust error handling procedure in gtdt_parse_timer_block() (@Aleksandr Mishin in [a11046ea7962753](https://github.com/sophgo/linux-riscv/commit/a11046ea7962753) at 2024-12-05 13:01:13)
    > [ Upstream commit 1a9de2f6fda69d5f105dd8af776856a66abdaa64 ]
    > In case of error in gtdt_parse_timer_block() invalid &#x27;gtdt_frame&#x27;
    > will be used in &#x27;do {} while (i-- &gt;&#x3D; 0 &amp;&amp; gtdt_frame--);&#x27; statement block
    > because do{} block will be executed even if &#x27;i &#x3D;&#x3D; 0&#x27;.
    > Adjust error handling procedure by replacing &#x27;i-- &gt;&#x3D; 0&#x27; with &#x27;i-- &gt; 0&#x27;.
    > Found by Linux Verification Center (linuxtesting.org) with SVACE.
    > Fixes: a712c3ed9b8a (&quot;acpi/arm64: Add memory-mapped timer support in GTDT driver&quot;)
    > Signed-off-by: Aleksandr Mishin &lt;amishin@t-argos.ru&gt;
    > Acked-by: Hanjun Guo &lt;guohanjun@huawei.com&gt;
    > Acked-by: Sudeep Holla &lt;sudeep.holla@arm.com&gt;
    > Acked-by: Aleksandr Mishin &lt;amishin@t-argos.ru&gt;
    > Link: https://lore.kernel.org/r/20240827101239.22020-1-amishin@t-argos.ru
    > Signed-off-by: Catalin Marinas &lt;catalin.marinas@arm.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ loop: fix type of block size (@Li Wang in [8ae5e37357e995b](https://github.com/sophgo/linux-riscv/commit/8ae5e37357e995b) at 2024-12-05 13:01:13)
    > [ Upstream commit 8e604cac499248c75ad3a26695a743ff879ded5c ]
    > PAGE_SIZE may be 64K, and the max block size can be PAGE_SIZE, so any
    > variable for holding block size can&#x27;t be defined as &#x27;unsigned short&#x27;.
    > Unfortunately commit 473516b36193 (&quot;loop: use the atomic queue limits
    > update API&quot;) passes &#x27;bsize&#x27; with type of &#x27;unsigned short&#x27; to
    > loop_reconfigure_limits(), and causes LTP/ioctl_loop06 test failure:
    > 12 ioctl_loop06.c:76: TINFO: Using LOOP_SET_BLOCK_SIZE with arg &gt; PAGE_SIZE
    > 13 ioctl_loop06.c:59: TFAIL: Set block size succeed unexpectedly
    > ...
    > 18 ioctl_loop06.c:76: TINFO: Using LOOP_CONFIGURE with block_size &gt; PAGE_SIZE
    > 19 ioctl_loop06.c:59: TFAIL: Set block size succeed unexpectedly
    > Fixes the issue by defining &#x27;block size&#x27; variable with &#x27;unsigned int&#x27;, which is
    > aligned with block layer&#x27;s definition.
    > (improve commit log &amp; add fixes tag)
    > Fixes: 473516b36193 (&quot;loop: use the atomic queue limits update API&quot;)
    > Cc: John Garry &lt;john.g.garry@oracle.com&gt;
    > Cc: Stefan Hajnoczi &lt;stefanha@redhat.com&gt;
    > Cc: Christoph Hellwig &lt;hch@lst.de&gt;
    > Reviewed-by: Damien Le Moal &lt;dlemoal@kernel.org&gt;
    > Reviewed-by: Jan Stancek &lt;jstancek@redhat.com&gt;
    > Signed-off-by: Li Wang &lt;liwang@redhat.com&gt;
    > Signed-off-by: Ming Lei &lt;ming.lei@redhat.com&gt;
    > Reviewed-by: John Garry &lt;john.g.garry@oracle.com&gt;
    > Link: https://lore.kernel.org/r/20241109022744.1126003-1-ming.lei@redhat.com
    > Signed-off-by: Jens Axboe &lt;axboe@kernel.dk&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ arm64: fix .data.rel.ro size assertion when CONFIG_LTO_CLANG (@Masahiro Yamada in [602c0e55319cfc0](https://github.com/sophgo/linux-riscv/commit/602c0e55319cfc0) at 2024-12-05 13:01:13)
    > [ Upstream commit 340fd66c856651d8c1d29f392dd26ad674d2db0e ]
    > Commit be2881824ae9 (&quot;arm64/build: Assert for unwanted sections&quot;)
    > introduced an assertion to ensure that the .data.rel.ro section does
    > not exist.
    > However, this check does not work when CONFIG_LTO_CLANG is enabled,
    > because .data.rel.ro matches the .data.[0-9a-zA-Z_]* pattern in the
    > DATA_MAIN macro.
    > Move the ASSERT() above the RW_DATA() line.
    > Fixes: be2881824ae9 (&quot;arm64/build: Assert for unwanted sections&quot;)
    > Signed-off-by: Masahiro Yamada &lt;masahiroy@kernel.org&gt;
    > Acked-by: Will Deacon &lt;will@kernel.org&gt;
    > Link: https://lore.kernel.org/r/20241106161843.189927-1-masahiroy@kernel.org
    > Signed-off-by: Catalin Marinas &lt;catalin.marinas@arm.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ nvme-pci: fix freeing of the HMB descriptor table (@Christoph Hellwig in [582d9ed999b004f](https://github.com/sophgo/linux-riscv/commit/582d9ed999b004f) at 2024-12-05 13:01:13)
    > [ Upstream commit 3c2fb1ca8086eb139b2a551358137525ae8e0d7a ]
    > The HMB descriptor table is sized to the maximum number of descriptors
    > that could be used for a given device, but __nvme_alloc_host_mem could
    > break out of the loop earlier on memory allocation failure and end up
    > using less descriptors than planned for, which leads to an incorrect
    > size passed to dma_free_coherent.
    > In practice this was not showing up because the number of descriptors
    > tends to be low and the dma coherent allocator always allocates and
    > frees at least a page.
    > Fixes: 87ad72a59a38 (&quot;nvme-pci: implement host memory buffer support&quot;)
    > Signed-off-by: Christoph Hellwig &lt;hch@lst.de&gt;
    > Signed-off-by: Keith Busch &lt;kbusch@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ m68k: mvme147: Reinstate early console (@Daniel Palmer in [0f795d789e64403](https://github.com/sophgo/linux-riscv/commit/0f795d789e64403) at 2024-12-05 13:01:13)
    > [ Upstream commit 077b33b9e2833ff25050d986178a2c4c4036cbac ]
    > Commit a38eaa07a0ce (&quot;m68k/mvme147: config.c - Remove unused
    > functions&quot;), removed the console functionality for the mvme147 instead
    > of wiring it up to an early console.  Put the console write function
    > back and wire it up like mvme16x does so it&#x27;s possible to see Linux boot
    > on this fine hardware once more.
    > Fixes: a38eaa07a0ce (&quot;m68k/mvme147: config.c - Remove unused functions&quot;)
    > Signed-off-by: Daniel Palmer &lt;daniel@0x0f.com&gt;
    > Co-developed-by: Finn Thain &lt;fthain@linux-m68k.org&gt;
    > Signed-off-by: Finn Thain &lt;fthain@linux-m68k.org&gt;
    > Reviewed-by: Geert Uytterhoeven &lt;geert@linux-m68k.org&gt;
    > Link: https://lore.kernel.org/a82e8f0068a8722996a0ccfe666abb5e0a5c120d.1730850684.git.fthain@linux-m68k.org
    > Signed-off-by: Geert Uytterhoeven &lt;geert@linux-m68k.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ initramfs: avoid filename buffer overrun (@David Disseldorp in [fb83b093f758063](https://github.com/sophgo/linux-riscv/commit/fb83b093f758063) at 2024-12-05 13:01:12)
    > [ Upstream commit e017671f534dd3f568db9e47b0583e853d2da9b5 ]
    > The initramfs filename field is defined in
    > Documentation/driver-api/early-userspace/buffer-format.rst as:
    > 37 cpio_file :&#x3D; ALGN(4) + cpio_header + filename + &quot;\0&quot; + ALGN(4) + data
    > ...
    > 55 &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;
    > 56 Field name    Field size         Meaning
    > 57 &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D; &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;
    > ...
    > 70 c_namesize    8 bytes            Length of filename, including final \0
    > When extracting an initramfs cpio archive, the kernel&#x27;s do_name() path
    > handler assumes a zero-terminated path at @collected, passing it
    > directly to filp_open() / init_mkdir() / init_mknod().
    > If a specially crafted cpio entry carries a non-zero-terminated filename
    > and is followed by uninitialized memory, then a file may be created with
    > trailing characters that represent the uninitialized memory. The ability
    > to create an initramfs entry would imply already having full control of
    > the system, so the buffer overrun shouldn&#x27;t be considered a security
    > vulnerability.
    > Append the output of the following bash script to an existing initramfs
    > and observe any created /initramfs_test_fname_overrunAA* path. E.g.
    > ./reproducer.sh | gzip &gt;&gt; /myinitramfs
    > It&#x27;s easiest to observe non-zero uninitialized memory when the output is
    > gzipped, as it&#x27;ll overflow the heap allocated @out_buf in __gunzip(),
    > rather than the initrd_start+initrd_size block.
    > ---- reproducer.sh ----
    > nilchar&#x3D;&quot;A&quot;	# change to &quot;\0&quot; to properly zero terminate / pad
    > magic&#x3D;&quot;070701&quot;
    > ino&#x3D;1
    > mode&#x3D;$(( 0100777 ))
    > uid&#x3D;0
    > gid&#x3D;0
    > nlink&#x3D;1
    > mtime&#x3D;1
    > filesize&#x3D;0
    > devmajor&#x3D;0
    > devminor&#x3D;1
    > rdevmajor&#x3D;0
    > rdevminor&#x3D;0
    > csum&#x3D;0
    > fname&#x3D;&quot;initramfs_test_fname_overrun&quot;
    > namelen&#x3D;$(( ${#fname} + 1 ))	# plus one to account for terminator
    > printf &quot;%s%08x%08x%08x%08x%08x%08x%08x%08x%08x%08x%08x%08x%08x%s&quot; \
    > $magic $ino $mode $uid $gid $nlink $mtime $filesize \
    > $devmajor $devminor $rdevmajor $rdevminor $namelen $csum $fname
    > termpadlen&#x3D;$(( 1 + ((4 - ((110 + $namelen) &amp; 3)) % 4) ))
    > printf &quot;%.s${nilchar}&quot; $(seq 1 $termpadlen)
    > ---- reproducer.sh ----
    > Symlink filename fields handled in do_symlink() won&#x27;t overrun past the
    > data segment, due to the explicit zero-termination of the symlink
    > target.
    > Fix filename buffer overrun by aborting the initramfs FSM if any cpio
    > entry doesn&#x27;t carry a zero-terminator at the expected (name_len - 1)
    > offset.
    > Fixes: 1da177e4c3f41 (&quot;Linux-2.6.12-rc2&quot;)
    > Signed-off-by: David Disseldorp &lt;ddiss@suse.de&gt;
    > Link: https://lore.kernel.org/r/20241030035509.20194-2-ddiss@suse.de
    > Signed-off-by: Christian Brauner &lt;brauner@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ arm64: Expose ID_AA64ISAR1_EL1.XS to sanitised feature consumers (@Marc Zyngier in [de56fa09a0cb2ca](https://github.com/sophgo/linux-riscv/commit/de56fa09a0cb2ca) at 2024-12-05 13:01:12)
    > [ Upstream commit 2287a4c1e11822d05a70d22f28b26bd810dd204e ]
    > Despite KVM now being able to deal with XS-tagged TLBIs, we still don&#x27;t
    > expose these feature bits to KVM.
    > Plumb in the feature in ID_AA64ISAR1_EL1.
    > Fixes: 0feec7769a63 (&quot;KVM: arm64: nv: Add handling of NXS-flavoured TLBI operations&quot;)
    > Signed-off-by: Marc Zyngier &lt;maz@kernel.org&gt;
    > Acked-by: Catalin Marinas &lt;catalin.marinas@arm.com&gt;
    > Reviewed-by: Oliver Upton &lt;oliver.upton@linux.dev&gt;
    > Link: https://lore.kernel.org/r/20241031083519.364313-1-maz@kernel.org
    > Signed-off-by: Catalin Marinas &lt;catalin.marinas@arm.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ x86/pvh: Call C code via the kernel virtual mapping (@Ard Biesheuvel in [9978ff5dcaa9eeb](https://github.com/sophgo/linux-riscv/commit/9978ff5dcaa9eeb) at 2024-12-05 13:01:12)
    > [ Upstream commit e8fbc0d9cab6c1ee6403f42c0991b0c1d5dbc092 ]
    > Calling C code via a different mapping than it was linked at is
    > problematic, because the compiler assumes that RIP-relative and absolute
    > symbol references are interchangeable. GCC in particular may use
    > RIP-relative per-CPU variable references even when not using -fpic.
    > So call xen_prepare_pvh() via its kernel virtual mapping on x86_64, so
    > that those RIP-relative references produce the correct values. This
    > matches the pre-existing behavior for i386, which also invokes
    > xen_prepare_pvh() via the kernel virtual mapping before invoking
    > startup_32 with paging disabled again.
    > Fixes: 7243b93345f7 (&quot;xen/pvh: Bootstrap PVH guest&quot;)
    > Tested-by: Jason Andryuk &lt;jason.andryuk@amd.com&gt;
    > Reviewed-by: Jason Andryuk &lt;jason.andryuk@amd.com&gt;
    > Signed-off-by: Ard Biesheuvel &lt;ardb@kernel.org&gt;
    > Message-ID: &lt;20241009160438.3884381-8-ardb+git@google.com&gt;
    > Signed-off-by: Juergen Gross &lt;jgross@suse.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ brd: defer automatic disk creation until module initialization succeeds (@Yang Erkun in [63dfd728b30f794](https://github.com/sophgo/linux-riscv/commit/63dfd728b30f794) at 2024-12-05 13:01:12)
    > [ Upstream commit 826cc42adf44930a633d11a5993676d85ddb0842 ]
    > My colleague Wupeng found the following problems during fault injection:
    > BUG: unable to handle page fault for address: fffffbfff809d073
    > PGD 6e648067 P4D 123ec8067 PUD 123ec4067 PMD 100e38067 PTE 0
    > Oops: Oops: 0000 [#1] PREEMPT SMP KASAN NOPTI
    > CPU: 5 UID: 0 PID: 755 Comm: modprobe Not tainted 6.12.0-rc3+ #17
    > Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS
    > 1.16.1-2.fc37 04/01/2014
    > RIP: 0010:__asan_load8+0x4c/0xa0
    > ...
    > Call Trace:
    > &lt;TASK&gt;
    > blkdev_put_whole+0x41/0x70
    > bdev_release+0x1a3/0x250
    > blkdev_release+0x11/0x20
    > __fput+0x1d7/0x4a0
    > task_work_run+0xfc/0x180
    > syscall_exit_to_user_mode+0x1de/0x1f0
    > do_syscall_64+0x6b/0x170
    > entry_SYSCALL_64_after_hwframe+0x76/0x7e
    > loop_init() is calling loop_add() after __register_blkdev() succeeds and
    > is ignoring disk_add() failure from loop_add(), for loop_add() failure
    > is not fatal and successfully created disks are already visible to
    > bdev_open().
    > brd_init() is currently calling brd_alloc() before __register_blkdev()
    > succeeds and is releasing successfully created disks when brd_init()
    > returns an error. This can cause UAF for the latter two case:
    > case 1:
    > T1:
    > modprobe brd
    > brd_init
    > brd_alloc(0) // success
    > add_disk
    > disk_scan_partitions
    > bdev_file_open_by_dev // alloc file
    > fput // won&#x27;t free until back to userspace
    > brd_alloc(1) // failed since mem alloc error inject
    > // error path for modprobe will release code segment
    > // back to userspace
    > __fput
    > blkdev_release
    > bdev_release
    > blkdev_put_whole
    > bdev-&gt;bd_disk-&gt;fops-&gt;release // fops is freed now, UAF!
    > case 2:
    > T1:                            T2:
    > modprobe brd
    > brd_init
    > brd_alloc(0) // success
    > open(/dev/ram0)
    > brd_alloc(1) // fail
    > // error path for modprobe
    > close(/dev/ram0)
    > ...
    > /* UAF! */
    > bdev-&gt;bd_disk-&gt;fops-&gt;release
    > Fix this problem by following what loop_init() does. Besides,
    > reintroduce brd_devices_mutex to help serialize modifications to
    > brd_list.
    > Fixes: 7f9b348cb5e9 (&quot;brd: convert to blk_alloc_disk/blk_cleanup_disk&quot;)
    > Reported-by: Wupeng Ma &lt;mawupeng1@huawei.com&gt;
    > Signed-off-by: Yang Erkun &lt;yangerkun@huawei.com&gt;
    > Reviewed-by: Christoph Hellwig &lt;hch@lst.de&gt;
    > Link: https://lore.kernel.org/r/20241030034914.907829-1-yangerkun@huaweicloud.com
    > Signed-off-by: Jens Axboe &lt;axboe@kernel.dk&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ s390/cpum_sf: Fix and protect memory allocation of SDBs with mutex (@Thomas Richter in [4b3bdfa89635db6](https://github.com/sophgo/linux-riscv/commit/4b3bdfa89635db6) at 2024-12-05 13:01:12)
    > [ Upstream commit f55bd479d8663a4a4e403b3d308d3d1aa33d92df ]
    > Reservation of the PMU hardware is done at first event creation
    > and is protected by a pair of mutex_lock() and mutex_unlock().
    > After reservation of the PMU hardware the memory
    > required for the PMUs the event is to be installed on is
    > allocated by allocate_buffers() and alloc_sampling_buffer().
    > This done outside of the mutex protection.
    > Without mutex protection two or more concurrent invocations of
    > perf_event_init() may run in parallel.
    > This can lead to allocation of Sample Data Blocks (SDBs)
    > multiple times for the same PMU.
    > Prevent this and protect memory allocation of SDBs by
    > mutex.
    > Fixes: 8a6fe8f21ec4 (&quot;s390/cpum_sf: Use refcount_t instead of atomic_t&quot;)
    > Signed-off-by: Thomas Richter &lt;tmricht@linux.ibm.com&gt;
    > Reviewed-by: Sumanth Korikkar &lt;sumanthk@linux.ibm.com&gt;
    > Reviewed-by: Hendrik Brueckner &lt;brueckner@linux.ibm.com&gt;
    > Signed-off-by: Heiko Carstens &lt;hca@linux.ibm.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ mips: asm: fix warning when disabling MIPS_FP_SUPPORT (@Jonas Gorski in [2a375beb4c3824b](https://github.com/sophgo/linux-riscv/commit/2a375beb4c3824b) at 2024-12-05 13:01:12)
    > [ Upstream commit da09935975c8f8c90d6f57be2422dee5557206cd ]
    > When MIPS_FP_SUPPORT is disabled, __sanitize_fcr31() is defined as
    > nothing, which triggers a gcc warning:
    > In file included from kernel/sched/core.c:79:
    > kernel/sched/core.c: In function &#x27;context_switch&#x27;:
    > ./arch/mips/include/asm/switch_to.h:114:39: warning: suggest braces around empty body in an &#x27;if&#x27; statement [-Wempty-body]
    > 114 |                 __sanitize_fcr31(next);                                 \
    > |                                       ^
    > kernel/sched/core.c:5316:9: note: in expansion of macro &#x27;switch_to&#x27;
    > 5316 |         switch_to(prev, next, prev);
    > |         ^~~~~~~~~
    > Fix this by providing an empty body for __sanitize_fcr31() like one is
    > defined for __mips_mt_fpaff_switch_to().
    > Fixes: 36a498035bd2 (&quot;MIPS: Avoid FCSR sanitization when CONFIG_MIPS_FP_SUPPORT&#x3D;n&quot;)
    > Signed-off-by: Jonas Gorski &lt;jonas.gorski@gmail.com&gt;
    > Reviewed-by: Maciej W. Rozycki &lt;macro@orcam.me.uk&gt;
    > Signed-off-by: Thomas Bogendoerfer &lt;tsbogend@alpha.franken.de&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ ext4: avoid remount errors with &#x27;abort&#x27; mount option (@Jan Kara in [26cc5063e3c2a5d](https://github.com/sophgo/linux-riscv/commit/26cc5063e3c2a5d) at 2024-12-05 13:01:12)
    > [ Upstream commit 76486b104168ae59703190566e372badf433314b ]
    > When we remount filesystem with &#x27;abort&#x27; mount option while changing
    > other mount options as well (as is LTP test doing), we can return error
    > from the system call after commit d3476f3dad4a (&quot;ext4: don&#x27;t set
    > SB_RDONLY after filesystem errors&quot;) because the application of mount
    > option changes detects shutdown filesystem and refuses to do anything.
    > The behavior of application of other mount options in presence of
    > &#x27;abort&#x27; mount option is currently rather arbitary as some mount option
    > changes are handled before &#x27;abort&#x27; and some after it.
    > Move aborting of the filesystem to the end of remount handling so all
    > requested changes are properly applied before the filesystem is shutdown
    > to have a reasonably consistent behavior.
    > Fixes: d3476f3dad4a (&quot;ext4: don&#x27;t set SB_RDONLY after filesystem errors&quot;)
    > Reported-by: Jan Stancek &lt;jstancek@redhat.com&gt;
    > Link: https://lore.kernel.org/all/Zvp6L+oFnfASaoHl@t14s
    > Signed-off-by: Jan Kara &lt;jack@suse.cz&gt;
    > Tested-by: Jan Stancek &lt;jstancek@redhat.com&gt;
    > Link: https://patch.msgid.link/20241004221556.19222-1-jack@suse.cz
    > Signed-off-by: Theodore Ts&#x27;o &lt;tytso@mit.edu&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ kselftest/arm64: hwcap: fix f8dp2 cpuinfo name (@Andre Przywara in [e4d5d5a4c842e2d](https://github.com/sophgo/linux-riscv/commit/e4d5d5a4c842e2d) at 2024-12-05 13:01:11)
    > [ Upstream commit b0d80dbc378d52155c9ecf9579986edccceed3aa ]
    > The F8DP2 DPISA extension has a separate cpuinfo field, named
    > accordingly.
    > Change the erroneously placed name of &quot;f8dp4&quot; to &quot;f8dp2&quot;.
    > Fixes: 44d10c27bd75 (&quot;kselftest/arm64: Add 2023 DPISA hwcap test coverage&quot;)
    > Signed-off-by: Andre Przywara &lt;andre.przywara@arm.com&gt;
    > Reviewed-by: Mark Brown &lt;broonie@kernel.org&gt;
    > Link: https://lore.kernel.org/r/20240816153251.2833702-3-andre.przywara@arm.com
    > Signed-off-by: Catalin Marinas &lt;catalin.marinas@arm.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ fs/block: Check for IOCB_DIRECT in generic_atomic_write_valid() (@John Garry in [cfe3e04e9a5704a](https://github.com/sophgo/linux-riscv/commit/cfe3e04e9a5704a) at 2024-12-05 13:01:11)
    > [ Upstream commit c3be7ebbbce5201e151f17e28a6c807602f369c9 ]
    > Currently FMODE_CAN_ATOMIC_WRITE is set if the bdev can atomic write and
    > the file is open for direct IO. This does not work if the file is not
    > opened for direct IO, yet fcntl(O_DIRECT) is used on the fd later.
    > Change to check for direct IO on a per-IO basis in
    > generic_atomic_write_valid(). Since we want to report -EOPNOTSUPP for
    > non-direct IO for an atomic write, change to return an error code.
    > Relocate the block fops atomic write checks to the common write path, as to
    > catch non-direct IO.
    > Fixes: c34fc6f26ab8 (&quot;fs: Initial atomic write support&quot;)
    > Reviewed-by: Christoph Hellwig &lt;hch@lst.de&gt;
    > Reviewed-by: Darrick J. Wong &lt;djwong@kernel.org&gt;
    > Signed-off-by: John Garry &lt;john.g.garry@oracle.com&gt;
    > Link: https://lore.kernel.org/r/20241019125113.369994-3-john.g.garry@oracle.com
    > Signed-off-by: Jens Axboe &lt;axboe@kernel.dk&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ s390/pageattr: Implement missing kernel_page_present() (@Heiko Carstens in [a9681f745f2a9ce](https://github.com/sophgo/linux-riscv/commit/a9681f745f2a9ce) at 2024-12-05 13:01:11)
    > [ Upstream commit 2835f8bf5530750c3381166005934f996a83ad05 ]
    > kernel_page_present() was intentionally not implemented when adding
    > ARCH_HAS_SET_DIRECT_MAP support, since it was only used for suspend/resume
    > which is not supported anymore on s390.
    > A new bpf use case led to a compile error specific to s390. Even though
    > this specific use case went away implement kernel_page_present(), so that
    > the API is complete and potential future users won&#x27;t run into this problem.
    > Reported-by: Daniel Borkmann &lt;daniel@iogearbox.net&gt;
    > Closes: https://lore.kernel.org/all/045de961-ac69-40cc-b141-ab70ec9377ec@iogearbox.net
    > Fixes: 0490d6d7ba0a (&quot;s390/mm: enable ARCH_HAS_SET_DIRECT_MAP&quot;)
    > Reviewed-by: Alexander Gordeev &lt;agordeev@linux.ibm.com&gt;
    > Signed-off-by: Heiko Carstens &lt;hca@linux.ibm.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ s390/cio: Do not unregister the subchannel based on DNV (@Vineeth Vijayan in [9e9590f5e0651fb](https://github.com/sophgo/linux-riscv/commit/9e9590f5e0651fb) at 2024-12-05 13:01:11)
    > [ Upstream commit 8c58a229688ce3a097b3b1a2efe1b4f5508c2123 ]
    > Starting with commit 2297791c92d0 (&quot;s390/cio: dont unregister
    > subchannel from child-drivers&quot;), CIO does not unregister subchannels
    > when the attached device is invalid or unavailable. Instead, it
    > allows subchannels to exist without a connected device. However, if
    > the DNV value is 0, such as, when all the CHPIDs of a subchannel are
    > configured in standby state, the subchannel is unregistered, which
    > contradicts the current subchannel specification.
    > Update the logic so that subchannels are not unregistered based
    > on the DNV value. Also update the SCHIB information even if the
    > DNV bit is zero.
    > Suggested-by: Peter Oberparleiter &lt;oberpar@linux.ibm.com&gt;
    > Signed-off-by: Vineeth Vijayan &lt;vneethv@linux.ibm.com&gt;
    > Fixes: 2297791c92d0 (&quot;s390/cio: dont unregister subchannel from child-drivers&quot;)
    > Reviewed-by: Peter Oberparleiter &lt;oberpar@linux.ibm.com&gt;
    > Signed-off-by: Heiko Carstens &lt;hca@linux.ibm.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ block/fs: Pass an iocb to generic_atomic_write_valid() (@John Garry in [78de864e8af3649](https://github.com/sophgo/linux-riscv/commit/78de864e8af3649) at 2024-12-05 13:01:11)
    > [ Upstream commit 9a8dbdadae509e5717ff6e5aa572ca0974d2101d ]
    > Darrick and Hannes both thought it better that generic_atomic_write_valid()
    > should be passed a struct iocb, and not just the member of that struct
    > which is referenced; see [0] and [1].
    > I think that makes a more generic and clean API, so make that change.
    > [0] https://lore.kernel.org/linux-block/680ce641-729b-4150-b875-531a98657682@suse.de/
    > [1] https://lore.kernel.org/linux-xfs/20240620212401.GA3058325@frogsfrogsfrogs/
    > Fixes: c34fc6f26ab8 (&quot;fs: Initial atomic write support&quot;)
    > Suggested-by: Darrick J. Wong &lt;djwong@kernel.org&gt;
    > Suggested-by: Hannes Reinecke &lt;hare@suse.de&gt;
    > Reviewed-by: Darrick J. Wong &lt;djwong@kernel.org&gt;
    > Reviewed-by: Christoph Hellwig &lt;hch@lst.de&gt;
    > Signed-off-by: John Garry &lt;john.g.garry@oracle.com&gt;
    > Link: https://lore.kernel.org/r/20241019125113.369994-2-john.g.garry@oracle.com
    > Signed-off-by: Jens Axboe &lt;axboe@kernel.dk&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ kselftest/arm64: mte: fix printf type warnings about longs (@Andre Przywara in [75d29dd7eb8da1c](https://github.com/sophgo/linux-riscv/commit/75d29dd7eb8da1c) at 2024-12-05 13:01:11)
    > [ Upstream commit 96dddb7b9406259baace9a1831e8da155311be6f ]
    > When checking MTE tags, we print some diagnostic messages when the tests
    > fail. Some variables uses there are &quot;longs&quot;, however we only use &quot;%x&quot;
    > for the format specifier.
    > Update the format specifiers to &quot;%lx&quot;, to match the variable types they
    > are supposed to print.
    > Fixes: f3b2a26ca78d (&quot;kselftest/arm64: Verify mte tag inclusion via prctl&quot;)
    > Signed-off-by: Andre Przywara &lt;andre.przywara@arm.com&gt;
    > Reviewed-by: Mark Brown &lt;broonie@kernel.org&gt;
    > Link: https://lore.kernel.org/r/20240816153251.2833702-9-andre.przywara@arm.com
    > Signed-off-by: Catalin Marinas &lt;catalin.marinas@arm.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ kselftest/arm64: mte: fix printf type warnings about __u64 (@Andre Przywara in [46c3c7d3bd4f667](https://github.com/sophgo/linux-riscv/commit/46c3c7d3bd4f667) at 2024-12-05 13:01:11)
    > [ Upstream commit 7e893dc81de3e342156389ea0b83ec7d07f25281 ]
    > When printing the signal context&#x27;s PC, we use a &quot;%lx&quot; format specifier,
    > which matches the common userland (glibc&#x27;s) definition of uint64_t as an
    > &quot;unsigned long&quot;. However the structure in question is defined in a
    > kernel uapi header, which uses a self defined __u64 type, and the arm64
    > kernel headers define this using &quot;int-ll64.h&quot;, so it becomes an
    > &quot;unsigned long long&quot;. This mismatch leads to the usual compiler warning.
    > The common fix would be to use &quot;PRIx64&quot;, but because this is defined by
    > the userland&#x27;s toolchain libc headers, it wouldn&#x27;t match as well. Since
    > we know the exact type of __u64, just use &quot;%llx&quot; here instead, to silence
    > this warning.
    > This also fixes a more severe typo: &quot;$lx&quot; is not a valid format
    > specifier.
    > Fixes: 191e678bdc9b (&quot;kselftest/arm64: Log unexpected asynchronous MTE faults&quot;)
    > Signed-off-by: Andre Przywara &lt;andre.przywara@arm.com&gt;
    > Reviewed-by: Mark Brown &lt;broonie@kernel.org&gt;
    > Link: https://lore.kernel.org/r/20240816153251.2833702-7-andre.przywara@arm.com
    > Signed-off-by: Catalin Marinas &lt;catalin.marinas@arm.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ MAINTAINERS: appoint myself the XFS maintainer for 6.12 LTS (@Darrick J. Wong in [e6ee74fcc856981](https://github.com/sophgo/linux-riscv/commit/e6ee74fcc856981) at 2024-12-05 13:01:10)
    > I&#x27;m appointing myself to be responsible for getting after people to
    > submit their upstream bug fixes with the appropriate Fixes tags and to
    > cc stable; to find whatever slips through the cracks; and to keep an eye
    > on the automatic QA of all that stuff.
    > Cc: &lt;stable@vger.kernel.org&gt; # v6.12
    > Signed-off-by: &quot;Darrick J. Wong&quot; &lt;djwong@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ arm64: probes: Disable kprobes/uprobes on MOPS instructions (@Kristina Martsenko in [a11e7e3d2a6b92f](https://github.com/sophgo/linux-riscv/commit/a11e7e3d2a6b92f) at 2024-12-05 13:01:10)
    > [ Upstream commit c56c599d9002d44f559be3852b371db46adac87c ]
    > FEAT_MOPS instructions require that all three instructions (prologue,
    > main and epilogue) appear consecutively in memory. Placing a
    > kprobe/uprobe on one of them doesn&#x27;t work as only a single instruction
    > gets executed out-of-line or simulated. So don&#x27;t allow placing a probe
    > on a MOPS instruction.
    > Fixes: b7564127ffcb (&quot;arm64: mops: detect and enable FEAT_MOPS&quot;)
    > Signed-off-by: Kristina Martsenko &lt;kristina.martsenko@arm.com&gt;
    > Link: https://lore.kernel.org/r/20240930161051.3777828-2-kristina.martsenko@arm.com
    > Signed-off-by: Catalin Marinas &lt;catalin.marinas@arm.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ s390/virtio_ccw: Fix dma_parm pointer not set up (@Halil Pasic in [88f52359dab7777](https://github.com/sophgo/linux-riscv/commit/88f52359dab7777) at 2024-12-05 13:01:10)
    > [ Upstream commit 14c7579376279e507e52bf022192b46097a55377 ]
    > At least since commit 334304ac2bac (&quot;dma-mapping: don&#x27;t return errors
    > from dma_set_max_seg_size&quot;) setting up device.dma_parms is basically
    > mandated by the DMA API. As of now Channel (CCW) I/O in general does not
    > utilize the DMA API, except for virtio. For virtio-ccw however the
    > common virtio DMA infrastructure is such that most of the DMA stuff
    > hinges on the virtio parent device, which is a CCW device.
    > So lets set up the dma_parms pointer for the CCW parent device and hope
    > for the best!
    > Fixes: 334304ac2bac (&quot;dma-mapping: don&#x27;t return errors from dma_set_max_seg_size&quot;)
    > Reported-by: Marc Hartmayer &lt;mhartmay@linux.ibm.com&gt;
    > Reviewed-by: Eric Farman &lt;farman@linux.ibm.com&gt;
    > Reviewed-by: Cornelia Huck &lt;cohuck@redhat.com&gt;
    > Tested-by: Marc Hartmayer &lt;mhartmay@linux.ibm.com&gt;
    > Link: https://lore.kernel.org/r/20241007201030.204028-1-pasic@linux.ibm.com
    > Signed-off-by: Halil Pasic &lt;pasic@linux.ibm.com&gt;
    > Signed-off-by: Heiko Carstens &lt;hca@linux.ibm.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/amd/display: Fix incorrect DSC recompute trigger (@Fangzhi Zuo in [7af235b139f6017](https://github.com/sophgo/linux-riscv/commit/7af235b139f6017) at 2024-12-05 13:01:10)
    > [ Upstream commit 4641169a8c95d9efc35d2d3c55c3948f3b375ff9 ]
    > A stream without dsc_aux should not be eliminated from
    > the dsc determination. Whether it needs a dsc recompute depends on
    > whether its mode has changed or not. Eliminating such a no-dsc stream
    > from the dsc determination policy will end up with inconsistencies
    > in the new dc_state when compared to the current dc_state,
    > triggering a dsc recompute that should not have happened.
    > Reviewed-by: Rodrigo Siqueira &lt;rodrigo.siqueira@amd.com&gt;
    > Signed-off-by: Fangzhi Zuo &lt;Jerry.Zuo@amd.com&gt;
    > Signed-off-by: Aurabindo Pillai &lt;aurabindo.pillai@amd.com&gt;
    > Tested-by: Daniel Wheeler &lt;daniel.wheeler@amd.com&gt;
    > Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ s390/facilities: Fix warning about shadow of global variable (@Gerd Bayer in [50b81b50a991930](https://github.com/sophgo/linux-riscv/commit/50b81b50a991930) at 2024-12-05 13:01:10)
    > [ Upstream commit 61997c1e947dbf8bc625ef86ceee00fdf2a5dba1 ]
    > Compiling the kernel with clang W&#x3D;2 produces a warning that the
    > parameter declarations in some routines would shadow the definition of
    > the global variable stfle_fac_list. Address this warning by renaming the
    > parameters to fac_list.
    > Fixes: 17e89e1340a3 (&quot;s390/facilities: move stfl information from lowcore to global data&quot;)
    > Signed-off-by: Gerd Bayer &lt;gbayer@linux.ibm.com&gt;
    > Signed-off-by: Heiko Carstens &lt;hca@linux.ibm.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ efs: fix the efs new mount api implementation (@Bill O&#x27;Donnell in [24710dded8bafc9](https://github.com/sophgo/linux-riscv/commit/24710dded8bafc9) at 2024-12-05 13:01:10)
    > [ Upstream commit 51ceeb1a8142537b9f65aeaac6c301560a948197 ]
    > Commit 39a6c668e4 (efs: convert efs to use the new mount api)
    > did not include anything from v2 and v3 that were also submitted.
    > Fix this by bringing in those changes that were proposed in v2 and
    > v3.
    > Fixes: 39a6c668e4 efs: convert efs to use the new mount api.
    > Signed-off-by: Bill O&#x27;Donnell &lt;bodonnel@redhat.com&gt;
    > Link: https://lore.kernel.org/r/20241014190241.4093825-1-bodonnel@redhat.com
    > Signed-off-by: Christian Brauner &lt;brauner@kernel.org&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

+ drm/amd/display: Skip Invalid Streams from DSC Policy (@Fangzhi Zuo in [2141d5c5c54ae7b](https://github.com/sophgo/linux-riscv/commit/2141d5c5c54ae7b) at 2024-12-05 13:01:10)
    > [ Upstream commit 9afeda04964281e9f708b92c2a9c4f8a1387b46e ]
    > Streams with invalid new connector state should be elimiated from
    > dsc policy.
    > Reviewed-by: Aurabindo Pillai &lt;aurabindo.pillai@amd.com&gt;
    > Signed-off-by: Fangzhi Zuo &lt;Jerry.Zuo@amd.com&gt;
    > Signed-off-by: Rodrigo Siqueira &lt;rodrigo.siqueira@amd.com&gt;
    > Tested-by: Daniel Wheeler &lt;daniel.wheeler@amd.com&gt;
    > Signed-off-by: Alex Deucher &lt;alexander.deucher@amd.com&gt;
    > Signed-off-by: Sasha Levin &lt;sashal@kernel.org&gt;

## [sophgo-edk2(devel-sg2044)](https://github.com/sophgo/sophgo-edk2/tree/devel-sg2044)

+ Update edk2-platforms (@Jingyu Li in [a598737259fcd41](https://github.com/sophgo/sophgo-edk2/commit/a598737259fcd41) at 2025-01-08 10:17:18)
    > - SG2044Pkg/AcpiTables: Add ACLINT-SSWI support
    > Signed-off-by: Jingyu Li &lt;jingyu.li01@sophgo.com&gt;

+ Update edk2-platforms (@Jingyu Li in [5f7971aa4e1dffb](https://github.com/sophgo/sophgo-edk2/commit/5f7971aa4e1dffb) at 2025-01-07 14:41:49)
    > - SG2044Pkg/AcpiTables: Reserve interrupts 856-863 for TPU
    > - Resolve Password Compilation Errors and Optimize UI Design
    > - SG2044Pkg/UiApp: Add Enable/Disable Password Feature Control to the Menu
    > Signed-off-by: Jingyu Li &lt;jingyu.li01@sophgo.com&gt;

+ Update edk2-platforms (@Jingyu Li in [f658b704c2097ae](https://github.com/sophgo/sophgo-edk2/commit/f658b704c2097ae) at 2025-01-03 15:34:21)
    > - SG2044Pkg/AcpiTables: update &quot;_CCA&quot; value
    > - Add Password Functionality to BIOS
    > Signed-off-by: Jingyu Li &lt;jingyu.li01@sophgo.com&gt;

+ Update edk2-platforms (@Jingyu Li in [93851849a5a093c](https://github.com/sophgo/sophgo-edk2/commit/93851849a5a093c) at 2025-01-02 14:25:29)
    > - SG2044Pkg/AcpiTables/Rhct.alsc: add ISA extensions
    > - SG2044Pkg/AcpiTables/Rhct.alsc: update ISA node length
    > - SG2044Pkg/AcpiTables: update Rhct.alsc
    > Signed-off-by: Jingyu Li &lt;jingyu.li01@sophgo.com&gt;

+ README: Add iASL install steps (@Jingyu Li in [8577135ff3b66cf](https://github.com/sophgo/sophgo-edk2/commit/8577135ff3b66cf) at 2025-01-02 02:01:53)
    > Signed-off-by: Jingyu Li &lt;jingyu.li01@sophgo.com&gt;

+ Update edk2-platforms (@Jingyu Li in [12de069bf777eb9](https://github.com/sophgo/sophgo-edk2/commit/12de069bf777eb9) at 2024-12-31 13:48:09)
    > - Merge branch &#x27;tianocore:master&#x27; into devel-sg2044
    > - SG2044Pkg/AcpiTables: update pci routing table and add &quot;LINK_DEVICE&quot;
    > Signed-off-by: Jingyu Li &lt;jingyu.li01@sophgo.com&gt;

+ Update edk2-platforms (@Jingyu Li in [915f82224428681](https://github.com/sophgo/sophgo-edk2/commit/915f82224428681) at 2024-12-27 01:14:46)
    > - Update the SMBIOS table population code based on the latest conf.ini
    > Signed-off-by: Jingyu Li &lt;jingyu.li01@sophgo.com&gt;

+ Update edk2-platforms (@Jingyu Li in [d11d11a7618f47a](https://github.com/sophgo/sophgo-edk2/commit/d11d11a7618f47a) at 2024-12-25 13:24:19)
    > - IniParserLib: Add MAC address parsing handler
    > - Sophgo/MotorcommPhyDxe: Add Motorcomm YT8531 PHY driver
    > - Sophgo/DwMac4SnpDxe: Add dwmac4 SNP driver
    > - FirmwareManagerUiDxe: Add &quot;Update CONF.INI&quot; button
    > - Optimize the current design for displaying BIOS MENU Information
    > - SG2044Pkg/AcpiTables: update SPCR table to support earlycon
    > Signed-off-by: Jingyu Li &lt;jingyu.li01@sophgo.com&gt;

+ Update edk2-platforms (@Jingyu Li in [64283071131ea90](https://github.com/sophgo/sophgo-edk2/commit/64283071131ea90) at 2024-12-24 12:23:49)
    > - SG2044Pkg/AcpiTables: update PPTT table to support cpu and cache info
    > - SG2044Pkg/AcpiTables: delete device &quot;MCU&quot; and &quot;RESP&quot;
    > - SG2044/Dsdt: Add dependency between PCIe host and MSI controller
    > Signed-off-by: Jingyu Li &lt;jingyu.li01@sophgo.com&gt;

+ Update edk2-platforms (@Jingyu Li in [1e121ed34c507da](https://github.com/sophgo/sophgo-edk2/commit/1e121ed34c507da) at 2024-12-23 13:22:37)
    > - SG2044Pkg: Add DwGpioDxe
    > - SG2044Pkg/AcpiPlatformDxe: Fix not found bug when call entry point
    > - SG2044Pkg/AcpiTables: add thermal support
    > Signed-off-by: Jingyu Li &lt;jingyu.li01@sophgo.com&gt;

+ Update edk2-platforms (@Jingyu Li in [20f4f77e088dcfd](https://github.com/sophgo/sophgo-edk2/commit/20f4f77e088dcfd) at 2024-12-20 09:57:08)
    > - Modify SMBIOS Parsing from conf.ini to address an issue
    > - Resolve the issue where the system hangs during boot due to missing conf.ini
    > in SMBIOS
    > Signed-off-by: Jingyu Li &lt;jingyu.li01@sophgo.com&gt;

+ Update edk2-platforms (@Jingyu Li in [b77710097bdd76e](https://github.com/sophgo/sophgo-edk2/commit/b77710097bdd76e) at 2024-12-19 01:43:13)
    > - SG2044Pkg/AcpiTables: device &quot;MSI&quot; supports 512 interrupt descriptions
    > Signed-off-by: Jingyu Li &lt;jingyu.li01@sophgo.com&gt;

+ Update edk2-platforms (@Jingyu Li in [301967445c1060b](https://github.com/sophgo/sophgo-edk2/commit/301967445c1060b) at 2024-12-17 12:42:12)
    > - Resolve Current Issues in BIOS MENU
    > - SG2044Pkg: Add FirmwareManagerUiDxe
    > Signed-off-by: Jingyu Li &lt;jingyu.li01@sophgo.com&gt;

+ Update edk2-platforms (@Jingyu Li in [b48c43ef9f514bb](https://github.com/sophgo/sophgo-edk2/commit/b48c43ef9f514bb) at 2024-12-13 13:46:26)
    > - SG2044Pkg/AcpiTables: Correct the &quot;_CCA&quot; value of Dsdt/Pci.asl
    > - Enhance Current BIOS MENU Features
    > - SG2044Pkg: Add DwSpiDxe driver
    > Signed-off-by: Jingyu Li &lt;jingyu.li01@sophgo.com&gt;

+ Update edk2-non-osi (@Jingyu Li in [2439cb59030c467](https://github.com/sophgo/sophgo-edk2/commit/2439cb59030c467) at 2024-12-13 10:20:04)
    > - ASpeed/ASpeedGopBinPkg: Update AST2500 RISC-V GOP driver
    > Signed-off-by: Jingyu Li &lt;jingyu.li01@sophgo.com&gt;

+ Update edk2-platforms and edk2-non-osi (@Jingyu Li in [2a7503584bd6a2e](https://github.com/sophgo/sophgo-edk2/commit/2a7503584bd6a2e) at 2024-12-12 09:26:04)
    > - SG2044Pkg: Add AST2500 UEFI GOP driver
    > Signed-off-by: Jingyu Li &lt;jingyu.li01@sophgo.com&gt;

+ Update edk2 and edk2-platforms (@Jingyu Li in [083c4f9e789c26f](https://github.com/sophgo/sophgo-edk2/commit/083c4f9e789c26f) at 2024-12-11 13:35:29)
    > Signed-off-by: Jingyu Li &lt;jingyu.li01@sophgo.com&gt;

+ Update edk2-platforms (@Jingyu Li in [5ce6a6332ace174](https://github.com/sophgo/sophgo-edk2/commit/5ce6a6332ace174) at 2024-12-09 14:05:13)
    > - Improve Hotkey Logic and Adjust BIOS MENU Page Design
    > - Sophgo/PciPlatformLib: Fix PCIe switch enumerate bug
    > - Sophgo/FirmwareUpdate: Add firmware update application
    > - SG2044Pkg/AcpiTables: Update Dsdt/Intc.asl to support MSI controller
    > - SG2044Pkg/AcpiTables: Add Pci.asl and update Mcfg.aslc
    > Signed-off-by: Jingyu Li &lt;jingyu.li01@sophgo.com&gt;

+ Update edk2-platforms (@Jingyu Li in [6cee0c69f76ac92](https://github.com/sophgo/sophgo-edk2/commit/6cee0c69f76ac92) at 2024-12-04 01:51:57)
    > - Ds1307RealTimeClockLib: Add Pcd variable
    > Signed-off-by: Jingyu Li &lt;jingyu.li01@sophgo.com&gt;

+ Update edk2-platforms (@Jingyu Li in [24e456c688186e2](https://github.com/sophgo/sophgo-edk2/commit/24e456c688186e2) at 2024-12-03 01:36:47)
    > - Sophgo/SG2044Pkg: Add Hash2 Protocols to resolve TcpDxe loading issue
    > - Sophgo: RTC runtime support virtual address
    > - Sophgo/StmmacMdioDxe: Add MDIO driver
    > - Sophgo: Fixbug flash runtime support virtual address
    > - StmmacMdioDxe: Fix bug for the undeclared macros
    > Signed-off-by: Jingyu Li &lt;jingyu.li01@sophgo.com&gt;

+ Update edk2-platforms (@Jingyu Li in [6cf298895ff4891](https://github.com/sophgo/sophgo-edk2/commit/6cf298895ff4891) at 2024-11-28 15:14:22)
    > - Enhance the BIOS menu functionality
    > - SpifmcDxe: Replace macro with PcdFlashPartitionTableAddress
    > Signed-off-by: Jingyu Li &lt;jingyu.li01@sophgo.com&gt;

+ Update edk2-platforms (@Jingyu Li in [36fe75b373a4bd0](https://github.com/sophgo/sophgo-edk2/commit/36fe75b373a4bd0) at 2024-11-27 13:35:28)
    > - SpifmcDxe: Refactor I/O resource population phase
    > - NorFlashDxe: Add GetFlashVariableOffset() function
    > - FlashFvbDxe: Refactor FVB R/W policies
    > Signed-off-by: Jingyu Li &lt;jingyu.li01@sophgo.com&gt;

+ Update edk2-platforms (@Jingyu Li in [b13f8220be00bab](https://github.com/sophgo/sophgo-edk2/commit/b13f8220be00bab) at 2024-11-25 14:03:11)
    > - Sophgo/SpiDxe: Add SPIFMC DMMR mode
    > - Silicon/Sophgo: Rename SpiDxe to SpifmcDxe
    > - TrngLib: Fix load access page fault bug
    > - Sophgo/SG2044Pkg: Add DwI2cDxe
    > Signed-off-by: Jingyu Li &lt;jingyu.li01@sophgo.com&gt;

